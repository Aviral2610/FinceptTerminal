const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-2yLhyArq.js","assets/tauri-vendor-CMSE6dGk.js"])))=>i.map(i=>d[i]);
var EI=Object.defineProperty;var pE=s=>{throw TypeError(s)};var CI=(s,e,r)=>e in s?EI(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var Pe=(s,e,r)=>CI(s,typeof e!="symbol"?e+"":e,r),jI=(s,e,r)=>e.has(s)||pE("Cannot "+r);var Fu=(s,e,r)=>(jI(s,e,"read from private field"),r?r.call(s):e.get(s)),hE=(s,e,r)=>e.has(s)?pE("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,r);import{j as t,c as kI,R as AI,L as TI,T as RI,C as NI,a as OI,b as _I,d as DI,e as II,D as PI,P as LI,O as zI}from"./ui-vendor-CShIXldX.js";import{p as bd,b as po,c as $g,r as S,R as MI,a as wa}from"./react-vendor-9XN-Nagm.js";import{a as sA,c as iA,B as BI,b as xl,_ as Br}from"./ccxt-vendor-DQA7zUGY.js";import{i as lt,C as D0,D as Gg,R as fE,o as I0,s as P0,a as FI,j as uf,l as $I}from"./tauri-vendor-CMSE6dGk.js";import{g as oA,r as kl,R as ml,L as tg,C as vd,X as bl,Y as vl,T as Sl,h as rg,j as GI,P as UI,k as WI,l as qI,m as HI,B as aA,n as lA,q as cA,W as YI,o as KI,V as VI,p as XI,s as gE,A as dA,t as L0,u as JI}from"./chart-vendor-BDuuUcnU.js";import{r as QI,H as lo,P as co,u as ZI,a as eP,M as tP,b as rP,R as nP,B as sP,C as iP,c as oP}from"./flow-vendor-BSU3PDPm.js";function aP(s,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in s)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(s,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();var lP={};const uA={version:"v18.0.0",browser:!0,env:{NODE_ENV:"production"},nextTick:(s,...e)=>{setTimeout(()=>s(...e),0)},cwd:()=>"/",platform:"browser",argv:[],pid:1},pA={exports:{},require:s=>(console.warn(`module.require('${s}') called in browser - returning empty object`),{}),id:".",filename:"index.js",loaded:!1,parent:null,children:[]};typeof globalThis.Buffer>"u"&&Object.defineProperty(globalThis,"Buffer",{value:sA,writable:!1,configurable:!1});typeof globalThis.global>"u"&&Object.defineProperty(globalThis,"global",{value:globalThis,writable:!1,configurable:!1});typeof globalThis.process>"u"&&Object.defineProperty(globalThis,"process",{value:uA,writable:!1,configurable:!1});typeof globalThis.module>"u"&&Object.defineProperty(globalThis,"module",{value:pA,writable:!1,configurable:!1});typeof window<"u"&&(typeof window.Buffer>"u"&&(window.Buffer=sA),typeof window.process>"u"&&(window.process=uA),typeof window.module>"u"&&(window.module=pA),typeof window.global>"u"&&(window.global=globalThis));console.log("[Polyfills] Initialized: Buffer, global, process, module");var Ey={exports:{}},$u={},Cy={exports:{}},jy={};var xE;function cP(){return xE||(xE=1,(function(s){function e($,W){var D=$.length;$.push(W);e:for(;0<D;){var oe=D-1>>>1,Z=$[oe];if(0<i(Z,W))$[oe]=W,$[D]=Z,D=oe;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var W=$[0],D=$.pop();if(D!==W){$[0]=D;e:for(var oe=0,Z=$.length,fe=Z>>>1;oe<fe;){var Q=2*(oe+1)-1,_=$[Q],Y=Q+1,he=$[Y];if(0>i(_,D))Y<Z&&0>i(he,_)?($[oe]=he,$[Y]=D,oe=Y):($[oe]=_,$[Q]=D,oe=Q);else if(Y<Z&&0>i(he,D))$[oe]=he,$[Y]=D,oe=Y;else break e}}return W}function i($,W){var D=$.sortIndex-W.sortIndex;return D!==0?D:$.id-W.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();s.unstable_now=function(){return a.now()-l}}var d=[],p=[],f=1,h=null,x=3,m=!1,b=!1,w=!1,y=!1,C=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function j($){for(var W=r(p);W!==null;){if(W.callback===null)n(p);else if(W.startTime<=$)n(p),W.sortIndex=W.expirationTime,e(d,W);else break;W=r(p)}}function k($){if(w=!1,j($),!b)if(r(d)!==null)b=!0,A||(A=!0,G());else{var W=r(p);W!==null&&z(k,W.startTime-$)}}var A=!1,R=-1,M=5,P=-1;function I(){return y?!0:!(s.unstable_now()-P<M)}function O(){if(y=!1,A){var $=s.unstable_now();P=$;var W=!0;try{e:{b=!1,w&&(w=!1,T(R),R=-1),m=!0;var D=x;try{t:{for(j($),h=r(d);h!==null&&!(h.expirationTime>$&&I());){var oe=h.callback;if(typeof oe=="function"){h.callback=null,x=h.priorityLevel;var Z=oe(h.expirationTime<=$);if($=s.unstable_now(),typeof Z=="function"){h.callback=Z,j($),W=!0;break t}h===r(d)&&n(d),j($)}else n(d);h=r(d)}if(h!==null)W=!0;else{var fe=r(p);fe!==null&&z(k,fe.startTime-$),W=!1}}break e}finally{h=null,x=D,m=!1}W=void 0}}finally{W?G():A=!1}}}var G;if(typeof E=="function")G=function(){E(O)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,F=B.port2;B.port1.onmessage=O,G=function(){F.postMessage(null)}}else G=function(){C(O,0)};function z($,W){R=C(function(){$(s.unstable_now())},W)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function($){$.callback=null},s.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<$?Math.floor(1e3/$):5},s.unstable_getCurrentPriorityLevel=function(){return x},s.unstable_next=function($){switch(x){case 1:case 2:case 3:var W=3;break;default:W=x}var D=x;x=W;try{return $()}finally{x=D}},s.unstable_requestPaint=function(){y=!0},s.unstable_runWithPriority=function($,W){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var D=x;x=$;try{return W()}finally{x=D}},s.unstable_scheduleCallback=function($,W,D){var oe=s.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?oe+D:oe):D=oe,$){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=D+Z,$={id:f++,callback:W,priorityLevel:$,startTime:D,expirationTime:Z,sortIndex:-1},D>oe?($.sortIndex=D,e(p,$),r(d)===null&&$===r(p)&&(w?(T(R),R=-1):w=!0,z(k,D-oe))):($.sortIndex=Z,e(d,$),b||m||(b=!0,A||(A=!0,G()))),$},s.unstable_shouldYield=I,s.unstable_wrapCallback=function($){var W=x;return function(){var D=x;x=W;try{return $.apply(this,arguments)}finally{x=D}}}})(jy)),jy}var mE;function dP(){return mE||(mE=1,Cy.exports=cP()),Cy.exports}var yE;function uP(){if(yE)return $u;yE=1;var s=dP(),e=po(),r=$g();function n(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function o(c){var u=c,g=c;if(c.alternate)for(;u.return;)u=u.return;else{c=u;do u=c,(u.flags&4098)!==0&&(g=u.return),c=u.return;while(c)}return u.tag===3?g:null}function a(c){if(c.tag===13){var u=c.memoizedState;if(u===null&&(c=c.alternate,c!==null&&(u=c.memoizedState)),u!==null)return u.dehydrated}return null}function l(c){if(c.tag===31){var u=c.memoizedState;if(u===null&&(c=c.alternate,c!==null&&(u=c.memoizedState)),u!==null)return u.dehydrated}return null}function d(c){if(o(c)!==c)throw Error(n(188))}function p(c){var u=c.alternate;if(!u){if(u=o(c),u===null)throw Error(n(188));return u!==c?null:c}for(var g=c,v=u;;){var N=g.return;if(N===null)break;var L=N.alternate;if(L===null){if(v=N.return,v!==null){g=v;continue}break}if(N.child===L.child){for(L=N.child;L;){if(L===g)return d(N),c;if(L===v)return d(N),u;L=L.sibling}throw Error(n(188))}if(g.return!==v.return)g=N,v=L;else{for(var te=!1,we=N.child;we;){if(we===g){te=!0,g=N,v=L;break}if(we===v){te=!0,v=N,g=L;break}we=we.sibling}if(!te){for(we=L.child;we;){if(we===g){te=!0,g=L,v=N;break}if(we===v){te=!0,v=L,g=N;break}we=we.sibling}if(!te)throw Error(n(189))}}if(g.alternate!==v)throw Error(n(190))}if(g.tag!==3)throw Error(n(188));return g.stateNode.current===g?c:u}function f(c){var u=c.tag;if(u===5||u===26||u===27||u===6)return c;for(c=c.child;c!==null;){if(u=f(c),u!==null)return u;c=c.sibling}return null}var h=Object.assign,x=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),E=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function G(c){return c===null||typeof c!="object"?null:(c=O&&c[O]||c["@@iterator"],typeof c=="function"?c:null)}var B=Symbol.for("react.client.reference");function F(c){if(c==null)return null;if(typeof c=="function")return c.$$typeof===B?null:c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case w:return"Fragment";case C:return"Profiler";case y:return"StrictMode";case k:return"Suspense";case A:return"SuspenseList";case P:return"Activity"}if(typeof c=="object")switch(c.$$typeof){case b:return"Portal";case E:return c.displayName||"Context";case T:return(c._context.displayName||"Context")+".Consumer";case j:var u=c.render;return c=c.displayName,c||(c=u.displayName||u.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case R:return u=c.displayName||null,u!==null?u:F(c.type)||"Memo";case M:u=c._payload,c=c._init;try{return F(c(u))}catch{}}return null}var z=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D={pending:!1,data:null,method:null,action:null},oe=[],Z=-1;function fe(c){return{current:c}}function Q(c){0>Z||(c.current=oe[Z],oe[Z]=null,Z--)}function _(c,u){Z++,oe[Z]=c.current,c.current=u}var Y=fe(null),he=fe(null),me=fe(null),ge=fe(null);function le(c,u){switch(_(me,u),_(he,c),_(Y,null),u.nodeType){case 9:case 11:c=(c=u.documentElement)&&(c=c.namespaceURI)?Pw(c):0;break;default:if(c=u.tagName,u=u.namespaceURI)u=Pw(u),c=Lw(u,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}Q(Y),_(Y,c)}function X(){Q(Y),Q(he),Q(me)}function V(c){c.memoizedState!==null&&_(ge,c);var u=Y.current,g=Lw(u,c.type);u!==g&&(_(he,c),_(Y,g))}function de(c){he.current===c&&(Q(Y),Q(he)),ge.current===c&&(Q(ge),Lu._currentValue=D)}var je,_e;function Re(c){if(je===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);je=u&&u[1]||"",_e=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+c+_e}var Be=!1;function Se(c,u){if(!c||Be)return"";Be=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(u){var gt=function(){throw Error()};if(Object.defineProperty(gt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(gt,[])}catch(at){var st=at}Reflect.construct(c,[],gt)}else{try{gt.call()}catch(at){st=at}c.call(gt.prototype)}}else{try{throw Error()}catch(at){st=at}(gt=c())&&typeof gt.catch=="function"&&gt.catch(function(){})}}catch(at){if(at&&st&&typeof at.stack=="string")return[at.stack,st.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var N=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");N&&N.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var L=v.DetermineComponentFrameRoot(),te=L[0],we=L[1];if(te&&we){var Fe=te.split(`
`),nt=we.split(`
`);for(N=v=0;v<Fe.length&&!Fe[v].includes("DetermineComponentFrameRoot");)v++;for(;N<nt.length&&!nt[N].includes("DetermineComponentFrameRoot");)N++;if(v===Fe.length||N===nt.length)for(v=Fe.length-1,N=nt.length-1;1<=v&&0<=N&&Fe[v]!==nt[N];)N--;for(;1<=v&&0<=N;v--,N--)if(Fe[v]!==nt[N]){if(v!==1||N!==1)do if(v--,N--,0>N||Fe[v]!==nt[N]){var dt=`
`+Fe[v].replace(" at new "," at ");return c.displayName&&dt.includes("<anonymous>")&&(dt=dt.replace("<anonymous>",c.displayName)),dt}while(1<=v&&0<=N);break}}}finally{Be=!1,Error.prepareStackTrace=g}return(g=c?c.displayName||c.name:"")?Re(g):""}function ie(c,u){switch(c.tag){case 26:case 27:case 5:return Re(c.type);case 16:return Re("Lazy");case 13:return c.child!==u&&u!==null?Re("Suspense Fallback"):Re("Suspense");case 19:return Re("SuspenseList");case 0:case 15:return Se(c.type,!1);case 11:return Se(c.type.render,!1);case 1:return Se(c.type,!0);case 31:return Re("Activity");default:return""}}function ve(c){try{var u="",g=null;do u+=ie(c,g),g=c,c=c.return;while(c);return u}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}var Ae=Object.prototype.hasOwnProperty,$e=s.unstable_scheduleCallback,qe=s.unstable_cancelCallback,Ie=s.unstable_shouldYield,K=s.unstable_requestPaint,Ee=s.unstable_now,Oe=s.unstable_getCurrentPriorityLevel,q=s.unstable_ImmediatePriority,ee=s.unstable_UserBlockingPriority,ce=s.unstable_NormalPriority,Ce=s.unstable_LowPriority,be=s.unstable_IdlePriority,We=s.log,J=s.unstable_setDisableYieldValue,se=null,Te=null;function Me(c){if(typeof We=="function"&&J(c),Te&&typeof Te.setStrictMode=="function")try{Te.setStrictMode(se,c)}catch{}}var Qe=Math.clz32?Math.clz32:re,ye=Math.log,ue=Math.LN2;function re(c){return c>>>=0,c===0?32:31-(ye(c)/ue|0)|0}var ke=256,Ne=262144,U=4194304;function ne(c){var u=c&42;if(u!==0)return u;switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return c&261888;case 262144:case 524288:case 1048576:case 2097152:return c&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return c&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return c}}function xe(c,u,g){var v=c.pendingLanes;if(v===0)return 0;var N=0,L=c.suspendedLanes,te=c.pingedLanes;c=c.warmLanes;var we=v&134217727;return we!==0?(v=we&~L,v!==0?N=ne(v):(te&=we,te!==0?N=ne(te):g||(g=we&~c,g!==0&&(N=ne(g))))):(we=v&~L,we!==0?N=ne(we):te!==0?N=ne(te):g||(g=v&~c,g!==0&&(N=ne(g)))),N===0?0:u!==0&&u!==N&&(u&L)===0&&(L=N&-N,g=u&-u,L>=g||L===32&&(g&4194048)!==0)?u:N}function Le(c,u){return(c.pendingLanes&~(c.suspendedLanes&~c.pingedLanes)&u)===0}function ze(c,u){switch(c){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ge(){var c=U;return U<<=1,(U&62914560)===0&&(U=4194304),c}function Ze(c){for(var u=[],g=0;31>g;g++)u.push(c);return u}function xt(c,u){c.pendingLanes|=u,u!==268435456&&(c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0)}function bt(c,u,g,v,N,L){var te=c.pendingLanes;c.pendingLanes=g,c.suspendedLanes=0,c.pingedLanes=0,c.warmLanes=0,c.expiredLanes&=g,c.entangledLanes&=g,c.errorRecoveryDisabledLanes&=g,c.shellSuspendCounter=0;var we=c.entanglements,Fe=c.expirationTimes,nt=c.hiddenUpdates;for(g=te&~g;0<g;){var dt=31-Qe(g),gt=1<<dt;we[dt]=0,Fe[dt]=-1;var st=nt[dt];if(st!==null)for(nt[dt]=null,dt=0;dt<st.length;dt++){var at=st[dt];at!==null&&(at.lane&=-536870913)}g&=~gt}v!==0&&Lt(c,v,0),L!==0&&N===0&&c.tag!==0&&(c.suspendedLanes|=L&~(te&~u))}function Lt(c,u,g){c.pendingLanes|=u,c.suspendedLanes&=~u;var v=31-Qe(u);c.entangledLanes|=u,c.entanglements[v]=c.entanglements[v]|1073741824|g&261930}function yt(c,u){var g=c.entangledLanes|=u;for(c=c.entanglements;g;){var v=31-Qe(g),N=1<<v;N&u|c[v]&u&&(c[v]|=u),g&=~N}}function Pt(c,u){var g=u&-u;return g=(g&42)!==0?1:Et(g),(g&(c.suspendedLanes|u))!==0?0:g}function Et(c){switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=128;break;case 268435456:c=134217728;break;default:c=0}return c}function tt(c){return c&=-c,2<c?8<c?(c&134217727)!==0?32:268435456:8:2}function it(){var c=W.p;return c!==0?c:(c=window.event,c===void 0?32:iE(c.type))}function vt(c,u){var g=W.p;try{return W.p=c,u()}finally{W.p=g}}var rr=Math.random().toString(36).slice(2),Zt="__reactFiber$"+rr,mr="__reactProps$"+rr,Cr="__reactContainer$"+rr,ts="__reactEvents$"+rr,As="__reactListeners$"+rr,Fs="__reactHandles$"+rr,Ve="__reactResources$"+rr,Ot="__reactMarker$"+rr;function It(c){delete c[Zt],delete c[mr],delete c[ts],delete c[As],delete c[Fs]}function Dt(c){var u=c[Zt];if(u)return u;for(var g=c.parentNode;g;){if(u=g[Cr]||g[Zt]){if(g=u.alternate,u.child!==null||g!==null&&g.child!==null)for(c=Uw(c);c!==null;){if(g=c[Zt])return g;c=Uw(c)}return u}c=g,g=c.parentNode}return null}function Ct(c){if(c=c[Zt]||c[Cr]){var u=c.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return c}return null}function or(c){var u=c.tag;if(u===5||u===26||u===27||u===6)return c.stateNode;throw Error(n(33))}function rn(c){var u=c[Ve];return u||(u=c[Ve]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function $r(c){c[Ot]=!0}var oi=new Set,Ei={};function xs(c,u){$t(c,u),$t(c+"Capture",u)}function $t(c,u){for(Ei[c]=u,c=0;c<u.length;c++)oi.add(u[c])}var Wr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),En={},Ir={};function Fn(c){return Ae.call(Ir,c)?!0:Ae.call(En,c)?!1:Wr.test(c)?Ir[c]=!0:(En[c]=!0,!1)}function us(c,u,g){if(Fn(u))if(g===null)c.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":c.removeAttribute(u);return;case"boolean":var v=u.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){c.removeAttribute(u);return}}c.setAttribute(u,""+g)}}function Pr(c,u,g){if(g===null)c.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(u);return}c.setAttribute(u,""+g)}}function Cn(c,u,g,v){if(v===null)c.removeAttribute(g);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":c.removeAttribute(g);return}c.setAttributeNS(u,g,""+v)}}function Gr(c){switch(typeof c){case"bigint":case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Yn(c){var u=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function cn(c,u,g){var v=Object.getOwnPropertyDescriptor(c.constructor.prototype,u);if(!c.hasOwnProperty(u)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var N=v.get,L=v.set;return Object.defineProperty(c,u,{configurable:!0,get:function(){return N.call(this)},set:function(te){g=""+te,L.call(this,te)}}),Object.defineProperty(c,u,{enumerable:v.enumerable}),{getValue:function(){return g},setValue:function(te){g=""+te},stopTracking:function(){c._valueTracker=null,delete c[u]}}}}function dn(c){if(!c._valueTracker){var u=Yn(c)?"checked":"value";c._valueTracker=cn(c,u,""+c[u])}}function ho(c){if(!c)return!1;var u=c._valueTracker;if(!u)return!0;var g=u.getValue(),v="";return c&&(v=Yn(c)?c.checked?"true":"false":c.value),c=v,c!==g?(u.setValue(c),!0):!1}function jt(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}var Vs=/[\n"\\]/g;function rs(c){return c.replace(Vs,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function Xs(c,u,g,v,N,L,te,we){c.name="",te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"?c.type=te:c.removeAttribute("type"),u!=null?te==="number"?(u===0&&c.value===""||c.value!=u)&&(c.value=""+Gr(u)):c.value!==""+Gr(u)&&(c.value=""+Gr(u)):te!=="submit"&&te!=="reset"||c.removeAttribute("value"),u!=null?ae(c,te,Gr(u)):g!=null?ae(c,te,Gr(g)):v!=null&&c.removeAttribute("value"),N==null&&L!=null&&(c.defaultChecked=!!L),N!=null&&(c.checked=N&&typeof N!="function"&&typeof N!="symbol"),we!=null&&typeof we!="function"&&typeof we!="symbol"&&typeof we!="boolean"?c.name=""+Gr(we):c.removeAttribute("name")}function H(c,u,g,v,N,L,te,we){if(L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"&&(c.type=L),u!=null||g!=null){if(!(L!=="submit"&&L!=="reset"||u!=null)){dn(c);return}g=g!=null?""+Gr(g):"",u=u!=null?""+Gr(u):g,we||u===c.value||(c.value=u),c.defaultValue=u}v=v??N,v=typeof v!="function"&&typeof v!="symbol"&&!!v,c.checked=we?c.checked:!!v,c.defaultChecked=!!v,te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"&&(c.name=te),dn(c)}function ae(c,u,g){u==="number"&&jt(c.ownerDocument)===c||c.defaultValue===""+g||(c.defaultValue=""+g)}function De(c,u,g,v){if(c=c.options,u){u={};for(var N=0;N<g.length;N++)u["$"+g[N]]=!0;for(g=0;g<c.length;g++)N=u.hasOwnProperty("$"+c[g].value),c[g].selected!==N&&(c[g].selected=N),N&&v&&(c[g].defaultSelected=!0)}else{for(g=""+Gr(g),u=null,N=0;N<c.length;N++){if(c[N].value===g){c[N].selected=!0,v&&(c[N].defaultSelected=!0);return}u!==null||c[N].disabled||(u=c[N])}u!==null&&(u.selected=!0)}}function Ke(c,u,g){if(u!=null&&(u=""+Gr(u),u!==c.value&&(c.value=u),g==null)){c.defaultValue!==u&&(c.defaultValue=u);return}c.defaultValue=g!=null?""+Gr(g):""}function ut(c,u,g,v){if(u==null){if(v!=null){if(g!=null)throw Error(n(92));if(z(v)){if(1<v.length)throw Error(n(93));v=v[0]}g=v}g==null&&(g=""),u=g}g=Gr(u),c.defaultValue=g,v=c.textContent,v===g&&v!==""&&v!==null&&(c.value=v),dn(c)}function kt(c,u){if(u){var g=c.firstChild;if(g&&g===c.lastChild&&g.nodeType===3){g.nodeValue=u;return}}c.textContent=u}var pr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vr(c,u,g){var v=u.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?v?c.setProperty(u,""):u==="float"?c.cssFloat="":c[u]="":v?c.setProperty(u,g):typeof g!="number"||g===0||pr.has(u)?u==="float"?c.cssFloat=g:c[u]=(""+g).trim():c[u]=g+"px"}function ns(c,u,g){if(u!=null&&typeof u!="object")throw Error(n(62));if(c=c.style,g!=null){for(var v in g)!g.hasOwnProperty(v)||u!=null&&u.hasOwnProperty(v)||(v.indexOf("--")===0?c.setProperty(v,""):v==="float"?c.cssFloat="":c[v]="");for(var N in u)v=u[N],u.hasOwnProperty(N)&&g[N]!==v&&Vr(c,N,v)}else for(var L in u)u.hasOwnProperty(L)&&Vr(c,L,u[L])}function $n(c){if(c.indexOf("-")===-1)return!1;switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var b_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),v_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function th(c){return v_.test(""+c)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":c}function Jo(){}var vx=null;function Sx(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Sc=null,wc=null;function Iv(c){var u=Ct(c);if(u&&(c=u.stateNode)){var g=c[mr]||null;e:switch(c=u.stateNode,u.type){case"input":if(Xs(c,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),u=g.name,g.type==="radio"&&u!=null){for(g=c;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+rs(""+u)+'"][type="radio"]'),u=0;u<g.length;u++){var v=g[u];if(v!==c&&v.form===c.form){var N=v[mr]||null;if(!N)throw Error(n(90));Xs(v,N.value,N.defaultValue,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name)}}for(u=0;u<g.length;u++)v=g[u],v.form===c.form&&ho(v)}break e;case"textarea":Ke(c,g.value,g.defaultValue);break e;case"select":u=g.value,u!=null&&De(c,!!g.multiple,u,!1)}}}var wx=!1;function Pv(c,u,g){if(wx)return c(u,g);wx=!0;try{var v=c(u);return v}finally{if(wx=!1,(Sc!==null||wc!==null)&&(Gh(),Sc&&(u=Sc,c=wc,wc=Sc=null,Iv(u),c)))for(u=0;u<c.length;u++)Iv(c[u])}}function Zd(c,u){var g=c.stateNode;if(g===null)return null;var v=g[mr]||null;if(v===null)return null;g=v[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(c=c.type,v=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!v;break e;default:c=!1}if(c)return null;if(g&&typeof g!="function")throw Error(n(231,u,typeof g));return g}var Qo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ex=!1;if(Qo)try{var eu={};Object.defineProperty(eu,"passive",{get:function(){Ex=!0}}),window.addEventListener("test",eu,eu),window.removeEventListener("test",eu,eu)}catch{Ex=!1}var Ta=null,Cx=null,rh=null;function Lv(){if(rh)return rh;var c,u=Cx,g=u.length,v,N="value"in Ta?Ta.value:Ta.textContent,L=N.length;for(c=0;c<g&&u[c]===N[c];c++);var te=g-c;for(v=1;v<=te&&u[g-v]===N[L-v];v++);return rh=N.slice(c,1<v?1-v:void 0)}function nh(c){var u=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&u===13&&(c=13)):c=u,c===10&&(c=13),32<=c||c===13?c:0}function sh(){return!0}function zv(){return!1}function ai(c){function u(g,v,N,L,te){this._reactName=g,this._targetInst=N,this.type=v,this.nativeEvent=L,this.target=te,this.currentTarget=null;for(var we in c)c.hasOwnProperty(we)&&(g=c[we],this[we]=g?g(L):L[we]);return this.isDefaultPrevented=(L.defaultPrevented!=null?L.defaultPrevented:L.returnValue===!1)?sh:zv,this.isPropagationStopped=zv,this}return h(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=sh)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=sh)},persist:function(){},isPersistent:sh}),u}var Nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ih=ai(Nl),tu=h({},Nl,{view:0,detail:0}),S_=ai(tu),jx,kx,ru,oh=h({},tu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tx,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==ru&&(ru&&c.type==="mousemove"?(jx=c.screenX-ru.screenX,kx=c.screenY-ru.screenY):kx=jx=0,ru=c),jx)},movementY:function(c){return"movementY"in c?c.movementY:kx}}),Mv=ai(oh),w_=h({},oh,{dataTransfer:0}),E_=ai(w_),C_=h({},tu,{relatedTarget:0}),Ax=ai(C_),j_=h({},Nl,{animationName:0,elapsedTime:0,pseudoElement:0}),k_=ai(j_),A_=h({},Nl,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),T_=ai(A_),R_=h({},Nl,{data:0}),Bv=ai(R_),N_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},__={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function D_(c){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(c):(c=__[c])?!!u[c]:!1}function Tx(){return D_}var I_=h({},tu,{key:function(c){if(c.key){var u=N_[c.key]||c.key;if(u!=="Unidentified")return u}return c.type==="keypress"?(c=nh(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?O_[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tx,charCode:function(c){return c.type==="keypress"?nh(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?nh(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),P_=ai(I_),L_=h({},oh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fv=ai(L_),z_=h({},tu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tx}),M_=ai(z_),B_=h({},Nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),F_=ai(B_),$_=h({},oh,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),G_=ai($_),U_=h({},Nl,{newState:0,oldState:0}),W_=ai(U_),q_=[9,13,27,32],Rx=Qo&&"CompositionEvent"in window,nu=null;Qo&&"documentMode"in document&&(nu=document.documentMode);var H_=Qo&&"TextEvent"in window&&!nu,$v=Qo&&(!Rx||nu&&8<nu&&11>=nu),Gv=" ",Uv=!1;function Wv(c,u){switch(c){case"keyup":return q_.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qv(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Ec=!1;function Y_(c,u){switch(c){case"compositionend":return qv(u);case"keypress":return u.which!==32?null:(Uv=!0,Gv);case"textInput":return c=u.data,c===Gv&&Uv?null:c;default:return null}}function K_(c,u){if(Ec)return c==="compositionend"||!Rx&&Wv(c,u)?(c=Lv(),rh=Cx=Ta=null,Ec=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return $v&&u.locale!=="ko"?null:u.data;default:return null}}var V_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hv(c){var u=c&&c.nodeName&&c.nodeName.toLowerCase();return u==="input"?!!V_[c.type]:u==="textarea"}function Yv(c,u,g,v){Sc?wc?wc.push(v):wc=[v]:Sc=v,u=Vh(u,"onChange"),0<u.length&&(g=new ih("onChange","change",null,g,v),c.push({event:g,listeners:u}))}var su=null,iu=null;function X_(c){Rw(c,0)}function ah(c){var u=or(c);if(ho(u))return c}function Kv(c,u){if(c==="change")return u}var Vv=!1;if(Qo){var Nx;if(Qo){var Ox="oninput"in document;if(!Ox){var Xv=document.createElement("div");Xv.setAttribute("oninput","return;"),Ox=typeof Xv.oninput=="function"}Nx=Ox}else Nx=!1;Vv=Nx&&(!document.documentMode||9<document.documentMode)}function Jv(){su&&(su.detachEvent("onpropertychange",Qv),iu=su=null)}function Qv(c){if(c.propertyName==="value"&&ah(iu)){var u=[];Yv(u,iu,c,Sx(c)),Pv(X_,u)}}function J_(c,u,g){c==="focusin"?(Jv(),su=u,iu=g,su.attachEvent("onpropertychange",Qv)):c==="focusout"&&Jv()}function Q_(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return ah(iu)}function Z_(c,u){if(c==="click")return ah(u)}function eD(c,u){if(c==="input"||c==="change")return ah(u)}function tD(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var Ci=typeof Object.is=="function"?Object.is:tD;function ou(c,u){if(Ci(c,u))return!0;if(typeof c!="object"||c===null||typeof u!="object"||u===null)return!1;var g=Object.keys(c),v=Object.keys(u);if(g.length!==v.length)return!1;for(v=0;v<g.length;v++){var N=g[v];if(!Ae.call(u,N)||!Ci(c[N],u[N]))return!1}return!0}function Zv(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function e1(c,u){var g=Zv(c);c=0;for(var v;g;){if(g.nodeType===3){if(v=c+g.textContent.length,c<=u&&v>=u)return{node:g,offset:u-c};c=v}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=Zv(g)}}function t1(c,u){return c&&u?c===u?!0:c&&c.nodeType===3?!1:u&&u.nodeType===3?t1(c,u.parentNode):"contains"in c?c.contains(u):c.compareDocumentPosition?!!(c.compareDocumentPosition(u)&16):!1:!1}function r1(c){c=c!=null&&c.ownerDocument!=null&&c.ownerDocument.defaultView!=null?c.ownerDocument.defaultView:window;for(var u=jt(c.document);u instanceof c.HTMLIFrameElement;){try{var g=typeof u.contentWindow.location.href=="string"}catch{g=!1}if(g)c=u.contentWindow;else break;u=jt(c.document)}return u}function _x(c){var u=c&&c.nodeName&&c.nodeName.toLowerCase();return u&&(u==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||u==="textarea"||c.contentEditable==="true")}var rD=Qo&&"documentMode"in document&&11>=document.documentMode,Cc=null,Dx=null,au=null,Ix=!1;function n1(c,u,g){var v=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Ix||Cc==null||Cc!==jt(v)||(v=Cc,"selectionStart"in v&&_x(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),au&&ou(au,v)||(au=v,v=Vh(Dx,"onSelect"),0<v.length&&(u=new ih("onSelect","select",null,u,g),c.push({event:u,listeners:v}),u.target=Cc)))}function Ol(c,u){var g={};return g[c.toLowerCase()]=u.toLowerCase(),g["Webkit"+c]="webkit"+u,g["Moz"+c]="moz"+u,g}var jc={animationend:Ol("Animation","AnimationEnd"),animationiteration:Ol("Animation","AnimationIteration"),animationstart:Ol("Animation","AnimationStart"),transitionrun:Ol("Transition","TransitionRun"),transitionstart:Ol("Transition","TransitionStart"),transitioncancel:Ol("Transition","TransitionCancel"),transitionend:Ol("Transition","TransitionEnd")},Px={},s1={};Qo&&(s1=document.createElement("div").style,"AnimationEvent"in window||(delete jc.animationend.animation,delete jc.animationiteration.animation,delete jc.animationstart.animation),"TransitionEvent"in window||delete jc.transitionend.transition);function _l(c){if(Px[c])return Px[c];if(!jc[c])return c;var u=jc[c],g;for(g in u)if(u.hasOwnProperty(g)&&g in s1)return Px[c]=u[g];return c}var i1=_l("animationend"),o1=_l("animationiteration"),a1=_l("animationstart"),nD=_l("transitionrun"),sD=_l("transitionstart"),iD=_l("transitioncancel"),l1=_l("transitionend"),c1=new Map,Lx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lx.push("scrollEnd");function fo(c,u){c1.set(c,u),xs(u,[c])}var lh=typeof reportError=="function"?reportError:function(c){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof c=="object"&&c!==null&&typeof c.message=="string"?String(c.message):String(c),error:c});if(!window.dispatchEvent(u))return}else if(typeof bd=="object"&&typeof bd.emit=="function"){bd.emit("uncaughtException",c);return}console.error(c)},$i=[],kc=0,zx=0;function ch(){for(var c=kc,u=zx=kc=0;u<c;){var g=$i[u];$i[u++]=null;var v=$i[u];$i[u++]=null;var N=$i[u];$i[u++]=null;var L=$i[u];if($i[u++]=null,v!==null&&N!==null){var te=v.pending;te===null?N.next=N:(N.next=te.next,te.next=N),v.pending=N}L!==0&&d1(g,N,L)}}function dh(c,u,g,v){$i[kc++]=c,$i[kc++]=u,$i[kc++]=g,$i[kc++]=v,zx|=v,c.lanes|=v,c=c.alternate,c!==null&&(c.lanes|=v)}function Mx(c,u,g,v){return dh(c,u,g,v),uh(c)}function Dl(c,u){return dh(c,null,null,u),uh(c)}function d1(c,u,g){c.lanes|=g;var v=c.alternate;v!==null&&(v.lanes|=g);for(var N=!1,L=c.return;L!==null;)L.childLanes|=g,v=L.alternate,v!==null&&(v.childLanes|=g),L.tag===22&&(c=L.stateNode,c===null||c._visibility&1||(N=!0)),c=L,L=L.return;return c.tag===3?(L=c.stateNode,N&&u!==null&&(N=31-Qe(g),c=L.hiddenUpdates,v=c[N],v===null?c[N]=[u]:v.push(u),u.lane=g|536870912),L):null}function uh(c){if(50<Ru)throw Ru=0,Ym=null,Error(n(185));for(var u=c.return;u!==null;)c=u,u=c.return;return c.tag===3?c.stateNode:null}var Ac={};function oD(c,u,g,v){this.tag=c,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ji(c,u,g,v){return new oD(c,u,g,v)}function Bx(c){return c=c.prototype,!(!c||!c.isReactComponent)}function Zo(c,u){var g=c.alternate;return g===null?(g=ji(c.tag,u,c.key,c.mode),g.elementType=c.elementType,g.type=c.type,g.stateNode=c.stateNode,g.alternate=c,c.alternate=g):(g.pendingProps=u,g.type=c.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=c.flags&65011712,g.childLanes=c.childLanes,g.lanes=c.lanes,g.child=c.child,g.memoizedProps=c.memoizedProps,g.memoizedState=c.memoizedState,g.updateQueue=c.updateQueue,u=c.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=c.sibling,g.index=c.index,g.ref=c.ref,g.refCleanup=c.refCleanup,g}function u1(c,u){c.flags&=65011714;var g=c.alternate;return g===null?(c.childLanes=0,c.lanes=u,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=g.childLanes,c.lanes=g.lanes,c.child=g.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=g.memoizedProps,c.memoizedState=g.memoizedState,c.updateQueue=g.updateQueue,c.type=g.type,u=g.dependencies,c.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),c}function ph(c,u,g,v,N,L){var te=0;if(v=c,typeof c=="function")Bx(c)&&(te=1);else if(typeof c=="string")te=uI(c,g,Y.current)?26:c==="html"||c==="head"||c==="body"?27:5;else e:switch(c){case P:return c=ji(31,g,u,N),c.elementType=P,c.lanes=L,c;case w:return Il(g.children,N,L,u);case y:te=8,N|=24;break;case C:return c=ji(12,g,u,N|2),c.elementType=C,c.lanes=L,c;case k:return c=ji(13,g,u,N),c.elementType=k,c.lanes=L,c;case A:return c=ji(19,g,u,N),c.elementType=A,c.lanes=L,c;default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case E:te=10;break e;case T:te=9;break e;case j:te=11;break e;case R:te=14;break e;case M:te=16,v=null;break e}te=29,g=Error(n(130,c===null?"null":typeof c,"")),v=null}return u=ji(te,g,u,N),u.elementType=c,u.type=v,u.lanes=L,u}function Il(c,u,g,v){return c=ji(7,c,v,u),c.lanes=g,c}function Fx(c,u,g){return c=ji(6,c,null,u),c.lanes=g,c}function p1(c){var u=ji(18,null,null,0);return u.stateNode=c,u}function $x(c,u,g){return u=ji(4,c.children!==null?c.children:[],c.key,u),u.lanes=g,u.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},u}var h1=new WeakMap;function Gi(c,u){if(typeof c=="object"&&c!==null){var g=h1.get(c);return g!==void 0?g:(u={value:c,source:u,stack:ve(u)},h1.set(c,u),u)}return{value:c,source:u,stack:ve(u)}}var Tc=[],Rc=0,hh=null,lu=0,Ui=[],Wi=0,Ra=null,Ro=1,No="";function ea(c,u){Tc[Rc++]=lu,Tc[Rc++]=hh,hh=c,lu=u}function f1(c,u,g){Ui[Wi++]=Ro,Ui[Wi++]=No,Ui[Wi++]=Ra,Ra=c;var v=Ro;c=No;var N=32-Qe(v)-1;v&=~(1<<N),g+=1;var L=32-Qe(u)+N;if(30<L){var te=N-N%5;L=(v&(1<<te)-1).toString(32),v>>=te,N-=te,Ro=1<<32-Qe(u)+N|g<<N|v,No=L+c}else Ro=1<<L|g<<N|v,No=c}function Gx(c){c.return!==null&&(ea(c,1),f1(c,1,0))}function Ux(c){for(;c===hh;)hh=Tc[--Rc],Tc[Rc]=null,lu=Tc[--Rc],Tc[Rc]=null;for(;c===Ra;)Ra=Ui[--Wi],Ui[Wi]=null,No=Ui[--Wi],Ui[Wi]=null,Ro=Ui[--Wi],Ui[Wi]=null}function g1(c,u){Ui[Wi++]=Ro,Ui[Wi++]=No,Ui[Wi++]=Ra,Ro=u.id,No=u.overflow,Ra=c}var Ts=null,jn=null,Or=!1,Na=null,qi=!1,Wx=Error(n(519));function Oa(c){var u=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw cu(Gi(u,c)),Wx}function x1(c){var u=c.stateNode,g=c.type,v=c.memoizedProps;switch(u[Zt]=c,u[mr]=v,g){case"dialog":br("cancel",u),br("close",u);break;case"iframe":case"object":case"embed":br("load",u);break;case"video":case"audio":for(g=0;g<Ou.length;g++)br(Ou[g],u);break;case"source":br("error",u);break;case"img":case"image":case"link":br("error",u),br("load",u);break;case"details":br("toggle",u);break;case"input":br("invalid",u),H(u,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0);break;case"select":br("invalid",u);break;case"textarea":br("invalid",u),ut(u,v.value,v.defaultValue,v.children)}g=v.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||u.textContent===""+g||v.suppressHydrationWarning===!0||Dw(u.textContent,g)?(v.popover!=null&&(br("beforetoggle",u),br("toggle",u)),v.onScroll!=null&&br("scroll",u),v.onScrollEnd!=null&&br("scrollend",u),v.onClick!=null&&(u.onclick=Jo),u=!0):u=!1,u||Oa(c,!0)}function m1(c){for(Ts=c.return;Ts;)switch(Ts.tag){case 5:case 31:case 13:qi=!1;return;case 27:case 3:qi=!0;return;default:Ts=Ts.return}}function Nc(c){if(c!==Ts)return!1;if(!Or)return m1(c),Or=!0,!1;var u=c.tag,g;if((g=u!==3&&u!==27)&&((g=u===5)&&(g=c.type,g=!(g!=="form"&&g!=="button")||ly(c.type,c.memoizedProps)),g=!g),g&&jn&&Oa(c),m1(c),u===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(n(317));jn=Gw(c)}else if(u===31){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(n(317));jn=Gw(c)}else u===27?(u=jn,qa(c.type)?(c=hy,hy=null,jn=c):jn=u):jn=Ts?Yi(c.stateNode.nextSibling):null;return!0}function Pl(){jn=Ts=null,Or=!1}function qx(){var c=Na;return c!==null&&(ui===null?ui=c:ui.push.apply(ui,c),Na=null),c}function cu(c){Na===null?Na=[c]:Na.push(c)}var Hx=fe(null),Ll=null,ta=null;function _a(c,u,g){_(Hx,u._currentValue),u._currentValue=g}function ra(c){c._currentValue=Hx.current,Q(Hx)}function Yx(c,u,g){for(;c!==null;){var v=c.alternate;if((c.childLanes&u)!==u?(c.childLanes|=u,v!==null&&(v.childLanes|=u)):v!==null&&(v.childLanes&u)!==u&&(v.childLanes|=u),c===g)break;c=c.return}}function Kx(c,u,g,v){var N=c.child;for(N!==null&&(N.return=c);N!==null;){var L=N.dependencies;if(L!==null){var te=N.child;L=L.firstContext;e:for(;L!==null;){var we=L;L=N;for(var Fe=0;Fe<u.length;Fe++)if(we.context===u[Fe]){L.lanes|=g,we=L.alternate,we!==null&&(we.lanes|=g),Yx(L.return,g,c),v||(te=null);break e}L=we.next}}else if(N.tag===18){if(te=N.return,te===null)throw Error(n(341));te.lanes|=g,L=te.alternate,L!==null&&(L.lanes|=g),Yx(te,g,c),te=null}else te=N.child;if(te!==null)te.return=N;else for(te=N;te!==null;){if(te===c){te=null;break}if(N=te.sibling,N!==null){N.return=te.return,te=N;break}te=te.return}N=te}}function Oc(c,u,g,v){c=null;for(var N=u,L=!1;N!==null;){if(!L){if((N.flags&524288)!==0)L=!0;else if((N.flags&262144)!==0)break}if(N.tag===10){var te=N.alternate;if(te===null)throw Error(n(387));if(te=te.memoizedProps,te!==null){var we=N.type;Ci(N.pendingProps.value,te.value)||(c!==null?c.push(we):c=[we])}}else if(N===ge.current){if(te=N.alternate,te===null)throw Error(n(387));te.memoizedState.memoizedState!==N.memoizedState.memoizedState&&(c!==null?c.push(Lu):c=[Lu])}N=N.return}c!==null&&Kx(u,c,g,v),u.flags|=262144}function fh(c){for(c=c.firstContext;c!==null;){if(!Ci(c.context._currentValue,c.memoizedValue))return!0;c=c.next}return!1}function zl(c){Ll=c,ta=null,c=c.dependencies,c!==null&&(c.firstContext=null)}function Rs(c){return y1(Ll,c)}function gh(c,u){return Ll===null&&zl(c),y1(c,u)}function y1(c,u){var g=u._currentValue;if(u={context:u,memoizedValue:g,next:null},ta===null){if(c===null)throw Error(n(308));ta=u,c.dependencies={lanes:0,firstContext:u},c.flags|=524288}else ta=ta.next=u;return g}var aD=typeof AbortController<"u"?AbortController:function(){var c=[],u=this.signal={aborted:!1,addEventListener:function(g,v){c.push(v)}};this.abort=function(){u.aborted=!0,c.forEach(function(g){return g()})}},lD=s.unstable_scheduleCallback,cD=s.unstable_NormalPriority,ss={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vx(){return{controller:new aD,data:new Map,refCount:0}}function du(c){c.refCount--,c.refCount===0&&lD(cD,function(){c.controller.abort()})}var uu=null,Xx=0,_c=0,Dc=null;function dD(c,u){if(uu===null){var g=uu=[];Xx=0,_c=Zm(),Dc={status:"pending",value:void 0,then:function(v){g.push(v)}}}return Xx++,u.then(b1,b1),u}function b1(){if(--Xx===0&&uu!==null){Dc!==null&&(Dc.status="fulfilled");var c=uu;uu=null,_c=0,Dc=null;for(var u=0;u<c.length;u++)(0,c[u])()}}function uD(c,u){var g=[],v={status:"pending",value:null,reason:null,then:function(N){g.push(N)}};return c.then(function(){v.status="fulfilled",v.value=u;for(var N=0;N<g.length;N++)(0,g[N])(u)},function(N){for(v.status="rejected",v.reason=N,N=0;N<g.length;N++)(0,g[N])(void 0)}),v}var v1=$.S;$.S=function(c,u){nw=Ee(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&dD(c,u),v1!==null&&v1(c,u)};var Ml=fe(null);function Jx(){var c=Ml.current;return c!==null?c:un.pooledCache}function xh(c,u){u===null?_(Ml,Ml.current):_(Ml,u.pool)}function S1(){var c=Jx();return c===null?null:{parent:ss._currentValue,pool:c}}var Ic=Error(n(460)),Qx=Error(n(474)),mh=Error(n(542)),yh={then:function(){}};function w1(c){return c=c.status,c==="fulfilled"||c==="rejected"}function E1(c,u,g){switch(g=c[g],g===void 0?c.push(u):g!==u&&(u.then(Jo,Jo),u=g),u.status){case"fulfilled":return u.value;case"rejected":throw c=u.reason,j1(c),c;default:if(typeof u.status=="string")u.then(Jo,Jo);else{if(c=un,c!==null&&100<c.shellSuspendCounter)throw Error(n(482));c=u,c.status="pending",c.then(function(v){if(u.status==="pending"){var N=u;N.status="fulfilled",N.value=v}},function(v){if(u.status==="pending"){var N=u;N.status="rejected",N.reason=v}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw c=u.reason,j1(c),c}throw Fl=u,Ic}}function Bl(c){try{var u=c._init;return u(c._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(Fl=g,Ic):g}}var Fl=null;function C1(){if(Fl===null)throw Error(n(459));var c=Fl;return Fl=null,c}function j1(c){if(c===Ic||c===mh)throw Error(n(483))}var Pc=null,pu=0;function bh(c){var u=pu;return pu+=1,Pc===null&&(Pc=[]),E1(Pc,c,u)}function hu(c,u){u=u.props.ref,c.ref=u!==void 0?u:null}function vh(c,u){throw u.$$typeof===x?Error(n(525)):(c=Object.prototype.toString.call(u),Error(n(31,c==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":c)))}function k1(c){function u(Xe,He){if(c){var rt=Xe.deletions;rt===null?(Xe.deletions=[He],Xe.flags|=16):rt.push(He)}}function g(Xe,He){if(!c)return null;for(;He!==null;)u(Xe,He),He=He.sibling;return null}function v(Xe){for(var He=new Map;Xe!==null;)Xe.key!==null?He.set(Xe.key,Xe):He.set(Xe.index,Xe),Xe=Xe.sibling;return He}function N(Xe,He){return Xe=Zo(Xe,He),Xe.index=0,Xe.sibling=null,Xe}function L(Xe,He,rt){return Xe.index=rt,c?(rt=Xe.alternate,rt!==null?(rt=rt.index,rt<He?(Xe.flags|=67108866,He):rt):(Xe.flags|=67108866,He)):(Xe.flags|=1048576,He)}function te(Xe){return c&&Xe.alternate===null&&(Xe.flags|=67108866),Xe}function we(Xe,He,rt,ft){return He===null||He.tag!==6?(He=Fx(rt,Xe.mode,ft),He.return=Xe,He):(He=N(He,rt),He.return=Xe,He)}function Fe(Xe,He,rt,ft){var qt=rt.type;return qt===w?dt(Xe,He,rt.props.children,ft,rt.key):He!==null&&(He.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===M&&Bl(qt)===He.type)?(He=N(He,rt.props),hu(He,rt),He.return=Xe,He):(He=ph(rt.type,rt.key,rt.props,null,Xe.mode,ft),hu(He,rt),He.return=Xe,He)}function nt(Xe,He,rt,ft){return He===null||He.tag!==4||He.stateNode.containerInfo!==rt.containerInfo||He.stateNode.implementation!==rt.implementation?(He=$x(rt,Xe.mode,ft),He.return=Xe,He):(He=N(He,rt.children||[]),He.return=Xe,He)}function dt(Xe,He,rt,ft,qt){return He===null||He.tag!==7?(He=Il(rt,Xe.mode,ft,qt),He.return=Xe,He):(He=N(He,rt),He.return=Xe,He)}function gt(Xe,He,rt){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return He=Fx(""+He,Xe.mode,rt),He.return=Xe,He;if(typeof He=="object"&&He!==null){switch(He.$$typeof){case m:return rt=ph(He.type,He.key,He.props,null,Xe.mode,rt),hu(rt,He),rt.return=Xe,rt;case b:return He=$x(He,Xe.mode,rt),He.return=Xe,He;case M:return He=Bl(He),gt(Xe,He,rt)}if(z(He)||G(He))return He=Il(He,Xe.mode,rt,null),He.return=Xe,He;if(typeof He.then=="function")return gt(Xe,bh(He),rt);if(He.$$typeof===E)return gt(Xe,gh(Xe,He),rt);vh(Xe,He)}return null}function st(Xe,He,rt,ft){var qt=He!==null?He.key:null;if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return qt!==null?null:we(Xe,He,""+rt,ft);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case m:return rt.key===qt?Fe(Xe,He,rt,ft):null;case b:return rt.key===qt?nt(Xe,He,rt,ft):null;case M:return rt=Bl(rt),st(Xe,He,rt,ft)}if(z(rt)||G(rt))return qt!==null?null:dt(Xe,He,rt,ft,null);if(typeof rt.then=="function")return st(Xe,He,bh(rt),ft);if(rt.$$typeof===E)return st(Xe,He,gh(Xe,rt),ft);vh(Xe,rt)}return null}function at(Xe,He,rt,ft,qt){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return Xe=Xe.get(rt)||null,we(He,Xe,""+ft,qt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case m:return Xe=Xe.get(ft.key===null?rt:ft.key)||null,Fe(He,Xe,ft,qt);case b:return Xe=Xe.get(ft.key===null?rt:ft.key)||null,nt(He,Xe,ft,qt);case M:return ft=Bl(ft),at(Xe,He,rt,ft,qt)}if(z(ft)||G(ft))return Xe=Xe.get(rt)||null,dt(He,Xe,ft,qt,null);if(typeof ft.then=="function")return at(Xe,He,rt,bh(ft),qt);if(ft.$$typeof===E)return at(Xe,He,rt,gh(He,ft),qt);vh(He,ft)}return null}function zt(Xe,He,rt,ft){for(var qt=null,qr=null,Gt=He,dr=He=0,kr=null;Gt!==null&&dr<rt.length;dr++){Gt.index>dr?(kr=Gt,Gt=null):kr=Gt.sibling;var Hr=st(Xe,Gt,rt[dr],ft);if(Hr===null){Gt===null&&(Gt=kr);break}c&&Gt&&Hr.alternate===null&&u(Xe,Gt),He=L(Hr,He,dr),qr===null?qt=Hr:qr.sibling=Hr,qr=Hr,Gt=kr}if(dr===rt.length)return g(Xe,Gt),Or&&ea(Xe,dr),qt;if(Gt===null){for(;dr<rt.length;dr++)Gt=gt(Xe,rt[dr],ft),Gt!==null&&(He=L(Gt,He,dr),qr===null?qt=Gt:qr.sibling=Gt,qr=Gt);return Or&&ea(Xe,dr),qt}for(Gt=v(Gt);dr<rt.length;dr++)kr=at(Gt,Xe,dr,rt[dr],ft),kr!==null&&(c&&kr.alternate!==null&&Gt.delete(kr.key===null?dr:kr.key),He=L(kr,He,dr),qr===null?qt=kr:qr.sibling=kr,qr=kr);return c&&Gt.forEach(function(Xa){return u(Xe,Xa)}),Or&&ea(Xe,dr),qt}function Kt(Xe,He,rt,ft){if(rt==null)throw Error(n(151));for(var qt=null,qr=null,Gt=He,dr=He=0,kr=null,Hr=rt.next();Gt!==null&&!Hr.done;dr++,Hr=rt.next()){Gt.index>dr?(kr=Gt,Gt=null):kr=Gt.sibling;var Xa=st(Xe,Gt,Hr.value,ft);if(Xa===null){Gt===null&&(Gt=kr);break}c&&Gt&&Xa.alternate===null&&u(Xe,Gt),He=L(Xa,He,dr),qr===null?qt=Xa:qr.sibling=Xa,qr=Xa,Gt=kr}if(Hr.done)return g(Xe,Gt),Or&&ea(Xe,dr),qt;if(Gt===null){for(;!Hr.done;dr++,Hr=rt.next())Hr=gt(Xe,Hr.value,ft),Hr!==null&&(He=L(Hr,He,dr),qr===null?qt=Hr:qr.sibling=Hr,qr=Hr);return Or&&ea(Xe,dr),qt}for(Gt=v(Gt);!Hr.done;dr++,Hr=rt.next())Hr=at(Gt,Xe,dr,Hr.value,ft),Hr!==null&&(c&&Hr.alternate!==null&&Gt.delete(Hr.key===null?dr:Hr.key),He=L(Hr,He,dr),qr===null?qt=Hr:qr.sibling=Hr,qr=Hr);return c&&Gt.forEach(function(wI){return u(Xe,wI)}),Or&&ea(Xe,dr),qt}function on(Xe,He,rt,ft){if(typeof rt=="object"&&rt!==null&&rt.type===w&&rt.key===null&&(rt=rt.props.children),typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case m:e:{for(var qt=rt.key;He!==null;){if(He.key===qt){if(qt=rt.type,qt===w){if(He.tag===7){g(Xe,He.sibling),ft=N(He,rt.props.children),ft.return=Xe,Xe=ft;break e}}else if(He.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===M&&Bl(qt)===He.type){g(Xe,He.sibling),ft=N(He,rt.props),hu(ft,rt),ft.return=Xe,Xe=ft;break e}g(Xe,He);break}else u(Xe,He);He=He.sibling}rt.type===w?(ft=Il(rt.props.children,Xe.mode,ft,rt.key),ft.return=Xe,Xe=ft):(ft=ph(rt.type,rt.key,rt.props,null,Xe.mode,ft),hu(ft,rt),ft.return=Xe,Xe=ft)}return te(Xe);case b:e:{for(qt=rt.key;He!==null;){if(He.key===qt)if(He.tag===4&&He.stateNode.containerInfo===rt.containerInfo&&He.stateNode.implementation===rt.implementation){g(Xe,He.sibling),ft=N(He,rt.children||[]),ft.return=Xe,Xe=ft;break e}else{g(Xe,He);break}else u(Xe,He);He=He.sibling}ft=$x(rt,Xe.mode,ft),ft.return=Xe,Xe=ft}return te(Xe);case M:return rt=Bl(rt),on(Xe,He,rt,ft)}if(z(rt))return zt(Xe,He,rt,ft);if(G(rt)){if(qt=G(rt),typeof qt!="function")throw Error(n(150));return rt=qt.call(rt),Kt(Xe,He,rt,ft)}if(typeof rt.then=="function")return on(Xe,He,bh(rt),ft);if(rt.$$typeof===E)return on(Xe,He,gh(Xe,rt),ft);vh(Xe,rt)}return typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint"?(rt=""+rt,He!==null&&He.tag===6?(g(Xe,He.sibling),ft=N(He,rt),ft.return=Xe,Xe=ft):(g(Xe,He),ft=Fx(rt,Xe.mode,ft),ft.return=Xe,Xe=ft),te(Xe)):g(Xe,He)}return function(Xe,He,rt,ft){try{pu=0;var qt=on(Xe,He,rt,ft);return Pc=null,qt}catch(Gt){if(Gt===Ic||Gt===mh)throw Gt;var qr=ji(29,Gt,null,Xe.mode);return qr.lanes=ft,qr.return=Xe,qr}}}var $l=k1(!0),A1=k1(!1),Da=!1;function Zx(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function em(c,u){c=c.updateQueue,u.updateQueue===c&&(u.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,callbacks:null})}function Ia(c){return{lane:c,tag:0,payload:null,callback:null,next:null}}function Pa(c,u,g){var v=c.updateQueue;if(v===null)return null;if(v=v.shared,(Xr&2)!==0){var N=v.pending;return N===null?u.next=u:(u.next=N.next,N.next=u),v.pending=u,u=uh(c),d1(c,null,g),u}return dh(c,v,u,g),uh(c)}function fu(c,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194048)!==0)){var v=u.lanes;v&=c.pendingLanes,g|=v,u.lanes=g,yt(c,g)}}function tm(c,u){var g=c.updateQueue,v=c.alternate;if(v!==null&&(v=v.updateQueue,g===v)){var N=null,L=null;if(g=g.firstBaseUpdate,g!==null){do{var te={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};L===null?N=L=te:L=L.next=te,g=g.next}while(g!==null);L===null?N=L=u:L=L.next=u}else N=L=u;g={baseState:v.baseState,firstBaseUpdate:N,lastBaseUpdate:L,shared:v.shared,callbacks:v.callbacks},c.updateQueue=g;return}c=g.lastBaseUpdate,c===null?g.firstBaseUpdate=u:c.next=u,g.lastBaseUpdate=u}var rm=!1;function gu(){if(rm){var c=Dc;if(c!==null)throw c}}function xu(c,u,g,v){rm=!1;var N=c.updateQueue;Da=!1;var L=N.firstBaseUpdate,te=N.lastBaseUpdate,we=N.shared.pending;if(we!==null){N.shared.pending=null;var Fe=we,nt=Fe.next;Fe.next=null,te===null?L=nt:te.next=nt,te=Fe;var dt=c.alternate;dt!==null&&(dt=dt.updateQueue,we=dt.lastBaseUpdate,we!==te&&(we===null?dt.firstBaseUpdate=nt:we.next=nt,dt.lastBaseUpdate=Fe))}if(L!==null){var gt=N.baseState;te=0,dt=nt=Fe=null,we=L;do{var st=we.lane&-536870913,at=st!==we.lane;if(at?(jr&st)===st:(v&st)===st){st!==0&&st===_c&&(rm=!0),dt!==null&&(dt=dt.next={lane:0,tag:we.tag,payload:we.payload,callback:null,next:null});e:{var zt=c,Kt=we;st=u;var on=g;switch(Kt.tag){case 1:if(zt=Kt.payload,typeof zt=="function"){gt=zt.call(on,gt,st);break e}gt=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=Kt.payload,st=typeof zt=="function"?zt.call(on,gt,st):zt,st==null)break e;gt=h({},gt,st);break e;case 2:Da=!0}}st=we.callback,st!==null&&(c.flags|=64,at&&(c.flags|=8192),at=N.callbacks,at===null?N.callbacks=[st]:at.push(st))}else at={lane:st,tag:we.tag,payload:we.payload,callback:we.callback,next:null},dt===null?(nt=dt=at,Fe=gt):dt=dt.next=at,te|=st;if(we=we.next,we===null){if(we=N.shared.pending,we===null)break;at=we,we=at.next,at.next=null,N.lastBaseUpdate=at,N.shared.pending=null}}while(!0);dt===null&&(Fe=gt),N.baseState=Fe,N.firstBaseUpdate=nt,N.lastBaseUpdate=dt,L===null&&(N.shared.lanes=0),Fa|=te,c.lanes=te,c.memoizedState=gt}}function T1(c,u){if(typeof c!="function")throw Error(n(191,c));c.call(u)}function R1(c,u){var g=c.callbacks;if(g!==null)for(c.callbacks=null,c=0;c<g.length;c++)T1(g[c],u)}var Lc=fe(null),Sh=fe(0);function N1(c,u){c=ua,_(Sh,c),_(Lc,u),ua=c|u.baseLanes}function nm(){_(Sh,ua),_(Lc,Lc.current)}function sm(){ua=Sh.current,Q(Lc),Q(Sh)}var ki=fe(null),Hi=null;function La(c){var u=c.alternate;_(Kn,Kn.current&1),_(ki,c),Hi===null&&(u===null||Lc.current!==null||u.memoizedState!==null)&&(Hi=c)}function im(c){_(Kn,Kn.current),_(ki,c),Hi===null&&(Hi=c)}function O1(c){c.tag===22?(_(Kn,Kn.current),_(ki,c),Hi===null&&(Hi=c)):za()}function za(){_(Kn,Kn.current),_(ki,ki.current)}function Ai(c){Q(ki),Hi===c&&(Hi=null),Q(Kn)}var Kn=fe(0);function wh(c){for(var u=c;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||uy(g)||py(g)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===c)break;for(;u.sibling===null;){if(u.return===null||u.return===c)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var na=0,ar=null,nn=null,is=null,Eh=!1,zc=!1,Gl=!1,Ch=0,mu=0,Mc=null,pD=0;function Gn(){throw Error(n(321))}function om(c,u){if(u===null)return!1;for(var g=0;g<u.length&&g<c.length;g++)if(!Ci(c[g],u[g]))return!1;return!0}function am(c,u,g,v,N,L){return na=L,ar=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,$.H=c===null||c.memoizedState===null?fS:wm,Gl=!1,L=g(v,N),Gl=!1,zc&&(L=D1(u,g,v,N)),_1(c),L}function _1(c){$.H=vu;var u=nn!==null&&nn.next!==null;if(na=0,is=nn=ar=null,Eh=!1,mu=0,Mc=null,u)throw Error(n(300));c===null||os||(c=c.dependencies,c!==null&&fh(c)&&(os=!0))}function D1(c,u,g,v){ar=c;var N=0;do{if(zc&&(Mc=null),mu=0,zc=!1,25<=N)throw Error(n(301));if(N+=1,is=nn=null,c.updateQueue!=null){var L=c.updateQueue;L.lastEffect=null,L.events=null,L.stores=null,L.memoCache!=null&&(L.memoCache.index=0)}$.H=gS,L=u(g,v)}while(zc);return L}function hD(){var c=$.H,u=c.useState()[0];return u=typeof u.then=="function"?yu(u):u,c=c.useState()[0],(nn!==null?nn.memoizedState:null)!==c&&(ar.flags|=1024),u}function lm(){var c=Ch!==0;return Ch=0,c}function cm(c,u,g){u.updateQueue=c.updateQueue,u.flags&=-2053,c.lanes&=~g}function dm(c){if(Eh){for(c=c.memoizedState;c!==null;){var u=c.queue;u!==null&&(u.pending=null),c=c.next}Eh=!1}na=0,is=nn=ar=null,zc=!1,mu=Ch=0,Mc=null}function Js(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?ar.memoizedState=is=c:is=is.next=c,is}function Vn(){if(nn===null){var c=ar.alternate;c=c!==null?c.memoizedState:null}else c=nn.next;var u=is===null?ar.memoizedState:is.next;if(u!==null)is=u,nn=c;else{if(c===null)throw ar.alternate===null?Error(n(467)):Error(n(310));nn=c,c={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},is===null?ar.memoizedState=is=c:is=is.next=c}return is}function jh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yu(c){var u=mu;return mu+=1,Mc===null&&(Mc=[]),c=E1(Mc,c,u),u=ar,(is===null?u.memoizedState:is.next)===null&&(u=u.alternate,$.H=u===null||u.memoizedState===null?fS:wm),c}function kh(c){if(c!==null&&typeof c=="object"){if(typeof c.then=="function")return yu(c);if(c.$$typeof===E)return Rs(c)}throw Error(n(438,String(c)))}function um(c){var u=null,g=ar.updateQueue;if(g!==null&&(u=g.memoCache),u==null){var v=ar.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(u={data:v.data.map(function(N){return N.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),g===null&&(g=jh(),ar.updateQueue=g),g.memoCache=u,g=u.data[u.index],g===void 0)for(g=u.data[u.index]=Array(c),v=0;v<c;v++)g[v]=I;return u.index++,g}function sa(c,u){return typeof u=="function"?u(c):u}function Ah(c){var u=Vn();return pm(u,nn,c)}function pm(c,u,g){var v=c.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=g;var N=c.baseQueue,L=v.pending;if(L!==null){if(N!==null){var te=N.next;N.next=L.next,L.next=te}u.baseQueue=N=L,v.pending=null}if(L=c.baseState,N===null)c.memoizedState=L;else{u=N.next;var we=te=null,Fe=null,nt=u,dt=!1;do{var gt=nt.lane&-536870913;if(gt!==nt.lane?(jr&gt)===gt:(na&gt)===gt){var st=nt.revertLane;if(st===0)Fe!==null&&(Fe=Fe.next={lane:0,revertLane:0,gesture:null,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),gt===_c&&(dt=!0);else if((na&st)===st){nt=nt.next,st===_c&&(dt=!0);continue}else gt={lane:0,revertLane:nt.revertLane,gesture:null,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},Fe===null?(we=Fe=gt,te=L):Fe=Fe.next=gt,ar.lanes|=st,Fa|=st;gt=nt.action,Gl&&g(L,gt),L=nt.hasEagerState?nt.eagerState:g(L,gt)}else st={lane:gt,revertLane:nt.revertLane,gesture:nt.gesture,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null},Fe===null?(we=Fe=st,te=L):Fe=Fe.next=st,ar.lanes|=gt,Fa|=gt;nt=nt.next}while(nt!==null&&nt!==u);if(Fe===null?te=L:Fe.next=we,!Ci(L,c.memoizedState)&&(os=!0,dt&&(g=Dc,g!==null)))throw g;c.memoizedState=L,c.baseState=te,c.baseQueue=Fe,v.lastRenderedState=L}return N===null&&(v.lanes=0),[c.memoizedState,v.dispatch]}function hm(c){var u=Vn(),g=u.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=c;var v=g.dispatch,N=g.pending,L=u.memoizedState;if(N!==null){g.pending=null;var te=N=N.next;do L=c(L,te.action),te=te.next;while(te!==N);Ci(L,u.memoizedState)||(os=!0),u.memoizedState=L,u.baseQueue===null&&(u.baseState=L),g.lastRenderedState=L}return[L,v]}function I1(c,u,g){var v=ar,N=Vn(),L=Or;if(L){if(g===void 0)throw Error(n(407));g=g()}else g=u();var te=!Ci((nn||N).memoizedState,g);if(te&&(N.memoizedState=g,os=!0),N=N.queue,xm(z1.bind(null,v,N,c),[c]),N.getSnapshot!==u||te||is!==null&&is.memoizedState.tag&1){if(v.flags|=2048,Bc(9,{destroy:void 0},L1.bind(null,v,N,g,u),null),un===null)throw Error(n(349));L||(na&127)!==0||P1(v,u,g)}return g}function P1(c,u,g){c.flags|=16384,c={getSnapshot:u,value:g},u=ar.updateQueue,u===null?(u=jh(),ar.updateQueue=u,u.stores=[c]):(g=u.stores,g===null?u.stores=[c]:g.push(c))}function L1(c,u,g,v){u.value=g,u.getSnapshot=v,M1(u)&&B1(c)}function z1(c,u,g){return g(function(){M1(u)&&B1(c)})}function M1(c){var u=c.getSnapshot;c=c.value;try{var g=u();return!Ci(c,g)}catch{return!0}}function B1(c){var u=Dl(c,2);u!==null&&pi(u,c,2)}function fm(c){var u=Js();if(typeof c=="function"){var g=c;if(c=g(),Gl){Me(!0);try{g()}finally{Me(!1)}}}return u.memoizedState=u.baseState=c,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:c},u}function F1(c,u,g,v){return c.baseState=g,pm(c,nn,typeof v=="function"?v:sa)}function fD(c,u,g,v,N){if(Nh(c))throw Error(n(485));if(c=u.action,c!==null){var L={payload:N,action:c,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(te){L.listeners.push(te)}};$.T!==null?g(!0):L.isTransition=!1,v(L),g=u.pending,g===null?(L.next=u.pending=L,$1(u,L)):(L.next=g.next,u.pending=g.next=L)}}function $1(c,u){var g=u.action,v=u.payload,N=c.state;if(u.isTransition){var L=$.T,te={};$.T=te;try{var we=g(N,v),Fe=$.S;Fe!==null&&Fe(te,we),G1(c,u,we)}catch(nt){gm(c,u,nt)}finally{L!==null&&te.types!==null&&(L.types=te.types),$.T=L}}else try{L=g(N,v),G1(c,u,L)}catch(nt){gm(c,u,nt)}}function G1(c,u,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(v){U1(c,u,v)},function(v){return gm(c,u,v)}):U1(c,u,g)}function U1(c,u,g){u.status="fulfilled",u.value=g,W1(u),c.state=g,u=c.pending,u!==null&&(g=u.next,g===u?c.pending=null:(g=g.next,u.next=g,$1(c,g)))}function gm(c,u,g){var v=c.pending;if(c.pending=null,v!==null){v=v.next;do u.status="rejected",u.reason=g,W1(u),u=u.next;while(u!==v)}c.action=null}function W1(c){c=c.listeners;for(var u=0;u<c.length;u++)(0,c[u])()}function q1(c,u){return u}function H1(c,u){if(Or){var g=un.formState;if(g!==null){e:{var v=ar;if(Or){if(jn){t:{for(var N=jn,L=qi;N.nodeType!==8;){if(!L){N=null;break t}if(N=Yi(N.nextSibling),N===null){N=null;break t}}L=N.data,N=L==="F!"||L==="F"?N:null}if(N){jn=Yi(N.nextSibling),v=N.data==="F!";break e}}Oa(v)}v=!1}v&&(u=g[0])}}return g=Js(),g.memoizedState=g.baseState=u,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:q1,lastRenderedState:u},g.queue=v,g=uS.bind(null,ar,v),v.dispatch=g,v=fm(!1),L=Sm.bind(null,ar,!1,v.queue),v=Js(),N={state:u,dispatch:null,action:c,pending:null},v.queue=N,g=fD.bind(null,ar,N,L,g),N.dispatch=g,v.memoizedState=c,[u,g,!1]}function Y1(c){var u=Vn();return K1(u,nn,c)}function K1(c,u,g){if(u=pm(c,u,q1)[0],c=Ah(sa)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var v=yu(u)}catch(te){throw te===Ic?mh:te}else v=u;u=Vn();var N=u.queue,L=N.dispatch;return g!==u.memoizedState&&(ar.flags|=2048,Bc(9,{destroy:void 0},gD.bind(null,N,g),null)),[v,L,c]}function gD(c,u){c.action=u}function V1(c){var u=Vn(),g=nn;if(g!==null)return K1(u,g,c);Vn(),u=u.memoizedState,g=Vn();var v=g.queue.dispatch;return g.memoizedState=c,[u,v,!1]}function Bc(c,u,g,v){return c={tag:c,create:g,deps:v,inst:u,next:null},u=ar.updateQueue,u===null&&(u=jh(),ar.updateQueue=u),g=u.lastEffect,g===null?u.lastEffect=c.next=c:(v=g.next,g.next=c,c.next=v,u.lastEffect=c),c}function X1(){return Vn().memoizedState}function Th(c,u,g,v){var N=Js();ar.flags|=c,N.memoizedState=Bc(1|u,{destroy:void 0},g,v===void 0?null:v)}function Rh(c,u,g,v){var N=Vn();v=v===void 0?null:v;var L=N.memoizedState.inst;nn!==null&&v!==null&&om(v,nn.memoizedState.deps)?N.memoizedState=Bc(u,L,g,v):(ar.flags|=c,N.memoizedState=Bc(1|u,L,g,v))}function J1(c,u){Th(8390656,8,c,u)}function xm(c,u){Rh(2048,8,c,u)}function xD(c){ar.flags|=4;var u=ar.updateQueue;if(u===null)u=jh(),ar.updateQueue=u,u.events=[c];else{var g=u.events;g===null?u.events=[c]:g.push(c)}}function Q1(c){var u=Vn().memoizedState;return xD({ref:u,nextImpl:c}),function(){if((Xr&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}function Z1(c,u){return Rh(4,2,c,u)}function eS(c,u){return Rh(4,4,c,u)}function tS(c,u){if(typeof u=="function"){c=c();var g=u(c);return function(){typeof g=="function"?g():u(null)}}if(u!=null)return c=c(),u.current=c,function(){u.current=null}}function rS(c,u,g){g=g!=null?g.concat([c]):null,Rh(4,4,tS.bind(null,u,c),g)}function mm(){}function nS(c,u){var g=Vn();u=u===void 0?null:u;var v=g.memoizedState;return u!==null&&om(u,v[1])?v[0]:(g.memoizedState=[c,u],c)}function sS(c,u){var g=Vn();u=u===void 0?null:u;var v=g.memoizedState;if(u!==null&&om(u,v[1]))return v[0];if(v=c(),Gl){Me(!0);try{c()}finally{Me(!1)}}return g.memoizedState=[v,u],v}function ym(c,u,g){return g===void 0||(na&1073741824)!==0&&(jr&261930)===0?c.memoizedState=u:(c.memoizedState=g,c=iw(),ar.lanes|=c,Fa|=c,g)}function iS(c,u,g,v){return Ci(g,u)?g:Lc.current!==null?(c=ym(c,g,v),Ci(c,u)||(os=!0),c):(na&42)===0||(na&1073741824)!==0&&(jr&261930)===0?(os=!0,c.memoizedState=g):(c=iw(),ar.lanes|=c,Fa|=c,u)}function oS(c,u,g,v,N){var L=W.p;W.p=L!==0&&8>L?L:8;var te=$.T,we={};$.T=we,Sm(c,!1,u,g);try{var Fe=N(),nt=$.S;if(nt!==null&&nt(we,Fe),Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var dt=uD(Fe,v);bu(c,u,dt,Ni(c))}else bu(c,u,v,Ni(c))}catch(gt){bu(c,u,{then:function(){},status:"rejected",reason:gt},Ni())}finally{W.p=L,te!==null&&we.types!==null&&(te.types=we.types),$.T=te}}function mD(){}function bm(c,u,g,v){if(c.tag!==5)throw Error(n(476));var N=aS(c).queue;oS(c,N,u,D,g===null?mD:function(){return lS(c),g(v)})}function aS(c){var u=c.memoizedState;if(u!==null)return u;u={memoizedState:D,baseState:D,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:D},next:null};var g={};return u.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:g},next:null},c.memoizedState=u,c=c.alternate,c!==null&&(c.memoizedState=u),u}function lS(c){var u=aS(c);u.next===null&&(u=c.alternate.memoizedState),bu(c,u.next.queue,{},Ni())}function vm(){return Rs(Lu)}function cS(){return Vn().memoizedState}function dS(){return Vn().memoizedState}function yD(c){for(var u=c.return;u!==null;){switch(u.tag){case 24:case 3:var g=Ni();c=Ia(g);var v=Pa(u,c,g);v!==null&&(pi(v,u,g),fu(v,u,g)),u={cache:Vx()},c.payload=u;return}u=u.return}}function bD(c,u,g){var v=Ni();g={lane:v,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Nh(c)?pS(u,g):(g=Mx(c,u,g,v),g!==null&&(pi(g,c,v),hS(g,u,v)))}function uS(c,u,g){var v=Ni();bu(c,u,g,v)}function bu(c,u,g,v){var N={lane:v,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(Nh(c))pS(u,N);else{var L=c.alternate;if(c.lanes===0&&(L===null||L.lanes===0)&&(L=u.lastRenderedReducer,L!==null))try{var te=u.lastRenderedState,we=L(te,g);if(N.hasEagerState=!0,N.eagerState=we,Ci(we,te))return dh(c,u,N,0),un===null&&ch(),!1}catch{}if(g=Mx(c,u,N,v),g!==null)return pi(g,c,v),hS(g,u,v),!0}return!1}function Sm(c,u,g,v){if(v={lane:2,revertLane:Zm(),gesture:null,action:v,hasEagerState:!1,eagerState:null,next:null},Nh(c)){if(u)throw Error(n(479))}else u=Mx(c,g,v,2),u!==null&&pi(u,c,2)}function Nh(c){var u=c.alternate;return c===ar||u!==null&&u===ar}function pS(c,u){zc=Eh=!0;var g=c.pending;g===null?u.next=u:(u.next=g.next,g.next=u),c.pending=u}function hS(c,u,g){if((g&4194048)!==0){var v=u.lanes;v&=c.pendingLanes,g|=v,u.lanes=g,yt(c,g)}}var vu={readContext:Rs,use:kh,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useLayoutEffect:Gn,useInsertionEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useSyncExternalStore:Gn,useId:Gn,useHostTransitionStatus:Gn,useFormState:Gn,useActionState:Gn,useOptimistic:Gn,useMemoCache:Gn,useCacheRefresh:Gn};vu.useEffectEvent=Gn;var fS={readContext:Rs,use:kh,useCallback:function(c,u){return Js().memoizedState=[c,u===void 0?null:u],c},useContext:Rs,useEffect:J1,useImperativeHandle:function(c,u,g){g=g!=null?g.concat([c]):null,Th(4194308,4,tS.bind(null,u,c),g)},useLayoutEffect:function(c,u){return Th(4194308,4,c,u)},useInsertionEffect:function(c,u){Th(4,2,c,u)},useMemo:function(c,u){var g=Js();u=u===void 0?null:u;var v=c();if(Gl){Me(!0);try{c()}finally{Me(!1)}}return g.memoizedState=[v,u],v},useReducer:function(c,u,g){var v=Js();if(g!==void 0){var N=g(u);if(Gl){Me(!0);try{g(u)}finally{Me(!1)}}}else N=u;return v.memoizedState=v.baseState=N,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:N},v.queue=c,c=c.dispatch=bD.bind(null,ar,c),[v.memoizedState,c]},useRef:function(c){var u=Js();return c={current:c},u.memoizedState=c},useState:function(c){c=fm(c);var u=c.queue,g=uS.bind(null,ar,u);return u.dispatch=g,[c.memoizedState,g]},useDebugValue:mm,useDeferredValue:function(c,u){var g=Js();return ym(g,c,u)},useTransition:function(){var c=fm(!1);return c=oS.bind(null,ar,c.queue,!0,!1),Js().memoizedState=c,[!1,c]},useSyncExternalStore:function(c,u,g){var v=ar,N=Js();if(Or){if(g===void 0)throw Error(n(407));g=g()}else{if(g=u(),un===null)throw Error(n(349));(jr&127)!==0||P1(v,u,g)}N.memoizedState=g;var L={value:g,getSnapshot:u};return N.queue=L,J1(z1.bind(null,v,L,c),[c]),v.flags|=2048,Bc(9,{destroy:void 0},L1.bind(null,v,L,g,u),null),g},useId:function(){var c=Js(),u=un.identifierPrefix;if(Or){var g=No,v=Ro;g=(v&~(1<<32-Qe(v)-1)).toString(32)+g,u="_"+u+"R_"+g,g=Ch++,0<g&&(u+="H"+g.toString(32)),u+="_"}else g=pD++,u="_"+u+"r_"+g.toString(32)+"_";return c.memoizedState=u},useHostTransitionStatus:vm,useFormState:H1,useActionState:H1,useOptimistic:function(c){var u=Js();u.memoizedState=u.baseState=c;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=g,u=Sm.bind(null,ar,!0,g),g.dispatch=u,[c,u]},useMemoCache:um,useCacheRefresh:function(){return Js().memoizedState=yD.bind(null,ar)},useEffectEvent:function(c){var u=Js(),g={impl:c};return u.memoizedState=g,function(){if((Xr&2)!==0)throw Error(n(440));return g.impl.apply(void 0,arguments)}}},wm={readContext:Rs,use:kh,useCallback:nS,useContext:Rs,useEffect:xm,useImperativeHandle:rS,useInsertionEffect:Z1,useLayoutEffect:eS,useMemo:sS,useReducer:Ah,useRef:X1,useState:function(){return Ah(sa)},useDebugValue:mm,useDeferredValue:function(c,u){var g=Vn();return iS(g,nn.memoizedState,c,u)},useTransition:function(){var c=Ah(sa)[0],u=Vn().memoizedState;return[typeof c=="boolean"?c:yu(c),u]},useSyncExternalStore:I1,useId:cS,useHostTransitionStatus:vm,useFormState:Y1,useActionState:Y1,useOptimistic:function(c,u){var g=Vn();return F1(g,nn,c,u)},useMemoCache:um,useCacheRefresh:dS};wm.useEffectEvent=Q1;var gS={readContext:Rs,use:kh,useCallback:nS,useContext:Rs,useEffect:xm,useImperativeHandle:rS,useInsertionEffect:Z1,useLayoutEffect:eS,useMemo:sS,useReducer:hm,useRef:X1,useState:function(){return hm(sa)},useDebugValue:mm,useDeferredValue:function(c,u){var g=Vn();return nn===null?ym(g,c,u):iS(g,nn.memoizedState,c,u)},useTransition:function(){var c=hm(sa)[0],u=Vn().memoizedState;return[typeof c=="boolean"?c:yu(c),u]},useSyncExternalStore:I1,useId:cS,useHostTransitionStatus:vm,useFormState:V1,useActionState:V1,useOptimistic:function(c,u){var g=Vn();return nn!==null?F1(g,nn,c,u):(g.baseState=c,[c,g.queue.dispatch])},useMemoCache:um,useCacheRefresh:dS};gS.useEffectEvent=Q1;function Em(c,u,g,v){u=c.memoizedState,g=g(v,u),g=g==null?u:h({},u,g),c.memoizedState=g,c.lanes===0&&(c.updateQueue.baseState=g)}var Cm={enqueueSetState:function(c,u,g){c=c._reactInternals;var v=Ni(),N=Ia(v);N.payload=u,g!=null&&(N.callback=g),u=Pa(c,N,v),u!==null&&(pi(u,c,v),fu(u,c,v))},enqueueReplaceState:function(c,u,g){c=c._reactInternals;var v=Ni(),N=Ia(v);N.tag=1,N.payload=u,g!=null&&(N.callback=g),u=Pa(c,N,v),u!==null&&(pi(u,c,v),fu(u,c,v))},enqueueForceUpdate:function(c,u){c=c._reactInternals;var g=Ni(),v=Ia(g);v.tag=2,u!=null&&(v.callback=u),u=Pa(c,v,g),u!==null&&(pi(u,c,g),fu(u,c,g))}};function xS(c,u,g,v,N,L,te){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(v,L,te):u.prototype&&u.prototype.isPureReactComponent?!ou(g,v)||!ou(N,L):!0}function mS(c,u,g,v){c=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,v),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,v),u.state!==c&&Cm.enqueueReplaceState(u,u.state,null)}function Ul(c,u){var g=u;if("ref"in u){g={};for(var v in u)v!=="ref"&&(g[v]=u[v])}if(c=c.defaultProps){g===u&&(g=h({},g));for(var N in c)g[N]===void 0&&(g[N]=c[N])}return g}function yS(c){lh(c)}function bS(c){console.error(c)}function vS(c){lh(c)}function Oh(c,u){try{var g=c.onUncaughtError;g(u.value,{componentStack:u.stack})}catch(v){setTimeout(function(){throw v})}}function SS(c,u,g){try{var v=c.onCaughtError;v(g.value,{componentStack:g.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(N){setTimeout(function(){throw N})}}function jm(c,u,g){return g=Ia(g),g.tag=3,g.payload={element:null},g.callback=function(){Oh(c,u)},g}function wS(c){return c=Ia(c),c.tag=3,c}function ES(c,u,g,v){var N=g.type.getDerivedStateFromError;if(typeof N=="function"){var L=v.value;c.payload=function(){return N(L)},c.callback=function(){SS(u,g,v)}}var te=g.stateNode;te!==null&&typeof te.componentDidCatch=="function"&&(c.callback=function(){SS(u,g,v),typeof N!="function"&&($a===null?$a=new Set([this]):$a.add(this));var we=v.stack;this.componentDidCatch(v.value,{componentStack:we!==null?we:""})})}function vD(c,u,g,v,N){if(g.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(u=g.alternate,u!==null&&Oc(u,g,N,!0),g=ki.current,g!==null){switch(g.tag){case 31:case 13:return Hi===null?Uh():g.alternate===null&&Un===0&&(Un=3),g.flags&=-257,g.flags|=65536,g.lanes=N,v===yh?g.flags|=16384:(u=g.updateQueue,u===null?g.updateQueue=new Set([v]):u.add(v),Xm(c,v,N)),!1;case 22:return g.flags|=65536,v===yh?g.flags|=16384:(u=g.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([v])},g.updateQueue=u):(g=u.retryQueue,g===null?u.retryQueue=new Set([v]):g.add(v)),Xm(c,v,N)),!1}throw Error(n(435,g.tag))}return Xm(c,v,N),Uh(),!1}if(Or)return u=ki.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=N,v!==Wx&&(c=Error(n(422),{cause:v}),cu(Gi(c,g)))):(v!==Wx&&(u=Error(n(423),{cause:v}),cu(Gi(u,g))),c=c.current.alternate,c.flags|=65536,N&=-N,c.lanes|=N,v=Gi(v,g),N=jm(c.stateNode,v,N),tm(c,N),Un!==4&&(Un=2)),!1;var L=Error(n(520),{cause:v});if(L=Gi(L,g),Tu===null?Tu=[L]:Tu.push(L),Un!==4&&(Un=2),u===null)return!0;v=Gi(v,g),g=u;do{switch(g.tag){case 3:return g.flags|=65536,c=N&-N,g.lanes|=c,c=jm(g.stateNode,v,c),tm(g,c),!1;case 1:if(u=g.type,L=g.stateNode,(g.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&($a===null||!$a.has(L))))return g.flags|=65536,N&=-N,g.lanes|=N,N=wS(N),ES(N,c,g,v),tm(g,N),!1}g=g.return}while(g!==null);return!1}var km=Error(n(461)),os=!1;function Ns(c,u,g,v){u.child=c===null?A1(u,null,g,v):$l(u,c.child,g,v)}function CS(c,u,g,v,N){g=g.render;var L=u.ref;if("ref"in v){var te={};for(var we in v)we!=="ref"&&(te[we]=v[we])}else te=v;return zl(u),v=am(c,u,g,te,L,N),we=lm(),c!==null&&!os?(cm(c,u,N),ia(c,u,N)):(Or&&we&&Gx(u),u.flags|=1,Ns(c,u,v,N),u.child)}function jS(c,u,g,v,N){if(c===null){var L=g.type;return typeof L=="function"&&!Bx(L)&&L.defaultProps===void 0&&g.compare===null?(u.tag=15,u.type=L,kS(c,u,L,v,N)):(c=ph(g.type,null,v,u,u.mode,N),c.ref=u.ref,c.return=u,u.child=c)}if(L=c.child,!Im(c,N)){var te=L.memoizedProps;if(g=g.compare,g=g!==null?g:ou,g(te,v)&&c.ref===u.ref)return ia(c,u,N)}return u.flags|=1,c=Zo(L,v),c.ref=u.ref,c.return=u,u.child=c}function kS(c,u,g,v,N){if(c!==null){var L=c.memoizedProps;if(ou(L,v)&&c.ref===u.ref)if(os=!1,u.pendingProps=v=L,Im(c,N))(c.flags&131072)!==0&&(os=!0);else return u.lanes=c.lanes,ia(c,u,N)}return Am(c,u,g,v,N)}function AS(c,u,g,v){var N=v.children,L=c!==null?c.memoizedState:null;if(c===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),v.mode==="hidden"){if((u.flags&128)!==0){if(L=L!==null?L.baseLanes|g:g,c!==null){for(v=u.child=c.child,N=0;v!==null;)N=N|v.lanes|v.childLanes,v=v.sibling;v=N&~L}else v=0,u.child=null;return TS(c,u,L,g,v)}if((g&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},c!==null&&xh(u,L!==null?L.cachePool:null),L!==null?N1(u,L):nm(),O1(u);else return v=u.lanes=536870912,TS(c,u,L!==null?L.baseLanes|g:g,g,v)}else L!==null?(xh(u,L.cachePool),N1(u,L),za(),u.memoizedState=null):(c!==null&&xh(u,null),nm(),za());return Ns(c,u,N,g),u.child}function Su(c,u){return c!==null&&c.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function TS(c,u,g,v,N){var L=Jx();return L=L===null?null:{parent:ss._currentValue,pool:L},u.memoizedState={baseLanes:g,cachePool:L},c!==null&&xh(u,null),nm(),O1(u),c!==null&&Oc(c,u,v,!0),u.childLanes=N,null}function _h(c,u){return u=Ih({mode:u.mode,children:u.children},c.mode),u.ref=c.ref,c.child=u,u.return=c,u}function RS(c,u,g){return $l(u,c.child,null,g),c=_h(u,u.pendingProps),c.flags|=2,Ai(u),u.memoizedState=null,c}function SD(c,u,g){var v=u.pendingProps,N=(u.flags&128)!==0;if(u.flags&=-129,c===null){if(Or){if(v.mode==="hidden")return c=_h(u,v),u.lanes=536870912,Su(null,c);if(im(u),(c=jn)?(c=$w(c,qi),c=c!==null&&c.data==="&"?c:null,c!==null&&(u.memoizedState={dehydrated:c,treeContext:Ra!==null?{id:Ro,overflow:No}:null,retryLane:536870912,hydrationErrors:null},g=p1(c),g.return=u,u.child=g,Ts=u,jn=null)):c=null,c===null)throw Oa(u);return u.lanes=536870912,null}return _h(u,v)}var L=c.memoizedState;if(L!==null){var te=L.dehydrated;if(im(u),N)if(u.flags&256)u.flags&=-257,u=RS(c,u,g);else if(u.memoizedState!==null)u.child=c.child,u.flags|=128,u=null;else throw Error(n(558));else if(os||Oc(c,u,g,!1),N=(g&c.childLanes)!==0,os||N){if(v=un,v!==null&&(te=Pt(v,g),te!==0&&te!==L.retryLane))throw L.retryLane=te,Dl(c,te),pi(v,c,te),km;Uh(),u=RS(c,u,g)}else c=L.treeContext,jn=Yi(te.nextSibling),Ts=u,Or=!0,Na=null,qi=!1,c!==null&&g1(u,c),u=_h(u,v),u.flags|=4096;return u}return c=Zo(c.child,{mode:v.mode,children:v.children}),c.ref=u.ref,u.child=c,c.return=u,c}function Dh(c,u){var g=u.ref;if(g===null)c!==null&&c.ref!==null&&(u.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(n(284));(c===null||c.ref!==g)&&(u.flags|=4194816)}}function Am(c,u,g,v,N){return zl(u),g=am(c,u,g,v,void 0,N),v=lm(),c!==null&&!os?(cm(c,u,N),ia(c,u,N)):(Or&&v&&Gx(u),u.flags|=1,Ns(c,u,g,N),u.child)}function NS(c,u,g,v,N,L){return zl(u),u.updateQueue=null,g=D1(u,v,g,N),_1(c),v=lm(),c!==null&&!os?(cm(c,u,L),ia(c,u,L)):(Or&&v&&Gx(u),u.flags|=1,Ns(c,u,g,L),u.child)}function OS(c,u,g,v,N){if(zl(u),u.stateNode===null){var L=Ac,te=g.contextType;typeof te=="object"&&te!==null&&(L=Rs(te)),L=new g(v,L),u.memoizedState=L.state!==null&&L.state!==void 0?L.state:null,L.updater=Cm,u.stateNode=L,L._reactInternals=u,L=u.stateNode,L.props=v,L.state=u.memoizedState,L.refs={},Zx(u),te=g.contextType,L.context=typeof te=="object"&&te!==null?Rs(te):Ac,L.state=u.memoizedState,te=g.getDerivedStateFromProps,typeof te=="function"&&(Em(u,g,te,v),L.state=u.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof L.getSnapshotBeforeUpdate=="function"||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(te=L.state,typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount(),te!==L.state&&Cm.enqueueReplaceState(L,L.state,null),xu(u,v,L,N),gu(),L.state=u.memoizedState),typeof L.componentDidMount=="function"&&(u.flags|=4194308),v=!0}else if(c===null){L=u.stateNode;var we=u.memoizedProps,Fe=Ul(g,we);L.props=Fe;var nt=L.context,dt=g.contextType;te=Ac,typeof dt=="object"&&dt!==null&&(te=Rs(dt));var gt=g.getDerivedStateFromProps;dt=typeof gt=="function"||typeof L.getSnapshotBeforeUpdate=="function",we=u.pendingProps!==we,dt||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(we||nt!==te)&&mS(u,L,v,te),Da=!1;var st=u.memoizedState;L.state=st,xu(u,v,L,N),gu(),nt=u.memoizedState,we||st!==nt||Da?(typeof gt=="function"&&(Em(u,g,gt,v),nt=u.memoizedState),(Fe=Da||xS(u,g,Fe,v,st,nt,te))?(dt||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(u.flags|=4194308)):(typeof L.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=v,u.memoizedState=nt),L.props=v,L.state=nt,L.context=te,v=Fe):(typeof L.componentDidMount=="function"&&(u.flags|=4194308),v=!1)}else{L=u.stateNode,em(c,u),te=u.memoizedProps,dt=Ul(g,te),L.props=dt,gt=u.pendingProps,st=L.context,nt=g.contextType,Fe=Ac,typeof nt=="object"&&nt!==null&&(Fe=Rs(nt)),we=g.getDerivedStateFromProps,(nt=typeof we=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(te!==gt||st!==Fe)&&mS(u,L,v,Fe),Da=!1,st=u.memoizedState,L.state=st,xu(u,v,L,N),gu();var at=u.memoizedState;te!==gt||st!==at||Da||c!==null&&c.dependencies!==null&&fh(c.dependencies)?(typeof we=="function"&&(Em(u,g,we,v),at=u.memoizedState),(dt=Da||xS(u,g,dt,v,st,at,Fe)||c!==null&&c.dependencies!==null&&fh(c.dependencies))?(nt||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(v,at,Fe),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(v,at,Fe)),typeof L.componentDidUpdate=="function"&&(u.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof L.componentDidUpdate!="function"||te===c.memoizedProps&&st===c.memoizedState||(u.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||te===c.memoizedProps&&st===c.memoizedState||(u.flags|=1024),u.memoizedProps=v,u.memoizedState=at),L.props=v,L.state=at,L.context=Fe,v=dt):(typeof L.componentDidUpdate!="function"||te===c.memoizedProps&&st===c.memoizedState||(u.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||te===c.memoizedProps&&st===c.memoizedState||(u.flags|=1024),v=!1)}return L=v,Dh(c,u),v=(u.flags&128)!==0,L||v?(L=u.stateNode,g=v&&typeof g.getDerivedStateFromError!="function"?null:L.render(),u.flags|=1,c!==null&&v?(u.child=$l(u,c.child,null,N),u.child=$l(u,null,g,N)):Ns(c,u,g,N),u.memoizedState=L.state,c=u.child):c=ia(c,u,N),c}function _S(c,u,g,v){return Pl(),u.flags|=256,Ns(c,u,g,v),u.child}var Tm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rm(c){return{baseLanes:c,cachePool:S1()}}function Nm(c,u,g){return c=c!==null?c.childLanes&~g:0,u&&(c|=Ri),c}function DS(c,u,g){var v=u.pendingProps,N=!1,L=(u.flags&128)!==0,te;if((te=L)||(te=c!==null&&c.memoizedState===null?!1:(Kn.current&2)!==0),te&&(N=!0,u.flags&=-129),te=(u.flags&32)!==0,u.flags&=-33,c===null){if(Or){if(N?La(u):za(),(c=jn)?(c=$w(c,qi),c=c!==null&&c.data!=="&"?c:null,c!==null&&(u.memoizedState={dehydrated:c,treeContext:Ra!==null?{id:Ro,overflow:No}:null,retryLane:536870912,hydrationErrors:null},g=p1(c),g.return=u,u.child=g,Ts=u,jn=null)):c=null,c===null)throw Oa(u);return py(c)?u.lanes=32:u.lanes=536870912,null}var we=v.children;return v=v.fallback,N?(za(),N=u.mode,we=Ih({mode:"hidden",children:we},N),v=Il(v,N,g,null),we.return=u,v.return=u,we.sibling=v,u.child=we,v=u.child,v.memoizedState=Rm(g),v.childLanes=Nm(c,te,g),u.memoizedState=Tm,Su(null,v)):(La(u),Om(u,we))}var Fe=c.memoizedState;if(Fe!==null&&(we=Fe.dehydrated,we!==null)){if(L)u.flags&256?(La(u),u.flags&=-257,u=_m(c,u,g)):u.memoizedState!==null?(za(),u.child=c.child,u.flags|=128,u=null):(za(),we=v.fallback,N=u.mode,v=Ih({mode:"visible",children:v.children},N),we=Il(we,N,g,null),we.flags|=2,v.return=u,we.return=u,v.sibling=we,u.child=v,$l(u,c.child,null,g),v=u.child,v.memoizedState=Rm(g),v.childLanes=Nm(c,te,g),u.memoizedState=Tm,u=Su(null,v));else if(La(u),py(we)){if(te=we.nextSibling&&we.nextSibling.dataset,te)var nt=te.dgst;te=nt,v=Error(n(419)),v.stack="",v.digest=te,cu({value:v,source:null,stack:null}),u=_m(c,u,g)}else if(os||Oc(c,u,g,!1),te=(g&c.childLanes)!==0,os||te){if(te=un,te!==null&&(v=Pt(te,g),v!==0&&v!==Fe.retryLane))throw Fe.retryLane=v,Dl(c,v),pi(te,c,v),km;uy(we)||Uh(),u=_m(c,u,g)}else uy(we)?(u.flags|=192,u.child=c.child,u=null):(c=Fe.treeContext,jn=Yi(we.nextSibling),Ts=u,Or=!0,Na=null,qi=!1,c!==null&&g1(u,c),u=Om(u,v.children),u.flags|=4096);return u}return N?(za(),we=v.fallback,N=u.mode,Fe=c.child,nt=Fe.sibling,v=Zo(Fe,{mode:"hidden",children:v.children}),v.subtreeFlags=Fe.subtreeFlags&65011712,nt!==null?we=Zo(nt,we):(we=Il(we,N,g,null),we.flags|=2),we.return=u,v.return=u,v.sibling=we,u.child=v,Su(null,v),v=u.child,we=c.child.memoizedState,we===null?we=Rm(g):(N=we.cachePool,N!==null?(Fe=ss._currentValue,N=N.parent!==Fe?{parent:Fe,pool:Fe}:N):N=S1(),we={baseLanes:we.baseLanes|g,cachePool:N}),v.memoizedState=we,v.childLanes=Nm(c,te,g),u.memoizedState=Tm,Su(c.child,v)):(La(u),g=c.child,c=g.sibling,g=Zo(g,{mode:"visible",children:v.children}),g.return=u,g.sibling=null,c!==null&&(te=u.deletions,te===null?(u.deletions=[c],u.flags|=16):te.push(c)),u.child=g,u.memoizedState=null,g)}function Om(c,u){return u=Ih({mode:"visible",children:u},c.mode),u.return=c,c.child=u}function Ih(c,u){return c=ji(22,c,null,u),c.lanes=0,c}function _m(c,u,g){return $l(u,c.child,null,g),c=Om(u,u.pendingProps.children),c.flags|=2,u.memoizedState=null,c}function IS(c,u,g){c.lanes|=u;var v=c.alternate;v!==null&&(v.lanes|=u),Yx(c.return,u,g)}function Dm(c,u,g,v,N,L){var te=c.memoizedState;te===null?c.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:v,tail:g,tailMode:N,treeForkCount:L}:(te.isBackwards=u,te.rendering=null,te.renderingStartTime=0,te.last=v,te.tail=g,te.tailMode=N,te.treeForkCount=L)}function PS(c,u,g){var v=u.pendingProps,N=v.revealOrder,L=v.tail;v=v.children;var te=Kn.current,we=(te&2)!==0;if(we?(te=te&1|2,u.flags|=128):te&=1,_(Kn,te),Ns(c,u,v,g),v=Or?lu:0,!we&&c!==null&&(c.flags&128)!==0)e:for(c=u.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&IS(c,g,u);else if(c.tag===19)IS(c,g,u);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===u)break e;for(;c.sibling===null;){if(c.return===null||c.return===u)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}switch(N){case"forwards":for(g=u.child,N=null;g!==null;)c=g.alternate,c!==null&&wh(c)===null&&(N=g),g=g.sibling;g=N,g===null?(N=u.child,u.child=null):(N=g.sibling,g.sibling=null),Dm(u,!1,N,g,L,v);break;case"backwards":case"unstable_legacy-backwards":for(g=null,N=u.child,u.child=null;N!==null;){if(c=N.alternate,c!==null&&wh(c)===null){u.child=N;break}c=N.sibling,N.sibling=g,g=N,N=c}Dm(u,!0,g,null,L,v);break;case"together":Dm(u,!1,null,null,void 0,v);break;default:u.memoizedState=null}return u.child}function ia(c,u,g){if(c!==null&&(u.dependencies=c.dependencies),Fa|=u.lanes,(g&u.childLanes)===0)if(c!==null){if(Oc(c,u,g,!1),(g&u.childLanes)===0)return null}else return null;if(c!==null&&u.child!==c.child)throw Error(n(153));if(u.child!==null){for(c=u.child,g=Zo(c,c.pendingProps),u.child=g,g.return=u;c.sibling!==null;)c=c.sibling,g=g.sibling=Zo(c,c.pendingProps),g.return=u;g.sibling=null}return u.child}function Im(c,u){return(c.lanes&u)!==0?!0:(c=c.dependencies,!!(c!==null&&fh(c)))}function wD(c,u,g){switch(u.tag){case 3:le(u,u.stateNode.containerInfo),_a(u,ss,c.memoizedState.cache),Pl();break;case 27:case 5:V(u);break;case 4:le(u,u.stateNode.containerInfo);break;case 10:_a(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,im(u),null;break;case 13:var v=u.memoizedState;if(v!==null)return v.dehydrated!==null?(La(u),u.flags|=128,null):(g&u.child.childLanes)!==0?DS(c,u,g):(La(u),c=ia(c,u,g),c!==null?c.sibling:null);La(u);break;case 19:var N=(c.flags&128)!==0;if(v=(g&u.childLanes)!==0,v||(Oc(c,u,g,!1),v=(g&u.childLanes)!==0),N){if(v)return PS(c,u,g);u.flags|=128}if(N=u.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),_(Kn,Kn.current),v)break;return null;case 22:return u.lanes=0,AS(c,u,g,u.pendingProps);case 24:_a(u,ss,c.memoizedState.cache)}return ia(c,u,g)}function LS(c,u,g){if(c!==null)if(c.memoizedProps!==u.pendingProps)os=!0;else{if(!Im(c,g)&&(u.flags&128)===0)return os=!1,wD(c,u,g);os=(c.flags&131072)!==0}else os=!1,Or&&(u.flags&1048576)!==0&&f1(u,lu,u.index);switch(u.lanes=0,u.tag){case 16:e:{var v=u.pendingProps;if(c=Bl(u.elementType),u.type=c,typeof c=="function")Bx(c)?(v=Ul(c,v),u.tag=1,u=OS(null,u,c,v,g)):(u.tag=0,u=Am(null,u,c,v,g));else{if(c!=null){var N=c.$$typeof;if(N===j){u.tag=11,u=CS(null,u,c,v,g);break e}else if(N===R){u.tag=14,u=jS(null,u,c,v,g);break e}}throw u=F(c)||c,Error(n(306,u,""))}}return u;case 0:return Am(c,u,u.type,u.pendingProps,g);case 1:return v=u.type,N=Ul(v,u.pendingProps),OS(c,u,v,N,g);case 3:e:{if(le(u,u.stateNode.containerInfo),c===null)throw Error(n(387));v=u.pendingProps;var L=u.memoizedState;N=L.element,em(c,u),xu(u,v,null,g);var te=u.memoizedState;if(v=te.cache,_a(u,ss,v),v!==L.cache&&Kx(u,[ss],g,!0),gu(),v=te.element,L.isDehydrated)if(L={element:v,isDehydrated:!1,cache:te.cache},u.updateQueue.baseState=L,u.memoizedState=L,u.flags&256){u=_S(c,u,v,g);break e}else if(v!==N){N=Gi(Error(n(424)),u),cu(N),u=_S(c,u,v,g);break e}else for(c=u.stateNode.containerInfo,c.nodeType===9?c=c.body:c=c.nodeName==="HTML"?c.ownerDocument.body:c,jn=Yi(c.firstChild),Ts=u,Or=!0,Na=null,qi=!0,g=A1(u,null,v,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Pl(),v===N){u=ia(c,u,g);break e}Ns(c,u,v,g)}u=u.child}return u;case 26:return Dh(c,u),c===null?(g=Yw(u.type,null,u.pendingProps,null))?u.memoizedState=g:Or||(g=u.type,c=u.pendingProps,v=Xh(me.current).createElement(g),v[Zt]=u,v[mr]=c,Os(v,g,c),$r(v),u.stateNode=v):u.memoizedState=Yw(u.type,c.memoizedProps,u.pendingProps,c.memoizedState),null;case 27:return V(u),c===null&&Or&&(v=u.stateNode=Ww(u.type,u.pendingProps,me.current),Ts=u,qi=!0,N=jn,qa(u.type)?(hy=N,jn=Yi(v.firstChild)):jn=N),Ns(c,u,u.pendingProps.children,g),Dh(c,u),c===null&&(u.flags|=4194304),u.child;case 5:return c===null&&Or&&((N=v=jn)&&(v=QD(v,u.type,u.pendingProps,qi),v!==null?(u.stateNode=v,Ts=u,jn=Yi(v.firstChild),qi=!1,N=!0):N=!1),N||Oa(u)),V(u),N=u.type,L=u.pendingProps,te=c!==null?c.memoizedProps:null,v=L.children,ly(N,L)?v=null:te!==null&&ly(N,te)&&(u.flags|=32),u.memoizedState!==null&&(N=am(c,u,hD,null,null,g),Lu._currentValue=N),Dh(c,u),Ns(c,u,v,g),u.child;case 6:return c===null&&Or&&((c=g=jn)&&(g=ZD(g,u.pendingProps,qi),g!==null?(u.stateNode=g,Ts=u,jn=null,c=!0):c=!1),c||Oa(u)),null;case 13:return DS(c,u,g);case 4:return le(u,u.stateNode.containerInfo),v=u.pendingProps,c===null?u.child=$l(u,null,v,g):Ns(c,u,v,g),u.child;case 11:return CS(c,u,u.type,u.pendingProps,g);case 7:return Ns(c,u,u.pendingProps,g),u.child;case 8:return Ns(c,u,u.pendingProps.children,g),u.child;case 12:return Ns(c,u,u.pendingProps.children,g),u.child;case 10:return v=u.pendingProps,_a(u,u.type,v.value),Ns(c,u,v.children,g),u.child;case 9:return N=u.type._context,v=u.pendingProps.children,zl(u),N=Rs(N),v=v(N),u.flags|=1,Ns(c,u,v,g),u.child;case 14:return jS(c,u,u.type,u.pendingProps,g);case 15:return kS(c,u,u.type,u.pendingProps,g);case 19:return PS(c,u,g);case 31:return SD(c,u,g);case 22:return AS(c,u,g,u.pendingProps);case 24:return zl(u),v=Rs(ss),c===null?(N=Jx(),N===null&&(N=un,L=Vx(),N.pooledCache=L,L.refCount++,L!==null&&(N.pooledCacheLanes|=g),N=L),u.memoizedState={parent:v,cache:N},Zx(u),_a(u,ss,N)):((c.lanes&g)!==0&&(em(c,u),xu(u,null,null,g),gu()),N=c.memoizedState,L=u.memoizedState,N.parent!==v?(N={parent:v,cache:v},u.memoizedState=N,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=N),_a(u,ss,v)):(v=L.cache,_a(u,ss,v),v!==N.cache&&Kx(u,[ss],g,!0))),Ns(c,u,u.pendingProps.children,g),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function oa(c){c.flags|=4}function Pm(c,u,g,v,N){if((u=(c.mode&32)!==0)&&(u=!1),u){if(c.flags|=16777216,(N&335544128)===N)if(c.stateNode.complete)c.flags|=8192;else if(cw())c.flags|=8192;else throw Fl=yh,Qx}else c.flags&=-16777217}function zS(c,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)c.flags&=-16777217;else if(c.flags|=16777216,!Qw(u))if(cw())c.flags|=8192;else throw Fl=yh,Qx}function Ph(c,u){u!==null&&(c.flags|=4),c.flags&16384&&(u=c.tag!==22?Ge():536870912,c.lanes|=u,Uc|=u)}function wu(c,u){if(!Or)switch(c.tailMode){case"hidden":u=c.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?c.tail=null:g.sibling=null;break;case"collapsed":g=c.tail;for(var v=null;g!==null;)g.alternate!==null&&(v=g),g=g.sibling;v===null?u||c.tail===null?c.tail=null:c.tail.sibling=null:v.sibling=null}}function kn(c){var u=c.alternate!==null&&c.alternate.child===c.child,g=0,v=0;if(u)for(var N=c.child;N!==null;)g|=N.lanes|N.childLanes,v|=N.subtreeFlags&65011712,v|=N.flags&65011712,N.return=c,N=N.sibling;else for(N=c.child;N!==null;)g|=N.lanes|N.childLanes,v|=N.subtreeFlags,v|=N.flags,N.return=c,N=N.sibling;return c.subtreeFlags|=v,c.childLanes=g,u}function ED(c,u,g){var v=u.pendingProps;switch(Ux(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(u),null;case 1:return kn(u),null;case 3:return g=u.stateNode,v=null,c!==null&&(v=c.memoizedState.cache),u.memoizedState.cache!==v&&(u.flags|=2048),ra(ss),X(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(c===null||c.child===null)&&(Nc(u)?oa(u):c===null||c.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,qx())),kn(u),null;case 26:var N=u.type,L=u.memoizedState;return c===null?(oa(u),L!==null?(kn(u),zS(u,L)):(kn(u),Pm(u,N,null,v,g))):L?L!==c.memoizedState?(oa(u),kn(u),zS(u,L)):(kn(u),u.flags&=-16777217):(c=c.memoizedProps,c!==v&&oa(u),kn(u),Pm(u,N,c,v,g)),null;case 27:if(de(u),g=me.current,N=u.type,c!==null&&u.stateNode!=null)c.memoizedProps!==v&&oa(u);else{if(!v){if(u.stateNode===null)throw Error(n(166));return kn(u),null}c=Y.current,Nc(u)?x1(u):(c=Ww(N,v,g),u.stateNode=c,oa(u))}return kn(u),null;case 5:if(de(u),N=u.type,c!==null&&u.stateNode!=null)c.memoizedProps!==v&&oa(u);else{if(!v){if(u.stateNode===null)throw Error(n(166));return kn(u),null}if(L=Y.current,Nc(u))x1(u);else{var te=Xh(me.current);switch(L){case 1:L=te.createElementNS("http://www.w3.org/2000/svg",N);break;case 2:L=te.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;default:switch(N){case"svg":L=te.createElementNS("http://www.w3.org/2000/svg",N);break;case"math":L=te.createElementNS("http://www.w3.org/1998/Math/MathML",N);break;case"script":L=te.createElement("div"),L.innerHTML="<script><\/script>",L=L.removeChild(L.firstChild);break;case"select":L=typeof v.is=="string"?te.createElement("select",{is:v.is}):te.createElement("select"),v.multiple?L.multiple=!0:v.size&&(L.size=v.size);break;default:L=typeof v.is=="string"?te.createElement(N,{is:v.is}):te.createElement(N)}}L[Zt]=u,L[mr]=v;e:for(te=u.child;te!==null;){if(te.tag===5||te.tag===6)L.appendChild(te.stateNode);else if(te.tag!==4&&te.tag!==27&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===u)break e;for(;te.sibling===null;){if(te.return===null||te.return===u)break e;te=te.return}te.sibling.return=te.return,te=te.sibling}u.stateNode=L;e:switch(Os(L,N,v),N){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}v&&oa(u)}}return kn(u),Pm(u,u.type,c===null?null:c.memoizedProps,u.pendingProps,g),null;case 6:if(c&&u.stateNode!=null)c.memoizedProps!==v&&oa(u);else{if(typeof v!="string"&&u.stateNode===null)throw Error(n(166));if(c=me.current,Nc(u)){if(c=u.stateNode,g=u.memoizedProps,v=null,N=Ts,N!==null)switch(N.tag){case 27:case 5:v=N.memoizedProps}c[Zt]=u,c=!!(c.nodeValue===g||v!==null&&v.suppressHydrationWarning===!0||Dw(c.nodeValue,g)),c||Oa(u,!0)}else c=Xh(c).createTextNode(v),c[Zt]=u,u.stateNode=c}return kn(u),null;case 31:if(g=u.memoizedState,c===null||c.memoizedState!==null){if(v=Nc(u),g!==null){if(c===null){if(!v)throw Error(n(318));if(c=u.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(n(557));c[Zt]=u}else Pl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;kn(u),c=!1}else g=qx(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=g),c=!0;if(!c)return u.flags&256?(Ai(u),u):(Ai(u),null);if((u.flags&128)!==0)throw Error(n(558))}return kn(u),null;case 13:if(v=u.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(N=Nc(u),v!==null&&v.dehydrated!==null){if(c===null){if(!N)throw Error(n(318));if(N=u.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(n(317));N[Zt]=u}else Pl(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;kn(u),N=!1}else N=qx(),c!==null&&c.memoizedState!==null&&(c.memoizedState.hydrationErrors=N),N=!0;if(!N)return u.flags&256?(Ai(u),u):(Ai(u),null)}return Ai(u),(u.flags&128)!==0?(u.lanes=g,u):(g=v!==null,c=c!==null&&c.memoizedState!==null,g&&(v=u.child,N=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(N=v.alternate.memoizedState.cachePool.pool),L=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(L=v.memoizedState.cachePool.pool),L!==N&&(v.flags|=2048)),g!==c&&g&&(u.child.flags|=8192),Ph(u,u.updateQueue),kn(u),null);case 4:return X(),c===null&&ny(u.stateNode.containerInfo),kn(u),null;case 10:return ra(u.type),kn(u),null;case 19:if(Q(Kn),v=u.memoizedState,v===null)return kn(u),null;if(N=(u.flags&128)!==0,L=v.rendering,L===null)if(N)wu(v,!1);else{if(Un!==0||c!==null&&(c.flags&128)!==0)for(c=u.child;c!==null;){if(L=wh(c),L!==null){for(u.flags|=128,wu(v,!1),c=L.updateQueue,u.updateQueue=c,Ph(u,c),u.subtreeFlags=0,c=g,g=u.child;g!==null;)u1(g,c),g=g.sibling;return _(Kn,Kn.current&1|2),Or&&ea(u,v.treeForkCount),u.child}c=c.sibling}v.tail!==null&&Ee()>Fh&&(u.flags|=128,N=!0,wu(v,!1),u.lanes=4194304)}else{if(!N)if(c=wh(L),c!==null){if(u.flags|=128,N=!0,c=c.updateQueue,u.updateQueue=c,Ph(u,c),wu(v,!0),v.tail===null&&v.tailMode==="hidden"&&!L.alternate&&!Or)return kn(u),null}else 2*Ee()-v.renderingStartTime>Fh&&g!==536870912&&(u.flags|=128,N=!0,wu(v,!1),u.lanes=4194304);v.isBackwards?(L.sibling=u.child,u.child=L):(c=v.last,c!==null?c.sibling=L:u.child=L,v.last=L)}return v.tail!==null?(c=v.tail,v.rendering=c,v.tail=c.sibling,v.renderingStartTime=Ee(),c.sibling=null,g=Kn.current,_(Kn,N?g&1|2:g&1),Or&&ea(u,v.treeForkCount),c):(kn(u),null);case 22:case 23:return Ai(u),sm(),v=u.memoizedState!==null,c!==null?c.memoizedState!==null!==v&&(u.flags|=8192):v&&(u.flags|=8192),v?(g&536870912)!==0&&(u.flags&128)===0&&(kn(u),u.subtreeFlags&6&&(u.flags|=8192)):kn(u),g=u.updateQueue,g!==null&&Ph(u,g.retryQueue),g=null,c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),v=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==g&&(u.flags|=2048),c!==null&&Q(Ml),null;case 24:return g=null,c!==null&&(g=c.memoizedState.cache),u.memoizedState.cache!==g&&(u.flags|=2048),ra(ss),kn(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function CD(c,u){switch(Ux(u),u.tag){case 1:return c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 3:return ra(ss),X(),c=u.flags,(c&65536)!==0&&(c&128)===0?(u.flags=c&-65537|128,u):null;case 26:case 27:case 5:return de(u),null;case 31:if(u.memoizedState!==null){if(Ai(u),u.alternate===null)throw Error(n(340));Pl()}return c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 13:if(Ai(u),c=u.memoizedState,c!==null&&c.dehydrated!==null){if(u.alternate===null)throw Error(n(340));Pl()}return c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 19:return Q(Kn),null;case 4:return X(),null;case 10:return ra(u.type),null;case 22:case 23:return Ai(u),sm(),c!==null&&Q(Ml),c=u.flags,c&65536?(u.flags=c&-65537|128,u):null;case 24:return ra(ss),null;case 25:return null;default:return null}}function MS(c,u){switch(Ux(u),u.tag){case 3:ra(ss),X();break;case 26:case 27:case 5:de(u);break;case 4:X();break;case 31:u.memoizedState!==null&&Ai(u);break;case 13:Ai(u);break;case 19:Q(Kn);break;case 10:ra(u.type);break;case 22:case 23:Ai(u),sm(),c!==null&&Q(Ml);break;case 24:ra(ss)}}function Eu(c,u){try{var g=u.updateQueue,v=g!==null?g.lastEffect:null;if(v!==null){var N=v.next;g=N;do{if((g.tag&c)===c){v=void 0;var L=g.create,te=g.inst;v=L(),te.destroy=v}g=g.next}while(g!==N)}}catch(we){en(u,u.return,we)}}function Ma(c,u,g){try{var v=u.updateQueue,N=v!==null?v.lastEffect:null;if(N!==null){var L=N.next;v=L;do{if((v.tag&c)===c){var te=v.inst,we=te.destroy;if(we!==void 0){te.destroy=void 0,N=u;var Fe=g,nt=we;try{nt()}catch(dt){en(N,Fe,dt)}}}v=v.next}while(v!==L)}}catch(dt){en(u,u.return,dt)}}function BS(c){var u=c.updateQueue;if(u!==null){var g=c.stateNode;try{R1(u,g)}catch(v){en(c,c.return,v)}}}function FS(c,u,g){g.props=Ul(c.type,c.memoizedProps),g.state=c.memoizedState;try{g.componentWillUnmount()}catch(v){en(c,u,v)}}function Cu(c,u){try{var g=c.ref;if(g!==null){switch(c.tag){case 26:case 27:case 5:var v=c.stateNode;break;case 30:v=c.stateNode;break;default:v=c.stateNode}typeof g=="function"?c.refCleanup=g(v):g.current=v}}catch(N){en(c,u,N)}}function Oo(c,u){var g=c.ref,v=c.refCleanup;if(g!==null)if(typeof v=="function")try{v()}catch(N){en(c,u,N)}finally{c.refCleanup=null,c=c.alternate,c!=null&&(c.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(N){en(c,u,N)}else g.current=null}function $S(c){var u=c.type,g=c.memoizedProps,v=c.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":g.autoFocus&&v.focus();break e;case"img":g.src?v.src=g.src:g.srcSet&&(v.srcset=g.srcSet)}}catch(N){en(c,c.return,N)}}function Lm(c,u,g){try{var v=c.stateNode;HD(v,c.type,g,u),v[mr]=u}catch(N){en(c,c.return,N)}}function GS(c){return c.tag===5||c.tag===3||c.tag===26||c.tag===27&&qa(c.type)||c.tag===4}function zm(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||GS(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.tag===27&&qa(c.type)||c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Mm(c,u,g){var v=c.tag;if(v===5||v===6)c=c.stateNode,u?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(c,u):(u=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,u.appendChild(c),g=g._reactRootContainer,g!=null||u.onclick!==null||(u.onclick=Jo));else if(v!==4&&(v===27&&qa(c.type)&&(g=c.stateNode,u=null),c=c.child,c!==null))for(Mm(c,u,g),c=c.sibling;c!==null;)Mm(c,u,g),c=c.sibling}function Lh(c,u,g){var v=c.tag;if(v===5||v===6)c=c.stateNode,u?g.insertBefore(c,u):g.appendChild(c);else if(v!==4&&(v===27&&qa(c.type)&&(g=c.stateNode),c=c.child,c!==null))for(Lh(c,u,g),c=c.sibling;c!==null;)Lh(c,u,g),c=c.sibling}function US(c){var u=c.stateNode,g=c.memoizedProps;try{for(var v=c.type,N=u.attributes;N.length;)u.removeAttributeNode(N[0]);Os(u,v,g),u[Zt]=c,u[mr]=g}catch(L){en(c,c.return,L)}}var aa=!1,as=!1,Bm=!1,WS=typeof WeakSet=="function"?WeakSet:Set,ms=null;function jD(c,u){if(c=c.containerInfo,oy=nf,c=r1(c),_x(c)){if("selectionStart"in c)var g={start:c.selectionStart,end:c.selectionEnd};else e:{g=(g=c.ownerDocument)&&g.defaultView||window;var v=g.getSelection&&g.getSelection();if(v&&v.rangeCount!==0){g=v.anchorNode;var N=v.anchorOffset,L=v.focusNode;v=v.focusOffset;try{g.nodeType,L.nodeType}catch{g=null;break e}var te=0,we=-1,Fe=-1,nt=0,dt=0,gt=c,st=null;t:for(;;){for(var at;gt!==g||N!==0&&gt.nodeType!==3||(we=te+N),gt!==L||v!==0&&gt.nodeType!==3||(Fe=te+v),gt.nodeType===3&&(te+=gt.nodeValue.length),(at=gt.firstChild)!==null;)st=gt,gt=at;for(;;){if(gt===c)break t;if(st===g&&++nt===N&&(we=te),st===L&&++dt===v&&(Fe=te),(at=gt.nextSibling)!==null)break;gt=st,st=gt.parentNode}gt=at}g=we===-1||Fe===-1?null:{start:we,end:Fe}}else g=null}g=g||{start:0,end:0}}else g=null;for(ay={focusedElem:c,selectionRange:g},nf=!1,ms=u;ms!==null;)if(u=ms,c=u.child,(u.subtreeFlags&1028)!==0&&c!==null)c.return=u,ms=c;else for(;ms!==null;){switch(u=ms,L=u.alternate,c=u.flags,u.tag){case 0:if((c&4)!==0&&(c=u.updateQueue,c=c!==null?c.events:null,c!==null))for(g=0;g<c.length;g++)N=c[g],N.ref.impl=N.nextImpl;break;case 11:case 15:break;case 1:if((c&1024)!==0&&L!==null){c=void 0,g=u,N=L.memoizedProps,L=L.memoizedState,v=g.stateNode;try{var zt=Ul(g.type,N);c=v.getSnapshotBeforeUpdate(zt,L),v.__reactInternalSnapshotBeforeUpdate=c}catch(Kt){en(g,g.return,Kt)}}break;case 3:if((c&1024)!==0){if(c=u.stateNode.containerInfo,g=c.nodeType,g===9)dy(c);else if(g===1)switch(c.nodeName){case"HEAD":case"HTML":case"BODY":dy(c);break;default:c.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((c&1024)!==0)throw Error(n(163))}if(c=u.sibling,c!==null){c.return=u.return,ms=c;break}ms=u.return}}function qS(c,u,g){var v=g.flags;switch(g.tag){case 0:case 11:case 15:ca(c,g),v&4&&Eu(5,g);break;case 1:if(ca(c,g),v&4)if(c=g.stateNode,u===null)try{c.componentDidMount()}catch(te){en(g,g.return,te)}else{var N=Ul(g.type,u.memoizedProps);u=u.memoizedState;try{c.componentDidUpdate(N,u,c.__reactInternalSnapshotBeforeUpdate)}catch(te){en(g,g.return,te)}}v&64&&BS(g),v&512&&Cu(g,g.return);break;case 3:if(ca(c,g),v&64&&(c=g.updateQueue,c!==null)){if(u=null,g.child!==null)switch(g.child.tag){case 27:case 5:u=g.child.stateNode;break;case 1:u=g.child.stateNode}try{R1(c,u)}catch(te){en(g,g.return,te)}}break;case 27:u===null&&v&4&&US(g);case 26:case 5:ca(c,g),u===null&&v&4&&$S(g),v&512&&Cu(g,g.return);break;case 12:ca(c,g);break;case 31:ca(c,g),v&4&&KS(c,g);break;case 13:ca(c,g),v&4&&VS(c,g),v&64&&(c=g.memoizedState,c!==null&&(c=c.dehydrated,c!==null&&(g=ID.bind(null,g),eI(c,g))));break;case 22:if(v=g.memoizedState!==null||aa,!v){u=u!==null&&u.memoizedState!==null||as,N=aa;var L=as;aa=v,(as=u)&&!L?da(c,g,(g.subtreeFlags&8772)!==0):ca(c,g),aa=N,as=L}break;case 30:break;default:ca(c,g)}}function HS(c){var u=c.alternate;u!==null&&(c.alternate=null,HS(u)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(u=c.stateNode,u!==null&&It(u)),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}var Rn=null,li=!1;function la(c,u,g){for(g=g.child;g!==null;)YS(c,u,g),g=g.sibling}function YS(c,u,g){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(se,g)}catch{}switch(g.tag){case 26:as||Oo(g,u),la(c,u,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:as||Oo(g,u);var v=Rn,N=li;qa(g.type)&&(Rn=g.stateNode,li=!1),la(c,u,g),Du(g.stateNode),Rn=v,li=N;break;case 5:as||Oo(g,u);case 6:if(v=Rn,N=li,Rn=null,la(c,u,g),Rn=v,li=N,Rn!==null)if(li)try{(Rn.nodeType===9?Rn.body:Rn.nodeName==="HTML"?Rn.ownerDocument.body:Rn).removeChild(g.stateNode)}catch(L){en(g,u,L)}else try{Rn.removeChild(g.stateNode)}catch(L){en(g,u,L)}break;case 18:Rn!==null&&(li?(c=Rn,Bw(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,g.stateNode),Jc(c)):Bw(Rn,g.stateNode));break;case 4:v=Rn,N=li,Rn=g.stateNode.containerInfo,li=!0,la(c,u,g),Rn=v,li=N;break;case 0:case 11:case 14:case 15:Ma(2,g,u),as||Ma(4,g,u),la(c,u,g);break;case 1:as||(Oo(g,u),v=g.stateNode,typeof v.componentWillUnmount=="function"&&FS(g,u,v)),la(c,u,g);break;case 21:la(c,u,g);break;case 22:as=(v=as)||g.memoizedState!==null,la(c,u,g),as=v;break;default:la(c,u,g)}}function KS(c,u){if(u.memoizedState===null&&(c=u.alternate,c!==null&&(c=c.memoizedState,c!==null))){c=c.dehydrated;try{Jc(c)}catch(g){en(u,u.return,g)}}}function VS(c,u){if(u.memoizedState===null&&(c=u.alternate,c!==null&&(c=c.memoizedState,c!==null&&(c=c.dehydrated,c!==null))))try{Jc(c)}catch(g){en(u,u.return,g)}}function kD(c){switch(c.tag){case 31:case 13:case 19:var u=c.stateNode;return u===null&&(u=c.stateNode=new WS),u;case 22:return c=c.stateNode,u=c._retryCache,u===null&&(u=c._retryCache=new WS),u;default:throw Error(n(435,c.tag))}}function zh(c,u){var g=kD(c);u.forEach(function(v){if(!g.has(v)){g.add(v);var N=PD.bind(null,c,v);v.then(N,N)}})}function ci(c,u){var g=u.deletions;if(g!==null)for(var v=0;v<g.length;v++){var N=g[v],L=c,te=u,we=te;e:for(;we!==null;){switch(we.tag){case 27:if(qa(we.type)){Rn=we.stateNode,li=!1;break e}break;case 5:Rn=we.stateNode,li=!1;break e;case 3:case 4:Rn=we.stateNode.containerInfo,li=!0;break e}we=we.return}if(Rn===null)throw Error(n(160));YS(L,te,N),Rn=null,li=!1,L=N.alternate,L!==null&&(L.return=null),N.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)XS(u,c),u=u.sibling}var go=null;function XS(c,u){var g=c.alternate,v=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:ci(u,c),di(c),v&4&&(Ma(3,c,c.return),Eu(3,c),Ma(5,c,c.return));break;case 1:ci(u,c),di(c),v&512&&(as||g===null||Oo(g,g.return)),v&64&&aa&&(c=c.updateQueue,c!==null&&(v=c.callbacks,v!==null&&(g=c.shared.hiddenCallbacks,c.shared.hiddenCallbacks=g===null?v:g.concat(v))));break;case 26:var N=go;if(ci(u,c),di(c),v&512&&(as||g===null||Oo(g,g.return)),v&4){var L=g!==null?g.memoizedState:null;if(v=c.memoizedState,g===null)if(v===null)if(c.stateNode===null){e:{v=c.type,g=c.memoizedProps,N=N.ownerDocument||N;t:switch(v){case"title":L=N.getElementsByTagName("title")[0],(!L||L[Ot]||L[Zt]||L.namespaceURI==="http://www.w3.org/2000/svg"||L.hasAttribute("itemprop"))&&(L=N.createElement(v),N.head.insertBefore(L,N.querySelector("head > title"))),Os(L,v,g),L[Zt]=c,$r(L),v=L;break e;case"link":var te=Xw("link","href",N).get(v+(g.href||""));if(te){for(var we=0;we<te.length;we++)if(L=te[we],L.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&L.getAttribute("rel")===(g.rel==null?null:g.rel)&&L.getAttribute("title")===(g.title==null?null:g.title)&&L.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){te.splice(we,1);break t}}L=N.createElement(v),Os(L,v,g),N.head.appendChild(L);break;case"meta":if(te=Xw("meta","content",N).get(v+(g.content||""))){for(we=0;we<te.length;we++)if(L=te[we],L.getAttribute("content")===(g.content==null?null:""+g.content)&&L.getAttribute("name")===(g.name==null?null:g.name)&&L.getAttribute("property")===(g.property==null?null:g.property)&&L.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&L.getAttribute("charset")===(g.charSet==null?null:g.charSet)){te.splice(we,1);break t}}L=N.createElement(v),Os(L,v,g),N.head.appendChild(L);break;default:throw Error(n(468,v))}L[Zt]=c,$r(L),v=L}c.stateNode=v}else Jw(N,c.type,c.stateNode);else c.stateNode=Vw(N,v,c.memoizedProps);else L!==v?(L===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):L.count--,v===null?Jw(N,c.type,c.stateNode):Vw(N,v,c.memoizedProps)):v===null&&c.stateNode!==null&&Lm(c,c.memoizedProps,g.memoizedProps)}break;case 27:ci(u,c),di(c),v&512&&(as||g===null||Oo(g,g.return)),g!==null&&v&4&&Lm(c,c.memoizedProps,g.memoizedProps);break;case 5:if(ci(u,c),di(c),v&512&&(as||g===null||Oo(g,g.return)),c.flags&32){N=c.stateNode;try{kt(N,"")}catch(zt){en(c,c.return,zt)}}v&4&&c.stateNode!=null&&(N=c.memoizedProps,Lm(c,N,g!==null?g.memoizedProps:N)),v&1024&&(Bm=!0);break;case 6:if(ci(u,c),di(c),v&4){if(c.stateNode===null)throw Error(n(162));v=c.memoizedProps,g=c.stateNode;try{g.nodeValue=v}catch(zt){en(c,c.return,zt)}}break;case 3:if(Zh=null,N=go,go=Jh(u.containerInfo),ci(u,c),go=N,di(c),v&4&&g!==null&&g.memoizedState.isDehydrated)try{Jc(u.containerInfo)}catch(zt){en(c,c.return,zt)}Bm&&(Bm=!1,JS(c));break;case 4:v=go,go=Jh(c.stateNode.containerInfo),ci(u,c),di(c),go=v;break;case 12:ci(u,c),di(c);break;case 31:ci(u,c),di(c),v&4&&(v=c.updateQueue,v!==null&&(c.updateQueue=null,zh(c,v)));break;case 13:ci(u,c),di(c),c.child.flags&8192&&c.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Bh=Ee()),v&4&&(v=c.updateQueue,v!==null&&(c.updateQueue=null,zh(c,v)));break;case 22:N=c.memoizedState!==null;var Fe=g!==null&&g.memoizedState!==null,nt=aa,dt=as;if(aa=nt||N,as=dt||Fe,ci(u,c),as=dt,aa=nt,di(c),v&8192)e:for(u=c.stateNode,u._visibility=N?u._visibility&-2:u._visibility|1,N&&(g===null||Fe||aa||as||Wl(c)),g=null,u=c;;){if(u.tag===5||u.tag===26){if(g===null){Fe=g=u;try{if(L=Fe.stateNode,N)te=L.style,typeof te.setProperty=="function"?te.setProperty("display","none","important"):te.display="none";else{we=Fe.stateNode;var gt=Fe.memoizedProps.style,st=gt!=null&&gt.hasOwnProperty("display")?gt.display:null;we.style.display=st==null||typeof st=="boolean"?"":(""+st).trim()}}catch(zt){en(Fe,Fe.return,zt)}}}else if(u.tag===6){if(g===null){Fe=u;try{Fe.stateNode.nodeValue=N?"":Fe.memoizedProps}catch(zt){en(Fe,Fe.return,zt)}}}else if(u.tag===18){if(g===null){Fe=u;try{var at=Fe.stateNode;N?Fw(at,!0):Fw(Fe.stateNode,!1)}catch(zt){en(Fe,Fe.return,zt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===c)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===c)break e;for(;u.sibling===null;){if(u.return===null||u.return===c)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}v&4&&(v=c.updateQueue,v!==null&&(g=v.retryQueue,g!==null&&(v.retryQueue=null,zh(c,g))));break;case 19:ci(u,c),di(c),v&4&&(v=c.updateQueue,v!==null&&(c.updateQueue=null,zh(c,v)));break;case 30:break;case 21:break;default:ci(u,c),di(c)}}function di(c){var u=c.flags;if(u&2){try{for(var g,v=c.return;v!==null;){if(GS(v)){g=v;break}v=v.return}if(g==null)throw Error(n(160));switch(g.tag){case 27:var N=g.stateNode,L=zm(c);Lh(c,L,N);break;case 5:var te=g.stateNode;g.flags&32&&(kt(te,""),g.flags&=-33);var we=zm(c);Lh(c,we,te);break;case 3:case 4:var Fe=g.stateNode.containerInfo,nt=zm(c);Mm(c,nt,Fe);break;default:throw Error(n(161))}}catch(dt){en(c,c.return,dt)}c.flags&=-3}u&4096&&(c.flags&=-4097)}function JS(c){if(c.subtreeFlags&1024)for(c=c.child;c!==null;){var u=c;JS(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),c=c.sibling}}function ca(c,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)qS(c,u.alternate,u),u=u.sibling}function Wl(c){for(c=c.child;c!==null;){var u=c;switch(u.tag){case 0:case 11:case 14:case 15:Ma(4,u,u.return),Wl(u);break;case 1:Oo(u,u.return);var g=u.stateNode;typeof g.componentWillUnmount=="function"&&FS(u,u.return,g),Wl(u);break;case 27:Du(u.stateNode);case 26:case 5:Oo(u,u.return),Wl(u);break;case 22:u.memoizedState===null&&Wl(u);break;case 30:Wl(u);break;default:Wl(u)}c=c.sibling}}function da(c,u,g){for(g=g&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var v=u.alternate,N=c,L=u,te=L.flags;switch(L.tag){case 0:case 11:case 15:da(N,L,g),Eu(4,L);break;case 1:if(da(N,L,g),v=L,N=v.stateNode,typeof N.componentDidMount=="function")try{N.componentDidMount()}catch(nt){en(v,v.return,nt)}if(v=L,N=v.updateQueue,N!==null){var we=v.stateNode;try{var Fe=N.shared.hiddenCallbacks;if(Fe!==null)for(N.shared.hiddenCallbacks=null,N=0;N<Fe.length;N++)T1(Fe[N],we)}catch(nt){en(v,v.return,nt)}}g&&te&64&&BS(L),Cu(L,L.return);break;case 27:US(L);case 26:case 5:da(N,L,g),g&&v===null&&te&4&&$S(L),Cu(L,L.return);break;case 12:da(N,L,g);break;case 31:da(N,L,g),g&&te&4&&KS(N,L);break;case 13:da(N,L,g),g&&te&4&&VS(N,L);break;case 22:L.memoizedState===null&&da(N,L,g),Cu(L,L.return);break;case 30:break;default:da(N,L,g)}u=u.sibling}}function Fm(c,u){var g=null;c!==null&&c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),c=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(c=u.memoizedState.cachePool.pool),c!==g&&(c!=null&&c.refCount++,g!=null&&du(g))}function $m(c,u){c=null,u.alternate!==null&&(c=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==c&&(u.refCount++,c!=null&&du(c))}function xo(c,u,g,v){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)QS(c,u,g,v),u=u.sibling}function QS(c,u,g,v){var N=u.flags;switch(u.tag){case 0:case 11:case 15:xo(c,u,g,v),N&2048&&Eu(9,u);break;case 1:xo(c,u,g,v);break;case 3:xo(c,u,g,v),N&2048&&(c=null,u.alternate!==null&&(c=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==c&&(u.refCount++,c!=null&&du(c)));break;case 12:if(N&2048){xo(c,u,g,v),c=u.stateNode;try{var L=u.memoizedProps,te=L.id,we=L.onPostCommit;typeof we=="function"&&we(te,u.alternate===null?"mount":"update",c.passiveEffectDuration,-0)}catch(Fe){en(u,u.return,Fe)}}else xo(c,u,g,v);break;case 31:xo(c,u,g,v);break;case 13:xo(c,u,g,v);break;case 23:break;case 22:L=u.stateNode,te=u.alternate,u.memoizedState!==null?L._visibility&2?xo(c,u,g,v):ju(c,u):L._visibility&2?xo(c,u,g,v):(L._visibility|=2,Fc(c,u,g,v,(u.subtreeFlags&10256)!==0||!1)),N&2048&&Fm(te,u);break;case 24:xo(c,u,g,v),N&2048&&$m(u.alternate,u);break;default:xo(c,u,g,v)}}function Fc(c,u,g,v,N){for(N=N&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var L=c,te=u,we=g,Fe=v,nt=te.flags;switch(te.tag){case 0:case 11:case 15:Fc(L,te,we,Fe,N),Eu(8,te);break;case 23:break;case 22:var dt=te.stateNode;te.memoizedState!==null?dt._visibility&2?Fc(L,te,we,Fe,N):ju(L,te):(dt._visibility|=2,Fc(L,te,we,Fe,N)),N&&nt&2048&&Fm(te.alternate,te);break;case 24:Fc(L,te,we,Fe,N),N&&nt&2048&&$m(te.alternate,te);break;default:Fc(L,te,we,Fe,N)}u=u.sibling}}function ju(c,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var g=c,v=u,N=v.flags;switch(v.tag){case 22:ju(g,v),N&2048&&Fm(v.alternate,v);break;case 24:ju(g,v),N&2048&&$m(v.alternate,v);break;default:ju(g,v)}u=u.sibling}}var ku=8192;function $c(c,u,g){if(c.subtreeFlags&ku)for(c=c.child;c!==null;)ZS(c,u,g),c=c.sibling}function ZS(c,u,g){switch(c.tag){case 26:$c(c,u,g),c.flags&ku&&c.memoizedState!==null&&pI(g,go,c.memoizedState,c.memoizedProps);break;case 5:$c(c,u,g);break;case 3:case 4:var v=go;go=Jh(c.stateNode.containerInfo),$c(c,u,g),go=v;break;case 22:c.memoizedState===null&&(v=c.alternate,v!==null&&v.memoizedState!==null?(v=ku,ku=16777216,$c(c,u,g),ku=v):$c(c,u,g));break;default:$c(c,u,g)}}function ew(c){var u=c.alternate;if(u!==null&&(c=u.child,c!==null)){u.child=null;do u=c.sibling,c.sibling=null,c=u;while(c!==null)}}function Au(c){var u=c.deletions;if((c.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var v=u[g];ms=v,rw(v,c)}ew(c)}if(c.subtreeFlags&10256)for(c=c.child;c!==null;)tw(c),c=c.sibling}function tw(c){switch(c.tag){case 0:case 11:case 15:Au(c),c.flags&2048&&Ma(9,c,c.return);break;case 3:Au(c);break;case 12:Au(c);break;case 22:var u=c.stateNode;c.memoizedState!==null&&u._visibility&2&&(c.return===null||c.return.tag!==13)?(u._visibility&=-3,Mh(c)):Au(c);break;default:Au(c)}}function Mh(c){var u=c.deletions;if((c.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var v=u[g];ms=v,rw(v,c)}ew(c)}for(c=c.child;c!==null;){switch(u=c,u.tag){case 0:case 11:case 15:Ma(8,u,u.return),Mh(u);break;case 22:g=u.stateNode,g._visibility&2&&(g._visibility&=-3,Mh(u));break;default:Mh(u)}c=c.sibling}}function rw(c,u){for(;ms!==null;){var g=ms;switch(g.tag){case 0:case 11:case 15:Ma(8,g,u);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var v=g.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:du(g.memoizedState.cache)}if(v=g.child,v!==null)v.return=g,ms=v;else e:for(g=c;ms!==null;){v=ms;var N=v.sibling,L=v.return;if(HS(v),v===g){ms=null;break e}if(N!==null){N.return=L,ms=N;break e}ms=L}}}var AD={getCacheForType:function(c){var u=Rs(ss),g=u.data.get(c);return g===void 0&&(g=c(),u.data.set(c,g)),g},cacheSignal:function(){return Rs(ss).controller.signal}},TD=typeof WeakMap=="function"?WeakMap:Map,Xr=0,un=null,yr=null,jr=0,Zr=0,Ti=null,Ba=!1,Gc=!1,Gm=!1,ua=0,Un=0,Fa=0,ql=0,Um=0,Ri=0,Uc=0,Tu=null,ui=null,Wm=!1,Bh=0,nw=0,Fh=1/0,$h=null,$a=null,ps=0,Ga=null,Wc=null,pa=0,qm=0,Hm=null,sw=null,Ru=0,Ym=null;function Ni(){return(Xr&2)!==0&&jr!==0?jr&-jr:$.T!==null?Zm():it()}function iw(){if(Ri===0)if((jr&536870912)===0||Or){var c=Ne;Ne<<=1,(Ne&3932160)===0&&(Ne=262144),Ri=c}else Ri=536870912;return c=ki.current,c!==null&&(c.flags|=32),Ri}function pi(c,u,g){(c===un&&(Zr===2||Zr===9)||c.cancelPendingCommit!==null)&&(qc(c,0),Ua(c,jr,Ri,!1)),xt(c,g),((Xr&2)===0||c!==un)&&(c===un&&((Xr&2)===0&&(ql|=g),Un===4&&Ua(c,jr,Ri,!1)),_o(c))}function ow(c,u,g){if((Xr&6)!==0)throw Error(n(327));var v=!g&&(u&127)===0&&(u&c.expiredLanes)===0||Le(c,u),N=v?OD(c,u):Vm(c,u,!0),L=v;do{if(N===0){Gc&&!v&&Ua(c,u,0,!1);break}else{if(g=c.current.alternate,L&&!RD(g)){N=Vm(c,u,!1),L=!1;continue}if(N===2){if(L=u,c.errorRecoveryDisabledLanes&L)var te=0;else te=c.pendingLanes&-536870913,te=te!==0?te:te&536870912?536870912:0;if(te!==0){u=te;e:{var we=c;N=Tu;var Fe=we.current.memoizedState.isDehydrated;if(Fe&&(qc(we,te).flags|=256),te=Vm(we,te,!1),te!==2){if(Gm&&!Fe){we.errorRecoveryDisabledLanes|=L,ql|=L,N=4;break e}L=ui,ui=N,L!==null&&(ui===null?ui=L:ui.push.apply(ui,L))}N=te}if(L=!1,N!==2)continue}}if(N===1){qc(c,0),Ua(c,u,0,!0);break}e:{switch(v=c,L=N,L){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:Ua(v,u,Ri,!Ba);break e;case 2:ui=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(N=Bh+300-Ee(),10<N)){if(Ua(v,u,Ri,!Ba),xe(v,0,!0)!==0)break e;pa=u,v.timeoutHandle=zw(aw.bind(null,v,g,ui,$h,Wm,u,Ri,ql,Uc,Ba,L,"Throttled",-0,0),N);break e}aw(v,g,ui,$h,Wm,u,Ri,ql,Uc,Ba,L,null,-0,0)}}break}while(!0);_o(c)}function aw(c,u,g,v,N,L,te,we,Fe,nt,dt,gt,st,at){if(c.timeoutHandle=-1,gt=u.subtreeFlags,gt&8192||(gt&16785408)===16785408){gt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Jo},ZS(u,L,gt);var zt=(L&62914560)===L?Bh-Ee():(L&4194048)===L?nw-Ee():0;if(zt=hI(gt,zt),zt!==null){pa=L,c.cancelPendingCommit=zt(gw.bind(null,c,u,L,g,v,N,te,we,Fe,dt,gt,null,st,at)),Ua(c,L,te,!nt);return}}gw(c,u,L,g,v,N,te,we,Fe)}function RD(c){for(var u=c;;){var g=u.tag;if((g===0||g===11||g===15)&&u.flags&16384&&(g=u.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var v=0;v<g.length;v++){var N=g[v],L=N.getSnapshot;N=N.value;try{if(!Ci(L(),N))return!1}catch{return!1}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===c)break;for(;u.sibling===null;){if(u.return===null||u.return===c)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Ua(c,u,g,v){u&=~Um,u&=~ql,c.suspendedLanes|=u,c.pingedLanes&=~u,v&&(c.warmLanes|=u),v=c.expirationTimes;for(var N=u;0<N;){var L=31-Qe(N),te=1<<L;v[L]=-1,N&=~te}g!==0&&Lt(c,g,u)}function Gh(){return(Xr&6)===0?(Nu(0),!1):!0}function Km(){if(yr!==null){if(Zr===0)var c=yr.return;else c=yr,ta=Ll=null,dm(c),Pc=null,pu=0,c=yr;for(;c!==null;)MS(c.alternate,c),c=c.return;yr=null}}function qc(c,u){var g=c.timeoutHandle;g!==-1&&(c.timeoutHandle=-1,VD(g)),g=c.cancelPendingCommit,g!==null&&(c.cancelPendingCommit=null,g()),pa=0,Km(),un=c,yr=g=Zo(c.current,null),jr=u,Zr=0,Ti=null,Ba=!1,Gc=Le(c,u),Gm=!1,Uc=Ri=Um=ql=Fa=Un=0,ui=Tu=null,Wm=!1,(u&8)!==0&&(u|=u&32);var v=c.entangledLanes;if(v!==0)for(c=c.entanglements,v&=u;0<v;){var N=31-Qe(v),L=1<<N;u|=c[N],v&=~L}return ua=u,ch(),g}function lw(c,u){ar=null,$.H=vu,u===Ic||u===mh?(u=C1(),Zr=3):u===Qx?(u=C1(),Zr=4):Zr=u===km?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Ti=u,yr===null&&(Un=1,Oh(c,Gi(u,c.current)))}function cw(){var c=ki.current;return c===null?!0:(jr&4194048)===jr?Hi===null:(jr&62914560)===jr||(jr&536870912)!==0?c===Hi:!1}function dw(){var c=$.H;return $.H=vu,c===null?vu:c}function uw(){var c=$.A;return $.A=AD,c}function Uh(){Un=4,Ba||(jr&4194048)!==jr&&ki.current!==null||(Gc=!0),(Fa&134217727)===0&&(ql&134217727)===0||un===null||Ua(un,jr,Ri,!1)}function Vm(c,u,g){var v=Xr;Xr|=2;var N=dw(),L=uw();(un!==c||jr!==u)&&($h=null,qc(c,u)),u=!1;var te=Un;e:do try{if(Zr!==0&&yr!==null){var we=yr,Fe=Ti;switch(Zr){case 8:Km(),te=6;break e;case 3:case 2:case 9:case 6:ki.current===null&&(u=!0);var nt=Zr;if(Zr=0,Ti=null,Hc(c,we,Fe,nt),g&&Gc){te=0;break e}break;default:nt=Zr,Zr=0,Ti=null,Hc(c,we,Fe,nt)}}ND(),te=Un;break}catch(dt){lw(c,dt)}while(!0);return u&&c.shellSuspendCounter++,ta=Ll=null,Xr=v,$.H=N,$.A=L,yr===null&&(un=null,jr=0,ch()),te}function ND(){for(;yr!==null;)pw(yr)}function OD(c,u){var g=Xr;Xr|=2;var v=dw(),N=uw();un!==c||jr!==u?($h=null,Fh=Ee()+500,qc(c,u)):Gc=Le(c,u);e:do try{if(Zr!==0&&yr!==null){u=yr;var L=Ti;t:switch(Zr){case 1:Zr=0,Ti=null,Hc(c,u,L,1);break;case 2:case 9:if(w1(L)){Zr=0,Ti=null,hw(u);break}u=function(){Zr!==2&&Zr!==9||un!==c||(Zr=7),_o(c)},L.then(u,u);break e;case 3:Zr=7;break e;case 4:Zr=5;break e;case 7:w1(L)?(Zr=0,Ti=null,hw(u)):(Zr=0,Ti=null,Hc(c,u,L,7));break;case 5:var te=null;switch(yr.tag){case 26:te=yr.memoizedState;case 5:case 27:var we=yr;if(te?Qw(te):we.stateNode.complete){Zr=0,Ti=null;var Fe=we.sibling;if(Fe!==null)yr=Fe;else{var nt=we.return;nt!==null?(yr=nt,Wh(nt)):yr=null}break t}}Zr=0,Ti=null,Hc(c,u,L,5);break;case 6:Zr=0,Ti=null,Hc(c,u,L,6);break;case 8:Km(),Un=6;break e;default:throw Error(n(462))}}_D();break}catch(dt){lw(c,dt)}while(!0);return ta=Ll=null,$.H=v,$.A=N,Xr=g,yr!==null?0:(un=null,jr=0,ch(),Un)}function _D(){for(;yr!==null&&!Ie();)pw(yr)}function pw(c){var u=LS(c.alternate,c,ua);c.memoizedProps=c.pendingProps,u===null?Wh(c):yr=u}function hw(c){var u=c,g=u.alternate;switch(u.tag){case 15:case 0:u=NS(g,u,u.pendingProps,u.type,void 0,jr);break;case 11:u=NS(g,u,u.pendingProps,u.type.render,u.ref,jr);break;case 5:dm(u);default:MS(g,u),u=yr=u1(u,ua),u=LS(g,u,ua)}c.memoizedProps=c.pendingProps,u===null?Wh(c):yr=u}function Hc(c,u,g,v){ta=Ll=null,dm(u),Pc=null,pu=0;var N=u.return;try{if(vD(c,N,u,g,jr)){Un=1,Oh(c,Gi(g,c.current)),yr=null;return}}catch(L){if(N!==null)throw yr=N,L;Un=1,Oh(c,Gi(g,c.current)),yr=null;return}u.flags&32768?(Or||v===1?c=!0:Gc||(jr&536870912)!==0?c=!1:(Ba=c=!0,(v===2||v===9||v===3||v===6)&&(v=ki.current,v!==null&&v.tag===13&&(v.flags|=16384))),fw(u,c)):Wh(u)}function Wh(c){var u=c;do{if((u.flags&32768)!==0){fw(u,Ba);return}c=u.return;var g=ED(u.alternate,u,ua);if(g!==null){yr=g;return}if(u=u.sibling,u!==null){yr=u;return}yr=u=c}while(u!==null);Un===0&&(Un=5)}function fw(c,u){do{var g=CD(c.alternate,c);if(g!==null){g.flags&=32767,yr=g;return}if(g=c.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!u&&(c=c.sibling,c!==null)){yr=c;return}yr=c=g}while(c!==null);Un=6,yr=null}function gw(c,u,g,v,N,L,te,we,Fe){c.cancelPendingCommit=null;do qh();while(ps!==0);if((Xr&6)!==0)throw Error(n(327));if(u!==null){if(u===c.current)throw Error(n(177));if(L=u.lanes|u.childLanes,L|=zx,bt(c,g,L,te,we,Fe),c===un&&(yr=un=null,jr=0),Wc=u,Ga=c,pa=g,qm=L,Hm=N,sw=v,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(c.callbackNode=null,c.callbackPriority=0,LD(ce,function(){return vw(),null})):(c.callbackNode=null,c.callbackPriority=0),v=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||v){v=$.T,$.T=null,N=W.p,W.p=2,te=Xr,Xr|=4;try{jD(c,u,g)}finally{Xr=te,W.p=N,$.T=v}}ps=1,xw(),mw(),yw()}}function xw(){if(ps===1){ps=0;var c=Ga,u=Wc,g=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||g){g=$.T,$.T=null;var v=W.p;W.p=2;var N=Xr;Xr|=4;try{XS(u,c);var L=ay,te=r1(c.containerInfo),we=L.focusedElem,Fe=L.selectionRange;if(te!==we&&we&&we.ownerDocument&&t1(we.ownerDocument.documentElement,we)){if(Fe!==null&&_x(we)){var nt=Fe.start,dt=Fe.end;if(dt===void 0&&(dt=nt),"selectionStart"in we)we.selectionStart=nt,we.selectionEnd=Math.min(dt,we.value.length);else{var gt=we.ownerDocument||document,st=gt&&gt.defaultView||window;if(st.getSelection){var at=st.getSelection(),zt=we.textContent.length,Kt=Math.min(Fe.start,zt),on=Fe.end===void 0?Kt:Math.min(Fe.end,zt);!at.extend&&Kt>on&&(te=on,on=Kt,Kt=te);var Xe=e1(we,Kt),He=e1(we,on);if(Xe&&He&&(at.rangeCount!==1||at.anchorNode!==Xe.node||at.anchorOffset!==Xe.offset||at.focusNode!==He.node||at.focusOffset!==He.offset)){var rt=gt.createRange();rt.setStart(Xe.node,Xe.offset),at.removeAllRanges(),Kt>on?(at.addRange(rt),at.extend(He.node,He.offset)):(rt.setEnd(He.node,He.offset),at.addRange(rt))}}}}for(gt=[],at=we;at=at.parentNode;)at.nodeType===1&&gt.push({element:at,left:at.scrollLeft,top:at.scrollTop});for(typeof we.focus=="function"&&we.focus(),we=0;we<gt.length;we++){var ft=gt[we];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}nf=!!oy,ay=oy=null}finally{Xr=N,W.p=v,$.T=g}}c.current=u,ps=2}}function mw(){if(ps===2){ps=0;var c=Ga,u=Wc,g=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||g){g=$.T,$.T=null;var v=W.p;W.p=2;var N=Xr;Xr|=4;try{qS(c,u.alternate,u)}finally{Xr=N,W.p=v,$.T=g}}ps=3}}function yw(){if(ps===4||ps===3){ps=0,K();var c=Ga,u=Wc,g=pa,v=sw;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?ps=5:(ps=0,Wc=Ga=null,bw(c,c.pendingLanes));var N=c.pendingLanes;if(N===0&&($a=null),tt(g),u=u.stateNode,Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(se,u,void 0,(u.current.flags&128)===128)}catch{}if(v!==null){u=$.T,N=W.p,W.p=2,$.T=null;try{for(var L=c.onRecoverableError,te=0;te<v.length;te++){var we=v[te];L(we.value,{componentStack:we.stack})}}finally{$.T=u,W.p=N}}(pa&3)!==0&&qh(),_o(c),N=c.pendingLanes,(g&261930)!==0&&(N&42)!==0?c===Ym?Ru++:(Ru=0,Ym=c):Ru=0,Nu(0)}}function bw(c,u){(c.pooledCacheLanes&=u)===0&&(u=c.pooledCache,u!=null&&(c.pooledCache=null,du(u)))}function qh(){return xw(),mw(),yw(),vw()}function vw(){if(ps!==5)return!1;var c=Ga,u=qm;qm=0;var g=tt(pa),v=$.T,N=W.p;try{W.p=32>g?32:g,$.T=null,g=Hm,Hm=null;var L=Ga,te=pa;if(ps=0,Wc=Ga=null,pa=0,(Xr&6)!==0)throw Error(n(331));var we=Xr;if(Xr|=4,tw(L.current),QS(L,L.current,te,g),Xr=we,Nu(0,!1),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(se,L)}catch{}return!0}finally{W.p=N,$.T=v,bw(c,u)}}function Sw(c,u,g){u=Gi(g,u),u=jm(c.stateNode,u,2),c=Pa(c,u,2),c!==null&&(xt(c,2),_o(c))}function en(c,u,g){if(c.tag===3)Sw(c,c,g);else for(;u!==null;){if(u.tag===3){Sw(u,c,g);break}else if(u.tag===1){var v=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&($a===null||!$a.has(v))){c=Gi(g,c),g=wS(2),v=Pa(u,g,2),v!==null&&(ES(g,v,u,c),xt(v,2),_o(v));break}}u=u.return}}function Xm(c,u,g){var v=c.pingCache;if(v===null){v=c.pingCache=new TD;var N=new Set;v.set(u,N)}else N=v.get(u),N===void 0&&(N=new Set,v.set(u,N));N.has(g)||(Gm=!0,N.add(g),c=DD.bind(null,c,u,g),u.then(c,c))}function DD(c,u,g){var v=c.pingCache;v!==null&&v.delete(u),c.pingedLanes|=c.suspendedLanes&g,c.warmLanes&=~g,un===c&&(jr&g)===g&&(Un===4||Un===3&&(jr&62914560)===jr&&300>Ee()-Bh?(Xr&2)===0&&qc(c,0):Um|=g,Uc===jr&&(Uc=0)),_o(c)}function ww(c,u){u===0&&(u=Ge()),c=Dl(c,u),c!==null&&(xt(c,u),_o(c))}function ID(c){var u=c.memoizedState,g=0;u!==null&&(g=u.retryLane),ww(c,g)}function PD(c,u){var g=0;switch(c.tag){case 31:case 13:var v=c.stateNode,N=c.memoizedState;N!==null&&(g=N.retryLane);break;case 19:v=c.stateNode;break;case 22:v=c.stateNode._retryCache;break;default:throw Error(n(314))}v!==null&&v.delete(u),ww(c,g)}function LD(c,u){return $e(c,u)}var Hh=null,Yc=null,Jm=!1,Yh=!1,Qm=!1,Wa=0;function _o(c){c!==Yc&&c.next===null&&(Yc===null?Hh=Yc=c:Yc=Yc.next=c),Yh=!0,Jm||(Jm=!0,MD())}function Nu(c,u){if(!Qm&&Yh){Qm=!0;do for(var g=!1,v=Hh;v!==null;){if(c!==0){var N=v.pendingLanes;if(N===0)var L=0;else{var te=v.suspendedLanes,we=v.pingedLanes;L=(1<<31-Qe(42|c)+1)-1,L&=N&~(te&~we),L=L&201326741?L&201326741|1:L?L|2:0}L!==0&&(g=!0,kw(v,L))}else L=jr,L=xe(v,v===un?L:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(L&3)===0||Le(v,L)||(g=!0,kw(v,L));v=v.next}while(g);Qm=!1}}function zD(){Ew()}function Ew(){Yh=Jm=!1;var c=0;Wa!==0&&KD()&&(c=Wa);for(var u=Ee(),g=null,v=Hh;v!==null;){var N=v.next,L=Cw(v,u);L===0?(v.next=null,g===null?Hh=N:g.next=N,N===null&&(Yc=g)):(g=v,(c!==0||(L&3)!==0)&&(Yh=!0)),v=N}ps!==0&&ps!==5||Nu(c),Wa!==0&&(Wa=0)}function Cw(c,u){for(var g=c.suspendedLanes,v=c.pingedLanes,N=c.expirationTimes,L=c.pendingLanes&-62914561;0<L;){var te=31-Qe(L),we=1<<te,Fe=N[te];Fe===-1?((we&g)===0||(we&v)!==0)&&(N[te]=ze(we,u)):Fe<=u&&(c.expiredLanes|=we),L&=~we}if(u=un,g=jr,g=xe(c,c===u?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),v=c.callbackNode,g===0||c===u&&(Zr===2||Zr===9)||c.cancelPendingCommit!==null)return v!==null&&v!==null&&qe(v),c.callbackNode=null,c.callbackPriority=0;if((g&3)===0||Le(c,g)){if(u=g&-g,u===c.callbackPriority)return u;switch(v!==null&&qe(v),tt(g)){case 2:case 8:g=ee;break;case 32:g=ce;break;case 268435456:g=be;break;default:g=ce}return v=jw.bind(null,c),g=$e(g,v),c.callbackPriority=u,c.callbackNode=g,u}return v!==null&&v!==null&&qe(v),c.callbackPriority=2,c.callbackNode=null,2}function jw(c,u){if(ps!==0&&ps!==5)return c.callbackNode=null,c.callbackPriority=0,null;var g=c.callbackNode;if(qh()&&c.callbackNode!==g)return null;var v=jr;return v=xe(c,c===un?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),v===0?null:(ow(c,v,u),Cw(c,Ee()),c.callbackNode!=null&&c.callbackNode===g?jw.bind(null,c):null)}function kw(c,u){if(qh())return null;ow(c,u,!0)}function MD(){XD(function(){(Xr&6)!==0?$e(q,zD):Ew()})}function Zm(){if(Wa===0){var c=_c;c===0&&(c=ke,ke<<=1,(ke&261888)===0&&(ke=256)),Wa=c}return Wa}function Aw(c){return c==null||typeof c=="symbol"||typeof c=="boolean"?null:typeof c=="function"?c:th(""+c)}function Tw(c,u){var g=u.ownerDocument.createElement("input");return g.name=u.name,g.value=u.value,c.id&&g.setAttribute("form",c.id),u.parentNode.insertBefore(g,u),c=new FormData(c),g.parentNode.removeChild(g),c}function BD(c,u,g,v,N){if(u==="submit"&&g&&g.stateNode===N){var L=Aw((N[mr]||null).action),te=v.submitter;te&&(u=(u=te[mr]||null)?Aw(u.formAction):te.getAttribute("formAction"),u!==null&&(L=u,te=null));var we=new ih("action","action",null,v,N);c.push({event:we,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(Wa!==0){var Fe=te?Tw(N,te):new FormData(N);bm(g,{pending:!0,data:Fe,method:N.method,action:L},null,Fe)}}else typeof L=="function"&&(we.preventDefault(),Fe=te?Tw(N,te):new FormData(N),bm(g,{pending:!0,data:Fe,method:N.method,action:L},L,Fe))},currentTarget:N}]})}}for(var ey=0;ey<Lx.length;ey++){var ty=Lx[ey],FD=ty.toLowerCase(),$D=ty[0].toUpperCase()+ty.slice(1);fo(FD,"on"+$D)}fo(i1,"onAnimationEnd"),fo(o1,"onAnimationIteration"),fo(a1,"onAnimationStart"),fo("dblclick","onDoubleClick"),fo("focusin","onFocus"),fo("focusout","onBlur"),fo(nD,"onTransitionRun"),fo(sD,"onTransitionStart"),fo(iD,"onTransitionCancel"),fo(l1,"onTransitionEnd"),$t("onMouseEnter",["mouseout","mouseover"]),$t("onMouseLeave",["mouseout","mouseover"]),$t("onPointerEnter",["pointerout","pointerover"]),$t("onPointerLeave",["pointerout","pointerover"]),xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xs("onBeforeInput",["compositionend","keypress","textInput","paste"]),xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GD=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ou));function Rw(c,u){u=(u&4)!==0;for(var g=0;g<c.length;g++){var v=c[g],N=v.event;v=v.listeners;e:{var L=void 0;if(u)for(var te=v.length-1;0<=te;te--){var we=v[te],Fe=we.instance,nt=we.currentTarget;if(we=we.listener,Fe!==L&&N.isPropagationStopped())break e;L=we,N.currentTarget=nt;try{L(N)}catch(dt){lh(dt)}N.currentTarget=null,L=Fe}else for(te=0;te<v.length;te++){if(we=v[te],Fe=we.instance,nt=we.currentTarget,we=we.listener,Fe!==L&&N.isPropagationStopped())break e;L=we,N.currentTarget=nt;try{L(N)}catch(dt){lh(dt)}N.currentTarget=null,L=Fe}}}}function br(c,u){var g=u[ts];g===void 0&&(g=u[ts]=new Set);var v=c+"__bubble";g.has(v)||(Nw(u,c,2,!1),g.add(v))}function ry(c,u,g){var v=0;u&&(v|=4),Nw(g,c,v,u)}var Kh="_reactListening"+Math.random().toString(36).slice(2);function ny(c){if(!c[Kh]){c[Kh]=!0,oi.forEach(function(g){g!=="selectionchange"&&(GD.has(g)||ry(g,!1,c),ry(g,!0,c))});var u=c.nodeType===9?c:c.ownerDocument;u===null||u[Kh]||(u[Kh]=!0,ry("selectionchange",!1,u))}}function Nw(c,u,g,v){switch(iE(u)){case 2:var N=xI;break;case 8:N=mI;break;default:N=yy}g=N.bind(null,u,g,c),N=void 0,!Ex||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(N=!0),v?N!==void 0?c.addEventListener(u,g,{capture:!0,passive:N}):c.addEventListener(u,g,!0):N!==void 0?c.addEventListener(u,g,{passive:N}):c.addEventListener(u,g,!1)}function sy(c,u,g,v,N){var L=v;if((u&1)===0&&(u&2)===0&&v!==null)e:for(;;){if(v===null)return;var te=v.tag;if(te===3||te===4){var we=v.stateNode.containerInfo;if(we===N)break;if(te===4)for(te=v.return;te!==null;){var Fe=te.tag;if((Fe===3||Fe===4)&&te.stateNode.containerInfo===N)return;te=te.return}for(;we!==null;){if(te=Dt(we),te===null)return;if(Fe=te.tag,Fe===5||Fe===6||Fe===26||Fe===27){v=L=te;continue e}we=we.parentNode}}v=v.return}Pv(function(){var nt=L,dt=Sx(g),gt=[];e:{var st=c1.get(c);if(st!==void 0){var at=ih,zt=c;switch(c){case"keypress":if(nh(g)===0)break e;case"keydown":case"keyup":at=P_;break;case"focusin":zt="focus",at=Ax;break;case"focusout":zt="blur",at=Ax;break;case"beforeblur":case"afterblur":at=Ax;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=Mv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=E_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=M_;break;case i1:case o1:case a1:at=k_;break;case l1:at=F_;break;case"scroll":case"scrollend":at=S_;break;case"wheel":at=G_;break;case"copy":case"cut":case"paste":at=T_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Fv;break;case"toggle":case"beforetoggle":at=W_}var Kt=(u&4)!==0,on=!Kt&&(c==="scroll"||c==="scrollend"),Xe=Kt?st!==null?st+"Capture":null:st;Kt=[];for(var He=nt,rt;He!==null;){var ft=He;if(rt=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||rt===null||Xe===null||(ft=Zd(He,Xe),ft!=null&&Kt.push(_u(He,ft,rt))),on)break;He=He.return}0<Kt.length&&(st=new at(st,zt,null,g,dt),gt.push({event:st,listeners:Kt}))}}if((u&7)===0){e:{if(st=c==="mouseover"||c==="pointerover",at=c==="mouseout"||c==="pointerout",st&&g!==vx&&(zt=g.relatedTarget||g.fromElement)&&(Dt(zt)||zt[Cr]))break e;if((at||st)&&(st=dt.window===dt?dt:(st=dt.ownerDocument)?st.defaultView||st.parentWindow:window,at?(zt=g.relatedTarget||g.toElement,at=nt,zt=zt?Dt(zt):null,zt!==null&&(on=o(zt),Kt=zt.tag,zt!==on||Kt!==5&&Kt!==27&&Kt!==6)&&(zt=null)):(at=null,zt=nt),at!==zt)){if(Kt=Mv,ft="onMouseLeave",Xe="onMouseEnter",He="mouse",(c==="pointerout"||c==="pointerover")&&(Kt=Fv,ft="onPointerLeave",Xe="onPointerEnter",He="pointer"),on=at==null?st:or(at),rt=zt==null?st:or(zt),st=new Kt(ft,He+"leave",at,g,dt),st.target=on,st.relatedTarget=rt,ft=null,Dt(dt)===nt&&(Kt=new Kt(Xe,He+"enter",zt,g,dt),Kt.target=rt,Kt.relatedTarget=on,ft=Kt),on=ft,at&&zt)t:{for(Kt=UD,Xe=at,He=zt,rt=0,ft=Xe;ft;ft=Kt(ft))rt++;ft=0;for(var qt=He;qt;qt=Kt(qt))ft++;for(;0<rt-ft;)Xe=Kt(Xe),rt--;for(;0<ft-rt;)He=Kt(He),ft--;for(;rt--;){if(Xe===He||He!==null&&Xe===He.alternate){Kt=Xe;break t}Xe=Kt(Xe),He=Kt(He)}Kt=null}else Kt=null;at!==null&&Ow(gt,st,at,Kt,!1),zt!==null&&on!==null&&Ow(gt,on,zt,Kt,!0)}}e:{if(st=nt?or(nt):window,at=st.nodeName&&st.nodeName.toLowerCase(),at==="select"||at==="input"&&st.type==="file")var qr=Kv;else if(Hv(st))if(Vv)qr=eD;else{qr=Q_;var Gt=J_}else at=st.nodeName,!at||at.toLowerCase()!=="input"||st.type!=="checkbox"&&st.type!=="radio"?nt&&$n(nt.elementType)&&(qr=Kv):qr=Z_;if(qr&&(qr=qr(c,nt))){Yv(gt,qr,g,dt);break e}Gt&&Gt(c,st,nt),c==="focusout"&&nt&&st.type==="number"&&nt.memoizedProps.value!=null&&ae(st,"number",st.value)}switch(Gt=nt?or(nt):window,c){case"focusin":(Hv(Gt)||Gt.contentEditable==="true")&&(Cc=Gt,Dx=nt,au=null);break;case"focusout":au=Dx=Cc=null;break;case"mousedown":Ix=!0;break;case"contextmenu":case"mouseup":case"dragend":Ix=!1,n1(gt,g,dt);break;case"selectionchange":if(rD)break;case"keydown":case"keyup":n1(gt,g,dt)}var dr;if(Rx)e:{switch(c){case"compositionstart":var kr="onCompositionStart";break e;case"compositionend":kr="onCompositionEnd";break e;case"compositionupdate":kr="onCompositionUpdate";break e}kr=void 0}else Ec?Wv(c,g)&&(kr="onCompositionEnd"):c==="keydown"&&g.keyCode===229&&(kr="onCompositionStart");kr&&($v&&g.locale!=="ko"&&(Ec||kr!=="onCompositionStart"?kr==="onCompositionEnd"&&Ec&&(dr=Lv()):(Ta=dt,Cx="value"in Ta?Ta.value:Ta.textContent,Ec=!0)),Gt=Vh(nt,kr),0<Gt.length&&(kr=new Bv(kr,c,null,g,dt),gt.push({event:kr,listeners:Gt}),dr?kr.data=dr:(dr=qv(g),dr!==null&&(kr.data=dr)))),(dr=H_?Y_(c,g):K_(c,g))&&(kr=Vh(nt,"onBeforeInput"),0<kr.length&&(Gt=new Bv("onBeforeInput","beforeinput",null,g,dt),gt.push({event:Gt,listeners:kr}),Gt.data=dr)),BD(gt,c,nt,g,dt)}Rw(gt,u)})}function _u(c,u,g){return{instance:c,listener:u,currentTarget:g}}function Vh(c,u){for(var g=u+"Capture",v=[];c!==null;){var N=c,L=N.stateNode;if(N=N.tag,N!==5&&N!==26&&N!==27||L===null||(N=Zd(c,g),N!=null&&v.unshift(_u(c,N,L)),N=Zd(c,u),N!=null&&v.push(_u(c,N,L))),c.tag===3)return v;c=c.return}return[]}function UD(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5&&c.tag!==27);return c||null}function Ow(c,u,g,v,N){for(var L=u._reactName,te=[];g!==null&&g!==v;){var we=g,Fe=we.alternate,nt=we.stateNode;if(we=we.tag,Fe!==null&&Fe===v)break;we!==5&&we!==26&&we!==27||nt===null||(Fe=nt,N?(nt=Zd(g,L),nt!=null&&te.unshift(_u(g,nt,Fe))):N||(nt=Zd(g,L),nt!=null&&te.push(_u(g,nt,Fe)))),g=g.return}te.length!==0&&c.push({event:u,listeners:te})}var WD=/\r\n?/g,qD=/\u0000|\uFFFD/g;function _w(c){return(typeof c=="string"?c:""+c).replace(WD,`
`).replace(qD,"")}function Dw(c,u){return u=_w(u),_w(c)===u}function sn(c,u,g,v,N,L){switch(g){case"children":typeof v=="string"?u==="body"||u==="textarea"&&v===""||kt(c,v):(typeof v=="number"||typeof v=="bigint")&&u!=="body"&&kt(c,""+v);break;case"className":Pr(c,"class",v);break;case"tabIndex":Pr(c,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":Pr(c,g,v);break;case"style":ns(c,v,L);break;case"data":if(u!=="object"){Pr(c,"data",v);break}case"src":case"href":if(v===""&&(u!=="a"||g!=="href")){c.removeAttribute(g);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){c.removeAttribute(g);break}v=th(""+v),c.setAttribute(g,v);break;case"action":case"formAction":if(typeof v=="function"){c.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof L=="function"&&(g==="formAction"?(u!=="input"&&sn(c,u,"name",N.name,N,null),sn(c,u,"formEncType",N.formEncType,N,null),sn(c,u,"formMethod",N.formMethod,N,null),sn(c,u,"formTarget",N.formTarget,N,null)):(sn(c,u,"encType",N.encType,N,null),sn(c,u,"method",N.method,N,null),sn(c,u,"target",N.target,N,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){c.removeAttribute(g);break}v=th(""+v),c.setAttribute(g,v);break;case"onClick":v!=null&&(c.onclick=Jo);break;case"onScroll":v!=null&&br("scroll",c);break;case"onScrollEnd":v!=null&&br("scrollend",c);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(g=v.__html,g!=null){if(N.children!=null)throw Error(n(60));c.innerHTML=g}}break;case"multiple":c.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":c.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){c.removeAttribute("xlink:href");break}g=th(""+v),c.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(g,""+v):c.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(g,""):c.removeAttribute(g);break;case"capture":case"download":v===!0?c.setAttribute(g,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?c.setAttribute(g,v):c.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?c.setAttribute(g,v):c.removeAttribute(g);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?c.removeAttribute(g):c.setAttribute(g,v);break;case"popover":br("beforetoggle",c),br("toggle",c),us(c,"popover",v);break;case"xlinkActuate":Cn(c,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Cn(c,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Cn(c,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Cn(c,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Cn(c,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Cn(c,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Cn(c,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Cn(c,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Cn(c,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":us(c,"is",v);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=b_.get(g)||g,us(c,g,v))}}function iy(c,u,g,v,N,L){switch(g){case"style":ns(c,v,L);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(g=v.__html,g!=null){if(N.children!=null)throw Error(n(60));c.innerHTML=g}}break;case"children":typeof v=="string"?kt(c,v):(typeof v=="number"||typeof v=="bigint")&&kt(c,""+v);break;case"onScroll":v!=null&&br("scroll",c);break;case"onScrollEnd":v!=null&&br("scrollend",c);break;case"onClick":v!=null&&(c.onclick=Jo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ei.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(N=g.endsWith("Capture"),u=g.slice(2,N?g.length-7:void 0),L=c[mr]||null,L=L!=null?L[g]:null,typeof L=="function"&&c.removeEventListener(u,L,N),typeof v=="function")){typeof L!="function"&&L!==null&&(g in c?c[g]=null:c.hasAttribute(g)&&c.removeAttribute(g)),c.addEventListener(u,v,N);break e}g in c?c[g]=v:v===!0?c.setAttribute(g,""):us(c,g,v)}}}function Os(c,u,g){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":br("error",c),br("load",c);var v=!1,N=!1,L;for(L in g)if(g.hasOwnProperty(L)){var te=g[L];if(te!=null)switch(L){case"src":v=!0;break;case"srcSet":N=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:sn(c,u,L,te,g,null)}}N&&sn(c,u,"srcSet",g.srcSet,g,null),v&&sn(c,u,"src",g.src,g,null);return;case"input":br("invalid",c);var we=L=te=N=null,Fe=null,nt=null;for(v in g)if(g.hasOwnProperty(v)){var dt=g[v];if(dt!=null)switch(v){case"name":N=dt;break;case"type":te=dt;break;case"checked":Fe=dt;break;case"defaultChecked":nt=dt;break;case"value":L=dt;break;case"defaultValue":we=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(n(137,u));break;default:sn(c,u,v,dt,g,null)}}H(c,L,we,Fe,nt,te,N,!1);return;case"select":br("invalid",c),v=te=L=null;for(N in g)if(g.hasOwnProperty(N)&&(we=g[N],we!=null))switch(N){case"value":L=we;break;case"defaultValue":te=we;break;case"multiple":v=we;default:sn(c,u,N,we,g,null)}u=L,g=te,c.multiple=!!v,u!=null?De(c,!!v,u,!1):g!=null&&De(c,!!v,g,!0);return;case"textarea":br("invalid",c),L=N=v=null;for(te in g)if(g.hasOwnProperty(te)&&(we=g[te],we!=null))switch(te){case"value":v=we;break;case"defaultValue":N=we;break;case"children":L=we;break;case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(91));break;default:sn(c,u,te,we,g,null)}ut(c,v,N,L);return;case"option":for(Fe in g)g.hasOwnProperty(Fe)&&(v=g[Fe],v!=null)&&(Fe==="selected"?c.selected=v&&typeof v!="function"&&typeof v!="symbol":sn(c,u,Fe,v,g,null));return;case"dialog":br("beforetoggle",c),br("toggle",c),br("cancel",c),br("close",c);break;case"iframe":case"object":br("load",c);break;case"video":case"audio":for(v=0;v<Ou.length;v++)br(Ou[v],c);break;case"image":br("error",c),br("load",c);break;case"details":br("toggle",c);break;case"embed":case"source":case"link":br("error",c),br("load",c);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(nt in g)if(g.hasOwnProperty(nt)&&(v=g[nt],v!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:sn(c,u,nt,v,g,null)}return;default:if($n(u)){for(dt in g)g.hasOwnProperty(dt)&&(v=g[dt],v!==void 0&&iy(c,u,dt,v,g,void 0));return}}for(we in g)g.hasOwnProperty(we)&&(v=g[we],v!=null&&sn(c,u,we,v,g,null))}function HD(c,u,g,v){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var N=null,L=null,te=null,we=null,Fe=null,nt=null,dt=null;for(at in g){var gt=g[at];if(g.hasOwnProperty(at)&&gt!=null)switch(at){case"checked":break;case"value":break;case"defaultValue":Fe=gt;default:v.hasOwnProperty(at)||sn(c,u,at,null,v,gt)}}for(var st in v){var at=v[st];if(gt=g[st],v.hasOwnProperty(st)&&(at!=null||gt!=null))switch(st){case"type":L=at;break;case"name":N=at;break;case"checked":nt=at;break;case"defaultChecked":dt=at;break;case"value":te=at;break;case"defaultValue":we=at;break;case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(n(137,u));break;default:at!==gt&&sn(c,u,st,at,v,gt)}}Xs(c,te,we,Fe,nt,dt,L,N);return;case"select":at=te=we=st=null;for(L in g)if(Fe=g[L],g.hasOwnProperty(L)&&Fe!=null)switch(L){case"value":break;case"multiple":at=Fe;default:v.hasOwnProperty(L)||sn(c,u,L,null,v,Fe)}for(N in v)if(L=v[N],Fe=g[N],v.hasOwnProperty(N)&&(L!=null||Fe!=null))switch(N){case"value":st=L;break;case"defaultValue":we=L;break;case"multiple":te=L;default:L!==Fe&&sn(c,u,N,L,v,Fe)}u=we,g=te,v=at,st!=null?De(c,!!g,st,!1):!!v!=!!g&&(u!=null?De(c,!!g,u,!0):De(c,!!g,g?[]:"",!1));return;case"textarea":at=st=null;for(we in g)if(N=g[we],g.hasOwnProperty(we)&&N!=null&&!v.hasOwnProperty(we))switch(we){case"value":break;case"children":break;default:sn(c,u,we,null,v,N)}for(te in v)if(N=v[te],L=g[te],v.hasOwnProperty(te)&&(N!=null||L!=null))switch(te){case"value":st=N;break;case"defaultValue":at=N;break;case"children":break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(n(91));break;default:N!==L&&sn(c,u,te,N,v,L)}Ke(c,st,at);return;case"option":for(var zt in g)st=g[zt],g.hasOwnProperty(zt)&&st!=null&&!v.hasOwnProperty(zt)&&(zt==="selected"?c.selected=!1:sn(c,u,zt,null,v,st));for(Fe in v)st=v[Fe],at=g[Fe],v.hasOwnProperty(Fe)&&st!==at&&(st!=null||at!=null)&&(Fe==="selected"?c.selected=st&&typeof st!="function"&&typeof st!="symbol":sn(c,u,Fe,st,v,at));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Kt in g)st=g[Kt],g.hasOwnProperty(Kt)&&st!=null&&!v.hasOwnProperty(Kt)&&sn(c,u,Kt,null,v,st);for(nt in v)if(st=v[nt],at=g[nt],v.hasOwnProperty(nt)&&st!==at&&(st!=null||at!=null))switch(nt){case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(n(137,u));break;default:sn(c,u,nt,st,v,at)}return;default:if($n(u)){for(var on in g)st=g[on],g.hasOwnProperty(on)&&st!==void 0&&!v.hasOwnProperty(on)&&iy(c,u,on,void 0,v,st);for(dt in v)st=v[dt],at=g[dt],!v.hasOwnProperty(dt)||st===at||st===void 0&&at===void 0||iy(c,u,dt,st,v,at);return}}for(var Xe in g)st=g[Xe],g.hasOwnProperty(Xe)&&st!=null&&!v.hasOwnProperty(Xe)&&sn(c,u,Xe,null,v,st);for(gt in v)st=v[gt],at=g[gt],!v.hasOwnProperty(gt)||st===at||st==null&&at==null||sn(c,u,gt,st,v,at)}function Iw(c){switch(c){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function YD(){if(typeof performance.getEntriesByType=="function"){for(var c=0,u=0,g=performance.getEntriesByType("resource"),v=0;v<g.length;v++){var N=g[v],L=N.transferSize,te=N.initiatorType,we=N.duration;if(L&&we&&Iw(te)){for(te=0,we=N.responseEnd,v+=1;v<g.length;v++){var Fe=g[v],nt=Fe.startTime;if(nt>we)break;var dt=Fe.transferSize,gt=Fe.initiatorType;dt&&Iw(gt)&&(Fe=Fe.responseEnd,te+=dt*(Fe<we?1:(we-nt)/(Fe-nt)))}if(--v,u+=8*(L+te)/(N.duration/1e3),c++,10<c)break}}if(0<c)return u/c/1e6}return navigator.connection&&(c=navigator.connection.downlink,typeof c=="number")?c:5}var oy=null,ay=null;function Xh(c){return c.nodeType===9?c:c.ownerDocument}function Pw(c){switch(c){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Lw(c,u){if(c===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return c===1&&u==="foreignObject"?0:c}function ly(c,u){return c==="textarea"||c==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var cy=null;function KD(){var c=window.event;return c&&c.type==="popstate"?c===cy?!1:(cy=c,!0):(cy=null,!1)}var zw=typeof setTimeout=="function"?setTimeout:void 0,VD=typeof clearTimeout=="function"?clearTimeout:void 0,Mw=typeof Promise=="function"?Promise:void 0,XD=typeof queueMicrotask=="function"?queueMicrotask:typeof Mw<"u"?function(c){return Mw.resolve(null).then(c).catch(JD)}:zw;function JD(c){setTimeout(function(){throw c})}function qa(c){return c==="head"}function Bw(c,u){var g=u,v=0;do{var N=g.nextSibling;if(c.removeChild(g),N&&N.nodeType===8)if(g=N.data,g==="/$"||g==="/&"){if(v===0){c.removeChild(N),Jc(u);return}v--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")v++;else if(g==="html")Du(c.ownerDocument.documentElement);else if(g==="head"){g=c.ownerDocument.head,Du(g);for(var L=g.firstChild;L;){var te=L.nextSibling,we=L.nodeName;L[Ot]||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&L.rel.toLowerCase()==="stylesheet"||g.removeChild(L),L=te}}else g==="body"&&Du(c.ownerDocument.body);g=N}while(g);Jc(u)}function Fw(c,u){var g=c;c=0;do{var v=g.nextSibling;if(g.nodeType===1?u?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(u?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),v&&v.nodeType===8)if(g=v.data,g==="/$"){if(c===0)break;c--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||c++;g=v}while(g)}function dy(c){var u=c.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var g=u;switch(u=u.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":dy(g),It(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}c.removeChild(g)}}function QD(c,u,g,v){for(;c.nodeType===1;){var N=g;if(c.nodeName.toLowerCase()!==u.toLowerCase()){if(!v&&(c.nodeName!=="INPUT"||c.type!=="hidden"))break}else if(v){if(!c[Ot])switch(u){case"meta":if(!c.hasAttribute("itemprop"))break;return c;case"link":if(L=c.getAttribute("rel"),L==="stylesheet"&&c.hasAttribute("data-precedence"))break;if(L!==N.rel||c.getAttribute("href")!==(N.href==null||N.href===""?null:N.href)||c.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin)||c.getAttribute("title")!==(N.title==null?null:N.title))break;return c;case"style":if(c.hasAttribute("data-precedence"))break;return c;case"script":if(L=c.getAttribute("src"),(L!==(N.src==null?null:N.src)||c.getAttribute("type")!==(N.type==null?null:N.type)||c.getAttribute("crossorigin")!==(N.crossOrigin==null?null:N.crossOrigin))&&L&&c.hasAttribute("async")&&!c.hasAttribute("itemprop"))break;return c;default:return c}}else if(u==="input"&&c.type==="hidden"){var L=N.name==null?null:""+N.name;if(N.type==="hidden"&&c.getAttribute("name")===L)return c}else return c;if(c=Yi(c.nextSibling),c===null)break}return null}function ZD(c,u,g){if(u==="")return null;for(;c.nodeType!==3;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!g||(c=Yi(c.nextSibling),c===null))return null;return c}function $w(c,u){for(;c.nodeType!==8;)if((c.nodeType!==1||c.nodeName!=="INPUT"||c.type!=="hidden")&&!u||(c=Yi(c.nextSibling),c===null))return null;return c}function uy(c){return c.data==="$?"||c.data==="$~"}function py(c){return c.data==="$!"||c.data==="$?"&&c.ownerDocument.readyState!=="loading"}function eI(c,u){var g=c.ownerDocument;if(c.data==="$~")c._reactRetry=u;else if(c.data!=="$?"||g.readyState!=="loading")u();else{var v=function(){u(),g.removeEventListener("DOMContentLoaded",v)};g.addEventListener("DOMContentLoaded",v),c._reactRetry=v}}function Yi(c){for(;c!=null;c=c.nextSibling){var u=c.nodeType;if(u===1||u===3)break;if(u===8){if(u=c.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return c}var hy=null;function Gw(c){c=c.nextSibling;for(var u=0;c;){if(c.nodeType===8){var g=c.data;if(g==="/$"||g==="/&"){if(u===0)return Yi(c.nextSibling);u--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||u++}c=c.nextSibling}return null}function Uw(c){c=c.previousSibling;for(var u=0;c;){if(c.nodeType===8){var g=c.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(u===0)return c;u--}else g!=="/$"&&g!=="/&"||u++}c=c.previousSibling}return null}function Ww(c,u,g){switch(u=Xh(g),c){case"html":if(c=u.documentElement,!c)throw Error(n(452));return c;case"head":if(c=u.head,!c)throw Error(n(453));return c;case"body":if(c=u.body,!c)throw Error(n(454));return c;default:throw Error(n(451))}}function Du(c){for(var u=c.attributes;u.length;)c.removeAttributeNode(u[0]);It(c)}var Ki=new Map,qw=new Set;function Jh(c){return typeof c.getRootNode=="function"?c.getRootNode():c.nodeType===9?c:c.ownerDocument}var ha=W.d;W.d={f:tI,r:rI,D:nI,C:sI,L:iI,m:oI,X:lI,S:aI,M:cI};function tI(){var c=ha.f(),u=Gh();return c||u}function rI(c){var u=Ct(c);u!==null&&u.tag===5&&u.type==="form"?lS(u):ha.r(c)}var Kc=typeof document>"u"?null:document;function Hw(c,u,g){var v=Kc;if(v&&typeof u=="string"&&u){var N=rs(u);N='link[rel="'+c+'"][href="'+N+'"]',typeof g=="string"&&(N+='[crossorigin="'+g+'"]'),qw.has(N)||(qw.add(N),c={rel:c,crossOrigin:g,href:u},v.querySelector(N)===null&&(u=v.createElement("link"),Os(u,"link",c),$r(u),v.head.appendChild(u)))}}function nI(c){ha.D(c),Hw("dns-prefetch",c,null)}function sI(c,u){ha.C(c,u),Hw("preconnect",c,u)}function iI(c,u,g){ha.L(c,u,g);var v=Kc;if(v&&c&&u){var N='link[rel="preload"][as="'+rs(u)+'"]';u==="image"&&g&&g.imageSrcSet?(N+='[imagesrcset="'+rs(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(N+='[imagesizes="'+rs(g.imageSizes)+'"]')):N+='[href="'+rs(c)+'"]';var L=N;switch(u){case"style":L=Vc(c);break;case"script":L=Xc(c)}Ki.has(L)||(c=h({rel:"preload",href:u==="image"&&g&&g.imageSrcSet?void 0:c,as:u},g),Ki.set(L,c),v.querySelector(N)!==null||u==="style"&&v.querySelector(Iu(L))||u==="script"&&v.querySelector(Pu(L))||(u=v.createElement("link"),Os(u,"link",c),$r(u),v.head.appendChild(u)))}}function oI(c,u){ha.m(c,u);var g=Kc;if(g&&c){var v=u&&typeof u.as=="string"?u.as:"script",N='link[rel="modulepreload"][as="'+rs(v)+'"][href="'+rs(c)+'"]',L=N;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":L=Xc(c)}if(!Ki.has(L)&&(c=h({rel:"modulepreload",href:c},u),Ki.set(L,c),g.querySelector(N)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(Pu(L)))return}v=g.createElement("link"),Os(v,"link",c),$r(v),g.head.appendChild(v)}}}function aI(c,u,g){ha.S(c,u,g);var v=Kc;if(v&&c){var N=rn(v).hoistableStyles,L=Vc(c);u=u||"default";var te=N.get(L);if(!te){var we={loading:0,preload:null};if(te=v.querySelector(Iu(L)))we.loading=5;else{c=h({rel:"stylesheet",href:c,"data-precedence":u},g),(g=Ki.get(L))&&fy(c,g);var Fe=te=v.createElement("link");$r(Fe),Os(Fe,"link",c),Fe._p=new Promise(function(nt,dt){Fe.onload=nt,Fe.onerror=dt}),Fe.addEventListener("load",function(){we.loading|=1}),Fe.addEventListener("error",function(){we.loading|=2}),we.loading|=4,Qh(te,u,v)}te={type:"stylesheet",instance:te,count:1,state:we},N.set(L,te)}}}function lI(c,u){ha.X(c,u);var g=Kc;if(g&&c){var v=rn(g).hoistableScripts,N=Xc(c),L=v.get(N);L||(L=g.querySelector(Pu(N)),L||(c=h({src:c,async:!0},u),(u=Ki.get(N))&&gy(c,u),L=g.createElement("script"),$r(L),Os(L,"link",c),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},v.set(N,L))}}function cI(c,u){ha.M(c,u);var g=Kc;if(g&&c){var v=rn(g).hoistableScripts,N=Xc(c),L=v.get(N);L||(L=g.querySelector(Pu(N)),L||(c=h({src:c,async:!0,type:"module"},u),(u=Ki.get(N))&&gy(c,u),L=g.createElement("script"),$r(L),Os(L,"link",c),g.head.appendChild(L)),L={type:"script",instance:L,count:1,state:null},v.set(N,L))}}function Yw(c,u,g,v){var N=(N=me.current)?Jh(N):null;if(!N)throw Error(n(446));switch(c){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(u=Vc(g.href),g=rn(N).hoistableStyles,v=g.get(u),v||(v={type:"style",instance:null,count:0,state:null},g.set(u,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){c=Vc(g.href);var L=rn(N).hoistableStyles,te=L.get(c);if(te||(N=N.ownerDocument||N,te={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},L.set(c,te),(L=N.querySelector(Iu(c)))&&!L._p&&(te.instance=L,te.state.loading=5),Ki.has(c)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Ki.set(c,g),L||dI(N,c,g,te.state))),u&&v===null)throw Error(n(528,""));return te}if(u&&v!==null)throw Error(n(529,""));return null;case"script":return u=g.async,g=g.src,typeof g=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=Xc(g),g=rn(N).hoistableScripts,v=g.get(u),v||(v={type:"script",instance:null,count:0,state:null},g.set(u,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,c))}}function Vc(c){return'href="'+rs(c)+'"'}function Iu(c){return'link[rel="stylesheet"]['+c+"]"}function Kw(c){return h({},c,{"data-precedence":c.precedence,precedence:null})}function dI(c,u,g,v){c.querySelector('link[rel="preload"][as="style"]['+u+"]")?v.loading=1:(u=c.createElement("link"),v.preload=u,u.addEventListener("load",function(){return v.loading|=1}),u.addEventListener("error",function(){return v.loading|=2}),Os(u,"link",g),$r(u),c.head.appendChild(u))}function Xc(c){return'[src="'+rs(c)+'"]'}function Pu(c){return"script[async]"+c}function Vw(c,u,g){if(u.count++,u.instance===null)switch(u.type){case"style":var v=c.querySelector('style[data-href~="'+rs(g.href)+'"]');if(v)return u.instance=v,$r(v),v;var N=h({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return v=(c.ownerDocument||c).createElement("style"),$r(v),Os(v,"style",N),Qh(v,g.precedence,c),u.instance=v;case"stylesheet":N=Vc(g.href);var L=c.querySelector(Iu(N));if(L)return u.state.loading|=4,u.instance=L,$r(L),L;v=Kw(g),(N=Ki.get(N))&&fy(v,N),L=(c.ownerDocument||c).createElement("link"),$r(L);var te=L;return te._p=new Promise(function(we,Fe){te.onload=we,te.onerror=Fe}),Os(L,"link",v),u.state.loading|=4,Qh(L,g.precedence,c),u.instance=L;case"script":return L=Xc(g.src),(N=c.querySelector(Pu(L)))?(u.instance=N,$r(N),N):(v=g,(N=Ki.get(L))&&(v=h({},g),gy(v,N)),c=c.ownerDocument||c,N=c.createElement("script"),$r(N),Os(N,"link",v),c.head.appendChild(N),u.instance=N);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(v=u.instance,u.state.loading|=4,Qh(v,g.precedence,c));return u.instance}function Qh(c,u,g){for(var v=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),N=v.length?v[v.length-1]:null,L=N,te=0;te<v.length;te++){var we=v[te];if(we.dataset.precedence===u)L=we;else if(L!==N)break}L?L.parentNode.insertBefore(c,L.nextSibling):(u=g.nodeType===9?g.head:g,u.insertBefore(c,u.firstChild))}function fy(c,u){c.crossOrigin==null&&(c.crossOrigin=u.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=u.referrerPolicy),c.title==null&&(c.title=u.title)}function gy(c,u){c.crossOrigin==null&&(c.crossOrigin=u.crossOrigin),c.referrerPolicy==null&&(c.referrerPolicy=u.referrerPolicy),c.integrity==null&&(c.integrity=u.integrity)}var Zh=null;function Xw(c,u,g){if(Zh===null){var v=new Map,N=Zh=new Map;N.set(g,v)}else N=Zh,v=N.get(g),v||(v=new Map,N.set(g,v));if(v.has(c))return v;for(v.set(c,null),g=g.getElementsByTagName(c),N=0;N<g.length;N++){var L=g[N];if(!(L[Ot]||L[Zt]||c==="link"&&L.getAttribute("rel")==="stylesheet")&&L.namespaceURI!=="http://www.w3.org/2000/svg"){var te=L.getAttribute(u)||"";te=c+te;var we=v.get(te);we?we.push(L):v.set(te,[L])}}return v}function Jw(c,u,g){c=c.ownerDocument||c,c.head.insertBefore(g,u==="title"?c.querySelector("head > title"):null)}function uI(c,u,g){if(g===1||u.itemProp!=null)return!1;switch(c){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;return u.rel==="stylesheet"?(c=u.disabled,typeof u.precedence=="string"&&c==null):!0;case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function Qw(c){return!(c.type==="stylesheet"&&(c.state.loading&3)===0)}function pI(c,u,g,v){if(g.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var N=Vc(v.href),L=u.querySelector(Iu(N));if(L){u=L._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(c.count++,c=ef.bind(c),u.then(c,c)),g.state.loading|=4,g.instance=L,$r(L);return}L=u.ownerDocument||u,v=Kw(v),(N=Ki.get(N))&&fy(v,N),L=L.createElement("link"),$r(L);var te=L;te._p=new Promise(function(we,Fe){te.onload=we,te.onerror=Fe}),Os(L,"link",v),g.instance=L}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(g,u),(u=g.state.preload)&&(g.state.loading&3)===0&&(c.count++,g=ef.bind(c),u.addEventListener("load",g),u.addEventListener("error",g))}}var xy=0;function hI(c,u){return c.stylesheets&&c.count===0&&rf(c,c.stylesheets),0<c.count||0<c.imgCount?function(g){var v=setTimeout(function(){if(c.stylesheets&&rf(c,c.stylesheets),c.unsuspend){var L=c.unsuspend;c.unsuspend=null,L()}},6e4+u);0<c.imgBytes&&xy===0&&(xy=62500*YD());var N=setTimeout(function(){if(c.waitingForImages=!1,c.count===0&&(c.stylesheets&&rf(c,c.stylesheets),c.unsuspend)){var L=c.unsuspend;c.unsuspend=null,L()}},(c.imgBytes>xy?50:800)+u);return c.unsuspend=g,function(){c.unsuspend=null,clearTimeout(v),clearTimeout(N)}}:null}function ef(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)rf(this,this.stylesheets);else if(this.unsuspend){var c=this.unsuspend;this.unsuspend=null,c()}}}var tf=null;function rf(c,u){c.stylesheets=null,c.unsuspend!==null&&(c.count++,tf=new Map,u.forEach(fI,c),tf=null,ef.call(c))}function fI(c,u){if(!(u.state.loading&4)){var g=tf.get(c);if(g)var v=g.get(null);else{g=new Map,tf.set(c,g);for(var N=c.querySelectorAll("link[data-precedence],style[data-precedence]"),L=0;L<N.length;L++){var te=N[L];(te.nodeName==="LINK"||te.getAttribute("media")!=="not all")&&(g.set(te.dataset.precedence,te),v=te)}v&&g.set(null,v)}N=u.instance,te=N.getAttribute("data-precedence"),L=g.get(te)||v,L===v&&g.set(null,N),g.set(te,N),this.count++,v=ef.bind(this),N.addEventListener("load",v),N.addEventListener("error",v),L?L.parentNode.insertBefore(N,L.nextSibling):(c=c.nodeType===9?c.head:c,c.insertBefore(N,c.firstChild)),u.state.loading|=4}}var Lu={$$typeof:E,Provider:null,Consumer:null,_currentValue:D,_currentValue2:D,_threadCount:0};function gI(c,u,g,v,N,L,te,we,Fe){this.tag=1,this.containerInfo=c,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ze(0),this.hiddenUpdates=Ze(null),this.identifierPrefix=v,this.onUncaughtError=N,this.onCaughtError=L,this.onRecoverableError=te,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Fe,this.incompleteTransitions=new Map}function Zw(c,u,g,v,N,L,te,we,Fe,nt,dt,gt){return c=new gI(c,u,g,te,Fe,nt,dt,gt,we),u=1,L===!0&&(u|=24),L=ji(3,null,null,u),c.current=L,L.stateNode=c,u=Vx(),u.refCount++,c.pooledCache=u,u.refCount++,L.memoizedState={element:v,isDehydrated:g,cache:u},Zx(L),c}function eE(c){return c?(c=Ac,c):Ac}function tE(c,u,g,v,N,L){N=eE(N),v.context===null?v.context=N:v.pendingContext=N,v=Ia(u),v.payload={element:g},L=L===void 0?null:L,L!==null&&(v.callback=L),g=Pa(c,v,u),g!==null&&(pi(g,c,u),fu(g,c,u))}function rE(c,u){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var g=c.retryLane;c.retryLane=g!==0&&g<u?g:u}}function my(c,u){rE(c,u),(c=c.alternate)&&rE(c,u)}function nE(c){if(c.tag===13||c.tag===31){var u=Dl(c,67108864);u!==null&&pi(u,c,67108864),my(c,67108864)}}function sE(c){if(c.tag===13||c.tag===31){var u=Ni();u=Et(u);var g=Dl(c,u);g!==null&&pi(g,c,u),my(c,u)}}var nf=!0;function xI(c,u,g,v){var N=$.T;$.T=null;var L=W.p;try{W.p=2,yy(c,u,g,v)}finally{W.p=L,$.T=N}}function mI(c,u,g,v){var N=$.T;$.T=null;var L=W.p;try{W.p=8,yy(c,u,g,v)}finally{W.p=L,$.T=N}}function yy(c,u,g,v){if(nf){var N=by(v);if(N===null)sy(c,u,v,sf,g),oE(c,v);else if(bI(N,c,u,g,v))v.stopPropagation();else if(oE(c,v),u&4&&-1<yI.indexOf(c)){for(;N!==null;){var L=Ct(N);if(L!==null)switch(L.tag){case 3:if(L=L.stateNode,L.current.memoizedState.isDehydrated){var te=ne(L.pendingLanes);if(te!==0){var we=L;for(we.pendingLanes|=2,we.entangledLanes|=2;te;){var Fe=1<<31-Qe(te);we.entanglements[1]|=Fe,te&=~Fe}_o(L),(Xr&6)===0&&(Fh=Ee()+500,Nu(0))}}break;case 31:case 13:we=Dl(L,2),we!==null&&pi(we,L,2),Gh(),my(L,2)}if(L=by(v),L===null&&sy(c,u,v,sf,g),L===N)break;N=L}N!==null&&v.stopPropagation()}else sy(c,u,v,null,g)}}function by(c){return c=Sx(c),vy(c)}var sf=null;function vy(c){if(sf=null,c=Dt(c),c!==null){var u=o(c);if(u===null)c=null;else{var g=u.tag;if(g===13){if(c=a(u),c!==null)return c;c=null}else if(g===31){if(c=l(u),c!==null)return c;c=null}else if(g===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;c=null}else u!==c&&(c=null)}}return sf=c,null}function iE(c){switch(c){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Oe()){case q:return 2;case ee:return 8;case ce:case Ce:return 32;case be:return 268435456;default:return 32}default:return 32}}var Sy=!1,Ha=null,Ya=null,Ka=null,zu=new Map,Mu=new Map,Va=[],yI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function oE(c,u){switch(c){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":Ya=null;break;case"mouseover":case"mouseout":Ka=null;break;case"pointerover":case"pointerout":zu.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mu.delete(u.pointerId)}}function Bu(c,u,g,v,N,L){return c===null||c.nativeEvent!==L?(c={blockedOn:u,domEventName:g,eventSystemFlags:v,nativeEvent:L,targetContainers:[N]},u!==null&&(u=Ct(u),u!==null&&nE(u)),c):(c.eventSystemFlags|=v,u=c.targetContainers,N!==null&&u.indexOf(N)===-1&&u.push(N),c)}function bI(c,u,g,v,N){switch(u){case"focusin":return Ha=Bu(Ha,c,u,g,v,N),!0;case"dragenter":return Ya=Bu(Ya,c,u,g,v,N),!0;case"mouseover":return Ka=Bu(Ka,c,u,g,v,N),!0;case"pointerover":var L=N.pointerId;return zu.set(L,Bu(zu.get(L)||null,c,u,g,v,N)),!0;case"gotpointercapture":return L=N.pointerId,Mu.set(L,Bu(Mu.get(L)||null,c,u,g,v,N)),!0}return!1}function aE(c){var u=Dt(c.target);if(u!==null){var g=o(u);if(g!==null){if(u=g.tag,u===13){if(u=a(g),u!==null){c.blockedOn=u,vt(c.priority,function(){sE(g)});return}}else if(u===31){if(u=l(g),u!==null){c.blockedOn=u,vt(c.priority,function(){sE(g)});return}}else if(u===3&&g.stateNode.current.memoizedState.isDehydrated){c.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}c.blockedOn=null}function of(c){if(c.blockedOn!==null)return!1;for(var u=c.targetContainers;0<u.length;){var g=by(c.nativeEvent);if(g===null){g=c.nativeEvent;var v=new g.constructor(g.type,g);vx=v,g.target.dispatchEvent(v),vx=null}else return u=Ct(g),u!==null&&nE(u),c.blockedOn=g,!1;u.shift()}return!0}function lE(c,u,g){of(c)&&g.delete(u)}function vI(){Sy=!1,Ha!==null&&of(Ha)&&(Ha=null),Ya!==null&&of(Ya)&&(Ya=null),Ka!==null&&of(Ka)&&(Ka=null),zu.forEach(lE),Mu.forEach(lE)}function af(c,u){c.blockedOn===u&&(c.blockedOn=null,Sy||(Sy=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,vI)))}var lf=null;function cE(c){lf!==c&&(lf=c,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){lf===c&&(lf=null);for(var u=0;u<c.length;u+=3){var g=c[u],v=c[u+1],N=c[u+2];if(typeof v!="function"){if(vy(v||g)===null)continue;break}var L=Ct(g);L!==null&&(c.splice(u,3),u-=3,bm(L,{pending:!0,data:N,method:g.method,action:v},v,N))}}))}function Jc(c){function u(Fe){return af(Fe,c)}Ha!==null&&af(Ha,c),Ya!==null&&af(Ya,c),Ka!==null&&af(Ka,c),zu.forEach(u),Mu.forEach(u);for(var g=0;g<Va.length;g++){var v=Va[g];v.blockedOn===c&&(v.blockedOn=null)}for(;0<Va.length&&(g=Va[0],g.blockedOn===null);)aE(g),g.blockedOn===null&&Va.shift();if(g=(c.ownerDocument||c).$$reactFormReplay,g!=null)for(v=0;v<g.length;v+=3){var N=g[v],L=g[v+1],te=N[mr]||null;if(typeof L=="function")te||cE(g);else if(te){var we=null;if(L&&L.hasAttribute("formAction")){if(N=L,te=L[mr]||null)we=te.formAction;else if(vy(N)!==null)continue}else we=te.action;typeof we=="function"?g[v+1]=we:(g.splice(v,3),v-=3),cE(g)}}}function dE(){function c(L){L.canIntercept&&L.info==="react-transition"&&L.intercept({handler:function(){return new Promise(function(te){return N=te})},focusReset:"manual",scroll:"manual"})}function u(){N!==null&&(N(),N=null),v||setTimeout(g,20)}function g(){if(!v&&!navigation.transition){var L=navigation.currentEntry;L&&L.url!=null&&navigation.navigate(L.url,{state:L.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var v=!1,N=null;return navigation.addEventListener("navigate",c),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(g,100),function(){v=!0,navigation.removeEventListener("navigate",c),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),N!==null&&(N(),N=null)}}}function wy(c){this._internalRoot=c}cf.prototype.render=wy.prototype.render=function(c){var u=this._internalRoot;if(u===null)throw Error(n(409));var g=u.current,v=Ni();tE(g,v,c,u,null,null)},cf.prototype.unmount=wy.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var u=c.containerInfo;tE(c.current,2,null,c,null,null),Gh(),u[Cr]=null}};function cf(c){this._internalRoot=c}cf.prototype.unstable_scheduleHydration=function(c){if(c){var u=it();c={blockedOn:null,target:c,priority:u};for(var g=0;g<Va.length&&u!==0&&u<Va[g].priority;g++);Va.splice(g,0,c),g===0&&aE(c)}};var uE=e.version;if(uE!=="19.2.3")throw Error(n(527,uE,"19.2.3"));W.findDOMNode=function(c){var u=c._reactInternals;if(u===void 0)throw typeof c.render=="function"?Error(n(188)):(c=Object.keys(c).join(","),Error(n(268,c)));return c=p(u),c=c!==null?f(c):null,c=c===null?null:c.stateNode,c};var SI={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!df.isDisabled&&df.supportsFiber)try{se=df.inject(SI),Te=df}catch{}}return $u.createRoot=function(c,u){if(!i(c))throw Error(n(299));var g=!1,v="",N=yS,L=bS,te=vS;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(N=u.onUncaughtError),u.onCaughtError!==void 0&&(L=u.onCaughtError),u.onRecoverableError!==void 0&&(te=u.onRecoverableError)),u=Zw(c,1,!1,null,null,g,v,null,N,L,te,dE),c[Cr]=u.current,ny(c),new wy(u)},$u.hydrateRoot=function(c,u,g){if(!i(c))throw Error(n(299));var v=!1,N="",L=yS,te=bS,we=vS,Fe=null;return g!=null&&(g.unstable_strictMode===!0&&(v=!0),g.identifierPrefix!==void 0&&(N=g.identifierPrefix),g.onUncaughtError!==void 0&&(L=g.onUncaughtError),g.onCaughtError!==void 0&&(te=g.onCaughtError),g.onRecoverableError!==void 0&&(we=g.onRecoverableError),g.formState!==void 0&&(Fe=g.formState)),u=Zw(c,1,!0,u,g??null,v,N,Fe,L,te,we,dE),u.context=eE(null),g=u.current,v=Ni(),v=Et(v),N=Ia(v),N.callback=null,Pa(g,N,v),g=v,u.current.lanes=g,xt(u,g),_o(u),c[Cr]=u.current,ny(c),new cf(u)},$u.version="19.2.3",$u}var bE;function pP(){if(bE)return Ey.exports;bE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ey.exports=uP(),Ey.exports}var hP=pP();const pf="Request cancelled";async function tn(s,e){const r=e?.signal;if(r?.aborted)throw new Error(pf);const n=e?.maxRedirections,i=e?.connectTimeout,o=e?.proxy,a=e?.danger;e&&(delete e.maxRedirections,delete e.connectTimeout,delete e.proxy,delete e.danger);const l=e?.headers?e.headers instanceof Headers?e.headers:new Headers(e.headers):new Headers,d=new Request(s,e),p=await d.arrayBuffer(),f=p.byteLength!==0?Array.from(new Uint8Array(p)):null;for(const[A,R]of d.headers)l.get(A)||l.set(A,R);const x=(l instanceof Headers?Array.from(l.entries()):Array.isArray(l)?l:Object.entries(l)).map(([A,R])=>[A,typeof R=="string"?R:R.toString()]);if(r?.aborted)throw new Error(pf);const m=await lt("plugin:http|fetch",{clientConfig:{method:d.method,url:d.url,headers:x,data:f,maxRedirections:n,connectTimeout:i,proxy:o,danger:a}}),b=()=>lt("plugin:http|fetch_cancel",{rid:m});if(r?.aborted)throw b(),new Error(pf);r?.addEventListener("abort",()=>{b()});const{status:w,statusText:y,url:C,headers:T,rid:E}=await lt("plugin:http|fetch_send",{rid:m}),j=[101,103,204,205,304].includes(w)?null:new ReadableStream({start:A=>{const R=new D0;R.onmessage=M=>{if(r?.aborted){A.error(pf);return}const P=new Uint8Array(M),I=P[P.byteLength-1],O=P.slice(0,P.byteLength-1);if(I==1){A.close();return}A.enqueue(O)},lt("plugin:http|fetch_read_body",{rid:E,streamChannel:R}).catch(M=>{A.error(M)})}}),k=new Response(j,{status:w,statusText:y});return Object.defineProperty(k,"url",{value:C}),Object.defineProperty(k,"headers",{value:new Headers(T)}),k}const fP={BASE_URL:"https://finceptbackend.share.zrok.io"},gP=s=>`${fP.BASE_URL}${s}`,ys=async(s,e,r,n)=>{try{const i={"Content-Type":"application/json",...n},o=gP(e);console.log(" Making auth request:",{method:s,url:o,endpoint:e,data:r,headers:{...i,"X-API-Key":i["X-API-Key"]?"[REDACTED]":void 0}});const a={method:s,headers:i,mode:"cors"};r&&(s==="POST"||s==="PUT")&&(a.body=JSON.stringify(r));const l=await tn(o,a);console.log(" Auth response received:",{status:l.status,statusText:l.statusText,headers:Object.fromEntries(l.headers.entries()),url:l.url});const d=await l.text();console.log(" Raw auth response text:",d.substring(0,200));let p;try{p=JSON.parse(d),console.log(" Parsed auth JSON:",p)}catch(h){console.error(" Auth JSON parse failed:",h),console.log(" Full auth response text:",d);let x="Unable to connect to server. Please try again later.";return l.status===401||l.status===403?x="Invalid email or password. Please check your credentials and try again.":l.status===404?x="Account not found. Please check your email or sign up for a new account.":l.status===400?x="Invalid request. Please check your information and try again.":l.status>=500?x="Server error. Please try again later.":l.ok||(x="An error occurred. Please try again."),{success:!1,error:x,status_code:l.status}}let f;if(!l.ok){const h=p.message||p.error||"";l.status===401||l.status===403?h.toLowerCase().includes("password")?f="Incorrect password. Please try again.":(h.toLowerCase().includes("credential"),f="Invalid email or password. Please check your credentials and try again."):l.status===404?f="Account not found. Please check your email or sign up for a new account.":l.status===400?f=h||"Invalid request. Please check your information and try again.":l.status>=500?f="Server error. Please try again later.":f=h||`HTTP ${l.status}`}return{success:l.ok,data:p,status_code:l.status,error:f}}catch(i){return console.error(" Auth request failed completely:",i),i instanceof TypeError&&i.message.includes("Failed to fetch")?{success:!1,error:"Network error: Unable to connect to server. Please check your internet connection or try again later."}:{success:!1,error:i instanceof Error?i.message:"Network error"}}};class no{static async checkHealth(){try{return(await ys("GET","/health")).success}catch(e){return console.error("Health check failed:",e),!1}}static async login(e){return ys("POST","/user/login",e)}static async register(e){return ys("POST","/user/register",e)}static async verifyOtp(e){return ys("POST","/user/verify-otp",e)}static async forgotPassword(e){return ys("POST","/user/forgot-password",e)}static async resetPassword(e){return ys("POST","/user/reset-password",e)}static async getUserProfile(e){return ys("GET","/user/profile",void 0,{"X-API-Key":e})}static async getAuthStatus(e,r){const n={};return e&&(n["X-API-Key"]=e),r&&(n["X-Device-ID"]=r),ys("GET","/auth/status",void 0,n)}static async registerDevice(e){return ys("POST","/guest/register",e)}static async getGuestStatus(e){return ys("GET","/guest/status",void 0,{"X-API-Key":e})}static async updateUserProfile(e,r){return ys("PUT","/user/profile",r,{"X-API-Key":e})}static async regenerateApiKey(e){return ys("POST","/user/regenerate-api-key",void 0,{"X-API-Key":e})}static async getUserUsage(e){return ys("GET","/user/usage",void 0,{"X-API-Key":e})}static async getUserSubscriptions(e){return ys("GET","/user/subscriptions",void 0,{"X-API-Key":e})}static async subscribeToDatabase(e,r){return ys("POST","/user/subscribe",{database_name:r},{"X-API-Key":e})}static async getUserTransactions(e){return ys("GET","/user/transactions",void 0,{"X-API-Key":e})}static async deleteAccount(e,r){return ys("DELETE","/user/account",{password:r},{"X-API-Key":e})}static async testApiConnectivity(e){try{if(!await this.checkHealth())return{success:!1,error:"API server is not responding"};if(e){const i=await this.getAuthStatus(e,"test_device");return{success:i.success,response:i.data,authenticated:i.data?.authenticated||!1,error:i.error}}const n=await ys("GET","/test");return{success:n.success,response:n.data,error:n.error}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Connectivity test failed"}}}static async validateSession(e,r){try{const n=await this.getAuthStatus(e,r);return n.success&&n.data?.authenticated?{valid:!0,userType:n.data.user_type,userData:n.data.user||n.data.guest}:{valid:!1,error:n.error||"Session invalid"}}catch(n){return{valid:!1,error:n instanceof Error?n.message:"Session validation failed"}}}static async refreshSession(e){try{const[r,n,i]=await Promise.all([this.getUserProfile(e),this.getUserUsage(e),this.getUserSubscriptions(e)]);return r.success?{success:!0,data:{profile:r.data,usage:n.data,subscriptions:i.data}}:{success:!1,error:r.error||"Failed to refresh session"}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Session refresh failed"}}}}const xP={BASE_URL:"https://finceptbackend.share.zrok.io"},mP=s=>`${xP.BASE_URL}${s}`;let z0=null;const yP=s=>{z0=s},Vi=async(s,e,r,n)=>{try{const i={"Content-Type":"application/json",...n},o=mP(e);console.log(" Making payment request:",{method:s,url:o,endpoint:e,data:r,timestamp:new Date().toISOString()});const a={...i};a["X-API-Key"]&&(a["X-API-Key"]="[REDACTED - Length: "+a["X-API-Key"].length+"]"),console.log(" Request headers:",a);const l=!!n?.["X-API-Key"],d=n?.["X-API-Key"]?.length||0;console.log(" API Key debug:",{hasApiKey:l,apiKeyLength:d,headerKeys:Object.keys(i),originalHeaderKeys:n?Object.keys(n):"none"});const p={method:s,headers:i,mode:"cors"};r&&(s==="POST"||s==="PUT")&&(p.body=JSON.stringify(r),console.log(" Request body:",JSON.stringify(r,null,2))),console.log(" Final fetch config:",{url:o,method:p.method,mode:p.mode,hasBody:!!p.body,bodyLength:p.body?p.body.length:0});const f=await tn(o,p);console.log(" Payment response received:",{status:f.status,statusText:f.statusText,url:f.url,ok:f.ok,headers:Object.fromEntries(f.headers.entries())});const h=await f.text();console.log(" Payment response text (first 500 chars):",h.substring(0,500)),console.log(" Payment response full length:",h.length);let x;try{x=JSON.parse(h),console.log(" Payment JSON parsed successfully:",{success:x.success,hasData:!!x.data,message:x.message,error:x.error,errorCode:x.error_code})}catch(m){return console.error(" Payment JSON parse failed:",m),console.log(" Raw response that failed to parse:",h),{success:!1,error:`Invalid JSON response: ${h.substring(0,100)}...`,status_code:f.status}}return f.ok||console.error(" Payment request failed:",{status:f.status,statusText:f.statusText,responseData:x,requestHeaders:a,requestUrl:o,requestMethod:s}),{success:f.ok,data:x,status_code:f.status,error:f.ok?void 0:x.message||`HTTP ${f.status}`}}catch(i){return console.error(" Payment request failed completely:",i),console.error(" Error details:",{name:i instanceof Error?i.name:"Unknown",message:i instanceof Error?i.message:"Unknown error",stack:i instanceof Error?i.stack:"No stack trace"}),i instanceof TypeError&&i.message.includes("Failed to fetch")?{success:!1,error:"Network error: Unable to connect to payment server. Please check your connection."}:{success:!1,error:i instanceof Error?i.message:"Payment network error"}}};class sc{static async getSubscriptionPlans(){console.log(" PaymentApiService: Starting getSubscriptionPlans request");const e=await Vi("GET","/payment/plans");return console.log(" PaymentApiService: getSubscriptionPlans result:",{success:e.success,hasData:!!e.data,statusCode:e.status_code,error:e.error}),e.success&&e.data&&(console.log(" PaymentApiService: Raw API response structure:",{dataKeys:Object.keys(e.data),hasPlans:!!e.data.plans,hasDataProperty:!!e.data.data,plansCount:e.data.plans?.length||"no plans array"}),e.data.plans?(console.log(" PaymentApiService: Found plans directly in result.data"),console.log(" PaymentApiService: Number of plans:",e.data.plans.length)):e.data.data&&e.data.data.plans?(console.log(" PaymentApiService: Found plans in result.data.data"),console.log(" PaymentApiService: Number of plans:",e.data.data.plans.length)):(console.log(" PaymentApiService: Plans not found in expected location"),console.log(" PaymentApiService: Available properties:",Object.keys(e.data)))),e}static async getPlanDetails(e){return console.log(" PaymentApiService: Getting plan details for:",e),Vi("GET",`/payment/plans/${e}`)}static async createCheckoutSession(e,r){if(console.log(" PaymentApiService: createCheckoutSession called"),console.log(" PaymentApiService: API Key debug:",{hasApiKey:!!e,apiKeyType:typeof e,apiKeyLength:e?.length||0,apiKeyPrefix:e?e.substring(0,10)+"...":"null",apiKeyValid:e&&e.length>10}),console.log(" PaymentApiService: Request data:",r),!e)return console.error(" PaymentApiService: No API key provided!"),{success:!1,error:"No API key provided"};if(typeof e!="string")return console.error(" PaymentApiService: API key is not a string:",typeof e),{success:!1,error:"Invalid API key format"};const n={"X-API-Key":e};console.log(" PaymentApiService: Headers being passed:",{"X-API-Key":"[REDACTED - Length: "+e.length+"]",headerCount:Object.keys(n).length});const i=await Vi("POST","/payment/checkout",r,n);return console.log(" PaymentApiService: createCheckoutSession result:",{success:i.success,statusCode:i.status_code,error:i.error,hasData:!!i.data}),i}static async handlePaymentSuccess(e,r,n){console.log(" PaymentApiService: handlePaymentSuccess called:",{hasApiKey:!!e,sessionId:r,paymentId:n});const i=new URLSearchParams;r&&i.append("session_id",r),n&&i.append("payment_id",n);const o=i.toString(),a=`/payment/success${o?`?${o}`:""}`;return Vi("GET",a,void 0,{"X-API-Key":e})}static async getUserSubscription(e){return console.log(" PaymentApiService: getUserSubscription called:",{hasApiKey:!!e,apiKeyLength:e?.length||0}),Vi("GET","/payment/subscription",void 0,{"X-API-Key":e})}static async getUserUsage(e){return console.log(" PaymentApiService: getUserUsage called"),Vi("GET","/payment/usage",void 0,{"X-API-Key":e})}static async cancelSubscription(e){return console.log(" PaymentApiService: cancelSubscription called"),Vi("POST","/payment/cancel",void 0,{"X-API-Key":e})}static async reactivateSubscription(e){return console.log(" PaymentApiService: reactivateSubscription called"),Vi("POST","/payment/reactivate",void 0,{"X-API-Key":e})}static async getPaymentHistory(e,r=1,n=10){return console.log(" PaymentApiService: getPaymentHistory called:",{page:r,limit:n}),Vi("GET",`/payment/payments?page=${r}&limit=${n}`,void 0,{"X-API-Key":e})}static async getPaymentDetails(e,r){return console.log(" PaymentApiService: getPaymentDetails called:",r),Vi("GET",`/payment/payments/${r}`,void 0,{"X-API-Key":e})}static async validateWebhook(e){return console.log(" PaymentApiService: validateWebhook called"),Vi("POST","/payment/webhook",e)}static async testApiKey(e){console.log(" PaymentApiService: Testing API key validity"),console.log(" API Key test details:",{hasApiKey:!!e,apiKeyLength:e?.length||0,apiKeyPrefix:e?e.substring(0,15)+"...":"null"});const r=await Vi("GET","/payment/subscription",void 0,{"X-API-Key":e});return console.log(" API Key test result:",{success:r.success,statusCode:r.status_code,error:r.error}),r}}class qf{static formatCurrency(e,r="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:r,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}static calculateAnnualSavings(e){const r=e*10;return e*12-r}static getRecommendedPlan(e){return e<=1e4?"starter_20":e<=5e4?"professional_49":e<=2e5?"enterprise_99":"unlimited_199"}static validatePlanSelection(e,r){return r.some(n=>n.plan_id===e)}static parsePaymentParams(e){const r=new URLSearchParams(e.split("?")[1]);return{sessionId:r.get("session_id")||void 0,paymentId:r.get("payment_id")||void 0}}static isSubscriptionExpiringSoon(e){const r=new Date(e),n=new Date,i=Math.ceil((r.getTime()-n.getTime())/(1e3*60*60*24));return i<=7&&i>0}static getUsageStatus(e,r){if(r==="unlimited"||r===-1)return{percentage:0,status:"low",color:"green"};const n=typeof r=="string"?parseInt(r):r,i=Math.min(e/n*100,100);let o,a;return i>=95?(o="critical",a="red"):i>=80?(o="high",a="orange"):i>=50?(o="medium",a="yellow"):(o="low",a="green"),{percentage:Math.round(i),status:o,color:a}}static validatePaymentUrl(e){if(!e||e==="undefined"||e==="null")return!1;try{const r=new URL(e);if(!["http:","https:"].includes(r.protocol))return!1;const n=["javascript:","data:","file:"];for(const i of n)if(e.toLowerCase().includes(i))return console.warn("PaymentUtils: Dangerous URL pattern detected:",i),!1;return r.protocol==="https:",!0}catch(r){return console.error("PaymentUtils: Invalid URL format:",r),!1}}static async openPaymentUrl(e,r="Subscription",n=0){if(console.log("PaymentUtils: Opening payment URL:",e),!this.validatePaymentUrl(e))return console.error("PaymentUtils: Invalid checkout URL provided"),alert("Payment URL is invalid. Please try again or contact support."),!1;try{return z0?(console.log("PaymentUtils: Using in-app payment window"),await z0.openPaymentWindow(e,r,n)):(console.log("PaymentUtils: Falling back to external browser"),this.openPaymentUrlExternal(e))}catch(i){return console.error("PaymentUtils: Failed to open payment window:",i),this.openPaymentUrlExternal(e)}}static async openValidatedPaymentUrl(e,r="Subscription",n=0){return this.validatePaymentUrl(e)?this.openPaymentUrl(e,r,n):(console.error("PaymentUtils: Invalid or suspicious payment URL"),alert("Invalid payment URL. Please contact support."),!1)}static openPaymentUrlExternal(e){try{return window.open(e,"_blank","noopener,noreferrer")?!0:(console.warn("PaymentUtils: Popup blocked, trying clipboard fallback"),navigator.clipboard&&e!=="undefined"?navigator.clipboard.writeText(e).then(()=>{alert(`Popup blocked. Payment URL copied to clipboard: ${e}`)}).catch(()=>{alert(`Please visit this URL to complete payment: ${e}`)}):alert(`Please visit this URL to complete payment: ${e}`),!1)}catch(r){return console.error("PaymentUtils: Failed to open external payment URL:",r),alert(`Please visit this URL to complete payment: ${e}`),!1}}static generateReceiptData(e){return{receiptId:e.payment_uuid||"N/A",date:new Date().toLocaleDateString(),description:`Fincept API Subscription - ${e.plan?.name||"Plan"}`,amount:this.formatCurrency(e.plan?.price||0),status:e.status||"Completed"}}}const hA=S.createContext(void 0),ky=()=>{const e={platform:navigator.platform,userAgent:navigator.userAgent,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine},r=JSON.stringify(e);let n=0;for(let i=0;i<r.length;i++){const o=r.charCodeAt(i);n=(n<<5)-n+o,n=n&n}return`desktop_${Math.abs(n).toString(16)}`},Ug="fincept_session",Gu=s=>{try{localStorage.setItem(Ug,JSON.stringify({...s,saved_at:new Date().toISOString()}))}catch(e){console.error("Failed to save session:",e)}},bP=()=>{try{const s=localStorage.getItem(Ug);if(!s)return null;const e=JSON.parse(s);return e.user_type==="guest"&&e.expires_at&&new Date>new Date(e.expires_at)?(ng(),null):e}catch(s){return console.error("Failed to load session:",s),ng(),null}},ng=()=>{try{localStorage.removeItem(Ug)}catch(s){console.error("Failed to clear session:",s)}},Uu=()=>!localStorage.getItem(Ug),vP=({children:s})=>{const[e,r]=S.useState(null),[n,i]=S.useState(!0),[o,a]=S.useState(!1),[l,d]=S.useState([]),[p,f]=S.useState(!1),h=async O=>{try{const G=await no.getUserProfile(O);if(console.log("AuthContext: Raw profile result:",G),G.success&&G.data){const B=G.data.data||G.data;return console.log("AuthContext: Extracted profile data:",B),B}return null}catch(G){return console.error("Failed to fetch user profile:",G),null}},x=async O=>{try{const G=await sc.getUserSubscription(O);return G.success&&G.data?G.data:null}catch(G){return console.error("Failed to fetch user subscription:",G),null}},m=async()=>{if(!(!e?.api_key||e.user_type!=="registered"))try{const[O,G]=await Promise.all([h(e.api_key),x(e.api_key)]);if(O){const B={...e,user_info:{username:O.username,email:O.email,account_type:O.account_type,credit_balance:O.credit_balance,is_verified:O.is_verified,mfa_enabled:O.mfa_enabled},subscription:G||void 0};r(B),Gu(B)}}catch(O){console.error("Failed to refresh user data:",O)}},b=async O=>{if(!O.api_key)return console.log("validateSession: No API key found"),null;console.log("validateSession: Validating session with API...");const G=await no.getAuthStatus(O.api_key,O.device_id);console.log("validateSession: Auth status result:",G),console.log("validateSession: result.success =",G.success),console.log("validateSession: result.data =",G.data);const B=G.data?.data||G.data;if(console.log("validateSession: authData =",B),console.log("validateSession: authData?.authenticated =",B?.authenticated),G.success&&B?.authenticated){const F=B;console.log("validateSession: User authenticated, type:",F.user_type);let z=null,$=null;F.user_type==="registered"&&(console.log("validateSession: Fetching user profile..."),z=await h(O.api_key),console.log("validateSession: User profile result:",z),console.log("validateSession: Fetching user subscription..."),$=await x(O.api_key),console.log("validateSession: User subscription result:",$));const W={authenticated:!0,user_type:F.user_type,api_key:O.api_key,device_id:O.device_id,user_info:F.user_type==="registered"&&z?{username:z.username,email:z.email,account_type:z.account_type,credit_balance:z.credit_balance,is_verified:z.is_verified,mfa_enabled:z.mfa_enabled}:F.user,expires_at:F.user_type==="guest"?F.guest?.expires_at:void 0,daily_limit:F.user_type==="guest"?F.guest?.daily_limit:void 0,requests_today:F.user_type==="guest"?F.guest?.requests_today:void 0,subscription:$||void 0};return console.log("validateSession: Returning validated session:",W),W}return console.log("validateSession: Auth status check failed or not authenticated"),null};S.useEffect(()=>{(async()=>{console.log("AuthContext: Initializing session...");try{a(Uu());const G=bP();if(console.log("AuthContext: Saved session:",G?"Found":"Not found"),G)if(G.user_type==="registered"){const B=await b(G);B?(r(B),Gu(B)):(console.log("Session validation failed, clearing..."),ng())}else r(G)}catch(G){console.error("AuthContext: Initialization error:",G)}finally{console.log("AuthContext: Initialization complete"),i(!1)}})()},[]);const I={session:e,isLoading:n,isFirstTimeUser:o,availablePlans:l,isLoadingPlans:p,login:async(O,G)=>{try{console.log("AuthContext: Attempting login for:",O);const B=await no.login({email:O,password:G});if(console.log("AuthContext: Full login result:",B),console.log("AuthContext: result.success:",B.success),console.log("AuthContext: result.data:",B.data),B.success&&B.data&&B.data.data&&B.data.data.api_key){const F=B.data.data.api_key;console.log("AuthContext: Login successful, API key received:",F.substring(0,20)+"...");const[z,$]=await Promise.all([h(F),x(F)]),W={authenticated:!0,user_type:"registered",api_key:F,device_id:ky(),user_info:z?{username:z.username,email:z.email,account_type:z.account_type,credit_balance:z.credit_balance,is_verified:z.is_verified,mfa_enabled:z.mfa_enabled}:{email:O,account_type:"free",credit_balance:0},subscription:$||void 0};return r(W),Gu(W),a(Uu()),console.log("AuthContext: Login successful, account_type:",W.user_info?.account_type),console.log("AuthContext: Has subscription:",!!W.subscription?.has_subscription),{success:!0}}else return console.log("AuthContext: Login failed - success:",B.success,"data:",B.data,"error:",B.error),{success:!1,error:B.error||B.message||"Login failed"}}catch(B){return console.error("AuthContext: Login error:",B),{success:!1,error:B instanceof Error?B.message:"Login failed"}}},signup:async(O,G,B)=>{try{const F=await no.register({username:O,email:G,password:B});return F.success?{success:!0}:{success:!1,error:F.message||F.error||"Registration failed"}}catch(F){return{success:!1,error:F instanceof Error?F.message:"Registration failed"}}},verifyOtp:async(O,G)=>{try{const B=await no.verifyOtp({email:O,otp:G});if(B.success&&B.data&&B.data.data&&B.data.data.api_key){const F=B.data.data.api_key;console.log("AuthContext: OTP verification successful, API key received");const z=await h(F),$={authenticated:!0,user_type:"registered",api_key:F,device_id:ky(),user_info:z?{username:z.username,email:z.email,account_type:z.account_type,credit_balance:z.credit_balance,is_verified:z.is_verified,mfa_enabled:z.mfa_enabled}:{email:O,account_type:"free",credit_balance:0},subscription:void 0};return r($),Gu($),a(Uu()),{success:!0}}else return{success:!1,error:B.message||B.error||"Verification failed"}}catch(B){return{success:!1,error:B instanceof Error?B.message:"Verification failed"}}},setupGuestAccess:async()=>{try{const O=ky(),G=await no.registerDevice({device_id:O,device_name:`Fincept Terminal - ${navigator.platform}`,platform:"desktop",hardware_info:{platform:navigator.platform,user_agent:navigator.userAgent,language:navigator.language}});if(G.success&&G.data){const B=G.data,F={authenticated:!0,user_type:"guest",api_key:B.api_key||B.temp_api_key||null,device_id:O,expires_at:B.expires_at,daily_limit:B.daily_limit||50,requests_today:B.requests_today||0};return r(F),Gu(F),a(Uu()),{success:!0}}return{success:!1,error:G.message||G.error||"Failed to setup guest access"}}catch(O){return{success:!1,error:O instanceof Error?O.message:"Failed to setup guest access"}}},logout:async()=>{console.log("AuthContext: Logging out..."),r(null),ng(),a(Uu()),console.log("AuthContext: Logout complete")},checkApiConnectivity:async()=>{try{return await no.checkHealth()}catch(O){return console.error("API connectivity check failed:",O),!1}},forgotPassword:async O=>{try{const G=await no.forgotPassword({email:O});return G.success?{success:!0}:{success:!1,error:G.message||G.error||"Failed to send reset email"}}catch(G){return{success:!1,error:G instanceof Error?G.message:"Failed to send reset email"}}},resetPassword:async(O,G,B)=>{try{const F=await no.resetPassword({email:O,otp:G,new_password:B});return F.success?{success:!0}:{success:!1,error:F.message||F.error||"Password reset failed"}}catch(F){return{success:!1,error:F instanceof Error?F.message:"Password reset failed"}}},fetchPlans:async()=>{f(!0);try{console.log("AuthContext: Fetching plans from API...");const O=await sc.getSubscriptionPlans();if(console.log("AuthContext: Plans API result:",O),O.success&&O.data){const B=(O.data.data||O.data).plans||[];return console.log("AuthContext: Extracted plans:",B),console.log("AuthContext: Number of plans:",B.length),B.length>0?(d(B),console.log("AuthContext: Plans set successfully"),{success:!0}):(console.log("AuthContext: No plans found in response"),{success:!1,error:"No plans available"})}else return console.log("AuthContext: API request failed:",O.error),{success:!1,error:O.error||"Failed to fetch plans"}}catch(O){return console.error("AuthContext: Failed to fetch plans:",O),{success:!1,error:"Failed to fetch plans"}}finally{f(!1)}},createPaymentSession:async O=>{if(!e?.api_key)return{success:!1,error:"No API key available"};try{const G=await sc.createCheckoutSession(e.api_key,{plan_id:O,return_url:`${window.location.origin}/payment-success`});return G.success&&G.data?{success:!0,data:G.data}:{success:!1,error:G.error||"Failed to create payment session"}}catch(G){return console.error("Failed to create payment session:",G),{success:!1,error:"Failed to create payment session"}}},getUserSubscription:async()=>{if(!e?.api_key)return{success:!1,error:"No API key available"};try{const O=await sc.getUserSubscription(e.api_key);return O.success?{success:!0,data:O.data}:{success:!1,error:O.error||"Failed to get subscription"}}catch(O){return console.error("Failed to get subscription:",O),{success:!1,error:"Failed to get subscription"}}},refreshUserData:m};return t.jsx(hA.Provider,{value:I,children:s})},Ao=()=>{const s=S.useContext(hA);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},fA=S.createContext(void 0),gA=()=>{const s=S.useContext(fA);if(!s)throw new Error("useNavigation must be used within NavigationProvider");return s},SP=({children:s,onNavigate:e,onSetActiveTab:r})=>{const l={navigateToScreen:d=>{e(d)},navigateToPricing:()=>{e("pricing")},navigateToDashboard:()=>{e("dashboard")},navigateToProfile:()=>{e("dashboard"),r&&setTimeout(()=>r("profile"),100)},setActiveTab:r};return t.jsx(fA.Provider,{value:l,children:s})},ul={"bloomberg-classic":{name:"Bloomberg Classic",primary:"#FFA500",secondary:"#00C800",success:"#00C800",alert:"#FF0000",warning:"#FFFF00",info:"#6496FA",accent:"#00FFFF",purple:"#C864FF",text:"#FFFFFF",textMuted:"#787878",background:"#000000",panel:"#0a0a0a"},"matrix-green":{name:"Matrix Green",primary:"#00FF41",secondary:"#008F11",success:"#00FF41",alert:"#FF0000",warning:"#FFD700",info:"#00D4AA",accent:"#00FFAA",purple:"#00FF88",text:"#00FF41",textMuted:"#005500",background:"#000000",panel:"#001100"},"blue-terminal":{name:"Blue Terminal",primary:"#00D4FF",secondary:"#00FF88",success:"#6BCF7F",alert:"#FF6B6B",warning:"#FFD93D",info:"#6BCF7F",accent:"#A0E7E5",purple:"#B4A7FF",text:"#E8F4F8",textMuted:"#5A7C8C",background:"#000814",panel:"#001D3D"},"amber-retro":{name:"Amber Retro",primary:"#FFAA00",secondary:"#00FF00",success:"#00FF00",alert:"#FF0000",warning:"#FFCC00",info:"#88CCFF",accent:"#FFDD88",purple:"#FF88CC",text:"#FFBB33",textMuted:"#886600",background:"#000000",panel:"#0a0600"},"purple-neon":{name:"Purple Neon",primary:"#C864FF",secondary:"#00FFA3",success:"#00FFA3",alert:"#FF4D6D",warning:"#FFD23F",info:"#64D2FF",accent:"#FF6AC1",purple:"#9B4FD8",text:"#F0E6FF",textMuted:"#8B7BA8",background:"#0D0221",panel:"#1A0B3C"}},wP=[{value:"Consolas",label:"Consolas"},{value:"Courier New",label:"Courier New"},{value:"Monaco",label:"Monaco"},{value:"Fira Code",label:"Fira Code"},{value:"JetBrains Mono",label:"JetBrains Mono"},{value:"Source Code Pro",label:"Source Code Pro"}],vE="terminal-theme-settings";class EP{constructor(){Pe(this,"theme");this.theme=this.loadTheme()}loadTheme(){try{const e=localStorage.getItem(vE);if(e){const r=JSON.parse(e);return{font:{family:r.font?.family||"Consolas",baseSize:r.font?.baseSize||11,weight:r.font?.weight||"normal",italic:r.font?.italic||!1},colors:r.colors||ul["bloomberg-classic"]}}}catch(e){console.error("Failed to load theme from localStorage:",e)}return{font:{family:"Consolas",baseSize:11,weight:"normal",italic:!1},colors:ul["bloomberg-classic"]}}saveTheme(e){this.theme=e;try{localStorage.setItem(vE,JSON.stringify(e))}catch(r){console.error("Failed to save theme to localStorage:",r)}}getTheme(){return this.theme}updateFont(e){this.theme.font={...this.theme.font,...e},this.saveTheme(this.theme)}updateColors(e){ul[e]&&(this.theme.colors=ul[e],this.saveTheme(this.theme))}getFontSizes(){const e=this.theme.font.baseSize;return{heading:`${e+4}px`,subheading:`${e+2}px`,body:`${e}px`,small:`${e-1}px`,tiny:`${e-2}px`}}getFontFamily(){return`${this.theme.font.family}, monospace`}getFontWeight(){return{normal:"400",semibold:"600",bold:"700"}[this.theme.font.weight]}getFontStyle(){return this.theme.font.italic?"italic":"normal"}resetToDefault(){this.theme={font:{family:"Consolas",baseSize:11,weight:"normal",italic:!1},colors:ul["bloomberg-classic"]},this.saveTheme(this.theme)}getCurrentThemeKey(){const e=this.theme.colors;for(const[r,n]of Object.entries(ul))if(n.primary===e.primary)return r;return"bloomberg-classic"}}const zi=new EP,xA=S.createContext(void 0),CP=({children:s})=>{const[e,r]=S.useState(zi.getTheme()),n=h=>{zi.saveTheme(h),r(h)},i=()=>{zi.resetToDefault(),r(zi.getTheme())},o=e.colors,a=zi.getFontSizes(),l=zi.getFontFamily(),d=zi.getFontWeight(),p=zi.getFontStyle(),f={theme:e,colors:o,fontSize:a,fontFamily:l,fontWeight:d,fontStyle:p,updateTheme:n,resetTheme:i};return t.jsx(xA.Provider,{value:f,children:s})},Er=()=>{const s=S.useContext(xA);if(!s)throw new Error("useTerminalTheme must be used within ThemeProvider");return s},SE={debug:0,info:1,warn:2,error:3},jP=()=>"warn";function ds(s){const{namespace:e,enabled:r=!0}=s,n=jP(),i=d=>r?SE[d]>=SE[n]:!1,o=(d,p,f)=>({timestamp:new Date().toISOString(),level:d,namespace:e,message:p,data:f}),a=d=>{const p=`[${d.namespace}]`,f=d.data!==void 0?[p,d.message,d.data]:[p,d.message];switch(d.level){case"debug":console.debug(...f);break;case"info":console.info(...f);break;case"warn":console.warn(...f);break;case"error":console.error(...f);break}},l=(d,p,f)=>{const h=o(d,p,f);i(d)&&a(h)};return{debug:(d,p)=>l("debug",d,p),info:(d,p)=>l("info",d,p),warn:(d,p)=>l("warn",d,p),error:(d,p)=>l("error",d,p),getNamespace:()=>e,isEnabled:()=>r}}const mo=ds({namespace:"WorkflowService"}),lr=ds({namespace:"WebSocket"}),Qt=ds({namespace:"MCP"});ds({namespace:"Auth"});const Sn=ds({namespace:"SQLite"}),Qc=ds({namespace:"Watchlist"}),Do=ds({namespace:"Portfolio"}),vr=ds({namespace:"LLM"}),Xn=ds({namespace:"NodeExecution"}),Xi=ds({namespace:"Polygon"}),Zc=ds({namespace:"PythonAgent"}),yo=ds({namespace:"MarketData"}),Mr=ds({namespace:"Fyers"}),ir=ds({namespace:"Backtesting"}),Oi=ds({namespace:"ContextRecorder"}),Wu=ds({namespace:"AgentLLM"}),Ji=ds({namespace:"Geopolitics"}),Hl=ds({namespace:"Report"}),fa=ds({namespace:"Notebook"}),mp=ds({namespace:"DataSource"});class mA{constructor(){Pe(this,"db",null);Pe(this,"initPromise",null)}async initialize(){return this.initPromise?this.initPromise:(this.initPromise=this._initializeDatabase(),this.initPromise)}async _initializeDatabase(){try{Sn.info("Initializing database..."),this.db=await Gg.load("sqlite:fincept_terminal.db"),Sn.debug("Creating schema..."),await this.createSchema(),Sn.info("Database initialized successfully")}catch(e){throw Sn.error("Failed to initialize:",e),e}}getSchemaStatements(){return[`CREATE TABLE IF NOT EXISTS credentials (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        service_name TEXT NOT NULL UNIQUE,
        username TEXT,
        password TEXT,
        api_key TEXT,
        api_secret TEXT,
        additional_data TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS settings (
        setting_key TEXT PRIMARY KEY,
        setting_value TEXT NOT NULL,
        category TEXT,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS llm_configs (
        provider TEXT PRIMARY KEY,
        api_key TEXT,
        base_url TEXT,
        model TEXT NOT NULL,
        is_active INTEGER DEFAULT 0,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS llm_global_settings (
        id INTEGER PRIMARY KEY CHECK (id = 1),
        temperature REAL DEFAULT 0.7,
        max_tokens INTEGER DEFAULT 2000,
        system_prompt TEXT DEFAULT ''
      )`,`CREATE TABLE IF NOT EXISTS chat_sessions (
        session_uuid TEXT PRIMARY KEY,
        title TEXT NOT NULL,
        message_count INTEGER DEFAULT 0,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS chat_messages (
        id TEXT PRIMARY KEY,
        session_uuid TEXT NOT NULL,
        role TEXT NOT NULL CHECK (role IN ('user', 'assistant')),
        content TEXT NOT NULL,
        timestamp TEXT DEFAULT CURRENT_TIMESTAMP,
        provider TEXT,
        model TEXT,
        tokens_used INTEGER,
        FOREIGN KEY (session_uuid) REFERENCES chat_sessions(session_uuid) ON DELETE CASCADE
      )`,`CREATE TABLE IF NOT EXISTS data_sources (
        id TEXT PRIMARY KEY,
        alias TEXT NOT NULL UNIQUE,
        display_name TEXT NOT NULL,
        description TEXT,
        type TEXT NOT NULL CHECK (type IN ('websocket', 'rest_api')),
        provider TEXT NOT NULL,
        category TEXT,
        config TEXT NOT NULL,
        enabled INTEGER DEFAULT 1,
        tags TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS ws_provider_configs (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        provider_name TEXT NOT NULL UNIQUE,
        enabled INTEGER DEFAULT 1,
        api_key TEXT,
        api_secret TEXT,
        endpoint TEXT,
        config_data TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS paper_trading_portfolios (
        id TEXT PRIMARY KEY,
        name TEXT NOT NULL,
        provider TEXT NOT NULL,
        initial_balance REAL NOT NULL DEFAULT 100000,
        current_balance REAL NOT NULL,
        currency TEXT DEFAULT 'USD',
        margin_mode TEXT DEFAULT 'cross',
        leverage REAL DEFAULT 1,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS paper_trading_positions (
        id TEXT PRIMARY KEY,
        portfolio_id TEXT NOT NULL,
        symbol TEXT NOT NULL,
        side TEXT NOT NULL CHECK (side IN ('long', 'short')),
        entry_price REAL NOT NULL,
        quantity REAL NOT NULL,
        position_value REAL,
        current_price REAL,
        unrealized_pnl REAL,
        realized_pnl REAL DEFAULT 0,
        leverage REAL DEFAULT 1,
        margin_mode TEXT DEFAULT 'cross',
        liquidation_price REAL,
        opened_at TEXT DEFAULT CURRENT_TIMESTAMP,
        closed_at TEXT,
        status TEXT NOT NULL CHECK (status IN ('open', 'closed')),
        FOREIGN KEY (portfolio_id) REFERENCES paper_trading_portfolios(id) ON DELETE CASCADE
      )`,`CREATE TABLE IF NOT EXISTS paper_trading_orders (
        id TEXT PRIMARY KEY,
        portfolio_id TEXT NOT NULL,
        symbol TEXT NOT NULL,
        side TEXT NOT NULL CHECK (side IN ('buy', 'sell')),
        type TEXT NOT NULL CHECK (type IN ('market', 'limit', 'stop_market', 'stop_limit')),
        quantity REAL NOT NULL,
        price REAL,
        stop_price REAL,
        filled_quantity REAL DEFAULT 0,
        avg_fill_price REAL,
        status TEXT NOT NULL CHECK (status IN ('pending', 'filled', 'partial', 'cancelled', 'rejected', 'triggered')),
        time_in_force TEXT DEFAULT 'GTC',
        post_only INTEGER DEFAULT 0,
        reduce_only INTEGER DEFAULT 0,
        trailing_percent REAL,
        trailing_amount REAL,
        iceberg_qty REAL,
        leverage REAL,
        margin_mode TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        filled_at TEXT,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (portfolio_id) REFERENCES paper_trading_portfolios(id) ON DELETE CASCADE
      )`,`CREATE TABLE IF NOT EXISTS paper_trading_trades (
        id TEXT PRIMARY KEY,
        portfolio_id TEXT NOT NULL,
        order_id TEXT NOT NULL,
        symbol TEXT NOT NULL,
        side TEXT NOT NULL,
        price REAL NOT NULL,
        quantity REAL NOT NULL,
        fee REAL DEFAULT 0,
        fee_rate REAL DEFAULT 0,
        is_maker INTEGER DEFAULT 0,
        timestamp TEXT DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (portfolio_id) REFERENCES paper_trading_portfolios(id) ON DELETE CASCADE,
        FOREIGN KEY (order_id) REFERENCES paper_trading_orders(id) ON DELETE CASCADE
      )`,"CREATE INDEX IF NOT EXISTS idx_paper_positions_portfolio ON paper_trading_positions(portfolio_id)","CREATE INDEX IF NOT EXISTS idx_paper_positions_status ON paper_trading_positions(status)","CREATE INDEX IF NOT EXISTS idx_paper_orders_portfolio ON paper_trading_orders(portfolio_id)","CREATE INDEX IF NOT EXISTS idx_paper_orders_status ON paper_trading_orders(status)","CREATE INDEX IF NOT EXISTS idx_paper_trades_portfolio ON paper_trading_trades(portfolio_id)",`CREATE TABLE IF NOT EXISTS mcp_servers (
        id TEXT PRIMARY KEY,
        name TEXT NOT NULL,
        description TEXT,
        command TEXT NOT NULL,
        args TEXT,
        env TEXT,
        category TEXT,
        icon TEXT,
        enabled INTEGER DEFAULT 1,
        auto_start INTEGER DEFAULT 0,
        status TEXT DEFAULT 'stopped',
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS mcp_tools (
        id TEXT PRIMARY KEY,
        server_id TEXT NOT NULL,
        name TEXT NOT NULL,
        description TEXT,
        input_schema TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (server_id) REFERENCES mcp_servers(id) ON DELETE CASCADE
      )`,`CREATE TABLE IF NOT EXISTS mcp_tool_usage_logs (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        server_id TEXT NOT NULL,
        tool_name TEXT NOT NULL,
        args TEXT,
        result TEXT,
        success INTEGER,
        execution_time INTEGER,
        error TEXT,
        timestamp TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS market_data_cache (
        symbol TEXT NOT NULL,
        category TEXT NOT NULL,
        quote_data TEXT NOT NULL,
        cached_at TEXT DEFAULT CURRENT_TIMESTAMP,
        PRIMARY KEY (symbol, category)
      )`,`CREATE TABLE IF NOT EXISTS data_source_connections (
        id TEXT PRIMARY KEY,
        name TEXT NOT NULL,
        type TEXT NOT NULL,
        category TEXT NOT NULL,
        config TEXT NOT NULL,
        status TEXT NOT NULL,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP,
        last_tested TEXT,
        error_message TEXT
      )`,`CREATE TABLE IF NOT EXISTS forum_categories_cache (
        id INTEGER PRIMARY KEY,
        data TEXT NOT NULL,
        cached_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS forum_posts_cache (
        cache_key TEXT PRIMARY KEY,
        category_id INTEGER,
        sort_by TEXT,
        data TEXT NOT NULL,
        cached_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS forum_stats_cache (
        id INTEGER PRIMARY KEY CHECK (id = 1),
        data TEXT NOT NULL,
        cached_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS forum_post_details_cache (
        post_uuid TEXT PRIMARY KEY,
        data TEXT NOT NULL,
        comments_data TEXT NOT NULL,
        cached_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS recorded_contexts (
        id TEXT PRIMARY KEY,
        tab_name TEXT NOT NULL,
        data_type TEXT NOT NULL,
        label TEXT,
        raw_data TEXT NOT NULL,
        metadata TEXT,
        data_size INTEGER,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        tags TEXT
      )`,"CREATE INDEX IF NOT EXISTS idx_recorded_contexts_tab ON recorded_contexts(tab_name)","CREATE INDEX IF NOT EXISTS idx_recorded_contexts_type ON recorded_contexts(data_type)","CREATE INDEX IF NOT EXISTS idx_recorded_contexts_created ON recorded_contexts(created_at DESC)",`CREATE TABLE IF NOT EXISTS recording_sessions (
        id TEXT PRIMARY KEY,
        tab_name TEXT NOT NULL,
        is_active INTEGER DEFAULT 1,
        auto_record INTEGER DEFAULT 0,
        filters TEXT,
        started_at TEXT DEFAULT CURRENT_TIMESTAMP,
        ended_at TEXT
      )`,`CREATE TABLE IF NOT EXISTS chat_context_links (
        chat_session_uuid TEXT NOT NULL,
        context_id TEXT NOT NULL,
        added_at TEXT DEFAULT CURRENT_TIMESTAMP,
        is_active INTEGER DEFAULT 1,
        PRIMARY KEY (chat_session_uuid, context_id),
        FOREIGN KEY(chat_session_uuid) REFERENCES chat_sessions(session_uuid) ON DELETE CASCADE,
        FOREIGN KEY(context_id) REFERENCES recorded_contexts(id) ON DELETE CASCADE
      )`,`CREATE TABLE IF NOT EXISTS report_templates (
        id TEXT PRIMARY KEY,
        name TEXT NOT NULL,
        description TEXT,
        template_data TEXT NOT NULL,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS backtesting_providers (
        id TEXT PRIMARY KEY,
        name TEXT NOT NULL UNIQUE,
        adapter_type TEXT NOT NULL,
        config TEXT NOT NULL,
        enabled INTEGER DEFAULT 1,
        is_active INTEGER DEFAULT 0,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,`CREATE TABLE IF NOT EXISTS backtesting_strategies (
        id TEXT PRIMARY KEY,
        name TEXT NOT NULL,
        description TEXT,
        version TEXT DEFAULT '1.0.0',
        author TEXT,
        provider_type TEXT NOT NULL,
        strategy_type TEXT NOT NULL CHECK (strategy_type IN ('code', 'visual', 'template')),
        strategy_definition TEXT NOT NULL,
        tags TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        updated_at TEXT DEFAULT CURRENT_TIMESTAMP
      )`,"CREATE INDEX IF NOT EXISTS idx_strategies_provider ON backtesting_strategies(provider_type)","CREATE INDEX IF NOT EXISTS idx_strategies_type ON backtesting_strategies(strategy_type)",`CREATE TABLE IF NOT EXISTS backtest_runs (
        id TEXT PRIMARY KEY,
        strategy_id TEXT,
        provider_name TEXT NOT NULL,
        config TEXT NOT NULL,
        results TEXT,
        status TEXT NOT NULL CHECK (status IN ('completed', 'failed', 'running', 'cancelled')),
        performance_metrics TEXT,
        error_message TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        completed_at TEXT,
        duration_seconds INTEGER,
        FOREIGN KEY(strategy_id) REFERENCES backtesting_strategies(id) ON DELETE SET NULL
      )`,"CREATE INDEX IF NOT EXISTS idx_backtest_runs_strategy ON backtest_runs(strategy_id)","CREATE INDEX IF NOT EXISTS idx_backtest_runs_provider ON backtest_runs(provider_name)","CREATE INDEX IF NOT EXISTS idx_backtest_runs_status ON backtest_runs(status)","CREATE INDEX IF NOT EXISTS idx_backtest_runs_created ON backtest_runs(created_at DESC)",`CREATE TABLE IF NOT EXISTS optimization_runs (
        id TEXT PRIMARY KEY,
        strategy_id TEXT,
        provider_name TEXT NOT NULL,
        parameter_grid TEXT NOT NULL,
        objective TEXT NOT NULL,
        best_parameters TEXT,
        best_result TEXT,
        all_results TEXT,
        iterations INTEGER,
        status TEXT NOT NULL CHECK (status IN ('completed', 'failed', 'running', 'cancelled')),
        error_message TEXT,
        created_at TEXT DEFAULT CURRENT_TIMESTAMP,
        completed_at TEXT,
        duration_seconds INTEGER,
        FOREIGN KEY(strategy_id) REFERENCES backtesting_strategies(id) ON DELETE SET NULL
      )`,"CREATE INDEX IF NOT EXISTS idx_optimization_runs_strategy ON optimization_runs(strategy_id)","CREATE INDEX IF NOT EXISTS idx_optimization_runs_provider ON optimization_runs(provider_name)","CREATE INDEX IF NOT EXISTS idx_optimization_runs_status ON optimization_runs(status)",`INSERT OR IGNORE INTO llm_global_settings (id, temperature, max_tokens, system_prompt)
       VALUES (1, 0.7, 2000, 'You are a helpful AI assistant specialized in financial analysis and market data.')`]}async createSchema(){if(!this.db)throw new Error("Database not connected");const e=this.getSchemaStatements();for(const r of e)try{await this.db.execute(r)}catch(n){if(!n.message?.includes("duplicate column"))throw n}try{await this.db.execute(`
        UPDATE paper_trading_positions
        SET position_value = entry_price * quantity
        WHERE position_value IS NULL
      `)}catch(r){Sn.error("Failed to populate position_value:",r)}}async ensureInitialized(){this.db||await this.initialize()}isReady(){return this.db!==null}getDatabase(){return this.db}async execute(e,r){return await this.ensureInitialized(),this.db.execute(e,r||[])}async select(e,r){return await this.ensureInitialized(),this.db.select(e,r||[])}async healthCheck(){try{return await this.ensureInitialized(),await this.db.execute("SELECT 1"),{healthy:!0,message:"Database is healthy"}}catch(e){return{healthy:!1,message:e instanceof Error?e.message:"Unknown error"}}}}class yA{constructor(e){this.base=e}async saveSetting(e,r,n){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO settings (setting_key, setting_value, category, updated_at)
       VALUES ($1, $2, $3, CURRENT_TIMESTAMP)`,[e,r,n||null])}async getSetting(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM settings WHERE setting_key = $1",[e]))[0]?.setting_value||null}async getSettingsByCategory(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM settings WHERE category = $1",[e])}async getAllSettings(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM settings")}}class bA{constructor(e,r){this.base=e,this.settings=r}async saveCredential(e){try{return await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO credentials (service_name, username, password, api_key, api_secret, additional_data, updated_at)
         VALUES ($1, $2, $3, $4, $5, $6, CURRENT_TIMESTAMP)`,[e.service_name,e.username||null,e.password||null,e.api_key||null,e.api_secret||null,e.additional_data||null]),{success:!0,message:"Credential saved successfully"}}catch(r){return Sn.error("Failed to save credential:",r),{success:!1,message:"Failed to save credential"}}}async getCredentials(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM credentials ORDER BY service_name")}async getCredentialByService(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM credentials WHERE service_name = $1",[e]))[0]||null}async getApiKey(e){const r=e.toUpperCase().replace(/[^A-Z0-9]/g,"_")+"_API_KEY";return await this.settings.getSetting(r)}async setApiKey(e,r){await this.settings.saveSetting(e,r,"api_keys")}async getAllApiKeys(){await this.base.ensureInitialized();const e=await this.base.select("SELECT * FROM settings WHERE category = 'api_keys'"),r={};return e.forEach(n=>{r[n.setting_key]=n.setting_value}),r}async deleteCredential(e){try{return await this.base.ensureInitialized(),await this.base.execute("DELETE FROM credentials WHERE id = $1",[e]),{success:!0,message:"Credential deleted successfully"}}catch(r){return Sn.error("Failed to delete credential:",r),{success:!1,message:"Failed to delete credential"}}}}class vA{constructor(e){this.base=e}async getLLMConfigs(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM llm_configs ORDER BY provider")}async getLLMConfig(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM llm_configs WHERE provider = $1",[e]))[0]||null}async getActiveLLMConfig(){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM llm_configs WHERE is_active = 1 LIMIT 1"))[0]||null}async saveLLMConfig(e){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO llm_configs (provider, api_key, base_url, model, is_active, updated_at)
       VALUES ($1, $2, $3, $4, $5, CURRENT_TIMESTAMP)`,[e.provider,e.api_key||null,e.base_url||null,e.model,e.is_active?1:0])}async setActiveLLMProvider(e){await this.base.ensureInitialized(),await this.base.execute("UPDATE llm_configs SET is_active = 0"),await this.base.execute("UPDATE llm_configs SET is_active = 1 WHERE provider = $1",[e])}async ensureDefaultLLMConfigs(){if(await this.base.ensureInitialized(),(await this.getLLMConfigs()).length===0){const r=[{provider:"ollama",model:"llama3.2:3b",base_url:"http://localhost:11434",is_active:!0},{provider:"openai",model:"gpt-4o-mini",is_active:!1},{provider:"anthropic",model:"claude-sonnet-4",is_active:!1},{provider:"google",model:"gemini-2.0-flash-exp",is_active:!1},{provider:"groq",model:"llama-3.1-70b-versatile",is_active:!1},{provider:"deepseek",model:"deepseek-chat",base_url:"https://api.deepseek.com",is_active:!1},{provider:"xai",model:"grok-beta",is_active:!1},{provider:"cohere",model:"command-r-plus",is_active:!1},{provider:"mistral",model:"mistral-large-latest",is_active:!1},{provider:"together",model:"meta-llama/Meta-Llama-3.1-70B-Instruct-Turbo",is_active:!1},{provider:"fireworks",model:"accounts/fireworks/models/llama-v3p1-70b-instruct",is_active:!1},{provider:"openrouter",model:"meta-llama/llama-3.1-8b-instruct:free",base_url:"https://openrouter.ai/api/v1",is_active:!1}];for(const n of r)await this.saveLLMConfig(n);Sn.info("Initialized default LLM configurations")}}async getLLMGlobalSettings(){return await this.base.ensureInitialized(),(await this.base.select("SELECT temperature, max_tokens, system_prompt FROM llm_global_settings WHERE id = 1"))[0]||{temperature:.7,max_tokens:2e3,system_prompt:"You are a helpful AI assistant specialized in financial analysis and market data."}}async saveLLMGlobalSettings(e){await this.base.ensureInitialized(),await this.base.execute(`UPDATE llm_global_settings
       SET temperature = $1, max_tokens = $2, system_prompt = $3
       WHERE id = 1`,[e.temperature,e.max_tokens,e.system_prompt])}}class SA{constructor(e){this.base=e}async createChatSession(e){await this.base.ensureInitialized();const r=crypto.randomUUID(),n=new Date().toISOString();return await this.base.execute(`INSERT INTO chat_sessions (session_uuid, title, message_count, created_at, updated_at)
       VALUES ($1, $2, 0, $3, $4)`,[r,e,n,n]),{session_uuid:r,title:e,message_count:0,created_at:n,updated_at:n}}async getChatSessions(e=50){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM chat_sessions ORDER BY updated_at DESC LIMIT $1",[e])}async getChatSession(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM chat_sessions WHERE session_uuid = $1",[e]))[0]||null}async updateChatSessionTitle(e,r){await this.base.ensureInitialized(),await this.base.execute("UPDATE chat_sessions SET title = $1, updated_at = CURRENT_TIMESTAMP WHERE session_uuid = $2",[r,e])}async deleteChatSession(e){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM chat_sessions WHERE session_uuid = $1",[e])}async addChatMessage(e){await this.base.ensureInitialized();const r=crypto.randomUUID(),n=new Date().toISOString();return await this.base.execute(`INSERT INTO chat_messages (id, session_uuid, role, content, timestamp, provider, model, tokens_used)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8)`,[r,e.session_uuid,e.role,e.content,n,e.provider||null,e.model||null,e.tokens_used||null]),await this.base.execute(`UPDATE chat_sessions
       SET message_count = message_count + 1, updated_at = CURRENT_TIMESTAMP
       WHERE session_uuid = $1`,[e.session_uuid]),{id:r,session_uuid:e.session_uuid,role:e.role,content:e.content,timestamp:n,provider:e.provider,model:e.model,tokens_used:e.tokens_used}}async getChatMessages(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM chat_messages WHERE session_uuid = $1 ORDER BY timestamp ASC",[e])}async deleteChatMessage(e){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM chat_messages WHERE id = $1",[e])}async clearChatSessionMessages(e){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM chat_messages WHERE session_uuid = $1",[e]),await this.base.execute("UPDATE chat_sessions SET message_count = 0, updated_at = CURRENT_TIMESTAMP WHERE session_uuid = $1",[e])}}class wA{constructor(e){this.base=e}async saveDataSource(e){try{return await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO data_sources
         (id, alias, display_name, description, type, provider, category, config, enabled, tags, updated_at)
         VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, CURRENT_TIMESTAMP)`,[e.id,e.alias,e.display_name,e.description||null,e.type,e.provider,e.category||null,e.config,e.enabled?1:0,e.tags||null]),{success:!0,message:"Data source saved successfully",id:e.id}}catch(r){return Sn.error("Failed to save data source:",r),{success:!1,message:"Failed to save data source"}}}async getAllDataSources(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM data_sources ORDER BY display_name")}async getDataSourceById(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM data_sources WHERE id = $1",[e]))[0]||null}async getDataSourceByAlias(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM data_sources WHERE alias = $1",[e]))[0]||null}async getDataSourcesByType(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM data_sources WHERE type = $1",[e])}async getDataSourcesByProvider(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM data_sources WHERE provider = $1",[e])}async getEnabledDataSources(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM data_sources WHERE enabled = 1")}async toggleDataSourceEnabled(e){try{await this.base.ensureInitialized();const r=await this.getDataSourceById(e);if(!r)return{success:!1,message:"Data source not found",enabled:!1};const n=!r.enabled;return await this.base.execute("UPDATE data_sources SET enabled = NOT enabled, updated_at = CURRENT_TIMESTAMP WHERE id = $1",[e]),{success:!0,message:`Data source ${n?"enabled":"disabled"}`,enabled:n}}catch(r){return Sn.error("Failed to toggle data source:",r),{success:!1,message:"Failed to toggle data source",enabled:!1}}}async deleteDataSource(e){try{return await this.base.ensureInitialized(),await this.base.execute("DELETE FROM data_sources WHERE id = $1",[e]),{success:!0,message:"Data source deleted successfully"}}catch(r){return Sn.error("Failed to delete data source:",r),{success:!1,message:"Failed to delete data source"}}}async searchDataSources(e){await this.base.ensureInitialized();const r=`%${e}%`;return await this.base.select(`SELECT * FROM data_sources
       WHERE display_name LIKE $1 OR alias LIKE $1 OR provider LIKE $1 OR tags LIKE $1`,[r])}}class EA{constructor(e){this.base=e}async saveWSProviderConfig(e){try{return await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO ws_provider_configs
         (provider_name, enabled, api_key, api_secret, endpoint, config_data, updated_at)
         VALUES ($1, $2, $3, $4, $5, $6, CURRENT_TIMESTAMP)`,[e.provider_name,e.enabled?1:0,e.api_key||null,e.api_secret||null,e.endpoint||null,e.config_data||null]),{success:!0,message:"WebSocket provider configuration saved successfully"}}catch(r){return Sn.error("Failed to save WS provider config:",r),{success:!1,message:"Failed to save WebSocket provider configuration"}}}async getWSProviderConfigs(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM ws_provider_configs ORDER BY provider_name")}async getWSProviderConfig(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM ws_provider_configs WHERE provider_name = $1",[e]))[0]||null}async getEnabledWSProviderConfigs(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM ws_provider_configs WHERE enabled = 1")}async toggleWSProviderEnabled(e){try{await this.base.ensureInitialized();const r=await this.getWSProviderConfig(e);if(!r)return{success:!1,message:"Provider configuration not found",enabled:!1};const n=!r.enabled;return await this.base.execute("UPDATE ws_provider_configs SET enabled = NOT enabled, updated_at = CURRENT_TIMESTAMP WHERE provider_name = $1",[e]),{success:!0,message:`Provider ${n?"enabled":"disabled"}`,enabled:n}}catch(r){return Sn.error("Failed to toggle WS provider:",r),{success:!1,message:"Failed to toggle provider",enabled:!1}}}async deleteWSProviderConfig(e){try{return await this.base.ensureInitialized(),await this.base.execute("DELETE FROM ws_provider_configs WHERE provider_name = $1",[e]),{success:!0,message:"Provider configuration deleted successfully"}}catch(r){return Sn.error("Failed to delete WS provider config:",r),{success:!1,message:"Failed to delete provider configuration"}}}}class CA{constructor(e){this.base=e}async addMCPServer(e){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO mcp_servers
       (id, name, description, command, args, env, category, icon, enabled, auto_start, status, updated_at)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, CURRENT_TIMESTAMP)`,[e.id,e.name,e.description,e.command,e.args,e.env||null,e.category,e.icon,e.enabled?1:0,e.auto_start?1:0,e.status])}async getMCPServers(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM mcp_servers ORDER BY name")}async getMCPServer(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM mcp_servers WHERE id = $1",[e]))[0]||null}async updateMCPServerStatus(e,r){await this.base.ensureInitialized(),await this.base.execute("UPDATE mcp_servers SET status = $1, updated_at = CURRENT_TIMESTAMP WHERE id = $2",[r,e])}async updateMCPServerConfig(e,r){await this.base.ensureInitialized();const n=[],i=[];let o=1;if(r.name!==void 0&&(n.push(`name = $${o++}`),i.push(r.name)),r.description!==void 0&&(n.push(`description = $${o++}`),i.push(r.description)),r.command!==void 0&&(n.push(`command = $${o++}`),i.push(r.command)),r.args!==void 0&&(n.push(`args = $${o++}`),i.push(r.args)),r.env!==void 0&&(n.push(`env = $${o++}`),i.push(r.env)),r.category!==void 0&&(n.push(`category = $${o++}`),i.push(r.category)),r.icon!==void 0&&(n.push(`icon = $${o++}`),i.push(r.icon)),r.enabled!==void 0&&(n.push(`enabled = $${o++}`),i.push(r.enabled?1:0)),r.auto_start!==void 0&&(n.push(`auto_start = $${o++}`),i.push(r.auto_start?1:0)),n.length===0)return;n.push("updated_at = CURRENT_TIMESTAMP"),i.push(e);const a=`UPDATE mcp_servers SET ${n.join(", ")} WHERE id = $${o}`;await this.base.execute(a,i)}async deleteMCPServer(e){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM mcp_servers WHERE id = $1",[e])}async getAutoStartServers(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM mcp_servers WHERE auto_start = 1 AND enabled = 1")}async cacheMCPTools(e,r){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM mcp_tools WHERE server_id = $1",[e]);for(const n of r)await this.base.execute(`INSERT INTO mcp_tools (id, server_id, name, description, input_schema)
         VALUES ($1, $2, $3, $4, $5)`,[`${e}_${n.name}`,e,n.name,n.description||null,n.inputSchema?JSON.stringify(n.inputSchema):null])}async getMCPServerStats(e){await this.base.ensureInitialized();const n=(await this.base.select("SELECT COUNT(*) as count FROM mcp_tools WHERE server_id = $1",[e]))[0]?.count||0,i=new Date().toISOString().split("T")[0],a=(await this.base.select(`SELECT COUNT(*) as count FROM mcp_tool_usage_logs
       WHERE server_id = $1 AND DATE(timestamp) = $2`,[e,i]))[0]?.count||0,d=(await this.base.select(`SELECT timestamp FROM mcp_tool_usage_logs
       WHERE server_id = $1 ORDER BY timestamp DESC LIMIT 1`,[e]))[0]?.timestamp||null;return{toolCount:n,callsToday:a,lastUsed:d}}async logMCPToolUsage(e){await this.base.ensureInitialized(),await this.base.execute(`INSERT INTO mcp_tool_usage_logs (server_id, tool_name, args, result, success, execution_time, error)
       VALUES ($1, $2, $3, $4, $5, $6, $7)`,[e.serverId,e.toolName,e.args,e.result,e.success?1:0,e.executionTime,e.error||null])}async getMCPTools(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM mcp_tools ORDER BY name")}async getMCPToolsByServer(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM mcp_tools WHERE server_id = $1 ORDER BY name",[e])}}class jA{constructor(e){this.base=e}async saveMarketDataCache(e,r,n){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO market_data_cache (symbol, category, quote_data, cached_at)
       VALUES ($1, $2, $3, CURRENT_TIMESTAMP)`,[e,r,JSON.stringify(n)])}async getCachedMarketData(e,r,n=5){await this.base.ensureInitialized();const i=await this.base.select(`SELECT quote_data, cached_at FROM market_data_cache
       WHERE symbol = $1 AND category = $2
       AND datetime(cached_at) >= datetime('now', '-${n} minutes')`,[e,r]);return i[0]?JSON.parse(i[0].quote_data):null}async clearMarketDataCache(){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM market_data_cache")}async clearExpiredMarketCache(e=60){await this.base.ensureInitialized(),await this.base.execute(`DELETE FROM market_data_cache
       WHERE datetime(cached_at) < datetime('now', '-${e} minutes')`)}async getCachedCategoryData(e,r,n=5){await this.base.ensureInitialized();const i=new Map;try{const o=r.map((d,p)=>`$${p+1}`).join(","),a=r.length+1,l=await this.base.select(`SELECT symbol, quote_data, cached_at FROM market_data_cache
         WHERE symbol IN (${o}) AND category = $${a}
         AND datetime(cached_at) >= datetime('now', '-${n} minutes')`,[...r,e]);for(const d of l)i.set(d.symbol,JSON.parse(d.quote_data))}catch(o){Sn.error("Error getting cached category data:",o)}return i}async saveDataSourceConnection(e){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO data_source_connections
       (id, name, type, category, config, status, updated_at, last_tested, error_message)
       VALUES ($1, $2, $3, $4, $5, $6, CURRENT_TIMESTAMP, $7, $8)`,[e.id,e.name,e.type,e.category,e.config,e.status,e.lastTested||null,e.errorMessage||null])}async getDataSourceConnection(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM data_source_connections WHERE id = $1",[e]))[0]||null}async getAllDataSourceConnections(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM data_source_connections ORDER BY created_at DESC")}async getDataSourceConnectionsByCategory(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM data_source_connections WHERE category = $1 ORDER BY created_at DESC",[e])}async getDataSourceConnectionsByType(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM data_source_connections WHERE type = $1",[e])}async updateDataSourceConnection(e,r){await this.base.ensureInitialized();const n=[],i=[];let o=1;if(r.name!==void 0&&(n.push(`name = $${o++}`),i.push(r.name)),r.config!==void 0&&(n.push(`config = $${o++}`),i.push(r.config)),r.status!==void 0&&(n.push(`status = $${o++}`),i.push(r.status)),r.lastTested!==void 0&&(n.push(`last_tested = $${o++}`),i.push(r.lastTested)),r.errorMessage!==void 0&&(n.push(`error_message = $${o++}`),i.push(r.errorMessage)),n.length===0)return;n.push("updated_at = CURRENT_TIMESTAMP"),i.push(e);const a=`UPDATE data_source_connections SET ${n.join(", ")} WHERE id = $${o}`;await this.base.execute(a,i)}async deleteDataSourceConnection(e){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM data_source_connections WHERE id = $1",[e])}async cacheForumCategories(e){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO forum_categories_cache (id, data, cached_at)
       VALUES (1, $1, CURRENT_TIMESTAMP)`,[JSON.stringify(e)])}async getCachedForumCategories(e=5){await this.base.ensureInitialized();const r=await this.base.select(`SELECT data, cached_at FROM forum_categories_cache
       WHERE id = 1
       AND datetime(cached_at) >= datetime('now', '-${e} minutes')`);return r[0]?JSON.parse(r[0].data):null}async cacheForumPosts(e,r,n){await this.base.ensureInitialized();const i=`${e||"all"}_${r}`;await this.base.execute(`INSERT OR REPLACE INTO forum_posts_cache (cache_key, category_id, sort_by, data, cached_at)
       VALUES ($1, $2, $3, $4, CURRENT_TIMESTAMP)`,[i,e,r,JSON.stringify(n)])}async getCachedForumPosts(e,r,n=5){await this.base.ensureInitialized();const i=`${e||"all"}_${r}`,o=await this.base.select(`SELECT data, cached_at FROM forum_posts_cache
       WHERE cache_key = $1
       AND datetime(cached_at) >= datetime('now', '-${n} minutes')`,[i]);return o[0]?JSON.parse(o[0].data):null}async cacheForumStats(e){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO forum_stats_cache (id, data, cached_at)
       VALUES (1, $1, CURRENT_TIMESTAMP)`,[JSON.stringify(e)])}async getCachedForumStats(e=5){await this.base.ensureInitialized();const r=await this.base.select(`SELECT data, cached_at FROM forum_stats_cache
       WHERE id = 1
       AND datetime(cached_at) >= datetime('now', '-${e} minutes')`);return r[0]?JSON.parse(r[0].data):null}async cacheForumPostDetails(e,r,n){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO forum_post_details_cache (post_uuid, data, comments_data, cached_at)
       VALUES ($1, $2, $3, CURRENT_TIMESTAMP)`,[e,JSON.stringify(r),JSON.stringify(n)])}async getCachedForumPostDetails(e,r=5){await this.base.ensureInitialized();const n=await this.base.select(`SELECT data, comments_data, cached_at FROM forum_post_details_cache
       WHERE post_uuid = $1
       AND datetime(cached_at) >= datetime('now', '-${r} minutes')`,[e]);return n[0]?{post:JSON.parse(n[0].data),comments:JSON.parse(n[0].comments_data)}:null}async clearForumCache(){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM forum_categories_cache"),await this.base.execute("DELETE FROM forum_posts_cache"),await this.base.execute("DELETE FROM forum_stats_cache"),await this.base.execute("DELETE FROM forum_post_details_cache")}async clearExpiredForumCache(e=60){await this.base.ensureInitialized(),await this.base.execute(`DELETE FROM forum_categories_cache
       WHERE datetime(cached_at) < datetime('now', '-${e} minutes')`),await this.base.execute(`DELETE FROM forum_posts_cache
       WHERE datetime(cached_at) < datetime('now', '-${e} minutes')`),await this.base.execute(`DELETE FROM forum_stats_cache
       WHERE datetime(cached_at) < datetime('now', '-${e} minutes')`),await this.base.execute(`DELETE FROM forum_post_details_cache
       WHERE datetime(cached_at) < datetime('now', '-${e} minutes')`)}}class kA{constructor(e){this.base=e}async saveRecordedContext(e){await this.base.ensureInitialized();const r=new TextEncoder().encode(e.raw_data).length;await this.base.execute(`INSERT INTO recorded_contexts (id, tab_name, data_type, label, raw_data, metadata, data_size, tags)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8)`,[e.id,e.tab_name,e.data_type,e.label||null,e.raw_data,e.metadata||null,r,e.tags||null])}async getRecordedContexts(e){await this.base.ensureInitialized();let r="SELECT * FROM recorded_contexts WHERE 1=1";const n=[];let i=1;if(e?.tabName&&(r+=` AND tab_name = $${i++}`,n.push(e.tabName)),e?.dataType&&(r+=` AND data_type = $${i++}`,n.push(e.dataType)),e?.tags&&e.tags.length>0){const o=e.tags.map(()=>`tags LIKE $${i++}`).join(" OR ");r+=` AND (${o})`,n.push(...e.tags.map(a=>`%${a}%`))}return r+=" ORDER BY created_at DESC",e?.limit&&(r+=` LIMIT $${i}`,n.push(e.limit)),await this.base.select(r,n)}async getRecordedContext(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM recorded_contexts WHERE id = $1",[e]))[0]||null}async deleteRecordedContext(e){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM recorded_contexts WHERE id = $1",[e])}async clearOldContexts(e){await this.base.ensureInitialized(),await this.base.execute(`DELETE FROM recorded_contexts
       WHERE datetime(created_at) < datetime('now', '-${e} days')`)}async getContextStorageStats(){await this.base.ensureInitialized();const e=await this.base.select("SELECT COUNT(*) as count, SUM(data_size) as total_size FROM recorded_contexts");return{count:e[0]?.count||0,totalSize:e[0]?.total_size||0}}async startRecordingSession(e){await this.base.ensureInitialized(),await this.base.execute(`UPDATE recording_sessions SET is_active = 0, ended_at = CURRENT_TIMESTAMP
       WHERE tab_name = $1 AND is_active = 1`,[e.tab_name]),await this.base.execute(`INSERT INTO recording_sessions (id, tab_name, is_active, auto_record, filters)
       VALUES ($1, $2, $3, $4, $5)`,[e.id,e.tab_name,e.is_active?1:0,e.auto_record?1:0,e.filters||null])}async getActiveRecordingSession(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM recording_sessions WHERE tab_name = $1 AND is_active = 1 LIMIT 1",[e]))[0]||null}async stopRecordingSession(e){await this.base.ensureInitialized(),await this.base.execute(`UPDATE recording_sessions SET is_active = 0, ended_at = CURRENT_TIMESTAMP
       WHERE tab_name = $1 AND is_active = 1`,[e])}async linkContextToChat(e,r){await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO chat_context_links (chat_session_uuid, context_id)
       VALUES ($1, $2)`,[e,r])}async unlinkContextFromChat(e,r){await this.base.ensureInitialized(),await this.base.execute("DELETE FROM chat_context_links WHERE chat_session_uuid = $1 AND context_id = $2",[e,r])}async getChatContexts(e){return await this.base.ensureInitialized(),await this.base.select(`SELECT rc.* FROM recorded_contexts rc
       INNER JOIN chat_context_links ccl ON rc.id = ccl.context_id
       WHERE ccl.chat_session_uuid = $1 AND ccl.is_active = 1
       ORDER BY ccl.added_at DESC`,[e])}async toggleChatContextActive(e,r){await this.base.ensureInitialized(),await this.base.execute(`UPDATE chat_context_links SET is_active = NOT is_active
       WHERE chat_session_uuid = $1 AND context_id = $2`,[e,r])}}class AA{constructor(e){this.base=e}async saveBacktestingProvider(e){try{return await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO backtesting_providers (id, name, adapter_type, config, enabled, is_active, updated_at)
         VALUES ($1, $2, $3, $4, $5, $6, CURRENT_TIMESTAMP)`,[e.id,e.name,e.adapter_type,e.config,e.enabled?1:0,e.is_active?1:0]),{success:!0,message:"Backtesting provider saved successfully"}}catch(r){return Sn.error("Failed to save backtesting provider:",r),{success:!1,message:"Failed to save backtesting provider"}}}async getBacktestingProviders(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM backtesting_providers ORDER BY name")}async getBacktestingProvider(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM backtesting_providers WHERE name = $1",[e]))[0]||null}async getActiveBacktestingProvider(){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM backtesting_providers WHERE is_active = 1 LIMIT 1"))[0]||null}async setActiveBacktestingProvider(e){try{return await this.base.ensureInitialized(),await this.base.execute("UPDATE backtesting_providers SET is_active = 0"),await this.base.execute("UPDATE backtesting_providers SET is_active = 1, updated_at = CURRENT_TIMESTAMP WHERE name = $1",[e]),{success:!0,message:`Activated backtesting provider: ${e}`}}catch(r){return Sn.error("Failed to set active provider:",r),{success:!1,message:"Failed to set active provider"}}}async deleteBacktestingProvider(e){try{return await this.base.ensureInitialized(),await this.base.execute("DELETE FROM backtesting_providers WHERE name = $1",[e]),{success:!0,message:"Provider deleted successfully"}}catch(r){return Sn.error("Failed to delete provider:",r),{success:!1,message:"Failed to delete provider"}}}async saveBacktestingStrategy(e){try{return await this.base.ensureInitialized(),await this.base.execute(`INSERT OR REPLACE INTO backtesting_strategies
         (id, name, description, version, author, provider_type, strategy_type, strategy_definition, tags, updated_at)
         VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, CURRENT_TIMESTAMP)`,[e.id,e.name,e.description||null,e.version,e.author||null,e.provider_type,e.strategy_type,e.strategy_definition,e.tags||null]),{success:!0,message:"Strategy saved successfully"}}catch(r){return Sn.error("Failed to save strategy:",r),{success:!1,message:"Failed to save strategy"}}}async getBacktestingStrategies(){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM backtesting_strategies ORDER BY updated_at DESC")}async getBacktestingStrategy(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM backtesting_strategies WHERE id = $1",[e]))[0]||null}async getBacktestingStrategiesByProvider(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM backtesting_strategies WHERE provider_type = $1 ORDER BY updated_at DESC",[e])}async deleteBacktestingStrategy(e){try{return await this.base.ensureInitialized(),await this.base.execute("DELETE FROM backtesting_strategies WHERE id = $1",[e]),{success:!0,message:"Strategy deleted successfully"}}catch(r){return Sn.error("Failed to delete strategy:",r),{success:!1,message:"Failed to delete strategy"}}}async saveBacktestRun(e){try{return await this.base.ensureInitialized(),await this.base.execute(`INSERT INTO backtest_runs
         (id, strategy_id, provider_name, config, results, status, performance_metrics, error_message)
         VALUES ($1, $2, $3, $4, $5, $6, $7, $8)`,[e.id,e.strategy_id||null,e.provider_name,e.config,e.results||null,e.status,e.performance_metrics||null,e.error_message||null]),{success:!0,message:"Backtest run saved successfully"}}catch(r){return Sn.error("Failed to save backtest run:",r),{success:!1,message:"Failed to save backtest run"}}}async updateBacktestRun(e,r){try{await this.base.ensureInitialized();const n=[],i=[];return r.results!==void 0&&(n.push("results = $"+(i.length+1)),i.push(r.results)),r.status!==void 0&&(n.push("status = $"+(i.length+1)),i.push(r.status)),r.performance_metrics!==void 0&&(n.push("performance_metrics = $"+(i.length+1)),i.push(r.performance_metrics)),r.error_message!==void 0&&(n.push("error_message = $"+(i.length+1)),i.push(r.error_message)),r.completed_at!==void 0&&(n.push("completed_at = $"+(i.length+1)),i.push(r.completed_at)),r.duration_seconds!==void 0&&(n.push("duration_seconds = $"+(i.length+1)),i.push(r.duration_seconds)),n.length===0?{success:!0,message:"No updates to apply"}:(i.push(e),await this.base.execute(`UPDATE backtest_runs SET ${n.join(", ")} WHERE id = $${i.length}`,i),{success:!0,message:"Backtest run updated successfully"})}catch(n){return Sn.error("Failed to update backtest run:",n),{success:!1,message:"Failed to update backtest run"}}}async getBacktestRuns(e){await this.base.ensureInitialized();const r=e?`SELECT * FROM backtest_runs ORDER BY created_at DESC LIMIT ${e}`:"SELECT * FROM backtest_runs ORDER BY created_at DESC";return await this.base.select(r)}async getBacktestRun(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM backtest_runs WHERE id = $1",[e]))[0]||null}async getBacktestRunsByStrategy(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM backtest_runs WHERE strategy_id = $1 ORDER BY created_at DESC",[e])}async getBacktestRunsByProvider(e){return await this.base.ensureInitialized(),await this.base.select("SELECT * FROM backtest_runs WHERE provider_name = $1 ORDER BY created_at DESC",[e])}async deleteBacktestRun(e){try{return await this.base.ensureInitialized(),await this.base.execute("DELETE FROM backtest_runs WHERE id = $1",[e]),{success:!0,message:"Backtest run deleted successfully"}}catch(r){return Sn.error("Failed to delete backtest run:",r),{success:!1,message:"Failed to delete backtest run"}}}async saveOptimizationRun(e){try{return await this.base.ensureInitialized(),await this.base.execute(`INSERT INTO optimization_runs
         (id, strategy_id, provider_name, parameter_grid, objective, best_parameters, best_result, all_results, iterations, status, error_message)
         VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)`,[e.id,e.strategy_id||null,e.provider_name,e.parameter_grid,e.objective,e.best_parameters||null,e.best_result||null,e.all_results||null,e.iterations||null,e.status,e.error_message||null]),{success:!0,message:"Optimization run saved successfully"}}catch(r){return Sn.error("Failed to save optimization run:",r),{success:!1,message:"Failed to save optimization run"}}}async updateOptimizationRun(e,r){try{await this.base.ensureInitialized();const n=[],i=[];return r.best_parameters!==void 0&&(n.push("best_parameters = $"+(i.length+1)),i.push(r.best_parameters)),r.best_result!==void 0&&(n.push("best_result = $"+(i.length+1)),i.push(r.best_result)),r.all_results!==void 0&&(n.push("all_results = $"+(i.length+1)),i.push(r.all_results)),r.iterations!==void 0&&(n.push("iterations = $"+(i.length+1)),i.push(r.iterations)),r.status!==void 0&&(n.push("status = $"+(i.length+1)),i.push(r.status)),r.error_message!==void 0&&(n.push("error_message = $"+(i.length+1)),i.push(r.error_message)),r.completed_at!==void 0&&(n.push("completed_at = $"+(i.length+1)),i.push(r.completed_at)),r.duration_seconds!==void 0&&(n.push("duration_seconds = $"+(i.length+1)),i.push(r.duration_seconds)),n.length===0?{success:!0,message:"No updates to apply"}:(i.push(e),await this.base.execute(`UPDATE optimization_runs SET ${n.join(", ")} WHERE id = $${i.length}`,i),{success:!0,message:"Optimization run updated successfully"})}catch(n){return Sn.error("Failed to update optimization run:",n),{success:!1,message:"Failed to update optimization run"}}}async getOptimizationRuns(e){await this.base.ensureInitialized();const r=e?`SELECT * FROM optimization_runs ORDER BY created_at DESC LIMIT ${e}`:"SELECT * FROM optimization_runs ORDER BY created_at DESC";return await this.base.select(r)}async getOptimizationRun(e){return await this.base.ensureInitialized(),(await this.base.select("SELECT * FROM optimization_runs WHERE id = $1",[e]))[0]||null}async deleteOptimizationRun(e){try{return await this.base.ensureInitialized(),await this.base.execute("DELETE FROM optimization_runs WHERE id = $1",[e]),{success:!0,message:"Optimization run deleted successfully"}}catch(r){return Sn.error("Failed to delete optimization run:",r),{success:!1,message:"Failed to delete optimization run"}}}}class kP{constructor(){Pe(this,"base");Pe(this,"_settings");Pe(this,"_credentials");Pe(this,"_llmConfig");Pe(this,"_chat");Pe(this,"_dataSources");Pe(this,"_wsProviders");Pe(this,"_mcpServers");Pe(this,"_cache");Pe(this,"_contextRecorder");Pe(this,"_backtesting");this.base=new mA,this._settings=new yA(this.base),this._credentials=new bA(this.base,this._settings),this._llmConfig=new vA(this.base),this._chat=new SA(this.base),this._dataSources=new wA(this.base),this._wsProviders=new EA(this.base),this._mcpServers=new CA(this.base),this._cache=new jA(this.base),this._contextRecorder=new kA(this.base),this._backtesting=new AA(this.base)}async initialize(){return this.base.initialize()}async ensureInitialized(){return this.base.ensureInitialized()}isReady(){return this.base.isReady()}async execute(e,r){return this.base.execute(e,r)}async select(e,r){return this.base.select(e,r)}async healthCheck(){return this.base.healthCheck()}async saveSetting(e,r,n){return this._settings.saveSetting(e,r,n)}async getSetting(e){return this._settings.getSetting(e)}async getSettingsByCategory(e){return this._settings.getSettingsByCategory(e)}async getAllSettings(){return this._settings.getAllSettings()}async saveCredential(e){return this._credentials.saveCredential(e)}async getCredentials(){return this._credentials.getCredentials()}async getCredentialByService(e){return this._credentials.getCredentialByService(e)}async getApiKey(e){return this._credentials.getApiKey(e)}async setApiKey(e,r){return this._credentials.setApiKey(e,r)}async getAllApiKeys(){return this._credentials.getAllApiKeys()}async deleteCredential(e){return this._credentials.deleteCredential(e)}async getLLMConfigs(){return this._llmConfig.getLLMConfigs()}async getLLMConfig(e){return this._llmConfig.getLLMConfig(e)}async getActiveLLMConfig(){return this._llmConfig.getActiveLLMConfig()}async saveLLMConfig(e){return this._llmConfig.saveLLMConfig(e)}async setActiveLLMProvider(e){return this._llmConfig.setActiveLLMProvider(e)}async ensureDefaultLLMConfigs(){return this._llmConfig.ensureDefaultLLMConfigs()}async getLLMGlobalSettings(){return this._llmConfig.getLLMGlobalSettings()}async saveLLMGlobalSettings(e){return this._llmConfig.saveLLMGlobalSettings(e)}async createChatSession(e){return this._chat.createChatSession(e)}async getChatSessions(e){return this._chat.getChatSessions(e)}async getChatSession(e){return this._chat.getChatSession(e)}async updateChatSessionTitle(e,r){return this._chat.updateChatSessionTitle(e,r)}async deleteChatSession(e){return this._chat.deleteChatSession(e)}async addChatMessage(e){return this._chat.addChatMessage(e)}async getChatMessages(e){return this._chat.getChatMessages(e)}async deleteChatMessage(e){return this._chat.deleteChatMessage(e)}async clearChatSessionMessages(e){return this._chat.clearChatSessionMessages(e)}async saveDataSource(e){return this._dataSources.saveDataSource(e)}async getAllDataSources(){return this._dataSources.getAllDataSources()}async getDataSourceById(e){return this._dataSources.getDataSourceById(e)}async getDataSourceByAlias(e){return this._dataSources.getDataSourceByAlias(e)}async getDataSourcesByType(e){return this._dataSources.getDataSourcesByType(e)}async getDataSourcesByProvider(e){return this._dataSources.getDataSourcesByProvider(e)}async getEnabledDataSources(){return this._dataSources.getEnabledDataSources()}async toggleDataSourceEnabled(e){return this._dataSources.toggleDataSourceEnabled(e)}async deleteDataSource(e){return this._dataSources.deleteDataSource(e)}async searchDataSources(e){return this._dataSources.searchDataSources(e)}async saveWSProviderConfig(e){return this._wsProviders.saveWSProviderConfig(e)}async getWSProviderConfigs(){return this._wsProviders.getWSProviderConfigs()}async getWSProviderConfig(e){return this._wsProviders.getWSProviderConfig(e)}async getEnabledWSProviderConfigs(){return this._wsProviders.getEnabledWSProviderConfigs()}async toggleWSProviderEnabled(e){return this._wsProviders.toggleWSProviderEnabled(e)}async deleteWSProviderConfig(e){return this._wsProviders.deleteWSProviderConfig(e)}async addMCPServer(e){return this._mcpServers.addMCPServer(e)}async getMCPServers(){return this._mcpServers.getMCPServers()}async getMCPServer(e){return this._mcpServers.getMCPServer(e)}async updateMCPServerStatus(e,r){return this._mcpServers.updateMCPServerStatus(e,r)}async updateMCPServerConfig(e,r){return this._mcpServers.updateMCPServerConfig(e,r)}async deleteMCPServer(e){return this._mcpServers.deleteMCPServer(e)}async getAutoStartServers(){return this._mcpServers.getAutoStartServers()}async cacheMCPTools(e,r){return this._mcpServers.cacheMCPTools(e,r)}async getMCPServerStats(e){return this._mcpServers.getMCPServerStats(e)}async logMCPToolUsage(e){return this._mcpServers.logMCPToolUsage(e)}async getMCPTools(){return this._mcpServers.getMCPTools()}async getMCPToolsByServer(e){return this._mcpServers.getMCPToolsByServer(e)}async saveMarketDataCache(e,r,n){return this._cache.saveMarketDataCache(e,r,n)}async getCachedMarketData(e,r,n){return this._cache.getCachedMarketData(e,r,n)}async clearMarketDataCache(){return this._cache.clearMarketDataCache()}async clearExpiredMarketCache(e){return this._cache.clearExpiredMarketCache(e)}async getCachedCategoryData(e,r,n){return this._cache.getCachedCategoryData(e,r,n)}async saveDataSourceConnection(e){return this._cache.saveDataSourceConnection(e)}async getDataSourceConnection(e){return this._cache.getDataSourceConnection(e)}async getAllDataSourceConnections(){return this._cache.getAllDataSourceConnections()}async getDataSourceConnectionsByCategory(e){return this._cache.getDataSourceConnectionsByCategory(e)}async getDataSourceConnectionsByType(e){return this._cache.getDataSourceConnectionsByType(e)}async updateDataSourceConnection(e,r){return this._cache.updateDataSourceConnection(e,r)}async deleteDataSourceConnection(e){return this._cache.deleteDataSourceConnection(e)}async cacheForumCategories(e){return this._cache.cacheForumCategories(e)}async getCachedForumCategories(e){return this._cache.getCachedForumCategories(e)}async cacheForumPosts(e,r,n){return this._cache.cacheForumPosts(e,r,n)}async getCachedForumPosts(e,r,n){return this._cache.getCachedForumPosts(e,r,n)}async cacheForumStats(e){return this._cache.cacheForumStats(e)}async getCachedForumStats(e){return this._cache.getCachedForumStats(e)}async cacheForumPostDetails(e,r,n){return this._cache.cacheForumPostDetails(e,r,n)}async getCachedForumPostDetails(e,r){return this._cache.getCachedForumPostDetails(e,r)}async clearForumCache(){return this._cache.clearForumCache()}async clearExpiredForumCache(e){return this._cache.clearExpiredForumCache(e)}async saveRecordedContext(e){return this._contextRecorder.saveRecordedContext(e)}async getRecordedContexts(e){return this._contextRecorder.getRecordedContexts(e)}async getRecordedContext(e){return this._contextRecorder.getRecordedContext(e)}async deleteRecordedContext(e){return this._contextRecorder.deleteRecordedContext(e)}async clearOldContexts(e){return this._contextRecorder.clearOldContexts(e)}async getContextStorageStats(){return this._contextRecorder.getContextStorageStats()}async startRecordingSession(e){return this._contextRecorder.startRecordingSession(e)}async getActiveRecordingSession(e){return this._contextRecorder.getActiveRecordingSession(e)}async stopRecordingSession(e){return this._contextRecorder.stopRecordingSession(e)}async linkContextToChat(e,r){return this._contextRecorder.linkContextToChat(e,r)}async unlinkContextFromChat(e,r){return this._contextRecorder.unlinkContextFromChat(e,r)}async getChatContexts(e){return this._contextRecorder.getChatContexts(e)}async toggleChatContextActive(e,r){return this._contextRecorder.toggleChatContextActive(e,r)}async saveBacktestingProvider(e){return this._backtesting.saveBacktestingProvider(e)}async getBacktestingProviders(){return this._backtesting.getBacktestingProviders()}async getBacktestingProvider(e){return this._backtesting.getBacktestingProvider(e)}async getActiveBacktestingProvider(){return this._backtesting.getActiveBacktestingProvider()}async setActiveBacktestingProvider(e){return this._backtesting.setActiveBacktestingProvider(e)}async deleteBacktestingProvider(e){return this._backtesting.deleteBacktestingProvider(e)}async saveBacktestingStrategy(e){return this._backtesting.saveBacktestingStrategy(e)}async getBacktestingStrategies(){return this._backtesting.getBacktestingStrategies()}async getBacktestingStrategy(e){return this._backtesting.getBacktestingStrategy(e)}async getBacktestingStrategiesByProvider(e){return this._backtesting.getBacktestingStrategiesByProvider(e)}async deleteBacktestingStrategy(e){return this._backtesting.deleteBacktestingStrategy(e)}async saveBacktestRun(e){return this._backtesting.saveBacktestRun(e)}async updateBacktestRun(e,r){return this._backtesting.updateBacktestRun(e,r)}async getBacktestRuns(e){return this._backtesting.getBacktestRuns(e)}async getBacktestRun(e){return this._backtesting.getBacktestRun(e)}async getBacktestRunsByStrategy(e){return this._backtesting.getBacktestRunsByStrategy(e)}async getBacktestRunsByProvider(e){return this._backtesting.getBacktestRunsByProvider(e)}async deleteBacktestRun(e){return this._backtesting.deleteBacktestRun(e)}async saveOptimizationRun(e){return this._backtesting.saveOptimizationRun(e)}async updateOptimizationRun(e,r){return this._backtesting.updateOptimizationRun(e,r)}async getOptimizationRuns(e){return this._backtesting.getOptimizationRuns(e)}async getOptimizationRun(e){return this._backtesting.getOptimizationRun(e)}async deleteOptimizationRun(e){return this._backtesting.deleteOptimizationRun(e)}}const Je=new kP,TA=[{key:"FRED_API_KEY",label:"FRED API Key",description:"Federal Reserve Economic Data"},{key:"POLYGON_API_KEY",label:"Polygon.io API Key",description:"Stock market data"},{key:"ALPHA_VANTAGE_API_KEY",label:"Alpha Vantage API Key",description:"Stock & crypto data"},{key:"OPENAI_API_KEY",label:"OpenAI API Key",description:"GPT models"},{key:"ANTHROPIC_API_KEY",label:"Anthropic API Key",description:"Claude models"},{key:"COINGECKO_API_KEY",label:"CoinGecko API Key",description:"Cryptocurrency data"},{key:"NASDAQ_API_KEY",label:"NASDAQ API Key",description:"NASDAQ market data"},{key:"FINANCIAL_MODELING_PREP_API_KEY",label:"Financial Modeling Prep",description:"Financial statements & ratios"}],jd=Object.freeze(Object.defineProperty({__proto__:null,BacktestingModule:AA,CacheModule:jA,ChatModule:SA,ContextRecorderModule:kA,CredentialsModule:bA,DataSourceModule:wA,LLMConfigModule:vA,MCPServerModule:CA,PREDEFINED_API_KEYS:TA,SQLiteBase:mA,SettingsModule:yA,WSProviderModule:EA,default:Je,sqliteService:Je},Symbol.toStringTag,{value:"Module"})),RA=S.createContext(void 0),AP=({children:s})=>{const[e,r]=S.useState([]);S.useEffect(()=>{(async()=>{try{const p=(await Je.getAllDataSources()).map(f=>({id:f.id,name:f.display_name,type:f.provider,category:f.category||"database",status:f.enabled?"disconnected":"error",config:JSON.parse(f.config||"{}"),createdAt:f.created_at||new Date().toISOString(),updatedAt:f.updated_at||new Date().toISOString()}));r(p)}catch(d){console.error("Failed to load data source connections:",d)}})()},[]);const n=S.useCallback(async l=>{try{await Je.saveDataSource({id:l.id,alias:l.id,display_name:l.name,type:"rest_api",provider:l.type,category:l.category,config:JSON.stringify(l.config),enabled:!0}),r(d=>[...d,l])}catch(d){console.error("Failed to save connection:",d)}},[]),i=S.useCallback(async(l,d)=>{try{const p=e.find(f=>f.id===l);if(p){const f={...p,...d,updatedAt:new Date().toISOString()};await Je.saveDataSource({id:f.id,alias:f.id,display_name:f.name,type:"rest_api",provider:f.type,category:f.category,config:JSON.stringify(f.config),enabled:f.status!=="error"}),r(h=>h.map(x=>x.id===l?f:x))}}catch(p){console.error("Failed to update connection:",p)}},[e]),o=S.useCallback(async l=>{try{await Je.deleteDataSource(l),r(d=>d.filter(p=>p.id!==l))}catch(d){console.error("Failed to delete connection:",d)}},[]),a=S.useCallback(async l=>{console.log("Testing connection:",l.id);try{r(d=>d.map(p=>p.id===l.id?{...p,status:"testing",lastTested:new Date().toISOString()}:p)),await new Promise(d=>setTimeout(d,1500)),r(d=>d.map(p=>p.id===l.id?{...p,status:"connected",errorMessage:void 0}:p))}catch(d){r(p=>p.map(f=>f.id===l.id?{...f,status:"error",errorMessage:String(d)}:f))}},[]);return t.jsx(RA.Provider,{value:{connections:e,addConnection:n,updateConnection:i,deleteConnection:o,testConnection:a},children:s})},TP=()=>{const s=S.useContext(RA);if(!s)throw new Error("useDataSources must be used within a DataSourceProvider");return s};var Ln=(s=>(s.DISCONNECTED="disconnected",s.CONNECTING="connecting",s.CONNECTED="connected",s.RECONNECTING="reconnecting",s.ERROR="error",s.RATE_LIMITED="rate_limited",s))(Ln||{});const Ib={maxMessagesPerSecond:100,maxSubscriptions:50,throttleMs:10,enabled:!0},Pb={enabled:!0,maxAttempts:10,initialDelayMs:1e3,maxDelayMs:3e4,backoffMultiplier:2,resetAfterMs:6e4},NA={maxConnectionsPerProvider:10,globalRateLimit:Ib,defaultReconnectionPolicy:Pb,enableMetrics:!0,enableLogging:!0,logLevel:"info"};function M0(s){const e=s.split(".");if(e.length<2)throw new Error(`Invalid topic format: ${s}. Expected "provider.channel[.symbol]"`);const[r,n,i,...o]=e;return{provider:r,channel:n,symbol:i,params:o.length>0?{extra:o.join(".")}:void 0,raw:s}}class OA{constructor(e){Pe(this,"subscriptions",new Map);Pe(this,"messageHistory",[]);Pe(this,"maxHistorySize",100);Pe(this,"enableHistory",!1);Pe(this,"enableLogging",!1);Pe(this,"messageCount",0);Pe(this,"lastMessageTime",0);Pe(this,"messageRate",0);this.enableHistory=e?.enableHistory??!1,this.maxHistorySize=e?.maxHistorySize??100,this.enableLogging=e?.enableLogging??!1,this.enableLogging&&lr.info("EventBus initialized",{historyEnabled:this.enableHistory})}subscribe(e,r){const n=this.generateSubscriptionId(),i=this.topicToRegex(e),o={id:n,topic:e,pattern:i,callback:r,subscribedAt:Date.now()},a=this.getSubscriptionKey(e);return this.subscriptions.has(a)||this.subscriptions.set(a,[]),this.subscriptions.get(a).push(o),this.enableLogging&&lr.debug(`Subscribed to topic: ${e}`,{subscriptionId:n}),()=>this.unsubscribe(n,e)}unsubscribe(e,r){const n=this.getSubscriptionKey(r),i=this.subscriptions.get(n);if(i){const o=i.findIndex(a=>a.id===e);o!==-1&&(i.splice(o,1),i.length===0&&this.subscriptions.delete(n),this.enableLogging&&lr.debug(`Unsubscribed from topic: ${r}`,{subscriptionId:e}))}}publish(e,r){const n={topic:e,message:r,timestamp:Date.now()};this.updateMetrics(),this.enableHistory&&this.addToHistory(n);const i=this.findMatchingSubscriptions(e);this.enableLogging&&i.length>0&&(e.includes("ohlc")||e.includes("candle"))&&lr.debug(`Publishing chart data to ${i.length} subscribers: ${e}`),i.forEach(o=>{try{o.callback(r)}catch(a){lr.error(`Error in subscription callback for ${e}:`,a)}})}findMatchingSubscriptions(e){const r=[];return this.subscriptions.forEach(n=>{n.forEach(i=>{i.pattern.test(e)&&r.push(i)})}),r}topicToRegex(e){const n=e.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^.]+");return new RegExp(`^${n}$`)}getSubscriptionKey(e){const n=e.split(".")[0];return n==="*"?"__wildcard__":n}generateSubscriptionId(){return`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addToHistory(e){this.messageHistory.push(e),this.messageHistory.length>this.maxHistorySize&&(this.messageHistory=this.messageHistory.slice(-this.maxHistorySize))}updateMetrics(){this.messageCount++;const e=Date.now();if(this.lastMessageTime>0){const r=(e-this.lastMessageTime)/1e3;this.messageRate=1/r}this.lastMessageTime=e}getHistory(e){return this.enableHistory?e?this.messageHistory.slice(-e):[...this.messageHistory]:(lr.warn("History is disabled"),[])}getHistoryForTopic(e,r){const n=this.topicToRegex(e),i=this.messageHistory.filter(o=>n.test(o.topic));return r?i.slice(-r):i}clearHistory(){this.messageHistory=[],this.enableLogging&&lr.info("History cleared")}getSubscriptionCount(){let e=0;return this.subscriptions.forEach(r=>{e+=r.length}),e}getSubscriptions(){return new Map(this.subscriptions)}getMetrics(){return{totalMessages:this.messageCount,messagesPerSecond:this.messageRate,subscriptions:this.getSubscriptionCount(),historySize:this.messageHistory.length,lastMessageAt:this.lastMessageTime}}clear(){this.subscriptions.clear(),this.clearHistory(),this.messageCount=0,this.lastMessageTime=0,this.messageRate=0,this.enableLogging&&lr.info("All subscriptions cleared")}setLogging(e){this.enableLogging=e}setHistory(e,r){this.enableHistory=e,r!==void 0&&(this.maxHistorySize=r),e||this.clearHistory()}}const _A=new OA({enableHistory:!1,enableLogging:!1});class DA{constructor(e,r){Pe(this,"registry",new Map);Pe(this,"eventBus");Pe(this,"enableLogging",!1);Pe(this,"cleanupIntervalMs",6e4);Pe(this,"cleanupTimeoutMs",3e5);Pe(this,"cleanupTimer",null);this.eventBus=e,this.enableLogging=r?.enableLogging??!1,this.cleanupIntervalMs=r?.cleanupIntervalMs??6e4,this.cleanupTimeoutMs=r?.cleanupTimeoutMs??3e5,this.startCleanupTimer(),this.enableLogging&&lr.info("Registry initialized")}register(e,r,n){if(this.registry.has(e))throw new Error(`Provider ${e} is already registered`);const i={adapter:r,config:n,createdAt:Date.now(),refCount:0};this.registry.set(e,i),this.enableLogging&&lr.info(`Registered provider: ${e}`)}async unregister(e){const r=this.registry.get(e);if(!r){lr.warn(`Provider not found: ${e}`);return}try{await r.adapter.disconnect(),r.adapter.destroy()}catch(n){lr.error(`Error cleaning up ${e}:`,n)}this.registry.delete(e),this.enableLogging&&lr.info(`Unregistered provider: ${e}`)}get(e){const r=this.registry.get(e);return r?r.adapter:null}has(e){return this.registry.has(e)}getProviders(){return Array.from(this.registry.keys())}addRef(e){const r=this.registry.get(e);r&&(r.refCount++,this.enableLogging&&lr.debug(`${e} refCount: ${r.refCount}`))}release(e){const r=this.registry.get(e);r&&(r.refCount=Math.max(0,r.refCount-1),this.enableLogging&&lr.debug(`${e} refCount: ${r.refCount}`),r.refCount===0&&this.scheduleCleanup(e))}getRefCount(e){const r=this.registry.get(e);return r?r.refCount:0}getMetrics(e){const r=this.registry.get(e);return r?r.adapter.metrics:null}getAllMetrics(){const e=new Map;return this.registry.forEach((r,n)=>{e.set(n,r.adapter.metrics)}),e}getStatus(e){const r=this.registry.get(e);return r?r.adapter.status:null}isConnected(e){return this.getStatus(e)===Ln.CONNECTED}getAllStatuses(){const e=new Map;return this.registry.forEach((r,n)=>{e.set(n,r.adapter.status)}),e}scheduleCleanup(e){const r=this.registry.get(e);!r||r.refCount>0}startCleanupTimer(){this.cleanupTimer=setInterval(()=>{this.performCleanup()},this.cleanupIntervalMs)}async performCleanup(){const e=Date.now(),r=[];this.registry.forEach((n,i)=>{if(n.refCount>0)return;const a=n.adapter.metrics.lastMessageAt||n.createdAt;e-a>this.cleanupTimeoutMs&&r.push(i)});for(const n of r)this.enableLogging&&lr.info(`Cleaning up idle connection: ${n}`),await this.unregister(n)}async cleanup(){const e=this.getProviders();for(const r of e)await this.unregister(r);this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null),this.enableLogging&&lr.info("All connections cleaned up")}getStats(){const e={totalProviders:this.registry.size,connectedProviders:0,totalSubscriptions:0,totalMessages:0,providers:new Map};return this.registry.forEach((r,n)=>{const i=r.adapter.metrics;r.adapter.status===Ln.CONNECTED&&e.connectedProviders++,e.totalSubscriptions+=i.subscriptions,e.totalMessages+=i.messagesReceived,e.providers.set(n,{status:r.adapter.status,refCount:r.refCount,uptime:i.uptime||0,subscriptions:i.subscriptions})}),e}async reconnect(e){const r=this.registry.get(e);if(!r)throw new Error(`Provider not found: ${e}`);this.enableLogging&&lr.info(`Reconnecting provider: ${e}`);try{await r.adapter.disconnect(),await r.adapter.connect(r.config)}catch(n){throw lr.error(`Failed to reconnect ${e}:`,n),n}}async reconnectAll(){const e=this.getProviders();for(const r of e)try{await this.reconnect(r)}catch(n){lr.error(`Failed to reconnect ${r}:`,n)}}async pingAll(){const e=new Map;for(const[r,n]of this.registry.entries())if(n.adapter.status===Ln.CONNECTED)try{const i=await n.adapter.ping();e.set(r,i)}catch(i){lr.error(`Ping failed for ${r}:`,i),e.set(r,-1)}return e}setLogging(e){this.enableLogging=e}async destroy(){await this.cleanup(),this.enableLogging&&lr.info("Registry destroyed")}}class IA{constructor(e){Pe(this,"attempts",0);Pe(this,"lastAttemptTime",0);Pe(this,"lastSuccessTime",0);Pe(this,"policy");this.policy=e}getNextDelay(){return this.policy.enabled?(this.lastSuccessTime>0&&Date.now()-this.lastSuccessTime>this.policy.resetAfterMs&&this.reset(),Math.min(this.policy.initialDelayMs*Math.pow(this.policy.backoffMultiplier,this.attempts),this.policy.maxDelayMs)):0}recordAttempt(){this.attempts++,this.lastAttemptTime=Date.now()}recordSuccess(){this.lastSuccessTime=Date.now(),this.reset()}shouldAttempt(){return this.policy.enabled&&this.attempts<this.policy.maxAttempts}getAttempts(){return this.attempts}reset(){this.attempts=0}updatePolicy(e){this.policy={...this.policy,...e}}}class PA{constructor(e){Pe(this,"tokens");Pe(this,"maxTokens");Pe(this,"refillRate");Pe(this,"lastRefill");Pe(this,"config");Pe(this,"messageQueue",[]);this.config=e,this.maxTokens=e.maxMessagesPerSecond,this.tokens=this.maxTokens,this.refillRate=e.maxMessagesPerSecond,this.lastRefill=Date.now()}tryConsume(){return this.config.enabled?(this.refill(),this.tokens>=1?(this.tokens-=1,!0):!1):!0}refill(){const e=Date.now(),n=(e-this.lastRefill)/1e3*this.refillRate;this.tokens=Math.min(this.maxTokens,this.tokens+n),this.lastRefill=e}getWaitTime(){if(!this.config.enabled||(this.refill(),this.tokens>=1))return 0;const r=(1-this.tokens)/this.refillRate*1e3;return Math.max(r,this.config.throttleMs)}async execute(e){if(!this.config.enabled)return e();const r=this.getWaitTime();return r>0&&await this.sleep(r),this.tryConsume(),e()}queue(e){this.messageQueue.push(e),this.processQueue()}async processQueue(){for(;this.messageQueue.length>0;)if(this.tryConsume()){const e=this.messageQueue.shift();if(e)try{e()}catch(r){console.error("[RateLimiter] Error executing queued action:",r)}}else{const e=this.getWaitTime();await this.sleep(e)}}getAvailableTokens(){return this.refill(),Math.floor(this.tokens)}reset(){this.tokens=this.maxTokens,this.lastRefill=Date.now(),this.messageQueue=[]}updateConfig(e){this.config={...this.config,...e},this.maxTokens=this.config.maxMessagesPerSecond,this.refillRate=this.config.maxMessagesPerSecond}sleep(e){return new Promise(r=>setTimeout(r,e))}}class LA{constructor(e=5,r=6e4,n=2){Pe(this,"failures",0);Pe(this,"lastFailureTime",0);Pe(this,"state","closed");Pe(this,"successCount",0);this.failureThreshold=e,this.timeout=r,this.successThreshold=n}recordSuccess(){this.failures=0,this.lastFailureTime=0,this.state==="half-open"&&(this.successCount++,this.successCount>=this.successThreshold&&(this.state="closed",this.successCount=0))}recordFailure(){this.failures++,this.lastFailureTime=Date.now(),this.failures>=this.failureThreshold&&(this.state="open"),this.state==="half-open"&&(this.state="open",this.successCount=0)}isAllowed(){return this.state==="closed"?!0:this.state==="open"?Date.now()-this.lastFailureTime>=this.timeout?(this.state="half-open",this.successCount=0,!0):!1:!0}getState(){return this.state}reset(){this.failures=0,this.lastFailureTime=0,this.state="closed",this.successCount=0}}class zA{constructor(e=3e4,r=6e4){Pe(this,"lastHeartbeat",Date.now());Pe(this,"timeoutId",null);Pe(this,"onTimeout");this.intervalMs=e,this.timeoutMs=r}start(e){this.onTimeout=e,this.lastHeartbeat=Date.now(),this.scheduleCheck()}beat(){this.lastHeartbeat=Date.now()}stop(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.onTimeout=void 0}scheduleCheck(){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{Date.now()-this.lastHeartbeat>this.timeoutMs?this.onTimeout&&this.onTimeout():this.scheduleCheck()},this.intervalMs)}getTimeSinceLastBeat(){return Date.now()-this.lastHeartbeat}isHealthy(){return this.getTimeSinceLastBeat()<this.timeoutMs}}class MA{constructor(){Pe(this,"messageCount",0);Pe(this,"errorCount",0);Pe(this,"startTime",Date.now());Pe(this,"messageSizes",[]);Pe(this,"latencies",[]);Pe(this,"maxSamples",100)}recordMessage(e){this.messageCount++,e!==void 0&&(this.messageSizes.push(e),this.messageSizes.length>this.maxSamples&&this.messageSizes.shift())}recordError(){this.errorCount++}recordLatency(e){this.latencies.push(e),this.latencies.length>this.maxSamples&&this.latencies.shift()}getMetrics(){const e=Date.now()-this.startTime,r=e/1e3;return{messageCount:this.messageCount,errorCount:this.errorCount,messagesPerSecond:r>0?this.messageCount/r:0,errorRate:this.messageCount>0?this.errorCount/this.messageCount:0,averageMessageSize:this.average(this.messageSizes),averageLatency:this.average(this.latencies),uptime:e,uptimeHours:e/(1e3*60*60)}}reset(){this.messageCount=0,this.errorCount=0,this.startTime=Date.now(),this.messageSizes=[],this.latencies=[]}average(e){return e.length===0?0:e.reduce((r,n)=>r+n,0)/e.length}}function BA(s="ws"){return`${s}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}let Lb=class{constructor(){Pe(this,"ws",null);Pe(this,"_status",Ln.DISCONNECTED);Pe(this,"config",null);Pe(this,"reconnectionManager");Pe(this,"rateLimiter");Pe(this,"circuitBreaker");Pe(this,"heartbeatMonitor");Pe(this,"performanceMetrics");Pe(this,"messageCallbacks",[]);Pe(this,"errorCallbacks",[]);Pe(this,"statusCallbacks",[]);Pe(this,"subscriptions",new Set);Pe(this,"_metrics");Pe(this,"enableLogging",!1);this._metrics={provider:"",status:Ln.DISCONNECTED,messagesReceived:0,messagesPerSecond:0,reconnectionAttempts:0,errors:[],subscriptions:0},this.reconnectionManager=new IA(Pb),this.rateLimiter=new PA(Ib),this.circuitBreaker=new LA(5,6e4,2),this.heartbeatMonitor=new zA(3e4,6e4),this.performanceMetrics=new MA}get status(){return this._status}get metrics(){const e=this.performanceMetrics.getMetrics();return{...this._metrics,provider:this.provider,status:this._status,messagesReceived:e.messageCount,messagesPerSecond:e.messagesPerSecond,reconnectionAttempts:this.reconnectionManager.getAttempts(),subscriptions:this.subscriptions.size}}async connect(e){if(lr.info(`[${this.provider}] Connecting to WebSocket...`),!this.circuitBreaker.isAllowed())throw new Error(`Circuit breaker is open for ${this.provider}`);this.config=e,this.setStatus(Ln.CONNECTING);try{const r=this.getWebSocketUrl(e);lr.debug(`[${this.provider}] WebSocket URL: ${r}`),this.ws=new WebSocket(r),lr.debug(`[${this.provider}] WebSocket object created, readyState: ${this.ws.readyState}`),this.setupWebSocketHandlers(),lr.debug(`[${this.provider}] Waiting for WebSocket to open...`),await this.waitForConnection(),lr.debug(`[${this.provider}] WebSocket opened! readyState: ${this.ws?.readyState}`),this.reconnectionManager.recordSuccess(),this.circuitBreaker.recordSuccess(),this.setStatus(Ln.CONNECTED),this._metrics.connectedAt=Date.now(),this.heartbeatMonitor.start(()=>this.handleStaleConnection()),lr.debug(`[${this.provider}] Heartbeat monitoring started`),await this.onConnected(),lr.info(`[${this.provider}] Connection complete!`),this.log("Connected successfully")}catch(r){lr.error(`[${this.provider}] Connection failed:`,r),this.circuitBreaker.recordFailure(),this.reconnectionManager.recordAttempt();const n={timestamp:Date.now(),error:r instanceof Error?r.message:String(r)};if(this.addError(n),this.notifyError(n),this.setStatus(Ln.ERROR),this.reconnectionManager.shouldAttempt())lr.info(`[${this.provider}] Will retry connection...`),await this.scheduleReconnection();else throw r}}async disconnect(){this.log("Disconnecting..."),this.heartbeatMonitor.stop(),this.ws&&(this.ws.onclose=null,this.ws.onerror=null,(this.ws.readyState===WebSocket.OPEN||this.ws.readyState===WebSocket.CONNECTING)&&this.ws.close(),this.ws=null),this.setStatus(Ln.DISCONNECTED),this.subscriptions.clear(),await this.onDisconnected()}async subscribe(e,r){if(lr.debug(`[${this.provider}] Subscribe requested: ${e}`),lr.debug(`[${this.provider}] - WebSocket exists: ${!!this.ws}`),lr.debug(`[${this.provider}] - readyState: ${this.ws?.readyState} (OPEN=${WebSocket.OPEN})`),lr.debug(`[${this.provider}] - Status: ${this._status}`),!this.ws||this.ws.readyState!==WebSocket.OPEN)throw new Error(`Cannot subscribe: WebSocket is not open (readyState: ${this.ws?.readyState||"null"})`);if(this._status!==Ln.CONNECTED)throw new Error(`Cannot subscribe: connection status is ${this._status}`);if(!this.rateLimiter.tryConsume()){const n=this.rateLimiter.getWaitTime();this.log(`Rate limited, waiting ${n}ms before subscribing to ${e}`),await new Promise(i=>setTimeout(i,n))}await this.performSubscribe(e,r),this.subscriptions.add(e),this.log(`Subscribed to: ${e}`)}async unsubscribe(e){if(this._status!==Ln.CONNECTED){this.log(`Cannot unsubscribe: connection status is ${this._status}`);return}await this.performUnsubscribe(e),this.subscriptions.delete(e),this.log(`Unsubscribed from: ${e}`)}async send(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN)throw new Error("WebSocket is not connected");const r=typeof e=="string"?e:JSON.stringify(e);this.ws.send(r)}async ping(){const e=Date.now();await this.performPing();const r=Date.now()-e;return this._metrics.latency=r,this.performanceMetrics.recordLatency(r),r}getSubscriptions(){return Array.from(this.subscriptions)}onMessage(e){this.messageCallbacks.push(e)}onError(e){this.errorCallbacks.push(e)}onStatusChange(e){this.statusCallbacks.push(e)}destroy(){this.heartbeatMonitor.stop(),this.messageCallbacks=[],this.errorCallbacks=[],this.statusCallbacks=[],this.subscriptions.clear(),this.ws=null}async onConnected(){}async onDisconnected(){}setupWebSocketHandlers(){this.ws&&(this.ws.onopen=()=>{this.log("WebSocket connection opened")},this.ws.onmessage=e=>{this.heartbeatMonitor.beat(),this._metrics.lastMessageAt=Date.now(),this.performanceMetrics.recordMessage(e.data?.length);try{this.handleMessage(e)}catch(r){lr.error(`[${this.provider}] Error handling message:`,r),this.addError({timestamp:Date.now(),error:`Message handling error: ${r}`})}},this.ws.onerror=e=>{this.log("WebSocket error",e),this.addError({timestamp:Date.now(),error:"WebSocket error occurred"}),this.setStatus(Ln.ERROR)},this.ws.onclose=e=>{this.log(`WebSocket closed: ${e.code} - ${e.reason}`),this._status!==Ln.DISCONNECTED&&this.handleUnexpectedClose(e)})}waitForConnection(e=1e4){return new Promise((r,n)=>{if(!this.ws){n(new Error("WebSocket is null"));return}const i=setTimeout(()=>{n(new Error("Connection timeout"))},e);this.ws.addEventListener("open",()=>{clearTimeout(i),r()},{once:!0}),this.ws.addEventListener("error",o=>{clearTimeout(i),n(o)},{once:!0})})}async handleUnexpectedClose(e){this.log(`Unexpected close: ${e.code} - ${e.reason}`),this.reconnectionManager.shouldAttempt()?await this.scheduleReconnection():(this.setStatus(Ln.ERROR),this.addError({timestamp:Date.now(),error:"Max reconnection attempts reached",code:e.code}))}async scheduleReconnection(){const e=this.reconnectionManager.getNextDelay();if(this.setStatus(Ln.RECONNECTING),this.log(`Scheduling reconnection in ${e}ms (attempt ${this.reconnectionManager.getAttempts()+1})`),await new Promise(r=>setTimeout(r,e)),this.config)try{await this.connect(this.config),await this.resubscribe()}catch(r){lr.error(`[${this.provider}] Reconnection failed:`,r)}}async resubscribe(){const e=Array.from(this.subscriptions);this.subscriptions.clear();for(const r of e)try{await this.subscribe(r)}catch(n){lr.error(`[${this.provider}] Failed to resubscribe to ${r}:`,n)}}async handleStaleConnection(){if(this._status===Ln.RECONNECTING||this._status===Ln.CONNECTING){this.log("Already reconnecting, skipping stale connection handler");return}this.log("Connection appears stale, forcing reconnect"),await this.disconnect(),this.config&&this.reconnectionManager.shouldAttempt()&&await this.scheduleReconnection()}notifyMessage(e){this.messageCallbacks.forEach(r=>{try{r(e)}catch(n){lr.error(`[${this.provider}] Error in message callback:`,n)}})}notifyError(e){this.errorCallbacks.forEach(r=>{try{r(e)}catch(n){lr.error(`[${this.provider}] Error in error callback:`,n)}})}setStatus(e){this._status!==e&&(this._status=e,this._metrics.status=e,this.statusCallbacks.forEach(r=>{try{r(e)}catch(n){lr.error(`[${this.provider}] Error in status callback:`,n)}}),this.log(`Status changed to: ${e}`))}addError(e){this._metrics.errors.push(e),this.performanceMetrics.recordError(),this._metrics.errors.length>50&&(this._metrics.errors=this._metrics.errors.slice(-50))}log(...e){this.enableLogging&&lr.debug(`[${this.provider}]`,...e)}setLogging(e){this.enableLogging=e}},FA=class extends Lb{constructor(){super(...arguments);Pe(this,"provider","kraken");Pe(this,"WS_URL","wss://ws.kraken.com/v2");Pe(this,"WS_AUTH_URL","wss://ws-auth.kraken.com/v2");Pe(this,"reqIdCounter",1)}getWebSocketUrl(r){return r.api_key?this.WS_AUTH_URL:this.WS_URL}handleMessage(r){try{const n=JSON.parse(r.data);this.log("Received message:",n),n.method==="pong"?this.handlePong():n.method==="subscribe"||n.method==="unsubscribe"?this.handleSubscriptionResponse(n):n.channel?this.handleChannelMessage(n):n.error&&this.handleErrorMessage(n)}catch(n){console.error("[KrakenAdapter] Failed to parse message:",n)}}async performSubscribe(r,n){const{channel:i,symbol:o}=this.parseTopic(r),a={method:"subscribe",params:{channel:i,snapshot:n?.snapshot??!0},req_id:this.getNextReqId()};if(o){const l=this.normalizeSymbolForKraken(o);a.params.symbol=[l]}if(i==="book"||i==="level3"){let l=n?.depth??10;const d=[10,25,100,500,1e3];d.includes(l)||(l=d.reduce((p,f)=>Math.abs(f-l)<Math.abs(p-l)?f:p)),a.params.depth=l}i==="ohlc"&&(a.params.interval=n?.interval??1),i==="ticker"&&n?.event_trigger&&(a.params.event_trigger=n.event_trigger),i==="level3"&&this.config?.api_key&&(a.params.token=this.config.api_key),i==="instrument"&&n?.include_tokenized_assets!==void 0&&(a.params.include_tokenized_assets=n.include_tokenized_assets),await this.send(a),this.log(`Subscribed to ${i}${o?` for ${o}`:""}`)}async performUnsubscribe(r){const{channel:n,symbol:i}=this.parseTopic(r),o={method:"unsubscribe",params:{channel:n},req_id:this.getNextReqId()};i&&(o.params.symbol=[i]),await this.send(o),this.log(`Sent unsubscription request for ${r}`)}async performPing(){const r={method:"ping",req_id:this.getNextReqId()};await this.send(r)}async onConnected(){this.log("WebSocket connected successfully")}handleChannelMessage(r){if(!r.channel||!r.data)return;this.normalizeMessage(r).forEach(i=>{this.notifyMessage(i)})}normalizeMessage(r){const n=[];if(!r.data||r.data.length===0)return n;const i=r.channel||"unknown",o=r.type||"update";return r.data.forEach(a=>{let l="custom";const d=a.symbol;switch(i){case"ticker":l="ticker";break;case"trade":l="trade";break;case"ohlc":l="candle";break;case"book":case"level3":l="orderbook";const p=this.normalizeOrderBookData(a);n.push({provider:this.provider,channel:i,type:l,symbol:d,timestamp:r.timestamp?new Date(r.timestamp).getTime():Date.now(),data:p,raw:r});return;case"instrument":l="status";break;default:l="custom"}n.push({provider:this.provider,channel:i,type:l,symbol:d,timestamp:r.timestamp?new Date(r.timestamp).getTime():Date.now(),data:{...a,messageType:o},raw:r})}),n}normalizeOrderBookData(r){const n={messageType:r.type||"update"};return r.bids&&Array.isArray(r.bids)&&(n.bids=r.bids.map(i=>({price:parseFloat(i.price||i[0]||0),size:parseFloat(i.qty||i[1]||0)}))),r.asks&&Array.isArray(r.asks)&&(n.asks=r.asks.map(i=>({price:parseFloat(i.price||i[0]||0),size:parseFloat(i.qty||i[1]||0)}))),r.symbol&&(n.symbol=r.symbol),r.checksum&&(n.checksum=r.checksum),n}handleSubscriptionResponse(r){if(r.success)this.log("Subscription successful:",r);else if(r.error){const n=String(r.error);n.includes("not Found")||n.includes("invalid")||n.includes("not supported")?console.debug("[KrakenAdapter] Subscription info:",r.error):(console.error("[KrakenAdapter] Subscription error:",r.error),this.addError({timestamp:Date.now(),error:r.error}))}}handleErrorMessage(r){const n={timestamp:Date.now(),error:r.error||"Unknown error"};this.addError(n),this.notifyError(n),this.log("Error message:",r.error)}handlePong(){this.log("Received pong")}parseTopic(r){const n=r.split(".");return n.length===1?{channel:n[0]}:{channel:n[0],symbol:n.slice(1).join(".")}}getNextReqId(){return this.reqIdCounter++}normalizeSymbolForKraken(r){return r.toUpperCase()}},RP=class extends Lb{constructor(){super(...arguments);Pe(this,"provider","hyperliquid");Pe(this,"WS_URL","wss://api.hyperliquid.xyz/ws")}getWebSocketUrl(r){return this.WS_URL}handleMessage(r){try{const n=JSON.parse(r.data);this.log("Received message:",n),n.channel&&n.data&&this.handleChannelMessage(n)}catch(n){console.error("[HyperLiquidAdapter] Failed to parse message:",n)}}async performSubscribe(r,n){const{channel:i,symbol:o}=this.parseTopic(r),a={method:"subscribe",subscription:{type:this.mapChannelToType(i)}};o&&i!=="allMids"&&(a.subscription.coin=o),i==="ohlc"&&n?.interval&&(a.subscription.interval=this.normalizeInterval(n.interval)),await this.send(a),this.log(`Subscribed to ${i}${o?` for ${o}`:""}`)}async performUnsubscribe(r){const{channel:n,symbol:i}=this.parseTopic(r),o={method:"unsubscribe",subscription:{type:this.mapChannelToType(n)}};i&&n!=="allMids"&&(o.subscription.coin=i),await this.send(o),this.log(`Sent unsubscription request for ${r}`)}async performPing(){this.log("Ping not required for HyperLiquid")}async onConnected(){this.log("WebSocket connected successfully")}handleChannelMessage(r){if(!r.channel||!r.data)return;this.normalizeMessage(r).forEach(i=>{this.notifyMessage(i)})}normalizeMessage(r){const n=[],i=r.channel||"unknown",o=r.data;let a="custom",l;switch(i){case"allMids":return a="ticker",o.mids&&typeof o.mids=="object"&&Object.entries(o.mids).forEach(([p,f])=>{n.push({provider:this.provider,channel:"ticker",type:"ticker",symbol:p,timestamp:Date.now(),data:{last:parseFloat(f),mid:parseFloat(f)},raw:r})}),n;case"l2Book":a="orderbook",l=o.coin;const d=this.normalizeOrderBookData(o);return n.push({provider:this.provider,channel:"book",type:a,symbol:l,timestamp:o.time||Date.now(),data:d,raw:r}),n;case"trades":return a="trade",l=o.coin,Array.isArray(o.trades)&&o.trades.forEach(p=>{n.push({provider:this.provider,channel:"trades",type:"trade",symbol:l,timestamp:p.time||Date.now(),data:{price:parseFloat(p.px),size:parseFloat(p.sz),side:p.side==="A"?"sell":"buy",time:p.time},raw:r})}),n;case"candle":if(a="candle",l=o.coin,o.candle){const p=o.candle;n.push({provider:this.provider,channel:"ohlc",type:"candle",symbol:l,timestamp:p.t||Date.now(),data:{time:p.t,open:parseFloat(p.o),high:parseFloat(p.h),low:parseFloat(p.l),close:parseFloat(p.c),volume:parseFloat(p.v||0)},raw:r})}return n;default:a="custom"}return n.push({provider:this.provider,channel:i,type:a,symbol:l,timestamp:Date.now(),data:o,raw:r}),n}normalizeOrderBookData(r){const n={};if(r.levels&&Array.isArray(r.levels)&&r.levels.length===2){const[i,o]=r.levels;Array.isArray(i)&&(n.bids=i.map(a=>({price:parseFloat(a.px),size:parseFloat(a.sz),numOrders:a.n}))),Array.isArray(o)&&(n.asks=o.map(a=>({price:parseFloat(a.px),size:parseFloat(a.sz),numOrders:a.n})))}return r.coin&&(n.symbol=r.coin),r.time&&(n.time=r.time),n}mapChannelToType(r){return{ticker:"allMids",book:"l2Book",trades:"trades",ohlc:"candle",candle:"candle",allMids:"allMids",l2Book:"l2Book"}[r]||r}normalizeInterval(r){return typeof r=="number"?{1:"1m",5:"5m",15:"15m",60:"1h",240:"4h",1440:"1d"}[r]||"1m":r}parseTopic(r){const n=r.split(".");return n.length===1?{channel:n[0]}:{channel:n[0],symbol:n.slice(1).join(".")}}};const Wg={kraken:FA,hyperliquid:RP};function $A(){return Object.keys(Wg)}function GA(s){return s in Wg}function UA(s){const e=Wg[s];if(!e)throw new Error(`Adapter not found for provider: ${s}`);return new e}class WA{constructor(e){Pe(this,"eventBus");Pe(this,"registry");Pe(this,"config");Pe(this,"providerConfigs",new Map);Pe(this,"activeSubscriptions",new Map);Pe(this,"connectingProviders",new Set);this.config={...NA,...e},this.eventBus=_A,this.registry=new DA(this.eventBus,{enableLogging:this.config.enableLogging}),this.eventBus.setLogging(this.config.enableLogging),this.eventBus.setHistory(this.config.enableMetrics,100),this.log("WebSocketManager initialized")}async subscribe(e,r,n){try{const i=M0(e),{provider:o,channel:a,symbol:l}=i;await this.ensureConnection(o);const d=this.registry.get(o);if(!d)throw new Error(`Adapter not found for provider: ${o}`);const p=l?`${a}.${l}`:a;d.getSubscriptions().includes(p)||await d.subscribe(p,n);const h=this.eventBus.subscribe(e,r);this.registry.addRef(o);const x=BA("sub"),m={id:x,topic:e,callback:r,unsubscribe:()=>this.unsubscribe(x,e,o,p,h),params:n};return this.activeSubscriptions.set(x,m),this.log(`Subscribed to: ${e} (ID: ${x})`),m}catch(i){const o=i instanceof Error?i.message:String(i);throw!o.includes("not connected")&&!o.includes("not open")?console.error(`[WebSocketManager] Subscribe failed for ${e}:`,i):console.debug(`[WebSocketManager] Subscribe pending connection for ${e}`),i}}async unsubscribe(e,r,n,i,o){try{if(!this.activeSubscriptions.get(e))return;if(this.activeSubscriptions.delete(e),o(),this.registry.release(n),!Array.from(this.activeSubscriptions.values()).some(d=>d.topic===r)){const d=this.registry.get(n);d&&await d.unsubscribe(i)}this.log(`Unsubscribed from: ${r} (ID: ${e})`)}catch(a){console.error("[WebSocketManager] Unsubscribe failed:",a)}}async ensureConnection(e){if(!GA(e))throw new Error(`Provider not supported: ${e}`);if(!(this.registry.has(e)&&this.registry.isConnected(e))){if(this.connectingProviders.has(e)){for(this.log(`Already connecting to ${e}, waiting...`);this.connectingProviders.has(e);)await new Promise(r=>setTimeout(r,100));return}this.connectingProviders.add(e);try{const r=this.providerConfigs.get(e);if(!r)throw new Error(`No configuration found for provider: ${e}. Use setProviderConfig() first.`);if(!this.registry.has(e)){const i=UA(e);i.onMessage(o=>{const a=this.buildFullTopic(o);this.eventBus.publish(a,o)}),i.onError(o=>{this.log(`Error from ${e}:`,o)}),i.onStatusChange(o=>{this.log(`${e} status changed to: ${o}`)}),this.registry.register(e,i,r)}const n=this.registry.get(e);n&&n.status!==Ln.CONNECTED&&await n.connect(r)}finally{this.connectingProviders.delete(e)}}}buildFullTopic(e){const r=[e.provider,e.channel];return e.symbol&&r.push(e.symbol),r.join(".")}setProviderConfig(e,r){this.providerConfigs.set(e,r),this.log(`Configuration set for provider: ${e}`)}getProviderConfig(e){return this.providerConfigs.get(e)}async connect(e){await this.ensureConnection(e)}async disconnect(e){this.registry.has(e)&&(await this.registry.unregister(e),this.log(`Disconnected from provider: ${e}`))}getStatus(e){return this.registry.getStatus(e)}getAllStatuses(){return this.registry.getAllStatuses()}getMetrics(e){return this.registry.getMetrics(e)}getAllMetrics(){return this.registry.getAllMetrics()}getStats(){return{registry:this.registry.getStats(),eventBus:this.eventBus.getMetrics(),activeSubscriptions:this.activeSubscriptions.size,configuredProviders:this.providerConfigs.size}}async ping(e){const r=this.registry.get(e);if(!r)throw new Error(`Provider not connected: ${e}`);return r.ping()}async pingAll(){return this.registry.pingAll()}async reconnect(e){const n=this.getProviderSubscriptions(e).map(o=>({topic:o.topic,callback:o.callback,params:o.params}));await this.registry.reconnect(e);const i=this.registry.get(e);if(i&&n.length>0){this.log(`Resubscribing to ${n.length} topics for ${e}`);for(const o of n)try{const a=M0(o.topic),l=a.symbol?`${a.channel}.${a.symbol}`:a.channel;await i.subscribe(l,o.params),this.log(`Resubscribed to: ${o.topic}`)}catch(a){console.error(`[WebSocketManager] Failed to resubscribe to ${o.topic}:`,a)}}}async reconnectAll(){const e=this.registry.getProviders();for(const r of e)try{await this.reconnect(r)}catch(n){console.error(`[WebSocketManager] Failed to reconnect ${r}:`,n)}}getMessageHistory(e,r){return e?this.eventBus.getHistoryForTopic(e,r):this.eventBus.getHistory(r)}clearHistory(){this.eventBus.clearHistory()}getSubscriptions(){return Array.from(this.activeSubscriptions.values())}getProviderSubscriptions(e){return Array.from(this.activeSubscriptions.values()).filter(r=>r.topic.startsWith(`${e}.`))}setLogging(e){this.config.enableLogging=e,this.eventBus.setLogging(e),this.registry.setLogging(e)}updateConfig(e){this.config={...this.config,...e}}async destroy(){this.log("Destroying WebSocketManager...");const e=Array.from(this.activeSubscriptions.keys());for(const r of e){const n=this.activeSubscriptions.get(r);n&&n.unsubscribe()}await this.registry.destroy(),this.eventBus.clear(),this.log("WebSocketManager destroyed")}log(...e){this.config.enableLogging&&console.log("[WebSocketManager]",...e)}}let Ay=null;function wo(){return Ay||(Ay=new WA({enableLogging:!0,enableMetrics:!0})),Ay}const NP=Object.freeze(Object.defineProperty({__proto__:null,BaseAdapter:Lb,CircuitBreaker:LA,ConnectionStatus:Ln,DEFAULT_MANAGER_CONFIG:NA,DEFAULT_RATE_LIMIT:Ib,DEFAULT_RECONNECTION_POLICY:Pb,EventBus:OA,HeartbeatMonitor:zA,KrakenAdapter:FA,PerformanceMetrics:MA,RateLimiter:PA,ReconnectionManager:IA,WebSocketManager:WA,WebSocketRegistry:DA,adapters:Wg,createAdapter:UA,generateId:BA,getAvailableProviders:$A,getWebSocketManager:wo,globalEventBus:_A,isProviderAvailable:GA,parseTopic:M0},Symbol.toStringTag,{value:"Module"}));class sg extends Error{constructor(e,r,n,i){super(e),this.code=r,this.exchange=n,this.details=i,this.name="ExchangeError"}}class Ty extends sg{constructor(e,r,n){super(e,"AUTH_ERROR",r,n),this.name="AuthenticationError"}}class OP extends sg{constructor(e,r,n){super(e,"RATE_LIMIT",r,n),this.name="RateLimitError"}}class zb{constructor(e){Pe(this,"exchange");Pe(this,"_isConnected",!1);Pe(this,"_isAuthenticated",!1);Pe(this,"eventListeners",new Map);Pe(this,"id");Pe(this,"name");this.id=e.exchange;const r=iA[e.exchange];if(!r)throw new Error(`Exchange "${e.exchange}" not supported by CCXT`);this.exchange=new r({apiKey:e.credentials?.apiKey,secret:e.credentials?.secret,password:e.credentials?.password,uid:e.credentials?.uid,enableRateLimit:e.enableRateLimit??!0,timeout:e.timeout??3e4,...e.sandbox&&{sandbox:!0},...e.options}),this.name=this.exchange.name}async connect(){try{await this.exchange.loadMarkets(),this._isConnected=!0,this.emit("connected",{exchange:this.id})}catch(e){throw this._isConnected=!1,this.handleError(e)}}async disconnect(){this._isConnected=!1,this._isAuthenticated=!1,this.emit("disconnected",{exchange:this.id})}isConnected(){return this._isConnected}async authenticate(e){try{this.exchange.apiKey=e.apiKey,this.exchange.secret=e.secret,e.password&&(this.exchange.password=e.password),e.uid&&(this.exchange.uid=e.uid),await this.exchange.fetchBalance(),this._isAuthenticated=!0,this.emit("authenticated",{exchange:this.id})}catch(r){throw this._isAuthenticated=!1,new Ty("Authentication failed",this.id,r)}}isAuthenticated(){return this._isAuthenticated}async fetchMarkets(){try{return await this.ensureConnected(),await this.exchange.fetchMarkets()}catch(e){throw this.handleError(e)}}async fetchStatus(){try{return await this.ensureConnected(),this.exchange.has.fetchStatus?await this.exchange.fetchStatus():{status:"ok",updated:Date.now()}}catch(e){throw this.handleError(e)}}async fetchCurrencies(){try{return await this.ensureConnected(),this.exchange.has.fetchCurrencies?await this.exchange.fetchCurrencies():{}}catch(e){throw this.handleError(e)}}async fetchTime(){try{return await this.ensureConnected(),await this.exchange.fetchTime()}catch(e){throw this.handleError(e)}}async fetchTicker(e){try{return await this.ensureConnected(),await this.exchange.fetchTicker(e)}catch(r){throw this.handleError(r)}}async fetchTickers(e){try{return await this.ensureConnected(),await this.exchange.fetchTickers(e)}catch(r){throw this.handleError(r)}}async fetchOrderBook(e,r){try{return await this.ensureConnected(),await this.exchange.fetchOrderBook(e,r)}catch(n){throw this.handleError(n)}}async fetchTrades(e,r){try{return await this.ensureConnected(),await this.exchange.fetchTrades(e,void 0,r)}catch(n){throw this.handleError(n)}}async fetchOHLCV(e,r="1m",n){try{return await this.ensureConnected(),await this.exchange.fetchOHLCV(e,r,void 0,n)}catch(i){throw this.handleError(i)}}async fetchBalance(){try{return await this.ensureAuthenticated(),await this.exchange.fetchBalance()}catch(e){throw this.handleError(e)}}async fetchLedger(e,r,n){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchLedger)throw new Error("fetchLedger not supported by this exchange");return await this.exchange.fetchLedger(e,r,n)}catch(i){throw this.handleError(i)}}async fetchTradingFee(e){try{return await this.ensureAuthenticated(),this.exchange.has.fetchTradingFee?await this.exchange.fetchTradingFee(e):(await this.exchange.fetchTradingFees())[e]||null}catch(r){throw this.handleError(r)}}async fetchPositions(e){try{return await this.ensureAuthenticated(),this.exchange.has.fetchPositions?await this.exchange.fetchPositions(e):[]}catch(r){throw this.handleError(r)}}async createOrder(e,r,n,i,o,a){try{return await this.ensureAuthenticated(),await this.exchange.createOrder(e,r,n,i,o,a)}catch(l){throw this.handleError(l)}}async createOrders(e){try{if(await this.ensureAuthenticated(),!this.exchange.has.createOrders){const r=[];for(const n of e){const i=await this.createOrder(n.symbol,n.type,n.side,n.amount,n.price,n.params);r.push(i)}return r}return await this.exchange.createOrders(e)}catch(r){throw this.handleError(r)}}async createMarketOrderWithCost(e,r,n,i){try{if(await this.ensureAuthenticated(),!this.exchange.has.createMarketOrderWithCost)throw new Error("createMarketOrderWithCost not supported");return await this.exchange.createMarketOrderWithCost(e,r,n,i)}catch(o){throw this.handleError(o)}}async createMarketBuyOrderWithCost(e,r,n){try{return await this.ensureAuthenticated(),this.exchange.has.createMarketBuyOrderWithCost?await this.exchange.createMarketBuyOrderWithCost(e,r,n):await this.createMarketOrderWithCost(e,"buy",r,n)}catch(i){throw this.handleError(i)}}async editOrder(e,r,n,i,o,a,l){try{if(await this.ensureAuthenticated(),!this.exchange.has.editOrder)throw new Error("editOrder not supported by this exchange");return await this.exchange.editOrder(e,r,n,i,o,a,l)}catch(d){throw this.handleError(d)}}async cancelOrder(e,r){try{return await this.ensureAuthenticated(),await this.exchange.cancelOrder(e,r)}catch(n){throw this.handleError(n)}}async cancelOrders(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.cancelOrders){const n=[];for(const i of e){if(!r)throw new Error("Symbol required for bulk cancel fallback");const o=await this.cancelOrder(i,r);n.push(o)}return n}return await this.exchange.cancelOrders(e,r)}catch(n){throw this.handleError(n)}}async cancelAllOrders(e){try{if(await this.ensureAuthenticated(),!this.exchange.has.cancelAllOrders)throw new Error("Exchange does not support cancelAllOrders");return await this.exchange.cancelAllOrders(e)}catch(r){throw this.handleError(r)}}async cancelAllOrdersAfter(e){try{if(await this.ensureAuthenticated(),!this.exchange.has.cancelAllOrdersAfter)throw new Error("cancelAllOrdersAfter not supported by this exchange");return await this.exchange.cancelAllOrdersAfter(e)}catch(r){throw this.handleError(r)}}async fetchOrder(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchOrder(e,r)}catch(n){throw this.handleError(n)}}async fetchOrdersByIds(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchOrdersByIds){const n=[];for(const i of e){if(!r)throw new Error("Symbol required for fetchOrdersByIds fallback");const o=await this.fetchOrder(i,r);n.push(o)}return n}return await this.exchange.fetchOrdersByIds(e,r)}catch(n){throw this.handleError(n)}}async fetchOrderTrades(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchOrderTrades)throw new Error("fetchOrderTrades not supported by this exchange");return await this.exchange.fetchOrderTrades(e,r)}catch(n){throw this.handleError(n)}}async fetchMyTrades(e,r,n){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchMyTrades)throw new Error("fetchMyTrades not supported by this exchange");return await this.exchange.fetchMyTrades(e,r,n)}catch(i){throw this.handleError(i)}}async fetchOpenOrders(e){try{return await this.ensureAuthenticated(),await this.exchange.fetchOpenOrders(e)}catch(r){throw this.handleError(r)}}async fetchClosedOrders(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchClosedOrders(e,void 0,r)}catch(n){throw this.handleError(n)}}async fetchDeposits(e,r,n){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchDeposits)throw new Error("fetchDeposits not supported by this exchange");return await this.exchange.fetchDeposits(e,r,n)}catch(i){throw this.handleError(i)}}async fetchWithdrawals(e,r,n){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchWithdrawals)throw new Error("fetchWithdrawals not supported by this exchange");return await this.exchange.fetchWithdrawals(e,r,n)}catch(i){throw this.handleError(i)}}async fetchDepositAddress(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchDepositAddress)throw new Error("fetchDepositAddress not supported by this exchange");return await this.exchange.fetchDepositAddress(e,r)}catch(n){throw this.handleError(n)}}async createDepositAddress(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.createDepositAddress)throw new Error("createDepositAddress not supported by this exchange");return await this.exchange.createDepositAddress(e,r)}catch(n){throw this.handleError(n)}}async fetchDepositMethods(e){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchDepositMethods)throw new Error("fetchDepositMethods not supported by this exchange");return await this.exchange.fetchDepositMethods(e)}catch(r){throw this.handleError(r)}}async withdraw(e,r,n,i,o){try{if(await this.ensureAuthenticated(),!this.exchange.has.withdraw)throw new Error("withdraw not supported by this exchange");return await this.exchange.withdraw(e,r,n,i,o)}catch(a){throw this.handleError(a)}}async transfer(e,r,n,i,o){try{if(await this.ensureAuthenticated(),!this.exchange.has.transfer)throw new Error("transfer not supported by this exchange");return await this.exchange.transfer(e,r,n,i,o)}catch(a){throw this.handleError(a)}}async transferOut(e,r,n){try{if(await this.ensureAuthenticated(),!this.exchange.has.transfer)throw new Error("transferOut not supported by this exchange");return await this.exchange.transfer(e,r,"spot","external",n)}catch(i){throw this.handleError(i)}}getCapabilities(){const e=this.exchange.has;return{spot:!!e.spot,margin:!!e.margin,futures:!!e.future,options:!!e.option,swap:!!e.swap,supportedOrderTypes:this.getSupportedOrderTypes(),supportedTimeInForce:["GTC","IOC","FOK","PO"],leverageTrading:!!e.setLeverage,stopOrders:!!e.createStopOrder,conditionalOrders:!!e.createOrder,algoOrders:!1,realtimeData:!!e.watchTicker,historicalData:!!e.fetchOHLCV,websocketSupport:!!e.watchTicker,multiAccount:!1,subAccounts:!1,portfolioMargin:!1,restApi:!0,websocketApi:!!e.watchTicker,fixApi:!1,rateLimits:{public:1e3,private:3e3,trading:1e3}}}getSupportedOrderTypes(){const e=["market","limit"];return this.exchange.has.createStopOrder&&e.push("stop","stop_limit"),this.exchange.has.createTrailingAmountOrder&&e.push("trailing_stop"),e}getMarkets(){return this.exchange.markets}on(e,r){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(r)}off(e,r){this.eventListeners.get(e)?.delete(r)}emit(e,r){const n={event:e,exchange:this.id,timestamp:Date.now(),data:r};this.eventListeners.get(e)?.forEach(i=>{try{i(n)}catch(o){console.error(`Error in event listener for ${e}:`,o)}})}handleError(e){if(e instanceof sg)return e;const r=e.message||"Unknown error";return r.includes("rate limit")?new OP(r,this.id,e):r.includes("authentication")||r.includes("Invalid API")?new Ty(r,this.id,e):new sg(r,"UNKNOWN",this.id,e)}async ensureConnected(){this._isConnected||await this.connect()}async ensureAuthenticated(){if(await this.ensureConnected(),!this._isAuthenticated&&this.exchange.apiKey&&this.exchange.secret)throw new Ty("Not authenticated",this.id)}parseSymbol(e){const r=e.split("/");if(r.length!==2)throw new Error(`Invalid symbol format: ${e}`);return{base:r[0],quote:r[1]}}formatSymbol(e,r){return`${e}/${r}`}}class qA extends zb{constructor(e){super({exchange:"kraken",enableRateLimit:!0,timeout:3e4,...e})}getCapabilities(){return{...super.getCapabilities(),spot:!0,margin:!0,futures:!0,swap:!1,options:!1,supportedOrderTypes:["market","limit","stop","stop_limit","trailing_stop","iceberg"],leverageTrading:!0,stopOrders:!0,conditionalOrders:!0,algoOrders:!0,realtimeData:!0,historicalData:!0,websocketSupport:!0,rateLimits:{public:1e3,private:3e3,trading:1e3}}}async createStopLossOrder(e,r,n,i,o){const a=o?"stop_limit":"stop";return await this.createOrder(e,a,r,n,o,{stopPrice:i})}async createTakeProfitOrder(e,r,n,i,o){const a=o?"stop_limit":"stop";return await this.createOrder(e,a,r,n,o,{stopPrice:i,trigger:"last"})}async createTrailingStopOrder(e,r,n,i){return await this.createOrder(e,"trailing_stop",r,n,void 0,{trailingPercent:i})}async createIcebergOrder(e,r,n,i,o){return await this.createOrder(e,"iceberg",r,n,i,{icebergQty:o})}async setLeverage(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.setLeverage)throw new Error("Leverage not supported");return await this.exchange.setLeverage(r,e)}catch(n){throw this.handleError(n)}}async createMarginOrder(e,r,n,i,o,a){const l={leverage:a,marginMode:"cross"};return await this.createOrder(e,r,n,i,o,l)}async fetchMarginBalance(){try{return await this.ensureAuthenticated(),await this.exchange.fetchBalance({type:"margin"})}catch(e){throw this.handleError(e)}}async transfer(e,r,n,i){try{if(await this.ensureAuthenticated(),!this.exchange.has.transfer)throw new Error("Transfers not supported");return await this.exchange.transfer(e,r,n,i)}catch(o){throw this.handleError(o)}}async fetchFundingHistory(e,r,n){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchFundingHistory)throw new Error("Funding history not available");return await this.exchange.fetchFundingHistory(e,r,n)}catch(i){throw this.handleError(i)}}async fetchStakingAssets(){try{return await this.ensureAuthenticated(),await this.exchange.privatePostStakingAssets()}catch(e){throw this.handleError(e)}}async stakeAsset(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.privatePostStakingStake({asset:e,amount:r.toString(),method:n})}catch(i){throw this.handleError(i)}}async unstakeAsset(e,r){try{return await this.ensureAuthenticated(),await this.exchange.privatePostStakingUnstake({asset:e,amount:r.toString()})}catch(n){throw this.handleError(n)}}async fetchFuturesMarkets(){try{return await new iA.krakenfutures({apiKey:this.exchange.apiKey,secret:this.exchange.secret,enableRateLimit:!0}).loadMarkets()}catch(e){throw this.handleError(e)}}async fetchHistoricalOHLCV(e,r,n,i=720){try{return await this.ensureConnected(),await this.exchange.fetchOHLCV(e,r,n,i)}catch(o){throw this.handleError(o)}}async fetchRecentTrades(e,r=100){try{return await this.ensureConnected(),(await this.exchange.fetchTrades(e,void 0,r)).map(i=>({...i,exchange:"kraken",timestamp:i.timestamp||Date.now()}))}catch(n){throw this.handleError(n)}}async fetchTradingFees(){try{return await this.ensureAuthenticated(),await this.exchange.fetchTradingFees()}catch(e){throw this.handleError(e)}}async fetchTradingFee(e){try{return await this.ensureAuthenticated(),(await this.exchange.fetchTradingFees())[e]||null}catch(r){throw this.handleError(r)}}async fetchLedger(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchLedger(e,r,n)}catch(i){throw this.handleError(i)}}async fetchDepositAddress(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchDepositAddress(e,{network:r})}catch(n){throw this.handleError(n)}}async createDepositAddress(e,r){try{return await this.ensureAuthenticated(),await this.exchange.createDepositAddress(e,{network:r})}catch(n){throw this.handleError(n)}}async fetchDepositMethods(e){try{return await this.ensureAuthenticated(),await this.exchange.fetchDepositMethods(e)}catch(r){throw this.handleError(r)}}async fetchDeposits(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchDeposits(e,r,n)}catch(i){throw this.handleError(i)}}async fetchWithdrawals(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchWithdrawals(e,r,n)}catch(i){throw this.handleError(i)}}async withdraw(e,r,n,i,o){try{return await this.ensureAuthenticated(),await this.exchange.withdraw(e,r,n,i,{network:o})}catch(a){throw this.handleError(a)}}async editOrder(e,r,n,i,o,a,l){try{return await this.ensureAuthenticated(),await this.exchange.editOrder(e,r,n,i,o,a,l)}catch(d){throw this.handleError(d)}}async fetchOrder(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchOrder(e,r)}catch(n){throw this.handleError(n)}}async fetchOrdersByIds(e,r){try{await this.ensureAuthenticated();const n=[];for(const i of e){if(!r)throw new Error("Symbol required for Kraken fetchOrdersByIds");const o=await this.fetchOrder(i,r);n.push(o)}return n}catch(n){throw this.handleError(n)}}async fetchOrderTrades(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchOrderTrades(e,r)}catch(n){throw this.handleError(n)}}async fetchMyTrades(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchMyTrades(e,r,n)}catch(i){throw this.handleError(i)}}async cancelOrders(e,r){try{await this.ensureAuthenticated();const n=[];for(const i of e){if(!r)throw new Error("Symbol required for Kraken bulk cancel");const o=await this.cancelOrder(i,r);n.push(o)}return n}catch(n){throw this.handleError(n)}}async cancelAllOrdersAfter(e){try{return await this.ensureAuthenticated(),await this.exchange.cancelAllOrdersAfter(e)}catch(r){throw this.handleError(r)}}async createMarketBuyOrderWithCost(e,r){try{return await this.ensureAuthenticated(),await this.exchange.createMarketBuyOrderWithCost(e,r)}catch(n){throw this.handleError(n)}}async getSystemStatus(){try{return await this.exchange.publicGetSystemStatus()}catch(e){throw this.handleError(e)}}async getServerTime(){try{return await this.exchange.fetchTime()}catch(e){throw this.handleError(e)}}normalizeSymbol(e){const r=this.exchange.markets;for(const n in r)if(r[n].id===e)return n;return e}getPopularPairs(){return["BTC/USD","ETH/USD","XRP/USD","SOL/USD","ADA/USD","MATIC/USD","AVAX/USD","DOT/USD","LINK/USD","UNI/USD","BTC/EUR","ETH/EUR","BTC/USDT","ETH/USDT"]}}class HA extends zb{constructor(e){super({exchange:"hyperliquid",enableRateLimit:!0,timeout:3e4,...e})}getCapabilities(){return{...super.getCapabilities(),spot:!0,margin:!1,futures:!0,swap:!0,options:!1,supportedOrderTypes:["limit","market","stop","stop_limit"],leverageTrading:!0,stopOrders:!0,conditionalOrders:!0,algoOrders:!1,realtimeData:!0,historicalData:!0,websocketSupport:!0,rateLimits:{public:100,private:200,trading:100}}}setVaultAddress(e){this.exchange.options={...this.exchange.options,vaultAddress:e}}setSubAccountAddress(e){this.exchange.options={...this.exchange.options,subAccountAddress:e}}async fetchVaultBalance(e){try{return await this.ensureAuthenticated(),this.setVaultAddress(e),await this.fetchBalance()}catch(r){throw this.handleError(r)}}async createStopLossOrder(e,r,n,i,o){const a=o||i;return await this.createOrder(e,"stop_limit",r,n,a,{stopPrice:i,stopLossPrice:i})}async createTakeProfitOrder(e,r,n,i,o){const a=o||i;return await this.createOrder(e,"stop_limit",r,n,a,{stopPrice:i,takeProfitPrice:i})}async createReduceOnlyOrder(e,r,n,i,o){return await this.createOrder(e,r,n,i,o,{reduceOnly:!0})}async createPostOnlyOrder(e,r,n,i){return await this.createOrder(e,"limit",r,n,i,{postOnly:!0})}async setLeverage(e,r){try{if(await this.ensureAuthenticated(),r<1||r>50)throw new Error("HyperLiquid leverage must be between 1x and 50x");return await this.exchange.setLeverage(r,e)}catch(n){throw this.handleError(n)}}async setMarginMode(e,r){try{return await this.ensureAuthenticated(),await this.exchange.setMarginMode(r,e)}catch(n){throw this.handleError(n)}}async fetchTradingFee(e){try{return await this.ensureAuthenticated(),(await this.exchange.fetchTradingFees())[e]||null}catch(r){throw this.handleError(r)}}async fetchFundingRates(e){try{if(await this.ensureConnected(),!this.exchange.has.fetchFundingRates){e||(e=(await this.fetchMarkets()).filter(i=>i.swap).map(i=>i.symbol));const r={};for(const n of e)try{r[n]=await this.fetchFundingRate(n)}catch{}return r}return await this.exchange.fetchFundingRates(e)}catch(r){throw this.handleError(r)}}async fetchLedger(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchLedger(e,r,n)}catch(i){throw this.handleError(i)}}async editOrder(e,r,n,i,o,a,l){try{return await this.ensureAuthenticated(),await this.exchange.editOrder(e,r,n,i,o,a,l)}catch(d){throw this.handleError(d)}}async fetchOrder(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchOrder(e,r)}catch(n){throw this.handleError(n)}}async fetchOrdersByIds(e,r){try{await this.ensureAuthenticated();const n=[];for(const i of e){if(!r)throw new Error("Symbol required");const o=await this.fetchOrder(i,r);n.push(o)}return n}catch(n){throw this.handleError(n)}}async fetchOrderTrades(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchOrderTrades(e,r)}catch(n){throw this.handleError(n)}}async fetchMyTrades(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchMyTrades(e,r,n)}catch(i){throw this.handleError(i)}}async cancelOrders(e,r){try{await this.ensureAuthenticated();const n=[];for(const i of e){if(!r)throw new Error("Symbol required");const o=await this.cancelOrder(i,r);n.push(o)}return n}catch(n){throw this.handleError(n)}}async createMarketBuyOrderWithCost(e,r){try{await this.ensureAuthenticated();const n=await this.fetchTicker(e),i=n.ask||n.last;if(!i)throw new Error("Cannot determine price");const o=r/(i*1.05);return await this.createOrder(e,"market","buy",o)}catch(n){throw this.handleError(n)}}async createOrdersRequest(e){try{return await this.ensureAuthenticated(),this.exchange.has.createOrders?await this.exchange.createOrdersRequest(e):await this.createOrders(e)}catch(r){throw this.handleError(r)}}async editOrders(e){try{await this.ensureAuthenticated();const r=[];for(const n of e){const i=await this.editOrder(n.id,n.symbol,n.type,n.side,n.amount,n.price,n.params);r.push(i)}return r}catch(r){throw this.handleError(r)}}async cancelOrdersRequest(e,r){try{return await this.ensureAuthenticated(),await this.cancelOrders(e,r)}catch(n){throw this.handleError(n)}}async cancelOrdersForSymbols(e){try{await this.ensureAuthenticated();const r=[];for(const n of e){const i=await this.cancelAllOrders(n);r.push(...i)}return r}catch(r){throw this.handleError(r)}}async cancelAllOrdersAfter(e){try{if(await this.ensureAuthenticated(),!this.exchange.has.cancelAllOrdersAfter)throw new Error("cancelAllOrdersAfter not supported");return await this.exchange.cancelAllOrdersAfter(e)}catch(r){throw this.handleError(r)}}async fetchPosition(e){try{return await this.ensureAuthenticated(),(await this.fetchPositions([e])).find(n=>n.symbol===e)||null}catch(r){throw this.handleError(r)}}async fetchOrders(e,r,n){try{if(await this.ensureAuthenticated(),!this.exchange.has.fetchOrders){const i=await this.fetchOpenOrders(e),o=await this.fetchClosedOrders(e,n);return[...i,...o]}return await this.exchange.fetchOrders(e,r,n)}catch(i){throw this.handleError(i)}}async fetchCanceledOrders(e,r,n){try{return await this.ensureAuthenticated(),this.exchange.has.fetchCanceledOrders?await this.exchange.fetchCanceledOrders(e,r,n):(await this.fetchOrders(e,r,n)).filter(o=>o.status==="canceled")}catch(i){throw this.handleError(i)}}async fetchCanceledAndClosedOrders(e,r,n){try{return await this.ensureAuthenticated(),(await this.fetchOrders(e,r,n)).filter(o=>o.status==="canceled"||o.status==="closed")}catch(i){throw this.handleError(i)}}async addMargin(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.addMargin)throw new Error("addMargin not supported");return await this.exchange.addMargin(e,r)}catch(n){throw this.handleError(n)}}async reduceMargin(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.reduceMargin)throw new Error("reduceMargin not supported");return await this.exchange.reduceMargin(e,r)}catch(n){throw this.handleError(n)}}async createVault(e,r){try{if(await this.ensureAuthenticated(),!this.exchange.has.createVault)throw new Error("createVault not supported - use HyperLiquid web interface");return await this.exchange.createVault(e,r)}catch(n){throw this.handleError(n)}}async fetchHip3Markets(){try{return await this.ensureConnected(),this.exchange.has.fetchHip3Markets?await this.exchange.fetchHip3Markets():await this.fetchSpotMarkets()}catch(e){throw this.handleError(e)}}async fetchSwapMarkets(){try{return await this.ensureConnected(),(await this.fetchMarkets()).filter(r=>r.swap||r.type==="swap")}catch(e){throw this.handleError(e)}}async fetchSpotMarkets(){try{return await this.ensureConnected(),(await this.fetchMarkets()).filter(r=>r.spot||r.type==="spot")}catch(e){throw this.handleError(e)}}calculatePricePrecision(e){const r=this.exchange.markets[e];return r&&r.precision?.price||8}async fetchOpenInterest(e){try{if(await this.ensureConnected(),!this.exchange.has.fetchOpenInterest)throw new Error("fetchOpenInterest not supported");return await this.exchange.fetchOpenInterest(e)}catch(r){throw this.handleError(r)}}async fetchOpenInterests(e){try{if(await this.ensureConnected(),!this.exchange.has.fetchOpenInterests){if(!e)throw new Error("Symbols required");const r=[];for(const n of e){const i=await this.fetchOpenInterest(n);r.push(i)}return r}return await this.exchange.fetchOpenInterests(e)}catch(r){throw this.handleError(r)}}async fetchFundingHistory(e,r,n){try{return await this.ensureConnected(),this.exchange.has.fetchFundingHistory?await this.exchange.fetchFundingHistory(e,r,n):await this.fetchFundingRateHistory(e,r,n)}catch(i){throw this.handleError(i)}}reserveRequestWeight(e){return this.exchange.reserveRequestWeight?this.exchange.reserveRequestWeight(e):!0}async createOrderWs(e,r,n,i,o,a){try{return await this.ensureAuthenticated(),this.exchange.has.createOrderWs?await this.exchange.createOrderWs(e,r,n,i,o,a):await this.createOrder(e,r,n,i,o,a)}catch(l){throw this.handleError(l)}}async createOrdersWs(e){try{return await this.ensureAuthenticated(),this.exchange.has.createOrdersWs?await this.exchange.createOrdersWs(e):await this.createOrdersRequest(e)}catch(r){throw this.handleError(r)}}async editOrderWs(e,r,n,i,o,a,l){try{return await this.ensureAuthenticated(),this.exchange.has.editOrderWs?await this.exchange.editOrderWs(e,r,n,i,o,a,l):await this.editOrder(e,r,n,i,o,a,l)}catch(d){throw this.handleError(d)}}async cancelOrderWs(e,r,n){try{return await this.ensureAuthenticated(),this.exchange.has.cancelOrderWs?await this.exchange.cancelOrderWs(e,r,n):await this.cancelOrder(e,r)}catch(i){throw this.handleError(i)}}async cancelOrdersWs(e,r,n){try{return await this.ensureAuthenticated(),this.exchange.has.cancelOrdersWs?await this.exchange.cancelOrdersWs(e,r,n):await this.cancelOrders(e,r)}catch(i){throw this.handleError(i)}}async watchOrderBook(e,r){try{if(!this.exchange.has.watchOrderBook)throw new Error("watchOrderBook requires ccxt.pro package");return await this.exchange.watchOrderBook(e,r)}catch(n){throw this.handleError(n)}}async unWatchOrderBook(e){try{return this.exchange.has.unwatch?await this.exchange.unwatch("orderbook",e):void 0}catch(r){throw this.handleError(r)}}async watchTicker(e){try{if(!this.exchange.has.watchTicker)throw new Error("watchTicker requires ccxt.pro package");return await this.exchange.watchTicker(e)}catch(r){throw this.handleError(r)}}async watchTickers(e){try{if(!this.exchange.has.watchTickers)throw new Error("watchTickers requires ccxt.pro package");return await this.exchange.watchTickers(e)}catch(r){throw this.handleError(r)}}async unWatchTickers(e){try{if(!this.exchange.has.unwatch)return;if(e)for(const r of e)await this.exchange.unwatch("ticker",r)}catch(r){throw this.handleError(r)}}async watchMyTrades(e){try{if(!this.exchange.has.watchMyTrades)throw new Error("watchMyTrades requires ccxt.pro package");return await this.exchange.watchMyTrades(e)}catch(r){throw this.handleError(r)}}async watchTrades(e){try{if(!this.exchange.has.watchTrades)throw new Error("watchTrades requires ccxt.pro package");return await this.exchange.watchTrades(e)}catch(r){throw this.handleError(r)}}async unWatchTrades(e){try{return this.exchange.has.unwatch?await this.exchange.unwatch("trades",e):void 0}catch(r){throw this.handleError(r)}}async watchOHLCV(e,r="1m",n,i){try{if(!this.exchange.has.watchOHLCV)throw new Error("watchOHLCV requires ccxt.pro package");return await this.exchange.watchOHLCV(e,r,n,i)}catch(o){throw this.handleError(o)}}async unWatchOHLCV(e,r="1m"){try{return this.exchange.has.unwatch?await this.exchange.unwatch("ohlcv",e,r):void 0}catch(n){throw this.handleError(n)}}async watchOrders(e){try{if(!this.exchange.has.watchOrders)throw new Error("watchOrders requires ccxt.pro package");return await this.exchange.watchOrders(e)}catch(r){throw this.handleError(r)}}async fetchDepositAddress(e,r){try{return await this.ensureAuthenticated(),await this.exchange.fetchDepositAddress(e,r)}catch(n){throw this.handleError(n)}}async fetchDeposits(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchDeposits(e,r,n)}catch(i){throw this.handleError(i)}}async fetchWithdrawals(e,r,n){try{return await this.ensureAuthenticated(),await this.exchange.fetchWithdrawals(e,r,n)}catch(i){throw this.handleError(i)}}async withdraw(e,r,n,i,o){try{return await this.ensureAuthenticated(),await this.exchange.withdraw(e,r,n,i,o)}catch(a){throw this.handleError(a)}}async transfer(e,r,n,i){try{return await this.ensureAuthenticated(),await this.exchange.transfer(e,r,n,i)}catch(o){throw this.handleError(o)}}async fetchFundingRate(e){try{return await this.ensureConnected(),await this.exchange.fetchFundingRate(e)}catch(r){throw this.handleError(r)}}async fetchFundingRateHistory(e,r,n){try{return await this.ensureConnected(),await this.exchange.fetchFundingRateHistory(e,r,n)}catch(i){throw this.handleError(i)}}getPopularPairs(){return["BTC/USDC:USDC","ETH/USDC:USDC","SOL/USDC:USDC","ARB/USDC:USDC","AVAX/USDC:USDC","MATIC/USDC:USDC","OP/USDC:USDC","DOGE/USDC:USDC","LINK/USDC:USDC","UNI/USDC:USDC"]}async getSystemStatus(){try{return await this.fetchStatus()}catch(e){throw this.handleError(e)}}async getServerTime(){try{return await this.fetchTime()}catch(e){throw this.handleError(e)}}isUsingCoincurve(){return!!this.exchange.coincurve}}const _P={kraken:{id:"kraken",name:"Kraken",adapter:qA,type:"centralized",assetClass:"crypto",region:"global",features:{spot:!0,margin:!0,futures:!0,staking:!0,earn:!0}},hyperliquid:{id:"hyperliquid",name:"HyperLiquid",adapter:HA,type:"decentralized",assetClass:"crypto",region:"global",features:{spot:!0,margin:!1,futures:!0,swap:!0,vault:!0,subaccounts:!0}}};function YA(s,e){return function(){return s.apply(e,arguments)}}const{toString:DP}=Object.prototype,{getPrototypeOf:Mb}=Object,{iterator:qg,toStringTag:KA}=Symbol,Hg=(s=>e=>{const r=DP.call(e);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),To=s=>(s=s.toLowerCase(),e=>Hg(e)===s),Yg=s=>e=>typeof e===s,{isArray:$d}=Array,kd=Yg("undefined");function Gp(s){return s!==null&&!kd(s)&&s.constructor!==null&&!kd(s.constructor)&&mi(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const VA=To("ArrayBuffer");function IP(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&VA(s.buffer),e}const PP=Yg("string"),mi=Yg("function"),XA=Yg("number"),Up=s=>s!==null&&typeof s=="object",LP=s=>s===!0||s===!1,Hf=s=>{if(Hg(s)!=="object")return!1;const e=Mb(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(KA in s)&&!(qg in s)},zP=s=>{if(!Up(s)||Gp(s))return!1;try{return Object.keys(s).length===0&&Object.getPrototypeOf(s)===Object.prototype}catch{return!1}},MP=To("Date"),BP=To("File"),FP=To("Blob"),$P=To("FileList"),GP=s=>Up(s)&&mi(s.pipe),UP=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||mi(s.append)&&((e=Hg(s))==="formdata"||e==="object"&&mi(s.toString)&&s.toString()==="[object FormData]"))},WP=To("URLSearchParams"),[qP,HP,YP,KP]=["ReadableStream","Request","Response","Headers"].map(To),VP=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wp(s,e,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let n,i;if(typeof s!="object"&&(s=[s]),$d(s))for(n=0,i=s.length;n<i;n++)e.call(null,s[n],n,s);else{if(Gp(s))return;const o=r?Object.getOwnPropertyNames(s):Object.keys(s),a=o.length;let l;for(n=0;n<a;n++)l=o[n],e.call(null,s[l],l,s)}}function JA(s,e){if(Gp(s))return null;e=e.toLowerCase();const r=Object.keys(s);let n=r.length,i;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const ic=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:globalThis,QA=s=>!kd(s)&&s!==ic;function B0(){const{caseless:s,skipUndefined:e}=QA(this)&&this||{},r={},n=(i,o)=>{const a=s&&JA(r,o)||o;Hf(r[a])&&Hf(i)?r[a]=B0(r[a],i):Hf(i)?r[a]=B0({},i):$d(i)?r[a]=i.slice():(!e||!kd(i))&&(r[a]=i)};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&Wp(arguments[i],n);return r}const XP=(s,e,r,{allOwnKeys:n}={})=>(Wp(e,(i,o)=>{r&&mi(i)?s[o]=YA(i,r):s[o]=i},{allOwnKeys:n}),s),JP=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),QP=(s,e,r,n)=>{s.prototype=Object.create(e.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),r&&Object.assign(s.prototype,r)},ZP=(s,e,r,n)=>{let i,o,a;const l={};if(e=e||{},s==null)return e;do{for(i=Object.getOwnPropertyNames(s),o=i.length;o-- >0;)a=i[o],(!n||n(a,s,e))&&!l[a]&&(e[a]=s[a],l[a]=!0);s=r!==!1&&Mb(s)}while(s&&(!r||r(s,e))&&s!==Object.prototype);return e},eL=(s,e,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=e.length;const n=s.indexOf(e,r);return n!==-1&&n===r},tL=s=>{if(!s)return null;if($d(s))return s;let e=s.length;if(!XA(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=s[e];return r},rL=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&Mb(Uint8Array)),nL=(s,e)=>{const n=(s&&s[qg]).call(s);let i;for(;(i=n.next())&&!i.done;){const o=i.value;e.call(s,o[0],o[1])}},sL=(s,e)=>{let r;const n=[];for(;(r=s.exec(e))!==null;)n.push(r);return n},iL=To("HTMLFormElement"),oL=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),wE=(({hasOwnProperty:s})=>(e,r)=>s.call(e,r))(Object.prototype),aL=To("RegExp"),ZA=(s,e)=>{const r=Object.getOwnPropertyDescriptors(s),n={};Wp(r,(i,o)=>{let a;(a=e(i,o,s))!==!1&&(n[o]=a||i)}),Object.defineProperties(s,n)},lL=s=>{ZA(s,(e,r)=>{if(mi(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=s[r];if(mi(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},cL=(s,e)=>{const r={},n=i=>{i.forEach(o=>{r[o]=!0})};return $d(s)?n(s):n(String(s).split(e)),r},dL=()=>{},uL=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function pL(s){return!!(s&&mi(s.append)&&s[KA]==="FormData"&&s[qg])}const hL=s=>{const e=new Array(10),r=(n,i)=>{if(Up(n)){if(e.indexOf(n)>=0)return;if(Gp(n))return n;if(!("toJSON"in n)){e[i]=n;const o=$d(n)?[]:{};return Wp(n,(a,l)=>{const d=r(a,i+1);!kd(d)&&(o[l]=d)}),e[i]=void 0,o}}return n};return r(s,0)},fL=To("AsyncFunction"),gL=s=>s&&(Up(s)||mi(s))&&mi(s.then)&&mi(s.catch),eT=((s,e)=>s?setImmediate:e?((r,n)=>(ic.addEventListener("message",({source:i,data:o})=>{i===ic&&o===r&&n.length&&n.shift()()},!1),i=>{n.push(i),ic.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",mi(ic.postMessage)),xL=typeof queueMicrotask<"u"?queueMicrotask.bind(ic):typeof bd<"u"&&bd.nextTick||eT,mL=s=>s!=null&&mi(s[qg]),ot={isArray:$d,isArrayBuffer:VA,isBuffer:Gp,isFormData:UP,isArrayBufferView:IP,isString:PP,isNumber:XA,isBoolean:LP,isObject:Up,isPlainObject:Hf,isEmptyObject:zP,isReadableStream:qP,isRequest:HP,isResponse:YP,isHeaders:KP,isUndefined:kd,isDate:MP,isFile:BP,isBlob:FP,isRegExp:aL,isFunction:mi,isStream:GP,isURLSearchParams:WP,isTypedArray:rL,isFileList:$P,forEach:Wp,merge:B0,extend:XP,trim:VP,stripBOM:JP,inherits:QP,toFlatObject:ZP,kindOf:Hg,kindOfTest:To,endsWith:eL,toArray:tL,forEachEntry:nL,matchAll:sL,isHTMLForm:iL,hasOwnProperty:wE,hasOwnProp:wE,reduceDescriptors:ZA,freezeMethods:lL,toObjectSet:cL,toCamelCase:oL,noop:dL,toFiniteNumber:uL,findKey:JA,global:ic,isContextDefined:QA,isSpecCompliantForm:pL,toJSONObject:hL,isAsyncFn:fL,isThenable:gL,setImmediate:eT,asap:xL,isIterable:mL};function cr(s,e,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}ot.inherits(cr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ot.toJSONObject(this.config),code:this.code,status:this.status}}});const tT=cr.prototype,rT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{rT[s]={value:s}});Object.defineProperties(cr,rT);Object.defineProperty(tT,"isAxiosError",{value:!0});cr.from=(s,e,r,n,i,o)=>{const a=Object.create(tT);ot.toFlatObject(s,a,function(f){return f!==Error.prototype},p=>p!=="isAxiosError");const l=s&&s.message?s.message:"Error",d=e==null&&s?s.code:e;return cr.call(a,l,d,r,n,i),s&&a.cause==null&&Object.defineProperty(a,"cause",{value:s,configurable:!0}),a.name=s&&s.name||"Error",o&&Object.assign(a,o),a};const yL=null;function F0(s){return ot.isPlainObject(s)||ot.isArray(s)}function nT(s){return ot.endsWith(s,"[]")?s.slice(0,-2):s}function EE(s,e,r){return s?s.concat(e).map(function(i,o){return i=nT(i),!r&&o?"["+i+"]":i}).join(r?".":""):e}function bL(s){return ot.isArray(s)&&!s.some(F0)}const vL=ot.toFlatObject(ot,{},null,function(e){return/^is[A-Z]/.test(e)});function Kg(s,e,r){if(!ot.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,r=ot.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,y){return!ot.isUndefined(y[w])});const n=r.metaTokens,i=r.visitor||f,o=r.dots,a=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&ot.isSpecCompliantForm(e);if(!ot.isFunction(i))throw new TypeError("visitor must be a function");function p(b){if(b===null)return"";if(ot.isDate(b))return b.toISOString();if(ot.isBoolean(b))return b.toString();if(!d&&ot.isBlob(b))throw new cr("Blob is not supported. Use a Buffer instead.");return ot.isArrayBuffer(b)||ot.isTypedArray(b)?d&&typeof Blob=="function"?new Blob([b]):BI.from(b):b}function f(b,w,y){let C=b;if(b&&!y&&typeof b=="object"){if(ot.endsWith(w,"{}"))w=n?w:w.slice(0,-2),b=JSON.stringify(b);else if(ot.isArray(b)&&bL(b)||(ot.isFileList(b)||ot.endsWith(w,"[]"))&&(C=ot.toArray(b)))return w=nT(w),C.forEach(function(E,j){!(ot.isUndefined(E)||E===null)&&e.append(a===!0?EE([w],j,o):a===null?w:w+"[]",p(E))}),!1}return F0(b)?!0:(e.append(EE(y,w,o),p(b)),!1)}const h=[],x=Object.assign(vL,{defaultVisitor:f,convertValue:p,isVisitable:F0});function m(b,w){if(!ot.isUndefined(b)){if(h.indexOf(b)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(b),ot.forEach(b,function(C,T){(!(ot.isUndefined(C)||C===null)&&i.call(e,C,ot.isString(T)?T.trim():T,w,x))===!0&&m(C,w?w.concat(T):[T])}),h.pop()}}if(!ot.isObject(s))throw new TypeError("data must be an object");return m(s),e}function CE(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Bb(s,e){this._pairs=[],s&&Kg(s,this,e)}const sT=Bb.prototype;sT.append=function(e,r){this._pairs.push([e,r])};sT.toString=function(e){const r=e?function(n){return e.call(this,n,CE)}:CE;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function SL(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function iT(s,e,r){if(!e)return s;const n=r&&r.encode||SL;ot.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let o;if(i?o=i(e,r):o=ot.isURLSearchParams(e)?e.toString():new Bb(e,r).toString(n),o){const a=s.indexOf("#");a!==-1&&(s=s.slice(0,a)),s+=(s.indexOf("?")===-1?"?":"&")+o}return s}class jE{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ot.forEach(this.handlers,function(n){n!==null&&e(n)})}}const oT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wL=typeof URLSearchParams<"u"?URLSearchParams:Bb,EL=typeof FormData<"u"?FormData:null,CL=typeof Blob<"u"?Blob:null,jL={isBrowser:!0,classes:{URLSearchParams:wL,FormData:EL,Blob:CL},protocols:["http","https","file","blob","url","data"]},Fb=typeof window<"u"&&typeof document<"u",$0=typeof navigator=="object"&&navigator||void 0,kL=Fb&&(!$0||["ReactNative","NativeScript","NS"].indexOf($0.product)<0),AL=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",TL=Fb&&window.location.href||"http://localhost",RL=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Fb,hasStandardBrowserEnv:kL,hasStandardBrowserWebWorkerEnv:AL,navigator:$0,origin:TL},Symbol.toStringTag,{value:"Module"})),qs={...RL,...jL};function NL(s,e){return Kg(s,new qs.classes.URLSearchParams,{visitor:function(r,n,i,o){return qs.isNode&&ot.isBuffer(r)?(this.append(n,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...e})}function OL(s){return ot.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function _L(s){const e={},r=Object.keys(s);let n;const i=r.length;let o;for(n=0;n<i;n++)o=r[n],e[o]=s[o];return e}function aT(s){function e(r,n,i,o){let a=r[o++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),d=o>=r.length;return a=!a&&ot.isArray(i)?i.length:a,d?(ot.hasOwnProp(i,a)?i[a]=[i[a],n]:i[a]=n,!l):((!i[a]||!ot.isObject(i[a]))&&(i[a]=[]),e(r,n,i[a],o)&&ot.isArray(i[a])&&(i[a]=_L(i[a])),!l)}if(ot.isFormData(s)&&ot.isFunction(s.entries)){const r={};return ot.forEachEntry(s,(n,i)=>{e(OL(n),i,r,0)}),r}return null}function DL(s,e,r){if(ot.isString(s))try{return(e||JSON.parse)(s),ot.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(s)}const qp={transitional:oT,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,o=ot.isObject(e);if(o&&ot.isHTMLForm(e)&&(e=new FormData(e)),ot.isFormData(e))return i?JSON.stringify(aT(e)):e;if(ot.isArrayBuffer(e)||ot.isBuffer(e)||ot.isStream(e)||ot.isFile(e)||ot.isBlob(e)||ot.isReadableStream(e))return e;if(ot.isArrayBufferView(e))return e.buffer;if(ot.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return NL(e,this.formSerializer).toString();if((l=ot.isFileList(e))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Kg(l?{"files[]":e}:e,d&&new d,this.formSerializer)}}return o||i?(r.setContentType("application/json",!1),DL(e)):e}],transformResponse:[function(e){const r=this.transitional||qp.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(ot.isResponse(e)||ot.isReadableStream(e))return e;if(e&&ot.isString(e)&&(n&&!this.responseType||i)){const a=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(l){if(a)throw l.name==="SyntaxError"?cr.from(l,cr.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:qs.classes.FormData,Blob:qs.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ot.forEach(["delete","get","head","post","put","patch"],s=>{qp.headers[s]={}});const IL=ot.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),PL=s=>{const e={};let r,n,i;return s&&s.split(`
`).forEach(function(a){i=a.indexOf(":"),r=a.substring(0,i).trim().toLowerCase(),n=a.substring(i+1).trim(),!(!r||e[r]&&IL[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},kE=Symbol("internals");function qu(s){return s&&String(s).trim().toLowerCase()}function Yf(s){return s===!1||s==null?s:ot.isArray(s)?s.map(Yf):String(s)}function LL(s){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(s);)e[n[1]]=n[2];return e}const zL=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function Ry(s,e,r,n,i){if(ot.isFunction(n))return n.call(this,e,r);if(i&&(e=r),!!ot.isString(e)){if(ot.isString(n))return e.indexOf(n)!==-1;if(ot.isRegExp(n))return n.test(e)}}function ML(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function BL(s,e){const r=ot.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+r,{value:function(i,o,a){return this[n].call(this,e,i,o,a)},configurable:!0})})}let yi=class{constructor(e){e&&this.set(e)}set(e,r,n){const i=this;function o(l,d,p){const f=qu(d);if(!f)throw new Error("header name must be a non-empty string");const h=ot.findKey(i,f);(!h||i[h]===void 0||p===!0||p===void 0&&i[h]!==!1)&&(i[h||d]=Yf(l))}const a=(l,d)=>ot.forEach(l,(p,f)=>o(p,f,d));if(ot.isPlainObject(e)||e instanceof this.constructor)a(e,r);else if(ot.isString(e)&&(e=e.trim())&&!zL(e))a(PL(e),r);else if(ot.isObject(e)&&ot.isIterable(e)){let l={},d,p;for(const f of e){if(!ot.isArray(f))throw TypeError("Object iterator must return a key-value pair");l[p=f[0]]=(d=l[p])?ot.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}a(l,r)}else e!=null&&o(r,e,n);return this}get(e,r){if(e=qu(e),e){const n=ot.findKey(this,e);if(n){const i=this[n];if(!r)return i;if(r===!0)return LL(i);if(ot.isFunction(r))return r.call(this,i,n);if(ot.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=qu(e),e){const n=ot.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||Ry(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let i=!1;function o(a){if(a=qu(a),a){const l=ot.findKey(n,a);l&&(!r||Ry(n,n[l],l,r))&&(delete n[l],i=!0)}}return ot.isArray(e)?e.forEach(o):o(e),i}clear(e){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const o=r[n];(!e||Ry(this,this[o],o,e,!0))&&(delete this[o],i=!0)}return i}normalize(e){const r=this,n={};return ot.forEach(this,(i,o)=>{const a=ot.findKey(n,o);if(a){r[a]=Yf(i),delete r[o];return}const l=e?ML(o):String(o).trim();l!==o&&delete r[o],r[l]=Yf(i),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return ot.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=e&&ot.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[kE]=this[kE]={accessors:{}}).accessors,i=this.prototype;function o(a){const l=qu(a);n[l]||(BL(i,a),n[l]=!0)}return ot.isArray(e)?e.forEach(o):o(e),this}};yi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ot.reduceDescriptors(yi.prototype,({value:s},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(n){this[r]=n}}});ot.freezeMethods(yi);function Ny(s,e){const r=this||qp,n=e||r,i=yi.from(n.headers);let o=n.data;return ot.forEach(s,function(l){o=l.call(r,o,i.normalize(),e?e.status:void 0)}),i.normalize(),o}function lT(s){return!!(s&&s.__CANCEL__)}function Gd(s,e,r){cr.call(this,s??"canceled",cr.ERR_CANCELED,e,r),this.name="CanceledError"}ot.inherits(Gd,cr,{__CANCEL__:!0});function cT(s,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?s(r):e(new cr("Request failed with status code "+r.status,[cr.ERR_BAD_REQUEST,cr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function FL(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function $L(s,e){s=s||10;const r=new Array(s),n=new Array(s);let i=0,o=0,a;return e=e!==void 0?e:1e3,function(d){const p=Date.now(),f=n[o];a||(a=p),r[i]=d,n[i]=p;let h=o,x=0;for(;h!==i;)x+=r[h++],h=h%s;if(i=(i+1)%s,i===o&&(o=(o+1)%s),p-a<e)return;const m=f&&p-f;return m?Math.round(x*1e3/m):void 0}}function GL(s,e){let r=0,n=1e3/e,i,o;const a=(p,f=Date.now())=>{r=f,i=null,o&&(clearTimeout(o),o=null),s(...p)};return[(...p)=>{const f=Date.now(),h=f-r;h>=n?a(p,f):(i=p,o||(o=setTimeout(()=>{o=null,a(i)},n-h)))},()=>i&&a(i)]}const ig=(s,e,r=3)=>{let n=0;const i=$L(50,250);return GL(o=>{const a=o.loaded,l=o.lengthComputable?o.total:void 0,d=a-n,p=i(d),f=a<=l;n=a;const h={loaded:a,total:l,progress:l?a/l:void 0,bytes:d,rate:p||void 0,estimated:p&&l&&f?(l-a)/p:void 0,event:o,lengthComputable:l!=null,[e?"download":"upload"]:!0};s(h)},r)},AE=(s,e)=>{const r=s!=null;return[n=>e[0]({lengthComputable:r,total:s,loaded:n}),e[1]]},TE=s=>(...e)=>ot.asap(()=>s(...e)),UL=qs.hasStandardBrowserEnv?((s,e)=>r=>(r=new URL(r,qs.origin),s.protocol===r.protocol&&s.host===r.host&&(e||s.port===r.port)))(new URL(qs.origin),qs.navigator&&/(msie|trident)/i.test(qs.navigator.userAgent)):()=>!0,WL=qs.hasStandardBrowserEnv?{write(s,e,r,n,i,o,a){if(typeof document>"u")return;const l=[`${s}=${encodeURIComponent(e)}`];ot.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),ot.isString(n)&&l.push(`path=${n}`),ot.isString(i)&&l.push(`domain=${i}`),o===!0&&l.push("secure"),ot.isString(a)&&l.push(`SameSite=${a}`),document.cookie=l.join("; ")},read(s){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+s+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(s){this.write(s,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function qL(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function HL(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function dT(s,e,r){let n=!qL(e);return s&&(n||r==!1)?HL(s,e):e}const RE=s=>s instanceof yi?{...s}:s;function pc(s,e){e=e||{};const r={};function n(p,f,h,x){return ot.isPlainObject(p)&&ot.isPlainObject(f)?ot.merge.call({caseless:x},p,f):ot.isPlainObject(f)?ot.merge({},f):ot.isArray(f)?f.slice():f}function i(p,f,h,x){if(ot.isUndefined(f)){if(!ot.isUndefined(p))return n(void 0,p,h,x)}else return n(p,f,h,x)}function o(p,f){if(!ot.isUndefined(f))return n(void 0,f)}function a(p,f){if(ot.isUndefined(f)){if(!ot.isUndefined(p))return n(void 0,p)}else return n(void 0,f)}function l(p,f,h){if(h in e)return n(p,f);if(h in s)return n(void 0,p)}const d={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(p,f,h)=>i(RE(p),RE(f),h,!0)};return ot.forEach(Object.keys({...s,...e}),function(f){const h=d[f]||i,x=h(s[f],e[f],f);ot.isUndefined(x)&&h!==l||(r[f]=x)}),r}const uT=s=>{const e=pc({},s);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:o,headers:a,auth:l}=e;if(e.headers=a=yi.from(a),e.url=iT(dT(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ot.isFormData(r)){if(qs.hasStandardBrowserEnv||qs.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(ot.isFunction(r.getHeaders)){const d=r.getHeaders(),p=["content-type","content-length"];Object.entries(d).forEach(([f,h])=>{p.includes(f.toLowerCase())&&a.set(f,h)})}}if(qs.hasStandardBrowserEnv&&(n&&ot.isFunction(n)&&(n=n(e)),n||n!==!1&&UL(e.url))){const d=i&&o&&WL.read(o);d&&a.set(i,d)}return e},YL=typeof XMLHttpRequest<"u",KL=YL&&function(s){return new Promise(function(r,n){const i=uT(s);let o=i.data;const a=yi.from(i.headers).normalize();let{responseType:l,onUploadProgress:d,onDownloadProgress:p}=i,f,h,x,m,b;function w(){m&&m(),b&&b(),i.cancelToken&&i.cancelToken.unsubscribe(f),i.signal&&i.signal.removeEventListener("abort",f)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function C(){if(!y)return;const E=yi.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:E,config:s,request:y};cT(function(R){r(R),w()},function(R){n(R),w()},k),y=null}"onloadend"in y?y.onloadend=C:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(C)},y.onabort=function(){y&&(n(new cr("Request aborted",cr.ECONNABORTED,s,y)),y=null)},y.onerror=function(j){const k=j&&j.message?j.message:"Network Error",A=new cr(k,cr.ERR_NETWORK,s,y);A.event=j||null,n(A),y=null},y.ontimeout=function(){let j=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const k=i.transitional||oT;i.timeoutErrorMessage&&(j=i.timeoutErrorMessage),n(new cr(j,k.clarifyTimeoutError?cr.ETIMEDOUT:cr.ECONNABORTED,s,y)),y=null},o===void 0&&a.setContentType(null),"setRequestHeader"in y&&ot.forEach(a.toJSON(),function(j,k){y.setRequestHeader(k,j)}),ot.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),l&&l!=="json"&&(y.responseType=i.responseType),p&&([x,b]=ig(p,!0),y.addEventListener("progress",x)),d&&y.upload&&([h,m]=ig(d),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",m)),(i.cancelToken||i.signal)&&(f=E=>{y&&(n(!E||E.type?new Gd(null,s,y):E),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(f),i.signal&&(i.signal.aborted?f():i.signal.addEventListener("abort",f)));const T=FL(i.url);if(T&&qs.protocols.indexOf(T)===-1){n(new cr("Unsupported protocol "+T+":",cr.ERR_BAD_REQUEST,s));return}y.send(o||null)})},VL=(s,e)=>{const{length:r}=s=s?s.filter(Boolean):[];if(e||r){let n=new AbortController,i;const o=function(p){if(!i){i=!0,l();const f=p instanceof Error?p:this.reason;n.abort(f instanceof cr?f:new Gd(f instanceof Error?f.message:f))}};let a=e&&setTimeout(()=>{a=null,o(new cr(`timeout ${e} of ms exceeded`,cr.ETIMEDOUT))},e);const l=()=>{s&&(a&&clearTimeout(a),a=null,s.forEach(p=>{p.unsubscribe?p.unsubscribe(o):p.removeEventListener("abort",o)}),s=null)};s.forEach(p=>p.addEventListener("abort",o));const{signal:d}=n;return d.unsubscribe=()=>ot.asap(l),d}},XL=function*(s,e){let r=s.byteLength;if(r<e){yield s;return}let n=0,i;for(;n<r;)i=n+e,yield s.slice(n,i),n=i},JL=async function*(s,e){for await(const r of QL(s))yield*XL(r,e)},QL=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},NE=(s,e,r,n)=>{const i=JL(s,e);let o=0,a,l=d=>{a||(a=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:p,value:f}=await i.next();if(p){l(),d.close();return}let h=f.byteLength;if(r){let x=o+=h;r(x)}d.enqueue(new Uint8Array(f))}catch(p){throw l(p),p}},cancel(d){return l(d),i.return()}},{highWaterMark:2})},OE=64*1024,{isFunction:hf}=ot,ZL=(({Request:s,Response:e})=>({Request:s,Response:e}))(ot.global),{ReadableStream:_E,TextEncoder:DE}=ot.global,IE=(s,...e)=>{try{return!!s(...e)}catch{return!1}},ez=s=>{s=ot.merge.call({skipUndefined:!0},ZL,s);const{fetch:e,Request:r,Response:n}=s,i=e?hf(e):typeof fetch=="function",o=hf(r),a=hf(n);if(!i)return!1;const l=i&&hf(_E),d=i&&(typeof DE=="function"?(b=>w=>b.encode(w))(new DE):async b=>new Uint8Array(await new r(b).arrayBuffer())),p=o&&l&&IE(()=>{let b=!1;const w=new r(qs.origin,{body:new _E,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!w}),f=a&&l&&IE(()=>ot.isReadableStream(new n("").body)),h={stream:f&&(b=>b.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!h[b]&&(h[b]=(w,y)=>{let C=w&&w[b];if(C)return C.call(w);throw new cr(`Response type '${b}' is not supported`,cr.ERR_NOT_SUPPORT,y)})});const x=async b=>{if(b==null)return 0;if(ot.isBlob(b))return b.size;if(ot.isSpecCompliantForm(b))return(await new r(qs.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(ot.isArrayBufferView(b)||ot.isArrayBuffer(b))return b.byteLength;if(ot.isURLSearchParams(b)&&(b=b+""),ot.isString(b))return(await d(b)).byteLength},m=async(b,w)=>{const y=ot.toFiniteNumber(b.getContentLength());return y??x(w)};return async b=>{let{url:w,method:y,data:C,signal:T,cancelToken:E,timeout:j,onDownloadProgress:k,onUploadProgress:A,responseType:R,headers:M,withCredentials:P="same-origin",fetchOptions:I}=uT(b),O=e||fetch;R=R?(R+"").toLowerCase():"text";let G=VL([T,E&&E.toAbortSignal()],j),B=null;const F=G&&G.unsubscribe&&(()=>{G.unsubscribe()});let z;try{if(A&&p&&y!=="get"&&y!=="head"&&(z=await m(M,C))!==0){let fe=new r(w,{method:"POST",body:C,duplex:"half"}),Q;if(ot.isFormData(C)&&(Q=fe.headers.get("content-type"))&&M.setContentType(Q),fe.body){const[_,Y]=AE(z,ig(TE(A)));C=NE(fe.body,OE,_,Y)}}ot.isString(P)||(P=P?"include":"omit");const $=o&&"credentials"in r.prototype,W={...I,signal:G,method:y.toUpperCase(),headers:M.normalize().toJSON(),body:C,duplex:"half",credentials:$?P:void 0};B=o&&new r(w,W);let D=await(o?O(B,I):O(w,W));const oe=f&&(R==="stream"||R==="response");if(f&&(k||oe&&F)){const fe={};["status","statusText","headers"].forEach(he=>{fe[he]=D[he]});const Q=ot.toFiniteNumber(D.headers.get("content-length")),[_,Y]=k&&AE(Q,ig(TE(k),!0))||[];D=new n(NE(D.body,OE,_,()=>{Y&&Y(),F&&F()}),fe)}R=R||"text";let Z=await h[ot.findKey(h,R)||"text"](D,b);return!oe&&F&&F(),await new Promise((fe,Q)=>{cT(fe,Q,{data:Z,headers:yi.from(D.headers),status:D.status,statusText:D.statusText,config:b,request:B})})}catch($){throw F&&F(),$&&$.name==="TypeError"&&/Load failed|fetch/i.test($.message)?Object.assign(new cr("Network Error",cr.ERR_NETWORK,b,B),{cause:$.cause||$}):cr.from($,$&&$.code,b,B)}}},tz=new Map,pT=s=>{let e=s&&s.env||{};const{fetch:r,Request:n,Response:i}=e,o=[n,i,r];let a=o.length,l=a,d,p,f=tz;for(;l--;)d=o[l],p=f.get(d),p===void 0&&f.set(d,p=l?new Map:ez(e)),f=p;return p};pT();const $b={http:yL,xhr:KL,fetch:{get:pT}};ot.forEach($b,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const PE=s=>`- ${s}`,rz=s=>ot.isFunction(s)||s===null||s===!1;function nz(s,e){s=ot.isArray(s)?s:[s];const{length:r}=s;let n,i;const o={};for(let a=0;a<r;a++){n=s[a];let l;if(i=n,!rz(n)&&(i=$b[(l=String(n)).toLowerCase()],i===void 0))throw new cr(`Unknown adapter '${l}'`);if(i&&(ot.isFunction(i)||(i=i.get(e))))break;o[l||"#"+a]=i}if(!i){const a=Object.entries(o).map(([d,p])=>`adapter ${d} `+(p===!1?"is not supported by the environment":"is not available in the build"));let l=r?a.length>1?`since :
`+a.map(PE).join(`
`):" "+PE(a[0]):"as no adapter specified";throw new cr("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const hT={getAdapter:nz,adapters:$b};function Oy(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Gd(null,s)}function LE(s){return Oy(s),s.headers=yi.from(s.headers),s.data=Ny.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),hT.getAdapter(s.adapter||qp.adapter,s)(s).then(function(n){return Oy(s),n.data=Ny.call(s,s.transformResponse,n),n.headers=yi.from(n.headers),n},function(n){return lT(n)||(Oy(s),n&&n.response&&(n.response.data=Ny.call(s,s.transformResponse,n.response),n.response.headers=yi.from(n.response.headers))),Promise.reject(n)})}const fT="1.13.2",Vg={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{Vg[s]=function(n){return typeof n===s||"a"+(e<1?"n ":" ")+s}});const zE={};Vg.transitional=function(e,r,n){function i(o,a){return"[Axios v"+fT+"] Transitional option '"+o+"'"+a+(n?". "+n:"")}return(o,a,l)=>{if(e===!1)throw new cr(i(a," has been removed"+(r?" in "+r:"")),cr.ERR_DEPRECATED);return r&&!zE[a]&&(zE[a]=!0,console.warn(i(a," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(o,a,l):!0}};Vg.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function sz(s,e,r){if(typeof s!="object")throw new cr("options must be an object",cr.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let i=n.length;for(;i-- >0;){const o=n[i],a=e[o];if(a){const l=s[o],d=l===void 0||a(l,o,s);if(d!==!0)throw new cr("option "+o+" must be "+d,cr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new cr("Unknown option "+o,cr.ERR_BAD_OPTION)}}const Kf={assertOptions:sz,validators:Vg},Io=Kf.validators;let lc=class{constructor(e){this.defaults=e||{},this.interceptors={request:new jE,response:new jE}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=pc(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:o}=r;n!==void 0&&Kf.assertOptions(n,{silentJSONParsing:Io.transitional(Io.boolean),forcedJSONParsing:Io.transitional(Io.boolean),clarifyTimeoutError:Io.transitional(Io.boolean)},!1),i!=null&&(ot.isFunction(i)?r.paramsSerializer={serialize:i}:Kf.assertOptions(i,{encode:Io.function,serialize:Io.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Kf.assertOptions(r,{baseUrl:Io.spelling("baseURL"),withXsrfToken:Io.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let a=o&&ot.merge(o.common,o[r.method]);o&&ot.forEach(["delete","get","head","post","put","patch","common"],b=>{delete o[b]}),r.headers=yi.concat(a,o);const l=[];let d=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(r)===!1||(d=d&&w.synchronous,l.unshift(w.fulfilled,w.rejected))});const p=[];this.interceptors.response.forEach(function(w){p.push(w.fulfilled,w.rejected)});let f,h=0,x;if(!d){const b=[LE.bind(this),void 0];for(b.unshift(...l),b.push(...p),x=b.length,f=Promise.resolve(r);h<x;)f=f.then(b[h++],b[h++]);return f}x=l.length;let m=r;for(;h<x;){const b=l[h++],w=l[h++];try{m=b(m)}catch(y){w.call(this,y);break}}try{f=LE.call(this,m)}catch(b){return Promise.reject(b)}for(h=0,x=p.length;h<x;)f=f.then(p[h++],p[h++]);return f}getUri(e){e=pc(this.defaults,e);const r=dT(e.baseURL,e.url,e.allowAbsoluteUrls);return iT(r,e.params,e.paramsSerializer)}};ot.forEach(["delete","get","head","options"],function(e){lc.prototype[e]=function(r,n){return this.request(pc(n||{},{method:e,url:r,data:(n||{}).data}))}});ot.forEach(["post","put","patch"],function(e){function r(n){return function(o,a,l){return this.request(pc(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}lc.prototype[e]=r(),lc.prototype[e+"Form"]=r(!0)});let iz=class gT{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const n=this;this.promise.then(i=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](i);n._listeners=null}),this.promise.then=i=>{let o;const a=new Promise(l=>{n.subscribe(l),o=l}).then(i);return a.cancel=function(){n.unsubscribe(o)},a},e(function(o,a,l){n.reason||(n.reason=new Gd(o,a,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new gT(function(i){e=i}),cancel:e}}};function oz(s){return function(r){return s.apply(null,r)}}function az(s){return ot.isObject(s)&&s.isAxiosError===!0}const G0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(G0).forEach(([s,e])=>{G0[e]=s});function xT(s){const e=new lc(s),r=YA(lc.prototype.request,e);return ot.extend(r,lc.prototype,e,{allOwnKeys:!0}),ot.extend(r,e,null,{allOwnKeys:!0}),r.create=function(i){return xT(pc(s,i))},r}const er=xT(qp);er.Axios=lc;er.CanceledError=Gd;er.CancelToken=iz;er.isCancel=lT;er.VERSION=fT;er.toFormData=Kg;er.AxiosError=cr;er.Cancel=er.CanceledError;er.all=function(e){return Promise.all(e)};er.spread=oz;er.isAxiosError=az;er.mergeConfig=pc;er.AxiosHeaders=yi;er.formToJSON=s=>aT(ot.isHTMLForm(s)?new FormData(s):s);er.getAdapter=hT.getAdapter;er.HttpStatusCode=G0;er.default=er;const{Axios:QQ,AxiosError:ZQ,CanceledError:eZ,isCancel:tZ,CancelToken:rZ,VERSION:nZ,all:sZ,Cancel:iZ,isAxiosError:oZ,spread:aZ,toFormData:lZ,AxiosHeaders:cZ,HttpStatusCode:dZ,formToJSON:uZ,getAdapter:pZ,mergeConfig:hZ}=er,Ad={kraken:{id:"kraken",name:"kraken",displayName:"Kraken",type:"crypto",category:"centralized",region:"global",adapterClass:qA,features:{spot:!0,margin:!0,futures:!0,perpetuals:!1,options:!1,staking:!0,vaults:!1,subaccounts:!1},tradingFeatures:{marketOrders:!0,limitOrders:!0,stopOrders:!0,stopLimitOrders:!0,trailingStopOrders:!0,icebergOrders:!0,batchOrders:!0,editOrders:!0},advancedFeatures:{leverage:!0,maxLeverage:5,marginMode:!0,transfers:!0,withdrawals:!0,deposits:!0},defaultSymbols:["BTC/USD","ETH/USD","SOL/USD","XRP/USD","ADA/USD","DOGE/USD","MATIC/USD","DOT/USD","AVAX/USD","LINK/USD","UNI/USD","ATOM/USD","LTC/USD","BCH/USD","ALGO/USD"],websocket:{enabled:!0,endpoint:"wss://ws.kraken.com/v2"}},hyperliquid:{id:"hyperliquid",name:"hyperliquid",displayName:"HyperLiquid",type:"crypto",category:"decentralized",region:"global",adapterClass:HA,features:{spot:!0,margin:!1,futures:!0,perpetuals:!0,options:!1,staking:!1,vaults:!0,subaccounts:!0},tradingFeatures:{marketOrders:!0,limitOrders:!0,stopOrders:!0,stopLimitOrders:!0,trailingStopOrders:!1,icebergOrders:!1,batchOrders:!0,editOrders:!0},advancedFeatures:{leverage:!0,maxLeverage:50,marginMode:!0,transfers:!0,withdrawals:!0,deposits:!1},defaultSymbols:["BTC/USDC:USDC","ETH/USDC:USDC","SOL/USDC:USDC","AVAX/USDC:USDC","MATIC/USDC:USDC"],websocket:{enabled:!0,endpoint:"wss://api.hyperliquid.xyz/ws"}}};function lz(){return Object.values(Ad)}function cz(s){return Ad[s]}function dz(s){return Ad[s]?.defaultSymbols||[]}function uz(s,e){const r=Ad[s];if(!r)throw new Error(`Broker "${s}" is not registered`);return new r.adapterClass(e)}function pz(s){return{marketData:{fetchMarkets:Ut(s,"fetchMarkets"),fetchTicker:Ut(s,"fetchTicker"),fetchTickers:Ut(s,"fetchTickers"),fetchOrderBook:Ut(s,"fetchOrderBook"),fetchTrades:Ut(s,"fetchTrades"),fetchOHLCV:Ut(s,"fetchOHLCV"),fetchStatus:Ut(s,"fetchStatus"),fetchTime:Ut(s,"fetchTime"),fetchCurrencies:Ut(s,"fetchCurrencies")},account:{fetchBalance:Ut(s,"fetchBalance"),fetchPositions:Ut(s,"fetchPositions"),fetchLedger:Ut(s,"fetchLedger"),fetchTradingFee:Ut(s,"fetchTradingFee"),fetchDeposits:Ut(s,"fetchDeposits"),fetchWithdrawals:Ut(s,"fetchWithdrawals")},trading:{createOrder:Ut(s,"createOrder"),createOrders:Ut(s,"createOrders"),editOrder:Ut(s,"editOrder"),editOrders:Ut(s,"editOrders"),cancelOrder:Ut(s,"cancelOrder"),cancelOrders:Ut(s,"cancelOrders"),cancelAllOrders:Ut(s,"cancelAllOrders"),cancelAllOrdersAfter:Ut(s,"cancelAllOrdersAfter")},tradingAdvanced:{fetchOrder:Ut(s,"fetchOrder"),fetchOrders:Ut(s,"fetchOrders"),fetchOpenOrders:Ut(s,"fetchOpenOrders"),fetchClosedOrders:Ut(s,"fetchClosedOrders"),fetchCanceledOrders:Ut(s,"fetchCanceledOrders"),fetchMyTrades:Ut(s,"fetchMyTrades"),fetchOrderTrades:Ut(s,"fetchOrderTrades")},margin:{setLeverage:Ut(s,"setLeverage"),setMarginMode:Ut(s,"setMarginMode"),addMargin:Ut(s,"addMargin"),reduceMargin:Ut(s,"reduceMargin")},transfers:{transfer:Ut(s,"transfer"),transferOut:Ut(s,"transferOut"),withdraw:Ut(s,"withdraw"),createDepositAddress:Ut(s,"createDepositAddress"),fetchDepositAddress:Ut(s,"fetchDepositAddress"),fetchDepositMethods:Ut(s,"fetchDepositMethods")},futures:{fetchFundingRate:Ut(s,"fetchFundingRate"),fetchFundingRates:Ut(s,"fetchFundingRates"),fetchFundingRateHistory:Ut(s,"fetchFundingRateHistory"),fetchFundingHistory:Ut(s,"fetchFundingHistory"),fetchOpenInterest:Ut(s,"fetchOpenInterest"),fetchOpenInterests:Ut(s,"fetchOpenInterests")},hyperliquid:{createVault:Ut(s,"createVault"),setVaultAddress:Ut(s,"setVaultAddress"),setSubAccountAddress:Ut(s,"setSubAccountAddress"),fetchVaultBalance:Ut(s,"fetchVaultBalance")},websocket:{watchTicker:Ut(s,"watchTicker"),watchTickers:Ut(s,"watchTickers"),watchOrderBook:Ut(s,"watchOrderBook"),watchTrades:Ut(s,"watchTrades"),watchOHLCV:Ut(s,"watchOHLCV"),watchOrders:Ut(s,"watchOrders"),watchMyTrades:Ut(s,"watchMyTrades"),watchBalance:Ut(s,"watchBalance"),watchPositions:Ut(s,"watchPositions")}}}function Ut(s,e){return typeof s?.[e]=="function"}function hz(s){return{canFetchTicker:()=>s.marketData.fetchTicker,canFetchOrderBook:()=>s.marketData.fetchOrderBook,canFetchOHLCV:()=>s.marketData.fetchOHLCV,canCreateOrder:()=>s.trading.createOrder,canEditOrder:()=>s.trading.editOrder,canBatchOrder:()=>s.trading.createOrders,canCancelAll:()=>s.trading.cancelAllOrders,canSetLeverage:()=>s.margin.setLeverage,canTransfer:()=>s.transfers.transfer,canWithdraw:()=>s.transfers.withdraw,hasFundingRates:()=>s.futures.fetchFundingRates,hasOpenInterest:()=>s.futures.fetchOpenInterest,hasVaults:()=>s.hyperliquid.createVault,hasSubaccounts:()=>s.hyperliquid.setSubAccountAddress,hasWebSocket:()=>s.websocket.watchTicker,canStreamOrders:()=>s.websocket.watchOrders}}({...Object.fromEntries(Object.entries(_P).map(([s,e])=>[s,{id:e.id,name:e.name,type:e.assetClass,region:e.region,supported:!0,category:"crypto"}]))});class fz{async createPortfolio(e){await Je.execute(`
      INSERT INTO paper_trading_portfolios
      (id, name, provider, initial_balance, current_balance, currency, margin_mode, leverage)
      VALUES ($1, $2, $3, $4, $5, $6, $7, $8)
    `,[e.id,e.name,e.provider,e.initialBalance,e.initialBalance,e.currency||"USD",e.marginMode||"cross",e.leverage||1])}async getPortfolio(e){const n=await Je.select(`
      SELECT id, name, provider, initial_balance, current_balance, currency,
             margin_mode, leverage, created_at, updated_at
      FROM paper_trading_portfolios
      WHERE id = $1
    `,[e]);if(!n||n.length===0)return null;const i=n[0];return this.mapDBPortfolio(i)}async updatePortfolioBalance(e,r){await Je.execute(`
      UPDATE paper_trading_portfolios
      SET current_balance = $1, updated_at = CURRENT_TIMESTAMP
      WHERE id = $2
    `,[r,e])}async deletePortfolio(e){await Je.execute("DELETE FROM paper_trading_portfolios WHERE id = $1",[e])}async listPortfolios(){return(await Je.select(`
      SELECT id, name, provider, initial_balance, current_balance, currency,
             margin_mode, leverage, created_at, updated_at
      FROM paper_trading_portfolios
      ORDER BY created_at DESC
    `,[])).map(n=>this.mapDBPortfolio(n))}async createPosition(e){const r=e.entryPrice*e.quantity;await Je.execute(`
      INSERT INTO paper_trading_positions
      (id, portfolio_id, symbol, side, entry_price, quantity, position_value, leverage, margin_mode, status)
      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, 'open')
    `,[e.id,e.portfolioId,e.symbol,e.side,e.entryPrice,e.quantity,r,e.leverage||1,e.marginMode||"cross"])}async getPosition(e){const n=await Je.select(`
      SELECT id, portfolio_id, symbol, side, entry_price, quantity, position_value,
             current_price, unrealized_pnl, realized_pnl, leverage, margin_mode,
             liquidation_price, opened_at, closed_at, status
      FROM paper_trading_positions
      WHERE id = $1
    `,[e]);return!n||n.length===0?null:this.mapDBPosition(n[0])}async getPositionBySymbol(e,r,n="open"){const o=await Je.select(`
      SELECT id, portfolio_id, symbol, side, entry_price, quantity, position_value,
             current_price, unrealized_pnl, realized_pnl, leverage, margin_mode,
             liquidation_price, opened_at, closed_at, status
      FROM paper_trading_positions
      WHERE portfolio_id = $1 AND symbol = $2 AND status = $3
      ORDER BY opened_at DESC
      LIMIT 1
    `,[e,r,n]);return!o||o.length===0?null:this.mapDBPosition(o[0])}async getPositionBySymbolAndSide(e,r,n,i="open"){const a=await Je.select(`
      SELECT id, portfolio_id, symbol, side, entry_price, quantity, position_value,
             current_price, unrealized_pnl, realized_pnl, leverage, margin_mode,
             liquidation_price, opened_at, closed_at, status
      FROM paper_trading_positions
      WHERE portfolio_id = $1 AND symbol = $2 AND side = $3 AND status = $4
      ORDER BY opened_at DESC
      LIMIT 1
    `,[e,r,n,i]);return!a||a.length===0?null:this.mapDBPosition(a[0])}async getPortfolioPositions(e,r){let n=`
      SELECT id, portfolio_id, symbol, side, entry_price, quantity, position_value,
             current_price, unrealized_pnl, realized_pnl, leverage, margin_mode,
             liquidation_price, opened_at, closed_at, status
      FROM paper_trading_positions
      WHERE portfolio_id = $1
    `;const i=[e];return r&&(n+=" AND status = $2",i.push(r)),n+=" ORDER BY opened_at DESC",(await Je.select(n,i)).map(a=>this.mapDBPosition(a))}async updatePosition(e,r){const n=[],i=[];let o=1;if(r.quantity!==void 0&&(n.push(`quantity = $${o++}`),i.push(r.quantity)),r.entryPrice!==void 0&&(n.push(`entry_price = $${o++}`),i.push(r.entryPrice)),r.currentPrice!==void 0&&(n.push(`current_price = $${o++}`),i.push(r.currentPrice)),r.unrealizedPnl!==void 0&&(n.push(`unrealized_pnl = $${o++}`),i.push(r.unrealizedPnl)),r.realizedPnl!==void 0&&(n.push(`realized_pnl = $${o++}`),i.push(r.realizedPnl)),r.liquidationPrice!==void 0&&(n.push(`liquidation_price = $${o++}`),i.push(r.liquidationPrice)),r.status!==void 0&&(n.push(`status = $${o++}`),i.push(r.status)),r.closedAt!==void 0&&(n.push(`closed_at = $${o++}`),i.push(r.closedAt)),n.length===0)return;i.push(e);const a=`UPDATE paper_trading_positions SET ${n.join(", ")} WHERE id = $${o}`;await Je.execute(a,i)}async deletePosition(e){await Je.execute("DELETE FROM paper_trading_positions WHERE id = $1",[e])}async createOrder(e){await Je.execute(`
      INSERT INTO paper_trading_orders
      (id, portfolio_id, symbol, side, type, quantity, price, stop_price, status,
       time_in_force, post_only, reduce_only, trailing_percent, trailing_amount,
       iceberg_qty, leverage, margin_mode, filled_quantity, created_at, updated_at)
      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, 'pending', $9, $10, $11, $12, $13, $14, $15, $16, 0, CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
    `,[e.id,e.portfolioId,e.symbol,e.side,e.type,e.quantity,e.price||null,e.stopPrice||null,e.timeInForce||"GTC",e.postOnly?1:0,e.reduceOnly?1:0,e.trailingPercent||null,e.trailingAmount||null,e.icebergQty||null,e.leverage||null,e.marginMode||null])}async getOrder(e){const n=await Je.select(`
      SELECT id, portfolio_id, symbol, side, type, quantity, price, stop_price,
             filled_quantity, avg_fill_price, status, time_in_force, post_only,
             reduce_only, trailing_percent, trailing_amount, iceberg_qty, leverage,
             margin_mode, created_at, filled_at, updated_at
      FROM paper_trading_orders
      WHERE id = $1
    `,[e]);return!n||n.length===0?null:this.mapDBOrder(n[0])}async getPortfolioOrders(e,r){let n=`
      SELECT id, portfolio_id, symbol, side, type, quantity, price, stop_price,
             filled_quantity, avg_fill_price, status, time_in_force, post_only,
             reduce_only, trailing_percent, trailing_amount, iceberg_qty, leverage,
             margin_mode, created_at, filled_at, updated_at
      FROM paper_trading_orders
      WHERE portfolio_id = $1
    `;const i=[e];return r&&(n+=" AND status = $2",i.push(r)),n+=" ORDER BY created_at DESC",(await Je.select(n,i)).map(a=>this.mapDBOrder(a))}async getPendingOrders(e){let r=`
      SELECT id, portfolio_id, symbol, side, type, quantity, price, stop_price,
             filled_quantity, avg_fill_price, status, time_in_force, post_only,
             reduce_only, trailing_percent, trailing_amount, iceberg_qty, leverage,
             margin_mode, created_at, filled_at, updated_at
      FROM paper_trading_orders
      WHERE status IN ('pending', 'triggered', 'partial')
    `;const n=[];return e&&(r+=" AND portfolio_id = $1",n.push(e)),r+=" ORDER BY created_at ASC",(await Je.select(r,n)).map(o=>this.mapDBOrder(o))}async updateOrder(e,r){const n=["updated_at = CURRENT_TIMESTAMP"],i=[];let o=1;r.filledQuantity!==void 0&&(n.push(`filled_quantity = $${o++}`),i.push(r.filledQuantity)),r.avgFillPrice!==void 0&&(n.push(`avg_fill_price = $${o++}`),i.push(r.avgFillPrice)),r.status!==void 0&&(n.push(`status = $${o++}`),i.push(r.status)),r.filledAt!==void 0&&(n.push(`filled_at = $${o++}`),i.push(r.filledAt)),i.push(e);const a=`UPDATE paper_trading_orders SET ${n.join(", ")} WHERE id = $${o}`;await Je.execute(a,i)}async deleteOrder(e){await Je.execute("DELETE FROM paper_trading_orders WHERE id = $1",[e])}async createTrade(e){await Je.execute(`
      INSERT INTO paper_trading_trades
      (id, portfolio_id, order_id, symbol, side, price, quantity, fee, fee_rate, is_maker, timestamp)
      VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, CURRENT_TIMESTAMP)
    `,[e.id,e.portfolioId,e.orderId,e.symbol,e.side,e.price,e.quantity,e.fee,e.feeRate,e.isMaker?1:0])}async getTrade(e){const n=await Je.select(`
      SELECT id, portfolio_id, order_id, symbol, side, price, quantity,
             fee, fee_rate, is_maker, timestamp
      FROM paper_trading_trades
      WHERE id = $1
    `,[e]);return!n||n.length===0?null:this.mapDBTrade(n[0])}async getPortfolioTrades(e,r){let n=`
      SELECT id, portfolio_id, order_id, symbol, side, price, quantity,
             fee, fee_rate, is_maker, timestamp
      FROM paper_trading_trades
      WHERE portfolio_id = $1
      ORDER BY timestamp DESC
    `;const i=[e];return r&&(n+=" LIMIT $2",i.push(r)),(await Je.select(n,i)).map(a=>this.mapDBTrade(a))}async getOrderTrades(e){return(await Je.select(`
      SELECT id, portfolio_id, order_id, symbol, side, price, quantity,
             fee, fee_rate, is_maker, timestamp
      FROM paper_trading_trades
      WHERE order_id = $1
      ORDER BY timestamp ASC
    `,[e])).map(i=>this.mapDBTrade(i))}async deleteTrade(e){await Je.execute("DELETE FROM paper_trading_trades WHERE id = $1",[e])}mapDBPortfolio(e){return{id:e.id,name:e.name,provider:e.provider,initialBalance:e.initial_balance,currentBalance:e.current_balance,currency:e.currency||"USD",marginMode:e.margin_mode||"cross",leverage:e.leverage||1,createdAt:e.created_at,updatedAt:e.updated_at}}mapDBPosition(e){return{id:e.id,portfolioId:e.portfolio_id,symbol:e.symbol,side:e.side,entryPrice:e.entry_price,quantity:e.quantity,positionValue:e.position_value,currentPrice:e.current_price,unrealizedPnl:e.unrealized_pnl,realizedPnl:e.realized_pnl,leverage:e.leverage,marginMode:e.margin_mode,liquidationPrice:e.liquidation_price,openedAt:e.opened_at,closedAt:e.closed_at,status:e.status}}mapDBOrder(e){return{id:e.id,portfolioId:e.portfolio_id,symbol:e.symbol,side:e.side,type:e.type,amount:e.quantity,price:e.price||void 0,stopPrice:e.stop_price||void 0,filled:e.filled_quantity,average:e.avg_fill_price||void 0,status:e.status,timestamp:new Date(e.created_at).getTime(),datetime:e.created_at,timeInForce:e.time_in_force||void 0,postOnly:e.post_only===1,reduceOnly:e.reduce_only===1,trailingPercent:e.trailing_percent||void 0,trailingAmount:e.trailing_amount||void 0,icebergQty:e.iceberg_qty||void 0,leverage:e.leverage||void 0,marginMode:e.margin_mode,lastTradeTimestamp:e.filled_at?new Date(e.filled_at).getTime():void 0,remaining:e.quantity-e.filled_quantity,cost:(e.avg_fill_price||0)*e.filled_quantity,info:{}}}mapDBTrade(e){return{id:e.id,portfolioId:e.portfolio_id,orderId:e.order_id,symbol:e.symbol,side:e.side,price:e.price,quantity:e.quantity,fee:e.fee,feeRate:e.fee_rate,isMaker:e.is_maker===1,timestamp:e.timestamp}}}const Nt=new fz;class U0{constructor(e){this.config=e}async getBalance(e){const r=await Nt.getPortfolio(e);if(!r)throw new Error(`Portfolio ${e} not found`);const n=await Nt.getPortfolioPositions(e,"open"),i=this.calculateTotalMarginUsed(n),o=r.currency||"USD",a=Math.max(0,r.currentBalance-i),l=i,d=r.currentBalance;return{free:{[o]:a},used:{[o]:l},total:{[o]:d},info:{portfolio_id:e,margin_mode:r.marginMode,leverage:r.leverage}}}async checkSufficientFunds(e,r,n,i,o,a){const l=await Nt.getPortfolio(e);if(!l)return{sufficient:!1,required:0,available:0,error:"Portfolio not found"};const d=a||l.leverage||1,p=i*o,f=p/d,h=n==="buy"?this.config.fees.taker:this.config.fees.maker,x=p*h,m=f+x,b=await this.getBalance(e),w=l.currency||"USD",y=b.free?.[w]||0,C=y>=m;return{sufficient:C,required:m,available:y,error:C?void 0:`Insufficient funds: ${y.toFixed(2)} ${w} available, ${m.toFixed(2)} ${w} required`}}async lockFunds(e,r){}async releaseFunds(e,r){}async updatePositionAfterFill(e,r,n,i,o,a,l,d){const p=n==="buy"?"long":"short",f=p==="long"?"short":"long",h=await Nt.getPositionBySymbolAndSide(e,r,f,"open");if(d&&!h)throw new Error(`Cannot reduce position - no ${f} position exists for ${r}`);if(h){if(console.log(`[PaperTradingBalance] Reducing/closing ${f} position for ${r}`),console.log(`  Existing: ${h.quantity} @ ${h.entryPrice}`),console.log(`  Reducing by: ${o} @ ${i}`),d&&o>h.quantity)throw new Error(`Reduce-only order quantity ${o} exceeds position size ${h.quantity}`);const m=f==="long"?(i-h.entryPrice)*o:(h.entryPrice-i)*o;console.log(`  Realized PnL: ${m.toFixed(2)}`);const b=await Nt.getPortfolio(e);if(b&&await Nt.updatePortfolioBalance(e,b.currentBalance+m),h.quantity===o)console.log("  Fully closing position"),await Nt.updatePosition(h.id,{status:"closed",closedAt:new Date().toISOString(),realizedPnl:m,quantity:0});else if(h.quantity>o){const y=h.quantity-o;console.log(`  Partially closing, remaining: ${y}`),await Nt.updatePosition(h.id,{quantity:y,realizedPnl:(h.realizedPnl||0)+m})}else{console.log("  Fill exceeds position, closing and opening opposite"),await Nt.updatePosition(h.id,{status:"closed",closedAt:new Date().toISOString(),realizedPnl:m,quantity:0});const y=o-h.quantity;return await this.createNewPosition(e,r,p,i,y,a,l)}const w=await Nt.getPosition(h.id);if(!w)throw new Error("Failed to retrieve updated position");return w}const x=await Nt.getPositionBySymbolAndSide(e,r,p,"open");if(x){console.log(`[PaperTradingBalance] Adding to existing ${p} position for ${r}`),console.log(`  Existing: ${x.quantity} @ ${x.entryPrice}`),console.log(`  Adding: ${o} @ ${i}`);const m=x.entryPrice*x.quantity+i*o,b=x.quantity+o,w=m/b;console.log(`  New position: ${b} @ ${w}`);const y=this.calculateLiquidationPrice(p,w,a,b);await Nt.updatePosition(x.id,{quantity:b,entryPrice:w,liquidationPrice:y});const C=await Nt.getPosition(x.id);if(!C)throw new Error("Failed to retrieve updated position");return C}else return await this.createNewPosition(e,r,p,i,o,a,l)}async createNewPosition(e,r,n,i,o,a,l){console.log(`[PaperTradingBalance] Creating new ${n} position for ${r}`);const d=`pos_${Date.now()}_${Math.random().toString(36).substring(7)}`,p=this.calculateLiquidationPrice(n,i,a,o);await Nt.createPosition({id:d,portfolioId:e,symbol:r,side:n,entryPrice:i,quantity:o,leverage:a,marginMode:l});const f=await Nt.getPosition(d);if(!f)throw new Error("Failed to create position");return await Nt.updatePosition(d,{liquidationPrice:p}),f}async updatePositionPrices(e,r,n){const i=await Nt.getPositionBySymbol(e,r,"open");if(!i)return;const o=this.calculateUnrealizedPnL(i.side,i.entryPrice,n,i.quantity);await Nt.updatePosition(i.id,{currentPrice:n,unrealizedPnl:o})}async checkLiquidation(e,r){if(!e.liquidationPrice)return{shouldLiquidate:!1,position:e,currentPrice:r,liquidationPrice:0,marginRatio:0};if(!(e.side==="long"&&r<=e.liquidationPrice||e.side==="short"&&r>=e.liquidationPrice)){const i=e.quantity*e.entryPrice/e.leverage,o=e.quantity*r,a=e.side==="long"?o-e.quantity*e.entryPrice:e.quantity*e.entryPrice-o,d=(i+a)/o*100;return{shouldLiquidate:!1,position:e,currentPrice:r,liquidationPrice:e.liquidationPrice,marginRatio:d}}return{shouldLiquidate:!0,position:e,currentPrice:r,liquidationPrice:e.liquidationPrice,marginRatio:0,reason:`Price ${r} ${e.side==="long"?"<=":">="} liquidation price ${e.liquidationPrice}`}}async executeLiquidation(e,r){const n=this.calculateRealizedPnL(e.side,e.entryPrice,r,e.quantity);await Nt.updatePosition(e.id,{quantity:0,currentPrice:r,unrealizedPnl:0,realizedPnl:e.realizedPnl+n,status:"closed",closedAt:new Date().toISOString()});const i=await Nt.getPortfolio(e.portfolioId);if(i){const o=i.currentBalance+n;await Nt.updatePortfolioBalance(e.portfolioId,o)}}calculateUnrealizedPnL(e,r,n,i){return e==="long"?(n-r)*i:(r-n)*i}calculateRealizedPnL(e,r,n,i){return e==="long"?(n-r)*i:(r-n)*i}calculateTotalMarginUsed(e){return e.reduce((r,n)=>{const o=n.quantity*n.entryPrice/n.leverage;return r+o},0)}calculateMarginRequirement(e,r,n,i,o,a){const d=n*i/o,p=d*.5,f=this.calculateLiquidationPrice(r,n,o,i);return{symbol:e,side:r,quantity:i,price:n,leverage:o,marginMode:a,initialMargin:d,maintenanceMargin:p,liquidationPrice:f}}calculateLiquidationPrice(e,r,n,i){if(n<=1)return null;const o=.5/n;return e==="long"?r*(1-1/n+o):r*(1+1/n-o)}async calculatePortfolioPnL(e){const r=await Nt.getPortfolioPositions(e);let n=0,i=0;for(const o of r)i+=o.realizedPnl,o.status==="open"&&o.unrealizedPnl!==null&&(n+=o.unrealizedPnl);return{unrealizedPnL:n,realizedPnL:i,totalPnL:n+i}}async calculateTotalValue(e){const r=await Nt.getPortfolio(e);if(!r)return 0;const{unrealizedPnL:n}=await this.calculatePortfolioPnL(e);return r.currentBalance+n}}class gz{constructor(e,r){Pe(this,"balanceManager");Pe(this,"monitoringInterval",null);Pe(this,"priceCache",new Map);Pe(this,"websocketPriceUpdates",new Map);this.config=e,this.realExchangeAdapter=r,this.balanceManager=new U0(e)}updatePriceFromWebSocket(e,r){const n={symbol:e,bid:r.bid||r.last||0,ask:r.ask||r.last||0,last:r.last||0,timestamp:Date.now()};this.websocketPriceUpdates.set(e,n)}async placeOrder(e,r,n,i,o,a){const l=`order_${Date.now()}_${Math.random().toString(36).substring(7)}`,d=await this.fetchPriceSnapshot(e),p=o||(n==="buy"?d.ask:d.bid),f=a?.leverage||this.config.defaultLeverage||1,h=await this.balanceManager.checkSufficientFunds(this.config.portfolioId,e,n,i,p,f);if(!h.sufficient)return{success:!1,order:this.createOrderObject(l,e,r,n,i,o,a,"rejected"),trades:[],balance:h.available,error:h.error};switch(await Nt.createOrder({id:l,portfolioId:this.config.portfolioId,symbol:e,side:n,type:r,quantity:i,price:o||null,stopPrice:a?.stopPrice||null,timeInForce:a?.timeInForce,postOnly:a?.postOnly,reduceOnly:a?.reduceOnly,trailingPercent:a?.trailingPercent||null,trailingAmount:a?.trailingAmount||null,icebergQty:a?.icebergQty||null,leverage:a?.leverage,marginMode:a?.marginMode}),r){case"market":return await this.executeMarketOrder(l,e,n,i,a);case"limit":return await this.handleLimitOrder(l,e,n,i,o,a);case"stop":case"stop_limit":return await this.handleStopOrder(l,e,r,n,i,o,a);case"trailing_stop":return await this.handleTrailingStopOrder(l,e,n,i,a);case"iceberg":return await this.handleIcebergOrder(l,e,n,i,o,a);default:return{success:!1,order:this.createOrderObject(l,e,r,n,i,o,a,"rejected"),trades:[],balance:h.available,error:`Unsupported order type: ${r}`}}}async executeMarketOrder(e,r,n,i,o){const a=await this.fetchPriceSnapshot(r),l=n==="buy"?a.ask:a.bid,d=this.config.slippage.market,p=n==="buy"?l*(1+d):l*(1-d);if(this.config.simulatedLatency&&this.config.simulatedLatency>0&&await this.sleep(this.config.simulatedLatency),o?.timeInForce==="PO")return await Nt.updateOrder(e,{status:"rejected"}),{success:!1,order:this.createOrderObject(e,r,"market",n,i,void 0,o,"rejected"),trades:[],balance:0,error:"Post-only (PO) time-in-force not valid for market orders"};const f=await this.executeTrade(e,r,n,p,i,!1,o);return f.success?(await Nt.updateOrder(e,{filledQuantity:i,avgFillPrice:p,status:"filled",filledAt:new Date().toISOString()}),{success:!0,order:await Nt.getOrder(e),trades:f.trades,position:f.position,balance:f.balance}):f}async handleLimitOrder(e,r,n,i,o,a){const l=await this.fetchPriceSnapshot(r),d=n==="buy"?l.ask<=o:l.bid>=o;return a?.postOnly&&d?(await Nt.updateOrder(e,{status:"rejected"}),{success:!1,order:this.createOrderObject(e,r,"limit",n,i,o,a,"rejected"),trades:[],balance:0,error:"Post-only order would take liquidity"}):a?.timeInForce==="IOC"?d?await this.executeLimitOrder(e,r,n,i,o,a):(await Nt.updateOrder(e,{status:"canceled"}),{success:!1,order:this.createOrderObject(e,r,"limit",n,i,o,a,"canceled"),trades:[],balance:0,error:"IOC order could not be filled immediately"}):a?.timeInForce==="FOK"?d?await this.executeLimitOrder(e,r,n,i,o,a):(await Nt.updateOrder(e,{status:"canceled"}),{success:!1,order:this.createOrderObject(e,r,"limit",n,i,o,a,"canceled"),trades:[],balance:0,error:"FOK order could not be fully filled"}):d?await this.executeLimitOrder(e,r,n,i,o,a):{success:!0,order:await Nt.getOrder(e),trades:[],balance:0}}async executeLimitOrder(e,r,n,i,o,a){const l=o,p=await this.executeTrade(e,r,n,l,i,!0,a);return p.success?(await Nt.updateOrder(e,{filledQuantity:i,avgFillPrice:l,status:"filled",filledAt:new Date().toISOString()}),{success:!0,order:await Nt.getOrder(e),trades:p.trades,position:p.position,balance:p.balance}):p}async handleStopOrder(e,r,n,i,o,a,l){return l?.stopPrice?{success:!0,order:await Nt.getOrder(e),trades:[],balance:0}:(await Nt.updateOrder(e,{status:"rejected"}),{success:!1,order:this.createOrderObject(e,r,n,i,o,a,l,"rejected"),trades:[],balance:0,error:"Stop orders require stopPrice parameter"})}async checkStopOrderTrigger(e,r){return e.stopPrice?e.side==="buy"?r>=e.stopPrice:r<=e.stopPrice:!1}async executeTriggeredStopOrder(e,r){if(await Nt.updateOrder(e.id,{status:"triggered"}),e.type==="stop"){const n=await this.fetchPriceSnapshot(e.symbol),i=e.side==="buy"?n.ask:n.bid;await this.executeTrade(e.id,e.symbol,e.side,i,e.amount,!1),await Nt.updateOrder(e.id,{filledQuantity:e.amount,avgFillPrice:i,status:"filled",filledAt:new Date().toISOString()})}else e.type==="stop_limit"&&e.price&&(e.side==="buy"?r<=e.price:r>=e.price)&&(await this.executeTrade(e.id,e.symbol,e.side,e.price,e.amount,!0),await Nt.updateOrder(e.id,{filledQuantity:e.amount,avgFillPrice:e.price,status:"filled",filledAt:new Date().toISOString()}))}async handleTrailingStopOrder(e,r,n,i,o){return!o?.trailingPercent&&!o?.trailingAmount?(await Nt.updateOrder(e,{status:"rejected"}),{success:!1,order:this.createOrderObject(e,r,"trailing_stop",n,i,void 0,o,"rejected"),trades:[],balance:0,error:"Trailing stop orders require trailingPercent or trailingAmount"}):{success:!0,order:await Nt.getOrder(e),trades:[],balance:0}}async handleIcebergOrder(e,r,n,i,o,a){return a?.icebergQty?await this.handleLimitOrder(e,r,n,i,o,a):(await Nt.updateOrder(e,{status:"rejected"}),{success:!1,order:this.createOrderObject(e,r,"iceberg",n,i,o,a,"rejected"),trades:[],balance:0,error:"Iceberg orders require icebergQty parameter"})}async executeTrade(e,r,n,i,o,a,l){const d=a?this.config.fees.maker:this.config.fees.taker,f=i*o*d,x={id:`trade_${Date.now()}_${Math.random().toString(36).substring(7)}`,portfolioId:this.config.portfolioId,orderId:e,symbol:r,side:n,price:i,quantity:o,fee:f,feeRate:d,isMaker:a,timestamp:new Date().toISOString()};await Nt.createTrade(x);const m=l?.leverage||this.config.defaultLeverage||1,b=l?.marginMode||this.config.marginMode||"cross",w=await this.balanceManager.updatePositionAfterFill(this.config.portfolioId,r,n,i,o,m,b,l?.reduceOnly),y=await Nt.getPortfolio(this.config.portfolioId);if(y){const E=y.currentBalance-f;await Nt.updatePortfolioBalance(this.config.portfolioId,E)}const C=await this.balanceManager.getBalance(this.config.portfolioId),T=this.config.currency||"USD";return{success:!0,order:this.createOrderObject(e,r,"market",n,o,i,l,"filled"),trades:[x],position:w,balance:C.free?.[T]||0}}startMonitoring(e=500){this.monitoringInterval||(this.monitoringInterval=setInterval(async()=>{await this.checkPendingOrders()},e))}stopMonitoring(){this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=null)}async checkPendingOrders(){try{const e=await Nt.getPendingOrders(this.config.portfolioId);for(const r of e)try{const n=await this.fetchPriceSnapshot(r.symbol);await this.checkPositionLiquidations(r.symbol,n.last),r.type==="limit"&&r.status==="pending"&&(r.side==="buy"?n.ask<=(r.price||0):n.bid>=(r.price||0))&&await this.executeLimitOrder(r.id,r.symbol,r.side,r.amount,r.price,{leverage:r.leverage,marginMode:r.marginMode}),(r.type==="stop"||r.type==="stop_limit")&&r.status==="pending"&&await this.checkStopOrderTrigger(r,n.last)&&await this.executeTriggeredStopOrder(r,n.last),await this.balanceManager.updatePositionPrices(this.config.portfolioId,r.symbol,n.last)}catch(n){console.error(`Error checking order ${r.id}:`,n)}}catch(e){console.error("Error checking pending orders:",e)}}async checkPositionLiquidations(e,r){const n=await Nt.getPositionBySymbol(this.config.portfolioId,e,"open");if(!n||!n.liquidationPrice)return;(await this.balanceManager.checkLiquidation(n,r)).shouldLiquidate&&await this.balanceManager.executeLiquidation(n,r)}async cancelOrder(e){const r=await Nt.getOrder(e);if(!r)throw new Error(`Order ${e} not found`);if(r.status==="filled")throw new Error(`Cannot cancel filled order ${e}`);return await Nt.updateOrder(e,{status:"canceled"}),await Nt.getOrder(e)}async cancelAllOrders(e){const r=await Nt.getPendingOrders(this.config.portfolioId),n=e?r.filter(o=>o.symbol===e):r,i=[];for(const o of n){await Nt.updateOrder(o.id,{status:"canceled"});const a=await Nt.getOrder(o.id);a&&i.push(a)}return i}async fetchPriceSnapshot(e){const r=this.websocketPriceUpdates.get(e);if(r&&Date.now()-r.timestamp<2e3)return r;const n=this.priceCache.get(e),i=Date.now();if(n&&i-n.timestamp<1e3)return n;const o=await this.realExchangeAdapter.fetchTicker(e),a={symbol:e,bid:o.bid||o.last||0,ask:o.ask||o.last||0,last:o.last||0,timestamp:i};return this.priceCache.set(e,a),a}createOrderObject(e,r,n,i,o,a,l,d="pending"){return{id:e,portfolioId:this.config.portfolioId,symbol:r,type:n,side:i,amount:o,price:a,stopPrice:l?.stopPrice,filled:0,remaining:o,average:void 0,status:d,timestamp:Date.now(),datetime:new Date().toISOString(),timeInForce:l?.timeInForce,postOnly:l?.postOnly,reduceOnly:l?.reduceOnly,trailingPercent:l?.trailingPercent,trailingAmount:l?.trailingAmount,icebergQty:l?.icebergQty,leverage:l?.leverage,marginMode:l?.marginMode,cost:0,info:{}}}sleep(e){return new Promise(r=>setTimeout(r,e))}destroy(){this.stopMonitoring(),this.priceCache.clear()}}class xz extends zb{constructor(r){super({...r,exchange:r.paperTradingConfig.provider});Pe(this,"paperConfig");Pe(this,"realAdapter");Pe(this,"balanceManager");Pe(this,"matchingEngine");Pe(this,"initialized",!1);this.paperConfig=r.paperTradingConfig,this.realAdapter=r.realAdapter,this.balanceManager=new U0(this.paperConfig),this.matchingEngine=new gz(this.paperConfig,this.realAdapter),Object.defineProperty(this,"name",{value:`${this.realAdapter.name} (Paper Trading)`,writable:!1,configurable:!0})}async connect(){try{console.log("[PaperTradingAdapter] Starting connection..."),console.log("[PaperTradingAdapter] Real adapter connected:",this.realAdapter.isConnected()),this.realAdapter.isConnected()?console.log("[PaperTradingAdapter] Real adapter already connected, skipping"):(console.log("[PaperTradingAdapter] Connecting real adapter..."),await this.realAdapter.connect(),console.log("[PaperTradingAdapter] Real adapter connected successfully")),console.log("[PaperTradingAdapter] Initializing portfolio..."),await this.initializePortfolio(),console.log("[PaperTradingAdapter] Portfolio initialized"),this.paperConfig.enableRealtimeUpdates!==!1&&(console.log("[PaperTradingAdapter] Starting order monitoring..."),this.matchingEngine.startMonitoring(this.paperConfig.priceUpdateInterval||1e3)),this._isConnected=!0,this._isAuthenticated=!0,this.initialized=!0,console.log("[PaperTradingAdapter]  Connection complete!"),this.emit("connected",{exchange:this.id}),this.emit("authenticated",{exchange:this.id})}catch(r){throw this._isConnected=!1,console.error("[PaperTradingAdapter]  Connection failed:",r),this.handleError(r)}}async disconnect(){this.matchingEngine.stopMonitoring(),this._isConnected=!1,this._isAuthenticated=!1,this.emit("disconnected",{exchange:this.id})}async resetAccount(){console.log("[PaperTradingAdapter] Resetting account...");const r=this.paperConfig.portfolioId;try{const n=await Nt.getPortfolioPositions(r,"open");console.log(`[PaperTradingAdapter] Closing ${n.length} open positions...`);for(const p of n)await Nt.updatePosition(p.id,{status:"closed",closedAt:new Date().toISOString()});const i=await Nt.getPendingOrders(r);console.log(`[PaperTradingAdapter] Cancelling ${i.length} pending orders...`);for(const p of i)await Nt.updateOrder(p.id,{status:"canceled"});console.log("[PaperTradingAdapter] Deleting all positions...");const o=await Nt.getPortfolioPositions(r);for(const p of o)await Nt.deletePosition(p.id);console.log("[PaperTradingAdapter] Deleting all orders...");const a=await Nt.getPortfolioOrders(r);for(const p of a)await Nt.deleteOrder(p.id);console.log("[PaperTradingAdapter] Deleting all trades...");const l=await Nt.getPortfolioTrades(r);for(const p of l)await Nt.deleteTrade(p.id);const d=this.paperConfig.initialBalance;console.log(`[PaperTradingAdapter] Resetting balance to ${d}...`),await Nt.updatePortfolioBalance(r,d),this.balanceManager=new U0(this.paperConfig),console.log("[PaperTradingAdapter]  Account reset complete!"),this.emit("reset",{exchange:this.id,portfolioId:r})}catch(n){throw console.error("[PaperTradingAdapter]  Reset failed:",n),n}}async authenticate(r){this._isAuthenticated=!0,this.emit("authenticated",{exchange:this.id})}async initializePortfolio(){await Nt.getPortfolio(this.paperConfig.portfolioId)||await Nt.createPortfolio({id:this.paperConfig.portfolioId,name:this.paperConfig.portfolioName,provider:this.paperConfig.provider,initialBalance:this.paperConfig.initialBalance,currency:this.paperConfig.currency,marginMode:this.paperConfig.marginMode,leverage:this.paperConfig.defaultLeverage})}async fetchMarkets(){return await this.realAdapter.fetchMarkets()}async fetchTicker(r){return await this.realAdapter.fetchTicker(r)}async fetchTickers(r){return await this.realAdapter.fetchTickers(r)}async fetchOrderBook(r,n){return await this.realAdapter.fetchOrderBook(r,n)}async fetchTrades(r,n){return await this.realAdapter.fetchTrades(r,n)}async fetchOHLCV(r,n,i){return await this.realAdapter.fetchOHLCV(r,n,i)}getMarkets(){return this.exchange.markets||{}}async fetchStatus(){return"fetchStatus"in this.realAdapter&&typeof this.realAdapter.fetchStatus=="function"?await this.realAdapter.fetchStatus():{status:"ok",updated:Date.now()}}async fetchCurrencies(){return"fetchCurrencies"in this.realAdapter&&typeof this.realAdapter.fetchCurrencies=="function"?await this.realAdapter.fetchCurrencies():{}}async fetchTime(){return"fetchTime"in this.realAdapter&&typeof this.realAdapter.fetchTime=="function"?await this.realAdapter.fetchTime():Date.now()}async fetchBalance(){if(!this.initialized)throw new Error("Paper trading adapter not initialized. Call connect() first.");const r=await this.balanceManager.getBalance(this.paperConfig.portfolioId);return this.emit("balance",{exchange:this.id,data:r}),r}async fetchPositions(r){if(!this.initialized)throw new Error("Paper trading adapter not initialized. Call connect() first.");const n=await Nt.getPortfolioPositions(this.paperConfig.portfolioId,"open"),i=n.map(async a=>{try{const l=this.realAdapter.fetchTicker(a.symbol),d=new Promise((x,m)=>setTimeout(()=>m(new Error("Ticker timeout")),1e4)),p=await Promise.race([l,d]),f=p.last||p.close||a.currentPrice||a.entryPrice,h=a.side==="long"?(f-a.entryPrice)*a.quantity:(a.entryPrice-f)*a.quantity;await Nt.updatePosition(a.id,{currentPrice:f,unrealizedPnl:h}),a.currentPrice=f,a.unrealizedPnl=h}catch{a.currentPrice=a.currentPrice||a.entryPrice,a.unrealizedPnl=a.unrealizedPnl||0}});await Promise.race([Promise.all(i),new Promise((a,l)=>setTimeout(()=>l(new Error("All updates timeout")),2e4))]).catch(()=>{});const o=n.filter(a=>!r||r.includes(a.symbol)).map(a=>({info:a,id:a.id,symbol:a.symbol,timestamp:new Date(a.openedAt).getTime(),datetime:a.openedAt,initialMargin:a.quantity*a.entryPrice/a.leverage,initialMarginPercentage:1/a.leverage,maintenanceMargin:a.quantity*a.entryPrice/a.leverage*.5,maintenanceMarginPercentage:.5/a.leverage,entryPrice:a.entryPrice,notional:a.quantity*(a.currentPrice||a.entryPrice),leverage:a.leverage,unrealizedPnl:a.unrealizedPnl||0,contracts:a.quantity,contractSize:1,marginRatio:void 0,liquidationPrice:a.liquidationPrice||0,markPrice:a.currentPrice||a.entryPrice,collateral:a.quantity*a.entryPrice/a.leverage,marginMode:a.marginMode,side:a.side==="long"?"long":"short",percentage:a.unrealizedPnl?a.unrealizedPnl/(a.quantity*a.entryPrice/a.leverage)*100:0}));return this.emit("position",{exchange:this.id,data:o}),o}async fetchLedger(r,n,i){return(await Nt.getPortfolioTrades(this.paperConfig.portfolioId,i)).map(a=>({id:a.id,timestamp:new Date(a.timestamp).getTime(),datetime:a.timestamp,direction:a.side==="buy"?"in":"out",account:this.paperConfig.portfolioId,referenceId:a.orderId,referenceAccount:a.symbol,type:"trade",currency:r||this.paperConfig.currency||"USD",amount:a.quantity,before:null,after:null,status:"ok",fee:{cost:a.fee,currency:this.paperConfig.currency||"USD"},info:a}))}async fetchTradingFee(r){return{info:{},symbol:r,maker:this.paperConfig.fees.maker,taker:this.paperConfig.fees.taker,percentage:!0,tierBased:!1}}async createOrder(r,n,i,o,a,l){if(!this.initialized)throw new Error("Paper trading adapter not initialized. Call connect() first.");const d=await this.matchingEngine.placeOrder(r,n,i,o,a,l);if(!d.success)throw new Error(d.error||"Order placement failed");return this.emit("order",{exchange:this.id,data:d.order}),d.position&&this.emit("position",{exchange:this.id,data:d.position}),d.order}async editOrder(r,n,i,o,a,l,d){if(await this.cancelOrder(r,n),!i||!o||!a)throw new Error("Edit order requires type, side, and amount");return await this.createOrder(n,i,o,a,l,d)}async cancelOrder(r,n){if(!this.initialized)throw new Error("Paper trading adapter not initialized. Call connect() first.");const i=await this.matchingEngine.cancelOrder(r);return this.emit("order",{exchange:this.id,data:i}),i}async cancelOrders(r,n){const i=[];for(const o of r){const a=await this.cancelOrder(o,n||"");i.push(a)}return i}async cancelAllOrders(r){if(!this.initialized)throw new Error("Paper trading adapter not initialized. Call connect() first.");const n=await this.matchingEngine.cancelAllOrders(r);for(const i of n)this.emit("order",{exchange:this.id,data:i});return n}async cancelAllOrdersAfter(r){return setTimeout(async()=>{await this.cancelAllOrders()},r),{timeout:r,status:"scheduled"}}async fetchOrder(r,n){const i=await Nt.getOrder(r);if(!i)throw new Error(`Order ${r} not found`);return i}async fetchOrdersByIds(r,n){const i=[];for(const o of r){const a=await Nt.getOrder(o);a&&i.push(a)}return i}async fetchOrderTrades(r,n){return(await Nt.getOrderTrades(r)).map(o=>({id:o.id,order:r,info:o,timestamp:new Date(o.timestamp).getTime(),datetime:o.timestamp,symbol:o.symbol,type:"limit",side:o.side,takerOrMaker:o.isMaker?"maker":"taker",price:o.price,amount:o.quantity,cost:o.price*o.quantity,fee:{cost:o.fee,currency:this.paperConfig.currency||"USD",rate:o.feeRate}}))}async fetchOpenOrders(r){const i=(await Nt.getPortfolioOrders(this.paperConfig.portfolioId)).filter(o=>["pending","triggered","partial"].includes(o.status));return r?i.filter(o=>o.symbol===r):i}async fetchClosedOrders(r,n){let o=(await Nt.getPortfolioOrders(this.paperConfig.portfolioId)).filter(a=>["filled","canceled","rejected"].includes(a.status));return r&&(o=o.filter(a=>a.symbol===r)),n&&(o=o.slice(0,n)),o}async fetchMyTrades(r,n,i){let a=await Nt.getPortfolioTrades(this.paperConfig.portfolioId,i);return r&&(a=a.filter(l=>l.symbol===r)),n&&(a=a.filter(l=>new Date(l.timestamp).getTime()>=n)),a.map(l=>({id:l.id,order:l.orderId,info:l,timestamp:new Date(l.timestamp).getTime(),datetime:l.timestamp,symbol:l.symbol,type:"limit",side:l.side,takerOrMaker:l.isMaker?"maker":"taker",price:l.price,amount:l.quantity,cost:l.price*l.quantity,fee:{cost:l.fee,currency:this.paperConfig.currency||"USD",rate:l.feeRate}}))}async createStopLossOrder(r,n,i,o,a){return await this.createOrder(r,a?"stop_limit":"stop",n,i,a,{stopPrice:o})}async createTakeProfitOrder(r,n,i,o,a){return await this.createOrder(r,a?"stop_limit":"stop",n,i,a,{stopPrice:o})}async createTrailingStopOrder(r,n,i,o){return await this.createOrder(r,"trailing_stop",n,i,void 0,{trailingPercent:o})}async createIcebergOrder(r,n,i,o,a){return await this.createOrder(r,"iceberg",n,i,o,{icebergQty:a})}async createMarketOrderWithCost(r,n,i){const o=await this.fetchTicker(r),a=n==="buy"?o.ask||o.last||0:o.bid||o.last||0,l=i/a;return await this.createOrder(r,"market",n,l)}async createPostOnlyOrder(r,n,i,o){return await this.createOrder(r,"limit",n,i,o,{postOnly:!0})}async createReduceOnlyOrder(r,n,i,o,a){return await this.createOrder(r,n,i,o,a,{reduceOnly:!0})}async setLeverage(r,n){return await Nt.getPortfolio(this.paperConfig.portfolioId)&&(this.paperConfig.defaultLeverage=n),{symbol:r,leverage:n}}async setMarginMode(r,n){return this.paperConfig.marginMode=n,{symbol:r,marginMode:n}}async fetchDeposits(r,n,i){return[]}async fetchWithdrawals(r,n,i){return[]}async fetchDepositAddress(r,n){throw new Error("Deposits not supported in paper trading")}async createDepositAddress(r,n){throw new Error("Deposits not supported in paper trading")}async fetchDepositMethods(r){return[]}async withdraw(r,n,i,o,a){throw new Error("Withdrawals not supported in paper trading")}async transfer(r,n,i,o){return{info:{},id:`transfer_${Date.now()}`,timestamp:Date.now(),datetime:new Date().toISOString(),currency:r,amount:n,fromAccount:i,toAccount:o,status:"ok"}}async transferOut(r,n,i){return await this.transfer(r,n,"main","external")}getCapabilities(){const r="getCapabilities"in this.realAdapter&&typeof this.realAdapter.getCapabilities=="function"?this.realAdapter.getCapabilities():{};return{...r,spot:this.paperConfig.enableMarginTrading?!0:r.spot,margin:this.paperConfig.enableMarginTrading||!1,futures:this.paperConfig.enableMarginTrading||!1,leverageTrading:this.paperConfig.enableMarginTrading||!1,multiAccount:!1,subAccounts:!1}}async*watchTicker(r){if(this.realAdapter.watchTicker)yield*this.realAdapter.watchTicker(r);else throw new Error("WebSocket not supported by underlying adapter")}async*watchOrderBook(r,n){if(this.realAdapter.watchOrderBook)yield*this.realAdapter.watchOrderBook(r,n);else throw new Error("WebSocket not supported by underlying adapter")}async*watchTrades(r){if(this.realAdapter.watchTrades)yield*this.realAdapter.watchTrades(r);else throw new Error("WebSocket not supported by underlying adapter")}async*watchBalance(){for(;;)yield await this.fetchBalance(),await new Promise(n=>setTimeout(n,1e3))}async*watchOrders(r){for(;;)yield await this.fetchOpenOrders(r),await new Promise(i=>setTimeout(i,1e3))}async resetPortfolio(){await this.cancelAllOrders();const r=await Nt.getPortfolioPositions(this.paperConfig.portfolioId,"open");for(const n of r){const i=n.side==="long"?"sell":"buy";await this.createOrder(n.symbol,"market",i,n.quantity,void 0,{reduceOnly:!0})}await Nt.updatePortfolioBalance(this.paperConfig.portfolioId,this.paperConfig.initialBalance)}async getStatistics(){const r=await Nt.getPortfolio(this.paperConfig.portfolioId),n=await Nt.getPortfolioPositions(this.paperConfig.portfolioId),i=await Nt.getPortfolioTrades(this.paperConfig.portfolioId),o=await this.balanceManager.calculatePortfolioPnL(this.paperConfig.portfolioId),a=await this.balanceManager.calculateTotalValue(this.paperConfig.portfolioId);return i.filter(l=>l.side==="sell"),{portfolioId:this.paperConfig.portfolioId,portfolioName:this.paperConfig.portfolioName,initialBalance:this.paperConfig.initialBalance,currentBalance:r?.currentBalance||0,totalValue:a,totalPnL:o.totalPnL,realizedPnL:o.realizedPnL,unrealizedPnL:o.unrealizedPnL,totalTrades:i.length,openPositions:n.filter(l=>l.status==="open").length,closedPositions:n.filter(l=>l.status==="closed").length,returnPercent:(o.totalPnL/this.paperConfig.initialBalance*100).toFixed(2)}}async destroy(){this.matchingEngine.destroy(),await this.disconnect()}}function mz(s,e){const r={exchange:`${s.provider}_paper`,enableRateLimit:!0,paperTradingConfig:s,realAdapter:e};return new xz(r)}const mT=S.createContext(null);function yT({children:s}){const[e,r]=S.useState("kraken"),[n,i]=S.useState("paper"),[o,a]=S.useState(()=>localStorage.getItem("paper_portfolio_mode")||"separate"),[l,d]=S.useState(new Map),[p,f]=S.useState(!0),[h,x]=S.useState(!1),[m,b]=S.useState(null),[w,y]=S.useState(null),C=S.useMemo(()=>cz(e)||null,[e]),T=S.useMemo(()=>lz().filter(G=>G.type==="crypto"),[]),E=S.useMemo(()=>dz(e),[e]),j=S.useMemo(()=>{const G=n==="paper"?w:m;return G?pz(G):null},[m,w,n]),k=S.useMemo(()=>j?hz(j):null,[j]),A=S.useMemo(()=>n==="paper"?w:m,[n,m,w]);S.useEffect(()=>{(async()=>{f(!0);try{const B=wo(),F=new Map;for(const W of T)W.websocket.enabled&&W.websocket.endpoint&&F.set(W.id,{provider_name:W.id,enabled:!0,endpoint:W.websocket.endpoint});d(F);const z=localStorage.getItem("active_trading_broker"),$=localStorage.getItem("trading_mode");z&&Ad[z]&&r(z),$&&i($),F.forEach((W,D)=>{B.setProviderConfig(D,W)})}catch(B){console.error("[BrokerContext] Failed to load configurations:",B)}finally{f(!1)}})()},[T]);const R=S.useRef(!1);S.useEffect(()=>{if(console.log(`[BrokerContext] useEffect triggered - activeBroker: ${e}, isLoading: ${p}, isInitialized: ${R.current}`),p){console.log("[BrokerContext] Skipping initialization - still loading configs");return}if(R.current){console.log("[BrokerContext] Skipping initialization - already initialized");return}return(async()=>{x(!0);try{console.log("[BrokerContext] ========================================"),console.log(`[BrokerContext] Initializing ${e} adapters...`),console.log("[BrokerContext] ========================================"),m&&(console.log("[BrokerContext] Disconnecting old real adapter..."),await m.disconnect()),w&&(console.log("[BrokerContext] Disconnecting old paper adapter..."),await w.disconnect()),console.log(`[BrokerContext] Creating ${e} real adapter...`);const B=uz(e);console.log(`[BrokerContext] Connecting ${e} real adapter...`),await B.connect(),console.log(`[BrokerContext]  ${e} real adapter connected (status: ${B.isConnected()?"CONNECTED":"NOT CONNECTED"})`),b(B),console.log(`[BrokerContext] Creating ${e} paper adapter...`);const F=o==="unified"?"paper_global":`paper_${e}`;console.log(`[BrokerContext] Portfolio ID: ${F} (mode: ${o})`);let z;try{z=mz({portfolioId:F,portfolioName:o==="unified"?"Global Paper Trading Portfolio":`${e.toUpperCase()} Paper Trading`,provider:e,assetClass:"crypto",initialBalance:1e5,currency:"USD",fees:{maker:2e-4,taker:5e-4},slippage:{market:0,limit:0},enableMarginTrading:!0,defaultLeverage:1,maxLeverage:C?.advancedFeatures.maxLeverage||1},B),console.log("[BrokerContext]  Paper adapter instance created")}catch(D){throw console.error("[BrokerContext]  Failed to create paper adapter:",D),D}console.log(`[BrokerContext] Connecting ${e} paper adapter...`),await z.connect(),console.log(`[BrokerContext]  ${e} paper adapter connected (status: ${z.isConnected()?"CONNECTED":"NOT CONNECTED"})`),y(z),console.log("[BrokerContext]  setPaperAdapter() called");const $=wo(),W=l.get(e);if(console.log(`[BrokerContext] WebSocket config for ${e}:`,W?"EXISTS":"MISSING"),W){console.log(`[BrokerContext] Setting WebSocket config for ${e}...`),$.setProviderConfig(e,W),console.log(`[BrokerContext] Connecting WebSocket for ${e}...`),await $.connect(e);let D=$.getStatus(e),oe=0;const Z=20;for(;D!==Ln.CONNECTED&&oe<Z;)console.log(`[BrokerContext] Waiting for WebSocket... (${oe+1}/${Z}) - Status: ${D}`),await new Promise(fe=>setTimeout(fe,500)),D=$.getStatus(e),oe++;console.log(`[BrokerContext]  ${e} WebSocket status: ${D}`),console.log("[BrokerContext] ========================================"),console.log(`[BrokerContext] ${e} initialization complete!`),console.log(`[BrokerContext] Real Adapter: ${B.isConnected()?" CONNECTED":" NOT CONNECTED"}`),console.log(`[BrokerContext] Paper Adapter: ${z.isConnected()?" CONNECTED":" NOT CONNECTED"}`),console.log(`[BrokerContext] WebSocket: ${D}`),console.log("[BrokerContext] ========================================")}else console.warn(`[BrokerContext] No WebSocket config found for ${e}!`);R.current=!0}catch(B){console.error(`[BrokerContext]  Failed to initialize ${e}:`,B),console.error("[BrokerContext] Error details:",B),console.error("[BrokerContext] Stack trace:",B?.stack),b(null),y(null)}finally{x(!1)}})(),()=>{!R.current&&m&&(console.log("[BrokerContext] Cleanup: Disconnecting adapters for broker switch"),m.disconnect(),w&&w.disconnect())}},[p,e,o]);const M=S.useCallback(async G=>{if(!Ad[G])throw new Error(`Broker ${G} is not available`);console.log(`[BrokerContext] Switching to broker: ${G}`),R.current=!1,r(G),localStorage.setItem("active_trading_broker",G)},[]),P=S.useCallback(G=>{console.log(`[BrokerContext] Switching to ${G} mode`),i(G),localStorage.setItem("trading_mode",G)},[]),I=S.useCallback(G=>{console.log(`[BrokerContext] Switching paper portfolio mode to: ${G}`),a(G),localStorage.setItem("paper_portfolio_mode",G),R.current=!1},[]),O=S.useCallback(async(G,B)=>{d(F=>{const z=new Map(F),W={...z.get(G),...B,provider_name:G};return z.set(G,W),wo().setProviderConfig(G,W),z})},[]);return t.jsx(mT.Provider,{value:{activeBroker:e,activeBrokerMetadata:C,setActiveBroker:M,availableBrokers:T,tradingMode:n,setTradingMode:P,paperPortfolioMode:o,setPaperPortfolioMode:I,realAdapter:m,paperAdapter:w,activeAdapter:A,features:j,supports:k,defaultSymbols:E,providerConfigs:l,updateProviderConfig:O,isLoading:p,isConnecting:h},children:s})}function Hn(){const s=S.useContext(mT);if(!s)throw new Error("useBrokerContext must be used within a BrokerProvider");return s}function yz({children:s}){return t.jsx(yT,{children:s})}const Po=[{id:"local",label:"Local (System)",shortLabel:"LOC",zone:void 0},{id:"utc",label:"UTC (Coordinated)",shortLabel:"UTC",zone:"UTC"},{id:"new-york",label:"New York (EST/EDT)",shortLabel:"NYC",zone:"America/New_York"},{id:"chicago",label:"Chicago (CST/CDT)",shortLabel:"CHI",zone:"America/Chicago"},{id:"denver",label:"Denver (MST/MDT)",shortLabel:"DEN",zone:"America/Denver"},{id:"los-angeles",label:"Los Angeles (PST/PDT)",shortLabel:"LAX",zone:"America/Los_Angeles"},{id:"toronto",label:"Toronto (EST/EDT)",shortLabel:"TOR",zone:"America/Toronto"},{id:"vancouver",label:"Vancouver (PST/PDT)",shortLabel:"VAN",zone:"America/Vancouver"},{id:"mexico-city",label:"Mexico City (CST)",shortLabel:"MEX",zone:"America/Mexico_City"},{id:"sao-paulo",label:"So Paulo (BRT)",shortLabel:"SAO",zone:"America/Sao_Paulo"},{id:"buenos-aires",label:"Buenos Aires (ART)",shortLabel:"BUE",zone:"America/Buenos_Aires"},{id:"london",label:"London (GMT/BST)",shortLabel:"LDN",zone:"Europe/London"},{id:"paris",label:"Paris (CET/CEST)",shortLabel:"PAR",zone:"Europe/Paris"},{id:"berlin",label:"Berlin (CET/CEST)",shortLabel:"BER",zone:"Europe/Berlin"},{id:"amsterdam",label:"Amsterdam (CET/CEST)",shortLabel:"AMS",zone:"Europe/Amsterdam"},{id:"zurich",label:"Zurich (CET/CEST)",shortLabel:"ZRH",zone:"Europe/Zurich"},{id:"moscow",label:"Moscow (MSK)",shortLabel:"MOW",zone:"Europe/Moscow"},{id:"istanbul",label:"Istanbul (TRT)",shortLabel:"IST",zone:"Europe/Istanbul"},{id:"dubai",label:"Dubai (GST)",shortLabel:"DXB",zone:"Asia/Dubai"},{id:"mumbai",label:"Mumbai (IST)",shortLabel:"BOM",zone:"Asia/Kolkata"},{id:"delhi",label:"Delhi (IST)",shortLabel:"DEL",zone:"Asia/Kolkata"},{id:"bangkok",label:"Bangkok (ICT)",shortLabel:"BKK",zone:"Asia/Bangkok"},{id:"singapore",label:"Singapore (SGT)",shortLabel:"SIN",zone:"Asia/Singapore"},{id:"hong-kong",label:"Hong Kong (HKT)",shortLabel:"HKG",zone:"Asia/Hong_Kong"},{id:"shanghai",label:"Shanghai (CST)",shortLabel:"SHA",zone:"Asia/Shanghai"},{id:"tokyo",label:"Tokyo (JST)",shortLabel:"TYO",zone:"Asia/Tokyo"},{id:"seoul",label:"Seoul (KST)",shortLabel:"SEL",zone:"Asia/Seoul"},{id:"sydney",label:"Sydney (AEST/AEDT)",shortLabel:"SYD",zone:"Australia/Sydney"},{id:"melbourne",label:"Melbourne (AEST/AEDT)",shortLabel:"MEL",zone:"Australia/Melbourne"},{id:"perth",label:"Perth (AWST)",shortLabel:"PER",zone:"Australia/Perth"},{id:"auckland",label:"Auckland (NZST/NZDT)",shortLabel:"AKL",zone:"Pacific/Auckland"},{id:"johannesburg",label:"Johannesburg (SAST)",shortLabel:"JNB",zone:"Africa/Johannesburg"},{id:"cairo",label:"Cairo (EET)",shortLabel:"CAI",zone:"Africa/Cairo"},{id:"lagos",label:"Lagos (WAT)",shortLabel:"LOS",zone:"Africa/Lagos"},{id:"riyadh",label:"Riyadh (AST)",shortLabel:"RUH",zone:"Asia/Riyadh"},{id:"tel-aviv",label:"Tel Aviv (IST)",shortLabel:"TLV",zone:"Asia/Jerusalem"}],_y="fincept_default_timezone",ME="fincept_timezone",BE="local",bT=S.createContext(void 0),bz=({children:s})=>{const[e,r]=S.useState(()=>{try{const b=localStorage.getItem(_y);if(b&&Po.find(w=>w.id===b))return b}catch(b){console.warn("[TimezoneContext] Failed to read default timezone from localStorage:",b)}return BE}),[n,i]=S.useState(()=>{try{const b=localStorage.getItem(ME);if(b&&Po.find(y=>y.id===b))return b;const w=localStorage.getItem(_y);if(w&&Po.find(y=>y.id===w))return w}catch(b){console.warn("[TimezoneContext] Failed to read session timezone from localStorage:",b)}return BE}),o=Po.find(b=>b.id===e)||Po[0],a=Po.find(b=>b.id===n)||Po[0];S.useEffect(()=>{try{localStorage.setItem(_y,e)}catch(b){console.warn("[TimezoneContext] Failed to save default timezone to localStorage:",b)}},[e]),S.useEffect(()=>{try{localStorage.setItem(ME,n)}catch(b){console.warn("[TimezoneContext] Failed to save session timezone to localStorage:",b)}},[n]);const l=S.useCallback(b=>{Po.find(w=>w.id===b)?r(b):console.warn(`[TimezoneContext] Unknown timezone ID: ${b}`)},[]),d=S.useCallback(b=>{Po.find(w=>w.id===b)?i(b):console.warn(`[TimezoneContext] Unknown timezone ID: ${b}`)},[]),p=S.useCallback((b,w)=>{const y={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,...w};a.zone&&(y.timeZone=a.zone);try{return new Intl.DateTimeFormat("en-US",y).format(b)}catch(C){return console.error("[TimezoneContext] Format error:",C),b.toLocaleTimeString("en-US",{hour12:!1})}},[a]),f=S.useCallback((b,w)=>{const y={hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,...w};o.zone&&(y.timeZone=o.zone);try{return new Intl.DateTimeFormat("en-US",y).format(b)}catch(C){return console.error("[TimezoneContext] Format error:",C),b.toLocaleTimeString("en-US",{hour12:!1})}},[o]),h=S.useCallback(b=>p(b,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),[p]),x=S.useCallback(()=>h(new Date),[h]),m={defaultTimezone:o,timezone:a,options:Po,setDefaultTimezone:l,setTimezone:d,formatTime:p,formatTimeWithDefault:f,formatTimeShort:h,getCurrentTimeFormatted:x};return t.jsx(bT.Provider,{value:m,children:s})},Xg=()=>{const s=S.useContext(bT);if(!s)throw new Error("useTimezone must be used within a TimezoneProvider");return s},vz=(s=1e3)=>{const[e,r]=S.useState(new Date),{formatTimeShort:n,timezone:i}=Xg();return S.useEffect(()=>{const o=setInterval(()=>{r(new Date)},s);return()=>clearInterval(o)},[s]),{currentTime:e,formattedTime:n(e),timezone:i}},Sz=(s=1e3)=>{const[e,r]=S.useState(new Date),{formatTimeWithDefault:n,defaultTimezone:i}=Xg();return S.useEffect(()=>{const o=setInterval(()=>{r(new Date)},s);return()=>clearInterval(o)},[s]),{currentTime:e,formattedTime:n(e),timezone:i}};class wz{constructor(){Pe(this,"workflows",new Map);Pe(this,"runningWorkflows",new Set);Pe(this,"STORAGE_KEY","fincept_workflows");this.loadFromStorage()}loadFromStorage(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(e){const r=JSON.parse(e);r.forEach(n=>this.workflows.set(n.id,n)),mo.info(`Loaded ${r.length} workflows from storage`)}}catch(e){mo.error("Failed to load workflows:",e)}}saveToStorage(){try{const e=Array.from(this.workflows.values());localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e)),mo.info(`Saved ${e.length} workflows to storage`)}catch(e){mo.error("Failed to save workflows:",e)}}async saveWorkflow(e){this.workflows.set(e.id,e),this.saveToStorage(),mo.info(`Saved workflow: ${e.id}`)}async saveDraft(e,r,n,i){const o=`draft_${Date.now()}`,a={id:o,name:e,description:r,nodes:n,edges:i,status:"draft"};return await this.saveWorkflow(a),o}async loadWorkflow(e){return this.workflows.get(e)}async deleteWorkflow(e){this.workflows.delete(e),this.runningWorkflows.delete(e),this.saveToStorage(),mo.info(`Deleted workflow: ${e}`)}async listWorkflows(){return Array.from(this.workflows.values())}async executeWorkflow(e){const r=this.workflows.get(e);if(!r)throw new Error(`Workflow ${e} not found`);this.runningWorkflows.add(e),r.status="running",this.saveToStorage(),mo.info(`Executing workflow: ${e}`),setTimeout(()=>{const n=this.workflows.get(e);n&&(n.status="completed",this.runningWorkflows.delete(e),this.saveToStorage(),mo.info(`Workflow ${e} completed`))},100)}async stopWorkflow(e){this.runningWorkflows.delete(e);const r=this.workflows.get(e);r&&(r.status="idle"),mo.info(`Stopped workflow: ${e}`)}async cleanupRunningWorkflows(){mo.info("Cleaning up running workflows...");for(const e of this.runningWorkflows)await this.stopWorkflow(e);this.runningWorkflows.clear()}isWorkflowRunning(e){return this.runningWorkflows.has(e)}async updateDraft(e,r,n,i,o){const a=this.workflows.get(e);a&&(a.name=r,a.description=n,a.nodes=i,a.edges=o,a.status="draft",this.workflows.set(e,a),this.saveToStorage(),mo.info(`Updated draft: ${e}`))}}const Td=new wz;var Ez=Symbol.for("react.lazy"),og=MI[" use ".trim().toString()];function Cz(s){return typeof s=="object"&&s!==null&&"then"in s}function vT(s){return s!=null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===Ez&&"_payload"in s&&Cz(s._payload)}function Gb(s){const e=kz(s),r=S.forwardRef((n,i)=>{let{children:o,...a}=n;vT(o)&&typeof og=="function"&&(o=og(o._payload));const l=S.Children.toArray(o),d=l.find(Tz);if(d){const p=d.props.children,f=l.map(h=>h===d?S.Children.count(p)>1?S.Children.only(null):S.isValidElement(p)?p.props.children:null:h);return t.jsx(e,{...a,ref:i,children:S.isValidElement(p)?S.cloneElement(p,void 0,f):null})}return t.jsx(e,{...a,ref:i,children:o})});return r.displayName=`${s}.Slot`,r}var jz=Gb("Slot");function kz(s){const e=S.forwardRef((r,n)=>{let{children:i,...o}=r;if(vT(i)&&typeof og=="function"&&(i=og(i._payload)),S.isValidElement(i)){const a=Nz(i),l=Rz(o,i.props);return i.type!==S.Fragment&&(l.ref=n?kI(n,a):a),S.cloneElement(i,l)}return S.Children.count(i)>1?S.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var Az=Symbol("radix.slottable");function Tz(s){return S.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===Az}function Rz(s,e){const r={...e};for(const n in e){const i=s[n],o=e[n];/^on[A-Z]/.test(n)?i&&o?r[n]=(...l)=>{const d=o(...l);return i(...l),d}:i&&(r[n]=i):n==="style"?r[n]={...i,...o}:n==="className"&&(r[n]=[i,o].filter(Boolean).join(" "))}return{...s,...r}}function Nz(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}const FE=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,$E=oA,ST=(s,e)=>r=>{var n;if(e?.variants==null)return $E(s,r?.class,r?.className);const{variants:i,defaultVariants:o}=e,a=Object.keys(i).map(p=>{const f=r?.[p],h=o?.[p];if(f===null)return null;const x=FE(f)||FE(h);return i[p][x]}),l=r&&Object.entries(r).reduce((p,f)=>{let[h,x]=f;return x===void 0||(p[h]=x),p},{}),d=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((p,f)=>{let{class:h,className:x,...m}=f;return Object.entries(m).every(b=>{let[w,y]=b;return Array.isArray(y)?y.includes({...o,...l}[w]):{...o,...l}[w]===y})?[...p,h,x]:p},[]);return $E(s,a,d,r?.class,r?.className)},Oz=(s,e)=>{const r=new Array(s.length+e.length);for(let n=0;n<s.length;n++)r[n]=s[n];for(let n=0;n<e.length;n++)r[s.length+n]=e[n];return r},_z=(s,e)=>({classGroupId:s,validator:e}),wT=(s=new Map,e=null,r)=>({nextPart:s,validators:e,classGroupId:r}),ag="-",GE=[],Dz="arbitrary..",Iz=s=>{const e=Lz(s),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:a=>{if(a.startsWith("[")&&a.endsWith("]"))return Pz(a);const l=a.split(ag),d=l[0]===""&&l.length>1?1:0;return ET(l,d,e)},getConflictingClassGroupIds:(a,l)=>{if(l){const d=n[a],p=r[a];return d?p?Oz(p,d):d:p||GE}return r[a]||GE}}},ET=(s,e,r)=>{if(s.length-e===0)return r.classGroupId;const i=s[e],o=r.nextPart.get(i);if(o){const p=ET(s,e+1,o);if(p)return p}const a=r.validators;if(a===null)return;const l=e===0?s.join(ag):s.slice(e).join(ag),d=a.length;for(let p=0;p<d;p++){const f=a[p];if(f.validator(l))return f.classGroupId}},Pz=s=>s.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=s.slice(1,-1),r=e.indexOf(":"),n=e.slice(0,r);return n?Dz+n:void 0})(),Lz=s=>{const{theme:e,classGroups:r}=s;return zz(r,e)},zz=(s,e)=>{const r=wT();for(const n in s){const i=s[n];Ub(i,r,n,e)}return r},Ub=(s,e,r,n)=>{const i=s.length;for(let o=0;o<i;o++){const a=s[o];Mz(a,e,r,n)}},Mz=(s,e,r,n)=>{if(typeof s=="string"){Bz(s,e,r);return}if(typeof s=="function"){Fz(s,e,r,n);return}$z(s,e,r,n)},Bz=(s,e,r)=>{const n=s===""?e:CT(e,s);n.classGroupId=r},Fz=(s,e,r,n)=>{if(Gz(s)){Ub(s(n),e,r,n);return}e.validators===null&&(e.validators=[]),e.validators.push(_z(r,s))},$z=(s,e,r,n)=>{const i=Object.entries(s),o=i.length;for(let a=0;a<o;a++){const[l,d]=i[a];Ub(d,CT(e,l),r,n)}},CT=(s,e)=>{let r=s;const n=e.split(ag),i=n.length;for(let o=0;o<i;o++){const a=n[o];let l=r.nextPart.get(a);l||(l=wT(),r.nextPart.set(a,l)),r=l}return r},Gz=s=>"isThemeGetter"in s&&s.isThemeGetter===!0,Uz=s=>{if(s<1)return{get:()=>{},set:()=>{}};let e=0,r=Object.create(null),n=Object.create(null);const i=(o,a)=>{r[o]=a,e++,e>s&&(e=0,n=r,r=Object.create(null))};return{get(o){let a=r[o];if(a!==void 0)return a;if((a=n[o])!==void 0)return i(o,a),a},set(o,a){o in r?r[o]=a:i(o,a)}}},W0="!",UE=":",Wz=[],WE=(s,e,r,n,i)=>({modifiers:s,hasImportantModifier:e,baseClassName:r,maybePostfixModifierPosition:n,isExternal:i}),qz=s=>{const{prefix:e,experimentalParseClassName:r}=s;let n=i=>{const o=[];let a=0,l=0,d=0,p;const f=i.length;for(let w=0;w<f;w++){const y=i[w];if(a===0&&l===0){if(y===UE){o.push(i.slice(d,w)),d=w+1;continue}if(y==="/"){p=w;continue}}y==="["?a++:y==="]"?a--:y==="("?l++:y===")"&&l--}const h=o.length===0?i:i.slice(d);let x=h,m=!1;h.endsWith(W0)?(x=h.slice(0,-1),m=!0):h.startsWith(W0)&&(x=h.slice(1),m=!0);const b=p&&p>d?p-d:void 0;return WE(o,m,x,b)};if(e){const i=e+UE,o=n;n=a=>a.startsWith(i)?o(a.slice(i.length)):WE(Wz,!1,a,void 0,!0)}if(r){const i=n;n=o=>r({className:o,parseClassName:i})}return n},Hz=s=>{const e=new Map;return s.orderSensitiveModifiers.forEach((r,n)=>{e.set(r,1e6+n)}),r=>{const n=[];let i=[];for(let o=0;o<r.length;o++){const a=r[o],l=a[0]==="[",d=e.has(a);l||d?(i.length>0&&(i.sort(),n.push(...i),i=[]),n.push(a)):i.push(a)}return i.length>0&&(i.sort(),n.push(...i)),n}},Yz=s=>({cache:Uz(s.cacheSize),parseClassName:qz(s),sortModifiers:Hz(s),...Iz(s)}),Kz=/\s+/,Vz=(s,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i,sortModifiers:o}=e,a=[],l=s.trim().split(Kz);let d="";for(let p=l.length-1;p>=0;p-=1){const f=l[p],{isExternal:h,modifiers:x,hasImportantModifier:m,baseClassName:b,maybePostfixModifierPosition:w}=r(f);if(h){d=f+(d.length>0?" "+d:d);continue}let y=!!w,C=n(y?b.substring(0,w):b);if(!C){if(!y){d=f+(d.length>0?" "+d:d);continue}if(C=n(b),!C){d=f+(d.length>0?" "+d:d);continue}y=!1}const T=x.length===0?"":x.length===1?x[0]:o(x).join(":"),E=m?T+W0:T,j=E+C;if(a.indexOf(j)>-1)continue;a.push(j);const k=i(C,y);for(let A=0;A<k.length;++A){const R=k[A];a.push(E+R)}d=f+(d.length>0?" "+d:d)}return d},Xz=(...s)=>{let e=0,r,n,i="";for(;e<s.length;)(r=s[e++])&&(n=jT(r))&&(i&&(i+=" "),i+=n);return i},jT=s=>{if(typeof s=="string")return s;let e,r="";for(let n=0;n<s.length;n++)s[n]&&(e=jT(s[n]))&&(r&&(r+=" "),r+=e);return r},Jz=(s,...e)=>{let r,n,i,o;const a=d=>{const p=e.reduce((f,h)=>h(f),s());return r=Yz(p),n=r.cache.get,i=r.cache.set,o=l,l(d)},l=d=>{const p=n(d);if(p)return p;const f=Vz(d,r);return i(d,f),f};return o=a,(...d)=>o(Xz(...d))},Qz=[],hs=s=>{const e=r=>r[s]||Qz;return e.isThemeGetter=!0,e},kT=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,AT=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Zz=/^\d+\/\d+$/,eM=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,tM=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,rM=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,nM=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,sM=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ed=s=>Zz.test(s),fr=s=>!!s&&!Number.isNaN(Number(s)),Ja=s=>!!s&&Number.isInteger(Number(s)),Dy=s=>s.endsWith("%")&&fr(s.slice(0,-1)),ga=s=>eM.test(s),iM=()=>!0,oM=s=>tM.test(s)&&!rM.test(s),TT=()=>!1,aM=s=>nM.test(s),lM=s=>sM.test(s),cM=s=>!Bt(s)&&!Ft(s),dM=s=>Ud(s,OT,TT),Bt=s=>kT.test(s),Yl=s=>Ud(s,_T,oM),Iy=s=>Ud(s,gM,fr),qE=s=>Ud(s,RT,TT),uM=s=>Ud(s,NT,lM),ff=s=>Ud(s,DT,aM),Ft=s=>AT.test(s),Hu=s=>Wd(s,_T),pM=s=>Wd(s,xM),HE=s=>Wd(s,RT),hM=s=>Wd(s,OT),fM=s=>Wd(s,NT),gf=s=>Wd(s,DT,!0),Ud=(s,e,r)=>{const n=kT.exec(s);return n?n[1]?e(n[1]):r(n[2]):!1},Wd=(s,e,r=!1)=>{const n=AT.exec(s);return n?n[1]?e(n[1]):r:!1},RT=s=>s==="position"||s==="percentage",NT=s=>s==="image"||s==="url",OT=s=>s==="length"||s==="size"||s==="bg-size",_T=s=>s==="length",gM=s=>s==="number",xM=s=>s==="family-name",DT=s=>s==="shadow",mM=()=>{const s=hs("color"),e=hs("font"),r=hs("text"),n=hs("font-weight"),i=hs("tracking"),o=hs("leading"),a=hs("breakpoint"),l=hs("container"),d=hs("spacing"),p=hs("radius"),f=hs("shadow"),h=hs("inset-shadow"),x=hs("text-shadow"),m=hs("drop-shadow"),b=hs("blur"),w=hs("perspective"),y=hs("aspect"),C=hs("ease"),T=hs("animate"),E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],j=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...j(),Ft,Bt],A=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto","contain","none"],M=()=>[Ft,Bt,d],P=()=>[ed,"full","auto",...M()],I=()=>[Ja,"none","subgrid",Ft,Bt],O=()=>["auto",{span:["full",Ja,Ft,Bt]},Ja,Ft,Bt],G=()=>[Ja,"auto",Ft,Bt],B=()=>["auto","min","max","fr",Ft,Bt],F=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],z=()=>["start","end","center","stretch","center-safe","end-safe"],$=()=>["auto",...M()],W=()=>[ed,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...M()],D=()=>[s,Ft,Bt],oe=()=>[...j(),HE,qE,{position:[Ft,Bt]}],Z=()=>["no-repeat",{repeat:["","x","y","space","round"]}],fe=()=>["auto","cover","contain",hM,dM,{size:[Ft,Bt]}],Q=()=>[Dy,Hu,Yl],_=()=>["","none","full",p,Ft,Bt],Y=()=>["",fr,Hu,Yl],he=()=>["solid","dashed","dotted","double"],me=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ge=()=>[fr,Dy,HE,qE],le=()=>["","none",b,Ft,Bt],X=()=>["none",fr,Ft,Bt],V=()=>["none",fr,Ft,Bt],de=()=>[fr,Ft,Bt],je=()=>[ed,"full",...M()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ga],breakpoint:[ga],color:[iM],container:[ga],"drop-shadow":[ga],ease:["in","out","in-out"],font:[cM],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ga],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ga],shadow:[ga],spacing:["px",fr],text:[ga],"text-shadow":[ga],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ed,Bt,Ft,y]}],container:["container"],columns:[{columns:[fr,Bt,Ft,l]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:P()}],"inset-x":[{"inset-x":P()}],"inset-y":[{"inset-y":P()}],start:[{start:P()}],end:[{end:P()}],top:[{top:P()}],right:[{right:P()}],bottom:[{bottom:P()}],left:[{left:P()}],visibility:["visible","invisible","collapse"],z:[{z:[Ja,"auto",Ft,Bt]}],basis:[{basis:[ed,"full","auto",l,...M()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[fr,ed,"auto","initial","none",Bt]}],grow:[{grow:["",fr,Ft,Bt]}],shrink:[{shrink:["",fr,Ft,Bt]}],order:[{order:[Ja,"first","last","none",Ft,Bt]}],"grid-cols":[{"grid-cols":I()}],"col-start-end":[{col:O()}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":I()}],"row-start-end":[{row:O()}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":B()}],"auto-rows":[{"auto-rows":B()}],gap:[{gap:M()}],"gap-x":[{"gap-x":M()}],"gap-y":[{"gap-y":M()}],"justify-content":[{justify:[...F(),"normal"]}],"justify-items":[{"justify-items":[...z(),"normal"]}],"justify-self":[{"justify-self":["auto",...z()]}],"align-content":[{content:["normal",...F()]}],"align-items":[{items:[...z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...z(),{baseline:["","last"]}]}],"place-content":[{"place-content":F()}],"place-items":[{"place-items":[...z(),"baseline"]}],"place-self":[{"place-self":["auto",...z()]}],p:[{p:M()}],px:[{px:M()}],py:[{py:M()}],ps:[{ps:M()}],pe:[{pe:M()}],pt:[{pt:M()}],pr:[{pr:M()}],pb:[{pb:M()}],pl:[{pl:M()}],m:[{m:$()}],mx:[{mx:$()}],my:[{my:$()}],ms:[{ms:$()}],me:[{me:$()}],mt:[{mt:$()}],mr:[{mr:$()}],mb:[{mb:$()}],ml:[{ml:$()}],"space-x":[{"space-x":M()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":M()}],"space-y-reverse":["space-y-reverse"],size:[{size:W()}],w:[{w:[l,"screen",...W()]}],"min-w":[{"min-w":[l,"screen","none",...W()]}],"max-w":[{"max-w":[l,"screen","none","prose",{screen:[a]},...W()]}],h:[{h:["screen","lh",...W()]}],"min-h":[{"min-h":["screen","lh","none",...W()]}],"max-h":[{"max-h":["screen","lh",...W()]}],"font-size":[{text:["base",r,Hu,Yl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Ft,Iy]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Dy,Bt]}],"font-family":[{font:[pM,Bt,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,Ft,Bt]}],"line-clamp":[{"line-clamp":[fr,"none",Ft,Iy]}],leading:[{leading:[o,...M()]}],"list-image":[{"list-image":["none",Ft,Bt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ft,Bt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:D()}],"text-color":[{text:D()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...he(),"wavy"]}],"text-decoration-thickness":[{decoration:[fr,"from-font","auto",Ft,Yl]}],"text-decoration-color":[{decoration:D()}],"underline-offset":[{"underline-offset":[fr,"auto",Ft,Bt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ft,Bt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ft,Bt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:oe()}],"bg-repeat":[{bg:Z()}],"bg-size":[{bg:fe()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ja,Ft,Bt],radial:["",Ft,Bt],conic:[Ja,Ft,Bt]},fM,uM]}],"bg-color":[{bg:D()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:D()}],"gradient-via":[{via:D()}],"gradient-to":[{to:D()}],rounded:[{rounded:_()}],"rounded-s":[{"rounded-s":_()}],"rounded-e":[{"rounded-e":_()}],"rounded-t":[{"rounded-t":_()}],"rounded-r":[{"rounded-r":_()}],"rounded-b":[{"rounded-b":_()}],"rounded-l":[{"rounded-l":_()}],"rounded-ss":[{"rounded-ss":_()}],"rounded-se":[{"rounded-se":_()}],"rounded-ee":[{"rounded-ee":_()}],"rounded-es":[{"rounded-es":_()}],"rounded-tl":[{"rounded-tl":_()}],"rounded-tr":[{"rounded-tr":_()}],"rounded-br":[{"rounded-br":_()}],"rounded-bl":[{"rounded-bl":_()}],"border-w":[{border:Y()}],"border-w-x":[{"border-x":Y()}],"border-w-y":[{"border-y":Y()}],"border-w-s":[{"border-s":Y()}],"border-w-e":[{"border-e":Y()}],"border-w-t":[{"border-t":Y()}],"border-w-r":[{"border-r":Y()}],"border-w-b":[{"border-b":Y()}],"border-w-l":[{"border-l":Y()}],"divide-x":[{"divide-x":Y()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Y()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...he(),"hidden","none"]}],"divide-style":[{divide:[...he(),"hidden","none"]}],"border-color":[{border:D()}],"border-color-x":[{"border-x":D()}],"border-color-y":[{"border-y":D()}],"border-color-s":[{"border-s":D()}],"border-color-e":[{"border-e":D()}],"border-color-t":[{"border-t":D()}],"border-color-r":[{"border-r":D()}],"border-color-b":[{"border-b":D()}],"border-color-l":[{"border-l":D()}],"divide-color":[{divide:D()}],"outline-style":[{outline:[...he(),"none","hidden"]}],"outline-offset":[{"outline-offset":[fr,Ft,Bt]}],"outline-w":[{outline:["",fr,Hu,Yl]}],"outline-color":[{outline:D()}],shadow:[{shadow:["","none",f,gf,ff]}],"shadow-color":[{shadow:D()}],"inset-shadow":[{"inset-shadow":["none",h,gf,ff]}],"inset-shadow-color":[{"inset-shadow":D()}],"ring-w":[{ring:Y()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:D()}],"ring-offset-w":[{"ring-offset":[fr,Yl]}],"ring-offset-color":[{"ring-offset":D()}],"inset-ring-w":[{"inset-ring":Y()}],"inset-ring-color":[{"inset-ring":D()}],"text-shadow":[{"text-shadow":["none",x,gf,ff]}],"text-shadow-color":[{"text-shadow":D()}],opacity:[{opacity:[fr,Ft,Bt]}],"mix-blend":[{"mix-blend":[...me(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":me()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[fr]}],"mask-image-linear-from-pos":[{"mask-linear-from":ge()}],"mask-image-linear-to-pos":[{"mask-linear-to":ge()}],"mask-image-linear-from-color":[{"mask-linear-from":D()}],"mask-image-linear-to-color":[{"mask-linear-to":D()}],"mask-image-t-from-pos":[{"mask-t-from":ge()}],"mask-image-t-to-pos":[{"mask-t-to":ge()}],"mask-image-t-from-color":[{"mask-t-from":D()}],"mask-image-t-to-color":[{"mask-t-to":D()}],"mask-image-r-from-pos":[{"mask-r-from":ge()}],"mask-image-r-to-pos":[{"mask-r-to":ge()}],"mask-image-r-from-color":[{"mask-r-from":D()}],"mask-image-r-to-color":[{"mask-r-to":D()}],"mask-image-b-from-pos":[{"mask-b-from":ge()}],"mask-image-b-to-pos":[{"mask-b-to":ge()}],"mask-image-b-from-color":[{"mask-b-from":D()}],"mask-image-b-to-color":[{"mask-b-to":D()}],"mask-image-l-from-pos":[{"mask-l-from":ge()}],"mask-image-l-to-pos":[{"mask-l-to":ge()}],"mask-image-l-from-color":[{"mask-l-from":D()}],"mask-image-l-to-color":[{"mask-l-to":D()}],"mask-image-x-from-pos":[{"mask-x-from":ge()}],"mask-image-x-to-pos":[{"mask-x-to":ge()}],"mask-image-x-from-color":[{"mask-x-from":D()}],"mask-image-x-to-color":[{"mask-x-to":D()}],"mask-image-y-from-pos":[{"mask-y-from":ge()}],"mask-image-y-to-pos":[{"mask-y-to":ge()}],"mask-image-y-from-color":[{"mask-y-from":D()}],"mask-image-y-to-color":[{"mask-y-to":D()}],"mask-image-radial":[{"mask-radial":[Ft,Bt]}],"mask-image-radial-from-pos":[{"mask-radial-from":ge()}],"mask-image-radial-to-pos":[{"mask-radial-to":ge()}],"mask-image-radial-from-color":[{"mask-radial-from":D()}],"mask-image-radial-to-color":[{"mask-radial-to":D()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":j()}],"mask-image-conic-pos":[{"mask-conic":[fr]}],"mask-image-conic-from-pos":[{"mask-conic-from":ge()}],"mask-image-conic-to-pos":[{"mask-conic-to":ge()}],"mask-image-conic-from-color":[{"mask-conic-from":D()}],"mask-image-conic-to-color":[{"mask-conic-to":D()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:oe()}],"mask-repeat":[{mask:Z()}],"mask-size":[{mask:fe()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ft,Bt]}],filter:[{filter:["","none",Ft,Bt]}],blur:[{blur:le()}],brightness:[{brightness:[fr,Ft,Bt]}],contrast:[{contrast:[fr,Ft,Bt]}],"drop-shadow":[{"drop-shadow":["","none",m,gf,ff]}],"drop-shadow-color":[{"drop-shadow":D()}],grayscale:[{grayscale:["",fr,Ft,Bt]}],"hue-rotate":[{"hue-rotate":[fr,Ft,Bt]}],invert:[{invert:["",fr,Ft,Bt]}],saturate:[{saturate:[fr,Ft,Bt]}],sepia:[{sepia:["",fr,Ft,Bt]}],"backdrop-filter":[{"backdrop-filter":["","none",Ft,Bt]}],"backdrop-blur":[{"backdrop-blur":le()}],"backdrop-brightness":[{"backdrop-brightness":[fr,Ft,Bt]}],"backdrop-contrast":[{"backdrop-contrast":[fr,Ft,Bt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",fr,Ft,Bt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[fr,Ft,Bt]}],"backdrop-invert":[{"backdrop-invert":["",fr,Ft,Bt]}],"backdrop-opacity":[{"backdrop-opacity":[fr,Ft,Bt]}],"backdrop-saturate":[{"backdrop-saturate":[fr,Ft,Bt]}],"backdrop-sepia":[{"backdrop-sepia":["",fr,Ft,Bt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":M()}],"border-spacing-x":[{"border-spacing-x":M()}],"border-spacing-y":[{"border-spacing-y":M()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ft,Bt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[fr,"initial",Ft,Bt]}],ease:[{ease:["linear","initial",C,Ft,Bt]}],delay:[{delay:[fr,Ft,Bt]}],animate:[{animate:["none",T,Ft,Bt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,Ft,Bt]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:X()}],"rotate-x":[{"rotate-x":X()}],"rotate-y":[{"rotate-y":X()}],"rotate-z":[{"rotate-z":X()}],scale:[{scale:V()}],"scale-x":[{"scale-x":V()}],"scale-y":[{"scale-y":V()}],"scale-z":[{"scale-z":V()}],"scale-3d":["scale-3d"],skew:[{skew:de()}],"skew-x":[{"skew-x":de()}],"skew-y":[{"skew-y":de()}],transform:[{transform:[Ft,Bt,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:je()}],"translate-x":[{"translate-x":je()}],"translate-y":[{"translate-y":je()}],"translate-z":[{"translate-z":je()}],"translate-none":["translate-none"],accent:[{accent:D()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:D()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ft,Bt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ft,Bt]}],fill:[{fill:["none",...D()]}],"stroke-w":[{stroke:[fr,Hu,Yl,Iy]}],stroke:[{stroke:["none",...D()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},yM=Jz(mM);function Bs(...s){return yM(oA(s))}const bM=ST("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Tr({className:s,variant:e,size:r,asChild:n=!1,...i}){const o=n?jz:"button";return t.jsx(o,{"data-slot":"button",className:Bs(bM({variant:e,size:r,className:s})),...i})}function ei({className:s,type:e,...r}){return t.jsx("input",{type:e,"data-slot":"input",className:Bs("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...r})}var vM=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],SM=vM.reduce((s,e)=>{const r=Gb(`Primitive.${e}`),n=S.forwardRef((i,o)=>{const{asChild:a,...l}=i,d=a?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(d,{...l,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{}),wM="Label",IT=S.forwardRef((s,e)=>t.jsx(SM.label,{...s,ref:e,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(s.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));IT.displayName=wM;var EM=IT;function gi({className:s,...e}){return t.jsx(EM,{"data-slot":"label",className:Bs("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...e})}const CM=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jM=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),YE=s=>{const e=jM(s);return e.charAt(0).toUpperCase()+e.slice(1)},PT=(...s)=>s.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),kM=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var AM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const TM=S.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:a,...l},d)=>S.createElement("svg",{ref:d,...AM,width:e,height:e,stroke:s,strokeWidth:n?Number(r)*24/Number(e):r,className:PT("lucide",i),...!o&&!kM(l)&&{"aria-hidden":"true"},...l},[...a.map(([p,f])=>S.createElement(p,f)),...Array.isArray(o)?o:[o]]));const ht=(s,e)=>{const r=S.forwardRef(({className:n,...i},o)=>S.createElement(TM,{ref:o,iconNode:e,className:PT(`lucide-${CM(YE(s))}`,`lucide-${s}`,n),...i}));return r.displayName=YE(s),r};const RM=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Cs=ht("activity",RM);const NM=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],OM=ht("arrow-down",NM);const _M=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ks=ht("arrow-left",_M);const DM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],lg=ht("arrow-right",DM);const IM=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],KE=ht("arrow-up-right",IM);const PM=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],LM=ht("arrow-up",PM);const zM=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],MM=ht("award",zM);const BM=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Py=ht("bell",BM);const FM=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],$M=ht("bold",FM);const GM=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],LT=ht("book-open",GM);const UM=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],WM=ht("bookmark",UM);const qM=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],xi=ht("bot",qM);const HM=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],qo=ht("brain",HM);const YM=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],KM=ht("briefcase",YM);const VM=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],XM=ht("building",VM);const JM=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],zT=ht("calculator",JM);const QM=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ja=ht("chart-column",QM);const ZM=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Jg=ht("chart-pie",ZM);const e4=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Es=ht("check",e4);const t4=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],bi=ht("chevron-down",t4);const r4=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Rd=ht("chevron-right",r4);const n4=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Hp=ht("chevron-up",n4);const s4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Rr=ht("circle-alert",s4);const i4=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Bn=ht("circle-check-big",i4);const o4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],MT=ht("circle-check",o4);const a4=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],l4=ht("circle-play",a4);const c4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],d4=ht("circle-question-mark",c4);const u4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],BT=ht("circle-stop",u4);const p4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Rp=ht("circle-x",p4);const h4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],cg=ht("circle",h4);const f4=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],uo=ht("clock",f4);const g4=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],x4=ht("cloud",g4);const m4=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Yp=ht("code",m4);const y4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],b4=ht("columns-2",y4);const v4=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],hc=ht("copy",v4);const S4=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],FT=ht("credit-card",S4);const w4=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],E4=ht("crown",w4);const C4=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],js=ht("database",C4);const j4=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],wl=ht("dollar-sign",j4);const k4=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Mi=ht("download",k4);const A4=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Nd=ht("external-link",A4);const T4=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],cc=ht("eye-off",T4);const R4=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vi=ht("eye",R4);const N4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],O4=ht("file-json",N4);const _4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ri=ht("file-text",_4);const D4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]],I4=ht("file-x",D4);const P4=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],VE=ht("folder-open",P4);const L4=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],XE=ht("folder-tree",L4);const z4=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],M4=ht("folder",z4);const B4=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],F4=ht("funnel",B4);const $4=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],xf=ht("git-branch",$4);const G4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],fc=ht("globe",G4);const U4=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],W4=ht("grip-vertical",U4);const q4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],JE=ht("history",q4);const H4=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],q0=ht("image",H4);const Y4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],dg=ht("info",Y4);const K4=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],V4=ht("italic",K4);const X4=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Wb=ht("key",X4);const J4=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Q4=ht("layout-grid",J4);const Z4=[["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"M3 10a2 2 0 0 0 2 2h3",key:"1npucw"}],["path",{d:"M3 5v12a2 2 0 0 0 2 2h3",key:"x1gjn2"}]],eB=ht("list-tree",Z4);const tB=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],rB=ht("list",tB);const nB=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Hs=ht("loader-circle",nB);const sB=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],ni=ht("loader",sB);const iB=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Np=ht("lock",iB);const oB=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],QE=ht("log-out",oB);const aB=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gc=ht("mail",aB);const lB=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],cB=ht("map-pin",lB);const dB=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],uB=ht("maximize-2",dB);const pB=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],ZE=ht("maximize",pB);const hB=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Qg=ht("message-square",hB);const fB=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],eC=ht("minimize",fB);const gB=[["path",{d:"M5 12h14",key:"1ays0h"}]],Op=ht("minus",gB);const xB=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],mB=ht("monitor",xB);const yB=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],bB=ht("move",yB);const vB=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],SB=ht("newspaper",vB);const wB=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],qb=ht("package",wB);const EB=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],CB=ht("palette",EB);const jB=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],kB=ht("panels-top-left",jB);const AB=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],TB=ht("pause",AB);const RB=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Od=ht("pen-line",RB);const NB=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ug=ht("pen",NB);const OB=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],pg=ht("phone",OB);const _B=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Ms=ht("play",_B);const DB=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],wn=ht("plus",DB);const IB=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],PB=ht("power-off",IB);const LB=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],$T=ht("power",LB);const zB=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],xn=ht("refresh-cw",zB);const MB=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],H0=ht("rocket",MB);const BB=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],GT=ht("rotate-ccw",BB);const FB=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],Kl=ht("ruler",FB);const $B=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ao=ht("save",$B);const GB=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ho=ht("search",GB);const UB=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Zg=ht("send",UB);const WB=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Mn=ht("settings",WB);const qB=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],HB=ht("settings-2",qB);const YB=[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]],KB=ht("share",YB);const VB=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],jo=ht("shield",VB);const XB=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],JB=ht("shopping-cart",XB);const QB=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],_d=ht("sparkles",QB);const ZB=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],xc=ht("square",ZB);const e3=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Y0=ht("star",e3);const t3=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],UT=ht("table",t3);const r3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ka=ht("target",r3);const n3=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],dc=ht("terminal",n3);const s3=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],WT=ht("text-align-start",s3);const i3=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],On=ht("trash-2",i3);const o3=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Dd=ht("trending-down",o3);const a3=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Nr=ht("trending-up",a3);const l3=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Cl=ht("triangle-alert",l3);const c3=[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]],d3=ht("triangle",c3);const u3=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],K0=ht("trophy",u3);const p3=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Sd=ht("type",p3);const h3=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],f3=ht("undo-2",h3);const g3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],qT=ht("upload",g3);const x3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Kp=ht("user",x3);const m3=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Hb=ht("wallet",m3);const y3=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],tC=ht("wand-sparkles",y3);const b3=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],v3=ht("wifi-off",b3);const S3=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Yb=ht("wifi",S3);const w3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ln=ht("x",w3);const E3=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],si=ht("zap",E3),nr=s=>typeof s=="string",Yu=()=>{let s,e;const r=new Promise((n,i)=>{s=n,e=i});return r.resolve=s,r.reject=e,r},rC=s=>s==null?"":""+s,C3=(s,e,r)=>{s.forEach(n=>{e[n]&&(r[n]=e[n])})},j3=/###/g,nC=s=>s&&s.indexOf("###")>-1?s.replace(j3,"."):s,sC=s=>!s||nr(s),yp=(s,e,r)=>{const n=nr(e)?e.split("."):e;let i=0;for(;i<n.length-1;){if(sC(s))return{};const o=nC(n[i]);!s[o]&&r&&(s[o]=new r),Object.prototype.hasOwnProperty.call(s,o)?s=s[o]:s={},++i}return sC(s)?{}:{obj:s,k:nC(n[i])}},iC=(s,e,r)=>{const{obj:n,k:i}=yp(s,e,Object);if(n!==void 0||e.length===1){n[i]=r;return}let o=e[e.length-1],a=e.slice(0,e.length-1),l=yp(s,a,Object);for(;l.obj===void 0&&a.length;)o=`${a[a.length-1]}.${o}`,a=a.slice(0,a.length-1),l=yp(s,a,Object),l?.obj&&typeof l.obj[`${l.k}.${o}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${o}`]=r},k3=(s,e,r,n)=>{const{obj:i,k:o}=yp(s,e,Object);i[o]=i[o]||[],i[o].push(r)},hg=(s,e)=>{const{obj:r,k:n}=yp(s,e);if(r&&Object.prototype.hasOwnProperty.call(r,n))return r[n]},A3=(s,e,r)=>{const n=hg(s,r);return n!==void 0?n:hg(e,r)},HT=(s,e,r)=>{for(const n in e)n!=="__proto__"&&n!=="constructor"&&(n in s?nr(s[n])||s[n]instanceof String||nr(e[n])||e[n]instanceof String?r&&(s[n]=e[n]):HT(s[n],e[n],r):s[n]=e[n]);return s},td=s=>s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var T3={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const R3=s=>nr(s)?s.replace(/[&<>"'\/]/g,e=>T3[e]):s;class N3{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const r=this.regExpMap.get(e);if(r!==void 0)return r;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}const O3=[" ",",","?","!",";"],_3=new N3(20),D3=(s,e,r)=>{e=e||"",r=r||"";const n=O3.filter(a=>e.indexOf(a)<0&&r.indexOf(a)<0);if(n.length===0)return!0;const i=_3.getRegExp(`(${n.map(a=>a==="?"?"\\?":a).join("|")})`);let o=!i.test(s);if(!o){const a=s.indexOf(r);a>0&&!i.test(s.substring(0,a))&&(o=!0)}return o},V0=(s,e,r=".")=>{if(!s)return;if(s[e])return Object.prototype.hasOwnProperty.call(s,e)?s[e]:void 0;const n=e.split(r);let i=s;for(let o=0;o<n.length;){if(!i||typeof i!="object")return;let a,l="";for(let d=o;d<n.length;++d)if(d!==o&&(l+=r),l+=n[d],a=i[l],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&d<n.length-1)continue;o+=d-o+1;break}i=a}return i},_p=s=>s?.replace("_","-"),I3={type:"logger",log(s){this.output("log",s)},warn(s){this.output("warn",s)},error(s){this.output("error",s)},output(s,e){console?.[s]?.apply?.(console,e)}};class fg{constructor(e,r={}){this.init(e,r)}init(e,r={}){this.prefix=r.prefix||"i18next:",this.logger=e||I3,this.options=r,this.debug=r.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,r,n,i){return i&&!this.debug?null:(nr(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[r](e))}create(e){return new fg(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new fg(this.logger,e)}}var Wo=new fg;class ex{constructor(){this.observers={}}on(e,r){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const i=this.observers[n].get(r)||0;this.observers[n].set(r,i+1)}),this}off(e,r){if(this.observers[e]){if(!r){delete this.observers[e];return}this.observers[e].delete(r)}}emit(e,...r){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([i,o])=>{for(let a=0;a<o;a++)i(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([i,o])=>{for(let a=0;a<o;a++)i.apply(i,[e,...r])})}}class oC extends ex{constructor(e,r={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const r=this.options.ns.indexOf(e);r>-1&&this.options.ns.splice(r,1)}getResource(e,r,n,i={}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,a=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,r],n&&(Array.isArray(n)?l.push(...n):nr(n)&&o?l.push(...n.split(o)):l.push(n)));const d=hg(this.data,l);return!d&&!r&&!n&&e.indexOf(".")>-1&&(e=l[0],r=l[1],n=l.slice(2).join(".")),d||!a||!nr(n)?d:V0(this.data?.[e]?.[r],n,o)}addResource(e,r,n,i,o={silent:!1}){const a=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator;let l=[e,r];n&&(l=l.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(l=e.split("."),i=r,r=l[1]),this.addNamespaces(r),iC(this.data,l,i),o.silent||this.emit("added",e,r,n,i)}addResources(e,r,n,i={silent:!1}){for(const o in n)(nr(n[o])||Array.isArray(n[o]))&&this.addResource(e,r,o,n[o],{silent:!0});i.silent||this.emit("added",e,r,n)}addResourceBundle(e,r,n,i,o,a={silent:!1,skipCopy:!1}){let l=[e,r];e.indexOf(".")>-1&&(l=e.split("."),i=n,n=r,r=l[1]),this.addNamespaces(r);let d=hg(this.data,l)||{};a.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?HT(d,n,o):d={...d,...n},iC(this.data,l,d),a.silent||this.emit("added",e,r,n)}removeResourceBundle(e,r){this.hasResourceBundle(e,r)&&delete this.data[e][r],this.removeNamespaces(r),this.emit("removed",e,r)}hasResourceBundle(e,r){return this.getResource(e,r)!==void 0}getResourceBundle(e,r){return r||(r=this.options.defaultNS),this.getResource(e,r)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const r=this.getDataByLanguage(e);return!!(r&&Object.keys(r)||[]).find(i=>r[i]&&Object.keys(r[i]).length>0)}toJSON(){return this.data}}var YT={processors:{},addPostProcessor(s){this.processors[s.name]=s},handle(s,e,r,n,i){return s.forEach(o=>{e=this.processors[o]?.process(e,r,n,i)??e}),e}};const KT=Symbol("i18next/PATH_KEY");function P3(){const s=[],e=Object.create(null);let r;return e.get=(n,i)=>(r?.revoke?.(),i===KT?s:(s.push(i),r=Proxy.revocable(n,e),r.proxy)),Proxy.revocable(Object.create(null),e).proxy}function X0(s,e){const{[KT]:r}=s(P3());return r.join(e?.keySeparator??".")}const aC={},Ly=s=>!nr(s)&&typeof s!="boolean"&&typeof s!="number";class gg extends ex{constructor(e,r={}){super(),C3(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Wo.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,r={interpolation:{}}){const n={...r};if(e==null)return!1;const i=this.resolve(e,n);if(i?.res===void 0)return!1;const o=Ly(i.res);return!(n.returnObjects===!1&&o)}extractFromKey(e,r){let n=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const i=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let o=r.ns||this.options.defaultNS||[];const a=n&&e.indexOf(n)>-1,l=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!D3(e,n,i);if(a&&!l){const d=e.match(this.interpolator.nestingRegexp);if(d&&d.length>0)return{key:e,namespaces:nr(o)?[o]:o};const p=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(p[0])>-1)&&(o=p.shift()),e=p.join(i)}return{key:e,namespaces:nr(o)?[o]:o}}translate(e,r,n){let i=typeof r=="object"?{...r}:r;if(typeof i!="object"&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),typeof i=="object"&&(i={...i}),i||(i={}),e==null)return"";typeof e=="function"&&(e=X0(e,{...this.options,...i})),Array.isArray(e)||(e=[String(e)]);const o=i.returnDetails!==void 0?i.returnDetails:this.options.returnDetails,a=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,{key:l,namespaces:d}=this.extractFromKey(e[e.length-1],i),p=d[d.length-1];let f=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;f===void 0&&(f=":");const h=i.lng||this.language,x=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(h?.toLowerCase()==="cimode")return x?o?{res:`${p}${f}${l}`,usedKey:l,exactUsedKey:l,usedLng:h,usedNS:p,usedParams:this.getUsedParamsDetails(i)}:`${p}${f}${l}`:o?{res:l,usedKey:l,exactUsedKey:l,usedLng:h,usedNS:p,usedParams:this.getUsedParamsDetails(i)}:l;const m=this.resolve(e,i);let b=m?.res;const w=m?.usedKey||l,y=m?.exactUsedKey||l,C=["[object Number]","[object Function]","[object RegExp]"],T=i.joinArrays!==void 0?i.joinArrays:this.options.joinArrays,E=!this.i18nFormat||this.i18nFormat.handleAsObject,j=i.count!==void 0&&!nr(i.count),k=gg.hasDefaultValue(i),A=j?this.pluralResolver.getSuffix(h,i.count,i):"",R=i.ordinal&&j?this.pluralResolver.getSuffix(h,i.count,{ordinal:!1}):"",M=j&&!i.ordinal&&i.count===0,P=M&&i[`defaultValue${this.options.pluralSeparator}zero`]||i[`defaultValue${A}`]||i[`defaultValue${R}`]||i.defaultValue;let I=b;E&&!b&&k&&(I=P);const O=Ly(I),G=Object.prototype.toString.apply(I);if(E&&I&&O&&C.indexOf(G)<0&&!(nr(T)&&Array.isArray(I))){if(!i.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const B=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,I,{...i,ns:d}):`key '${l} (${this.language})' returned an object instead of string.`;return o?(m.res=B,m.usedParams=this.getUsedParamsDetails(i),m):B}if(a){const B=Array.isArray(I),F=B?[]:{},z=B?y:w;for(const $ in I)if(Object.prototype.hasOwnProperty.call(I,$)){const W=`${z}${a}${$}`;k&&!b?F[$]=this.translate(W,{...i,defaultValue:Ly(P)?P[$]:void 0,joinArrays:!1,ns:d}):F[$]=this.translate(W,{...i,joinArrays:!1,ns:d}),F[$]===W&&(F[$]=I[$])}b=F}}else if(E&&nr(T)&&Array.isArray(b))b=b.join(T),b&&(b=this.extendTranslation(b,e,i,n));else{let B=!1,F=!1;!this.isValidLookup(b)&&k&&(B=!0,b=P),this.isValidLookup(b)||(F=!0,b=l);const $=(i.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&F?void 0:b,W=k&&P!==b&&this.options.updateMissing;if(F||B||W){if(this.logger.log(W?"updateKey":"missingKey",h,p,l,W?P:b),a){const fe=this.resolve(l,{...i,keySeparator:!1});fe&&fe.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let D=[];const oe=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if(this.options.saveMissingTo==="fallback"&&oe&&oe[0])for(let fe=0;fe<oe.length;fe++)D.push(oe[fe]);else this.options.saveMissingTo==="all"?D=this.languageUtils.toResolveHierarchy(i.lng||this.language):D.push(i.lng||this.language);const Z=(fe,Q,_)=>{const Y=k&&_!==b?_:$;this.options.missingKeyHandler?this.options.missingKeyHandler(fe,p,Q,Y,W,i):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(fe,p,Q,Y,W,i),this.emit("missingKey",fe,p,Q,b)};this.options.saveMissing&&(this.options.saveMissingPlurals&&j?D.forEach(fe=>{const Q=this.pluralResolver.getSuffixes(fe,i);M&&i[`defaultValue${this.options.pluralSeparator}zero`]&&Q.indexOf(`${this.options.pluralSeparator}zero`)<0&&Q.push(`${this.options.pluralSeparator}zero`),Q.forEach(_=>{Z([fe],l+_,i[`defaultValue${_}`]||P)})}):Z(D,l,P))}b=this.extendTranslation(b,e,i,m,n),F&&b===l&&this.options.appendNamespaceToMissingKey&&(b=`${p}${f}${l}`),(F||B)&&this.options.parseMissingKeyHandler&&(b=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${p}${f}${l}`:l,B?b:void 0,i))}return o?(m.res=b,m.usedParams=this.getUsedParamsDetails(i),m):b}extendTranslation(e,r,n,i,o){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const d=nr(e)&&(n?.interpolation?.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let p;if(d){const h=e.match(this.interpolator.nestingRegexp);p=h&&h.length}let f=n.replace&&!nr(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),e=this.interpolator.interpolate(e,f,n.lng||this.language||i.usedLng,n),d){const h=e.match(this.interpolator.nestingRegexp),x=h&&h.length;p<x&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,(...h)=>o?.[0]===h[0]&&!n.context?(this.logger.warn(`It seems you are nesting recursively key: ${h[0]} in key: ${r[0]}`),null):this.translate(...h,r),n)),n.interpolation&&this.interpolator.reset()}const a=n.postProcess||this.options.postProcess,l=nr(a)?[a]:a;return e!=null&&l?.length&&n.applyPostProcessor!==!1&&(e=YT.handle(l,e,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,r={}){let n,i,o,a,l;return nr(e)&&(e=[e]),e.forEach(d=>{if(this.isValidLookup(n))return;const p=this.extractFromKey(d,r),f=p.key;i=f;let h=p.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const x=r.count!==void 0&&!nr(r.count),m=x&&!r.ordinal&&r.count===0,b=r.context!==void 0&&(nr(r.context)||typeof r.context=="number")&&r.context!=="",w=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);h.forEach(y=>{this.isValidLookup(n)||(l=y,!aC[`${w[0]}-${y}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(aC[`${w[0]}-${y}`]=!0,this.logger.warn(`key "${i}" for languages "${w.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(C=>{if(this.isValidLookup(n))return;a=C;const T=[f];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(T,f,C,y,r);else{let j;x&&(j=this.pluralResolver.getSuffix(C,r.count,r));const k=`${this.options.pluralSeparator}zero`,A=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(x&&(r.ordinal&&j.indexOf(A)===0&&T.push(f+j.replace(A,this.options.pluralSeparator)),T.push(f+j),m&&T.push(f+k)),b){const R=`${f}${this.options.contextSeparator||"_"}${r.context}`;T.push(R),x&&(r.ordinal&&j.indexOf(A)===0&&T.push(R+j.replace(A,this.options.pluralSeparator)),T.push(R+j),m&&T.push(R+k))}}let E;for(;E=T.pop();)this.isValidLookup(n)||(o=E,n=this.getResource(C,y,E,r))}))})}),{res:n,usedKey:i,exactUsedKey:o,usedLng:a,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,r,n,i={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,r,n,i):this.resourceStore.getResource(e,r,n,i)}getUsedParamsDetails(e={}){const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!nr(e.replace);let i=n?e.replace:e;if(n&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(const o of r)delete i[o]}return i}static hasDefaultValue(e){const r="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&r===n.substring(0,r.length)&&e[n]!==void 0)return!0;return!1}}class lC{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Wo.create("languageUtils")}getScriptPartFromCode(e){if(e=_p(e),!e||e.indexOf("-")<0)return null;const r=e.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(e){if(e=_p(e),!e||e.indexOf("-")<0)return e;const r=e.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(e){if(nr(e)&&e.indexOf("-")>-1){let r;try{r=Intl.getCanonicalLocales(e)[0]}catch{}return r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let r;return e.forEach(n=>{if(r)return;const i=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(i))&&(r=i)}),!r&&this.options.supportedLngs&&e.forEach(n=>{if(r)return;const i=this.getScriptPartFromCode(n);if(this.isSupportedCode(i))return r=i;const o=this.getLanguagePartFromCode(n);if(this.isSupportedCode(o))return r=o;r=this.options.supportedLngs.find(a=>{if(a===o)return a;if(!(a.indexOf("-")<0&&o.indexOf("-")<0)&&(a.indexOf("-")>0&&o.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===o||a.indexOf(o)===0&&o.length>1))return a})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(e,r){if(!e)return[];if(typeof e=="function"&&(e=e(r)),nr(e)&&(e=[e]),Array.isArray(e))return e;if(!r)return e.default||[];let n=e[r];return n||(n=e[this.getScriptPartFromCode(r)]),n||(n=e[this.formatLanguageCode(r)]),n||(n=e[this.getLanguagePartFromCode(r)]),n||(n=e.default),n||[]}toResolveHierarchy(e,r){const n=this.getFallbackCodes((r===!1?[]:r)||this.options.fallbackLng||[],e),i=[],o=a=>{a&&(this.isSupportedCode(a)?i.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return nr(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):nr(e)&&o(this.formatLanguageCode(e)),n.forEach(a=>{i.indexOf(a)<0&&o(this.formatLanguageCode(a))}),i}}const cC={zero:0,one:1,two:2,few:3,many:4,other:5},dC={select:s=>s===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class L3{constructor(e,r={}){this.languageUtils=e,this.options=r,this.logger=Wo.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,r){this.rules[e]=r}clearCache(){this.pluralRulesCache={}}getRule(e,r={}){const n=_p(e==="dev"?"en":e),i=r.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:n,type:i});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let a;try{a=new Intl.PluralRules(n,{type:i})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),dC;if(!e.match(/-|_/))return dC;const d=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(d,r)}return this.pluralRulesCache[o]=a,a}needsPlural(e,r={}){let n=this.getRule(e,r);return n||(n=this.getRule("dev",r)),n?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,r,n={}){return this.getSuffixes(e,n).map(i=>`${r}${i}`)}getSuffixes(e,r={}){let n=this.getRule(e,r);return n||(n=this.getRule("dev",r)),n?n.resolvedOptions().pluralCategories.sort((i,o)=>cC[i]-cC[o]).map(i=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,r,n={}){const i=this.getRule(e,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(r)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",r,n))}}const uC=(s,e,r,n=".",i=!0)=>{let o=A3(s,e,r);return!o&&i&&nr(r)&&(o=V0(s,r,n),o===void 0&&(o=V0(e,r,n))),o},zy=s=>s.replace(/\$/g,"$$$$");class pC{constructor(e={}){this.logger=Wo.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(r=>r),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:r,escapeValue:n,useRawValueToEscape:i,prefix:o,prefixEscaped:a,suffix:l,suffixEscaped:d,formatSeparator:p,unescapeSuffix:f,unescapePrefix:h,nestingPrefix:x,nestingPrefixEscaped:m,nestingSuffix:b,nestingSuffixEscaped:w,nestingOptionsSeparator:y,maxReplaces:C,alwaysFormat:T}=e.interpolation;this.escape=r!==void 0?r:R3,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=o?td(o):a||"{{",this.suffix=l?td(l):d||"}}",this.formatSeparator=p||",",this.unescapePrefix=f?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":f||"",this.nestingPrefix=x?td(x):m||td("$t("),this.nestingSuffix=b?td(b):w||td(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=C||1e3,this.alwaysFormat=T!==void 0?T:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(r,n)=>r?.source===n?(r.lastIndex=0,r):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,r,n,i){let o,a,l;const d=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},p=m=>{if(m.indexOf(this.formatSeparator)<0){const C=uC(r,d,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(C,void 0,n,{...i,...r,interpolationkey:m}):C}const b=m.split(this.formatSeparator),w=b.shift().trim(),y=b.join(this.formatSeparator).trim();return this.format(uC(r,d,w,this.options.keySeparator,this.options.ignoreJSONStructure),y,n,{...i,...r,interpolationkey:w})};this.resetRegExp();const f=i?.missingInterpolationHandler||this.options.missingInterpolationHandler,h=i?.interpolation?.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>zy(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?zy(this.escape(m)):zy(m)}].forEach(m=>{for(l=0;o=m.regex.exec(e);){const b=o[1].trim();if(a=p(b),a===void 0)if(typeof f=="function"){const y=f(e,o,i);a=nr(y)?y:""}else if(i&&Object.prototype.hasOwnProperty.call(i,b))a="";else if(h){a=o[0];continue}else this.logger.warn(`missed to pass in variable ${b} for interpolating ${e}`),a="";else!nr(a)&&!this.useRawValueToEscape&&(a=rC(a));const w=m.safeValue(a);if(e=e.replace(o[0],w),h?(m.regex.lastIndex+=a.length,m.regex.lastIndex-=o[0].length):m.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,r,n={}){let i,o,a;const l=(d,p)=>{const f=this.nestingOptionsSeparator;if(d.indexOf(f)<0)return d;const h=d.split(new RegExp(`${f}[ ]*{`));let x=`{${h[1]}`;d=h[0],x=this.interpolate(x,a);const m=x.match(/'/g),b=x.match(/"/g);((m?.length??0)%2===0&&!b||b.length%2!==0)&&(x=x.replace(/'/g,'"'));try{a=JSON.parse(x),p&&(a={...p,...a})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${d}`,w),`${d}${f}${x}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,d};for(;i=this.nestingRegexp.exec(e);){let d=[];a={...n},a=a.replace&&!nr(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;const p=/{.*}/.test(i[1])?i[1].lastIndexOf("}")+1:i[1].indexOf(this.formatSeparator);if(p!==-1&&(d=i[1].slice(p).split(this.formatSeparator).map(f=>f.trim()).filter(Boolean),i[1]=i[1].slice(0,p)),o=r(l.call(this,i[1].trim(),a),a),o&&i[0]===e&&!nr(o))return o;nr(o)||(o=rC(o)),o||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),o=""),d.length&&(o=d.reduce((f,h)=>this.format(f,h,n.lng,{...n,interpolationkey:i[1].trim()}),o.trim())),e=e.replace(i[0],o),this.regexp.lastIndex=0}return e}}const z3=s=>{let e=s.toLowerCase().trim();const r={};if(s.indexOf("(")>-1){const n=s.split("(");e=n[0].toLowerCase().trim();const i=n[1].substring(0,n[1].length-1);e==="currency"&&i.indexOf(":")<0?r.currency||(r.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?r.range||(r.range=i.trim()):i.split(";").forEach(a=>{if(a){const[l,...d]=a.split(":"),p=d.join(":").trim().replace(/^'+|'+$/g,""),f=l.trim();r[f]||(r[f]=p),p==="false"&&(r[f]=!1),p==="true"&&(r[f]=!0),isNaN(p)||(r[f]=parseInt(p,10))}})}return{formatName:e,formatOptions:r}},hC=s=>{const e={};return(r,n,i)=>{let o=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(o={...o,[i.interpolationkey]:void 0});const a=n+JSON.stringify(o);let l=e[a];return l||(l=s(_p(n),i),e[a]=l),l(r)}},M3=s=>(e,r,n)=>s(_p(r),n)(e);class B3{constructor(e={}){this.logger=Wo.create("formatter"),this.options=e,this.init(e)}init(e,r={interpolation:{}}){this.formatSeparator=r.interpolation.formatSeparator||",";const n=r.cacheInBuiltFormats?hC:M3;this.formats={number:n((i,o)=>{const a=new Intl.NumberFormat(i,{...o});return l=>a.format(l)}),currency:n((i,o)=>{const a=new Intl.NumberFormat(i,{...o,style:"currency"});return l=>a.format(l)}),datetime:n((i,o)=>{const a=new Intl.DateTimeFormat(i,{...o});return l=>a.format(l)}),relativetime:n((i,o)=>{const a=new Intl.RelativeTimeFormat(i,{...o});return l=>a.format(l,o.range||"day")}),list:n((i,o)=>{const a=new Intl.ListFormat(i,{...o});return l=>a.format(l)})}}add(e,r){this.formats[e.toLowerCase().trim()]=r}addCached(e,r){this.formats[e.toLowerCase().trim()]=hC(r)}format(e,r,n,i={}){const o=r.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(l=>l.indexOf(")")>-1)){const l=o.findIndex(d=>d.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,l)].join(this.formatSeparator)}return o.reduce((l,d)=>{const{formatName:p,formatOptions:f}=z3(d);if(this.formats[p]){let h=l;try{const x=i?.formatParams?.[i.interpolationkey]||{},m=x.locale||x.lng||i.locale||i.lng||n;h=this.formats[p](l,m,{...f,...i,...x})}catch(x){this.logger.warn(x)}return h}else this.logger.warn(`there was no format function for ${p}`);return l},e)}}const F3=(s,e)=>{s.pending[e]!==void 0&&(delete s.pending[e],s.pendingCount--)};class $3 extends ex{constructor(e,r,n,i={}){super(),this.backend=e,this.store=r,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=Wo.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(n,i.backend,i)}queueLoad(e,r,n,i){const o={},a={},l={},d={};return e.forEach(p=>{let f=!0;r.forEach(h=>{const x=`${p}|${h}`;!n.reload&&this.store.hasResourceBundle(p,h)?this.state[x]=2:this.state[x]<0||(this.state[x]===1?a[x]===void 0&&(a[x]=!0):(this.state[x]=1,f=!1,a[x]===void 0&&(a[x]=!0),o[x]===void 0&&(o[x]=!0),d[h]===void 0&&(d[h]=!0)))}),f||(l[p]=!0)}),(Object.keys(o).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(o),pending:Object.keys(a),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(d)}}loaded(e,r,n){const i=e.split("|"),o=i[0],a=i[1];r&&this.emit("failedLoading",o,a,r),!r&&n&&this.store.addResourceBundle(o,a,n,void 0,void 0,{skipCopy:!0}),this.state[e]=r?-1:2,r&&n&&(this.state[e]=0);const l={};this.queue.forEach(d=>{k3(d.loaded,[o],a),F3(d,e),r&&d.errors.push(r),d.pendingCount===0&&!d.done&&(Object.keys(d.loaded).forEach(p=>{l[p]||(l[p]={});const f=d.loaded[p];f.length&&f.forEach(h=>{l[p][h]===void 0&&(l[p][h]=!0)})}),d.done=!0,d.errors.length?d.callback(d.errors):d.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(d=>!d.done)}read(e,r,n,i=0,o=this.retryTimeout,a){if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:r,fcName:n,tried:i,wait:o,callback:a});return}this.readingCalls++;const l=(p,f)=>{if(this.readingCalls--,this.waitingReads.length>0){const h=this.waitingReads.shift();this.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(p&&f&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,r,n,i+1,o*2,a)},o);return}a(p,f)},d=this.backend[n].bind(this.backend);if(d.length===2){try{const p=d(e,r);p&&typeof p.then=="function"?p.then(f=>l(null,f)).catch(l):l(null,p)}catch(p){l(p)}return}return d(e,r,l)}prepareLoading(e,r,n={},i){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();nr(e)&&(e=this.languageUtils.toResolveHierarchy(e)),nr(r)&&(r=[r]);const o=this.queueLoad(e,r,n,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach(a=>{this.loadOne(a)})}load(e,r,n){this.prepareLoading(e,r,{},n)}reload(e,r,n){this.prepareLoading(e,r,{reload:!0},n)}loadOne(e,r=""){const n=e.split("|"),i=n[0],o=n[1];this.read(i,o,"read",void 0,void 0,(a,l)=>{a&&this.logger.warn(`${r}loading namespace ${o} for language ${i} failed`,a),!a&&l&&this.logger.log(`${r}loaded namespace ${o} for language ${i}`,l),this.loaded(e,a,l)})}saveMissing(e,r,n,i,o,a={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${n}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend?.create){const d={...a,isUpdate:o},p=this.backend.create.bind(this.backend);if(p.length<6)try{let f;p.length===5?f=p(e,r,n,i,d):f=p(e,r,n,i),f&&typeof f.then=="function"?f.then(h=>l(null,h)).catch(l):l(null,f)}catch(f){l(f)}else p(e,r,n,i,l,d)}!e||!e[0]||this.store.addResource(e[0],r,n,i)}}}const fC=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:s=>{let e={};if(typeof s[1]=="object"&&(e=s[1]),nr(s[1])&&(e.defaultValue=s[1]),nr(s[2])&&(e.tDescription=s[2]),typeof s[2]=="object"||typeof s[3]=="object"){const r=s[3]||s[2];Object.keys(r).forEach(n=>{e[n]=r[n]})}return e},interpolation:{escapeValue:!0,format:s=>s,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),gC=s=>(nr(s.ns)&&(s.ns=[s.ns]),nr(s.fallbackLng)&&(s.fallbackLng=[s.fallbackLng]),nr(s.fallbackNS)&&(s.fallbackNS=[s.fallbackNS]),s.supportedLngs?.indexOf?.("cimode")<0&&(s.supportedLngs=s.supportedLngs.concat(["cimode"])),typeof s.initImmediate=="boolean"&&(s.initAsync=s.initImmediate),s),mf=()=>{},G3=s=>{Object.getOwnPropertyNames(Object.getPrototypeOf(s)).forEach(r=>{typeof s[r]=="function"&&(s[r]=s[r].bind(s))})};class bp extends ex{constructor(e={},r){if(super(),this.options=gC(e),this.services={},this.logger=Wo,this.modules={external:[]},G3(this),r&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,r),this;setTimeout(()=>{this.init(e,r)},0)}}init(e={},r){this.isInitializing=!0,typeof e=="function"&&(r=e,e={}),e.defaultNS==null&&e.ns&&(nr(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const n=fC();this.options={...n,...this.options,...gC(e)},this.options.interpolation={...n.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator),typeof this.options.overloadTranslationOptionHandler!="function"&&(this.options.overloadTranslationOptionHandler=n.overloadTranslationOptionHandler);const i=p=>p?typeof p=="function"?new p:p:null;if(!this.options.isClone){this.modules.logger?Wo.init(i(this.modules.logger),this.options):Wo.init(null,this.options);let p;this.modules.formatter?p=this.modules.formatter:p=B3;const f=new lC(this.options);this.store=new oC(this.options.resources,this.options);const h=this.services;h.logger=Wo,h.resourceStore=this.store,h.languageUtils=f,h.pluralResolver=new L3(f,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),p&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(h.formatter=i(p),h.formatter.init&&h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new pC(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new $3(i(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",(m,...b)=>{this.emit(m,...b)}),this.modules.languageDetector&&(h.languageDetector=i(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=i(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new gg(this.services,this.options),this.translator.on("*",(m,...b)=>{this.emit(m,...b)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,r||(r=mf),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const p=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);p.length>0&&p[0]!=="dev"&&(this.options.lng=p[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(p=>{this[p]=(...f)=>this.store[p](...f)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(p=>{this[p]=(...f)=>(this.store[p](...f),this)});const l=Yu(),d=()=>{const p=(f,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(h),r(f,h)};if(this.languages&&!this.isInitialized)return p(null,this.t.bind(this));this.changeLanguage(this.options.lng,p)};return this.options.resources||!this.options.initAsync?d():setTimeout(d,0),l}loadResources(e,r=mf){let n=r;const i=nr(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(i?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const o=[],a=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(p=>{p!=="cimode"&&o.indexOf(p)<0&&o.push(p)})};i?a(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(d=>a(d)),this.options.preload?.forEach?.(l=>a(l)),this.services.backendConnector.load(o,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(l)})}else n(null)}reloadResources(e,r,n){const i=Yu();return typeof e=="function"&&(n=e,e=void 0),typeof r=="function"&&(n=r,r=void 0),e||(e=this.languages),r||(r=this.options.ns),n||(n=mf),this.services.backendConnector.reload(e,r,o=>{i.resolve(),n(o)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&YT.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let r=0;r<this.languages.length;r++){const n=this.languages[r];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,r){this.isLanguageChangingTo=e;const n=Yu();this.emit("languageChanging",e);const i=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,d)=>{d?this.isLanguageChangingTo===e&&(i(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,n.resolve((...p)=>this.t(...p)),r&&r(l,(...p)=>this.t(...p))},a=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const d=nr(l)?l:l&&l[0],p=this.store.hasLanguageSomeTranslations(d)?d:this.services.languageUtils.getBestMatchFromCodes(nr(l)?[l]:l);p&&(this.language||i(p),this.translator.language||this.translator.changeLanguage(p),this.services.languageDetector?.cacheUserLanguage?.(p)),this.loadResources(p,f=>{o(f,p)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e),n}getFixedT(e,r,n){const i=(o,a,...l)=>{let d;typeof a!="object"?d=this.options.overloadTranslationOptionHandler([o,a].concat(l)):d={...a},d.lng=d.lng||i.lng,d.lngs=d.lngs||i.lngs,d.ns=d.ns||i.ns,d.keyPrefix!==""&&(d.keyPrefix=d.keyPrefix||n||i.keyPrefix);const p=this.options.keySeparator||".";let f;return d.keyPrefix&&Array.isArray(o)?f=o.map(h=>(typeof h=="function"&&(h=X0(h,{...this.options,...a})),`${d.keyPrefix}${p}${h}`)):(typeof o=="function"&&(o=X0(o,{...this.options,...a})),f=d.keyPrefix?`${d.keyPrefix}${p}${o}`:o),this.t(f,d)};return nr(e)?i.lng=e:i.lngs=e,i.ns=r,i.keyPrefix=n,i}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,r={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=r.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const a=(l,d)=>{const p=this.services.backendConnector.state[`${l}|${d}`];return p===-1||p===0||p===2};if(r.precheck){const l=r.precheck(this,a);if(l!==void 0)return l}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(n,e)&&(!i||a(o,e)))}loadNamespaces(e,r){const n=Yu();return this.options.ns?(nr(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{n.resolve(),r&&r(i)}),n):(r&&r(),Promise.resolve())}loadLanguages(e,r){const n=Yu();nr(e)&&(e=[e]);const i=this.options.preload||[],o=e.filter(a=>i.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return o.length?(this.options.preload=i.concat(o),this.loadResources(a=>{n.resolve(),r&&r(a)}),n):(r&&r(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const i=new Intl.Locale(e);if(i&&i.getTextInfo){const o=i.getTextInfo();if(o&&o.direction)return o.direction}}catch{}const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services?.languageUtils||new lC(fC());return e.toLowerCase().indexOf("-latn")>1?"ltr":r.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},r){const n=new bp(e,r);return n.createInstance=bp.createInstance,n}cloneInstance(e={},r=mf){const n=e.forkResourceStore;n&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},o=new bp(i);if((e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(l=>{o[l]=this[l]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},n){const l=Object.keys(this.store.data).reduce((d,p)=>(d[p]={...this.store.data[p]},d[p]=Object.keys(d[p]).reduce((f,h)=>(f[h]={...d[p][h]},f),d[p]),d),{});o.store=new oC(l,i),o.services.resourceStore=o.store}return e.interpolation&&(o.services.interpolator=new pC(i)),o.translator=new gg(o.services,i),o.translator.on("*",(l,...d)=>{o.emit(l,...d)}),o.init(i,r),o.translator.options=i,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ii=bp.createInstance();ii.createInstance;ii.dir;ii.init;ii.loadResources;ii.reloadResources;ii.use;ii.changeLanguage;ii.getFixedT;ii.t;ii.exists;ii.setDefaultNamespace;ii.hasLoadedNamespace;ii.loadNamespaces;ii.loadLanguages;const U3=(s,e,r,n)=>{const i=[r,{code:e,...n||{}}];if(s?.services?.logger?.forward)return s.services.logger.forward(i,"warn","react-i18next::",!0);mc(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),s?.services?.logger?.warn?s.services.logger.warn(...i):console?.warn&&console.warn(...i)},xC={},VT=(s,e,r,n)=>{mc(r)&&xC[r]||(mc(r)&&(xC[r]=new Date),U3(s,e,r,n))},XT=(s,e)=>()=>{if(s.isInitialized)e();else{const r=()=>{setTimeout(()=>{s.off("initialized",r)},0),e()};s.on("initialized",r)}},J0=(s,e,r)=>{s.loadNamespaces(e,XT(s,r))},mC=(s,e,r,n)=>{if(mc(r)&&(r=[r]),s.options.preload&&s.options.preload.indexOf(e)>-1)return J0(s,r,n);r.forEach(i=>{s.options.ns.indexOf(i)<0&&s.options.ns.push(i)}),s.loadLanguages(e,XT(s,n))},W3=(s,e,r={})=>!e.languages||!e.languages.length?(VT(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(s,{lng:r.lng,precheck:(n,i)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&n.services.backendConnector.backend&&n.isLanguageChangingTo&&!i(n.isLanguageChangingTo,s))return!1}}),mc=s=>typeof s=="string",q3=s=>typeof s=="object"&&s!==null,H3=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,Y3={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},K3=s=>Y3[s],V3=s=>s.replace(H3,K3);let Q0={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:V3,transDefaultProps:void 0};const X3=(s={})=>{Q0={...Q0,...s}},J3=()=>Q0;let JT;const Q3=s=>{JT=s},Z3=()=>JT,eF={type:"3rdParty",init(s){X3(s.options.react),Q3(s)}},tF=S.createContext();class rF{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var nF=QI();const sF=(s,e)=>mc(e)?e:q3(e)&&mc(e.defaultValue)?e.defaultValue:Array.isArray(s)?s[s.length-1]:s,iF={t:sF,ready:!1},oF=()=>()=>{},tx=(s,e={})=>{const{i18n:r}=e,{i18n:n,defaultNS:i}=S.useContext(tF)||{},o=r||n||Z3();o&&!o.reportNamespaces&&(o.reportNamespaces=new rF),o||VT(o,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const a=S.useMemo(()=>({...J3(),...o?.options?.react,...e}),[o,e]),{useSuspense:l,keyPrefix:d}=a,p=s||i||o?.options?.defaultNS,f=mc(p)?[p]:p||["translation"],h=S.useMemo(()=>f,f);o?.reportNamespaces?.addUsedNamespaces?.(h);const x=S.useRef(0),m=S.useCallback(P=>{if(!o)return oF;const{bindI18n:I,bindI18nStore:O}=a,G=()=>{x.current+=1,P()};return I&&o.on(I,G),O&&o.store.on(O,G),()=>{I&&I.split(" ").forEach(B=>o.off(B,G)),O&&O.split(" ").forEach(B=>o.store.off(B,G))}},[o,a]),b=S.useRef(),w=S.useCallback(()=>{if(!o)return iF;const P=!!(o.isInitialized||o.initializedStoreOnce)&&h.every(z=>W3(z,o,a)),I=e.lng||o.language,O=x.current,G=b.current;if(G&&G.ready===P&&G.lng===I&&G.keyPrefix===d&&G.revision===O)return G;const F={t:o.getFixedT(I,a.nsMode==="fallback"?h:h[0],d),ready:P,lng:I,keyPrefix:d,revision:O};return b.current=F,F},[o,h,d,a,e.lng]),[y,C]=S.useState(0),{t:T,ready:E}=nF.useSyncExternalStore(m,w,w);S.useEffect(()=>{if(o&&!E&&!l){const P=()=>C(I=>I+1);e.lng?mC(o,e.lng,h,P):J0(o,h,P)}},[o,e.lng,h,E,l,y]);const j=o||{},k=S.useRef(null),A=S.useRef(),R=P=>{const I=Object.getOwnPropertyDescriptors(P);I.__original&&delete I.__original;const O=Object.create(Object.getPrototypeOf(P),I);if(!Object.prototype.hasOwnProperty.call(O,"__original"))try{Object.defineProperty(O,"__original",{value:P,writable:!1,enumerable:!1,configurable:!1})}catch{}return O},M=S.useMemo(()=>{const P=j,I=P?.language;let O=P;P&&(k.current&&k.current.__original===P?A.current!==I?(O=R(P),k.current=O,A.current=I):O=k.current:(O=R(P),k.current=O,A.current=I));const G=[T,O,E];return G.t=T,G.i18n=O,G.ready=E,G},[T,j,E,j.resolvedLanguage,j.language,j.languages]);if(o&&l&&!E)throw new Promise(P=>{const I=()=>P();e.lng?mC(o,e.lng,h,I):J0(o,h,I)});return M},yC=({onNavigate:s})=>{const{login:e,setupGuestAccess:r}=Ao(),{t:n}=tx("auth"),[i,o]=S.useState(""),[a,l]=S.useState(""),[d,p]=S.useState(!1),[f,h]=S.useState(!1),[x,m]=S.useState(!1),[b,w]=S.useState(""),y=async T=>{if(T.preventDefault(),!i||!a){w(n("login.errors.emailPassword"));return}h(!0),w("");try{console.log("Login attempt for:",i);const E=await e(i,a);if(E.success)console.log("Login successful - App.tsx will handle routing based on account type");else{console.log("Login failed:",E.error);const j=E.error||"Login failed. Please check your credentials.";j.toLowerCase().includes("invalid email or password")||j.toLowerCase().includes("invalid credentials")||j.toLowerCase().includes("check your credentials")?w("Invalid email or password. Please double-check your login information."):j.toLowerCase().includes("account not found")||j.toLowerCase().includes("user not found")||j.toLowerCase().includes("user does not exist")?w("No account found with this email. Please check your email or sign up for a new account."):j.toLowerCase().includes("password")?w('Incorrect password. Please try again or use "Forgot Password" to reset it.'):j.toLowerCase().includes("server error")?w("Server error. Please try again in a few moments."):j.toLowerCase().includes("unable to connect")?w("Unable to connect to server. Please check your internet connection and try again."):w(j)}}catch(E){console.error("Login error:",E),w(n("login.errors.unexpectedError"))}finally{h(!1)}},C=async()=>{m(!0),w("");try{console.log("Setting up guest access...");const T=await r();T.success?console.log("Guest access setup successful - App.tsx will handle routing"):(console.log("Guest access setup failed:",T.error),w(T.error||n("login.errors.guestSetupFailed")))}catch(T){console.error("Guest access error:",T),w(n("login.errors.guestSetupFailed"))}finally{m(!1)}};return t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-sm mx-4 shadow-2xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-white text-2xl font-light mb-3",children:n("login.title")}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:n("login.subtitle")})]}),t.jsxs("form",{onSubmit:y,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"email",className:"text-white text-xs",children:n("login.emailLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(gc,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"email",type:"email",placeholder:n("login.emailPlaceholder"),value:i,onChange:T=>{o(T.target.value),b&&w("")},className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:f||x,required:!0})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"password",className:"text-white text-xs",children:n("login.passwordLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(Np,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"password",type:d?"text":"password",placeholder:n("login.passwordPlaceholder"),value:a,onChange:T=>{l(T.target.value),b&&w("")},className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 pr-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500 [&::-ms-reveal]:hidden [&::-ms-clear]:hidden",style:{WebkitTextSecurity:d?"none":void 0},autoComplete:"current-password",disabled:f||x,required:!0}),t.jsx("button",{type:"button",onClick:()=>p(!d),className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-zinc-400 hover:text-zinc-300",disabled:f||x,children:d?t.jsx(cc,{className:"h-3.5 w-3.5"}):t.jsx(vi,{className:"h-3.5 w-3.5"})})]})]}),b&&t.jsx("div",{className:"text-red-400 text-xs bg-red-900/20 border border-red-900/50 rounded p-2",children:b}),t.jsxs("div",{className:"flex justify-between items-center text-xs pt-1",children:[t.jsx("button",{type:"button",onClick:()=>s("forgotPassword"),className:"text-blue-400 hover:text-blue-300 transition-colors",disabled:f||x,children:n("login.forgotPassword")}),t.jsx(Tr,{type:"submit",className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-1.5 text-sm font-normal transition-colors disabled:opacity-50",disabled:f||x,children:f?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-3 h-3 border border-white/30 border-t-white rounded-full animate-spin mr-1.5"}),n("login.signingIn")]}):n("login.loginButton")})]})]}),t.jsxs("div",{className:"mt-5 pt-4 border-t border-zinc-700 space-y-3",children:[t.jsx(Tr,{onClick:C,className:"w-full bg-blue-600/20 hover:bg-blue-600/30 border border-blue-600/50 text-blue-400 py-2 text-sm font-normal transition-colors disabled:opacity-50",disabled:f||x,children:x?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx("div",{className:"w-3 h-3 border border-blue-400/30 border-t-blue-400 rounded-full animate-spin mr-1.5"}),n("login.guestSettingUp")]}):t.jsxs(t.Fragment,{children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),n("login.guestButton")]})}),t.jsx("div",{className:"text-center",children:t.jsxs("p",{className:"text-zinc-400 text-xs",children:[n("login.noAccount")," ",t.jsx("button",{type:"button",onClick:()=>s("register"),className:"text-blue-400 hover:text-blue-300 transition-colors",disabled:f||x,children:n("login.signUp")})]})}),t.jsx("div",{className:"text-center text-zinc-500 text-xs",children:t.jsx("p",{children:n("login.guestInfo")})})]})]})},aF=({onNavigate:s})=>{const{signup:e,verifyOtp:r,session:n}=Ao(),{t:i}=tx("auth"),[o,a]=S.useState("form"),[l,d]=S.useState({firstName:"",lastName:"",email:"",phone:"",countryCode:"+1",company:"",password:"",confirmPassword:""}),[p,f]=S.useState(""),[h,x]=S.useState(!1),[m,b]=S.useState(""),[w,y]=S.useState(!1),[C,T]=S.useState([]),[E,j]=S.useState(!1),[k,A]=S.useState(""),[R,M]=S.useState({minLength:!1,hasUpperCase:!1,hasLowerCase:!1,hasNumber:!1,hasSpecialChar:!1});S.useEffect(()=>{(async()=>{try{const oe=(await(await fetch("https://restcountries.com/v3.1/all?fields=name,cca2,idd,flag")).json()).filter(Z=>Z.idd?.root&&Z.idd?.suffixes?.length>0).map(Z=>({name:Z.name.common,code:Z.cca2,dialCode:Z.idd.root+(Z.idd.suffixes[0]||""),flag:Z.flag})).sort((Z,fe)=>Z.name.localeCompare(fe.name));T(oe)}catch(W){console.error("Failed to fetch countries:",W),T([{name:"United States",code:"US",dialCode:"+1",flag:""},{name:"United Kingdom",code:"GB",dialCode:"+44",flag:""},{name:"Canada",code:"CA",dialCode:"+1",flag:""},{name:"India",code:"IN",dialCode:"+91",flag:""},{name:"Australia",code:"AU",dialCode:"+61",flag:""},{name:"Germany",code:"DE",dialCode:"+49",flag:""},{name:"France",code:"FR",dialCode:"+33",flag:""},{name:"Japan",code:"JP",dialCode:"+81",flag:""}])}})()},[]),S.useEffect(()=>{n?.authenticated&&n?.user_type==="registered"&&w&&(console.log("Registration complete, navigating based on account type:",n.user_info?.account_type),n.subscription?.has_subscription?(console.log("User has subscription, redirecting to dashboard"),s("dashboard")):(console.log("User is free tier, showing pricing screen"),s("pricing")))},[n,w,s]);const P=($,W)=>{d(D=>({...D,[$]:W})),m&&b(""),$==="password"&&M({minLength:W.length>=8,hasUpperCase:/[A-Z]/.test(W),hasLowerCase:/[a-z]/.test(W),hasNumber:/[0-9]/.test(W),hasSpecialChar:/[!@#$%^&*(),.?":{}|<>]/.test(W)})},I=$=>{d(W=>({...W,countryCode:$.dialCode})),j(!1),A("")},O=C.filter($=>$.name.toLowerCase().includes(k.toLowerCase())||$.dialCode.includes(k)),G=C.find($=>$.dialCode===l.countryCode),B=async $=>{if($.preventDefault(),!l.firstName||!l.lastName||!l.email||!l.password||!l.confirmPassword){b(i("register.errors.requiredFields"));return}if(l.password!==l.confirmPassword){b(i("register.errors.passwordMismatch"));return}if(l.password.length<8){b(i("register.errors.passwordLength"));return}x(!0),b("");try{console.log("Registration attempt for:",l.email);const W=`${l.firstName.trim()}${l.lastName.trim()}`.toLowerCase();console.log("Generated username:",W);const D=await e(W,l.email,l.password);if(D.success)console.log("Registration successful, OTP sent to:",l.email),a("otp-verification");else{console.log("Registration failed:",D.error);const oe=D.error||"Registration failed. Please try again.";oe.toLowerCase().includes("already exists")||oe.toLowerCase().includes("already registered")?b(i("register.errors.alreadyExists")):b(oe)}}catch(W){console.error("Registration error:",W),b(i("register.errors.unexpectedError"))}finally{x(!1)}},F=async $=>{if($.preventDefault(),!p){b(i("register.errors.verificationCode"));return}if(h||w){console.log("Verification already in progress or complete, skipping");return}x(!0),b("");try{console.log("OTP verification for:",l.email);const W=await r(l.email,p);W.success?(console.log("OTP verification successful"),y(!0)):(console.log("OTP verification failed:",W.error),b(W.error||i("register.errors.verificationFailed")))}catch(W){console.error("OTP verification error:",W),b(i("register.errors.unexpectedError"))}finally{x(!1)}},z=async()=>{x(!0),b("");try{const $=`${l.firstName.trim()}${l.lastName.trim()}`.toLowerCase(),W=await e($,l.email,l.password);W.success?(b(""),console.log("OTP resent successfully")):b(W.error||i("register.errors.resendFailed"))}catch{b(i("register.errors.resendFailed"))}finally{x(!1)}};return w?t.jsx("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-sm mx-4 shadow-2xl",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-8 h-8 border border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),t.jsx("h2",{className:"text-white text-xl font-semibold mb-2",children:i("register.verification.complete")}),t.jsx("p",{className:"text-zinc-400 text-sm",children:i("register.verification.settingUp")})]})}):o==="form"?t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-lg mx-4 shadow-2xl",children:[t.jsxs("div",{className:"mb-5",children:[t.jsxs("div",{className:"flex items-center mb-2.5",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:i("register.title")})]}),t.jsx("p",{className:"text-zinc-400 text-sm leading-5",children:i("register.subtitle")})]}),t.jsxs("form",{onSubmit:B,className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"firstName",className:"text-white text-xs",children:i("register.firstNameLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(Kp,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"firstName",type:"text",placeholder:i("register.firstNamePlaceholder"),value:l.firstName,onChange:$=>P("firstName",$.target.value),className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:h,required:!0})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"lastName",className:"text-white text-xs",children:i("register.lastNameLabel")}),t.jsx(ei,{id:"lastName",type:"text",placeholder:i("register.lastNamePlaceholder"),value:l.lastName,onChange:$=>P("lastName",$.target.value),className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:h,required:!0})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"email",className:"text-white text-xs",children:i("register.emailLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(gc,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"email",type:"email",placeholder:i("register.emailPlaceholder"),value:l.email,onChange:$=>P("email",$.target.value),className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:h,required:!0})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"phone",className:"text-white text-xs",children:i("register.phoneLabel")}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative",children:[t.jsxs("button",{type:"button",onClick:()=>j(!E),className:"bg-zinc-800 border border-zinc-600 text-white h-9 px-2.5 text-sm rounded flex items-center gap-1 hover:bg-zinc-700 focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500 min-w-[75px]",disabled:h,children:[t.jsx("span",{className:"text-base",children:G?.flag||""}),t.jsx("span",{className:"text-xs",children:l.countryCode}),t.jsx(bi,{className:"h-3 w-3"})]}),E&&t.jsxs("div",{className:"absolute top-full left-0 mt-1 w-80 bg-zinc-800 border border-zinc-600 rounded-lg shadow-lg z-50 max-h-60 overflow-hidden",children:[t.jsx("div",{className:"p-2",children:t.jsx(ei,{type:"text",placeholder:i("register.searchCountries"),value:k,onChange:$=>A($.target.value),className:"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500 h-8 text-sm"})}),t.jsx("div",{className:"overflow-y-auto max-h-48",children:O.slice(0,50).map($=>t.jsxs("button",{type:"button",onClick:()=>I($),className:"w-full px-3 py-2 text-left hover:bg-zinc-700 flex items-center gap-2 text-sm text-white",children:[t.jsx("span",{className:"text-base",children:$.flag}),t.jsx("span",{className:"flex-1",children:$.name}),t.jsx("span",{className:"text-zinc-400",children:$.dialCode})]},$.code))})]})]}),t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(pg,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"phone",type:"tel",placeholder:i("register.phonePlaceholder"),value:l.phone,onChange:$=>P("phone",$.target.value),className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:h})]})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"company",className:"text-white text-xs",children:i("register.companyLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(XM,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"company",type:"text",placeholder:i("register.companyPlaceholder"),value:l.company,onChange:$=>P("company",$.target.value),className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:h})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"password",className:"text-white text-xs",children:i("register.passwordLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(Np,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"password",type:"password",placeholder:i("register.passwordPlaceholder"),value:l.password,onChange:$=>P("password",$.target.value),className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:h,required:!0,minLength:8})]}),l.password&&t.jsxs("div",{className:"mt-2 space-y-1 text-xs",children:[t.jsxs("div",{className:`flex items-center gap-1.5 ${R.minLength?"text-green-400":"text-zinc-500"}`,children:[R.minLength?t.jsx(Es,{className:"h-3 w-3"}):t.jsx(ln,{className:"h-3 w-3"}),t.jsx("span",{children:i("register.passwordRequirements.minLength")})]}),t.jsxs("div",{className:`flex items-center gap-1.5 ${R.hasUpperCase?"text-green-400":"text-zinc-500"}`,children:[R.hasUpperCase?t.jsx(Es,{className:"h-3 w-3"}):t.jsx(ln,{className:"h-3 w-3"}),t.jsx("span",{children:i("register.passwordRequirements.uppercase")})]}),t.jsxs("div",{className:`flex items-center gap-1.5 ${R.hasLowerCase?"text-green-400":"text-zinc-500"}`,children:[R.hasLowerCase?t.jsx(Es,{className:"h-3 w-3"}):t.jsx(ln,{className:"h-3 w-3"}),t.jsx("span",{children:i("register.passwordRequirements.lowercase")})]}),t.jsxs("div",{className:`flex items-center gap-1.5 ${R.hasNumber?"text-green-400":"text-zinc-500"}`,children:[R.hasNumber?t.jsx(Es,{className:"h-3 w-3"}):t.jsx(ln,{className:"h-3 w-3"}),t.jsx("span",{children:i("register.passwordRequirements.number")})]}),t.jsxs("div",{className:`flex items-center gap-1.5 ${R.hasSpecialChar?"text-green-400":"text-zinc-500"}`,children:[R.hasSpecialChar?t.jsx(Es,{className:"h-3 w-3"}):t.jsx(ln,{className:"h-3 w-3"}),t.jsx("span",{children:i("register.passwordRequirements.special")})]})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"confirmPassword",className:"text-white text-xs",children:i("register.confirmPasswordLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(Np,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"confirmPassword",type:"password",placeholder:i("register.confirmPasswordPlaceholder"),value:l.confirmPassword,onChange:$=>P("confirmPassword",$.target.value),className:`bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500 ${l.confirmPassword&&l.password!==l.confirmPassword?"border-red-500":""}`,disabled:h,required:!0})]}),l.confirmPassword&&l.password!==l.confirmPassword&&t.jsxs("div",{className:"flex items-center gap-1.5 text-red-400 text-xs mt-1",children:[t.jsx(ln,{className:"h-3 w-3"}),t.jsx("span",{children:i("register.errors.passwordMismatch")})]})]}),m&&t.jsx("div",{className:"text-red-400 text-xs bg-red-900/20 border border-red-900/50 rounded p-2",children:m}),t.jsx("div",{className:"flex justify-end pt-2",children:t.jsx(Tr,{type:"submit",className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-2 text-sm font-normal transition-colors disabled:opacity-50",disabled:h,children:h?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-3 h-3 border border-white/30 border-t-white rounded-full animate-spin mr-1.5"}),i("register.creating")]}):i("register.registerButton")})})]}),t.jsx("div",{className:"mt-4 pt-4 border-t border-zinc-700 text-center",children:t.jsxs("p",{className:"text-zinc-400 text-xs",children:[i("register.haveAccount")," ",t.jsx("button",{type:"button",onClick:()=>s("login"),className:"text-blue-400 hover:text-blue-300 transition-colors",disabled:h,children:i("register.signIn")})]})}),E&&t.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>j(!1)})]}):o==="otp-verification"?t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-sm mx-4 shadow-2xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>a("form"),className:"text-zinc-400 hover:text-white transition-colors mr-3",disabled:h,children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:i("register.verification.title")})]}),t.jsxs("p",{className:"text-zinc-400 text-xs leading-5",children:[i("register.verification.subtitle")," ",t.jsx("span",{className:"text-white",children:l.email}),".",i("register.verification.description")]}),t.jsx("p",{className:"text-zinc-500 text-xs leading-5 mt-2",children:i("register.verification.note")})]}),t.jsxs("form",{onSubmit:F,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"otp",className:"text-white text-xs",children:i("register.verification.codeLabel")}),t.jsxs("div",{className:"relative",children:[t.jsx(Wb,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"otp",type:"text",placeholder:i("register.verification.codePlaceholder"),value:p,onChange:$=>{f($.target.value),m&&b("")},className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:h,required:!0})]})]}),m&&t.jsx("div",{className:"text-red-400 text-xs bg-red-900/20 border border-red-900/50 rounded p-2",children:m}),t.jsx("div",{className:"flex justify-end pt-2",children:t.jsx(Tr,{type:"submit",className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-1.5 text-sm font-normal transition-colors disabled:opacity-50",disabled:h||w,children:h?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-3 h-3 border border-white/30 border-t-white rounded-full animate-spin mr-1.5"}),i("register.verification.verifying")]}):i("register.verification.verifyButton")})})]}),t.jsx("div",{className:"mt-5 pt-4 border-t border-zinc-700 text-center",children:t.jsx("button",{onClick:z,className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",disabled:h,children:i(h?"register.verification.resending":"register.verification.resend")})})]}):null},lF=({onNavigate:s})=>{const[e,r]=S.useState("email"),[n,i]=S.useState(""),[o,a]=S.useState(""),[l,d]=S.useState(""),[p,f]=S.useState(""),[h,x]=S.useState(!1),[m,b]=S.useState(!1),[w,y]=S.useState(""),C=async k=>{if(k.preventDefault(),!n){y("Please enter your email address");return}b(!0),y("");try{console.log("Requesting password reset for:",n);const A=await no.forgotPassword({email:n});A.success?(console.log("Password reset OTP sent successfully"),r("otp-sent")):(console.log("Password reset request failed:",A.error),y(A.error||"Failed to send reset code. Please try again."))}catch(A){console.error("Password reset request error:",A),y("An unexpected error occurred. Please try again.")}finally{b(!1)}},T=()=>{r("reset-form"),y("")},E=async k=>{if(k.preventDefault(),!o){y("Please enter the verification code");return}if(!l){y("Please enter a new password");return}if(l.length<8){y("Password must be at least 8 characters long");return}if(l!==p){y("Passwords do not match");return}b(!0),y("");try{console.log("Resetting password for:",n);const A=await no.resetPassword({email:n,otp:o,new_password:l});A.success?(console.log("Password reset successful"),r("success")):(console.log("Password reset failed:",A.error),y(A.error||"Failed to reset password. Please check your code and try again."))}catch(A){console.error("Password reset error:",A),y("An unexpected error occurred. Please try again.")}finally{b(!1)}},j=async()=>{b(!0),y("");try{const k=await no.forgotPassword({email:n});k.success?y(""):y(k.error||"Failed to resend code. Please try again.")}catch{y("Failed to resend code. Please try again.")}finally{b(!1)}};return e==="email"?t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-sm mx-4 shadow-2xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:"Reset Password"})]}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Enter your email address and we'll send you a verification code to reset your password."})]}),t.jsxs("form",{onSubmit:C,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"resetEmail",className:"text-white text-xs",children:"Email Address"}),t.jsxs("div",{className:"relative",children:[t.jsx(gc,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"resetEmail",type:"email",placeholder:"Enter your email",value:n,onChange:k=>{i(k.target.value),w&&y("")},className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:m,required:!0})]})]}),w&&t.jsx("div",{className:"text-red-400 text-xs bg-red-900/20 border border-red-900/50 rounded p-2",children:w}),t.jsx("div",{className:"flex justify-end pt-2",children:t.jsx(Tr,{type:"submit",className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-1.5 text-sm font-normal transition-colors disabled:opacity-50",disabled:m,children:m?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-3 h-3 border border-white/30 border-t-white rounded-full animate-spin mr-1.5"}),"Sending..."]}):"Send Code"})})]}),t.jsx("div",{className:"mt-5 pt-4 border-t border-zinc-700 text-center",children:t.jsxs("p",{className:"text-zinc-400 text-xs",children:["Remember your password?"," ",t.jsx("button",{type:"button",onClick:()=>s("login"),className:"text-blue-400 hover:text-blue-300 transition-colors",disabled:m,children:"Sign In"})]})})]}):e==="otp-sent"?t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-sm mx-4 shadow-2xl",children:[t.jsx("div",{className:"text-center mb-6",children:t.jsxs("div",{className:"mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-blue-600/20 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(gc,{className:"w-6 h-6 text-blue-400"})}),t.jsx("h2",{className:"text-white text-2xl font-light mb-3",children:"Check Your Email"}),t.jsxs("p",{className:"text-zinc-400 text-xs leading-5",children:["We've sent a verification code to ",t.jsx("span",{className:"text-white",children:n}),". Enter the code below to reset your password."]})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(Tr,{onClick:T,className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-1.5 text-sm font-normal transition-colors w-full",children:"I Have the Code"}),t.jsxs("div",{className:"text-center space-y-2",children:[t.jsx("button",{onClick:j,className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",disabled:m,children:m?"Sending...":"Didn't receive the code? Resend"}),t.jsx("br",{}),t.jsx("button",{onClick:()=>r("email"),className:"text-zinc-400 hover:text-zinc-300 text-xs transition-colors",children:"Use a different email"})]})]}),w&&t.jsx("div",{className:"text-red-400 text-xs bg-red-900/20 border border-red-900/50 rounded p-2 mt-4",children:w})]}):e==="reset-form"?t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-sm mx-4 shadow-2xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>r("otp-sent"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:"Reset Password"})]}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Enter the verification code and your new password."})]}),t.jsxs("form",{onSubmit:E,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"otp",className:"text-white text-xs",children:"Verification Code"}),t.jsxs("div",{className:"relative",children:[t.jsx(Wb,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-zinc-400"}),t.jsx(ei,{id:"otp",type:"text",placeholder:"Enter code from email",value:o,onChange:k=>{a(k.target.value),w&&y("")},className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pl-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:m,required:!0})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"newPassword",className:"text-white text-xs",children:"New Password"}),t.jsxs("div",{className:"relative",children:[t.jsx(ei,{id:"newPassword",type:h?"text":"password",placeholder:"Enter new password",value:l,onChange:k=>{d(k.target.value),w&&y("")},className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 pr-9 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:m,required:!0,minLength:8}),t.jsx("button",{type:"button",onClick:()=>x(!h),className:"absolute right-2.5 top-1/2 transform -translate-y-1/2 text-zinc-400 hover:text-zinc-300",children:h?t.jsx(cc,{className:"h-3.5 w-3.5"}):t.jsx(vi,{className:"h-3.5 w-3.5"})})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gi,{htmlFor:"confirmPassword",className:"text-white text-xs",children:"Confirm Password"}),t.jsx(ei,{id:"confirmPassword",type:h?"text":"password",placeholder:"Confirm new password",value:p,onChange:k=>{f(k.target.value),w&&y("")},className:"bg-zinc-800 border-zinc-600 text-white placeholder-zinc-500 py-2 h-9 text-sm focus:border-zinc-500 focus:ring-1 focus:ring-zinc-500",disabled:m,required:!0})]}),w&&t.jsx("div",{className:"text-red-400 text-xs bg-red-900/20 border border-red-900/50 rounded p-2",children:w}),t.jsx("div",{className:"flex justify-end pt-2",children:t.jsx(Tr,{type:"submit",className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-1.5 text-sm font-normal transition-colors disabled:opacity-50",disabled:m,children:m?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-3 h-3 border border-white/30 border-t-white rounded-full animate-spin mr-1.5"}),"Resetting..."]}):"Reset Password"})})]})]}):e==="success"?t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-sm mx-4 shadow-2xl",children:[t.jsx("div",{className:"text-center mb-6",children:t.jsxs("div",{className:"mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-green-600/20 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("svg",{className:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("h2",{className:"text-white text-2xl font-light mb-3",children:"Password Reset"}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Your password has been successfully reset. You can now sign in with your new password."})]})}),t.jsx("div",{className:"space-y-4",children:t.jsx(Tr,{onClick:()=>s("login"),className:"bg-zinc-700 hover:bg-zinc-600 text-white px-6 py-1.5 text-sm font-normal transition-colors w-full",children:"Continue to Login"})})]}):null},cF=({onNavigate:s})=>t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-lg mx-4 shadow-2xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:"Help Center"})]}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Find answers to common questions and get support for your Fincept account."})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-white text-sm font-medium",children:"Frequently Asked Questions"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("details",{className:"group",children:[t.jsxs("summary",{className:"text-zinc-300 text-xs cursor-pointer hover:text-white transition-colors list-none flex items-center justify-between p-2 bg-zinc-800/50 rounded",children:[t.jsx("span",{children:"How do I reset my password?"}),t.jsx("svg",{className:"w-3 h-3 group-open:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx("div",{className:"mt-2 p-2 text-zinc-400 text-xs leading-relaxed",children:'Click "Forgot Password" on the login screen, enter your email, and follow the reset link we send you.'})]}),t.jsxs("details",{className:"group",children:[t.jsxs("summary",{className:"text-zinc-300 text-xs cursor-pointer hover:text-white transition-colors list-none flex items-center justify-between p-2 bg-zinc-800/50 rounded",children:[t.jsx("span",{children:"What is Guest Access?"}),t.jsx("svg",{className:"w-3 h-3 group-open:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx("div",{className:"mt-2 p-2 text-zinc-400 text-xs leading-relaxed",children:"Guest Access allows you to explore Fincept with 50 API requests and 24-hour access without creating an account."})]}),t.jsxs("details",{className:"group",children:[t.jsxs("summary",{className:"text-zinc-300 text-xs cursor-pointer hover:text-white transition-colors list-none flex items-center justify-between p-2 bg-zinc-800/50 rounded",children:[t.jsx("span",{children:"How do I contact support?"}),t.jsx("svg",{className:"w-3 h-3 group-open:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx("div",{className:"mt-2 p-2 text-zinc-400 text-xs leading-relaxed",children:"You can reach our support team at support@fincept.com or through the Contact Us link in the footer."})]}),t.jsxs("details",{className:"group",children:[t.jsxs("summary",{className:"text-zinc-300 text-xs cursor-pointer hover:text-white transition-colors list-none flex items-center justify-between p-2 bg-zinc-800/50 rounded",children:[t.jsx("span",{children:"What is a B-Unit?"}),t.jsx("svg",{className:"w-3 h-3 group-open:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx("div",{className:"mt-2 p-2 text-zinc-400 text-xs leading-relaxed",children:"B-Unit is our biometric authentication device that provides an additional layer of security for your terminal access."})]}),t.jsxs("details",{className:"group",children:[t.jsxs("summary",{className:"text-zinc-300 text-xs cursor-pointer hover:text-white transition-colors list-none flex items-center justify-between p-2 bg-zinc-800/50 rounded",children:[t.jsx("span",{children:"System Requirements"}),t.jsx("svg",{className:"w-3 h-3 group-open:rotate-180 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx("div",{className:"mt-2 p-2 text-zinc-400 text-xs leading-relaxed",children:"Fincept Terminal works on modern web browsers. We recommend Chrome, Firefox, Safari, or Edge for the best experience."})]})]})]}),t.jsxs("div",{className:"space-y-3 pt-4 border-t border-zinc-700",children:[t.jsx("h3",{className:"text-white text-sm font-medium",children:"Quick Actions"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("button",{onClick:()=>s("register"),className:"bg-zinc-800 hover:bg-zinc-700 text-white p-3 rounded text-xs text-left transition-colors",children:[t.jsx("div",{className:"font-medium mb-1",children:"Create Account"}),t.jsx("div",{className:"text-zinc-400",children:"Get started with Fincept"})]}),t.jsxs("button",{onClick:()=>s("forgotPassword"),className:"bg-zinc-800 hover:bg-zinc-700 text-white p-3 rounded text-xs text-left transition-colors",children:[t.jsx("div",{className:"font-medium mb-1",children:"Reset Password"}),t.jsx("div",{className:"text-zinc-400",children:"Recover your account"})]})]})]}),t.jsxs("div",{className:"space-y-3 pt-4 border-t border-zinc-700",children:[t.jsx("h3",{className:"text-white text-sm font-medium",children:"Contact Information"}),t.jsxs("div",{className:"space-y-2 text-xs",children:[t.jsxs("div",{className:"flex items-center text-zinc-400",children:[t.jsx(gc,{className:"w-3 h-3 mr-2"}),t.jsx("span",{children:"support@fincept.com"})]}),t.jsxs("div",{className:"flex items-center text-zinc-400",children:[t.jsx(pg,{className:"w-3 h-3 mr-2"}),t.jsx("span",{children:"1-800-FINCEPT (346-2378)"})]}),t.jsxs("div",{className:"flex items-start text-zinc-400",children:[t.jsx("svg",{className:"w-3 h-3 mr-2 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Support Hours: Mon-Fri 9AM-6PM EST"})]})]})]})]}),t.jsx("div",{className:"mt-6 pt-4 border-t border-zinc-700",children:t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white text-xs transition-colors flex items-center",children:[t.jsx(ks,{className:"w-3 h-3 mr-1"}),"Back to Login"]}),t.jsx(Tr,{onClick:()=>alert("Opening live chat..."),className:"bg-blue-600/20 hover:bg-blue-600/30 border border-blue-600/50 text-blue-400 px-3 py-1 text-xs font-normal transition-colors",children:"Live Chat"})]})})]}),dF=({onNavigate:s,onProceedToDashboard:e,userType:r="new"})=>{const{availablePlans:n,isLoadingPlans:i,fetchPlans:o,createPaymentSession:a,session:l}=Ao(),[d,p]=S.useState(""),[f,h]=S.useState("monthly"),[x,m]=S.useState(!1),[b,w]=S.useState(""),[y,C]=S.useState(!1),T=S.useRef(!1),E=S.useRef(void 0);S.useEffect(()=>{const F=async()=>{if(T.current||y||i){console.log("Skipping plan load - already in progress or completed");return}if(n.length>0){console.log("Plans already available, skipping load"),C(!0);return}T.current=!0,console.log("Loading subscription plans from API...");try{const $=await o();$.success?(C(!0),w("")):(w($.error||"Failed to load subscription plans"),E.current=setTimeout(()=>{console.log("Retrying to load plans..."),T.current=!1,C(!1),F()},3e3))}catch($){console.error("Error loading plans:",$),w("Failed to load subscription plans")}finally{T.current=!1}},z=setTimeout(F,100);return()=>{clearTimeout(z),E.current&&clearTimeout(E.current)}},[]),S.useEffect(()=>{n.length>0&&!d&&(l?.subscription?.data?.subscription?.plan?.plan_id||l?.subscription?.subscription?.plan?.plan_id||p("starter_20"))},[n.length,d,l?.subscription]);const j=F=>({starter_20:t.jsx(Y0,{className:"w-4 h-4"}),professional_49:t.jsx(si,{className:"w-4 h-4"}),enterprise_99:t.jsx(E4,{className:"w-4 h-4"}),unlimited_199:t.jsx(H0,{className:"w-4 h-4"})})[F]||t.jsx(jo,{className:"w-4 h-4"}),k=async()=>{if(!d){w("Please select a plan");return}if(!l?.api_key){w("Authentication required. Please log in again.");return}m(!0),w("");try{console.log("Creating payment session for plan:",d);const F=await a(d);if(F.success&&F.data){console.log("Payment session created:",F.data),console.log("result.data structure:",JSON.stringify(F.data,null,2)),console.log("checkout_url direct access:",F.data.checkout_url),console.log("checkout_url via data.data:",F.data.data?.checkout_url);const z=F.data.checkout_url||F.data.data?.checkout_url;z?(console.log("Found checkout URL:",z),qf.openPaymentUrl(z),s("paymentProcessing")):(console.error("No checkout URL found in result data"),w("No payment URL received. Please try again."))}else console.error("Failed to create payment session:",F.error),w(F.error||"Failed to create payment session. Please try again.")}catch(F){console.error("Payment session error:",F),w("An unexpected error occurred. Please try again.")}finally{m(!1)}},A=()=>{console.log("Continuing with free plan"),e()},R=async()=>{w(""),C(!1),T.current=!1,console.log("Manual retry - loading plans...");const F=await o();F.success?C(!0):w(F.error||"Failed to load subscription plans")},M=F=>{const z=d===F.plan_id,$=F.price_usd,W="month",D=F.plan_id==="starter_20",oe=F.plan_id==="unlimited_199",fe=(l?.subscription?.data?.subscription?.plan?.plan_id||l?.subscription?.subscription?.plan?.plan_id)===F.plan_id;return t.jsxs("div",{onClick:()=>!fe&&p(F.plan_id),className:`
          relative rounded-lg border-2 p-4 transition-all duration-200
          ${fe?"border-green-500 bg-green-600/10 cursor-default":z?"border-blue-500 bg-blue-600/10 shadow-lg shadow-blue-500/20 cursor-pointer hover:scale-[1.02]":"border-zinc-600 bg-zinc-800/50 hover:border-zinc-500 cursor-pointer hover:scale-[1.02]"}
        `,children:[fe&&t.jsx("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2",children:t.jsx("span",{className:"bg-green-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:"Current Plan"})}),!fe&&D&&t.jsx("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2",children:t.jsx("span",{className:"bg-blue-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:"Popular"})}),!fe&&oe&&t.jsx("div",{className:"absolute -top-2 left-1/2 transform -translate-x-1/2",children:t.jsx("span",{className:"bg-orange-500 text-white text-xs font-medium px-2 py-0.5 rounded-full",children:"Best Value"})}),t.jsxs("div",{className:"text-center mb-3",children:[t.jsx("div",{className:`
            inline-flex items-center justify-center w-8 h-8 rounded-full mb-2
            ${z?"bg-blue-500 text-white":"bg-zinc-700 text-zinc-300"}
          `,children:j(F.plan_id)}),t.jsx("h3",{className:"text-white text-lg font-semibold mb-1",children:F.name}),t.jsx("div",{className:"mb-2",children:t.jsxs("div",{className:"flex items-baseline justify-center",children:[t.jsx("span",{className:"text-2xl font-bold text-white",children:qf.formatCurrency($)}),t.jsxs("span",{className:"text-zinc-400 text-xs ml-1",children:["/",W]})]})}),t.jsx("p",{className:"text-zinc-400 text-xs",children:F.description})]}),t.jsx("div",{className:"space-y-2 mb-3",children:t.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[t.jsxs("div",{className:"bg-zinc-800/30 p-1.5 rounded text-center",children:[t.jsx("div",{className:"text-zinc-400 text-xs",children:F.features.api_calls}),t.jsx("div",{className:"text-white font-medium text-xs",children:"API Calls"})]}),t.jsxs("div",{className:"bg-zinc-800/30 p-1.5 rounded text-center",children:[t.jsx("div",{className:"text-zinc-400 text-xs",children:F.features.databases}),t.jsx("div",{className:"text-white font-medium text-xs",children:"Databases"})]})]})}),t.jsx("div",{className:"space-y-1",children:t.jsxs("div",{className:"text-xs text-zinc-300 space-y-0.5",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(Es,{className:"w-3 h-3 text-green-400 mr-2 flex-shrink-0"}),t.jsx("span",{children:F.features.support})]}),F.priority_support&&t.jsxs("div",{className:"flex items-center",children:[t.jsx(Es,{className:"w-3 h-3 text-green-400 mr-2 flex-shrink-0"}),t.jsx("span",{children:"Priority support"})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(Es,{className:"w-3 h-3 text-green-400 mr-2 flex-shrink-0"}),t.jsx("span",{children:"Real-time data"})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(Es,{className:"w-3 h-3 text-green-400 mr-2 flex-shrink-0"}),t.jsx("span",{children:"Custom dashboards"})]})]})})]},F.plan_id)};if(i&&!y)return t.jsx("div",{className:"bg-zinc-900/95 backdrop-blur-sm border border-zinc-700 rounded-xl p-8 w-full max-w-md mx-auto shadow-2xl",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Hs,{className:"w-8 h-8 animate-spin text-blue-500 mx-auto mb-4"}),t.jsx("h2",{className:"text-white text-xl font-semibold mb-2",children:"Loading Plans"}),t.jsx("p",{className:"text-zinc-400 text-sm",children:"Fetching subscription options..."})]})});if(b&&n.length===0)return t.jsx("div",{className:"bg-zinc-900/95 backdrop-blur-sm border border-zinc-700 rounded-xl p-8 w-full max-w-md mx-auto shadow-2xl",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Rr,{className:"w-8 h-8 text-red-500 mx-auto mb-4"}),t.jsx("h2",{className:"text-white text-xl font-semibold mb-2",children:"Unable to Load Plans"}),t.jsx("p",{className:"text-zinc-400 text-sm mb-4",children:b}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Tr,{onClick:R,className:"w-full bg-blue-600 hover:bg-blue-500 text-white",disabled:i,children:i?t.jsxs("div",{className:"flex items-center",children:[t.jsx(Hs,{className:"w-4 h-4 animate-spin mr-2"}),"Loading..."]}):"Retry"}),r==="existing"&&t.jsx(Tr,{onClick:A,variant:"outline",className:"w-full bg-zinc-800 border-zinc-600 text-white hover:bg-zinc-700 hover:border-zinc-500",children:"Continue with Free Plan"})]})]})});const P=n.find(F=>F.plan_id===d),I=l?.subscription?.data?.subscription?.plan?.plan_id||l?.subscription?.subscription?.plan?.plan_id,O=n.find(F=>F.plan_id===I),G=l?.subscription?.data?.has_subscription||l?.subscription?.has_subscription,B=d===I;return t.jsxs("div",{className:"bg-zinc-900/95 backdrop-blur-sm border border-zinc-700 rounded-xl p-6 w-full max-w-5xl mx-auto shadow-2xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-3",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("button",{onClick:()=>{l?.authenticated?e():s("login")},className:"text-zinc-400 hover:text-white transition-colors mr-3",disabled:x,children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-xl font-semibold",children:r==="existing"?"Upgrade Your Plan":"Choose Your Plan"})]})}),t.jsx("p",{className:"text-zinc-400 text-sm",children:G&&O?`Currently on ${O.name} plan. Select a different plan to upgrade or downgrade.`:r==="existing"?"Currently on Free plan. Upgrade for advanced features and higher limits.":"Select a plan that fits your financial analysis needs. Start with 14-day free trial."})]}),n.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-zinc-400",children:"No subscription plans available at the moment."}),t.jsx(Tr,{onClick:R,className:"mt-4 bg-blue-600 hover:bg-blue-500 text-white",disabled:i,children:i?"Loading...":"Retry Loading Plans"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:n.map(M)}),b&&t.jsx("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-900/50 rounded-lg",children:t.jsxs("div",{className:"flex items-center text-red-400 text-sm",children:[t.jsx(Rr,{className:"w-4 h-4 mr-2 flex-shrink-0"}),b]})}),t.jsx("div",{className:"border-t border-zinc-700/50 pt-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[t.jsxs("div",{className:"text-center sm:text-left",children:[t.jsxs("div",{className:"text-white text-sm font-medium",children:["Selected: ",P?.name||"None"]}),t.jsx("div",{className:"text-zinc-400 text-xs",children:P?t.jsxs(t.Fragment,{children:[qf.formatCurrency(P.price_usd),"/month  14-day free trial  Cancel anytime"]}):"Select a plan to continue"})]}),t.jsxs("div",{className:"flex gap-3",children:[r==="existing"&&!G&&t.jsx(Tr,{onClick:A,variant:"outline",className:"bg-zinc-800 border-zinc-600 text-white hover:bg-zinc-700 hover:border-zinc-500 px-4 py-2 text-sm transition-colors",disabled:x,children:"Stay Free"}),G&&t.jsx(Tr,{onClick:e,variant:"outline",className:"bg-zinc-800 border-zinc-600 text-white hover:bg-zinc-700 hover:border-zinc-500 px-4 py-2 text-sm transition-colors",disabled:x,children:"Keep Current Plan"}),t.jsx(Tr,{onClick:k,disabled:!d||x||B,className:"bg-blue-600 hover:bg-blue-500 text-white font-medium px-6 py-2 text-sm transition-colors disabled:opacity-50",children:x?t.jsxs("div",{className:"flex items-center",children:[t.jsx(Hs,{className:"w-3 h-3 animate-spin mr-2"}),"Processing..."]}):B?"Current Plan":G?`Change to ${P?.name||"Plan"}`:`Start Free Trial - ${P?.name||"Plan"}`})]})]})})]})]})},uF=({onNavigate:s,onPaymentComplete:e})=>{const{session:r,refreshUserData:n}=Ao(),[i,o]=S.useState("processing"),[a,l]=S.useState(0),[d,p]=S.useState(0),[f,h]=S.useState(new Date),[x,m]=S.useState(null),[b,w]=S.useState(""),y=S.useRef(void 0),C=S.useRef(void 0),T=60,E=5e3,j=3e5,k=async()=>{if(!r?.api_key){w("Authentication required"),o("failed");return}try{console.log(`Payment status check #${a+1}`);const G=await sc.getUserSubscription(r.api_key);if(G.success&&G.data?.has_subscription){console.log("Payment completed - user now has active subscription"),o("completed"),m(G.data),await n(),y.current&&clearInterval(y.current),C.current&&clearTimeout(C.current);return}l(B=>B+1),h(new Date),a>=T&&(console.log("Payment check timeout reached"),o("timeout"),y.current&&clearInterval(y.current),C.current&&clearTimeout(C.current))}catch(G){console.error("Payment status check failed:",G),w("Failed to check payment status")}};S.useEffect(()=>{console.log("Starting payment status monitoring..."),o("waiting");const G=setTimeout(()=>{k(),y.current=setInterval(k,E)},3e3);C.current=setTimeout(()=>{console.log("Payment processing timeout"),o("timeout"),y.current&&clearInterval(y.current)},j);const B=setInterval(()=>{p(F=>F+1)},1e3);return()=>{clearTimeout(G),y.current&&clearInterval(y.current),C.current&&clearTimeout(C.current),clearInterval(B)}},[]);const A=async()=>{w(""),o("processing"),await k()},R=()=>{e()},M=()=>{s("pricing")},P=G=>{const B=Math.floor(G/60),F=G%60;return`${B}:${F.toString().padStart(2,"0")}`},O=(()=>{switch(i){case"processing":return{icon:t.jsx(Hs,{className:"w-8 h-8 animate-spin text-blue-500"}),title:"Initializing Payment Check",subtitle:"Setting up payment verification...",color:"text-blue-500"};case"waiting":return{icon:t.jsx(uo,{className:"w-8 h-8 text-yellow-500 animate-pulse"}),title:"Waiting for Payment Confirmation",subtitle:"Please complete your payment in the browser window that opened.",color:"text-yellow-500"};case"completed":return{icon:t.jsx(Bn,{className:"w-8 h-8 text-green-500"}),title:"Payment Successful!",subtitle:"Your subscription has been activated successfully.",color:"text-green-500"};case"failed":return{icon:t.jsx(Rp,{className:"w-8 h-8 text-red-500"}),title:"Payment Failed",subtitle:"There was an issue processing your payment.",color:"text-red-500"};case"cancelled":return{icon:t.jsx(Rp,{className:"w-8 h-8 text-orange-500"}),title:"Payment Cancelled",subtitle:"The payment was cancelled or not completed.",color:"text-orange-500"};case"timeout":return{icon:t.jsx(Cl,{className:"w-8 h-8 text-orange-500"}),title:"Payment Verification Timeout",subtitle:"We're still waiting for payment confirmation. This may take a few more minutes.",color:"text-orange-500"};default:return{icon:t.jsx(uo,{className:"w-8 h-8 text-gray-500"}),title:"Processing...",subtitle:"Please wait...",color:"text-gray-500"}}})();return t.jsx("div",{className:"bg-zinc-900/95 backdrop-blur-sm border border-zinc-700 rounded-xl p-8 w-full max-w-md mx-auto shadow-2xl",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"mb-6",children:O.icon}),t.jsx("h2",{className:`text-xl font-semibold mb-2 ${O.color}`,children:O.title}),t.jsx("p",{className:"text-zinc-400 text-sm mb-6",children:O.subtitle}),i==="waiting"&&t.jsxs("div",{className:"bg-zinc-800/50 rounded-lg p-4 mb-6 space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-center space-x-2 text-zinc-300",children:[t.jsx(FT,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Secure Payment Processing"})]}),t.jsxs("div",{className:"text-xs text-zinc-500 space-y-1",children:[t.jsxs("div",{children:["Time elapsed: ",P(d)]}),t.jsxs("div",{children:["Status checks: ",a,"/",T]}),t.jsxs("div",{children:["Last checked: ",f.toLocaleTimeString()]})]}),t.jsxs("div",{className:"flex items-center justify-center space-x-1 text-zinc-400",children:[t.jsx(jo,{className:"w-3 h-3"}),t.jsx("span",{className:"text-xs",children:"Encrypted & Secure"})]})]}),i==="completed"&&x&&t.jsx("div",{className:"bg-green-900/20 border border-green-900/50 rounded-lg p-4 mb-6",children:t.jsxs("div",{className:"text-sm text-green-300 space-y-2",children:[t.jsxs("div",{className:"font-medium",children:[x.subscription?.plan?.name," Plan Activated"]}),t.jsxs("div",{className:"text-xs text-green-400",children:[qf.formatCurrency(x.subscription?.plan?.price||0),"/month"]}),t.jsxs("div",{className:"text-xs text-zinc-400",children:[x.subscription?.days_remaining," days remaining in current period"]})]})}),b&&t.jsx("div",{className:"bg-red-900/20 border border-red-900/50 rounded-lg p-3 mb-6",children:t.jsxs("div",{className:"flex items-center text-red-400 text-sm",children:[t.jsx(Cl,{className:"w-4 h-4 mr-2 flex-shrink-0"}),b]})}),t.jsxs("div",{className:"space-y-3",children:[i==="completed"&&t.jsx(Tr,{onClick:R,className:"w-full bg-green-600 hover:bg-green-500 text-white font-medium",children:"Continue to Dashboard"}),(i==="waiting"||i==="processing")&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs(Tr,{onClick:A,variant:"outline",className:"w-full bg-zinc-800 border-zinc-600 text-white hover:bg-zinc-700 hover:border-zinc-500",children:[t.jsx(xn,{className:"w-4 h-4 mr-2"}),"Check Status Now"]}),t.jsx(Tr,{onClick:M,variant:"outline",className:"w-full bg-zinc-800 border-zinc-600 text-white hover:bg-zinc-700 hover:border-zinc-500",children:"Back to Plans"})]}),(i==="failed"||i==="cancelled"||i==="timeout")&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs(Tr,{onClick:A,className:"w-full bg-blue-600 hover:bg-blue-500 text-white font-medium",children:[t.jsx(xn,{className:"w-4 h-4 mr-2"}),"Check Again"]}),t.jsx(Tr,{onClick:M,variant:"outline",className:"w-full bg-zinc-800 border-zinc-600 text-white hover:bg-zinc-700 hover:border-zinc-500",children:"Back to Plans"})]})]}),t.jsx("div",{className:"mt-6 pt-4 border-t border-zinc-700/50",children:t.jsxs("div",{className:"text-xs text-zinc-500 space-y-1",children:[i==="waiting"&&t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Complete your payment in the opened browser window."}),t.jsx("p",{children:"This page will automatically update when payment is confirmed."})]}),i==="timeout"&&t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"Payment processing may take up to 10 minutes."}),t.jsx("p",{children:"You can safely close this window and check your account later."})]}),(i==="failed"||i==="cancelled")&&t.jsxs(t.Fragment,{children:[t.jsx("p",{children:"If you completed the payment, please wait a few minutes and check again."}),t.jsx("p",{children:"Contact support if issues persist."})]})]})}),i==="waiting"&&t.jsx("div",{className:"mt-4",children:t.jsx("div",{className:"w-full bg-zinc-700 rounded-full h-1",children:t.jsx("div",{className:"bg-blue-500 h-1 rounded-full transition-all duration-300",style:{width:`${Math.min(a/T*100,100)}%`}})})})]})})};var My,bC;function pF(){if(bC)return My;bC=1;var s={linear:function(e,r,n,i){var o=n-r;return o*e/i+r},easeInQuad:function(e,r,n,i){var o=n-r;return o*(e/=i)*e+r},easeOutQuad:function(e,r,n,i){var o=n-r;return-o*(e/=i)*(e-2)+r},easeInOutQuad:function(e,r,n,i){var o=n-r;return(e/=i/2)<1?o/2*e*e+r:-o/2*(--e*(e-2)-1)+r},easeInCubic:function(e,r,n,i){var o=n-r;return o*(e/=i)*e*e+r},easeOutCubic:function(e,r,n,i){var o=n-r;return o*((e=e/i-1)*e*e+1)+r},easeInOutCubic:function(e,r,n,i){var o=n-r;return(e/=i/2)<1?o/2*e*e*e+r:o/2*((e-=2)*e*e+2)+r},easeInQuart:function(e,r,n,i){var o=n-r;return o*(e/=i)*e*e*e+r},easeOutQuart:function(e,r,n,i){var o=n-r;return-o*((e=e/i-1)*e*e*e-1)+r},easeInOutQuart:function(e,r,n,i){var o=n-r;return(e/=i/2)<1?o/2*e*e*e*e+r:-o/2*((e-=2)*e*e*e-2)+r},easeInQuint:function(e,r,n,i){var o=n-r;return o*(e/=i)*e*e*e*e+r},easeOutQuint:function(e,r,n,i){var o=n-r;return o*((e=e/i-1)*e*e*e*e+1)+r},easeInOutQuint:function(e,r,n,i){var o=n-r;return(e/=i/2)<1?o/2*e*e*e*e*e+r:o/2*((e-=2)*e*e*e*e+2)+r},easeInSine:function(e,r,n,i){var o=n-r;return-o*Math.cos(e/i*(Math.PI/2))+o+r},easeOutSine:function(e,r,n,i){var o=n-r;return o*Math.sin(e/i*(Math.PI/2))+r},easeInOutSine:function(e,r,n,i){var o=n-r;return-o/2*(Math.cos(Math.PI*e/i)-1)+r},easeInExpo:function(e,r,n,i){var o=n-r;return e==0?r:o*Math.pow(2,10*(e/i-1))+r},easeOutExpo:function(e,r,n,i){var o=n-r;return e==i?r+o:o*(-Math.pow(2,-10*e/i)+1)+r},easeInOutExpo:function(e,r,n,i){var o=n-r;return e===0?r:e===i?r+o:(e/=i/2)<1?o/2*Math.pow(2,10*(e-1))+r:o/2*(-Math.pow(2,-10*--e)+2)+r},easeInCirc:function(e,r,n,i){var o=n-r;return-o*(Math.sqrt(1-(e/=i)*e)-1)+r},easeOutCirc:function(e,r,n,i){var o=n-r;return o*Math.sqrt(1-(e=e/i-1)*e)+r},easeInOutCirc:function(e,r,n,i){var o=n-r;return(e/=i/2)<1?-o/2*(Math.sqrt(1-e*e)-1)+r:o/2*(Math.sqrt(1-(e-=2)*e)+1)+r},easeInElastic:function(e,r,n,i){var o=n-r,a,l,d;return d=1.70158,l=0,a=o,e===0?r:(e/=i)===1?r+o:(l||(l=i*.3),a<Math.abs(o)?(a=o,d=l/4):d=l/(2*Math.PI)*Math.asin(o/a),-(a*Math.pow(2,10*(e-=1))*Math.sin((e*i-d)*(2*Math.PI)/l))+r)},easeOutElastic:function(e,r,n,i){var o=n-r,a,l,d;return d=1.70158,l=0,a=o,e===0?r:(e/=i)===1?r+o:(l||(l=i*.3),a<Math.abs(o)?(a=o,d=l/4):d=l/(2*Math.PI)*Math.asin(o/a),a*Math.pow(2,-10*e)*Math.sin((e*i-d)*(2*Math.PI)/l)+o+r)},easeInOutElastic:function(e,r,n,i){var o=n-r,a,l,d;return d=1.70158,l=0,a=o,e===0?r:(e/=i/2)===2?r+o:(l||(l=i*(.3*1.5)),a<Math.abs(o)?(a=o,d=l/4):d=l/(2*Math.PI)*Math.asin(o/a),e<1?-.5*(a*Math.pow(2,10*(e-=1))*Math.sin((e*i-d)*(2*Math.PI)/l))+r:a*Math.pow(2,-10*(e-=1))*Math.sin((e*i-d)*(2*Math.PI)/l)*.5+o+r)},easeInBack:function(e,r,n,i,o){var a=n-r;return o===void 0&&(o=1.70158),a*(e/=i)*e*((o+1)*e-o)+r},easeOutBack:function(e,r,n,i,o){var a=n-r;return o===void 0&&(o=1.70158),a*((e=e/i-1)*e*((o+1)*e+o)+1)+r},easeInOutBack:function(e,r,n,i,o){var a=n-r;return o===void 0&&(o=1.70158),(e/=i/2)<1?a/2*(e*e*(((o*=1.525)+1)*e-o))+r:a/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+r},easeInBounce:function(e,r,n,i){var o=n-r,a;return a=s.easeOutBounce(i-e,0,o,i),o-a+r},easeOutBounce:function(e,r,n,i){var o=n-r;return(e/=i)<1/2.75?o*(7.5625*e*e)+r:e<2/2.75?o*(7.5625*(e-=1.5/2.75)*e+.75)+r:e<2.5/2.75?o*(7.5625*(e-=2.25/2.75)*e+.9375)+r:o*(7.5625*(e-=2.625/2.75)*e+.984375)+r},easeInOutBounce:function(e,r,n,i){var o=n-r,a;return e<i/2?(a=s.easeInBounce(e*2,0,o,i),a*.5+r):(a=s.easeOutBounce(e*2-i,0,o,i),a*.5+o*.5+r)}};return My=s,My}var hF=pF();function fF(s){return s*Math.PI/180}function Pi(s,e){return s+Math.random()*(e-s)}function gF(s,e){return Math.floor(s+Math.random()*(e-s+1))}var vp;(function(s){s[s.Circle=0]="Circle",s[s.Square=1]="Square",s[s.Strip=2]="Strip"})(vp||(vp={}));var pl;(function(s){s[s.Positive=1]="Positive",s[s.Negative=-1]="Negative"})(pl||(pl={}));const xF=1e3/60;class mF{constructor(e,r,n,i){this.getOptions=r;const{colors:o,initialVelocityX:a,initialVelocityY:l}=this.getOptions();this.context=e,this.x=n,this.y=i,this.w=Pi(5,20),this.h=Pi(5,20),this.radius=Pi(5,10),this.vx=typeof a=="number"?Pi(-a,a):Pi(a.min,a.max),this.vy=typeof l=="number"?Pi(-l,0):Pi(l.min,l.max),this.shape=gF(0,2),this.angle=fF(Pi(0,360)),this.angularSpin=Pi(-.2,.2),this.color=o[Math.floor(Math.random()*o.length)],this.rotateY=Pi(0,1),this.rotationDirection=Pi(0,1)?pl.Positive:pl.Negative}update(e){const{gravity:r,wind:n,friction:i,opacity:o,drawShape:a}=this.getOptions(),l=e/xF;this.x+=this.vx*l,this.y+=this.vy*l,this.vy+=r*l,this.vx+=n*l,this.vx*=i**l,this.vy*=i**l,this.rotateY>=1&&this.rotationDirection===pl.Positive?this.rotationDirection=pl.Negative:this.rotateY<=-1&&this.rotationDirection===pl.Negative&&(this.rotationDirection=pl.Positive);const d=.1*this.rotationDirection*l;if(this.rotateY+=d,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=o,this.context.lineCap="round",this.context.lineWidth=2,a&&typeof a=="function")a.call(this,this.context);else switch(this.shape){case vp.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case vp.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case vp.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class yF{constructor(e,r){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=i=>{this.particles.splice(i,1)},this.getParticle=()=>{const i=Pi(this.x,this.w+this.x),o=Pi(this.y,this.h+this.y);return new mF(this.context,this.getOptions,i,o)},this.animate=i=>{const{canvas:o,context:a,particlesGenerated:l,lastNumberOfPieces:d}=this,{run:p,recycle:f,numberOfPieces:h,debug:x,tweenFunction:m,tweenDuration:b}=this.getOptions();if(!p)return!1;const w=this.particles.length,y=f?w:l;if(y<h){d!==h&&(this.tweenProgress=0,this.tweenFrom=y,this.lastNumberOfPieces=h),this.tweenProgress=Math.min(b,Math.max(0,this.tweenProgress+i));const C=m(this.tweenProgress,this.tweenFrom,h,b),T=Math.round(C-y);for(let E=0;E<T;E++)this.particles.push(this.getParticle());this.particlesGenerated+=T}x&&(a.font="12px sans-serif",a.fillStyle="#333",a.textAlign="right",a.fillText(`Particles: ${w}`,o.width-10,o.height-20));for(let C=this.particles.length-1;C>=0;C--){const T=this.particles[C];T.update(i),(T.y>o.height||T.y<-100||T.x>o.width+100||T.x<-100)&&(f&&y<=h?this.particles[C]=this.getParticle():this.removeParticleAt(C))}return w>0||y<h},this.canvas=e;const n=this.canvas.getContext("2d");if(!n)throw new Error("Could not get canvas context");this.context=n,this.getOptions=r}}const Kb={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:hF.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class bF{constructor(e,r){this.lastFrameTime=0,this.setOptionsWithDefaults=i=>{const o={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...o,...Kb,...i},Object.assign(this,i.confettiSource)},this.update=(i=0)=>{const{options:{run:o,onConfettiComplete:a,frameRate:l},canvas:d,context:p}=this,f=Math.min(i-this.lastFrameTime,50);if(l&&f<1e3/l){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=i-(l?f%l:0),o&&(p.fillStyle="white",p.clearRect(0,0,d.width,d.height)),this.generator.animate(f)?this.rafId=requestAnimationFrame(this.update):(a&&typeof a=="function"&&this.generator.particlesGenerated>0&&a.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=e;const n=this.canvas.getContext("2d");if(!n)throw new Error("Could not get canvas context");this.context=n,this.generator=new yF(this.canvas,()=>this.options),this.options=r,this.update()}get options(){return this._options}set options(e){const r=this._options?.run,n=this._options?.recycle;this.setOptionsWithDefaults(e),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof e.recycle=="boolean"&&e.recycle&&n===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof e.run=="boolean"&&e.run&&r===!1&&this.update()}}const vF=S.createRef();class Vb extends S.Component{constructor(e){super(e),this.canvas=S.createRef(),this.canvas=e.canvasRef||vF}componentDidMount(){if(this.canvas.current){const e=By(this.props)[0];this.confetti=new bF(this.canvas.current,e)}}componentDidUpdate(){const e=By(this.props)[0];this.confetti&&(this.confetti.options=e)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[e,r]=By(this.props),n={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...r.style};return t.jsx("canvas",{width:e.width,height:e.height,ref:this.canvas,...r,style:n})}}Vb.defaultProps={...Kb};Vb.displayName="ReactConfetti";function By(s){const e={},r={},n={},i=[...Object.keys(Kb),"confettiSource","drawShape","onConfettiComplete","frameRate"],o=["canvasRef"];for(const a in s){const l=s[a];i.includes(a)?e[a]=l:o.includes(a)?o[a]=l:n[a]=l}return[e,n,r]}const SF=S.forwardRef((s,e)=>t.jsx(Vb,{canvasRef:e,...s})),wF=({onComplete:s})=>{const{session:e,refreshUserData:r}=Ao(),[n,i]=S.useState(!0),[o,a]=S.useState(null),[l,d]=S.useState(null),[p,f]=S.useState(""),[h,x]=S.useState(5),[m,b]=S.useState(!0),[w,y]=S.useState({width:window.innerWidth,height:window.innerHeight});S.useEffect(()=>{const A=()=>{y({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[]),S.useEffect(()=>{const A=setTimeout(()=>{b(!1)},5e3);return()=>clearTimeout(A)},[]),S.useEffect(()=>{const A=new URLSearchParams(window.location.search),R=A.get("session_id"),M=A.get("payment_id");console.log("Payment success page loaded with params:",{sessionId:R,paymentId:M}),(R||M)&&window.history.replaceState({},document.title,window.location.pathname),(async()=>{if(!e?.api_key){console.log("Waiting for session to load...");return}try{if(console.log("Processing payment success..."),R||M){const O=await sc.handlePaymentSuccess(e.api_key,R||void 0,M||void 0);O.success&&O.data?(console.log("Payment success confirmed:",O.data),a(O.data)):console.log("Payment success API call failed, proceeding with subscription check")}const I=await sc.getUserSubscription(e.api_key);if(I.success&&I.data)console.log("Subscription data retrieved:",I.data),d(I.data),await r(),console.log("Payment processing complete");else throw new Error("Failed to retrieve subscription data")}catch(I){console.error("Payment success handling failed:",I),f("Failed to confirm payment. Please contact support if you were charged.")}finally{i(!1)}})()},[e?.api_key]),S.useEffect(()=>{if(!n&&!p&&h>0){const A=setTimeout(()=>{x(h-1)},1e3);return()=>clearTimeout(A)}else h===0&&s()},[n,p,h,s]);const C=()=>{s()},T=()=>{if(o){const A=`
FINCEPT API - PAYMENT RECEIPT
============================

Receipt ID: ${o.payment_uuid||"N/A"}
Date: ${new Date().toLocaleDateString()}
Description: ${l?.subscription?.plan?.name||"Subscription"} Plan
Amount: $${o.amount||l?.subscription?.plan?.price||0}
Status: Completed

Thank you for your subscription!
Visit: https://fincept.in
Support: support@fincept.in
      `.trim(),R=new Blob([A],{type:"text/plain"}),M=URL.createObjectURL(R),P=document.createElement("a");P.href=M,P.download=`fincept-receipt-${Date.now()}.txt`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(M)}};if(n)return t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"bg-zinc-900/95 backdrop-blur-sm border border-zinc-700 rounded-xl p-8 w-full max-w-md mx-auto shadow-2xl",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Hs,{className:"w-12 h-12 animate-spin text-blue-500 mx-auto mb-4"}),t.jsx("h2",{className:"text-white text-xl font-semibold mb-2",children:"Confirming Payment"}),t.jsx("p",{className:"text-zinc-400 text-sm",children:"Activating your subscription..."})]})})});if(p)return t.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:t.jsx("div",{className:"bg-zinc-900/95 backdrop-blur-sm border border-zinc-700 rounded-xl p-8 w-full max-w-md mx-auto shadow-2xl",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Rr,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),t.jsx("h2",{className:"text-white text-xl font-semibold mb-2",children:"Payment Confirmation Error"}),t.jsx("p",{className:"text-zinc-400 text-sm mb-6",children:p}),t.jsx(Tr,{onClick:C,className:"w-full bg-blue-600 hover:bg-blue-500 text-white",children:"Continue to Dashboard"}),t.jsx("p",{className:"text-xs text-zinc-500 mt-3",children:"Check your account dashboard for subscription status"})]})})});const E=l?.subscription,j=E?.plan?.name||"Premium",k=E?.plan?.price||0;return t.jsxs(t.Fragment,{children:[m&&t.jsx(SF,{width:w.width,height:w.height,recycle:!1,numberOfPieces:500,gravity:.3}),t.jsx("div",{className:"flex items-center justify-center min-h-[400px] p-4",children:t.jsxs("div",{className:"bg-gradient-to-br from-zinc-900/95 to-zinc-800/95 backdrop-blur-sm border border-green-500/30 rounded-xl p-6 sm:p-8 w-full max-w-lg mx-auto shadow-2xl",children:[t.jsx("div",{className:"text-center mb-6",children:t.jsxs("div",{className:"relative inline-block",children:[t.jsx(Bn,{className:"w-16 h-16 sm:w-20 sm:h-20 text-green-500 mx-auto animate-bounce"}),t.jsx(_d,{className:"w-6 h-6 text-yellow-400 absolute -top-2 -right-2 animate-pulse"})]})}),t.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white mb-2 text-center",children:"Payment Successful!"}),t.jsx("p",{className:"text-zinc-300 text-sm sm:text-base mb-6 text-center",children:" Your subscription is now active!"}),t.jsx("div",{className:"bg-gradient-to-r from-green-900/30 to-blue-900/30 border border-green-500/50 rounded-lg p-4 sm:p-5 mb-6",children:t.jsxs("div",{className:"text-center space-y-2",children:[t.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-white",children:[j," Plan"]}),t.jsxs("div",{className:"text-3xl sm:text-4xl font-bold text-green-400",children:["$",k,t.jsx("span",{className:"text-lg text-zinc-400",children:"/month"})]}),t.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mt-3 text-xs sm:text-sm",children:[t.jsx("span",{className:"bg-green-500/20 text-green-300 px-3 py-1 rounded-full",children:" Unlimited API Calls"}),t.jsx("span",{className:"bg-blue-500/20 text-blue-300 px-3 py-1 rounded-full",children:" Priority Support"}),t.jsx("span",{className:"bg-purple-500/20 text-purple-300 px-3 py-1 rounded-full",children:" Premium Features"})]})]})}),t.jsx("div",{className:"text-center mb-6",children:t.jsxs("p",{className:"text-zinc-400 text-sm",children:["Redirecting to dashboard in ",t.jsxs("span",{className:"text-green-400 font-bold",children:[h,"s"]})]})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs(Tr,{onClick:C,className:"w-full bg-green-600 hover:bg-green-500 text-white font-semibold py-3 text-base",children:[t.jsx(lg,{className:"w-5 h-5 mr-2"}),"Continue to Dashboard Now"]}),t.jsxs(Tr,{onClick:T,variant:"outline",className:"w-full border-zinc-600 text-zinc-300 hover:bg-zinc-800 py-3",disabled:!o&&!l,children:[t.jsx(Mi,{className:"w-4 h-4 mr-2"}),"Download Receipt"]})]}),o?.payment_uuid&&t.jsx("div",{className:"mt-6 pt-4 border-t border-zinc-700/50 text-center",children:t.jsxs("p",{className:"text-xs text-zinc-500",children:["Payment ID: ",o.payment_uuid]})})]})})]})},EF=({onNavigate:s})=>t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-lg mx-4 shadow-2xl",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:"Contact Us"})]}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Get in touch with our support team for assistance with your Fincept account."})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-white text-sm font-medium",children:"Contact Information"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-start p-3 bg-zinc-800/50 rounded",children:[t.jsx(gc,{className:"w-4 h-4 text-zinc-400 mr-3 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white text-sm font-medium",children:"Email Support"}),t.jsx("div",{className:"text-zinc-400 text-xs mt-1",children:"support@fincept.com"}),t.jsx("div",{className:"text-zinc-500 text-xs mt-1",children:"Average response time: 4-6 hours"})]})]}),t.jsxs("div",{className:"flex items-start p-3 bg-zinc-800/50 rounded",children:[t.jsx(pg,{className:"w-4 h-4 text-zinc-400 mr-3 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white text-sm font-medium",children:"Phone Support"}),t.jsx("div",{className:"text-zinc-400 text-xs mt-1",children:"1-800-FINCEPT (346-2378)"}),t.jsx("div",{className:"text-zinc-500 text-xs mt-1",children:"For urgent technical issues"})]})]}),t.jsxs("div",{className:"flex items-start p-3 bg-zinc-800/50 rounded",children:[t.jsx(uo,{className:"w-4 h-4 text-zinc-400 mr-3 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white text-sm font-medium",children:"Support Hours"}),t.jsx("div",{className:"text-zinc-400 text-xs mt-1",children:"Monday - Friday: 9:00 AM - 6:00 PM EST"}),t.jsx("div",{className:"text-zinc-400 text-xs",children:"Saturday: 10:00 AM - 4:00 PM EST"}),t.jsx("div",{className:"text-zinc-500 text-xs mt-1",children:"Emergency support available 24/7"})]})]}),t.jsxs("div",{className:"flex items-start p-3 bg-zinc-800/50 rounded",children:[t.jsx(cB,{className:"w-4 h-4 text-zinc-400 mr-3 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white text-sm font-medium",children:"Office Address"}),t.jsxs("div",{className:"text-zinc-400 text-xs mt-1",children:["Fincept LP",t.jsx("br",{}),"123 Financial District",t.jsx("br",{}),"New York, NY 10004",t.jsx("br",{}),"United States"]})]})]})]})]}),t.jsxs("div",{className:"space-y-4 pt-4 border-t border-zinc-700",children:[t.jsx("h3",{className:"text-white text-sm font-medium",children:"Quick Actions"}),t.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[t.jsxs(Tr,{onClick:()=>alert("Opening live chat..."),className:"bg-green-600/20 hover:bg-green-600/30 border border-green-600/50 text-green-400 p-3 font-normal transition-colors justify-start",children:[t.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.014 8.014 0 01-2.215-.31l-5.297 2.67c-.346.174-.735-.002-.735-.394V17.7a8 8 0 113.467-13.876"})}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"text-sm",children:"Start Live Chat"}),t.jsx("div",{className:"text-xs text-green-300",children:"Usually responds in minutes"})]})]}),t.jsxs(Tr,{onClick:()=>window.open("mailto:support@fincept.com","_blank"),className:"bg-blue-600/20 hover:bg-blue-600/30 border border-blue-600/50 text-blue-400 p-3 font-normal transition-colors justify-start",children:[t.jsx(gc,{className:"w-4 h-4 mr-2"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"text-sm",children:"Send Email"}),t.jsx("div",{className:"text-xs text-blue-300",children:"For detailed inquiries"})]})]}),t.jsxs(Tr,{onClick:()=>window.open("tel:1-800-346-2378","_blank"),className:"bg-orange-600/20 hover:bg-orange-600/30 border border-orange-600/50 text-orange-400 p-3 font-normal transition-colors justify-start",children:[t.jsx(pg,{className:"w-4 h-4 mr-2"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"text-sm",children:"Call Support"}),t.jsx("div",{className:"text-xs text-orange-300",children:"For urgent issues"})]})]})]})]}),t.jsxs("div",{className:"space-y-4 pt-4 border-t border-zinc-700",children:[t.jsx("h3",{className:"text-white text-sm font-medium",children:"Common Issues"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("button",{onClick:()=>s("help"),className:"w-full text-left p-2 bg-zinc-800/30 hover:bg-zinc-800/50 rounded text-xs transition-colors",children:[t.jsx("div",{className:"text-zinc-300",children:"Account login problems"}),t.jsx("div",{className:"text-zinc-500 mt-1",children:"Password reset, account lockouts, 2FA issues"})]}),t.jsxs("button",{onClick:()=>s("help"),className:"w-full text-left p-2 bg-zinc-800/30 hover:bg-zinc-800/50 rounded text-xs transition-colors",children:[t.jsx("div",{className:"text-zinc-300",children:"Technical difficulties"}),t.jsx("div",{className:"text-zinc-500 mt-1",children:"Platform errors, connectivity, performance"})]}),t.jsxs("button",{onClick:()=>s("help"),className:"w-full text-left p-2 bg-zinc-800/30 hover:bg-zinc-800/50 rounded text-xs transition-colors",children:[t.jsx("div",{className:"text-zinc-300",children:"Billing inquiries"}),t.jsx("div",{className:"text-zinc-500 mt-1",children:"Subscription, payments, invoices"})]})]})]})]}),t.jsx("div",{className:"mt-6 pt-4 border-t border-zinc-700",children:t.jsxs("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white text-xs transition-colors flex items-center",children:[t.jsx(ks,{className:"w-3 h-3 mr-1"}),"Back to Login"]})})]}),CF=({onNavigate:s})=>t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-2xl mx-4 shadow-2xl max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:"Terms of Service"})]}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Please read these terms carefully before using Fincept services."})]}),t.jsxs("div",{className:"space-y-6 text-sm",children:[t.jsx("div",{children:t.jsx("p",{className:"text-zinc-500 text-xs mb-4",children:"Last updated: January 1, 2025"})}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"1. Acceptance of Terms"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:'By accessing and using Fincept Terminal ("Service"), you accept and agree to be bound by the terms and provision of this agreement.'}),t.jsx("p",{children:"If you do not agree to abide by the above, please do not use this service."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"2. Description of Service"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"Fincept Terminal is a professional financial analytics and data platform that provides real-time market data, financial analysis tools, and portfolio management capabilities."}),t.jsx("p",{children:"The Service includes both free guest access with limited features and paid subscription tiers with enhanced functionality."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"3. User Accounts and Registration"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"To access certain features of the Service, you must register for an account. You agree to provide accurate, current, and complete information during the registration process."}),t.jsx("p",{children:"You are responsible for safeguarding the password and all activities that occur under your account."}),t.jsx("p",{children:"You must notify us immediately of any unauthorized use of your account."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"4. Acceptable Use Policy"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"You agree not to use the Service to:"}),t.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1 text-zinc-400",children:[t.jsx("li",{children:"Violate any applicable laws or regulations"}),t.jsx("li",{children:"Transmit any harmful, offensive, or disruptive content"}),t.jsx("li",{children:"Attempt to gain unauthorized access to our systems"}),t.jsx("li",{children:"Use automated scripts or bots without permission"}),t.jsx("li",{children:"Redistribute or resell our data without authorization"})]})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"5. Data and Privacy"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"Your privacy is important to us. Our data collection and usage practices are detailed in our Privacy Policy, which forms part of these Terms."}),t.jsx("p",{children:"Market data provided through the Service is sourced from third-party providers and is subject to their respective terms and conditions."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"6. Subscription and Billing"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"Paid subscriptions are billed in advance on a monthly or annual basis. All fees are non-refundable except as required by law."}),t.jsx("p",{children:"We reserve the right to change our pricing with 30 days' notice to existing subscribers."}),t.jsx("p",{children:"Your subscription will automatically renew unless cancelled before the renewal date."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"7. Disclaimers and Limitations"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:'The Service is provided "as is" without any warranties, express or implied. We do not guarantee the accuracy, completeness, or timeliness of market data.'}),t.jsx("p",{children:"Investment decisions should not be based solely on information provided by our Service. Always consult with qualified financial advisors."}),t.jsx("p",{children:"Our liability is limited to the amount paid for the Service in the preceding 12 months."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"8. Termination"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"We may terminate or suspend your account immediately, without prior notice, for conduct that we believe violates these Terms or is harmful to other users, us, or third parties."}),t.jsx("p",{children:"You may terminate your account at any time by contacting our support team."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"9. Changes to Terms"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"We reserve the right to modify these Terms at any time. We will notify users of significant changes via email or through the Service."}),t.jsx("p",{children:"Continued use of the Service after changes constitutes acceptance of the new Terms."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"10. Contact Information"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"If you have questions about these Terms, please contact us at:"}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded mt-2",children:[t.jsx("p",{children:"Email: legal@fincept.com"}),t.jsx("p",{children:"Phone: 1-800-FINCEPT (346-2378)"}),t.jsx("p",{children:"Address: Fincept LP, 123 Financial District, New York, NY 10004"})]})]})]})]}),t.jsxs("div",{className:"mt-8 pt-4 border-t border-zinc-700 flex justify-between items-center",children:[t.jsxs("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white text-xs transition-colors flex items-center",children:[t.jsx(ks,{className:"w-3 h-3 mr-1"}),"Back to Login"]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx("button",{onClick:()=>s("privacyPolicy"),className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",children:"Privacy Policy"}),t.jsx("button",{onClick:()=>s("contactUs"),className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",children:"Contact Us"})]})]})]}),jF=({onNavigate:s})=>t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-2xl mx-4 shadow-2xl max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:"Trademarks"})]}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Information about trademarks and intellectual property rights."})]}),t.jsxs("div",{className:"space-y-6 text-sm",children:[t.jsx("div",{children:t.jsx("p",{className:"text-zinc-500 text-xs mb-4",children:"Last updated: January 1, 2025"})}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Fincept Trademarks"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-3",children:[t.jsx("p",{children:"The following marks are trademarks or registered trademarks of Fincept LP in the United States and other countries:"}),t.jsxs("div",{className:"bg-zinc-800/50 p-4 rounded space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"font-medium text-white",children:"FINCEPT"}),t.jsx("span",{className:"text-zinc-400",children:"Registered Trademark"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"font-medium text-white",children:"FINCEPT TERMINAL"}),t.jsx("span",{className:"text-zinc-400",children:"Trademark"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"font-medium text-white",children:"B-UNIT"}),t.jsx("span",{className:"text-zinc-400",children:"Trademark"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"font-medium text-white",children:"FINCEPT ANALYTICS"}),t.jsx("span",{className:"text-zinc-400",children:"Trademark"})]})]}),t.jsx("p",{children:"All rights in these trademarks are reserved. Unauthorized use is strictly prohibited."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Third-Party Trademarks"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-3",children:[t.jsx("p",{children:"The following are trademarks or registered trademarks of their respective owners:"}),t.jsxs("div",{className:"space-y-2 text-zinc-400",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Bloomberg Terminal"}),t.jsx("span",{children:"Bloomberg Finance L.P."})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Reuters"}),t.jsx("span",{children:"Thomson Reuters Corporation"})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"S&P 500"}),t.jsx("span",{children:"S&P Global Inc."})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"NASDAQ"}),t.jsx("span",{children:"NASDAQ, Inc."})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"NYSE"}),t.jsx("span",{children:"NYSE Group, Inc."})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"FTSE"}),t.jsx("span",{children:"FTSE International Limited"})]})]}),t.jsx("p",{children:"All third-party trademarks mentioned are the property of their respective owners. Use of these marks does not imply endorsement by or affiliation with Fincept."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Trademark Guidelines"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-3",children:[t.jsx("p",{children:"If you wish to use any Fincept trademark, please follow these guidelines:"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h4",{className:"text-white text-sm font-medium",children:"Permitted Uses:"}),t.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1 text-zinc-400",children:[t.jsx("li",{children:"Referential use to identify Fincept products or services"}),t.jsx("li",{children:"Academic or journalistic references with proper attribution"}),t.jsx("li",{children:"Use in comparative advertising when truthful and not misleading"})]}),t.jsx("h4",{className:"text-white text-sm font-medium mt-4",children:"Prohibited Uses:"}),t.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1 text-zinc-400",children:[t.jsx("li",{children:"Use as part of your own trademark or business name"}),t.jsx("li",{children:"Use that implies sponsorship, endorsement, or affiliation"}),t.jsx("li",{children:"Modification, alteration, or combination with other marks"}),t.jsx("li",{children:"Use in a way that disparages or damages Fincept's reputation"})]})]})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Copyright Notice"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:" 2025 Fincept LP. All rights reserved."}),t.jsx("p",{children:"The content, features, and functionality of Fincept Terminal are protected by copyright, trademark, patent, and other intellectual property laws."}),t.jsx("p",{children:"Reproduction, modification, or distribution of any content without written permission is strictly prohibited."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Data Provider Acknowledgments"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-3",children:[t.jsx("p",{children:"Market data and financial information are provided by various third-party sources. Each data provider retains all rights to their content:"}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded text-zinc-400 text-xs space-y-1",children:[t.jsx("p",{children:" Market data  respective exchanges and data providers"}),t.jsx("p",{children:" Financial data  FactSet Research Systems Inc."}),t.jsx("p",{children:" News content  respective news organizations"}),t.jsx("p",{children:" Economic indicators  government statistical agencies"}),t.jsx("p",{children:" Corporate information  respective companies and filing authorities"})]}),t.jsx("p",{children:"Users must comply with all third-party data provider terms and conditions."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Reporting Trademark Infringement"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"If you believe your trademark rights have been infringed, or if you discover unauthorized use of Fincept trademarks, please contact us:"}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded mt-2",children:[t.jsx("p",{children:t.jsx("strong",{children:"Legal Department"})}),t.jsx("p",{children:"Email: legal@fincept.com"}),t.jsx("p",{children:"Phone: 1-800-FINCEPT (346-2378)"}),t.jsx("p",{children:"Address: Fincept LP, 123 Financial District, New York, NY 10004"})]})]})]})]}),t.jsxs("div",{className:"mt-8 pt-4 border-t border-zinc-700 flex justify-between items-center",children:[t.jsxs("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white text-xs transition-colors flex items-center",children:[t.jsx(ks,{className:"w-3 h-3 mr-1"}),"Back to Login"]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx("button",{onClick:()=>s("termsOfService"),className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",children:"Terms of Service"}),t.jsx("button",{onClick:()=>s("privacyPolicy"),className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",children:"Privacy Policy"})]})]})]}),kF=({onNavigate:s})=>t.jsxs("div",{className:"bg-zinc-900/90 backdrop-blur-sm border border-zinc-700 rounded-lg p-6 w-full max-w-2xl mx-4 shadow-2xl max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white transition-colors mr-3",children:t.jsx(ks,{className:"h-4 w-4"})}),t.jsx("h2",{className:"text-white text-2xl font-light",children:"Privacy Policy"})]}),t.jsx("p",{className:"text-zinc-400 text-xs leading-5",children:"Learn how we collect, use, and protect your personal information."})]}),t.jsxs("div",{className:"space-y-6 text-sm",children:[t.jsx("div",{children:t.jsx("p",{className:"text-zinc-500 text-xs mb-4",children:"Last updated: January 1, 2025"})}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-white text-lg font-medium mb-3 flex items-center",children:[t.jsx(jo,{className:"w-4 h-4 mr-2"}),"Our Commitment to Privacy"]}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"At Fincept, we are committed to protecting your privacy and ensuring the security of your personal information. This Privacy Policy explains how we collect, use, and safeguard your data when you use our services."}),t.jsx("p",{children:"We believe in transparency and will never sell, rent, or trade your personal information to third parties for marketing purposes."})]})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-white text-lg font-medium mb-3 flex items-center",children:[t.jsx(vi,{className:"w-4 h-4 mr-2"}),"Information We Collect"]}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-3",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Personal Information"}),t.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1 text-zinc-400",children:[t.jsx("li",{children:"Name, email address, and phone number"}),t.jsx("li",{children:"Company information and job title"}),t.jsx("li",{children:"Account credentials and authentication data"}),t.jsx("li",{children:"Billing and payment information"}),t.jsx("li",{children:"Communication preferences"})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Usage Information"}),t.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1 text-zinc-400",children:[t.jsx("li",{children:"Terminal usage patterns and feature interactions"}),t.jsx("li",{children:"Search queries and data requests"}),t.jsx("li",{children:"Session duration and frequency of use"}),t.jsx("li",{children:"Device information and browser type"}),t.jsx("li",{children:"IP address and location data"})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Financial Data"}),t.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1 text-zinc-400",children:[t.jsx("li",{children:"Portfolio compositions and holdings"}),t.jsx("li",{children:"Trading preferences and strategies"}),t.jsx("li",{children:"Watchlists and saved analyses"}),t.jsx("li",{children:"Custom dashboard configurations"})]})]})]})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-white text-lg font-medium mb-3 flex items-center",children:[t.jsx(Np,{className:"w-4 h-4 mr-2"}),"How We Use Your Information"]}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-3",children:[t.jsx("p",{children:"We use your information to:"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded",children:[t.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Service Delivery"}),t.jsxs("ul",{className:"text-zinc-400 text-xs space-y-1",children:[t.jsx("li",{children:" Provide terminal access and functionality"}),t.jsx("li",{children:" Personalize your user experience"}),t.jsx("li",{children:" Process transactions and billing"}),t.jsx("li",{children:" Deliver customer support"})]})]}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded",children:[t.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Security & Compliance"}),t.jsxs("ul",{className:"text-zinc-400 text-xs space-y-1",children:[t.jsx("li",{children:" Verify identity and prevent fraud"}),t.jsx("li",{children:" Comply with regulatory requirements"}),t.jsx("li",{children:" Monitor for suspicious activity"}),t.jsx("li",{children:" Maintain audit trails"})]})]}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded",children:[t.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Communication"}),t.jsxs("ul",{className:"text-zinc-400 text-xs space-y-1",children:[t.jsx("li",{children:" Send service notifications"}),t.jsx("li",{children:" Provide technical updates"}),t.jsx("li",{children:" Share relevant market insights"}),t.jsx("li",{children:" Respond to inquiries"})]})]}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded",children:[t.jsx("h4",{className:"text-white text-sm font-medium mb-2",children:"Improvement"}),t.jsxs("ul",{className:"text-zinc-400 text-xs space-y-1",children:[t.jsx("li",{children:" Analyze usage patterns"}),t.jsx("li",{children:" Improve platform performance"}),t.jsx("li",{children:" Develop new features"}),t.jsx("li",{children:" Enhance security measures"})]})]})]})]})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-white text-lg font-medium mb-3 flex items-center",children:[t.jsx(KB,{className:"w-4 h-4 mr-2"}),"Information Sharing"]}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"We may share your information in the following circumstances:"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"bg-zinc-800/30 p-2 rounded",children:[t.jsx("span",{className:"text-white font-medium",children:"Service Providers:"}),t.jsx("span",{className:"text-zinc-400 ml-2",children:"With trusted third parties who help deliver our services"})]}),t.jsxs("div",{className:"bg-zinc-800/30 p-2 rounded",children:[t.jsx("span",{className:"text-white font-medium",children:"Legal Requirements:"}),t.jsx("span",{className:"text-zinc-400 ml-2",children:"When required by law, regulation, or legal process"})]}),t.jsxs("div",{className:"bg-zinc-800/30 p-2 rounded",children:[t.jsx("span",{className:"text-white font-medium",children:"Business Transfer:"}),t.jsx("span",{className:"text-zinc-400 ml-2",children:"In connection with a merger, acquisition, or sale of assets"})]}),t.jsxs("div",{className:"bg-zinc-800/30 p-2 rounded",children:[t.jsx("span",{className:"text-white font-medium",children:"Consent:"}),t.jsx("span",{className:"text-zinc-400 ml-2",children:"When you explicitly consent to sharing"})]})]}),t.jsx("p",{className:"mt-3 text-zinc-400",children:"We never sell personal information to data brokers or advertising companies."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Data Security"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"We implement industry-standard security measures to protect your data:"}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded space-y-1 text-zinc-400 text-xs",children:[t.jsx("p",{children:" End-to-end encryption for data transmission"}),t.jsx("p",{children:" AES-256 encryption for data storage"}),t.jsx("p",{children:" Multi-factor authentication requirements"}),t.jsx("p",{children:" Regular security audits and penetration testing"}),t.jsx("p",{children:" SOC 2 Type II compliance"}),t.jsx("p",{children:" 24/7 security monitoring"})]})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Your Rights"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed space-y-2",children:[t.jsx("p",{children:"You have the following rights regarding your personal data:"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{className:"text-green-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Access:"})," Request a copy of your personal data"]})]}),t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{className:"text-green-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Correction:"})," Update inaccurate or incomplete information"]})]}),t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{className:"text-green-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Deletion:"})," Request deletion of your personal data"]})]}),t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{className:"text-green-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Portability:"})," Receive your data in a machine-readable format"]})]}),t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{className:"text-green-400 mr-2",children:""}),t.jsxs("span",{children:[t.jsx("strong",{children:"Opt-out:"})," Withdraw consent for data processing"]})]})]}),t.jsx("p",{className:"mt-3",children:"To exercise these rights, contact us at privacy@fincept.com or through your account settings."})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-white text-lg font-medium mb-3",children:"Contact Us"}),t.jsxs("div",{className:"text-zinc-300 text-xs leading-relaxed",children:[t.jsx("p",{className:"mb-3",children:"If you have questions about this Privacy Policy or our data practices:"}),t.jsxs("div",{className:"bg-zinc-800/50 p-3 rounded",children:[t.jsx("p",{children:t.jsx("strong",{children:"Privacy Officer"})}),t.jsx("p",{children:"Email: privacy@fincept.com"}),t.jsx("p",{children:"Phone: 1-800-FINCEPT (346-2378)"}),t.jsx("p",{children:"Address: Fincept LP, 123 Financial District, New York, NY 10004"})]})]})]})]}),t.jsxs("div",{className:"mt-8 pt-4 border-t border-zinc-700 flex justify-between items-center",children:[t.jsxs("button",{onClick:()=>s("login"),className:"text-zinc-400 hover:text-white text-xs transition-colors flex items-center",children:[t.jsx(ks,{className:"w-3 h-3 mr-1"}),"Back to Login"]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx("button",{onClick:()=>s("termsOfService"),className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",children:"Terms of Service"}),t.jsx("button",{onClick:()=>s("contactUs"),className:"text-blue-400 hover:text-blue-300 text-xs transition-colors",children:"Contact Us"})]})]})]});function vC({className:s,...e}){return t.jsx(AI,{"data-slot":"tabs",className:Bs("flex flex-col gap-2",s),...e})}function AF({className:s,...e}){return t.jsx(TI,{"data-slot":"tabs-list",className:Bs("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...e})}function _i({className:s,...e}){return t.jsx(RI,{"data-slot":"tabs-trigger",className:Bs("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...e})}function Qr({className:s,...e}){return t.jsx(NI,{"data-slot":"tabs-content",className:Bs("flex-1 outline-none",s),...e})}const QT=S.createContext(void 0),TF=()=>{const s=S.useContext(QT);if(!s)throw new Error("useInterfaceMode must be used within InterfaceModeProvider");return s},RF=({children:s})=>{const[e,r]=S.useState("terminal"),n=()=>{r(i=>i==="terminal"?"chat":"terminal")};return t.jsx(QT.Provider,{value:{mode:e,setMode:r,toggleMode:n},children:s})};class NF{constructor(){Pe(this,"baseUrl");Pe(this,"apiKey",null);this.baseUrl="https://finceptbackend.share.zrok.io"}async initialize(){try{const e=localStorage.getItem("fincept_session");if(e){const r=JSON.parse(e);this.apiKey=r.api_key||null}}catch(e){console.error("Failed to initialize chat mode API:",e)}}async quickChat(e){try{await this.initialize();const r=await fetch(`${this.baseUrl}/chat/quick-chat`,{method:"POST",headers:{"Content-Type":"application/json",...this.apiKey&&{"X-API-Key":this.apiKey}},body:JSON.stringify({content:e})});if(!r.ok)throw new Error(`API request failed: ${r.statusText}`);const n=await r.json();if(n.success)return{success:!0,data:{user_message:n.data.user_message,ai_response:n.data.ai_response,timestamp:n.data.timestamp}};throw new Error(n.message||"Unknown error")}catch(r){return console.error("Quick chat error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to send message"}}}async createSession(e){try{await this.initialize();const r=await fetch(`${this.baseUrl}/chat/sessions`,{method:"POST",headers:{"Content-Type":"application/json",...this.apiKey&&{"X-API-Key":this.apiKey}},body:JSON.stringify({title:e||"New Conversation"})});if(!r.ok)throw new Error(`Failed to create session: ${r.statusText}`);const n=await r.json();if(n.success)return{success:!0,data:n.data.session};throw new Error(n.message||"Unknown error")}catch(r){return console.error("Create session error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to create session"}}}async getSessions(){try{await this.initialize();const e=await fetch(`${this.baseUrl}/chat/sessions`,{method:"GET",headers:{"Content-Type":"application/json",...this.apiKey&&{"X-API-Key":this.apiKey}}});if(!e.ok)throw new Error(`Failed to get sessions: ${e.statusText}`);const r=await e.json();if(r.success)return{success:!0,data:r.data.sessions};throw new Error(r.message||"Unknown error")}catch(e){return console.error("Get sessions error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to get sessions"}}}async sendMessageToSession(e,r){try{await this.initialize();const n=await fetch(`${this.baseUrl}/chat/sessions/${e}/messages`,{method:"POST",headers:{"Content-Type":"application/json",...this.apiKey&&{"X-API-Key":this.apiKey}},body:JSON.stringify({content:r})});if(!n.ok)throw new Error(`Failed to send message: ${n.statusText}`);const i=await n.json();if(i.success)return{success:!0,data:{user_message:i.data.user_message,ai_message:i.data.ai_message}};throw new Error(i.message||"Unknown error")}catch(n){return console.error("Send message error:",n),{success:!1,error:n instanceof Error?n.message:"Failed to send message"}}}async getSession(e){try{await this.initialize();const r=await fetch(`${this.baseUrl}/chat/sessions/${e}`,{method:"GET",headers:{"Content-Type":"application/json",...this.apiKey&&{"X-API-Key":this.apiKey}}});if(!r.ok)throw new Error(`Failed to get session: ${r.statusText}`);const n=await r.json();if(n.success)return{success:!0,data:n.data};throw new Error(n.message||"Unknown error")}catch(r){return console.error("Get session error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to get session"}}}async deleteSession(e){try{await this.initialize();const r=await fetch(`${this.baseUrl}/chat/sessions/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",...this.apiKey&&{"X-API-Key":this.apiKey}}});if(!r.ok)throw new Error(`Failed to delete session: ${r.statusText}`);const n=await r.json();if(n.success)return{success:!0};throw new Error(n.message||"Unknown error")}catch(r){return console.error("Delete session error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to delete session"}}}async updateSessionTitle(e,r){try{await this.initialize();const n=await fetch(`${this.baseUrl}/chat/sessions/${e}/title`,{method:"PUT",headers:{"Content-Type":"application/json",...this.apiKey&&{"X-API-Key":this.apiKey}},body:JSON.stringify({title:r})});if(!n.ok)throw new Error(`Failed to update title: ${n.statusText}`);const i=await n.json();if(i.success)return{success:!0};throw new Error(i.message||"Unknown error")}catch(n){return console.error("Update title error:",n),{success:!1,error:n instanceof Error?n.message:"Failed to update title"}}}}const OF=new NF;function _F(s,e){const r={};return(s[s.length-1]===""?[...s,""]:s).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const DF=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,IF=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,PF={};function SC(s,e){return(PF.jsx?IF:DF).test(s)}const LF=/[ \t\n\f\r]/g;function zF(s){return typeof s=="object"?s.type==="text"?wC(s.value):!1:wC(s)}function wC(s){return s.replace(LF,"")===""}class Vp{constructor(e,r,n){this.normal=r,this.property=e,n&&(this.space=n)}}Vp.prototype.normal={};Vp.prototype.property={};Vp.prototype.space=void 0;function ZT(s,e){const r={},n={};for(const i of s)Object.assign(r,i.property),Object.assign(n,i.normal);return new Vp(r,n,e)}function Z0(s){return s.toLowerCase()}class Si{constructor(e,r){this.attribute=r,this.property=e}}Si.prototype.attribute="";Si.prototype.booleanish=!1;Si.prototype.boolean=!1;Si.prototype.commaOrSpaceSeparated=!1;Si.prototype.commaSeparated=!1;Si.prototype.defined=!1;Si.prototype.mustUseProperty=!1;Si.prototype.number=!1;Si.prototype.overloadedBoolean=!1;Si.prototype.property="";Si.prototype.spaceSeparated=!1;Si.prototype.space=void 0;let MF=0;const ur=vc(),ls=vc(),eb=vc(),wt=vc(),bn=vc(),wd=vc(),Ii=vc();function vc(){return 2**++MF}const tb=Object.freeze(Object.defineProperty({__proto__:null,boolean:ur,booleanish:ls,commaOrSpaceSeparated:Ii,commaSeparated:wd,number:wt,overloadedBoolean:eb,spaceSeparated:bn},Symbol.toStringTag,{value:"Module"})),Fy=Object.keys(tb);class Xb extends Si{constructor(e,r,n,i){let o=-1;if(super(e,r),EC(this,"space",i),typeof n=="number")for(;++o<Fy.length;){const a=Fy[o];EC(this,Fy[o],(n&tb[a])===tb[a])}}}Xb.prototype.defined=!0;function EC(s,e,r){r&&(s[e]=r)}function qd(s){const e={},r={};for(const[n,i]of Object.entries(s.properties)){const o=new Xb(n,s.transform(s.attributes||{},n),i,s.space);s.mustUseProperty&&s.mustUseProperty.includes(n)&&(o.mustUseProperty=!0),e[n]=o,r[Z0(n)]=n,r[Z0(o.attribute)]=n}return new Vp(e,r,s.space)}const eR=qd({properties:{ariaActiveDescendant:null,ariaAtomic:ls,ariaAutoComplete:null,ariaBusy:ls,ariaChecked:ls,ariaColCount:wt,ariaColIndex:wt,ariaColSpan:wt,ariaControls:bn,ariaCurrent:null,ariaDescribedBy:bn,ariaDetails:null,ariaDisabled:ls,ariaDropEffect:bn,ariaErrorMessage:null,ariaExpanded:ls,ariaFlowTo:bn,ariaGrabbed:ls,ariaHasPopup:null,ariaHidden:ls,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:bn,ariaLevel:wt,ariaLive:null,ariaModal:ls,ariaMultiLine:ls,ariaMultiSelectable:ls,ariaOrientation:null,ariaOwns:bn,ariaPlaceholder:null,ariaPosInSet:wt,ariaPressed:ls,ariaReadOnly:ls,ariaRelevant:null,ariaRequired:ls,ariaRoleDescription:bn,ariaRowCount:wt,ariaRowIndex:wt,ariaRowSpan:wt,ariaSelected:ls,ariaSetSize:wt,ariaSort:null,ariaValueMax:wt,ariaValueMin:wt,ariaValueNow:wt,ariaValueText:null,role:null},transform(s,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function tR(s,e){return e in s?s[e]:e}function rR(s,e){return tR(s,e.toLowerCase())}const BF=qd({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:wd,acceptCharset:bn,accessKey:bn,action:null,allow:null,allowFullScreen:ur,allowPaymentRequest:ur,allowUserMedia:ur,alt:null,as:null,async:ur,autoCapitalize:null,autoComplete:bn,autoFocus:ur,autoPlay:ur,blocking:bn,capture:null,charSet:null,checked:ur,cite:null,className:bn,cols:wt,colSpan:null,content:null,contentEditable:ls,controls:ur,controlsList:bn,coords:wt|wd,crossOrigin:null,data:null,dateTime:null,decoding:null,default:ur,defer:ur,dir:null,dirName:null,disabled:ur,download:eb,draggable:ls,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:ur,formTarget:null,headers:bn,height:wt,hidden:eb,high:wt,href:null,hrefLang:null,htmlFor:bn,httpEquiv:bn,id:null,imageSizes:null,imageSrcSet:null,inert:ur,inputMode:null,integrity:null,is:null,isMap:ur,itemId:null,itemProp:bn,itemRef:bn,itemScope:ur,itemType:bn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:ur,low:wt,manifest:null,max:null,maxLength:wt,media:null,method:null,min:null,minLength:wt,multiple:ur,muted:ur,name:null,nonce:null,noModule:ur,noValidate:ur,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:ur,optimum:wt,pattern:null,ping:bn,placeholder:null,playsInline:ur,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:ur,referrerPolicy:null,rel:bn,required:ur,reversed:ur,rows:wt,rowSpan:wt,sandbox:bn,scope:null,scoped:ur,seamless:ur,selected:ur,shadowRootClonable:ur,shadowRootDelegatesFocus:ur,shadowRootMode:null,shape:null,size:wt,sizes:null,slot:null,span:wt,spellCheck:ls,src:null,srcDoc:null,srcLang:null,srcSet:null,start:wt,step:null,style:null,tabIndex:wt,target:null,title:null,translate:null,type:null,typeMustMatch:ur,useMap:null,value:ls,width:wt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:bn,axis:null,background:null,bgColor:null,border:wt,borderColor:null,bottomMargin:wt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:ur,declare:ur,event:null,face:null,frame:null,frameBorder:null,hSpace:wt,leftMargin:wt,link:null,longDesc:null,lowSrc:null,marginHeight:wt,marginWidth:wt,noResize:ur,noHref:ur,noShade:ur,noWrap:ur,object:null,profile:null,prompt:null,rev:null,rightMargin:wt,rules:null,scheme:null,scrolling:ls,standby:null,summary:null,text:null,topMargin:wt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:wt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:ur,disableRemotePlayback:ur,prefix:null,property:null,results:wt,security:null,unselectable:null},space:"html",transform:rR}),FF=qd({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ii,accentHeight:wt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:wt,amplitude:wt,arabicForm:null,ascent:wt,attributeName:null,attributeType:null,azimuth:wt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:wt,by:null,calcMode:null,capHeight:wt,className:bn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:wt,diffuseConstant:wt,direction:null,display:null,dur:null,divisor:wt,dominantBaseline:null,download:ur,dx:null,dy:null,edgeMode:null,editable:null,elevation:wt,enableBackground:null,end:null,event:null,exponent:wt,externalResourcesRequired:null,fill:null,fillOpacity:wt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:wd,g2:wd,glyphName:wd,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:wt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:wt,horizOriginX:wt,horizOriginY:wt,id:null,ideographic:wt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:wt,k:wt,k1:wt,k2:wt,k3:wt,k4:wt,kernelMatrix:Ii,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:wt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:wt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:wt,overlineThickness:wt,paintOrder:null,panose1:null,path:null,pathLength:wt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:bn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:wt,pointsAtY:wt,pointsAtZ:wt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ii,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ii,rev:Ii,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ii,requiredFeatures:Ii,requiredFonts:Ii,requiredFormats:Ii,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:wt,specularExponent:wt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:wt,strikethroughThickness:wt,string:null,stroke:null,strokeDashArray:Ii,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:wt,strokeOpacity:wt,strokeWidth:null,style:null,surfaceScale:wt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ii,tabIndex:wt,tableValues:null,target:null,targetX:wt,targetY:wt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ii,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:wt,underlineThickness:wt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:wt,values:null,vAlphabetic:wt,vMathematical:wt,vectorEffect:null,vHanging:wt,vIdeographic:wt,version:null,vertAdvY:wt,vertOriginX:wt,vertOriginY:wt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:wt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:tR}),nR=qd({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(s,e){return"xlink:"+e.slice(5).toLowerCase()}}),sR=qd({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:rR}),iR=qd({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(s,e){return"xml:"+e.slice(3).toLowerCase()}}),$F={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},GF=/[A-Z]/g,CC=/-[a-z]/g,UF=/^data[-\w.:]+$/i;function WF(s,e){const r=Z0(e);let n=e,i=Si;if(r in s.normal)return s.property[s.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&UF.test(e)){if(e.charAt(4)==="-"){const o=e.slice(5).replace(CC,HF);n="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{const o=e.slice(4);if(!CC.test(o)){let a=o.replace(GF,qF);a.charAt(0)!=="-"&&(a="-"+a),e="data"+a}}i=Xb}return new i(n,e)}function qF(s){return"-"+s.toLowerCase()}function HF(s){return s.charAt(1).toUpperCase()}const YF=ZT([eR,BF,nR,sR,iR],"html"),Jb=ZT([eR,FF,nR,sR,iR],"svg");function KF(s){return s.join(" ").trim()}var rd={},$y,jC;function VF(){if(jC)return $y;jC=1;var s=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,r=/^\s*/,n=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,i=/^:\s*/,o=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,l=/^\s+|\s+$/g,d=`
`,p="/",f="*",h="",x="comment",m="declaration";function b(y,C){if(typeof y!="string")throw new TypeError("First argument must be a string");if(!y)return[];C=C||{};var T=1,E=1;function j(F){var z=F.match(e);z&&(T+=z.length);var $=F.lastIndexOf(d);E=~$?F.length-$:E+F.length}function k(){var F={line:T,column:E};return function(z){return z.position=new A(F),P(),z}}function A(F){this.start=F,this.end={line:T,column:E},this.source=C.source}A.prototype.content=y;function R(F){var z=new Error(C.source+":"+T+":"+E+": "+F);if(z.reason=F,z.filename=C.source,z.line=T,z.column=E,z.source=y,!C.silent)throw z}function M(F){var z=F.exec(y);if(z){var $=z[0];return j($),y=y.slice($.length),z}}function P(){M(r)}function I(F){var z;for(F=F||[];z=O();)z!==!1&&F.push(z);return F}function O(){var F=k();if(!(p!=y.charAt(0)||f!=y.charAt(1))){for(var z=2;h!=y.charAt(z)&&(f!=y.charAt(z)||p!=y.charAt(z+1));)++z;if(z+=2,h===y.charAt(z-1))return R("End of comment missing");var $=y.slice(2,z-2);return E+=2,j($),y=y.slice(z),E+=2,F({type:x,comment:$})}}function G(){var F=k(),z=M(n);if(z){if(O(),!M(i))return R("property missing ':'");var $=M(o),W=F({type:m,property:w(z[0].replace(s,h)),value:$?w($[0].replace(s,h)):h});return M(a),W}}function B(){var F=[];I(F);for(var z;z=G();)z!==!1&&(F.push(z),I(F));return F}return P(),B()}function w(y){return y?y.replace(l,h):h}return $y=b,$y}var kC;function XF(){if(kC)return rd;kC=1;var s=rd&&rd.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(rd,"__esModule",{value:!0}),rd.default=r;const e=s(VF());function r(n,i){let o=null;if(!n||typeof n!="string")return o;const a=(0,e.default)(n),l=typeof i=="function";return a.forEach(d=>{if(d.type!=="declaration")return;const{property:p,value:f}=d;l?i(p,f,d):f&&(o=o||{},o[p]=f)}),o}return rd}var Ku={},AC;function JF(){if(AC)return Ku;AC=1,Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.camelCase=void 0;var s=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,r=/^[^-]+$/,n=/^-(webkit|moz|ms|o|khtml)-/,i=/^-(ms)-/,o=function(p){return!p||r.test(p)||s.test(p)},a=function(p,f){return f.toUpperCase()},l=function(p,f){return"".concat(f,"-")},d=function(p,f){return f===void 0&&(f={}),o(p)?p:(p=p.toLowerCase(),f.reactCompat?p=p.replace(i,l):p=p.replace(n,l),p.replace(e,a))};return Ku.camelCase=d,Ku}var Vu,TC;function QF(){if(TC)return Vu;TC=1;var s=Vu&&Vu.__importDefault||function(i){return i&&i.__esModule?i:{default:i}},e=s(XF()),r=JF();function n(i,o){var a={};return!i||typeof i!="string"||(0,e.default)(i,function(l,d){l&&d&&(a[(0,r.camelCase)(l,o)]=d)}),a}return n.default=n,Vu=n,Vu}var ZF=QF();const oR=aR("end"),Qb=aR("start");function aR(s){return e;function e(r){const n=r&&r.position&&r.position[s]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function e5(s){const e=Qb(s),r=oR(s);if(e&&r)return{start:e,end:r}}function Sp(s){return!s||typeof s!="object"?"":"position"in s||"type"in s?RC(s.position):"start"in s||"end"in s?RC(s):"line"in s||"column"in s?rb(s):""}function rb(s){return NC(s&&s.line)+":"+NC(s&&s.column)}function RC(s){return rb(s&&s.start)+"-"+rb(s&&s.end)}function NC(s){return s&&typeof s=="number"?s:1}class Ks extends Error{constructor(e,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let i="",o={},a=!1;if(r&&("line"in r&&"column"in r?o={place:r}:"start"in r&&"end"in r?o={place:r}:"type"in r?o={ancestors:[r],place:r.position}:o={...r}),typeof e=="string"?i=e:!o.cause&&e&&(a=!0,i=e.message,o.cause=e),!o.ruleId&&!o.source&&typeof n=="string"){const d=n.indexOf(":");d===-1?o.ruleId=n:(o.source=n.slice(0,d),o.ruleId=n.slice(d+1))}if(!o.place&&o.ancestors&&o.ancestors){const d=o.ancestors[o.ancestors.length-1];d&&(o.place=d.position)}const l=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=l?l.line:void 0,this.name=Sp(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=a&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Ks.prototype.file="";Ks.prototype.name="";Ks.prototype.reason="";Ks.prototype.message="";Ks.prototype.stack="";Ks.prototype.column=void 0;Ks.prototype.line=void 0;Ks.prototype.ancestors=void 0;Ks.prototype.cause=void 0;Ks.prototype.fatal=void 0;Ks.prototype.place=void 0;Ks.prototype.ruleId=void 0;Ks.prototype.source=void 0;const Zb={}.hasOwnProperty,t5=new Map,r5=/[A-Z]/g,n5=new Set(["table","tbody","thead","tfoot","tr"]),s5=new Set(["td","th"]),lR="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function i5(s,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=e.filePath||void 0;let n;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=h5(r,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=p5(r,e.jsx,e.jsxs)}const i={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:n,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?Jb:YF,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},o=cR(i,s,void 0);return o&&typeof o!="string"?o:i.create(s,i.Fragment,{children:o||void 0},void 0)}function cR(s,e,r){if(e.type==="element")return o5(s,e,r);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return a5(s,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return c5(s,e,r);if(e.type==="mdxjsEsm")return l5(s,e);if(e.type==="root")return d5(s,e,r);if(e.type==="text")return u5(s,e)}function o5(s,e,r){const n=s.schema;let i=n;e.tagName.toLowerCase()==="svg"&&n.space==="html"&&(i=Jb,s.schema=i),s.ancestors.push(e);const o=uR(s,e.tagName,!1),a=f5(s,e);let l=tv(s,e);return n5.has(e.tagName)&&(l=l.filter(function(d){return typeof d=="string"?!zF(d):!0})),dR(s,a,o,e),ev(a,l),s.ancestors.pop(),s.schema=n,s.create(e,o,a,r)}function a5(s,e){if(e.data&&e.data.estree&&s.evaluater){const n=e.data.estree.body[0];return n.type,s.evaluater.evaluateExpression(n.expression)}Dp(s,e.position)}function l5(s,e){if(e.data&&e.data.estree&&s.evaluater)return s.evaluater.evaluateProgram(e.data.estree);Dp(s,e.position)}function c5(s,e,r){const n=s.schema;let i=n;e.name==="svg"&&n.space==="html"&&(i=Jb,s.schema=i),s.ancestors.push(e);const o=e.name===null?s.Fragment:uR(s,e.name,!0),a=g5(s,e),l=tv(s,e);return dR(s,a,o,e),ev(a,l),s.ancestors.pop(),s.schema=n,s.create(e,o,a,r)}function d5(s,e,r){const n={};return ev(n,tv(s,e)),s.create(e,s.Fragment,n,r)}function u5(s,e){return e.value}function dR(s,e,r,n){typeof r!="string"&&r!==s.Fragment&&s.passNode&&(e.node=n)}function ev(s,e){if(e.length>0){const r=e.length>1?e:e[0];r&&(s.children=r)}}function p5(s,e,r){return n;function n(i,o,a,l){const p=Array.isArray(a.children)?r:e;return l?p(o,a,l):p(o,a)}}function h5(s,e){return r;function r(n,i,o,a){const l=Array.isArray(o.children),d=Qb(n);return e(i,o,a,l,{columnNumber:d?d.column-1:void 0,fileName:s,lineNumber:d?d.line:void 0},void 0)}}function f5(s,e){const r={};let n,i;for(i in e.properties)if(i!=="children"&&Zb.call(e.properties,i)){const o=x5(s,i,e.properties[i]);if(o){const[a,l]=o;s.tableCellAlignToStyle&&a==="align"&&typeof l=="string"&&s5.has(e.tagName)?n=l:r[a]=l}}if(n){const o=r.style||(r.style={});o[s.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function g5(s,e){const r={};for(const n of e.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&s.evaluater){const o=n.data.estree.body[0];o.type;const a=o.expression;a.type;const l=a.properties[0];l.type,Object.assign(r,s.evaluater.evaluateExpression(l.argument))}else Dp(s,e.position);else{const i=n.name;let o;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&s.evaluater){const l=n.value.data.estree.body[0];l.type,o=s.evaluater.evaluateExpression(l.expression)}else Dp(s,e.position);else o=n.value===null?!0:n.value;r[i]=o}return r}function tv(s,e){const r=[];let n=-1;const i=s.passKeys?new Map:t5;for(;++n<e.children.length;){const o=e.children[n];let a;if(s.passKeys){const d=o.type==="element"?o.tagName:o.type==="mdxJsxFlowElement"||o.type==="mdxJsxTextElement"?o.name:void 0;if(d){const p=i.get(d)||0;a=d+"-"+p,i.set(d,p+1)}}const l=cR(s,o,a);l!==void 0&&r.push(l)}return r}function x5(s,e,r){const n=WF(s.schema,e);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?_F(r):KF(r)),n.property==="style"){let i=typeof r=="object"?r:m5(s,String(r));return s.stylePropertyNameCase==="css"&&(i=y5(i)),["style",i]}return[s.elementAttributeNameCase==="react"&&n.space?$F[n.property]||n.property:n.attribute,r]}}function m5(s,e){try{return ZF(e,{reactCompat:!0})}catch(r){if(s.ignoreInvalidStyle)return{};const n=r,i=new Ks("Cannot parse `style` attribute",{ancestors:s.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=s.filePath||void 0,i.url=lR+"#cannot-parse-style-attribute",i}}function uR(s,e,r){let n;if(!r)n={type:"Literal",value:e};else if(e.includes(".")){const i=e.split(".");let o=-1,a;for(;++o<i.length;){const l=SC(i[o])?{type:"Identifier",name:i[o]}:{type:"Literal",value:i[o]};a=a?{type:"MemberExpression",object:a,property:l,computed:!!(o&&l.type==="Literal"),optional:!1}:l}n=a}else n=SC(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(n.type==="Literal"){const i=n.value;return Zb.call(s.components,i)?s.components[i]:i}if(s.evaluater)return s.evaluater.evaluateExpression(n);Dp(s)}function Dp(s,e){const r=new Ks("Cannot handle MDX estrees without `createEvaluater`",{ancestors:s.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=s.filePath||void 0,r.url=lR+"#cannot-handle-mdx-estrees-without-createevaluater",r}function y5(s){const e={};let r;for(r in s)Zb.call(s,r)&&(e[b5(r)]=s[r]);return e}function b5(s){let e=s.replace(r5,v5);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function v5(s){return"-"+s.toLowerCase()}const Gy={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},S5={};function rv(s,e){const r=S5,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,i=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return pR(s,n,i)}function pR(s,e,r){if(w5(s)){if("value"in s)return s.type==="html"&&!r?"":s.value;if(e&&"alt"in s&&s.alt)return s.alt;if("children"in s)return OC(s.children,e,r)}return Array.isArray(s)?OC(s,e,r):""}function OC(s,e,r){const n=[];let i=-1;for(;++i<s.length;)n[i]=pR(s[i],e,r);return n.join("")}function w5(s){return!!(s&&typeof s=="object")}const _C=document.createElement("i");function nv(s){const e="&"+s+";";_C.innerHTML=e;const r=_C.textContent;return r.charCodeAt(r.length-1)===59&&s!=="semi"||r===e?!1:r}function Bi(s,e,r,n){const i=s.length;let o=0,a;if(e<0?e=-e>i?0:i+e:e=e>i?i:e,r=r>0?r:0,n.length<1e4)a=Array.from(n),a.unshift(e,r),s.splice(...a);else for(r&&s.splice(e,r);o<n.length;)a=n.slice(o,o+1e4),a.unshift(e,0),s.splice(...a),o+=1e4,e+=1e4}function oo(s,e){return s.length>0?(Bi(s,s.length,0,e),s):e}const DC={}.hasOwnProperty;function hR(s){const e={};let r=-1;for(;++r<s.length;)E5(e,s[r]);return e}function E5(s,e){let r;for(r in e){const i=(DC.call(s,r)?s[r]:void 0)||(s[r]={}),o=e[r];let a;if(o)for(a in o){DC.call(i,a)||(i[a]=[]);const l=o[a];C5(i[a],Array.isArray(l)?l:l?[l]:[])}}}function C5(s,e){let r=-1;const n=[];for(;++r<e.length;)(e[r].add==="after"?s:n).push(e[r]);Bi(s,0,0,n)}function fR(s,e){const r=Number.parseInt(s,e);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function Co(s){return s.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const ti=Al(/[A-Za-z]/),Ys=Al(/[\dA-Za-z]/),j5=Al(/[#-'*+\--9=?A-Z^-~]/);function xg(s){return s!==null&&(s<32||s===127)}const nb=Al(/\d/),k5=Al(/[\dA-Fa-f]/),A5=Al(/[!-/:-@[-`{-~]/);function Yt(s){return s!==null&&s<-2}function gn(s){return s!==null&&(s<0||s===32)}function wr(s){return s===-2||s===-1||s===32}const rx=Al(/\p{P}|\p{S}/u),yc=Al(/\s/);function Al(s){return e;function e(r){return r!==null&&r>-1&&s.test(String.fromCharCode(r))}}function Hd(s){const e=[];let r=-1,n=0,i=0;for(;++r<s.length;){const o=s.charCodeAt(r);let a="";if(o===37&&Ys(s.charCodeAt(r+1))&&Ys(s.charCodeAt(r+2)))i=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(a=String.fromCharCode(o));else if(o>55295&&o<57344){const l=s.charCodeAt(r+1);o<56320&&l>56319&&l<57344?(a=String.fromCharCode(o,l),i=1):a=""}else a=String.fromCharCode(o);a&&(e.push(s.slice(n,r),encodeURIComponent(a)),n=r+i+1,a=""),i&&(r+=i,i=0)}return e.join("")+s.slice(n)}function Fr(s,e,r,n){const i=n?n-1:Number.POSITIVE_INFINITY;let o=0;return a;function a(d){return wr(d)?(s.enter(r),l(d)):e(d)}function l(d){return wr(d)&&o++<i?(s.consume(d),l):(s.exit(r),e(d))}}const T5={tokenize:R5};function R5(s){const e=s.attempt(this.parser.constructs.contentInitial,n,i);let r;return e;function n(l){if(l===null){s.consume(l);return}return s.enter("lineEnding"),s.consume(l),s.exit("lineEnding"),Fr(s,e,"linePrefix")}function i(l){return s.enter("paragraph"),o(l)}function o(l){const d=s.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=d),r=d,a(l)}function a(l){if(l===null){s.exit("chunkText"),s.exit("paragraph"),s.consume(l);return}return Yt(l)?(s.consume(l),s.exit("chunkText"),o):(s.consume(l),a)}}const N5={tokenize:O5},IC={tokenize:_5};function O5(s){const e=this,r=[];let n=0,i,o,a;return l;function l(E){if(n<r.length){const j=r[n];return e.containerState=j[1],s.attempt(j[0].continuation,d,p)(E)}return p(E)}function d(E){if(n++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,i&&T();const j=e.events.length;let k=j,A;for(;k--;)if(e.events[k][0]==="exit"&&e.events[k][1].type==="chunkFlow"){A=e.events[k][1].end;break}C(n);let R=j;for(;R<e.events.length;)e.events[R][1].end={...A},R++;return Bi(e.events,k+1,0,e.events.slice(j)),e.events.length=R,p(E)}return l(E)}function p(E){if(n===r.length){if(!i)return x(E);if(i.currentConstruct&&i.currentConstruct.concrete)return b(E);e.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return e.containerState={},s.check(IC,f,h)(E)}function f(E){return i&&T(),C(n),x(E)}function h(E){return e.parser.lazy[e.now().line]=n!==r.length,a=e.now().offset,b(E)}function x(E){return e.containerState={},s.attempt(IC,m,b)(E)}function m(E){return n++,r.push([e.currentConstruct,e.containerState]),x(E)}function b(E){if(E===null){i&&T(),C(0),s.consume(E);return}return i=i||e.parser.flow(e.now()),s.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:o}),w(E)}function w(E){if(E===null){y(s.exit("chunkFlow"),!0),C(0),s.consume(E);return}return Yt(E)?(s.consume(E),y(s.exit("chunkFlow")),n=0,e.interrupt=void 0,l):(s.consume(E),w)}function y(E,j){const k=e.sliceStream(E);if(j&&k.push(null),E.previous=o,o&&(o.next=E),o=E,i.defineSkip(E.start),i.write(k),e.parser.lazy[E.start.line]){let A=i.events.length;for(;A--;)if(i.events[A][1].start.offset<a&&(!i.events[A][1].end||i.events[A][1].end.offset>a))return;const R=e.events.length;let M=R,P,I;for(;M--;)if(e.events[M][0]==="exit"&&e.events[M][1].type==="chunkFlow"){if(P){I=e.events[M][1].end;break}P=!0}for(C(n),A=R;A<e.events.length;)e.events[A][1].end={...I},A++;Bi(e.events,M+1,0,e.events.slice(R)),e.events.length=A}}function C(E){let j=r.length;for(;j-- >E;){const k=r[j];e.containerState=k[1],k[0].exit.call(e,s)}r.length=E}function T(){i.write([null]),o=void 0,i=void 0,e.containerState._closeFlow=void 0}}function _5(s,e,r){return Fr(s,s.attempt(this.parser.constructs.document,e,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Id(s){if(s===null||gn(s)||yc(s))return 1;if(rx(s))return 2}function nx(s,e,r){const n=[];let i=-1;for(;++i<s.length;){const o=s[i].resolveAll;o&&!n.includes(o)&&(e=o(e,r),n.push(o))}return e}const sb={name:"attention",resolveAll:D5,tokenize:I5};function D5(s,e){let r=-1,n,i,o,a,l,d,p,f;for(;++r<s.length;)if(s[r][0]==="enter"&&s[r][1].type==="attentionSequence"&&s[r][1]._close){for(n=r;n--;)if(s[n][0]==="exit"&&s[n][1].type==="attentionSequence"&&s[n][1]._open&&e.sliceSerialize(s[n][1]).charCodeAt(0)===e.sliceSerialize(s[r][1]).charCodeAt(0)){if((s[n][1]._close||s[r][1]._open)&&(s[r][1].end.offset-s[r][1].start.offset)%3&&!((s[n][1].end.offset-s[n][1].start.offset+s[r][1].end.offset-s[r][1].start.offset)%3))continue;d=s[n][1].end.offset-s[n][1].start.offset>1&&s[r][1].end.offset-s[r][1].start.offset>1?2:1;const h={...s[n][1].end},x={...s[r][1].start};PC(h,-d),PC(x,d),a={type:d>1?"strongSequence":"emphasisSequence",start:h,end:{...s[n][1].end}},l={type:d>1?"strongSequence":"emphasisSequence",start:{...s[r][1].start},end:x},o={type:d>1?"strongText":"emphasisText",start:{...s[n][1].end},end:{...s[r][1].start}},i={type:d>1?"strong":"emphasis",start:{...a.start},end:{...l.end}},s[n][1].end={...a.start},s[r][1].start={...l.end},p=[],s[n][1].end.offset-s[n][1].start.offset&&(p=oo(p,[["enter",s[n][1],e],["exit",s[n][1],e]])),p=oo(p,[["enter",i,e],["enter",a,e],["exit",a,e],["enter",o,e]]),p=oo(p,nx(e.parser.constructs.insideSpan.null,s.slice(n+1,r),e)),p=oo(p,[["exit",o,e],["enter",l,e],["exit",l,e],["exit",i,e]]),s[r][1].end.offset-s[r][1].start.offset?(f=2,p=oo(p,[["enter",s[r][1],e],["exit",s[r][1],e]])):f=0,Bi(s,n-1,r-n+3,p),r=n+p.length-f-2;break}}for(r=-1;++r<s.length;)s[r][1].type==="attentionSequence"&&(s[r][1].type="data");return s}function I5(s,e){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,i=Id(n);let o;return a;function a(d){return o=d,s.enter("attentionSequence"),l(d)}function l(d){if(d===o)return s.consume(d),l;const p=s.exit("attentionSequence"),f=Id(d),h=!f||f===2&&i||r.includes(d),x=!i||i===2&&f||r.includes(n);return p._open=!!(o===42?h:h&&(i||!x)),p._close=!!(o===42?x:x&&(f||!h)),e(d)}}function PC(s,e){s.column+=e,s.offset+=e,s._bufferIndex+=e}const P5={name:"autolink",tokenize:L5};function L5(s,e,r){let n=0;return i;function i(m){return s.enter("autolink"),s.enter("autolinkMarker"),s.consume(m),s.exit("autolinkMarker"),s.enter("autolinkProtocol"),o}function o(m){return ti(m)?(s.consume(m),a):m===64?r(m):p(m)}function a(m){return m===43||m===45||m===46||Ys(m)?(n=1,l(m)):p(m)}function l(m){return m===58?(s.consume(m),n=0,d):(m===43||m===45||m===46||Ys(m))&&n++<32?(s.consume(m),l):(n=0,p(m))}function d(m){return m===62?(s.exit("autolinkProtocol"),s.enter("autolinkMarker"),s.consume(m),s.exit("autolinkMarker"),s.exit("autolink"),e):m===null||m===32||m===60||xg(m)?r(m):(s.consume(m),d)}function p(m){return m===64?(s.consume(m),f):j5(m)?(s.consume(m),p):r(m)}function f(m){return Ys(m)?h(m):r(m)}function h(m){return m===46?(s.consume(m),n=0,f):m===62?(s.exit("autolinkProtocol").type="autolinkEmail",s.enter("autolinkMarker"),s.consume(m),s.exit("autolinkMarker"),s.exit("autolink"),e):x(m)}function x(m){if((m===45||Ys(m))&&n++<63){const b=m===45?x:h;return s.consume(m),b}return r(m)}}const Xp={partial:!0,tokenize:z5};function z5(s,e,r){return n;function n(o){return wr(o)?Fr(s,i,"linePrefix")(o):i(o)}function i(o){return o===null||Yt(o)?e(o):r(o)}}const gR={continuation:{tokenize:B5},exit:F5,name:"blockQuote",tokenize:M5};function M5(s,e,r){const n=this;return i;function i(a){if(a===62){const l=n.containerState;return l.open||(s.enter("blockQuote",{_container:!0}),l.open=!0),s.enter("blockQuotePrefix"),s.enter("blockQuoteMarker"),s.consume(a),s.exit("blockQuoteMarker"),o}return r(a)}function o(a){return wr(a)?(s.enter("blockQuotePrefixWhitespace"),s.consume(a),s.exit("blockQuotePrefixWhitespace"),s.exit("blockQuotePrefix"),e):(s.exit("blockQuotePrefix"),e(a))}}function B5(s,e,r){const n=this;return i;function i(a){return wr(a)?Fr(s,o,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):o(a)}function o(a){return s.attempt(gR,e,r)(a)}}function F5(s){s.exit("blockQuote")}const xR={name:"characterEscape",tokenize:$5};function $5(s,e,r){return n;function n(o){return s.enter("characterEscape"),s.enter("escapeMarker"),s.consume(o),s.exit("escapeMarker"),i}function i(o){return A5(o)?(s.enter("characterEscapeValue"),s.consume(o),s.exit("characterEscapeValue"),s.exit("characterEscape"),e):r(o)}}const mR={name:"characterReference",tokenize:G5};function G5(s,e,r){const n=this;let i=0,o,a;return l;function l(h){return s.enter("characterReference"),s.enter("characterReferenceMarker"),s.consume(h),s.exit("characterReferenceMarker"),d}function d(h){return h===35?(s.enter("characterReferenceMarkerNumeric"),s.consume(h),s.exit("characterReferenceMarkerNumeric"),p):(s.enter("characterReferenceValue"),o=31,a=Ys,f(h))}function p(h){return h===88||h===120?(s.enter("characterReferenceMarkerHexadecimal"),s.consume(h),s.exit("characterReferenceMarkerHexadecimal"),s.enter("characterReferenceValue"),o=6,a=k5,f):(s.enter("characterReferenceValue"),o=7,a=nb,f(h))}function f(h){if(h===59&&i){const x=s.exit("characterReferenceValue");return a===Ys&&!nv(n.sliceSerialize(x))?r(h):(s.enter("characterReferenceMarker"),s.consume(h),s.exit("characterReferenceMarker"),s.exit("characterReference"),e)}return a(h)&&i++<o?(s.consume(h),f):r(h)}}const LC={partial:!0,tokenize:W5},zC={concrete:!0,name:"codeFenced",tokenize:U5};function U5(s,e,r){const n=this,i={partial:!0,tokenize:k};let o=0,a=0,l;return d;function d(A){return p(A)}function p(A){const R=n.events[n.events.length-1];return o=R&&R[1].type==="linePrefix"?R[2].sliceSerialize(R[1],!0).length:0,l=A,s.enter("codeFenced"),s.enter("codeFencedFence"),s.enter("codeFencedFenceSequence"),f(A)}function f(A){return A===l?(a++,s.consume(A),f):a<3?r(A):(s.exit("codeFencedFenceSequence"),wr(A)?Fr(s,h,"whitespace")(A):h(A))}function h(A){return A===null||Yt(A)?(s.exit("codeFencedFence"),n.interrupt?e(A):s.check(LC,w,j)(A)):(s.enter("codeFencedFenceInfo"),s.enter("chunkString",{contentType:"string"}),x(A))}function x(A){return A===null||Yt(A)?(s.exit("chunkString"),s.exit("codeFencedFenceInfo"),h(A)):wr(A)?(s.exit("chunkString"),s.exit("codeFencedFenceInfo"),Fr(s,m,"whitespace")(A)):A===96&&A===l?r(A):(s.consume(A),x)}function m(A){return A===null||Yt(A)?h(A):(s.enter("codeFencedFenceMeta"),s.enter("chunkString",{contentType:"string"}),b(A))}function b(A){return A===null||Yt(A)?(s.exit("chunkString"),s.exit("codeFencedFenceMeta"),h(A)):A===96&&A===l?r(A):(s.consume(A),b)}function w(A){return s.attempt(i,j,y)(A)}function y(A){return s.enter("lineEnding"),s.consume(A),s.exit("lineEnding"),C}function C(A){return o>0&&wr(A)?Fr(s,T,"linePrefix",o+1)(A):T(A)}function T(A){return A===null||Yt(A)?s.check(LC,w,j)(A):(s.enter("codeFlowValue"),E(A))}function E(A){return A===null||Yt(A)?(s.exit("codeFlowValue"),T(A)):(s.consume(A),E)}function j(A){return s.exit("codeFenced"),e(A)}function k(A,R,M){let P=0;return I;function I(z){return A.enter("lineEnding"),A.consume(z),A.exit("lineEnding"),O}function O(z){return A.enter("codeFencedFence"),wr(z)?Fr(A,G,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(z):G(z)}function G(z){return z===l?(A.enter("codeFencedFenceSequence"),B(z)):M(z)}function B(z){return z===l?(P++,A.consume(z),B):P>=a?(A.exit("codeFencedFenceSequence"),wr(z)?Fr(A,F,"whitespace")(z):F(z)):M(z)}function F(z){return z===null||Yt(z)?(A.exit("codeFencedFence"),R(z)):M(z)}}}function W5(s,e,r){const n=this;return i;function i(a){return a===null?r(a):(s.enter("lineEnding"),s.consume(a),s.exit("lineEnding"),o)}function o(a){return n.parser.lazy[n.now().line]?r(a):e(a)}}const Uy={name:"codeIndented",tokenize:H5},q5={partial:!0,tokenize:Y5};function H5(s,e,r){const n=this;return i;function i(p){return s.enter("codeIndented"),Fr(s,o,"linePrefix",5)(p)}function o(p){const f=n.events[n.events.length-1];return f&&f[1].type==="linePrefix"&&f[2].sliceSerialize(f[1],!0).length>=4?a(p):r(p)}function a(p){return p===null?d(p):Yt(p)?s.attempt(q5,a,d)(p):(s.enter("codeFlowValue"),l(p))}function l(p){return p===null||Yt(p)?(s.exit("codeFlowValue"),a(p)):(s.consume(p),l)}function d(p){return s.exit("codeIndented"),e(p)}}function Y5(s,e,r){const n=this;return i;function i(a){return n.parser.lazy[n.now().line]?r(a):Yt(a)?(s.enter("lineEnding"),s.consume(a),s.exit("lineEnding"),i):Fr(s,o,"linePrefix",5)(a)}function o(a){const l=n.events[n.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(a):Yt(a)?i(a):r(a)}}const K5={name:"codeText",previous:X5,resolve:V5,tokenize:J5};function V5(s){let e=s.length-4,r=3,n,i;if((s[r][1].type==="lineEnding"||s[r][1].type==="space")&&(s[e][1].type==="lineEnding"||s[e][1].type==="space")){for(n=r;++n<e;)if(s[n][1].type==="codeTextData"){s[r][1].type="codeTextPadding",s[e][1].type="codeTextPadding",r+=2,e-=2;break}}for(n=r-1,e++;++n<=e;)i===void 0?n!==e&&s[n][1].type!=="lineEnding"&&(i=n):(n===e||s[n][1].type==="lineEnding")&&(s[i][1].type="codeTextData",n!==i+2&&(s[i][1].end=s[n-1][1].end,s.splice(i+2,n-i-2),e-=n-i-2,n=i+2),i=void 0);return s}function X5(s){return s!==96||this.events[this.events.length-1][1].type==="characterEscape"}function J5(s,e,r){let n=0,i,o;return a;function a(h){return s.enter("codeText"),s.enter("codeTextSequence"),l(h)}function l(h){return h===96?(s.consume(h),n++,l):(s.exit("codeTextSequence"),d(h))}function d(h){return h===null?r(h):h===32?(s.enter("space"),s.consume(h),s.exit("space"),d):h===96?(o=s.enter("codeTextSequence"),i=0,f(h)):Yt(h)?(s.enter("lineEnding"),s.consume(h),s.exit("lineEnding"),d):(s.enter("codeTextData"),p(h))}function p(h){return h===null||h===32||h===96||Yt(h)?(s.exit("codeTextData"),d(h)):(s.consume(h),p)}function f(h){return h===96?(s.consume(h),i++,f):i===n?(s.exit("codeTextSequence"),s.exit("codeText"),e(h)):(o.type="codeTextData",p(h))}}class Q5{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,r,n){const i=r||0;this.setCursor(Math.trunc(e));const o=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return n&&Xu(this.left,n),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Xu(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Xu(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const r=this.left.splice(e,Number.POSITIVE_INFINITY);Xu(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Xu(this.left,r.reverse())}}}function Xu(s,e){let r=0;if(e.length<1e4)s.push(...e);else for(;r<e.length;)s.push(...e.slice(r,r+1e4)),r+=1e4}function yR(s){const e={};let r=-1,n,i,o,a,l,d,p;const f=new Q5(s);for(;++r<f.length;){for(;r in e;)r=e[r];if(n=f.get(r),r&&n[1].type==="chunkFlow"&&f.get(r-1)[1].type==="listItemPrefix"&&(d=n[1]._tokenizer.events,o=0,o<d.length&&d[o][1].type==="lineEndingBlank"&&(o+=2),o<d.length&&d[o][1].type==="content"))for(;++o<d.length&&d[o][1].type!=="content";)d[o][1].type==="chunkText"&&(d[o][1]._isInFirstContentOfListItem=!0,o++);if(n[0]==="enter")n[1].contentType&&(Object.assign(e,Z5(f,r)),r=e[r],p=!0);else if(n[1]._container){for(o=r,i=void 0;o--;)if(a=f.get(o),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(i&&(f.get(i)[1].type="lineEndingBlank"),a[1].type="lineEnding",i=o);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;i&&(n[1].end={...f.get(i)[1].start},l=f.slice(i,r),l.unshift(n),f.splice(i,r-i+1,l))}}return Bi(s,0,Number.POSITIVE_INFINITY,f.slice(0)),!p}function Z5(s,e){const r=s.get(e)[1],n=s.get(e)[2];let i=e-1;const o=[];let a=r._tokenizer;a||(a=n.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const l=a.events,d=[],p={};let f,h,x=-1,m=r,b=0,w=0;const y=[w];for(;m;){for(;s.get(++i)[1]!==m;);o.push(i),m._tokenizer||(f=n.sliceStream(m),m.next||f.push(null),h&&a.defineSkip(m.start),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(f),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=r;++x<l.length;)l[x][0]==="exit"&&l[x-1][0]==="enter"&&l[x][1].type===l[x-1][1].type&&l[x][1].start.line!==l[x][1].end.line&&(w=x+1,y.push(w),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(a.events=[],m?(m._tokenizer=void 0,m.previous=void 0):y.pop(),x=y.length;x--;){const C=l.slice(y[x],y[x+1]),T=o.pop();d.push([T,T+C.length-1]),s.splice(T,2,C)}for(d.reverse(),x=-1;++x<d.length;)p[b+d[x][0]]=b+d[x][1],b+=d[x][1]-d[x][0]-1;return p}const e$={resolve:r$,tokenize:n$},t$={partial:!0,tokenize:s$};function r$(s){return yR(s),s}function n$(s,e){let r;return n;function n(l){return s.enter("content"),r=s.enter("chunkContent",{contentType:"content"}),i(l)}function i(l){return l===null?o(l):Yt(l)?s.check(t$,a,o)(l):(s.consume(l),i)}function o(l){return s.exit("chunkContent"),s.exit("content"),e(l)}function a(l){return s.consume(l),s.exit("chunkContent"),r.next=s.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,i}}function s$(s,e,r){const n=this;return i;function i(a){return s.exit("chunkContent"),s.enter("lineEnding"),s.consume(a),s.exit("lineEnding"),Fr(s,o,"linePrefix")}function o(a){if(a===null||Yt(a))return r(a);const l=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(a):s.interrupt(n.parser.constructs.flow,r,e)(a)}}function bR(s,e,r,n,i,o,a,l,d){const p=d||Number.POSITIVE_INFINITY;let f=0;return h;function h(C){return C===60?(s.enter(n),s.enter(i),s.enter(o),s.consume(C),s.exit(o),x):C===null||C===32||C===41||xg(C)?r(C):(s.enter(n),s.enter(a),s.enter(l),s.enter("chunkString",{contentType:"string"}),w(C))}function x(C){return C===62?(s.enter(o),s.consume(C),s.exit(o),s.exit(i),s.exit(n),e):(s.enter(l),s.enter("chunkString",{contentType:"string"}),m(C))}function m(C){return C===62?(s.exit("chunkString"),s.exit(l),x(C)):C===null||C===60||Yt(C)?r(C):(s.consume(C),C===92?b:m)}function b(C){return C===60||C===62||C===92?(s.consume(C),m):m(C)}function w(C){return!f&&(C===null||C===41||gn(C))?(s.exit("chunkString"),s.exit(l),s.exit(a),s.exit(n),e(C)):f<p&&C===40?(s.consume(C),f++,w):C===41?(s.consume(C),f--,w):C===null||C===32||C===40||xg(C)?r(C):(s.consume(C),C===92?y:w)}function y(C){return C===40||C===41||C===92?(s.consume(C),w):w(C)}}function vR(s,e,r,n,i,o){const a=this;let l=0,d;return p;function p(m){return s.enter(n),s.enter(i),s.consume(m),s.exit(i),s.enter(o),f}function f(m){return l>999||m===null||m===91||m===93&&!d||m===94&&!l&&"_hiddenFootnoteSupport"in a.parser.constructs?r(m):m===93?(s.exit(o),s.enter(i),s.consume(m),s.exit(i),s.exit(n),e):Yt(m)?(s.enter("lineEnding"),s.consume(m),s.exit("lineEnding"),f):(s.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||Yt(m)||l++>999?(s.exit("chunkString"),f(m)):(s.consume(m),d||(d=!wr(m)),m===92?x:h)}function x(m){return m===91||m===92||m===93?(s.consume(m),l++,h):h(m)}}function SR(s,e,r,n,i,o){let a;return l;function l(x){return x===34||x===39||x===40?(s.enter(n),s.enter(i),s.consume(x),s.exit(i),a=x===40?41:x,d):r(x)}function d(x){return x===a?(s.enter(i),s.consume(x),s.exit(i),s.exit(n),e):(s.enter(o),p(x))}function p(x){return x===a?(s.exit(o),d(a)):x===null?r(x):Yt(x)?(s.enter("lineEnding"),s.consume(x),s.exit("lineEnding"),Fr(s,p,"linePrefix")):(s.enter("chunkString",{contentType:"string"}),f(x))}function f(x){return x===a||x===null||Yt(x)?(s.exit("chunkString"),p(x)):(s.consume(x),x===92?h:f)}function h(x){return x===a||x===92?(s.consume(x),f):f(x)}}function wp(s,e){let r;return n;function n(i){return Yt(i)?(s.enter("lineEnding"),s.consume(i),s.exit("lineEnding"),r=!0,n):wr(i)?Fr(s,n,r?"linePrefix":"lineSuffix")(i):e(i)}}const i$={name:"definition",tokenize:a$},o$={partial:!0,tokenize:l$};function a$(s,e,r){const n=this;let i;return o;function o(m){return s.enter("definition"),a(m)}function a(m){return vR.call(n,s,l,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return i=Co(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),m===58?(s.enter("definitionMarker"),s.consume(m),s.exit("definitionMarker"),d):r(m)}function d(m){return gn(m)?wp(s,p)(m):p(m)}function p(m){return bR(s,f,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function f(m){return s.attempt(o$,h,h)(m)}function h(m){return wr(m)?Fr(s,x,"whitespace")(m):x(m)}function x(m){return m===null||Yt(m)?(s.exit("definition"),n.parser.defined.push(i),e(m)):r(m)}}function l$(s,e,r){return n;function n(l){return gn(l)?wp(s,i)(l):r(l)}function i(l){return SR(s,o,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function o(l){return wr(l)?Fr(s,a,"whitespace")(l):a(l)}function a(l){return l===null||Yt(l)?e(l):r(l)}}const c$={name:"hardBreakEscape",tokenize:d$};function d$(s,e,r){return n;function n(o){return s.enter("hardBreakEscape"),s.consume(o),i}function i(o){return Yt(o)?(s.exit("hardBreakEscape"),e(o)):r(o)}}const u$={name:"headingAtx",resolve:p$,tokenize:h$};function p$(s,e){let r=s.length-2,n=3,i,o;return s[n][1].type==="whitespace"&&(n+=2),r-2>n&&s[r][1].type==="whitespace"&&(r-=2),s[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&s[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(i={type:"atxHeadingText",start:s[n][1].start,end:s[r][1].end},o={type:"chunkText",start:s[n][1].start,end:s[r][1].end,contentType:"text"},Bi(s,n,r-n+1,[["enter",i,e],["enter",o,e],["exit",o,e],["exit",i,e]])),s}function h$(s,e,r){let n=0;return i;function i(f){return s.enter("atxHeading"),o(f)}function o(f){return s.enter("atxHeadingSequence"),a(f)}function a(f){return f===35&&n++<6?(s.consume(f),a):f===null||gn(f)?(s.exit("atxHeadingSequence"),l(f)):r(f)}function l(f){return f===35?(s.enter("atxHeadingSequence"),d(f)):f===null||Yt(f)?(s.exit("atxHeading"),e(f)):wr(f)?Fr(s,l,"whitespace")(f):(s.enter("atxHeadingText"),p(f))}function d(f){return f===35?(s.consume(f),d):(s.exit("atxHeadingSequence"),l(f))}function p(f){return f===null||f===35||gn(f)?(s.exit("atxHeadingText"),l(f)):(s.consume(f),p)}}const f$=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],MC=["pre","script","style","textarea"],g$={concrete:!0,name:"htmlFlow",resolveTo:y$,tokenize:b$},x$={partial:!0,tokenize:S$},m$={partial:!0,tokenize:v$};function y$(s){let e=s.length;for(;e--&&!(s[e][0]==="enter"&&s[e][1].type==="htmlFlow"););return e>1&&s[e-2][1].type==="linePrefix"&&(s[e][1].start=s[e-2][1].start,s[e+1][1].start=s[e-2][1].start,s.splice(e-2,2)),s}function b$(s,e,r){const n=this;let i,o,a,l,d;return p;function p(_){return f(_)}function f(_){return s.enter("htmlFlow"),s.enter("htmlFlowData"),s.consume(_),h}function h(_){return _===33?(s.consume(_),x):_===47?(s.consume(_),o=!0,w):_===63?(s.consume(_),i=3,n.interrupt?e:Z):ti(_)?(s.consume(_),a=String.fromCharCode(_),y):r(_)}function x(_){return _===45?(s.consume(_),i=2,m):_===91?(s.consume(_),i=5,l=0,b):ti(_)?(s.consume(_),i=4,n.interrupt?e:Z):r(_)}function m(_){return _===45?(s.consume(_),n.interrupt?e:Z):r(_)}function b(_){const Y="CDATA[";return _===Y.charCodeAt(l++)?(s.consume(_),l===Y.length?n.interrupt?e:G:b):r(_)}function w(_){return ti(_)?(s.consume(_),a=String.fromCharCode(_),y):r(_)}function y(_){if(_===null||_===47||_===62||gn(_)){const Y=_===47,he=a.toLowerCase();return!Y&&!o&&MC.includes(he)?(i=1,n.interrupt?e(_):G(_)):f$.includes(a.toLowerCase())?(i=6,Y?(s.consume(_),C):n.interrupt?e(_):G(_)):(i=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(_):o?T(_):E(_))}return _===45||Ys(_)?(s.consume(_),a+=String.fromCharCode(_),y):r(_)}function C(_){return _===62?(s.consume(_),n.interrupt?e:G):r(_)}function T(_){return wr(_)?(s.consume(_),T):I(_)}function E(_){return _===47?(s.consume(_),I):_===58||_===95||ti(_)?(s.consume(_),j):wr(_)?(s.consume(_),E):I(_)}function j(_){return _===45||_===46||_===58||_===95||Ys(_)?(s.consume(_),j):k(_)}function k(_){return _===61?(s.consume(_),A):wr(_)?(s.consume(_),k):E(_)}function A(_){return _===null||_===60||_===61||_===62||_===96?r(_):_===34||_===39?(s.consume(_),d=_,R):wr(_)?(s.consume(_),A):M(_)}function R(_){return _===d?(s.consume(_),d=null,P):_===null||Yt(_)?r(_):(s.consume(_),R)}function M(_){return _===null||_===34||_===39||_===47||_===60||_===61||_===62||_===96||gn(_)?k(_):(s.consume(_),M)}function P(_){return _===47||_===62||wr(_)?E(_):r(_)}function I(_){return _===62?(s.consume(_),O):r(_)}function O(_){return _===null||Yt(_)?G(_):wr(_)?(s.consume(_),O):r(_)}function G(_){return _===45&&i===2?(s.consume(_),$):_===60&&i===1?(s.consume(_),W):_===62&&i===4?(s.consume(_),fe):_===63&&i===3?(s.consume(_),Z):_===93&&i===5?(s.consume(_),oe):Yt(_)&&(i===6||i===7)?(s.exit("htmlFlowData"),s.check(x$,Q,B)(_)):_===null||Yt(_)?(s.exit("htmlFlowData"),B(_)):(s.consume(_),G)}function B(_){return s.check(m$,F,Q)(_)}function F(_){return s.enter("lineEnding"),s.consume(_),s.exit("lineEnding"),z}function z(_){return _===null||Yt(_)?B(_):(s.enter("htmlFlowData"),G(_))}function $(_){return _===45?(s.consume(_),Z):G(_)}function W(_){return _===47?(s.consume(_),a="",D):G(_)}function D(_){if(_===62){const Y=a.toLowerCase();return MC.includes(Y)?(s.consume(_),fe):G(_)}return ti(_)&&a.length<8?(s.consume(_),a+=String.fromCharCode(_),D):G(_)}function oe(_){return _===93?(s.consume(_),Z):G(_)}function Z(_){return _===62?(s.consume(_),fe):_===45&&i===2?(s.consume(_),Z):G(_)}function fe(_){return _===null||Yt(_)?(s.exit("htmlFlowData"),Q(_)):(s.consume(_),fe)}function Q(_){return s.exit("htmlFlow"),e(_)}}function v$(s,e,r){const n=this;return i;function i(a){return Yt(a)?(s.enter("lineEnding"),s.consume(a),s.exit("lineEnding"),o):r(a)}function o(a){return n.parser.lazy[n.now().line]?r(a):e(a)}}function S$(s,e,r){return n;function n(i){return s.enter("lineEnding"),s.consume(i),s.exit("lineEnding"),s.attempt(Xp,e,r)}}const w$={name:"htmlText",tokenize:E$};function E$(s,e,r){const n=this;let i,o,a;return l;function l(Z){return s.enter("htmlText"),s.enter("htmlTextData"),s.consume(Z),d}function d(Z){return Z===33?(s.consume(Z),p):Z===47?(s.consume(Z),k):Z===63?(s.consume(Z),E):ti(Z)?(s.consume(Z),M):r(Z)}function p(Z){return Z===45?(s.consume(Z),f):Z===91?(s.consume(Z),o=0,b):ti(Z)?(s.consume(Z),T):r(Z)}function f(Z){return Z===45?(s.consume(Z),m):r(Z)}function h(Z){return Z===null?r(Z):Z===45?(s.consume(Z),x):Yt(Z)?(a=h,W(Z)):(s.consume(Z),h)}function x(Z){return Z===45?(s.consume(Z),m):h(Z)}function m(Z){return Z===62?$(Z):Z===45?x(Z):h(Z)}function b(Z){const fe="CDATA[";return Z===fe.charCodeAt(o++)?(s.consume(Z),o===fe.length?w:b):r(Z)}function w(Z){return Z===null?r(Z):Z===93?(s.consume(Z),y):Yt(Z)?(a=w,W(Z)):(s.consume(Z),w)}function y(Z){return Z===93?(s.consume(Z),C):w(Z)}function C(Z){return Z===62?$(Z):Z===93?(s.consume(Z),C):w(Z)}function T(Z){return Z===null||Z===62?$(Z):Yt(Z)?(a=T,W(Z)):(s.consume(Z),T)}function E(Z){return Z===null?r(Z):Z===63?(s.consume(Z),j):Yt(Z)?(a=E,W(Z)):(s.consume(Z),E)}function j(Z){return Z===62?$(Z):E(Z)}function k(Z){return ti(Z)?(s.consume(Z),A):r(Z)}function A(Z){return Z===45||Ys(Z)?(s.consume(Z),A):R(Z)}function R(Z){return Yt(Z)?(a=R,W(Z)):wr(Z)?(s.consume(Z),R):$(Z)}function M(Z){return Z===45||Ys(Z)?(s.consume(Z),M):Z===47||Z===62||gn(Z)?P(Z):r(Z)}function P(Z){return Z===47?(s.consume(Z),$):Z===58||Z===95||ti(Z)?(s.consume(Z),I):Yt(Z)?(a=P,W(Z)):wr(Z)?(s.consume(Z),P):$(Z)}function I(Z){return Z===45||Z===46||Z===58||Z===95||Ys(Z)?(s.consume(Z),I):O(Z)}function O(Z){return Z===61?(s.consume(Z),G):Yt(Z)?(a=O,W(Z)):wr(Z)?(s.consume(Z),O):P(Z)}function G(Z){return Z===null||Z===60||Z===61||Z===62||Z===96?r(Z):Z===34||Z===39?(s.consume(Z),i=Z,B):Yt(Z)?(a=G,W(Z)):wr(Z)?(s.consume(Z),G):(s.consume(Z),F)}function B(Z){return Z===i?(s.consume(Z),i=void 0,z):Z===null?r(Z):Yt(Z)?(a=B,W(Z)):(s.consume(Z),B)}function F(Z){return Z===null||Z===34||Z===39||Z===60||Z===61||Z===96?r(Z):Z===47||Z===62||gn(Z)?P(Z):(s.consume(Z),F)}function z(Z){return Z===47||Z===62||gn(Z)?P(Z):r(Z)}function $(Z){return Z===62?(s.consume(Z),s.exit("htmlTextData"),s.exit("htmlText"),e):r(Z)}function W(Z){return s.exit("htmlTextData"),s.enter("lineEnding"),s.consume(Z),s.exit("lineEnding"),D}function D(Z){return wr(Z)?Fr(s,oe,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(Z):oe(Z)}function oe(Z){return s.enter("htmlTextData"),a(Z)}}const sv={name:"labelEnd",resolveAll:A$,resolveTo:T$,tokenize:R$},C$={tokenize:N$},j$={tokenize:O$},k$={tokenize:_$};function A$(s){let e=-1;const r=[];for(;++e<s.length;){const n=s[e][1];if(r.push(s[e]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const i=n.type==="labelImage"?4:2;n.type="data",e+=i}}return s.length!==r.length&&Bi(s,0,s.length,r),s}function T$(s,e){let r=s.length,n=0,i,o,a,l;for(;r--;)if(i=s[r][1],o){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;s[r][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(a){if(s[r][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(o=r,i.type!=="labelLink")){n=2;break}}else i.type==="labelEnd"&&(a=r);const d={type:s[o][1].type==="labelLink"?"link":"image",start:{...s[o][1].start},end:{...s[s.length-1][1].end}},p={type:"label",start:{...s[o][1].start},end:{...s[a][1].end}},f={type:"labelText",start:{...s[o+n+2][1].end},end:{...s[a-2][1].start}};return l=[["enter",d,e],["enter",p,e]],l=oo(l,s.slice(o+1,o+n+3)),l=oo(l,[["enter",f,e]]),l=oo(l,nx(e.parser.constructs.insideSpan.null,s.slice(o+n+4,a-3),e)),l=oo(l,[["exit",f,e],s[a-2],s[a-1],["exit",p,e]]),l=oo(l,s.slice(a+1)),l=oo(l,[["exit",d,e]]),Bi(s,o,s.length,l),s}function R$(s,e,r){const n=this;let i=n.events.length,o,a;for(;i--;)if((n.events[i][1].type==="labelImage"||n.events[i][1].type==="labelLink")&&!n.events[i][1]._balanced){o=n.events[i][1];break}return l;function l(x){return o?o._inactive?h(x):(a=n.parser.defined.includes(Co(n.sliceSerialize({start:o.end,end:n.now()}))),s.enter("labelEnd"),s.enter("labelMarker"),s.consume(x),s.exit("labelMarker"),s.exit("labelEnd"),d):r(x)}function d(x){return x===40?s.attempt(C$,f,a?f:h)(x):x===91?s.attempt(j$,f,a?p:h)(x):a?f(x):h(x)}function p(x){return s.attempt(k$,f,h)(x)}function f(x){return e(x)}function h(x){return o._balanced=!0,r(x)}}function N$(s,e,r){return n;function n(h){return s.enter("resource"),s.enter("resourceMarker"),s.consume(h),s.exit("resourceMarker"),i}function i(h){return gn(h)?wp(s,o)(h):o(h)}function o(h){return h===41?f(h):bR(s,a,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function a(h){return gn(h)?wp(s,d)(h):f(h)}function l(h){return r(h)}function d(h){return h===34||h===39||h===40?SR(s,p,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):f(h)}function p(h){return gn(h)?wp(s,f)(h):f(h)}function f(h){return h===41?(s.enter("resourceMarker"),s.consume(h),s.exit("resourceMarker"),s.exit("resource"),e):r(h)}}function O$(s,e,r){const n=this;return i;function i(l){return vR.call(n,s,o,a,"reference","referenceMarker","referenceString")(l)}function o(l){return n.parser.defined.includes(Co(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?e(l):r(l)}function a(l){return r(l)}}function _$(s,e,r){return n;function n(o){return s.enter("reference"),s.enter("referenceMarker"),s.consume(o),s.exit("referenceMarker"),i}function i(o){return o===93?(s.enter("referenceMarker"),s.consume(o),s.exit("referenceMarker"),s.exit("reference"),e):r(o)}}const D$={name:"labelStartImage",resolveAll:sv.resolveAll,tokenize:I$};function I$(s,e,r){const n=this;return i;function i(l){return s.enter("labelImage"),s.enter("labelImageMarker"),s.consume(l),s.exit("labelImageMarker"),o}function o(l){return l===91?(s.enter("labelMarker"),s.consume(l),s.exit("labelMarker"),s.exit("labelImage"),a):r(l)}function a(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):e(l)}}const P$={name:"labelStartLink",resolveAll:sv.resolveAll,tokenize:L$};function L$(s,e,r){const n=this;return i;function i(a){return s.enter("labelLink"),s.enter("labelMarker"),s.consume(a),s.exit("labelMarker"),s.exit("labelLink"),o}function o(a){return a===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(a):e(a)}}const Wy={name:"lineEnding",tokenize:z$};function z$(s,e){return r;function r(n){return s.enter("lineEnding"),s.consume(n),s.exit("lineEnding"),Fr(s,e,"linePrefix")}}const Vf={name:"thematicBreak",tokenize:M$};function M$(s,e,r){let n=0,i;return o;function o(p){return s.enter("thematicBreak"),a(p)}function a(p){return i=p,l(p)}function l(p){return p===i?(s.enter("thematicBreakSequence"),d(p)):n>=3&&(p===null||Yt(p))?(s.exit("thematicBreak"),e(p)):r(p)}function d(p){return p===i?(s.consume(p),n++,d):(s.exit("thematicBreakSequence"),wr(p)?Fr(s,l,"whitespace")(p):l(p))}}const hi={continuation:{tokenize:G$},exit:W$,name:"list",tokenize:$$},B$={partial:!0,tokenize:q$},F$={partial:!0,tokenize:U$};function $$(s,e,r){const n=this,i=n.events[n.events.length-1];let o=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,a=0;return l;function l(m){const b=n.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(b==="listUnordered"?!n.containerState.marker||m===n.containerState.marker:nb(m)){if(n.containerState.type||(n.containerState.type=b,s.enter(b,{_container:!0})),b==="listUnordered")return s.enter("listItemPrefix"),m===42||m===45?s.check(Vf,r,p)(m):p(m);if(!n.interrupt||m===49)return s.enter("listItemPrefix"),s.enter("listItemValue"),d(m)}return r(m)}function d(m){return nb(m)&&++a<10?(s.consume(m),d):(!n.interrupt||a<2)&&(n.containerState.marker?m===n.containerState.marker:m===41||m===46)?(s.exit("listItemValue"),p(m)):r(m)}function p(m){return s.enter("listItemMarker"),s.consume(m),s.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||m,s.check(Xp,n.interrupt?r:f,s.attempt(B$,x,h))}function f(m){return n.containerState.initialBlankLine=!0,o++,x(m)}function h(m){return wr(m)?(s.enter("listItemPrefixWhitespace"),s.consume(m),s.exit("listItemPrefixWhitespace"),x):r(m)}function x(m){return n.containerState.size=o+n.sliceSerialize(s.exit("listItemPrefix"),!0).length,e(m)}}function G$(s,e,r){const n=this;return n.containerState._closeFlow=void 0,s.check(Xp,i,o);function i(l){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Fr(s,e,"listItemIndent",n.containerState.size+1)(l)}function o(l){return n.containerState.furtherBlankLines||!wr(l)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,a(l)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,s.attempt(F$,e,a)(l))}function a(l){return n.containerState._closeFlow=!0,n.interrupt=void 0,Fr(s,s.attempt(hi,e,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function U$(s,e,r){const n=this;return Fr(s,i,"listItemIndent",n.containerState.size+1);function i(o){const a=n.events[n.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===n.containerState.size?e(o):r(o)}}function W$(s){s.exit(this.containerState.type)}function q$(s,e,r){const n=this;return Fr(s,i,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(o){const a=n.events[n.events.length-1];return!wr(o)&&a&&a[1].type==="listItemPrefixWhitespace"?e(o):r(o)}}const BC={name:"setextUnderline",resolveTo:H$,tokenize:Y$};function H$(s,e){let r=s.length,n,i,o;for(;r--;)if(s[r][0]==="enter"){if(s[r][1].type==="content"){n=r;break}s[r][1].type==="paragraph"&&(i=r)}else s[r][1].type==="content"&&s.splice(r,1),!o&&s[r][1].type==="definition"&&(o=r);const a={type:"setextHeading",start:{...s[n][1].start},end:{...s[s.length-1][1].end}};return s[i][1].type="setextHeadingText",o?(s.splice(i,0,["enter",a,e]),s.splice(o+1,0,["exit",s[n][1],e]),s[n][1].end={...s[o][1].end}):s[n][1]=a,s.push(["exit",a,e]),s}function Y$(s,e,r){const n=this;let i;return o;function o(p){let f=n.events.length,h;for(;f--;)if(n.events[f][1].type!=="lineEnding"&&n.events[f][1].type!=="linePrefix"&&n.events[f][1].type!=="content"){h=n.events[f][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(s.enter("setextHeadingLine"),i=p,a(p)):r(p)}function a(p){return s.enter("setextHeadingLineSequence"),l(p)}function l(p){return p===i?(s.consume(p),l):(s.exit("setextHeadingLineSequence"),wr(p)?Fr(s,d,"lineSuffix")(p):d(p))}function d(p){return p===null||Yt(p)?(s.exit("setextHeadingLine"),e(p)):r(p)}}const K$={tokenize:V$};function V$(s){const e=this,r=s.attempt(Xp,n,s.attempt(this.parser.constructs.flowInitial,i,Fr(s,s.attempt(this.parser.constructs.flow,i,s.attempt(e$,i)),"linePrefix")));return r;function n(o){if(o===null){s.consume(o);return}return s.enter("lineEndingBlank"),s.consume(o),s.exit("lineEndingBlank"),e.currentConstruct=void 0,r}function i(o){if(o===null){s.consume(o);return}return s.enter("lineEnding"),s.consume(o),s.exit("lineEnding"),e.currentConstruct=void 0,r}}const X$={resolveAll:ER()},J$=wR("string"),Q$=wR("text");function wR(s){return{resolveAll:ER(s==="text"?Z$:void 0),tokenize:e};function e(r){const n=this,i=this.parser.constructs[s],o=r.attempt(i,a,l);return a;function a(f){return p(f)?o(f):l(f)}function l(f){if(f===null){r.consume(f);return}return r.enter("data"),r.consume(f),d}function d(f){return p(f)?(r.exit("data"),o(f)):(r.consume(f),d)}function p(f){if(f===null)return!0;const h=i[f];let x=-1;if(h)for(;++x<h.length;){const m=h[x];if(!m.previous||m.previous.call(n,n.previous))return!0}return!1}}}function ER(s){return e;function e(r,n){let i=-1,o;for(;++i<=r.length;)o===void 0?r[i]&&r[i][1].type==="data"&&(o=i,i++):(!r[i]||r[i][1].type!=="data")&&(i!==o+2&&(r[o][1].end=r[i-1][1].end,r.splice(o+2,i-o-2),i=o+2),o=void 0);return s?s(r,n):r}}function Z$(s,e){let r=0;for(;++r<=s.length;)if((r===s.length||s[r][1].type==="lineEnding")&&s[r-1][1].type==="data"){const n=s[r-1][1],i=e.sliceStream(n);let o=i.length,a=-1,l=0,d;for(;o--;){const p=i[o];if(typeof p=="string"){for(a=p.length;p.charCodeAt(a-1)===32;)l++,a--;if(a)break;a=-1}else if(p===-2)d=!0,l++;else if(p!==-1){o++;break}}if(e._contentTypeTextTrailing&&r===s.length&&(l=0),l){const p={type:r===s.length||d||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:o?a:n.start._bufferIndex+a,_index:n.start._index+o,line:n.end.line,column:n.end.column-l,offset:n.end.offset-l},end:{...n.end}};n.end={...p.start},n.start.offset===n.end.offset?Object.assign(n,p):(s.splice(r,0,["enter",p,e],["exit",p,e]),r+=2)}r++}return s}const e8={42:hi,43:hi,45:hi,48:hi,49:hi,50:hi,51:hi,52:hi,53:hi,54:hi,55:hi,56:hi,57:hi,62:gR},t8={91:i$},r8={[-2]:Uy,[-1]:Uy,32:Uy},n8={35:u$,42:Vf,45:[BC,Vf],60:g$,61:BC,95:Vf,96:zC,126:zC},s8={38:mR,92:xR},i8={[-5]:Wy,[-4]:Wy,[-3]:Wy,33:D$,38:mR,42:sb,60:[P5,w$],91:P$,92:[c$,xR],93:sv,95:sb,96:K5},o8={null:[sb,X$]},a8={null:[42,95]},l8={null:[]},c8=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:a8,contentInitial:t8,disable:l8,document:e8,flow:n8,flowInitial:r8,insideSpan:o8,string:s8,text:i8},Symbol.toStringTag,{value:"Module"}));function d8(s,e,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const i={},o=[];let a=[],l=[];const d={attempt:R(k),check:R(A),consume:T,enter:E,exit:j,interrupt:R(A,{interrupt:!0})},p={code:null,containerState:{},defineSkip:w,events:[],now:b,parser:s,previous:null,sliceSerialize:x,sliceStream:m,write:h};let f=e.tokenize.call(p,d);return e.resolveAll&&o.push(e),p;function h(O){return a=oo(a,O),y(),a[a.length-1]!==null?[]:(M(e,0),p.events=nx(o,p.events,p),p.events)}function x(O,G){return p8(m(O),G)}function m(O){return u8(a,O)}function b(){const{_bufferIndex:O,_index:G,line:B,column:F,offset:z}=n;return{_bufferIndex:O,_index:G,line:B,column:F,offset:z}}function w(O){i[O.line]=O.column,I()}function y(){let O;for(;n._index<a.length;){const G=a[n._index];if(typeof G=="string")for(O=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===O&&n._bufferIndex<G.length;)C(G.charCodeAt(n._bufferIndex));else C(G)}}function C(O){f=f(O)}function T(O){Yt(O)?(n.line++,n.column=1,n.offset+=O===-3?2:1,I()):O!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===a[n._index].length&&(n._bufferIndex=-1,n._index++)),p.previous=O}function E(O,G){const B=G||{};return B.type=O,B.start=b(),p.events.push(["enter",B,p]),l.push(B),B}function j(O){const G=l.pop();return G.end=b(),p.events.push(["exit",G,p]),G}function k(O,G){M(O,G.from)}function A(O,G){G.restore()}function R(O,G){return B;function B(F,z,$){let W,D,oe,Z;return Array.isArray(F)?Q(F):"tokenize"in F?Q([F]):fe(F);function fe(me){return ge;function ge(le){const X=le!==null&&me[le],V=le!==null&&me.null,de=[...Array.isArray(X)?X:X?[X]:[],...Array.isArray(V)?V:V?[V]:[]];return Q(de)(le)}}function Q(me){return W=me,D=0,me.length===0?$:_(me[D])}function _(me){return ge;function ge(le){return Z=P(),oe=me,me.partial||(p.currentConstruct=me),me.name&&p.parser.constructs.disable.null.includes(me.name)?he():me.tokenize.call(G?Object.assign(Object.create(p),G):p,d,Y,he)(le)}}function Y(me){return O(oe,Z),z}function he(me){return Z.restore(),++D<W.length?_(W[D]):$}}}function M(O,G){O.resolveAll&&!o.includes(O)&&o.push(O),O.resolve&&Bi(p.events,G,p.events.length-G,O.resolve(p.events.slice(G),p)),O.resolveTo&&(p.events=O.resolveTo(p.events,p))}function P(){const O=b(),G=p.previous,B=p.currentConstruct,F=p.events.length,z=Array.from(l);return{from:F,restore:$};function $(){n=O,p.previous=G,p.currentConstruct=B,p.events.length=F,l=z,I()}}function I(){n.line in i&&n.column<2&&(n.column=i[n.line],n.offset+=i[n.line]-1)}}function u8(s,e){const r=e.start._index,n=e.start._bufferIndex,i=e.end._index,o=e.end._bufferIndex;let a;if(r===i)a=[s[r].slice(n,o)];else{if(a=s.slice(r,i),n>-1){const l=a[0];typeof l=="string"?a[0]=l.slice(n):a.shift()}o>0&&a.push(s[i].slice(0,o))}return a}function p8(s,e){let r=-1;const n=[];let i;for(;++r<s.length;){const o=s[r];let a;if(typeof o=="string")a=o;else switch(o){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=e?" ":"	";break}case-1:{if(!e&&i)continue;a=" ";break}default:a=String.fromCharCode(o)}i=o===-2,n.push(a)}return n.join("")}function h8(s){const n={constructs:hR([c8,...(s||{}).extensions||[]]),content:i(T5),defined:[],document:i(N5),flow:i(K$),lazy:{},string:i(J$),text:i(Q$)};return n;function i(o){return a;function a(l){return d8(n,o,l)}}}function f8(s){for(;!yR(s););return s}const FC=/[\0\t\n\r]/g;function g8(){let s=1,e="",r=!0,n;return i;function i(o,a,l){const d=[];let p,f,h,x,m;for(o=e+(typeof o=="string"?o.toString():new TextDecoder(a||void 0).decode(o)),h=0,e="",r&&(o.charCodeAt(0)===65279&&h++,r=void 0);h<o.length;){if(FC.lastIndex=h,p=FC.exec(o),x=p&&p.index!==void 0?p.index:o.length,m=o.charCodeAt(x),!p){e=o.slice(h);break}if(m===10&&h===x&&n)d.push(-3),n=void 0;else switch(n&&(d.push(-5),n=void 0),h<x&&(d.push(o.slice(h,x)),s+=x-h),m){case 0:{d.push(65533),s++;break}case 9:{for(f=Math.ceil(s/4)*4,d.push(-2);s++<f;)d.push(-1);break}case 10:{d.push(-4),s=1;break}default:n=!0,s=1}h=x+1}return l&&(n&&d.push(-5),e&&d.push(e),d.push(null)),d}}const x8=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function m8(s){return s.replace(x8,y8)}function y8(s,e,r){if(e)return e;if(r.charCodeAt(0)===35){const i=r.charCodeAt(1),o=i===120||i===88;return fR(r.slice(o?2:1),o?16:10)}return nv(r)||s}const CR={}.hasOwnProperty;function b8(s,e,r){return typeof e!="string"&&(r=e,e=void 0),v8(r)(f8(h8(r).document().write(g8()(s,e,!0))))}function v8(s){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(Ae),autolinkProtocol:P,autolinkEmail:P,atxHeading:o(Be),blockQuote:o(V),characterEscape:P,characterReference:P,codeFenced:o(de),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:o(de,a),codeText:o(je,a),codeTextData:P,data:P,codeFlowValue:P,definition:o(_e),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:o(Re),hardBreakEscape:o(Se),hardBreakTrailing:o(Se),htmlFlow:o(ie,a),htmlFlowData:P,htmlText:o(ie,a),htmlTextData:P,image:o(ve),label:a,link:o(Ae),listItem:o(qe),listItemValue:x,listOrdered:o($e,h),listUnordered:o($e),paragraph:o(Ie),reference:_,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:o(Be),strong:o(K),thematicBreak:o(Oe)},exit:{atxHeading:d(),atxHeadingSequence:k,autolink:d(),autolinkEmail:X,autolinkProtocol:le,blockQuote:d(),characterEscapeValue:I,characterReferenceMarkerHexadecimal:he,characterReferenceMarkerNumeric:he,characterReferenceValue:me,characterReference:ge,codeFenced:d(y),codeFencedFence:w,codeFencedFenceInfo:m,codeFencedFenceMeta:b,codeFlowValue:I,codeIndented:d(C),codeText:d(z),codeTextData:I,data:I,definition:d(),definitionDestinationString:j,definitionLabelString:T,definitionTitleString:E,emphasis:d(),hardBreakEscape:d(G),hardBreakTrailing:d(G),htmlFlow:d(B),htmlFlowData:I,htmlText:d(F),htmlTextData:I,image:d(W),label:oe,labelText:D,lineEnding:O,link:d($),listItem:d(),listOrdered:d(),listUnordered:d(),paragraph:d(),referenceString:Y,resourceDestinationString:Z,resourceTitleString:fe,resource:Q,setextHeading:d(M),setextHeadingLineSequence:R,setextHeadingText:A,strong:d(),thematicBreak:d()}};jR(e,(s||{}).mdastExtensions||[]);const r={};return n;function n(q){let ee={type:"root",children:[]};const ce={stack:[ee],tokenStack:[],config:e,enter:l,exit:p,buffer:a,resume:f,data:r},Ce=[];let be=-1;for(;++be<q.length;)if(q[be][1].type==="listOrdered"||q[be][1].type==="listUnordered")if(q[be][0]==="enter")Ce.push(be);else{const We=Ce.pop();be=i(q,We,be)}for(be=-1;++be<q.length;){const We=e[q[be][0]];CR.call(We,q[be][1].type)&&We[q[be][1].type].call(Object.assign({sliceSerialize:q[be][2].sliceSerialize},ce),q[be][1])}if(ce.tokenStack.length>0){const We=ce.tokenStack[ce.tokenStack.length-1];(We[1]||$C).call(ce,void 0,We[0])}for(ee.position={start:Qa(q.length>0?q[0][1].start:{line:1,column:1,offset:0}),end:Qa(q.length>0?q[q.length-2][1].end:{line:1,column:1,offset:0})},be=-1;++be<e.transforms.length;)ee=e.transforms[be](ee)||ee;return ee}function i(q,ee,ce){let Ce=ee-1,be=-1,We=!1,J,se,Te,Me;for(;++Ce<=ce;){const Qe=q[Ce];switch(Qe[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Qe[0]==="enter"?be++:be--,Me=void 0;break}case"lineEndingBlank":{Qe[0]==="enter"&&(J&&!Me&&!be&&!Te&&(Te=Ce),Me=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Me=void 0}if(!be&&Qe[0]==="enter"&&Qe[1].type==="listItemPrefix"||be===-1&&Qe[0]==="exit"&&(Qe[1].type==="listUnordered"||Qe[1].type==="listOrdered")){if(J){let ye=Ce;for(se=void 0;ye--;){const ue=q[ye];if(ue[1].type==="lineEnding"||ue[1].type==="lineEndingBlank"){if(ue[0]==="exit")continue;se&&(q[se][1].type="lineEndingBlank",We=!0),ue[1].type="lineEnding",se=ye}else if(!(ue[1].type==="linePrefix"||ue[1].type==="blockQuotePrefix"||ue[1].type==="blockQuotePrefixWhitespace"||ue[1].type==="blockQuoteMarker"||ue[1].type==="listItemIndent"))break}Te&&(!se||Te<se)&&(J._spread=!0),J.end=Object.assign({},se?q[se][1].start:Qe[1].end),q.splice(se||Ce,0,["exit",J,Qe[2]]),Ce++,ce++}if(Qe[1].type==="listItemPrefix"){const ye={type:"listItem",_spread:!1,start:Object.assign({},Qe[1].start),end:void 0};J=ye,q.splice(Ce,0,["enter",ye,Qe[2]]),Ce++,ce++,Te=void 0,Me=!0}}}return q[ee][1]._spread=We,ce}function o(q,ee){return ce;function ce(Ce){l.call(this,q(Ce),Ce),ee&&ee.call(this,Ce)}}function a(){this.stack.push({type:"fragment",children:[]})}function l(q,ee,ce){this.stack[this.stack.length-1].children.push(q),this.stack.push(q),this.tokenStack.push([ee,ce||void 0]),q.position={start:Qa(ee.start),end:void 0}}function d(q){return ee;function ee(ce){q&&q.call(this,ce),p.call(this,ce)}}function p(q,ee){const ce=this.stack.pop(),Ce=this.tokenStack.pop();if(Ce)Ce[0].type!==q.type&&(ee?ee.call(this,q,Ce[0]):(Ce[1]||$C).call(this,q,Ce[0]));else throw new Error("Cannot close `"+q.type+"` ("+Sp({start:q.start,end:q.end})+"): its not open");ce.position.end=Qa(q.end)}function f(){return rv(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function x(q){if(this.data.expectingFirstListItemValue){const ee=this.stack[this.stack.length-2];ee.start=Number.parseInt(this.sliceSerialize(q),10),this.data.expectingFirstListItemValue=void 0}}function m(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.lang=q}function b(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.meta=q}function w(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function y(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.value=q.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function C(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.value=q.replace(/(\r?\n|\r)$/g,"")}function T(q){const ee=this.resume(),ce=this.stack[this.stack.length-1];ce.label=ee,ce.identifier=Co(this.sliceSerialize(q)).toLowerCase()}function E(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.title=q}function j(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.url=q}function k(q){const ee=this.stack[this.stack.length-1];if(!ee.depth){const ce=this.sliceSerialize(q).length;ee.depth=ce}}function A(){this.data.setextHeadingSlurpLineEnding=!0}function R(q){const ee=this.stack[this.stack.length-1];ee.depth=this.sliceSerialize(q).codePointAt(0)===61?1:2}function M(){this.data.setextHeadingSlurpLineEnding=void 0}function P(q){const ce=this.stack[this.stack.length-1].children;let Ce=ce[ce.length-1];(!Ce||Ce.type!=="text")&&(Ce=Ee(),Ce.position={start:Qa(q.start),end:void 0},ce.push(Ce)),this.stack.push(Ce)}function I(q){const ee=this.stack.pop();ee.value+=this.sliceSerialize(q),ee.position.end=Qa(q.end)}function O(q){const ee=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ce=ee.children[ee.children.length-1];ce.position.end=Qa(q.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(ee.type)&&(P.call(this,q),I.call(this,q))}function G(){this.data.atHardBreak=!0}function B(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.value=q}function F(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.value=q}function z(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.value=q}function $(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const ee=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=ee,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function W(){const q=this.stack[this.stack.length-1];if(this.data.inReference){const ee=this.data.referenceType||"shortcut";q.type+="Reference",q.referenceType=ee,delete q.url,delete q.title}else delete q.identifier,delete q.label;this.data.referenceType=void 0}function D(q){const ee=this.sliceSerialize(q),ce=this.stack[this.stack.length-2];ce.label=m8(ee),ce.identifier=Co(ee).toLowerCase()}function oe(){const q=this.stack[this.stack.length-1],ee=this.resume(),ce=this.stack[this.stack.length-1];if(this.data.inReference=!0,ce.type==="link"){const Ce=q.children;ce.children=Ce}else ce.alt=ee}function Z(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.url=q}function fe(){const q=this.resume(),ee=this.stack[this.stack.length-1];ee.title=q}function Q(){this.data.inReference=void 0}function _(){this.data.referenceType="collapsed"}function Y(q){const ee=this.resume(),ce=this.stack[this.stack.length-1];ce.label=ee,ce.identifier=Co(this.sliceSerialize(q)).toLowerCase(),this.data.referenceType="full"}function he(q){this.data.characterReferenceType=q.type}function me(q){const ee=this.sliceSerialize(q),ce=this.data.characterReferenceType;let Ce;ce?(Ce=fR(ee,ce==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ce=nv(ee);const be=this.stack[this.stack.length-1];be.value+=Ce}function ge(q){const ee=this.stack.pop();ee.position.end=Qa(q.end)}function le(q){I.call(this,q);const ee=this.stack[this.stack.length-1];ee.url=this.sliceSerialize(q)}function X(q){I.call(this,q);const ee=this.stack[this.stack.length-1];ee.url="mailto:"+this.sliceSerialize(q)}function V(){return{type:"blockquote",children:[]}}function de(){return{type:"code",lang:null,meta:null,value:""}}function je(){return{type:"inlineCode",value:""}}function _e(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Re(){return{type:"emphasis",children:[]}}function Be(){return{type:"heading",depth:0,children:[]}}function Se(){return{type:"break"}}function ie(){return{type:"html",value:""}}function ve(){return{type:"image",title:null,url:"",alt:null}}function Ae(){return{type:"link",title:null,url:"",children:[]}}function $e(q){return{type:"list",ordered:q.type==="listOrdered",start:null,spread:q._spread,children:[]}}function qe(q){return{type:"listItem",spread:q._spread,checked:null,children:[]}}function Ie(){return{type:"paragraph",children:[]}}function K(){return{type:"strong",children:[]}}function Ee(){return{type:"text",value:""}}function Oe(){return{type:"thematicBreak"}}}function Qa(s){return{line:s.line,column:s.column,offset:s.offset}}function jR(s,e){let r=-1;for(;++r<e.length;){const n=e[r];Array.isArray(n)?jR(s,n):S8(s,n)}}function S8(s,e){let r;for(r in e)if(CR.call(e,r))switch(r){case"canContainEols":{const n=e[r];n&&s[r].push(...n);break}case"transforms":{const n=e[r];n&&s[r].push(...n);break}case"enter":case"exit":{const n=e[r];n&&Object.assign(s[r],n);break}}}function $C(s,e){throw s?new Error("Cannot close `"+s.type+"` ("+Sp({start:s.start,end:s.end})+"): a different token (`"+e.type+"`, "+Sp({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+Sp({start:e.start,end:e.end})+") is still open")}function w8(s){const e=this;e.parser=r;function r(n){return b8(n,{...e.data("settings"),...s,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function E8(s,e){const r={type:"element",tagName:"blockquote",properties:{},children:s.wrap(s.all(e),!0)};return s.patch(e,r),s.applyData(e,r)}function C8(s,e){const r={type:"element",tagName:"br",properties:{},children:[]};return s.patch(e,r),[s.applyData(e,r),{type:"text",value:`
`}]}function j8(s,e){const r=e.value?e.value+`
`:"",n={},i=e.lang?e.lang.split(/\s+/):[];i.length>0&&(n.className=["language-"+i[0]]);let o={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return e.meta&&(o.data={meta:e.meta}),s.patch(e,o),o=s.applyData(e,o),o={type:"element",tagName:"pre",properties:{},children:[o]},s.patch(e,o),o}function k8(s,e){const r={type:"element",tagName:"del",properties:{},children:s.all(e)};return s.patch(e,r),s.applyData(e,r)}function A8(s,e){const r={type:"element",tagName:"em",properties:{},children:s.all(e)};return s.patch(e,r),s.applyData(e,r)}function T8(s,e){const r=typeof s.options.clobberPrefix=="string"?s.options.clobberPrefix:"user-content-",n=String(e.identifier).toUpperCase(),i=Hd(n.toLowerCase()),o=s.footnoteOrder.indexOf(n);let a,l=s.footnoteCounts.get(n);l===void 0?(l=0,s.footnoteOrder.push(n),a=s.footnoteOrder.length):a=o+1,l+=1,s.footnoteCounts.set(n,l);const d={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+i,id:r+"fnref-"+i+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};s.patch(e,d);const p={type:"element",tagName:"sup",properties:{},children:[d]};return s.patch(e,p),s.applyData(e,p)}function R8(s,e){const r={type:"element",tagName:"h"+e.depth,properties:{},children:s.all(e)};return s.patch(e,r),s.applyData(e,r)}function N8(s,e){if(s.options.allowDangerousHtml){const r={type:"raw",value:e.value};return s.patch(e,r),s.applyData(e,r)}}function kR(s,e){const r=e.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+n}];const i=s.all(e),o=i[0];o&&o.type==="text"?o.value="["+o.value:i.unshift({type:"text",value:"["});const a=i[i.length-1];return a&&a.type==="text"?a.value+=n:i.push({type:"text",value:n}),i}function O8(s,e){const r=String(e.identifier).toUpperCase(),n=s.definitionById.get(r);if(!n)return kR(s,e);const i={src:Hd(n.url||""),alt:e.alt};n.title!==null&&n.title!==void 0&&(i.title=n.title);const o={type:"element",tagName:"img",properties:i,children:[]};return s.patch(e,o),s.applyData(e,o)}function _8(s,e){const r={src:Hd(e.url)};e.alt!==null&&e.alt!==void 0&&(r.alt=e.alt),e.title!==null&&e.title!==void 0&&(r.title=e.title);const n={type:"element",tagName:"img",properties:r,children:[]};return s.patch(e,n),s.applyData(e,n)}function D8(s,e){const r={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};s.patch(e,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return s.patch(e,n),s.applyData(e,n)}function I8(s,e){const r=String(e.identifier).toUpperCase(),n=s.definitionById.get(r);if(!n)return kR(s,e);const i={href:Hd(n.url||"")};n.title!==null&&n.title!==void 0&&(i.title=n.title);const o={type:"element",tagName:"a",properties:i,children:s.all(e)};return s.patch(e,o),s.applyData(e,o)}function P8(s,e){const r={href:Hd(e.url)};e.title!==null&&e.title!==void 0&&(r.title=e.title);const n={type:"element",tagName:"a",properties:r,children:s.all(e)};return s.patch(e,n),s.applyData(e,n)}function L8(s,e,r){const n=s.all(e),i=r?z8(r):AR(e),o={},a=[];if(typeof e.checked=="boolean"){const f=n[0];let h;f&&f.type==="element"&&f.tagName==="p"?h=f:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let l=-1;for(;++l<n.length;){const f=n[l];(i||l!==0||f.type!=="element"||f.tagName!=="p")&&a.push({type:"text",value:`
`}),f.type==="element"&&f.tagName==="p"&&!i?a.push(...f.children):a.push(f)}const d=n[n.length-1];d&&(i||d.type!=="element"||d.tagName!=="p")&&a.push({type:"text",value:`
`});const p={type:"element",tagName:"li",properties:o,children:a};return s.patch(e,p),s.applyData(e,p)}function z8(s){let e=!1;if(s.type==="list"){e=s.spread||!1;const r=s.children;let n=-1;for(;!e&&++n<r.length;)e=AR(r[n])}return e}function AR(s){const e=s.spread;return e??s.children.length>1}function M8(s,e){const r={},n=s.all(e);let i=-1;for(typeof e.start=="number"&&e.start!==1&&(r.start=e.start);++i<n.length;){const a=n[i];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const o={type:"element",tagName:e.ordered?"ol":"ul",properties:r,children:s.wrap(n,!0)};return s.patch(e,o),s.applyData(e,o)}function B8(s,e){const r={type:"element",tagName:"p",properties:{},children:s.all(e)};return s.patch(e,r),s.applyData(e,r)}function F8(s,e){const r={type:"root",children:s.wrap(s.all(e))};return s.patch(e,r),s.applyData(e,r)}function $8(s,e){const r={type:"element",tagName:"strong",properties:{},children:s.all(e)};return s.patch(e,r),s.applyData(e,r)}function G8(s,e){const r=s.all(e),n=r.shift(),i=[];if(n){const a={type:"element",tagName:"thead",properties:{},children:s.wrap([n],!0)};s.patch(e.children[0],a),i.push(a)}if(r.length>0){const a={type:"element",tagName:"tbody",properties:{},children:s.wrap(r,!0)},l=Qb(e.children[1]),d=oR(e.children[e.children.length-1]);l&&d&&(a.position={start:l,end:d}),i.push(a)}const o={type:"element",tagName:"table",properties:{},children:s.wrap(i,!0)};return s.patch(e,o),s.applyData(e,o)}function U8(s,e,r){const n=r?r.children:void 0,o=(n?n.indexOf(e):1)===0?"th":"td",a=r&&r.type==="table"?r.align:void 0,l=a?a.length:e.children.length;let d=-1;const p=[];for(;++d<l;){const h=e.children[d],x={},m=a?a[d]:void 0;m&&(x.align=m);let b={type:"element",tagName:o,properties:x,children:[]};h&&(b.children=s.all(h),s.patch(h,b),b=s.applyData(h,b)),p.push(b)}const f={type:"element",tagName:"tr",properties:{},children:s.wrap(p,!0)};return s.patch(e,f),s.applyData(e,f)}function W8(s,e){const r={type:"element",tagName:"td",properties:{},children:s.all(e)};return s.patch(e,r),s.applyData(e,r)}const GC=9,UC=32;function q8(s){const e=String(s),r=/\r?\n|\r/g;let n=r.exec(e),i=0;const o=[];for(;n;)o.push(WC(e.slice(i,n.index),i>0,!0),n[0]),i=n.index+n[0].length,n=r.exec(e);return o.push(WC(e.slice(i),i>0,!1)),o.join("")}function WC(s,e,r){let n=0,i=s.length;if(e){let o=s.codePointAt(n);for(;o===GC||o===UC;)n++,o=s.codePointAt(n)}if(r){let o=s.codePointAt(i-1);for(;o===GC||o===UC;)i--,o=s.codePointAt(i-1)}return i>n?s.slice(n,i):""}function H8(s,e){const r={type:"text",value:q8(String(e.value))};return s.patch(e,r),s.applyData(e,r)}function Y8(s,e){const r={type:"element",tagName:"hr",properties:{},children:[]};return s.patch(e,r),s.applyData(e,r)}const K8={blockquote:E8,break:C8,code:j8,delete:k8,emphasis:A8,footnoteReference:T8,heading:R8,html:N8,imageReference:O8,image:_8,inlineCode:D8,linkReference:I8,link:P8,listItem:L8,list:M8,paragraph:B8,root:F8,strong:$8,table:G8,tableCell:W8,tableRow:U8,text:H8,thematicBreak:Y8,toml:yf,yaml:yf,definition:yf,footnoteDefinition:yf};function yf(){}const TR=-1,sx=0,Ep=1,mg=2,iv=3,ov=4,av=5,lv=6,RR=7,NR=8,qC=typeof self=="object"?self:globalThis,V8=(s,e)=>{const r=(i,o)=>(s.set(o,i),i),n=i=>{if(s.has(i))return s.get(i);const[o,a]=e[i];switch(o){case sx:case TR:return r(a,i);case Ep:{const l=r([],i);for(const d of a)l.push(n(d));return l}case mg:{const l=r({},i);for(const[d,p]of a)l[n(d)]=n(p);return l}case iv:return r(new Date(a),i);case ov:{const{source:l,flags:d}=a;return r(new RegExp(l,d),i)}case av:{const l=r(new Map,i);for(const[d,p]of a)l.set(n(d),n(p));return l}case lv:{const l=r(new Set,i);for(const d of a)l.add(n(d));return l}case RR:{const{name:l,message:d}=a;return r(new qC[l](d),i)}case NR:return r(BigInt(a),i);case"BigInt":return r(Object(BigInt(a)),i);case"ArrayBuffer":return r(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:l}=new Uint8Array(a);return r(new DataView(l),a)}}return r(new qC[o](a),i)};return n},HC=s=>V8(new Map,s)(0),nd="",{toString:X8}={},{keys:J8}=Object,Ju=s=>{const e=typeof s;if(e!=="object"||!s)return[sx,e];const r=X8.call(s).slice(8,-1);switch(r){case"Array":return[Ep,nd];case"Object":return[mg,nd];case"Date":return[iv,nd];case"RegExp":return[ov,nd];case"Map":return[av,nd];case"Set":return[lv,nd];case"DataView":return[Ep,r]}return r.includes("Array")?[Ep,r]:r.includes("Error")?[RR,r]:[mg,r]},bf=([s,e])=>s===sx&&(e==="function"||e==="symbol"),Q8=(s,e,r,n)=>{const i=(a,l)=>{const d=n.push(a)-1;return r.set(l,d),d},o=a=>{if(r.has(a))return r.get(a);let[l,d]=Ju(a);switch(l){case sx:{let f=a;switch(d){case"bigint":l=NR,f=a.toString();break;case"function":case"symbol":if(s)throw new TypeError("unable to serialize "+d);f=null;break;case"undefined":return i([TR],a)}return i([l,f],a)}case Ep:{if(d){let x=a;return d==="DataView"?x=new Uint8Array(a.buffer):d==="ArrayBuffer"&&(x=new Uint8Array(a)),i([d,[...x]],a)}const f=[],h=i([l,f],a);for(const x of a)f.push(o(x));return h}case mg:{if(d)switch(d){case"BigInt":return i([d,a.toString()],a);case"Boolean":case"Number":case"String":return i([d,a.valueOf()],a)}if(e&&"toJSON"in a)return o(a.toJSON());const f=[],h=i([l,f],a);for(const x of J8(a))(s||!bf(Ju(a[x])))&&f.push([o(x),o(a[x])]);return h}case iv:return i([l,a.toISOString()],a);case ov:{const{source:f,flags:h}=a;return i([l,{source:f,flags:h}],a)}case av:{const f=[],h=i([l,f],a);for(const[x,m]of a)(s||!(bf(Ju(x))||bf(Ju(m))))&&f.push([o(x),o(m)]);return h}case lv:{const f=[],h=i([l,f],a);for(const x of a)(s||!bf(Ju(x)))&&f.push(o(x));return h}}const{message:p}=a;return i([l,{name:d,message:p}],a)};return o},YC=(s,{json:e,lossy:r}={})=>{const n=[];return Q8(!(e||r),!!e,new Map,n)(s),n},yg=typeof structuredClone=="function"?(s,e)=>e&&("json"in e||"lossy"in e)?HC(YC(s,e)):structuredClone(s):(s,e)=>HC(YC(s,e));function Z8(s,e){const r=[{type:"text",value:""}];return e>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),r}function e6(s,e){return"Back to reference "+(s+1)+(e>1?"-"+e:"")}function t6(s){const e=typeof s.options.clobberPrefix=="string"?s.options.clobberPrefix:"user-content-",r=s.options.footnoteBackContent||Z8,n=s.options.footnoteBackLabel||e6,i=s.options.footnoteLabel||"Footnotes",o=s.options.footnoteLabelTagName||"h2",a=s.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let d=-1;for(;++d<s.footnoteOrder.length;){const p=s.footnoteById.get(s.footnoteOrder[d]);if(!p)continue;const f=s.all(p),h=String(p.identifier).toUpperCase(),x=Hd(h.toLowerCase());let m=0;const b=[],w=s.footnoteCounts.get(h);for(;w!==void 0&&++m<=w;){b.length>0&&b.push({type:"text",value:" "});let T=typeof r=="string"?r:r(d,m);typeof T=="string"&&(T={type:"text",value:T}),b.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+x+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(d,m),className:["data-footnote-backref"]},children:Array.isArray(T)?T:[T]})}const y=f[f.length-1];if(y&&y.type==="element"&&y.tagName==="p"){const T=y.children[y.children.length-1];T&&T.type==="text"?T.value+=" ":y.children.push({type:"text",value:" "}),y.children.push(...b)}else f.push(...b);const C={type:"element",tagName:"li",properties:{id:e+"fn-"+x},children:s.wrap(f,!0)};s.patch(p,C),l.push(C)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...yg(a),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:s.wrap(l,!0)},{type:"text",value:`
`}]}}const ix=(function(s){if(s==null)return i6;if(typeof s=="function")return ox(s);if(typeof s=="object")return Array.isArray(s)?r6(s):n6(s);if(typeof s=="string")return s6(s);throw new Error("Expected function, string, or object as test")});function r6(s){const e=[];let r=-1;for(;++r<s.length;)e[r]=ix(s[r]);return ox(n);function n(...i){let o=-1;for(;++o<e.length;)if(e[o].apply(this,i))return!0;return!1}}function n6(s){const e=s;return ox(r);function r(n){const i=n;let o;for(o in s)if(i[o]!==e[o])return!1;return!0}}function s6(s){return ox(e);function e(r){return r&&r.type===s}}function ox(s){return e;function e(r,n,i){return!!(o6(r)&&s.call(this,r,typeof n=="number"?n:void 0,i||void 0))}}function i6(){return!0}function o6(s){return s!==null&&typeof s=="object"&&"type"in s}const OR=[],a6=!0,ib=!1,l6="skip";function _R(s,e,r,n){let i;typeof e=="function"&&typeof r!="function"?(n=r,r=e):i=e;const o=ix(i),a=n?-1:1;l(s,void 0,[])();function l(d,p,f){const h=d&&typeof d=="object"?d:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(x,"name",{value:"node ("+(d.type+(m?"<"+m+">":""))+")"})}return x;function x(){let m=OR,b,w,y;if((!e||o(d,p,f[f.length-1]||void 0))&&(m=c6(r(d,f)),m[0]===ib))return m;if("children"in d&&d.children){const C=d;if(C.children&&m[0]!==l6)for(w=(n?C.children.length:-1)+a,y=f.concat(C);w>-1&&w<C.children.length;){const T=C.children[w];if(b=l(T,w,y)(),b[0]===ib)return b;w=typeof b[1]=="number"?b[1]:w+a}}return m}}}function c6(s){return Array.isArray(s)?s:typeof s=="number"?[a6,s]:s==null?OR:[s]}function cv(s,e,r,n){let i,o,a;typeof e=="function"&&typeof r!="function"?(o=void 0,a=e,i=r):(o=e,a=r,i=n),_R(s,o,l,i);function l(d,p){const f=p[p.length-1],h=f?f.children.indexOf(d):void 0;return a(d,h,f)}}const ob={}.hasOwnProperty,d6={};function u6(s,e){const r=e||d6,n=new Map,i=new Map,o=new Map,a={...K8,...r.handlers},l={all:p,applyData:h6,definitionById:n,footnoteById:i,footnoteCounts:o,footnoteOrder:[],handlers:a,one:d,options:r,patch:p6,wrap:g6};return cv(s,function(f){if(f.type==="definition"||f.type==="footnoteDefinition"){const h=f.type==="definition"?n:i,x=String(f.identifier).toUpperCase();h.has(x)||h.set(x,f)}}),l;function d(f,h){const x=f.type,m=l.handlers[x];if(ob.call(l.handlers,x)&&m)return m(l,f,h);if(l.options.passThrough&&l.options.passThrough.includes(x)){if("children"in f){const{children:w,...y}=f,C=yg(y);return C.children=l.all(f),C}return yg(f)}return(l.options.unknownHandler||f6)(l,f,h)}function p(f){const h=[];if("children"in f){const x=f.children;let m=-1;for(;++m<x.length;){const b=l.one(x[m],f);if(b){if(m&&x[m-1].type==="break"&&(!Array.isArray(b)&&b.type==="text"&&(b.value=KC(b.value)),!Array.isArray(b)&&b.type==="element")){const w=b.children[0];w&&w.type==="text"&&(w.value=KC(w.value))}Array.isArray(b)?h.push(...b):h.push(b)}}}return h}}function p6(s,e){s.position&&(e.position=e5(s))}function h6(s,e){let r=e;if(s&&s.data){const n=s.data.hName,i=s.data.hChildren,o=s.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const a="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:a}}r.type==="element"&&o&&Object.assign(r.properties,yg(o)),"children"in r&&r.children&&i!==null&&i!==void 0&&(r.children=i)}return r}function f6(s,e){const r=e.data||{},n="value"in e&&!(ob.call(r,"hProperties")||ob.call(r,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:s.all(e)};return s.patch(e,n),s.applyData(e,n)}function g6(s,e){const r=[];let n=-1;for(e&&r.push({type:"text",value:`
`});++n<s.length;)n&&r.push({type:"text",value:`
`}),r.push(s[n]);return e&&s.length>0&&r.push({type:"text",value:`
`}),r}function KC(s){let e=0,r=s.charCodeAt(e);for(;r===9||r===32;)e++,r=s.charCodeAt(e);return s.slice(e)}function VC(s,e){const r=u6(s,e),n=r.one(s,void 0),i=t6(r),o=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return i&&o.children.push({type:"text",value:`
`},i),o}function x6(s,e){return s&&"run"in s?async function(r,n){const i=VC(r,{file:n,...e});await s.run(i,n)}:function(r,n){return VC(r,{file:n,...s||e})}}function XC(s){if(s)throw s}var qy,JC;function m6(){if(JC)return qy;JC=1;var s=Object.prototype.hasOwnProperty,e=Object.prototype.toString,r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=function(p){return typeof Array.isArray=="function"?Array.isArray(p):e.call(p)==="[object Array]"},o=function(p){if(!p||e.call(p)!=="[object Object]")return!1;var f=s.call(p,"constructor"),h=p.constructor&&p.constructor.prototype&&s.call(p.constructor.prototype,"isPrototypeOf");if(p.constructor&&!f&&!h)return!1;var x;for(x in p);return typeof x>"u"||s.call(p,x)},a=function(p,f){r&&f.name==="__proto__"?r(p,f.name,{enumerable:!0,configurable:!0,value:f.newValue,writable:!0}):p[f.name]=f.newValue},l=function(p,f){if(f==="__proto__")if(s.call(p,f)){if(n)return n(p,f).value}else return;return p[f]};return qy=function d(){var p,f,h,x,m,b,w=arguments[0],y=1,C=arguments.length,T=!1;for(typeof w=="boolean"&&(T=w,w=arguments[1]||{},y=2),(w==null||typeof w!="object"&&typeof w!="function")&&(w={});y<C;++y)if(p=arguments[y],p!=null)for(f in p)h=l(w,f),x=l(p,f),w!==x&&(T&&x&&(o(x)||(m=i(x)))?(m?(m=!1,b=h&&i(h)?h:[]):b=h&&o(h)?h:{},a(w,{name:f,newValue:d(T,b,x)})):typeof x<"u"&&a(w,{name:f,newValue:x}));return w},qy}var Hy=m6();function ab(s){if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)}function y6(){const s=[],e={run:r,use:n};return e;function r(...i){let o=-1;const a=i.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);l(null,...i);function l(d,...p){const f=s[++o];let h=-1;if(d){a(d);return}for(;++h<i.length;)(p[h]===null||p[h]===void 0)&&(p[h]=i[h]);i=p,f?b6(f,l)(...p):a(null,...p)}}function n(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return s.push(i),e}}function b6(s,e){let r;return n;function n(...a){const l=s.length>a.length;let d;l&&a.push(i);try{d=s.apply(this,a)}catch(p){const f=p;if(l&&r)throw f;return i(f)}l||(d&&d.then&&typeof d.then=="function"?d.then(o,i):d instanceof Error?i(d):o(d))}function i(a,...l){r||(r=!0,e(a,...l))}function o(a){i(null,a)}}const $o={basename:v6,dirname:S6,extname:w6,join:E6,sep:"/"};function v6(s,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Jp(s);let r=0,n=-1,i=s.length,o;if(e===void 0||e.length===0||e.length>s.length){for(;i--;)if(s.codePointAt(i)===47){if(o){r=i+1;break}}else n<0&&(o=!0,n=i+1);return n<0?"":s.slice(r,n)}if(e===s)return"";let a=-1,l=e.length-1;for(;i--;)if(s.codePointAt(i)===47){if(o){r=i+1;break}}else a<0&&(o=!0,a=i+1),l>-1&&(s.codePointAt(i)===e.codePointAt(l--)?l<0&&(n=i):(l=-1,n=a));return r===n?n=a:n<0&&(n=s.length),s.slice(r,n)}function S6(s){if(Jp(s),s.length===0)return".";let e=-1,r=s.length,n;for(;--r;)if(s.codePointAt(r)===47){if(n){e=r;break}}else n||(n=!0);return e<0?s.codePointAt(0)===47?"/":".":e===1&&s.codePointAt(0)===47?"//":s.slice(0,e)}function w6(s){Jp(s);let e=s.length,r=-1,n=0,i=-1,o=0,a;for(;e--;){const l=s.codePointAt(e);if(l===47){if(a){n=e+1;break}continue}r<0&&(a=!0,r=e+1),l===46?i<0?i=e:o!==1&&(o=1):i>-1&&(o=-1)}return i<0||r<0||o===0||o===1&&i===r-1&&i===n+1?"":s.slice(i,r)}function E6(...s){let e=-1,r;for(;++e<s.length;)Jp(s[e]),s[e]&&(r=r===void 0?s[e]:r+"/"+s[e]);return r===void 0?".":C6(r)}function C6(s){Jp(s);const e=s.codePointAt(0)===47;let r=j6(s,!e);return r.length===0&&!e&&(r="."),r.length>0&&s.codePointAt(s.length-1)===47&&(r+="/"),e?"/"+r:r}function j6(s,e){let r="",n=0,i=-1,o=0,a=-1,l,d;for(;++a<=s.length;){if(a<s.length)l=s.codePointAt(a);else{if(l===47)break;l=47}if(l===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(d=r.lastIndexOf("/"),d!==r.length-1){d<0?(r="",n=0):(r=r.slice(0,d),n=r.length-1-r.lastIndexOf("/")),i=a,o=0;continue}}else if(r.length>0){r="",n=0,i=a,o=0;continue}}e&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+s.slice(i+1,a):r=s.slice(i+1,a),n=a-i-1;i=a,o=0}else l===46&&o>-1?o++:o=-1}return r}function Jp(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}const k6={cwd:A6};function A6(){return"/"}function lb(s){return!!(s!==null&&typeof s=="object"&&"href"in s&&s.href&&"protocol"in s&&s.protocol&&s.auth===void 0)}function T6(s){if(typeof s=="string")s=new URL(s);else if(!lb(s)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+s+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(s.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return R6(s)}function R6(s){if(s.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const e=s.pathname;let r=-1;for(;++r<e.length;)if(e.codePointAt(r)===37&&e.codePointAt(r+1)===50){const n=e.codePointAt(r+2);if(n===70||n===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(e)}const Yy=["history","path","basename","stem","extname","dirname"];class DR{constructor(e){let r;e?lb(e)?r={path:e}:typeof e=="string"||N6(e)?r={value:e}:r=e:r={},this.cwd="cwd"in r?"":k6.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<Yy.length;){const o=Yy[n];o in r&&r[o]!==void 0&&r[o]!==null&&(this[o]=o==="history"?[...r[o]]:r[o])}let i;for(i in r)Yy.includes(i)||(this[i]=r[i])}get basename(){return typeof this.path=="string"?$o.basename(this.path):void 0}set basename(e){Vy(e,"basename"),Ky(e,"basename"),this.path=$o.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?$o.dirname(this.path):void 0}set dirname(e){QC(this.basename,"dirname"),this.path=$o.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?$o.extname(this.path):void 0}set extname(e){if(Ky(e,"extname"),QC(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=$o.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){lb(e)&&(e=T6(e)),Vy(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?$o.basename(this.path,this.extname):void 0}set stem(e){Vy(e,"stem"),Ky(e,"stem"),this.path=$o.join(this.dirname||"",e+(this.extname||""))}fail(e,r,n){const i=this.message(e,r,n);throw i.fatal=!0,i}info(e,r,n){const i=this.message(e,r,n);return i.fatal=void 0,i}message(e,r,n){const i=new Ks(e,r,n);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Ky(s,e){if(s&&s.includes($o.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+$o.sep+"`")}function Vy(s,e){if(!s)throw new Error("`"+e+"` cannot be empty")}function QC(s,e){if(!s)throw new Error("Setting `"+e+"` requires `path` to be set too")}function N6(s){return!!(s&&typeof s=="object"&&"byteLength"in s&&"byteOffset"in s)}const O6=(function(s){const n=this.constructor.prototype,i=n[s],o=function(){return i.apply(o,arguments)};return Object.setPrototypeOf(o,n),o}),_6={}.hasOwnProperty;class dv extends O6{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=y6()}copy(){const e=new dv;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];e.use(...n)}return e.data(Hy(!0,{},this.namespace)),e}data(e,r){return typeof e=="string"?arguments.length===2?(Qy("data",this.frozen),this.namespace[e]=r,this):_6.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Qy("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const i=r.call(e,...n);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const r=vf(e),n=this.parser||this.Parser;return Xy("parse",n),n(String(r),r)}process(e,r){const n=this;return this.freeze(),Xy("process",this.parser||this.Parser),Jy("process",this.compiler||this.Compiler),r?i(void 0,r):new Promise(i);function i(o,a){const l=vf(e),d=n.parse(l);n.run(d,l,function(f,h,x){if(f||!h||!x)return p(f);const m=h,b=n.stringify(m,x);P6(b)?x.value=b:x.result=b,p(f,x)});function p(f,h){f||!h?a(f):o?o(h):r(void 0,h)}}}processSync(e){let r=!1,n;return this.freeze(),Xy("processSync",this.parser||this.Parser),Jy("processSync",this.compiler||this.Compiler),this.process(e,i),ej("processSync","process",r),n;function i(o,a){r=!0,XC(o),n=a}}run(e,r,n){ZC(e),this.freeze();const i=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?o(void 0,n):new Promise(o);function o(a,l){const d=vf(r);i.run(e,d,p);function p(f,h,x){const m=h||e;f?l(f):a?a(m):n(void 0,m,x)}}}runSync(e,r){let n=!1,i;return this.run(e,r,o),ej("runSync","run",n),i;function o(a,l){XC(a),i=l,n=!0}}stringify(e,r){this.freeze();const n=vf(r),i=this.compiler||this.Compiler;return Jy("stringify",i),ZC(e),i(e,n)}use(e,...r){const n=this.attachers,i=this.namespace;if(Qy("use",this.frozen),e!=null)if(typeof e=="function")d(e,r);else if(typeof e=="object")Array.isArray(e)?l(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function o(p){if(typeof p=="function")d(p,[]);else if(typeof p=="object")if(Array.isArray(p)){const[f,...h]=p;d(f,h)}else a(p);else throw new TypeError("Expected usable value, not `"+p+"`")}function a(p){if(!("plugins"in p)&&!("settings"in p))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(p.plugins),p.settings&&(i.settings=Hy(!0,i.settings,p.settings))}function l(p){let f=-1;if(p!=null)if(Array.isArray(p))for(;++f<p.length;){const h=p[f];o(h)}else throw new TypeError("Expected a list of plugins, not `"+p+"`")}function d(p,f){let h=-1,x=-1;for(;++h<n.length;)if(n[h][0]===p){x=h;break}if(x===-1)n.push([p,...f]);else if(f.length>0){let[m,...b]=f;const w=n[x][1];ab(w)&&ab(m)&&(m=Hy(!0,w,m)),n[x]=[p,m,...b]}}}}const D6=new dv().freeze();function Xy(s,e){if(typeof e!="function")throw new TypeError("Cannot `"+s+"` without `parser`")}function Jy(s,e){if(typeof e!="function")throw new TypeError("Cannot `"+s+"` without `compiler`")}function Qy(s,e){if(e)throw new Error("Cannot call `"+s+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function ZC(s){if(!ab(s)||typeof s.type!="string")throw new TypeError("Expected node, got `"+s+"`")}function ej(s,e,r){if(!r)throw new Error("`"+s+"` finished async. Use `"+e+"` instead")}function vf(s){return I6(s)?s:new DR(s)}function I6(s){return!!(s&&typeof s=="object"&&"message"in s&&"messages"in s)}function P6(s){return typeof s=="string"||L6(s)}function L6(s){return!!(s&&typeof s=="object"&&"byteLength"in s&&"byteOffset"in s)}const z6="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",tj=[],rj={allowDangerousHtml:!0},M6=/^(https?|ircs?|mailto|xmpp)$/i,B6=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function cb(s){const e=F6(s),r=$6(s);return G6(e.runSync(e.parse(r),r),s)}function F6(s){const e=s.rehypePlugins||tj,r=s.remarkPlugins||tj,n=s.remarkRehypeOptions?{...s.remarkRehypeOptions,...rj}:rj;return D6().use(w8).use(r).use(x6,n).use(e)}function $6(s){const e=s.children||"",r=new DR;return typeof e=="string"&&(r.value=e),r}function G6(s,e){const r=e.allowedElements,n=e.allowElement,i=e.components,o=e.disallowedElements,a=e.skipHtml,l=e.unwrapDisallowed,d=e.urlTransform||U6;for(const f of B6)Object.hasOwn(e,f.from)&&(""+f.from+(f.to?"use `"+f.to+"` instead":"remove it")+z6+f.id,void 0);return cv(s,p),i5(s,{Fragment:t.Fragment,components:i,ignoreInvalidStyle:!0,jsx:t.jsx,jsxs:t.jsxs,passKeys:!0,passNode:!0});function p(f,h,x){if(f.type==="raw"&&x&&typeof h=="number")return a?x.children.splice(h,1):x.children[h]={type:"text",value:f.value},h;if(f.type==="element"){let m;for(m in Gy)if(Object.hasOwn(Gy,m)&&Object.hasOwn(f.properties,m)){const b=f.properties[m],w=Gy[m];(w===null||w.includes(f.tagName))&&(f.properties[m]=d(String(b||""),m,f))}}if(f.type==="element"){let m=r?!r.includes(f.tagName):o?o.includes(f.tagName):!1;if(!m&&n&&typeof h=="number"&&(m=!n(f,h,x)),m&&x&&typeof h=="number")return l&&f.children?x.children.splice(h,1,...f.children):x.children.splice(h,1),h}}}function U6(s){const e=s.indexOf(":"),r=s.indexOf("?"),n=s.indexOf("#"),i=s.indexOf("/");return e===-1||i!==-1&&e>i||r!==-1&&e>r||n!==-1&&e>n||M6.test(s.slice(0,e))?s:""}function nj(s,e){const r=String(s);if(typeof e!="string")throw new TypeError("Expected character");let n=0,i=r.indexOf(e);for(;i!==-1;)n++,i=r.indexOf(e,i+e.length);return n}function W6(s){if(typeof s!="string")throw new TypeError("Expected a string");return s.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function q6(s,e,r){const i=ix((r||{}).ignore||[]),o=H6(e);let a=-1;for(;++a<o.length;)_R(s,"text",l);function l(p,f){let h=-1,x;for(;++h<f.length;){const m=f[h],b=x?x.children:void 0;if(i(m,b?b.indexOf(m):void 0,x))return;x=m}if(x)return d(p,f)}function d(p,f){const h=f[f.length-1],x=o[a][0],m=o[a][1];let b=0;const y=h.children.indexOf(p);let C=!1,T=[];x.lastIndex=0;let E=x.exec(p.value);for(;E;){const j=E.index,k={index:E.index,input:E.input,stack:[...f,p]};let A=m(...E,k);if(typeof A=="string"&&(A=A.length>0?{type:"text",value:A}:void 0),A===!1?x.lastIndex=j+1:(b!==j&&T.push({type:"text",value:p.value.slice(b,j)}),Array.isArray(A)?T.push(...A):A&&T.push(A),b=j+E[0].length,C=!0),!x.global)break;E=x.exec(p.value)}return C?(b<p.value.length&&T.push({type:"text",value:p.value.slice(b)}),h.children.splice(y,1,...T)):T=[p],y+T.length}}function H6(s){const e=[];if(!Array.isArray(s))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!s[0]||Array.isArray(s[0])?s:[s];let n=-1;for(;++n<r.length;){const i=r[n];e.push([Y6(i[0]),K6(i[1])])}return e}function Y6(s){return typeof s=="string"?new RegExp(W6(s),"g"):s}function K6(s){return typeof s=="function"?s:function(){return s}}const Zy="phrasing",e0=["autolink","link","image","label"];function V6(){return{transforms:[rG],enter:{literalAutolink:J6,literalAutolinkEmail:t0,literalAutolinkHttp:t0,literalAutolinkWww:t0},exit:{literalAutolink:tG,literalAutolinkEmail:eG,literalAutolinkHttp:Q6,literalAutolinkWww:Z6}}}function X6(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Zy,notInConstruct:e0},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Zy,notInConstruct:e0},{character:":",before:"[ps]",after:"\\/",inConstruct:Zy,notInConstruct:e0}]}}function J6(s){this.enter({type:"link",title:null,url:"",children:[]},s)}function t0(s){this.config.enter.autolinkProtocol.call(this,s)}function Q6(s){this.config.exit.autolinkProtocol.call(this,s)}function Z6(s){this.config.exit.data.call(this,s);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(s)}function eG(s){this.config.exit.autolinkEmail.call(this,s)}function tG(s){this.exit(s)}function rG(s){q6(s,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,nG],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,sG]],{ignore:["link","linkReference"]})}function nG(s,e,r,n,i){let o="";if(!IR(i)||(/^w/i.test(e)&&(r=e+r,e="",o="http://"),!iG(r)))return!1;const a=oG(r+n);if(!a[0])return!1;const l={type:"link",title:null,url:o+e+a[0],children:[{type:"text",value:e+a[0]}]};return a[1]?[l,{type:"text",value:a[1]}]:l}function sG(s,e,r,n){return!IR(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+r,children:[{type:"text",value:e+"@"+r}]}}function iG(s){const e=s.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function oG(s){const e=/[!"&'),.:;<>?\]}]+$/.exec(s);if(!e)return[s,void 0];s=s.slice(0,e.index);let r=e[0],n=r.indexOf(")");const i=nj(s,"(");let o=nj(s,")");for(;n!==-1&&i>o;)s+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),o++;return[s,r]}function IR(s,e){const r=s.input.charCodeAt(s.index-1);return(s.index===0||yc(r)||rx(r))&&(!e||r!==47)}PR.peek=gG;function aG(){this.buffer()}function lG(s){this.enter({type:"footnoteReference",identifier:"",label:""},s)}function cG(){this.buffer()}function dG(s){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},s)}function uG(s){const e=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=Co(this.sliceSerialize(s)).toLowerCase(),r.label=e}function pG(s){this.exit(s)}function hG(s){const e=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=Co(this.sliceSerialize(s)).toLowerCase(),r.label=e}function fG(s){this.exit(s)}function gG(){return"["}function PR(s,e,r,n){const i=r.createTracker(n);let o=i.move("[^");const a=r.enter("footnoteReference"),l=r.enter("reference");return o+=i.move(r.safe(r.associationId(s),{after:"]",before:o})),l(),a(),o+=i.move("]"),o}function xG(){return{enter:{gfmFootnoteCallString:aG,gfmFootnoteCall:lG,gfmFootnoteDefinitionLabelString:cG,gfmFootnoteDefinition:dG},exit:{gfmFootnoteCallString:uG,gfmFootnoteCall:pG,gfmFootnoteDefinitionLabelString:hG,gfmFootnoteDefinition:fG}}}function mG(s){let e=!1;return s&&s.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:r,footnoteReference:PR},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function r(n,i,o,a){const l=o.createTracker(a);let d=l.move("[^");const p=o.enter("footnoteDefinition"),f=o.enter("label");return d+=l.move(o.safe(o.associationId(n),{before:d,after:"]"})),f(),d+=l.move("]:"),n.children&&n.children.length>0&&(l.shift(4),d+=l.move((e?`
`:" ")+o.indentLines(o.containerFlow(n,l.current()),e?LR:yG))),p(),d}}function yG(s,e,r){return e===0?s:LR(s,e,r)}function LR(s,e,r){return(r?"":"    ")+s}const bG=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];zR.peek=CG;function vG(){return{canContainEols:["delete"],enter:{strikethrough:wG},exit:{strikethrough:EG}}}function SG(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:bG}],handlers:{delete:zR}}}function wG(s){this.enter({type:"delete",children:[]},s)}function EG(s){this.exit(s)}function zR(s,e,r,n){const i=r.createTracker(n),o=r.enter("strikethrough");let a=i.move("~~");return a+=r.containerPhrasing(s,{...i.current(),before:a,after:"~"}),a+=i.move("~~"),o(),a}function CG(){return"~"}function jG(s){return s.length}function kG(s,e){const r=e||{},n=(r.align||[]).concat(),i=r.stringLength||jG,o=[],a=[],l=[],d=[];let p=0,f=-1;for(;++f<s.length;){const w=[],y=[];let C=-1;for(s[f].length>p&&(p=s[f].length);++C<s[f].length;){const T=AG(s[f][C]);if(r.alignDelimiters!==!1){const E=i(T);y[C]=E,(d[C]===void 0||E>d[C])&&(d[C]=E)}w.push(T)}a[f]=w,l[f]=y}let h=-1;if(typeof n=="object"&&"length"in n)for(;++h<p;)o[h]=sj(n[h]);else{const w=sj(n);for(;++h<p;)o[h]=w}h=-1;const x=[],m=[];for(;++h<p;){const w=o[h];let y="",C="";w===99?(y=":",C=":"):w===108?y=":":w===114&&(C=":");let T=r.alignDelimiters===!1?1:Math.max(1,d[h]-y.length-C.length);const E=y+"-".repeat(T)+C;r.alignDelimiters!==!1&&(T=y.length+T+C.length,T>d[h]&&(d[h]=T),m[h]=T),x[h]=E}a.splice(1,0,x),l.splice(1,0,m),f=-1;const b=[];for(;++f<a.length;){const w=a[f],y=l[f];h=-1;const C=[];for(;++h<p;){const T=w[h]||"";let E="",j="";if(r.alignDelimiters!==!1){const k=d[h]-(y[h]||0),A=o[h];A===114?E=" ".repeat(k):A===99?k%2?(E=" ".repeat(k/2+.5),j=" ".repeat(k/2-.5)):(E=" ".repeat(k/2),j=E):j=" ".repeat(k)}r.delimiterStart!==!1&&!h&&C.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&T==="")&&(r.delimiterStart!==!1||h)&&C.push(" "),r.alignDelimiters!==!1&&C.push(E),C.push(T),r.alignDelimiters!==!1&&C.push(j),r.padding!==!1&&C.push(" "),(r.delimiterEnd!==!1||h!==p-1)&&C.push("|")}b.push(r.delimiterEnd===!1?C.join("").replace(/ +$/,""):C.join(""))}return b.join(`
`)}function AG(s){return s==null?"":String(s)}function sj(s){const e=typeof s=="string"?s.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function TG(s,e,r,n){const i=r.enter("blockquote"),o=r.createTracker(n);o.move("> "),o.shift(2);const a=r.indentLines(r.containerFlow(s,o.current()),RG);return i(),a}function RG(s,e,r){return">"+(r?"":" ")+s}function NG(s,e){return ij(s,e.inConstruct,!0)&&!ij(s,e.notInConstruct,!1)}function ij(s,e,r){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return r;let n=-1;for(;++n<e.length;)if(s.includes(e[n]))return!0;return!1}function oj(s,e,r,n){let i=-1;for(;++i<r.unsafe.length;)if(r.unsafe[i].character===`
`&&NG(r.stack,r.unsafe[i]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function OG(s,e){const r=String(s);let n=r.indexOf(e),i=n,o=0,a=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===i?++o>a&&(a=o):o=1,i=n+e.length,n=r.indexOf(e,i);return a}function _G(s,e){return!!(e.options.fences===!1&&s.value&&!s.lang&&/[^ \r\n]/.test(s.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(s.value))}function DG(s){const e=s.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function IG(s,e,r,n){const i=DG(r),o=s.value||"",a=i==="`"?"GraveAccent":"Tilde";if(_G(s,r)){const h=r.enter("codeIndented"),x=r.indentLines(o,PG);return h(),x}const l=r.createTracker(n),d=i.repeat(Math.max(OG(o,i)+1,3)),p=r.enter("codeFenced");let f=l.move(d);if(s.lang){const h=r.enter(`codeFencedLang${a}`);f+=l.move(r.safe(s.lang,{before:f,after:" ",encode:["`"],...l.current()})),h()}if(s.lang&&s.meta){const h=r.enter(`codeFencedMeta${a}`);f+=l.move(" "),f+=l.move(r.safe(s.meta,{before:f,after:`
`,encode:["`"],...l.current()})),h()}return f+=l.move(`
`),o&&(f+=l.move(o+`
`)),f+=l.move(d),p(),f}function PG(s,e,r){return(r?"":"    ")+s}function uv(s){const e=s.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function LG(s,e,r,n){const i=uv(r),o=i==='"'?"Quote":"Apostrophe",a=r.enter("definition");let l=r.enter("label");const d=r.createTracker(n);let p=d.move("[");return p+=d.move(r.safe(r.associationId(s),{before:p,after:"]",...d.current()})),p+=d.move("]: "),l(),!s.url||/[\0- \u007F]/.test(s.url)?(l=r.enter("destinationLiteral"),p+=d.move("<"),p+=d.move(r.safe(s.url,{before:p,after:">",...d.current()})),p+=d.move(">")):(l=r.enter("destinationRaw"),p+=d.move(r.safe(s.url,{before:p,after:s.title?" ":`
`,...d.current()}))),l(),s.title&&(l=r.enter(`title${o}`),p+=d.move(" "+i),p+=d.move(r.safe(s.title,{before:p,after:i,...d.current()})),p+=d.move(i),l()),a(),p}function zG(s){const e=s.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function Ip(s){return"&#x"+s.toString(16).toUpperCase()+";"}function bg(s,e,r){const n=Id(s),i=Id(e);return n===void 0?i===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:i===void 0?{inside:!1,outside:!1}:i===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}MR.peek=MG;function MR(s,e,r,n){const i=zG(r),o=r.enter("emphasis"),a=r.createTracker(n),l=a.move(i);let d=a.move(r.containerPhrasing(s,{after:i,before:l,...a.current()}));const p=d.charCodeAt(0),f=bg(n.before.charCodeAt(n.before.length-1),p,i);f.inside&&(d=Ip(p)+d.slice(1));const h=d.charCodeAt(d.length-1),x=bg(n.after.charCodeAt(0),h,i);x.inside&&(d=d.slice(0,-1)+Ip(h));const m=a.move(i);return o(),r.attentionEncodeSurroundingInfo={after:x.outside,before:f.outside},l+d+m}function MG(s,e,r){return r.options.emphasis||"*"}function BG(s,e){let r=!1;return cv(s,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,ib}),!!((!s.depth||s.depth<3)&&rv(s)&&(e.options.setext||r))}function FG(s,e,r,n){const i=Math.max(Math.min(6,s.depth||1),1),o=r.createTracker(n);if(BG(s,r)){const f=r.enter("headingSetext"),h=r.enter("phrasing"),x=r.containerPhrasing(s,{...o.current(),before:`
`,after:`
`});return h(),f(),x+`
`+(i===1?"=":"-").repeat(x.length-(Math.max(x.lastIndexOf("\r"),x.lastIndexOf(`
`))+1))}const a="#".repeat(i),l=r.enter("headingAtx"),d=r.enter("phrasing");o.move(a+" ");let p=r.containerPhrasing(s,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(p)&&(p=Ip(p.charCodeAt(0))+p.slice(1)),p=p?a+" "+p:a,r.options.closeAtx&&(p+=" "+a),d(),l(),p}BR.peek=$G;function BR(s){return s.value||""}function $G(){return"<"}FR.peek=GG;function FR(s,e,r,n){const i=uv(r),o=i==='"'?"Quote":"Apostrophe",a=r.enter("image");let l=r.enter("label");const d=r.createTracker(n);let p=d.move("![");return p+=d.move(r.safe(s.alt,{before:p,after:"]",...d.current()})),p+=d.move("]("),l(),!s.url&&s.title||/[\0- \u007F]/.test(s.url)?(l=r.enter("destinationLiteral"),p+=d.move("<"),p+=d.move(r.safe(s.url,{before:p,after:">",...d.current()})),p+=d.move(">")):(l=r.enter("destinationRaw"),p+=d.move(r.safe(s.url,{before:p,after:s.title?" ":")",...d.current()}))),l(),s.title&&(l=r.enter(`title${o}`),p+=d.move(" "+i),p+=d.move(r.safe(s.title,{before:p,after:i,...d.current()})),p+=d.move(i),l()),p+=d.move(")"),a(),p}function GG(){return"!"}$R.peek=UG;function $R(s,e,r,n){const i=s.referenceType,o=r.enter("imageReference");let a=r.enter("label");const l=r.createTracker(n);let d=l.move("![");const p=r.safe(s.alt,{before:d,after:"]",...l.current()});d+=l.move(p+"]["),a();const f=r.stack;r.stack=[],a=r.enter("reference");const h=r.safe(r.associationId(s),{before:d,after:"]",...l.current()});return a(),r.stack=f,o(),i==="full"||!p||p!==h?d+=l.move(h+"]"):i==="shortcut"?d=d.slice(0,-1):d+=l.move("]"),d}function UG(){return"!"}GR.peek=WG;function GR(s,e,r){let n=s.value||"",i="`",o=-1;for(;new RegExp("(^|[^`])"+i+"([^`]|$)").test(n);)i+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++o<r.unsafe.length;){const a=r.unsafe[o],l=r.compilePattern(a);let d;if(a.atBreak)for(;d=l.exec(n);){let p=d.index;n.charCodeAt(p)===10&&n.charCodeAt(p-1)===13&&p--,n=n.slice(0,p)+" "+n.slice(d.index+1)}}return i+n+i}function WG(){return"`"}function UR(s,e){const r=rv(s);return!!(!e.options.resourceLink&&s.url&&!s.title&&s.children&&s.children.length===1&&s.children[0].type==="text"&&(r===s.url||"mailto:"+r===s.url)&&/^[a-z][a-z+.-]+:/i.test(s.url)&&!/[\0- <>\u007F]/.test(s.url))}WR.peek=qG;function WR(s,e,r,n){const i=uv(r),o=i==='"'?"Quote":"Apostrophe",a=r.createTracker(n);let l,d;if(UR(s,r)){const f=r.stack;r.stack=[],l=r.enter("autolink");let h=a.move("<");return h+=a.move(r.containerPhrasing(s,{before:h,after:">",...a.current()})),h+=a.move(">"),l(),r.stack=f,h}l=r.enter("link"),d=r.enter("label");let p=a.move("[");return p+=a.move(r.containerPhrasing(s,{before:p,after:"](",...a.current()})),p+=a.move("]("),d(),!s.url&&s.title||/[\0- \u007F]/.test(s.url)?(d=r.enter("destinationLiteral"),p+=a.move("<"),p+=a.move(r.safe(s.url,{before:p,after:">",...a.current()})),p+=a.move(">")):(d=r.enter("destinationRaw"),p+=a.move(r.safe(s.url,{before:p,after:s.title?" ":")",...a.current()}))),d(),s.title&&(d=r.enter(`title${o}`),p+=a.move(" "+i),p+=a.move(r.safe(s.title,{before:p,after:i,...a.current()})),p+=a.move(i),d()),p+=a.move(")"),l(),p}function qG(s,e,r){return UR(s,r)?"<":"["}qR.peek=HG;function qR(s,e,r,n){const i=s.referenceType,o=r.enter("linkReference");let a=r.enter("label");const l=r.createTracker(n);let d=l.move("[");const p=r.containerPhrasing(s,{before:d,after:"]",...l.current()});d+=l.move(p+"]["),a();const f=r.stack;r.stack=[],a=r.enter("reference");const h=r.safe(r.associationId(s),{before:d,after:"]",...l.current()});return a(),r.stack=f,o(),i==="full"||!p||p!==h?d+=l.move(h+"]"):i==="shortcut"?d=d.slice(0,-1):d+=l.move("]"),d}function HG(){return"["}function pv(s){const e=s.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function YG(s){const e=pv(s),r=s.options.bulletOther;if(!r)return e==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+r+"`) to be different");return r}function KG(s){const e=s.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function HR(s){const e=s.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function VG(s,e,r,n){const i=r.enter("list"),o=r.bulletCurrent;let a=s.ordered?KG(r):pv(r);const l=s.ordered?a==="."?")":".":YG(r);let d=e&&r.bulletLastUsed?a===r.bulletLastUsed:!1;if(!s.ordered){const f=s.children?s.children[0]:void 0;if((a==="*"||a==="-")&&f&&(!f.children||!f.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(d=!0),HR(r)===a&&f){let h=-1;for(;++h<s.children.length;){const x=s.children[h];if(x&&x.type==="listItem"&&x.children&&x.children[0]&&x.children[0].type==="thematicBreak"){d=!0;break}}}}d&&(a=l),r.bulletCurrent=a;const p=r.containerFlow(s,n);return r.bulletLastUsed=a,r.bulletCurrent=o,i(),p}function XG(s){const e=s.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function JG(s,e,r,n){const i=XG(r);let o=r.bulletCurrent||pv(r);e&&e.type==="list"&&e.ordered&&(o=(typeof e.start=="number"&&e.start>-1?e.start:1)+(r.options.incrementListMarker===!1?0:e.children.indexOf(s))+o);let a=o.length+1;(i==="tab"||i==="mixed"&&(e&&e.type==="list"&&e.spread||s.spread))&&(a=Math.ceil(a/4)*4);const l=r.createTracker(n);l.move(o+" ".repeat(a-o.length)),l.shift(a);const d=r.enter("listItem"),p=r.indentLines(r.containerFlow(s,l.current()),f);return d(),p;function f(h,x,m){return x?(m?"":" ".repeat(a))+h:(m?o:o+" ".repeat(a-o.length))+h}}function QG(s,e,r,n){const i=r.enter("paragraph"),o=r.enter("phrasing"),a=r.containerPhrasing(s,n);return o(),i(),a}const ZG=ix(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function eU(s,e,r,n){return(s.children.some(function(a){return ZG(a)})?r.containerPhrasing:r.containerFlow).call(r,s,n)}function tU(s){const e=s.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}YR.peek=rU;function YR(s,e,r,n){const i=tU(r),o=r.enter("strong"),a=r.createTracker(n),l=a.move(i+i);let d=a.move(r.containerPhrasing(s,{after:i,before:l,...a.current()}));const p=d.charCodeAt(0),f=bg(n.before.charCodeAt(n.before.length-1),p,i);f.inside&&(d=Ip(p)+d.slice(1));const h=d.charCodeAt(d.length-1),x=bg(n.after.charCodeAt(0),h,i);x.inside&&(d=d.slice(0,-1)+Ip(h));const m=a.move(i+i);return o(),r.attentionEncodeSurroundingInfo={after:x.outside,before:f.outside},l+d+m}function rU(s,e,r){return r.options.strong||"*"}function nU(s,e,r,n){return r.safe(s.value,n)}function sU(s){const e=s.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function iU(s,e,r){const n=(HR(r)+(r.options.ruleSpaces?" ":"")).repeat(sU(r));return r.options.ruleSpaces?n.slice(0,-1):n}const KR={blockquote:TG,break:oj,code:IG,definition:LG,emphasis:MR,hardBreak:oj,heading:FG,html:BR,image:FR,imageReference:$R,inlineCode:GR,link:WR,linkReference:qR,list:VG,listItem:JG,paragraph:QG,root:eU,strong:YR,text:nU,thematicBreak:iU};function oU(){return{enter:{table:aU,tableData:aj,tableHeader:aj,tableRow:cU},exit:{codeText:dU,table:lU,tableData:r0,tableHeader:r0,tableRow:r0}}}function aU(s){const e=s._align;this.enter({type:"table",align:e.map(function(r){return r==="none"?null:r}),children:[]},s),this.data.inTable=!0}function lU(s){this.exit(s),this.data.inTable=void 0}function cU(s){this.enter({type:"tableRow",children:[]},s)}function r0(s){this.exit(s)}function aj(s){this.enter({type:"tableCell",children:[]},s)}function dU(s){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,uU));const r=this.stack[this.stack.length-1];r.type,r.value=e,this.exit(s)}function uU(s,e){return e==="|"?e:s}function pU(s){const e=s||{},r=e.tableCellPadding,n=e.tablePipeAlign,i=e.stringLength,o=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:x,table:a,tableCell:d,tableRow:l}};function a(m,b,w,y){return p(f(m,w,y),m.align)}function l(m,b,w,y){const C=h(m,w,y),T=p([C]);return T.slice(0,T.indexOf(`
`))}function d(m,b,w,y){const C=w.enter("tableCell"),T=w.enter("phrasing"),E=w.containerPhrasing(m,{...y,before:o,after:o});return T(),C(),E}function p(m,b){return kG(m,{align:b,alignDelimiters:n,padding:r,stringLength:i})}function f(m,b,w){const y=m.children;let C=-1;const T=[],E=b.enter("table");for(;++C<y.length;)T[C]=h(y[C],b,w);return E(),T}function h(m,b,w){const y=m.children;let C=-1;const T=[],E=b.enter("tableRow");for(;++C<y.length;)T[C]=d(y[C],m,b,w);return E(),T}function x(m,b,w){let y=KR.inlineCode(m,b,w);return w.stack.includes("tableCell")&&(y=y.replace(/\|/g,"\\$&")),y}}function hU(){return{exit:{taskListCheckValueChecked:lj,taskListCheckValueUnchecked:lj,paragraph:gU}}}function fU(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:xU}}}function lj(s){const e=this.stack[this.stack.length-2];e.type,e.checked=s.type==="taskListCheckValueChecked"}function gU(s){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const i=e.children;let o=-1,a;for(;++o<i.length;){const l=i[o];if(l.type==="paragraph"){a=l;break}}a===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(s)}function xU(s,e,r,n){const i=s.children[0],o=typeof s.checked=="boolean"&&i&&i.type==="paragraph",a="["+(s.checked?"x":" ")+"] ",l=r.createTracker(n);o&&l.move(a);let d=KR.listItem(s,e,r,{...n,...l.current()});return o&&(d=d.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,p)),d;function p(f){return f+a}}function mU(){return[V6(),xG(),vG(),oU(),hU()]}function yU(s){return{extensions:[X6(),mG(s),SG(),pU(s),fU()]}}const bU={tokenize:jU,partial:!0},VR={tokenize:kU,partial:!0},XR={tokenize:AU,partial:!0},JR={tokenize:TU,partial:!0},vU={tokenize:RU,partial:!0},QR={name:"wwwAutolink",tokenize:EU,previous:e2},ZR={name:"protocolAutolink",tokenize:CU,previous:t2},Aa={name:"emailAutolink",tokenize:wU,previous:r2},Vo={};function SU(){return{text:Vo}}let Vl=48;for(;Vl<123;)Vo[Vl]=Aa,Vl++,Vl===58?Vl=65:Vl===91&&(Vl=97);Vo[43]=Aa;Vo[45]=Aa;Vo[46]=Aa;Vo[95]=Aa;Vo[72]=[Aa,ZR];Vo[104]=[Aa,ZR];Vo[87]=[Aa,QR];Vo[119]=[Aa,QR];function wU(s,e,r){const n=this;let i,o;return a;function a(h){return!db(h)||!r2.call(n,n.previous)||hv(n.events)?r(h):(s.enter("literalAutolink"),s.enter("literalAutolinkEmail"),l(h))}function l(h){return db(h)?(s.consume(h),l):h===64?(s.consume(h),d):r(h)}function d(h){return h===46?s.check(vU,f,p)(h):h===45||h===95||Ys(h)?(o=!0,s.consume(h),d):f(h)}function p(h){return s.consume(h),i=!0,d}function f(h){return o&&i&&ti(n.previous)?(s.exit("literalAutolinkEmail"),s.exit("literalAutolink"),e(h)):r(h)}}function EU(s,e,r){const n=this;return i;function i(a){return a!==87&&a!==119||!e2.call(n,n.previous)||hv(n.events)?r(a):(s.enter("literalAutolink"),s.enter("literalAutolinkWww"),s.check(bU,s.attempt(VR,s.attempt(XR,o),r),r)(a))}function o(a){return s.exit("literalAutolinkWww"),s.exit("literalAutolink"),e(a)}}function CU(s,e,r){const n=this;let i="",o=!1;return a;function a(h){return(h===72||h===104)&&t2.call(n,n.previous)&&!hv(n.events)?(s.enter("literalAutolink"),s.enter("literalAutolinkHttp"),i+=String.fromCodePoint(h),s.consume(h),l):r(h)}function l(h){if(ti(h)&&i.length<5)return i+=String.fromCodePoint(h),s.consume(h),l;if(h===58){const x=i.toLowerCase();if(x==="http"||x==="https")return s.consume(h),d}return r(h)}function d(h){return h===47?(s.consume(h),o?p:(o=!0,d)):r(h)}function p(h){return h===null||xg(h)||gn(h)||yc(h)||rx(h)?r(h):s.attempt(VR,s.attempt(XR,f),r)(h)}function f(h){return s.exit("literalAutolinkHttp"),s.exit("literalAutolink"),e(h)}}function jU(s,e,r){let n=0;return i;function i(a){return(a===87||a===119)&&n<3?(n++,s.consume(a),i):a===46&&n===3?(s.consume(a),o):r(a)}function o(a){return a===null?r(a):e(a)}}function kU(s,e,r){let n,i,o;return a;function a(p){return p===46||p===95?s.check(JR,d,l)(p):p===null||gn(p)||yc(p)||p!==45&&rx(p)?d(p):(o=!0,s.consume(p),a)}function l(p){return p===95?n=!0:(i=n,n=void 0),s.consume(p),a}function d(p){return i||n||!o?r(p):e(p)}}function AU(s,e){let r=0,n=0;return i;function i(a){return a===40?(r++,s.consume(a),i):a===41&&n<r?o(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?s.check(JR,e,o)(a):a===null||gn(a)||yc(a)?e(a):(s.consume(a),i)}function o(a){return a===41&&n++,s.consume(a),i}}function TU(s,e,r){return n;function n(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(s.consume(l),n):l===38?(s.consume(l),o):l===93?(s.consume(l),i):l===60||l===null||gn(l)||yc(l)?e(l):r(l)}function i(l){return l===null||l===40||l===91||gn(l)||yc(l)?e(l):n(l)}function o(l){return ti(l)?a(l):r(l)}function a(l){return l===59?(s.consume(l),n):ti(l)?(s.consume(l),a):r(l)}}function RU(s,e,r){return n;function n(o){return s.consume(o),i}function i(o){return Ys(o)?r(o):e(o)}}function e2(s){return s===null||s===40||s===42||s===95||s===91||s===93||s===126||gn(s)}function t2(s){return!ti(s)}function r2(s){return!(s===47||db(s))}function db(s){return s===43||s===45||s===46||s===95||Ys(s)}function hv(s){let e=s.length,r=!1;for(;e--;){const n=s[e][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return s.length>0&&!r&&(s[s.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const NU={tokenize:MU,partial:!0};function OU(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:PU,continuation:{tokenize:LU},exit:zU}},text:{91:{name:"gfmFootnoteCall",tokenize:IU},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:_U,resolveTo:DU}}}}function _U(s,e,r){const n=this;let i=n.events.length;const o=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let a;for(;i--;){const d=n.events[i][1];if(d.type==="labelImage"){a=d;break}if(d.type==="gfmFootnoteCall"||d.type==="labelLink"||d.type==="label"||d.type==="image"||d.type==="link")break}return l;function l(d){if(!a||!a._balanced)return r(d);const p=Co(n.sliceSerialize({start:a.end,end:n.now()}));return p.codePointAt(0)!==94||!o.includes(p.slice(1))?r(d):(s.enter("gfmFootnoteCallLabelMarker"),s.consume(d),s.exit("gfmFootnoteCallLabelMarker"),e(d))}}function DU(s,e){let r=s.length;for(;r--;)if(s[r][1].type==="labelImage"&&s[r][0]==="enter"){s[r][1];break}s[r+1][1].type="data",s[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},s[r+3][1].start),end:Object.assign({},s[s.length-1][1].end)},i={type:"gfmFootnoteCallMarker",start:Object.assign({},s[r+3][1].end),end:Object.assign({},s[r+3][1].end)};i.end.column++,i.end.offset++,i.end._bufferIndex++;const o={type:"gfmFootnoteCallString",start:Object.assign({},i.end),end:Object.assign({},s[s.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},o.start),end:Object.assign({},o.end)},l=[s[r+1],s[r+2],["enter",n,e],s[r+3],s[r+4],["enter",i,e],["exit",i,e],["enter",o,e],["enter",a,e],["exit",a,e],["exit",o,e],s[s.length-2],s[s.length-1],["exit",n,e]];return s.splice(r,s.length-r+1,...l),s}function IU(s,e,r){const n=this,i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let o=0,a;return l;function l(h){return s.enter("gfmFootnoteCall"),s.enter("gfmFootnoteCallLabelMarker"),s.consume(h),s.exit("gfmFootnoteCallLabelMarker"),d}function d(h){return h!==94?r(h):(s.enter("gfmFootnoteCallMarker"),s.consume(h),s.exit("gfmFootnoteCallMarker"),s.enter("gfmFootnoteCallString"),s.enter("chunkString").contentType="string",p)}function p(h){if(o>999||h===93&&!a||h===null||h===91||gn(h))return r(h);if(h===93){s.exit("chunkString");const x=s.exit("gfmFootnoteCallString");return i.includes(Co(n.sliceSerialize(x)))?(s.enter("gfmFootnoteCallLabelMarker"),s.consume(h),s.exit("gfmFootnoteCallLabelMarker"),s.exit("gfmFootnoteCall"),e):r(h)}return gn(h)||(a=!0),o++,s.consume(h),h===92?f:p}function f(h){return h===91||h===92||h===93?(s.consume(h),o++,p):p(h)}}function PU(s,e,r){const n=this,i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let o,a=0,l;return d;function d(b){return s.enter("gfmFootnoteDefinition")._container=!0,s.enter("gfmFootnoteDefinitionLabel"),s.enter("gfmFootnoteDefinitionLabelMarker"),s.consume(b),s.exit("gfmFootnoteDefinitionLabelMarker"),p}function p(b){return b===94?(s.enter("gfmFootnoteDefinitionMarker"),s.consume(b),s.exit("gfmFootnoteDefinitionMarker"),s.enter("gfmFootnoteDefinitionLabelString"),s.enter("chunkString").contentType="string",f):r(b)}function f(b){if(a>999||b===93&&!l||b===null||b===91||gn(b))return r(b);if(b===93){s.exit("chunkString");const w=s.exit("gfmFootnoteDefinitionLabelString");return o=Co(n.sliceSerialize(w)),s.enter("gfmFootnoteDefinitionLabelMarker"),s.consume(b),s.exit("gfmFootnoteDefinitionLabelMarker"),s.exit("gfmFootnoteDefinitionLabel"),x}return gn(b)||(l=!0),a++,s.consume(b),b===92?h:f}function h(b){return b===91||b===92||b===93?(s.consume(b),a++,f):f(b)}function x(b){return b===58?(s.enter("definitionMarker"),s.consume(b),s.exit("definitionMarker"),i.includes(o)||i.push(o),Fr(s,m,"gfmFootnoteDefinitionWhitespace")):r(b)}function m(b){return e(b)}}function LU(s,e,r){return s.check(Xp,e,s.attempt(NU,e,r))}function zU(s){s.exit("gfmFootnoteDefinition")}function MU(s,e,r){const n=this;return Fr(s,i,"gfmFootnoteDefinitionIndent",5);function i(o){const a=n.events[n.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?e(o):r(o)}}function BU(s){let r=(s||{}).singleTilde;const n={name:"strikethrough",tokenize:o,resolveAll:i};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function i(a,l){let d=-1;for(;++d<a.length;)if(a[d][0]==="enter"&&a[d][1].type==="strikethroughSequenceTemporary"&&a[d][1]._close){let p=d;for(;p--;)if(a[p][0]==="exit"&&a[p][1].type==="strikethroughSequenceTemporary"&&a[p][1]._open&&a[d][1].end.offset-a[d][1].start.offset===a[p][1].end.offset-a[p][1].start.offset){a[d][1].type="strikethroughSequence",a[p][1].type="strikethroughSequence";const f={type:"strikethrough",start:Object.assign({},a[p][1].start),end:Object.assign({},a[d][1].end)},h={type:"strikethroughText",start:Object.assign({},a[p][1].end),end:Object.assign({},a[d][1].start)},x=[["enter",f,l],["enter",a[p][1],l],["exit",a[p][1],l],["enter",h,l]],m=l.parser.constructs.insideSpan.null;m&&Bi(x,x.length,0,nx(m,a.slice(p+1,d),l)),Bi(x,x.length,0,[["exit",h,l],["enter",a[d][1],l],["exit",a[d][1],l],["exit",f,l]]),Bi(a,p-1,d-p+3,x),d=p+x.length-2;break}}for(d=-1;++d<a.length;)a[d][1].type==="strikethroughSequenceTemporary"&&(a[d][1].type="data");return a}function o(a,l,d){const p=this.previous,f=this.events;let h=0;return x;function x(b){return p===126&&f[f.length-1][1].type!=="characterEscape"?d(b):(a.enter("strikethroughSequenceTemporary"),m(b))}function m(b){const w=Id(p);if(b===126)return h>1?d(b):(a.consume(b),h++,m);if(h<2&&!r)return d(b);const y=a.exit("strikethroughSequenceTemporary"),C=Id(b);return y._open=!C||C===2&&!!w,y._close=!w||w===2&&!!C,l(b)}}}class FU{constructor(){this.map=[]}add(e,r,n){$U(this,e,r,n)}consume(e){if(this.map.sort(function(o,a){return o[0]-a[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(e.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),e.length=this.map[r][0];n.push(e.slice()),e.length=0;let i=n.pop();for(;i;){for(const o of i)e.push(o);i=n.pop()}this.map.length=0}}function $U(s,e,r,n){let i=0;if(!(r===0&&n.length===0)){for(;i<s.map.length;){if(s.map[i][0]===e){s.map[i][1]+=r,s.map[i][2].push(...n);return}i+=1}s.map.push([e,r,n])}}function GU(s,e){let r=!1;const n=[];for(;e<s.length;){const i=s[e];if(r){if(i[0]==="enter")i[1].type==="tableContent"&&n.push(s[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(i[1].type==="tableContent"){if(s[e-1][1].type==="tableDelimiterMarker"){const o=n.length-1;n[o]=n[o]==="left"?"center":"right"}}else if(i[1].type==="tableDelimiterRow")break}else i[0]==="enter"&&i[1].type==="tableDelimiterRow"&&(r=!0);e+=1}return n}function UU(){return{flow:{null:{name:"table",tokenize:WU,resolveAll:qU}}}}function WU(s,e,r){const n=this;let i=0,o=0,a;return l;function l(I){let O=n.events.length-1;for(;O>-1;){const F=n.events[O][1].type;if(F==="lineEnding"||F==="linePrefix")O--;else break}const G=O>-1?n.events[O][1].type:null,B=G==="tableHead"||G==="tableRow"?A:d;return B===A&&n.parser.lazy[n.now().line]?r(I):B(I)}function d(I){return s.enter("tableHead"),s.enter("tableRow"),p(I)}function p(I){return I===124||(a=!0,o+=1),f(I)}function f(I){return I===null?r(I):Yt(I)?o>1?(o=0,n.interrupt=!0,s.exit("tableRow"),s.enter("lineEnding"),s.consume(I),s.exit("lineEnding"),m):r(I):wr(I)?Fr(s,f,"whitespace")(I):(o+=1,a&&(a=!1,i+=1),I===124?(s.enter("tableCellDivider"),s.consume(I),s.exit("tableCellDivider"),a=!0,f):(s.enter("data"),h(I)))}function h(I){return I===null||I===124||gn(I)?(s.exit("data"),f(I)):(s.consume(I),I===92?x:h)}function x(I){return I===92||I===124?(s.consume(I),h):h(I)}function m(I){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(I):(s.enter("tableDelimiterRow"),a=!1,wr(I)?Fr(s,b,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(I):b(I))}function b(I){return I===45||I===58?y(I):I===124?(a=!0,s.enter("tableCellDivider"),s.consume(I),s.exit("tableCellDivider"),w):k(I)}function w(I){return wr(I)?Fr(s,y,"whitespace")(I):y(I)}function y(I){return I===58?(o+=1,a=!0,s.enter("tableDelimiterMarker"),s.consume(I),s.exit("tableDelimiterMarker"),C):I===45?(o+=1,C(I)):I===null||Yt(I)?j(I):k(I)}function C(I){return I===45?(s.enter("tableDelimiterFiller"),T(I)):k(I)}function T(I){return I===45?(s.consume(I),T):I===58?(a=!0,s.exit("tableDelimiterFiller"),s.enter("tableDelimiterMarker"),s.consume(I),s.exit("tableDelimiterMarker"),E):(s.exit("tableDelimiterFiller"),E(I))}function E(I){return wr(I)?Fr(s,j,"whitespace")(I):j(I)}function j(I){return I===124?b(I):I===null||Yt(I)?!a||i!==o?k(I):(s.exit("tableDelimiterRow"),s.exit("tableHead"),e(I)):k(I)}function k(I){return r(I)}function A(I){return s.enter("tableRow"),R(I)}function R(I){return I===124?(s.enter("tableCellDivider"),s.consume(I),s.exit("tableCellDivider"),R):I===null||Yt(I)?(s.exit("tableRow"),e(I)):wr(I)?Fr(s,R,"whitespace")(I):(s.enter("data"),M(I))}function M(I){return I===null||I===124||gn(I)?(s.exit("data"),R(I)):(s.consume(I),I===92?P:M)}function P(I){return I===92||I===124?(s.consume(I),M):M(I)}}function qU(s,e){let r=-1,n=!0,i=0,o=[0,0,0,0],a=[0,0,0,0],l=!1,d=0,p,f,h;const x=new FU;for(;++r<s.length;){const m=s[r],b=m[1];m[0]==="enter"?b.type==="tableHead"?(l=!1,d!==0&&(cj(x,e,d,p,f),f=void 0,d=0),p={type:"table",start:Object.assign({},b.start),end:Object.assign({},b.end)},x.add(r,0,[["enter",p,e]])):b.type==="tableRow"||b.type==="tableDelimiterRow"?(n=!0,h=void 0,o=[0,0,0,0],a=[0,r+1,0,0],l&&(l=!1,f={type:"tableBody",start:Object.assign({},b.start),end:Object.assign({},b.end)},x.add(r,0,[["enter",f,e]])),i=b.type==="tableDelimiterRow"?2:f?3:1):i&&(b.type==="data"||b.type==="tableDelimiterMarker"||b.type==="tableDelimiterFiller")?(n=!1,a[2]===0&&(o[1]!==0&&(a[0]=a[1],h=Sf(x,e,o,i,void 0,h),o=[0,0,0,0]),a[2]=r)):b.type==="tableCellDivider"&&(n?n=!1:(o[1]!==0&&(a[0]=a[1],h=Sf(x,e,o,i,void 0,h)),o=a,a=[o[1],r,0,0])):b.type==="tableHead"?(l=!0,d=r):b.type==="tableRow"||b.type==="tableDelimiterRow"?(d=r,o[1]!==0?(a[0]=a[1],h=Sf(x,e,o,i,r,h)):a[1]!==0&&(h=Sf(x,e,a,i,r,h)),i=0):i&&(b.type==="data"||b.type==="tableDelimiterMarker"||b.type==="tableDelimiterFiller")&&(a[3]=r)}for(d!==0&&cj(x,e,d,p,f),x.consume(e.events),r=-1;++r<e.events.length;){const m=e.events[r];m[0]==="enter"&&m[1].type==="table"&&(m[1]._align=GU(e.events,r))}return s}function Sf(s,e,r,n,i,o){const a=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",l="tableContent";r[0]!==0&&(o.end=Object.assign({},md(e.events,r[0])),s.add(r[0],0,[["exit",o,e]]));const d=md(e.events,r[1]);if(o={type:a,start:Object.assign({},d),end:Object.assign({},d)},s.add(r[1],0,[["enter",o,e]]),r[2]!==0){const p=md(e.events,r[2]),f=md(e.events,r[3]),h={type:l,start:Object.assign({},p),end:Object.assign({},f)};if(s.add(r[2],0,[["enter",h,e]]),n!==2){const x=e.events[r[2]],m=e.events[r[3]];if(x[1].end=Object.assign({},m[1].end),x[1].type="chunkText",x[1].contentType="text",r[3]>r[2]+1){const b=r[2]+1,w=r[3]-r[2]-1;s.add(b,w,[])}}s.add(r[3]+1,0,[["exit",h,e]])}return i!==void 0&&(o.end=Object.assign({},md(e.events,i)),s.add(i,0,[["exit",o,e]]),o=void 0),o}function cj(s,e,r,n,i){const o=[],a=md(e.events,r);i&&(i.end=Object.assign({},a),o.push(["exit",i,e])),n.end=Object.assign({},a),o.push(["exit",n,e]),s.add(r+1,0,o)}function md(s,e){const r=s[e],n=r[0]==="enter"?"start":"end";return r[1][n]}const HU={name:"tasklistCheck",tokenize:KU};function YU(){return{text:{91:HU}}}function KU(s,e,r){const n=this;return i;function i(d){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(d):(s.enter("taskListCheck"),s.enter("taskListCheckMarker"),s.consume(d),s.exit("taskListCheckMarker"),o)}function o(d){return gn(d)?(s.enter("taskListCheckValueUnchecked"),s.consume(d),s.exit("taskListCheckValueUnchecked"),a):d===88||d===120?(s.enter("taskListCheckValueChecked"),s.consume(d),s.exit("taskListCheckValueChecked"),a):r(d)}function a(d){return d===93?(s.enter("taskListCheckMarker"),s.consume(d),s.exit("taskListCheckMarker"),s.exit("taskListCheck"),l):r(d)}function l(d){return Yt(d)?e(d):wr(d)?s.check({tokenize:VU},e,r)(d):r(d)}}function VU(s,e,r){return Fr(s,n,"whitespace");function n(i){return i===null?r(i):e(i)}}function XU(s){return hR([SU(),OU(),BU(s),UU(),YU()])}const JU={};function QU(s){const e=this,r=s||JU,n=e.data(),i=n.micromarkExtensions||(n.micromarkExtensions=[]),o=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),a=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);i.push(XU(r)),o.push(mU()),a.push(yU(r))}const vg=({content:s,style:e={}})=>{const r="#FFA500",n="#FFFFFF",i="#FFFF00",o="#787878",a="#000000",l="#00C800",d={color:n,fontSize:"14px",lineHeight:"1.6",...e};if(!s||typeof s!="string")return t.jsx("div",{style:{...d,color:o},children:"(No content to display)"});try{return t.jsx("div",{style:d,children:t.jsx(cb,{remarkPlugins:[QU],components:{h1:({children:p})=>t.jsx("h1",{style:{color:r,fontSize:"20px",fontWeight:"bold",marginTop:"16px",marginBottom:"12px",borderBottom:`2px solid ${r}`},children:p}),h2:({children:p})=>t.jsx("h2",{style:{color:r,fontSize:"18px",fontWeight:"bold",marginTop:"14px",marginBottom:"10px",borderBottom:`1px solid ${o}`},children:p}),h3:({children:p})=>t.jsx("h3",{style:{color:i,fontSize:"16px",fontWeight:"bold",marginTop:"12px",marginBottom:"8px"},children:p}),h4:({children:p})=>t.jsx("h4",{style:{color:i,fontSize:"15px",fontWeight:"bold",marginTop:"10px",marginBottom:"6px"},children:p}),h5:({children:p})=>t.jsx("h5",{style:{color:n,fontSize:"14px",fontWeight:"bold",marginTop:"8px",marginBottom:"4px"},children:p}),h6:({children:p})=>t.jsx("h6",{style:{color:n,fontSize:"13px",fontWeight:"bold",marginTop:"6px",marginBottom:"3px"},children:p}),p:({children:p})=>t.jsx("p",{style:{marginBottom:"12px",color:n},children:p}),ul:({children:p})=>t.jsx("ul",{style:{marginLeft:"20px",marginBottom:"12px",listStyleType:"disc",color:n},children:p}),ol:({children:p})=>t.jsx("ol",{style:{marginLeft:"20px",marginBottom:"12px",listStyleType:"decimal",color:n},children:p}),li:({children:p})=>t.jsx("li",{style:{marginBottom:"6px",color:n},children:p}),code:({inline:p,children:f,...h})=>p?t.jsx("code",{style:{backgroundColor:a,color:l,padding:"2px 6px",borderRadius:"3px",fontSize:"13px",fontFamily:"Consolas, monospace",border:`1px solid ${o}`},...h,children:f}):t.jsx("code",{style:{display:"block",backgroundColor:a,color:l,padding:"12px",borderRadius:"4px",fontSize:"13px",fontFamily:"Consolas, monospace",border:`1px solid ${o}`,marginBottom:"12px",overflowX:"auto",whiteSpace:"pre-wrap"},...h,children:f}),pre:({children:p})=>t.jsx("pre",{style:{backgroundColor:a,padding:"0",margin:"0 0 12px 0",overflowX:"auto"},children:p}),blockquote:({children:p})=>t.jsx("blockquote",{style:{borderLeft:`4px solid ${r}`,marginLeft:"0",paddingLeft:"16px",marginBottom:"12px",color:o,fontStyle:"italic"},children:p}),a:({children:p,href:f})=>t.jsx("a",{href:f,style:{color:r,textDecoration:"underline",cursor:"pointer"},target:"_blank",rel:"noopener noreferrer",children:p}),table:({children:p})=>t.jsx("table",{style:{borderCollapse:"collapse",width:"100%",marginBottom:"12px",border:`1px solid ${o}`},children:p}),thead:({children:p})=>t.jsx("thead",{style:{backgroundColor:a},children:p}),tbody:({children:p})=>t.jsx("tbody",{children:p}),tr:({children:p})=>t.jsx("tr",{style:{borderBottom:`1px solid ${o}`},children:p}),th:({children:p})=>t.jsx("th",{style:{padding:"8px",textAlign:"left",color:r,fontWeight:"bold",border:`1px solid ${o}`},children:p}),td:({children:p})=>t.jsx("td",{style:{padding:"8px",color:n,border:`1px solid ${o}`},children:p}),hr:()=>t.jsx("hr",{style:{border:"none",borderTop:`1px solid ${o}`,marginTop:"16px",marginBottom:"16px"}}),strong:({children:p})=>t.jsx("strong",{style:{color:i,fontWeight:"bold"},children:p}),em:({children:p})=>t.jsx("em",{style:{color:n,fontStyle:"italic"},children:p}),del:({children:p})=>t.jsx("del",{style:{color:o,textDecoration:"line-through"},children:p})},children:s})})}catch(p){return console.error("Error rendering markdown:",p),t.jsxs("div",{style:{...d,color:o},children:[t.jsx("div",{style:{color:"#ff6b6b",marginBottom:"8px"},children:"Error rendering markdown content"}),t.jsx("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"12px",color:n},children:s})]})}},ZU=({message:s})=>{const{colors:e,fontSize:r,fontFamily:n}=Er(),i=s.role==="user",o=s.role==="assistant",a=l=>new Date(l).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-start",flexDirection:i?"row-reverse":"row"},children:[i?t.jsx("div",{style:{width:"36px",height:"36px",borderRadius:"50%",background:`linear-gradient(135deg, ${e.info} 0%, ${e.primary} 100%)`,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,border:`2px solid ${e.info}33`},children:t.jsx(Kp,{size:18,color:e.background})}):t.jsx("img",{src:"/fincept_icon.ico",alt:"Fincept AI",style:{width:"36px",height:"36px",borderRadius:"50%",objectFit:"cover",flexShrink:0,border:`2px solid ${e.primary}33`}}),t.jsxs("div",{style:{flex:1,maxWidth:"75%",display:"flex",flexDirection:"column",gap:"6px",alignItems:i?"flex-end":"flex-start"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:r.tiny,color:e.textMuted},children:[t.jsx("span",{style:{fontWeight:"bold",color:i?e.info:e.primary},children:i?"YOU":"FINCEPT AI"}),t.jsx("span",{children:""}),t.jsx("span",{children:a(s.timestamp)})]}),t.jsx("div",{style:{background:i?e.panel:`${e.primary}11`,border:`1px solid ${i?e.textMuted:e.primary}33`,borderRadius:"12px",padding:"14px 18px",fontSize:r.body,lineHeight:"1.6",wordBreak:"break-word"},children:o?t.jsx("div",{style:{color:e.text},children:t.jsx(vg,{content:s.content})}):t.jsx("div",{style:{color:e.text,whiteSpace:"pre-wrap"},children:s.content})})]})]})},eW=({onSuggestionClick:s})=>{const{colors:e,fontSize:r}=Er(),n=[{icon:t.jsx(Nr,{size:16}),text:"Show me top market movers today",category:"Markets"},{icon:t.jsx(SB,{size:16}),text:"Get latest financial news",category:"News"},{icon:t.jsx(Jg,{size:16}),text:"Analyze my portfolio performance",category:"Portfolio"},{icon:t.jsx(zT,{size:16}),text:"Calculate stock valuation for AAPL",category:"Analytics"},{icon:t.jsx(wl,{size:16}),text:"What is the current GDP and inflation rate?",category:"Economics"},{icon:t.jsx(ja,{size:16}),text:"Show me market trends for tech sector",category:"Research"}];return t.jsxs("div",{style:{padding:"0 24px 20px",display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsx("h3",{style:{color:e.textMuted,fontSize:r.small,fontWeight:"bold",margin:0},children:"TRY ASKING:"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"10px"},children:n.map((i,o)=>t.jsxs("button",{onClick:()=>s(i.text),style:{background:e.panel,border:`1px solid ${e.primary}33`,borderRadius:"8px",padding:"12px 14px",cursor:"pointer",textAlign:"left",display:"flex",alignItems:"center",gap:"10px",transition:"all 0.2s",color:e.text,fontSize:r.small},onMouseEnter:a=>{a.currentTarget.style.background=`${e.primary}11`,a.currentTarget.style.borderColor=e.primary,a.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:a=>{a.currentTarget.style.background=e.panel,a.currentTarget.style.borderColor=`${e.primary}33`,a.currentTarget.style.transform="translateY(0)"},children:[t.jsx("div",{style:{color:e.primary},children:i.icon}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{fontSize:r.tiny,color:e.textMuted,marginBottom:"2px"},children:i.category}),t.jsx("div",{children:i.text})]})]},o))})]})},tW=()=>{const{colors:s,fontSize:e,fontFamily:r}=Er(),[n,i]=S.useState([]),[o,a]=S.useState(""),[l,d]=S.useState(!1),p=S.useRef(null),f=S.useRef(null);S.useEffect(()=>{h()},[n]),S.useEffect(()=>{i([{id:"welcome",role:"assistant",content:`# Welcome to Fincept Terminal Chat Mode

I'm your AI financial assistant. I can help you with:

** Market Analysis**
- Real-time quotes and price movements
- Technical and fundamental analysis
- Market trends and insights

** Portfolio Management**
- Portfolio analytics and performance
- Risk assessment and optimization
- Asset allocation recommendations

** News & Research**
- Latest financial news
- Company research and analysis
- Economic indicators and trends

** Advanced Analytics**
- Financial modeling
- Valuation analysis
- Custom calculations

**How can I assist you today?**`,timestamp:new Date}])},[]);const h=()=>{p.current?.scrollIntoView({behavior:"smooth"})},x=async()=>{if(!o.trim()||l)return;const w={id:`user-${Date.now()}`,role:"user",content:o.trim(),timestamp:new Date};i(y=>[...y,w]),a(""),d(!0);try{const y=await OF.quickChat(w.content);if(y.success&&y.data){const C={id:`assistant-${Date.now()}`,role:"assistant",content:y.data.ai_response,timestamp:new Date(y.data.timestamp)};i(T=>[...T,C])}else throw new Error(y.error||"Failed to get response")}catch(y){console.error("Chat error:",y);const C={id:`error-${Date.now()}`,role:"assistant",content:"I apologize, but I encountered an error processing your request. Please try again or rephrase your question.",timestamp:new Date};i(T=>[...T,C])}finally{d(!1)}},m=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),x())},b=w=>{a(w),f.current?.focus()};return t.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:s.background,color:s.text,fontFamily:r,fontSize:e.body,overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"16px 24px",borderBottom:`1px solid ${s.primary}33`,display:"flex",alignItems:"center",gap:"12px",background:`linear-gradient(135deg, ${s.background} 0%, ${s.panel} 100%)`},children:[t.jsx("img",{src:"/fincept_icon.ico",alt:"Fincept",style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover"}}),t.jsxs("div",{style:{flex:1},children:[t.jsx("h1",{style:{fontSize:e.heading,fontWeight:"bold",margin:0,color:s.primary},children:"FINCEPT AI ASSISTANT"}),t.jsx("p",{style:{fontSize:e.tiny,margin:0,color:s.textMuted},children:"Powered by Natural Language Processing  Real-time Market Data"})]}),t.jsx("div",{style:{padding:"6px 12px",borderRadius:"12px",background:`${s.success}22`,border:`1px solid ${s.success}`,fontSize:e.tiny,color:s.success,fontWeight:"bold"},children:" ONLINE"})]}),t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"24px",display:"flex",flexDirection:"column",gap:"20px"},children:[n.map(w=>t.jsx(ZU,{message:w},w.id)),l&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:s.textMuted},children:[t.jsx(Hs,{size:16,className:"animate-spin"}),t.jsx("span",{style:{fontSize:e.small},children:"Processing..."})]}),t.jsx("div",{ref:p})]}),n.length<=1&&t.jsx(eW,{onSuggestionClick:b}),t.jsxs("div",{style:{padding:"20px 24px",borderTop:`1px solid ${s.primary}33`,background:s.panel},children:[t.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-end",background:s.background,border:`2px solid ${s.primary}33`,borderRadius:"12px",padding:"12px",transition:"border-color 0.2s"},children:[t.jsx("textarea",{ref:f,value:o,onChange:w=>a(w.target.value),onKeyPress:m,placeholder:"Ask me anything about markets, your portfolio, news, analytics...",disabled:l,style:{flex:1,background:"transparent",border:"none",color:s.text,fontSize:e.body,fontFamily:r,resize:"none",outline:"none",minHeight:"24px",maxHeight:"120px",lineHeight:"24px"},rows:1,onInput:w=>{const y=w.target;y.style.height="24px",y.style.height=`${y.scrollHeight}px`}}),t.jsxs("button",{onClick:x,disabled:!o.trim()||l,style:{background:o.trim()&&!l?s.primary:s.textMuted,border:"none",borderRadius:"8px",padding:"10px 16px",cursor:o.trim()&&!l?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"6px",color:s.background,fontSize:e.small,fontWeight:"bold",transition:"all 0.2s",opacity:o.trim()&&!l?1:.5},children:[l?t.jsx(Hs,{size:16,className:"animate-spin"}):t.jsx(Zg,{size:16}),"SEND"]})]}),t.jsx("p",{style:{fontSize:e.tiny,color:s.textMuted,margin:"8px 0 0 0",textAlign:"center"},children:"Press Enter to send  Shift + Enter for new line"})]})]})},dj="3.0.0";new Date().toISOString().split("T")[0];`${new Date().getFullYear()}`;class rW extends fE{constructor(e){super(e.rid),this.available=!0,this.currentVersion=e.currentVersion,this.version=e.version,this.date=e.date,this.body=e.body,this.rawJson=e.rawJson}async download(e,r){ub(r);const n=new D0;e&&(n.onmessage=e);const i=await lt("plugin:updater|download",{onEvent:n,rid:this.rid,...r});this.downloadedBytes=new fE(i)}async install(){if(!this.downloadedBytes)throw new Error("Update.install called before Update.download");await lt("plugin:updater|install",{updateRid:this.rid,bytesRid:this.downloadedBytes.rid}),this.downloadedBytes=void 0}async downloadAndInstall(e,r){ub(r);const n=new D0;e&&(n.onmessage=e),await lt("plugin:updater|download_and_install",{onEvent:n,rid:this.rid,...r})}async close(){await this.downloadedBytes?.close(),await super.close()}}async function nW(s){ub(s);const e=await lt("plugin:updater|check",{...s});return e?new rW(e):null}function ub(s){s?.headers&&(s.headers=Array.from(new Headers(s.headers).entries()))}async function sW(){await lt("plugin:process|restart")}const iW=1800*1e3,oW="updater_last_check",uj="updater_dismissed_version";function aW(){const[s,e]=S.useState(!1),[r,n]=S.useState(null),[i,o]=S.useState(!1),[a,l]=S.useState(!1),[d,p]=S.useState(0),[f,h]=S.useState(null),x=async(w=!1)=>{try{o(!0),h(null),console.log("[AutoUpdater] Checking for updates...");const y=await nW();if(y?.available){if(console.log(`[AutoUpdater] Update available: v${y.version}`),console.log(`[AutoUpdater] Current version: v${y.currentVersion}`),console.log(`[AutoUpdater] Release date: ${y.date}`),console.log(`[AutoUpdater] Release notes: ${y.body}`),localStorage.getItem(uj)===y.version){console.log("[AutoUpdater] Update was previously dismissed by user"),w||h("This update was previously dismissed. A new update will be shown when available.");return}n(y),e(!0),localStorage.setItem(oW,Date.now().toString())}else console.log("[AutoUpdater] No updates available - you are on the latest version"),w||(h("You are running the latest version!"),setTimeout(()=>h(null),3e3))}catch(y){const C=y instanceof Error?y.message:"Unknown error occurred";console.error("[AutoUpdater] Error checking for updates:",C),!w&&!C.toLowerCase().includes("network")&&!C.toLowerCase().includes("fetch")&&h(`Failed to check for updates: ${C}`)}finally{o(!1)}},m=async()=>{if(!r){console.error("[AutoUpdater] No update info available"),h("No update information available");return}try{l(!0),p(0),h(null),console.log("[AutoUpdater] Starting download and installation...");let w=0,y=0;await r.downloadAndInstall(C=>{switch(C.event){case"Started":w=C.data.contentLength||0,y=0,console.log(`[AutoUpdater] Download started - Size: ${w} bytes`),p(0);break;case"Progress":y+=C.data.chunkLength;const T=w>0?y/w*100:0;console.log(`[AutoUpdater] Download progress: ${T.toFixed(2)}%`),p(Math.min(T,100));break;case"Finished":console.log("[AutoUpdater] Download complete, installing..."),p(100);break}}),console.log("[AutoUpdater] Update installed successfully!"),console.log("[AutoUpdater] Relaunching application in 2 seconds..."),setTimeout(async()=>{try{await sW()}catch(C){console.error("[AutoUpdater] Failed to relaunch:",C),h("Update installed but failed to relaunch. Please restart manually."),l(!1)}},2e3)}catch(w){const y=w instanceof Error?w.message:"Unknown error occurred";console.error("[AutoUpdater] Error installing update:",y),h(`Failed to install update: ${y}`),l(!1),p(0)}},b=()=>{r?.version&&(localStorage.setItem(uj,r.version),console.log(`[AutoUpdater] Update v${r.version} dismissed by user`)),e(!1),n(null),h(null)};return S.useEffect(()=>{const w=setTimeout(()=>{console.log("[AutoUpdater] Performing initial background update check..."),x(!0)},5e3),y=setInterval(()=>{console.log("[AutoUpdater] Performing periodic update check..."),x(!0)},iW);return()=>{clearTimeout(w),clearInterval(y)}},[]),{updateAvailable:s,updateInfo:r,isChecking:i,isInstalling:a,installProgress:d,error:f,checkForUpdate:()=>x(!1),installUpdate:m,dismissUpdate:b}}function n2({...s}){return t.jsx(OI,{"data-slot":"dialog",...s})}function lW({...s}){return t.jsx(LI,{"data-slot":"dialog-portal",...s})}function cW({className:s,...e}){return t.jsx(zI,{"data-slot":"dialog-overlay",className:Bs("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...e})}function s2({className:s,children:e,showCloseButton:r=!0,...n}){return t.jsxs(lW,{"data-slot":"dialog-portal",children:[t.jsx(cW,{}),t.jsxs(_I,{"data-slot":"dialog-content",className:Bs("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...n,children:[e,r&&t.jsxs(DI,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[t.jsx(ln,{}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function i2({className:s,...e}){return t.jsx("div",{"data-slot":"dialog-header",className:Bs("flex flex-col gap-2 text-center sm:text-left",s),...e})}function o2({className:s,...e}){return t.jsx("div",{"data-slot":"dialog-footer",className:Bs("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...e})}function a2({className:s,...e}){return t.jsx(II,{"data-slot":"dialog-title",className:Bs("text-lg leading-none font-semibold",s),...e})}function l2({className:s,...e}){return t.jsx(PI,{"data-slot":"dialog-description",className:Bs("text-muted-foreground text-sm",s),...e})}function dW(s,e=[]){let r=[];function n(o,a){const l=S.createContext(a);l.displayName=o+"Context";const d=r.length;r=[...r,a];const p=h=>{const{scope:x,children:m,...b}=h,w=x?.[s]?.[d]||l,y=S.useMemo(()=>b,Object.values(b));return t.jsx(w.Provider,{value:y,children:m})};p.displayName=o+"Provider";function f(h,x){const m=x?.[s]?.[d]||l,b=S.useContext(m);if(b)return b;if(a!==void 0)return a;throw new Error(`\`${h}\` must be used within \`${o}\``)}return[p,f]}const i=()=>{const o=r.map(a=>S.createContext(a));return function(l){const d=l?.[s]||o;return S.useMemo(()=>({[`__scope${s}`]:{...l,[s]:d}}),[l,d])}};return i.scopeName=s,[n,uW(i,...e)]}function uW(...s){const e=s[0];if(s.length===1)return e;const r=()=>{const n=s.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const a=n.reduce((l,{useScope:d,scopeName:p})=>{const h=d(o)[`__scope${p}`];return{...l,...h}},{});return S.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}var pW=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],c2=pW.reduce((s,e)=>{const r=Gb(`Primitive.${e}`),n=S.forwardRef((i,o)=>{const{asChild:a,...l}=i,d=a?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(d,{...l,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{}),fv="Progress",gv=100,[hW]=dW(fv),[fW,gW]=hW(fv),d2=S.forwardRef((s,e)=>{const{__scopeProgress:r,value:n=null,max:i,getValueLabel:o=xW,...a}=s;(i||i===0)&&!pj(i)&&console.error(mW(`${i}`,"Progress"));const l=pj(i)?i:gv;n!==null&&!hj(n,l)&&console.error(yW(`${n}`,"Progress"));const d=hj(n,l)?n:null,p=Sg(d)?o(d,l):void 0;return t.jsx(fW,{scope:r,value:d,max:l,children:t.jsx(c2.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Sg(d)?d:void 0,"aria-valuetext":p,role:"progressbar","data-state":h2(d,l),"data-value":d??void 0,"data-max":l,...a,ref:e})})});d2.displayName=fv;var u2="ProgressIndicator",p2=S.forwardRef((s,e)=>{const{__scopeProgress:r,...n}=s,i=gW(u2,r);return t.jsx(c2.div,{"data-state":h2(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...n,ref:e})});p2.displayName=u2;function xW(s,e){return`${Math.round(s/e*100)}%`}function h2(s,e){return s==null?"indeterminate":s===e?"complete":"loading"}function Sg(s){return typeof s=="number"}function pj(s){return Sg(s)&&!isNaN(s)&&s>0}function hj(s,e){return Sg(s)&&!isNaN(s)&&s<=e&&s>=0}function mW(s,e){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${gv}\`.`}function yW(s,e){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${gv} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var bW=d2,vW=p2;function SW({className:s,value:e,...r}){return t.jsx(bW,{"data-slot":"progress",className:Bs("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...r,children:t.jsx(vW,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})})}const wW=ST("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function fj({className:s,variant:e,...r}){return t.jsx("div",{"data-slot":"alert",role:"alert",className:Bs(wW({variant:e}),s),...r})}function gj({className:s,...e}){return t.jsx("div",{"data-slot":"alert-title",className:Bs("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",s),...e})}function xj({className:s,...e}){return t.jsx("div",{"data-slot":"alert-description",className:Bs("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...e})}const EW={BASE_URL:"https://finceptbackend.share.zrok.io"},CW=s=>`${EW.BASE_URL}${s}`,_n=async(s,e,r,n,i)=>{try{const o={"Content-Type":"application/json",skip_zrok_interstitial:"1"};r&&(o["X-API-Key"]=r),n&&(o["X-Device-ID"]=n);const a=CW(e);console.log(" Forum API Request:",{method:s,url:a,endpoint:e,hasApiKey:!!r,hasDeviceId:!!n,data:i});const l={method:s,headers:o,mode:"cors"};i&&(s==="POST"||s==="PUT")&&(l.body=JSON.stringify(i));const d=await tn(a,l);console.log(" Forum Response:",{status:d.status,statusText:d.statusText,url:d.url});const p=await d.text();console.log(" Forum Response Text:",p.substring(0,200));let f;try{f=JSON.parse(p),console.log(" Forum Parsed JSON:",f)}catch(h){return console.error(" Forum JSON parse failed:",h),{success:!1,error:`Invalid JSON response: ${p.substring(0,100)}...`,status_code:d.status}}return{success:d.ok,data:f,status_code:d.status,error:d.ok?void 0:f.message||`HTTP ${d.status}`}}catch(o){return console.error(" Forum Request failed:",o),o instanceof TypeError&&o.message.includes("Failed to fetch")?{success:!1,error:"Network error: Unable to connect to server. Please check your internet connection or try again later."}:{success:!1,error:o instanceof Error?o.message:"Network error"}}};class Qs{static async getCategories(e,r){return _n("GET","/forum/categories",e,r)}static async getPostsByCategory(e,r="latest",n=20,i,o){return _n("GET",`/forum/categories/${e}/posts?sort_by=${r}&limit=${n}`,i,o)}static async getAllPosts(e="latest",r=20,n,i){return _n("GET",`/forum/posts?sort_by=${e}&limit=${r}`,n,i)}static async getPostDetails(e,r,n){return _n("GET",`/forum/posts/${e}`,r,n)}static async createPost(e,r,n,i){return _n("POST",`/forum/categories/${e}/posts`,n,i,{...r,category_id:e})}static async addComment(e,r,n,i){return _n("POST",`/forum/posts/${e}/comments`,n,i,r)}static async voteOnPost(e,r,n,i){return _n("POST",`/forum/posts/${e}/vote`,n,i,{vote_type:r})}static async voteOnComment(e,r,n,i){return _n("POST",`/forum/comments/${e}/vote`,n,i,{vote_type:r})}static async searchPosts(e,r="all",n=20,i,o){return _n("GET",`/forum/search?q=${encodeURIComponent(e)}&post_type=${r}&limit=${n}`,i,o)}static async getForumStats(e,r){return _n("GET","/forum/stats",e,r)}static async getUserPosts(e,r){return _n("GET","/forum/user/posts",e,r)}static async getUserActivity(e,r){return _n("GET","/forum/user/activity",e,r)}static async deletePost(e,r,n){return _n("DELETE",`/forum/posts/${e}`,r,n)}static async deleteComment(e,r,n){return _n("DELETE",`/forum/comments/${e}`,r,n)}static async editPost(e,r,n,i){return _n("PUT",`/forum/posts/${e}`,n,i,r)}static async editComment(e,r,n,i){return _n("PUT",`/forum/comments/${e}`,n,i,{content:r})}static async togglePostPin(e,r,n){return _n("POST",`/forum/posts/${e}/toggle-pin`,r,n)}static async getTrendingPosts(e=10,r="week",n,i){return _n("GET",`/forum/posts/trending?limit=${e}&timeframe=${r}`,n,i)}static async getUserProfile(e,r,n){return _n("GET",`/forum/profile/${e}`,r,n)}static async getMyProfile(e,r){return _n("GET","/forum/profile",e,r)}static async updateProfile(e,r,n){return _n("PUT","/forum/profile",r,n,e)}static async createCategory(e,r,n){return _n("POST","/forum/admin/categories",r,n,e)}static async getAdminStatistics(e,r){return _n("GET","/forum/admin/statistics",e,r)}}const jW=()=>{const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),{session:o}=Ao(),[a,l]=S.useState(new Date),[d,p]=S.useState("ALL"),[f,h]=S.useState("latest"),[x,m]=S.useState(1247),[b,w]=S.useState(!1),[y,C]=S.useState(null),[T,E]=S.useState(!1),j=S.useRef(null),[k,A]=S.useState(!1),[R,M]=S.useState(!1),[P,I]=S.useState(!1),[O,G]=S.useState(!1),[B,F]=S.useState(!1),[z,$]=S.useState(null),[W,D]=S.useState([]),[oe,Z]=S.useState(""),[fe,Q]=S.useState(""),[_,Y]=S.useState(""),[he,me]=S.useState(""),[ge,le]=S.useState(""),[X,V]=S.useState([]),[de,je]=S.useState(null),[_e,Re]=S.useState({display_name:"",bio:"",avatar_color:s.primary,signature:""}),[Be,Se]=S.useState([]),[ie,ve]=S.useState([]),[Ae,$e]=S.useState(null),[qe,Ie]=S.useState([]),[K,Ee]=S.useState([]),Oe=s.primary,q=s.text,ee=s.alert,ce=s.secondary,Ce=s.warning,be=s.textMuted,We=s.info,J=s.purple,se=s.accent,Te=s.background,Me=s.panel,Qe=[{username:"QuantTrader_Pro",reputation:8947,posts:1234,joined:"2021-03-15",status:"ONLINE"},{username:"CryptoWhale_2024",reputation:7823,posts:892,joined:"2020-11-22",status:"ONLINE"},{username:"OptionsFlow_Alert",reputation:7456,posts:1567,joined:"2022-01-08",status:"ONLINE"},{username:"MacroHedgeFund",reputation:6789,posts:743,joined:"2021-07-19",status:"OFFLINE"},{username:"TechInvestor88",reputation:6234,posts:654,joined:"2022-05-12",status:"ONLINE"},{username:"EnergyAnalyst_TX",reputation:5892,posts:521,joined:"2021-09-30",status:"ONLINE"}],ye=()=>{const Ve=o?.api_key||localStorage.getItem("fincept_api_key")||void 0,Ot=o?.device_id||localStorage.getItem("fincept_device_id")||void 0;return{apiKey:Ve,deviceId:Ot}},ue=Ve=>{const Ot=Ve.likes-Ve.dislikes,It=Ot>10?"BULLISH":Ot<-5?"BEARISH":"NEUTRAL",Dt=Ve.likes>300?"HOT":Ve.likes>150?"TRENDING":"NORMAL",or=(Ve.content.match(/#\w+/g)||[]).slice(0,5).map(rn=>rn.substring(1));return{id:Ve.post_uuid,time:new Date(Ve.created_at).toLocaleTimeString("en-US",{hour12:!1}),author:Ve.author_display_name||"Anonymous",title:Ve.title,content:Ve.content,category:Ve.category_name?.toUpperCase()||"GENERAL",categoryId:Ve.category_id,tags:or.length>0?or:["DISCUSSION"],views:Ve.views||0,replies:Ve.reply_count||0,likes:Ve.likes||0,dislikes:Ve.dislikes||0,sentiment:It,priority:Dt,verified:Ve.likes>100}},re=Ve=>({id:Ve.comment_uuid,author:Ve.author_display_name||"Anonymous",content:Ve.content,time:new Date(Ve.created_at).toLocaleTimeString("en-US",{hour12:!1}),likes:Ve.likes||0,dislikes:Ve.dislikes||0}),ke=async(Ve=!1)=>{try{if(!Ve){const Ct=await Je.getCachedForumCategories(5);if(Ct){console.log("[Forum] Loaded categories from cache"),Se(Ct);return}}const{apiKey:Ot,deviceId:It}=ye(),Dt=await Qs.getCategories(Ot,It);if(Dt.success&&Dt.data?.data?.categories){const Ct=Dt.data.data.categories,or=[We,J,se,Ce,ce,Oe,ee,J],rn=[{name:"ALL",count:Ct.reduce(($r,oi)=>$r+oi.post_count,0),color:q,id:0},...Ct.map(($r,oi)=>({name:$r.name.toUpperCase(),count:$r.post_count,color:or[oi%or.length],id:$r.id}))];Se(rn),await Je.cacheForumCategories(rn),console.log("[Forum] Cached categories")}}catch{console.debug("Forum API not available (categories)")}},Ne=async(Ve=!1)=>{w(!0);try{const Ot=d==="ALL"?null:Be.find(or=>or.name===d)?.id||null;if(!Ve){const or=await Je.getCachedForumPosts(Ot,f,5);if(or){console.log("[Forum] Loaded posts from cache"),ve(or),w(!1);return}}const{apiKey:It,deviceId:Dt}=ye();let Ct;if(d==="ALL")if(f==="popular")Ct=await Qs.getTrendingPosts(20,"week",It,Dt);else{const or=Be.find(rn=>rn.name!=="ALL")?.id||1;Ct=await Qs.getPostsByCategory(or,f,20,It,Dt)}else Ot&&(Ct=await Qs.getPostsByCategory(Ot,f,20,It,Dt));if(Ct?.success&&Ct.data?.data){const rn=(Ct.data.data.posts||[]).map(ue);ve(rn),await Je.cacheForumPosts(Ot,f,rn),console.log("[Forum] Cached posts")}}catch{console.debug("Forum API not available (posts)")}finally{w(!1)}},U=async(Ve=!1)=>{try{if(!Ve){const Ct=await Je.getCachedForumStats(5);if(Ct){console.log("[Forum] Loaded stats from cache"),$e(Ct),Ct.active_users&&m(Ct.active_users);return}}const{apiKey:Ot,deviceId:It}=ye(),Dt=await Qs.getForumStats(Ot,It);Dt.success&&Dt.data?.data&&($e(Dt.data.data),Dt.data.data.active_users&&m(Dt.data.data.active_users),await Je.cacheForumStats(Dt.data.data),console.log("[Forum] Cached stats"))}catch{console.debug("Forum API not available (stats)")}},ne=async()=>{if(!fe.trim()){alert("Please enter a post title");return}if(fe.trim().length<5){alert("Post title must be at least 5 characters long");return}if(fe.trim().length>500){alert("Post title must be less than 500 characters");return}if(!_.trim()){alert("Please enter post content");return}if(_.trim().length<10){alert("Post content must be at least 10 characters long");return}const{apiKey:Ve,deviceId:Ot}=ye();if(!Ve){alert("You must be logged in to create posts");return}const It=Be.find(Dt=>Dt.name===d)?.id||Be[1]?.id||1;try{const Dt=await Qs.createPost(It,{title:fe.trim(),content:_.trim()},Ve,Ot);Dt.success?(alert("Post created successfully!"),A(!1),Q(""),Y(""),Ne(!0)):alert(`Failed to create post: ${Dt.error||Dt.data?.message||"Unknown error"}`)}catch(Dt){console.error("Error creating post:",Dt),alert("Error creating post")}},xe=async Ve=>{$(Ve),M(!0);const{apiKey:Ot,deviceId:It}=ye();try{const Dt=await Qs.getPostDetails(Ve.id,Ot,It);if(Dt.success&&Dt.data?.data){const or=(Dt.data.data.comments||[]).map(re);D(or)}}catch{console.debug("Forum API not available (post details)")}},Le=async()=>{if(!he.trim()||!z)return;const{apiKey:Ve,deviceId:Ot}=ye();if(!Ve){alert("You must be logged in to comment");return}try{const It=await Qs.addComment(z.id,{content:he},Ve,Ot);It.success?(me(""),xe(z)):alert(`Failed to add comment: ${It.error||"Unknown error"}`)}catch(It){console.error("Error adding comment:",It),alert("Error adding comment")}},ze=async(Ve,Ot)=>{const{apiKey:It,deviceId:Dt}=ye();if(!It){alert("You must be logged in to vote");return}try{const Ct=await Qs.voteOnPost(Ve,Ot,It,Dt);Ct.success?(Ne(!0),z&&z.id===Ve&&xe(z)):alert(`Vote failed: ${Ct.error||"Unknown error"}`)}catch(Ct){console.error("Error voting on post:",Ct)}},Ge=async(Ve,Ot)=>{const{apiKey:It,deviceId:Dt}=ye();if(!It){alert("You must be logged in to vote");return}try{(await Qs.voteOnComment(Ve,Ot,It,Dt)).success&&z&&xe(z)}catch(Ct){console.error("Error voting on comment:",Ct)}},Ze=async()=>{if(!ge.trim())return;const{apiKey:Ve,deviceId:Ot}=ye();w(!0);try{const It=await Qs.searchPosts(ge,"all",20,Ve,Ot);if(It.success&&It.data?.data?.results?.posts){const Ct=It.data.data.results.posts.map(ue);V(Ct)}}catch(It){console.error("Error searching:",It)}finally{w(!1)}},xt=async()=>{const{apiKey:Ve,deviceId:Ot}=ye();if(!Ve){alert("You must be logged in to view profile");return}try{const It=await Qs.getMyProfile(Ve,Ot);if(It.success&&It.data?.data){const Dt=It.data.data;je(Dt),Re({display_name:Dt.display_name||"",bio:Dt.bio||"",avatar_color:Dt.avatar_color||s.primary,signature:Dt.signature||""}),G(!0)}}catch(It){console.error("Error fetching profile:",It),alert("Error loading profile")}},bt=async Ve=>{const{apiKey:Ot,deviceId:It}=ye();if(!Ot){alert("You must be logged in to view profiles");return}Z(Ve);try{const Dt=await Qs.getUserProfile(Ve,Ot,It);Dt.success&&Dt.data?.data&&(je(Dt.data.data),G(!0))}catch(Dt){console.error("Error fetching user profile:",Dt),alert("Error loading user profile")}},Lt=async()=>{const{apiKey:Ve,deviceId:Ot}=ye();if(Ve)try{const It=await Qs.updateProfile(_e,Ve,Ot);It.success?(alert("Profile updated successfully!"),F(!1),xt()):alert(`Failed to update profile: ${It.error||"Unknown error"}`)}catch(It){console.error("Error updating profile:",It),alert("Error updating profile")}},yt=()=>{const Ve={};ie.forEach(It=>{It.tags.forEach(Dt=>{const Ct=`#${Dt}`;Ve[Ct]||(Ve[Ct]={count:0,sentiment:"NEUTRAL"}),Ve[Ct].count+=1,It.sentiment==="BULLISH"&&(Ve[Ct].sentiment="BULLISH")})});const Ot=Object.entries(Ve).map(([It,Dt])=>({topic:It,mentions:Dt.count*100,sentiment:Dt.sentiment,change:`+${Math.floor(Math.random()*200+50)}%`})).sort((It,Dt)=>Dt.mentions-It.mentions).slice(0,6);Ie(Ot)},Pt=()=>{const Ve=ie.slice(0,5).map((Ot,It)=>({user:Ot.author,action:It%3===0?"posted":It%3===1?"replied to":"liked",target:Ot.title.substring(0,30)+"...",time:`${(It+1)*3} min ago`}));Ee(Ve)},Et=async()=>{if(!T){E(!0),console.log("[Forum] Manual refresh triggered");try{await Promise.all([ke(!0),U(!0),Ne(!0)]),C(new Date),console.log("[Forum] Manual refresh completed")}catch(Ve){console.error("[Forum] Refresh failed:",Ve)}finally{E(!1)}}};S.useEffect(()=>{ke(),U()},[]),S.useEffect(()=>{Be.length>0&&Ne()},[d,f,Be]),S.useEffect(()=>{ie.length>0&&(yt(),Pt())},[ie]),S.useEffect(()=>{const Ve=setInterval(()=>{l(new Date),m(Ot=>Math.max(1e3,Ot+Math.floor(Math.random()*10)-5))},5e3);return()=>clearInterval(Ve)},[]),S.useEffect(()=>{const Ve=setInterval(()=>{console.log("[Forum] Auto-refresh triggered (5 min interval)"),Et()},3e5);return j.current=Ve,()=>{j.current&&clearInterval(j.current)}},[]);const tt=Ve=>{switch(Ve){case"HOT":return ee;case"TRENDING":return Oe;case"NORMAL":return be;default:return be}},it=Ve=>{switch(Ve){case"BULLISH":return ce;case"BEARISH":return ee;case"NEUTRAL":return Ce;default:return be}},vt=d==="ALL"?ie:ie.filter(Ve=>Ve.category===d),rr=Ae?.total_posts||Be.find(Ve=>Ve.name==="ALL")?.count||0,Zt=Math.floor(rr*.003),mr=S.useMemo(()=>k?t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:Me,border:`2px solid ${Oe}`,padding:"16px",width:"600px",maxHeight:"80vh",overflow:"auto"},children:[t.jsx("div",{style:{color:Oe,fontSize:"14px",fontWeight:"bold",marginBottom:"12px"},children:"CREATE NEW POST"}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"12px"}}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{color:q,fontSize:"11px",marginBottom:"4px"},children:["Title: ",t.jsxs("span",{style:{color:fe.length<5?ee:ce},children:["(",fe.length,"/500 chars - min 5)"]})]}),t.jsx("input",{type:"text",value:fe,onChange:Ve=>Q(Ve.target.value),maxLength:500,style:{width:"100%",backgroundColor:Te,border:`1px solid ${fe.length>0&&fe.length<5?ee:be}`,color:q,padding:"6px",fontSize:"12px",fontFamily:"Consolas, monospace"},placeholder:"Enter post title (minimum 5 characters)..."})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{color:q,fontSize:"11px",marginBottom:"4px"},children:["Content: ",t.jsxs("span",{style:{color:_.length<10?ee:ce},children:["(",_.length,"/10000 chars - min 10)"]})]}),t.jsx("textarea",{value:_,onChange:Ve=>Y(Ve.target.value),maxLength:1e4,rows:10,style:{width:"100%",backgroundColor:Te,border:`1px solid ${_.length>0&&_.length<10?ee:be}`,color:q,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace",resize:"vertical"},placeholder:"Enter post content (minimum 10 characters)... Use #tags for topics"})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:()=>A(!1),style:{backgroundColor:be,color:Te,border:"none",padding:"6px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:ne,style:{backgroundColor:Oe,color:Te,border:"none",padding:"6px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"CREATE POST"})]})]})}):null,[k,fe,_,ne,Oe,be,Te,q,ee,ce,Me]),Cr=S.useMemo(()=>!R||!z?null:t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsx("div",{style:{backgroundColor:Me,border:`2px solid ${Oe}`,padding:"16px",width:"800px",maxHeight:"80vh",overflow:"auto"},children:z&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[t.jsx("div",{style:{color:Oe,fontSize:"14px",fontWeight:"bold"},children:"POST DETAILS"}),t.jsx("button",{onClick:()=>M(!1),style:{backgroundColor:"transparent",border:`1px solid ${be}`,color:q,padding:"2px 8px",fontSize:"10px",cursor:"pointer"},children:"CLOSE [X]"})]}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"12px"}}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center",marginBottom:"8px",fontSize:"10px"},children:[t.jsxs("span",{style:{color:se},children:["@",z.author]}),t.jsx("span",{style:{color:be},children:""}),t.jsxs("span",{style:{color:We},children:["[",z.category,"]"]}),t.jsx("span",{style:{color:it(z.sentiment)},children:z.sentiment})]}),t.jsx("div",{style:{color:q,fontSize:"13px",fontWeight:"bold",marginBottom:"8px"},children:z.title}),t.jsx("div",{style:{color:be,fontSize:"11px",lineHeight:"1.5",marginBottom:"8px",whiteSpace:"pre-wrap"},children:z.content}),t.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"10px",marginBottom:"8px"},children:[t.jsxs("button",{onClick:()=>ze(z.id,"up"),style:{backgroundColor:"transparent",border:`1px solid ${ce}`,color:ce,padding:"4px 12px",fontSize:"10px",cursor:"pointer"},children:[" UPVOTE (",z.likes,")"]}),t.jsxs("button",{onClick:()=>ze(z.id,"down"),style:{backgroundColor:"transparent",border:`1px solid ${ee}`,color:ee,padding:"4px 12px",fontSize:"10px",cursor:"pointer"},children:[" DOWNVOTE (",z.dislikes,")"]})]})]}),t.jsxs("div",{style:{borderTop:`1px solid ${be}`,paddingTop:"12px",marginBottom:"12px"},children:[t.jsxs("div",{style:{color:Ce,fontSize:"12px",fontWeight:"bold",marginBottom:"8px"},children:["COMMENTS (",W.length,")"]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("textarea",{value:he,onChange:Ve=>me(Ve.target.value),maxLength:2e3,rows:3,style:{width:"100%",backgroundColor:Te,border:`1px solid ${be}`,color:q,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace",marginBottom:"4px"},placeholder:"Add a comment..."}),t.jsx("button",{onClick:Le,style:{backgroundColor:Oe,color:Te,border:"none",padding:"4px 12px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"POST COMMENT"})]}),W.map((Ve,Ot)=>t.jsxs("div",{style:{backgroundColor:Ot%2===0?"rgba(255,255,255,0.02)":"transparent",padding:"8px",marginBottom:"6px",borderLeft:`2px solid ${We}`},children:[t.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center",marginBottom:"4px",fontSize:"9px"},children:[t.jsxs("span",{style:{color:se},children:["@",Ve.author]}),t.jsx("span",{style:{color:be},children:""}),t.jsx("span",{style:{color:be},children:Ve.time})]}),t.jsx("div",{style:{color:q,fontSize:"10px",marginBottom:"4px",whiteSpace:"pre-wrap"},children:Ve.content}),t.jsxs("div",{style:{display:"flex",gap:"8px",fontSize:"9px"},children:[t.jsxs("button",{onClick:()=>Ge(Ve.id,"up"),style:{backgroundColor:"transparent",border:"none",color:ce,cursor:"pointer",fontSize:"9px"},children:[" ",Ve.likes]}),t.jsxs("button",{onClick:()=>Ge(Ve.id,"down"),style:{backgroundColor:"transparent",border:"none",color:ee,cursor:"pointer",fontSize:"9px"},children:[" ",Ve.dislikes]})]})]},Ve.id))]})]})})}),[R,z,W,he,Le,ze,Ge,it,Oe,be,q,Te,Me,se,We,ce,ee,Ce]),ts=S.useMemo(()=>P?t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:Me,border:`2px solid ${Oe}`,padding:"16px",width:"700px",maxHeight:"80vh",overflow:"auto"},children:[t.jsx("div",{style:{color:Oe,fontSize:"14px",fontWeight:"bold",marginBottom:"12px"},children:"SEARCH FORUM"}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"12px"}}),t.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[t.jsx("input",{type:"text",value:ge,onChange:Ve=>le(Ve.target.value),onKeyPress:Ve=>Ve.key==="Enter"&&Ze(),style:{flex:1,backgroundColor:Te,border:`1px solid ${be}`,color:q,padding:"8px",fontSize:"12px",fontFamily:"Consolas, monospace"},placeholder:"Search posts and comments..."}),t.jsx("button",{onClick:Ze,style:{backgroundColor:Oe,color:Te,border:"none",padding:"8px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"SEARCH"}),t.jsx("button",{onClick:()=>{I(!1),V([]),le("")},style:{backgroundColor:be,color:Te,border:"none",padding:"8px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"CLOSE"})]}),b&&t.jsx("div",{style:{color:Ce,textAlign:"center",padding:"20px"},children:"SEARCHING..."}),X.length>0&&t.jsxs("div",{children:[t.jsxs("div",{style:{color:Ce,fontSize:"11px",marginBottom:"8px"},children:["FOUND ",X.length," RESULTS"]}),X.map((Ve,Ot)=>t.jsxs("div",{onClick:()=>{I(!1),xe(Ve)},style:{backgroundColor:Ot%2===0?"rgba(255,255,255,0.02)":"transparent",padding:"8px",marginBottom:"6px",borderLeft:`3px solid ${tt(Ve.priority)}`,cursor:"pointer"},children:[t.jsx("div",{style:{color:q,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:Ve.title}),t.jsxs("div",{style:{color:be,fontSize:"10px",marginBottom:"4px"},children:[Ve.content.substring(0,150),"..."]}),t.jsxs("div",{style:{display:"flex",gap:"8px",fontSize:"9px"},children:[t.jsxs("span",{style:{color:se},children:["@",Ve.author]}),t.jsxs("span",{style:{color:We},children:["[",Ve.category,"]"]}),t.jsxs("span",{style:{color:ce},children:[" ",Ve.likes]})]})]},Ve.id))]})]})}):null,[P,ge,X,b,Ze,xe,tt,Oe,be,Te,q,Me,Ce,se,We,ce]),As=S.useMemo(()=>!O||!de?null:t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsx("div",{style:{backgroundColor:Me,border:`2px solid ${Oe}`,padding:"16px",width:"600px",maxHeight:"80vh",overflow:"auto"},children:de&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"12px"},children:[t.jsx("div",{style:{color:Oe,fontSize:"14px",fontWeight:"bold"},children:"FORUM PROFILE"}),t.jsx("button",{onClick:()=>{G(!1),je(null)},style:{backgroundColor:"transparent",border:`1px solid ${be}`,color:q,padding:"2px 8px",fontSize:"10px",cursor:"pointer"},children:"CLOSE [X]"})]}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"12px"}}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{color:se,fontSize:"16px",fontWeight:"bold",marginBottom:"8px"},children:["@",de.username]}),t.jsx("div",{style:{color:q,fontSize:"12px",marginBottom:"4px"},children:de.display_name||"No display name set"}),t.jsx("div",{style:{color:be,fontSize:"11px",marginBottom:"12px",fontStyle:"italic"},children:de.bio||"No bio available"}),t.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"11px",marginBottom:"12px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:be},children:"Posts: "}),t.jsx("span",{style:{color:q},children:de.post_count||0})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:be},children:"Comments: "}),t.jsx("span",{style:{color:q},children:de.comment_count||0})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:be},children:"Reputation: "}),t.jsx("span",{style:{color:ce},children:de.reputation||0})]})]}),de.signature&&t.jsxs("div",{style:{backgroundColor:"rgba(255,255,255,0.02)",padding:"8px",marginBottom:"12px",borderLeft:`2px solid ${Ce}`},children:[t.jsx("div",{style:{color:Ce,fontSize:"10px",marginBottom:"4px"},children:"SIGNATURE:"}),t.jsx("div",{style:{color:be,fontSize:"10px",fontStyle:"italic"},children:de.signature})]}),!oe&&t.jsx("button",{onClick:()=>{G(!1),F(!0)},style:{backgroundColor:Oe,color:Te,border:"none",padding:"6px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"EDIT PROFILE"})]})]})})}),[O,de,oe,Oe,be,q,Te,Me,se,ce,Ce]),Fs=S.useMemo(()=>B?t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:Me,border:`2px solid ${Oe}`,padding:"16px",width:"600px",maxHeight:"80vh",overflow:"auto"},children:[t.jsx("div",{style:{color:Oe,fontSize:"14px",fontWeight:"bold",marginBottom:"12px"},children:"EDIT PROFILE"}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"12px"}}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:q,fontSize:"11px",marginBottom:"4px"},children:"Display Name:"}),t.jsx("input",{type:"text",value:_e.display_name,onChange:Ve=>Re({..._e,display_name:Ve.target.value}),style:{width:"100%",backgroundColor:Te,border:`1px solid ${be}`,color:q,padding:"6px",fontSize:"12px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:q,fontSize:"11px",marginBottom:"4px"},children:"Bio:"}),t.jsx("textarea",{value:_e.bio,onChange:Ve=>Re({..._e,bio:Ve.target.value}),rows:4,style:{width:"100%",backgroundColor:Te,border:`1px solid ${be}`,color:q,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:q,fontSize:"11px",marginBottom:"4px"},children:"Signature:"}),t.jsx("input",{type:"text",value:_e.signature,onChange:Ve=>Re({..._e,signature:Ve.target.value}),style:{width:"100%",backgroundColor:Te,border:`1px solid ${be}`,color:q,padding:"6px",fontSize:"12px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:()=>F(!1),style:{backgroundColor:be,color:Te,border:"none",padding:"6px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:Lt,style:{backgroundColor:Oe,color:Te,border:"none",padding:"6px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"SAVE CHANGES"})]})]})}):null,[B,_e,Lt,Oe,be,Te,q,Me]);return t.jsxs("div",{style:{height:"100%",backgroundColor:Te,color:q,fontFamily:"Consolas, monospace",overflow:"hidden",display:"flex",flexDirection:"column",fontSize:"12px"},children:[t.jsxs("div",{style:{backgroundColor:Me,borderBottom:`1px solid ${be}`,padding:"4px 8px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",marginBottom:"2px",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:Oe,fontWeight:"bold"},children:"FINCEPT GLOBAL FORUM"}),t.jsx("span",{style:{color:q},children:"|"}),t.jsx("span",{style:{color:ce},children:" LIVE"}),t.jsx("span",{style:{color:q},children:"|"}),t.jsxs("span",{style:{color:Ce},children:["USERS ONLINE: ",x.toLocaleString()]}),t.jsx("span",{style:{color:q},children:"|"}),t.jsxs("span",{style:{color:se},children:["POSTS TODAY: ",Zt.toLocaleString()]}),t.jsx("span",{style:{color:q},children:"|"}),t.jsxs("span",{style:{color:q},children:[a.toISOString().replace("T"," ").substring(0,19)," UTC"]})]}),t.jsx("button",{onClick:Et,disabled:T,style:{backgroundColor:T?be:Oe,color:Te,border:"none",padding:"2px 8px",fontSize:"10px",fontWeight:"bold",cursor:T?"not-allowed":"pointer",opacity:T?.6:1},title:y?`Last refreshed: ${y.toLocaleTimeString()}`:"Refresh forum data",children:T?" REFRESHING...":" REFRESH"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"11px"},children:[t.jsx("span",{style:{color:be},children:"TRENDING:"}),qe.slice(0,5).map((Ve,Ot)=>t.jsx("span",{style:{color:Ot%2===0?ee:Ot%3===0?se:J},children:Ve.topic.replace("#","").toUpperCase()},Ot)),t.jsx("span",{style:{color:q},children:"|"}),t.jsx("span",{style:{color:be},children:"SENTIMENT:"}),t.jsx("span",{style:{color:ce},children:"BULLISH 68%"}),t.jsx("span",{style:{color:ee},children:"BEARISH 18%"}),t.jsx("span",{style:{color:Ce},children:"NEUTRAL 14%"})]})]}),t.jsx("div",{style:{backgroundColor:Me,borderBottom:`1px solid ${be}`,padding:"2px 4px",flexShrink:0},children:t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"2px"},children:[{key:"F1",label:"ALL",action:()=>p("ALL")},{key:"F2",label:Be[1]?.name||"MARKETS",action:()=>p(Be[1]?.name||"MARKETS")},{key:"F3",label:Be[2]?.name||"TECH",action:()=>p(Be[2]?.name||"TECH")},{key:"F4",label:Be[3]?.name||"CRYPTO",action:()=>p(Be[3]?.name||"CRYPTO")},{key:"F5",label:Be[4]?.name||"OPTIONS",action:()=>p(Be[4]?.name||"OPTIONS")},{key:"F6",label:Be[5]?.name||"BANKING",action:()=>p(Be[5]?.name||"BANKING")},{key:"F7",label:Be[6]?.name||"ENERGY",action:()=>p(Be[6]?.name||"ENERGY")},{key:"F8",label:Be[7]?.name||"MACRO",action:()=>p(Be[7]?.name||"MACRO")},{key:"F9",label:"POST",action:()=>A(!0)},{key:"F10",label:"SEARCH",action:()=>I(!0)},{key:"F11",label:"PROFILE",action:()=>xt()},{key:"F12",label:"SETTINGS",action:()=>F(!0)}].map(Ve=>t.jsxs("button",{onClick:Ve.action,style:{backgroundColor:d===Ve.label?Oe:Te,border:`1px solid ${be}`,color:d===Ve.label?Te:q,padding:"2px 4px",fontSize:"9px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:d===Ve.label?"bold":"normal",cursor:"pointer"},children:[t.jsxs("span",{style:{color:Ce},children:[Ve.key,":"]}),t.jsx("span",{style:{marginLeft:"2px"},children:Ve.label})]},Ve.key))})}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"4px",backgroundColor:"#050505"},children:t.jsxs("div",{style:{display:"flex",gap:"4px",height:"100%"},children:[t.jsxs("div",{style:{width:"280px",backgroundColor:Me,border:`1px solid ${be}`,padding:"4px",overflow:"auto"},children:[t.jsx("div",{style:{color:Oe,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:"FORUM CATEGORIES"}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"4px"}}),Be.map((Ve,Ot)=>t.jsxs("button",{onClick:()=>p(Ve.name),style:{width:"100%",display:"flex",justifyContent:"space-between",padding:"4px",marginBottom:"2px",backgroundColor:d===Ve.name?"rgba(255,165,0,0.1)":"transparent",border:`1px solid ${d===Ve.name?Oe:"transparent"}`,color:Ve.color,fontSize:"10px",cursor:"pointer",textAlign:"left"},children:[t.jsx("span",{children:Ve.name}),t.jsx("span",{style:{color:se},children:Ve.count})]},Ot)),t.jsxs("div",{style:{borderTop:`1px solid ${be}`,marginTop:"8px",paddingTop:"8px"},children:[t.jsx("div",{style:{color:Ce,fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"TOP CONTRIBUTORS"}),Qe.map((Ve,Ot)=>t.jsxs("div",{onClick:()=>bt(Ve.username),style:{padding:"3px",marginBottom:"2px",backgroundColor:"rgba(255,255,255,0.02)",fontSize:"9px",cursor:"pointer"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:q},children:Ve.username}),t.jsx("span",{style:{color:Ve.status==="ONLINE"?ce:be},children:""})]}),t.jsxs("div",{style:{display:"flex",gap:"6px",color:be},children:[t.jsxs("span",{children:["REP: ",Ve.reputation]}),t.jsxs("span",{children:["POSTS: ",Ve.posts]})]})]},Ot))]}),t.jsxs("div",{style:{borderTop:`1px solid ${be}`,marginTop:"8px",paddingTop:"8px"},children:[t.jsx("div",{style:{color:Ce,fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"FORUM STATISTICS"}),t.jsxs("div",{style:{fontSize:"9px",lineHeight:"1.4",color:be},children:[t.jsxs("div",{children:["Total Posts: ",rr.toLocaleString()]}),t.jsxs("div",{children:["Total Users: ",(Ae?.total_comments||47832).toLocaleString()]}),t.jsxs("div",{children:["Posts Today: ",Zt.toLocaleString()]}),t.jsxs("div",{children:["Active Now: ",x]}),t.jsx("div",{style:{color:ce},children:"Avg Response: 12 min"})]})]})]}),t.jsxs("div",{style:{flex:1,backgroundColor:Me,border:`1px solid ${be}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsxs("div",{style:{color:Oe,fontSize:"11px",fontWeight:"bold"},children:["FORUM POSTS [",d,"]",b&&t.jsx("span",{style:{color:Ce,marginLeft:"8px"},children:"LOADING..."})]}),t.jsxs("div",{style:{display:"flex",gap:"4px",fontSize:"9px"},children:[t.jsx("button",{onClick:()=>h("latest"),style:{padding:"2px 6px",backgroundColor:f==="latest"?Oe:Te,color:f==="latest"?Te:q,border:`1px solid ${be}`,cursor:"pointer"},children:"LATEST"}),t.jsx("button",{onClick:()=>h("popular"),style:{padding:"2px 6px",backgroundColor:f==="popular"?Oe:Te,color:f==="popular"?Te:q,border:`1px solid ${be}`,cursor:"pointer"},children:"HOT"}),t.jsx("button",{onClick:()=>h("views"),style:{padding:"2px 6px",backgroundColor:f==="views"?Oe:Te,color:f==="views"?Te:q,border:`1px solid ${be}`,cursor:"pointer"},children:"TOP"})]})]}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"8px"}}),vt.length===0&&!b&&t.jsx("div",{style:{color:be,textAlign:"center",padding:"20px"},children:"No posts available. Be the first to post!"}),vt.map((Ve,Ot)=>t.jsxs("div",{style:{marginBottom:"6px",padding:"6px",backgroundColor:Ot%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`3px solid ${tt(Ve.priority)}`,paddingLeft:"6px",cursor:"pointer"},onClick:()=>xe(Ve),children:[t.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center",marginBottom:"2px",fontSize:"8px"},children:[t.jsx("span",{style:{color:be},children:Ve.time}),t.jsxs("span",{style:{color:tt(Ve.priority),fontWeight:"bold"},children:["[",Ve.priority,"]"]}),t.jsxs("span",{style:{color:We},children:["[",Ve.category,"]"]}),t.jsx("span",{style:{color:it(Ve.sentiment)},children:Ve.sentiment}),Ve.verified&&t.jsx("span",{style:{color:se},children:" VERIFIED"})]}),t.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center",marginBottom:"2px",fontSize:"9px"},children:[t.jsxs("span",{style:{color:se},children:["@",Ve.author]}),t.jsx("span",{style:{color:be},children:""}),t.jsx("span",{style:{color:q,fontWeight:"bold"},children:Ve.title})]}),t.jsxs("div",{style:{color:be,fontSize:"9px",lineHeight:"1.3",marginBottom:"3px"},children:[Ve.content.substring(0,200),Ve.content.length>200?"...":""]}),t.jsx("div",{style:{display:"flex",gap:"6px",fontSize:"8px",marginBottom:"2px"},children:Ve.tags.map((It,Dt)=>t.jsxs("span",{style:{color:Ce,backgroundColor:"rgba(255,255,0,0.1)",padding:"1px 4px",borderRadius:"2px"},children:["#",It]},Dt))}),t.jsxs("div",{style:{display:"flex",gap:"10px",fontSize:"8px"},children:[t.jsxs("span",{style:{color:se},children:[" ",Ve.views.toLocaleString()]}),t.jsxs("span",{style:{color:J},children:[" ",Ve.replies]}),t.jsxs("span",{style:{color:ce},children:[" ",Ve.likes]}),t.jsxs("span",{style:{color:ee},children:[" ",Ve.dislikes]})]})]},Ve.id))]}),t.jsxs("div",{style:{width:"280px",backgroundColor:Me,border:`1px solid ${be}`,padding:"4px",overflow:"auto"},children:[t.jsx("div",{style:{color:Oe,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:"TRENDING TOPICS (1H)"}),t.jsx("div",{style:{borderBottom:`1px solid ${be}`,marginBottom:"8px"}}),qe.map((Ve,Ot)=>t.jsxs("div",{style:{padding:"3px",marginBottom:"3px",backgroundColor:"rgba(255,255,255,0.02)",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:Ce},children:Ve.topic}),t.jsx("span",{style:{color:ce},children:Ve.change})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:be},children:[t.jsxs("span",{children:[Ve.mentions," mentions"]}),t.jsx("span",{style:{color:it(Ve.sentiment)},children:Ve.sentiment})]})]},Ot)),t.jsxs("div",{style:{borderTop:`1px solid ${be}`,marginTop:"12px",paddingTop:"8px"},children:[t.jsx("div",{style:{color:Ce,fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"RECENT ACTIVITY"}),K.map((Ve,Ot)=>t.jsxs("div",{style:{padding:"2px",marginBottom:"2px",fontSize:"8px",color:be,lineHeight:"1.3"},children:[t.jsxs("span",{style:{color:se},children:["@",Ve.user]})," ",t.jsx("span",{children:Ve.action})," ",t.jsx("span",{style:{color:q},children:Ve.target})," ",t.jsxs("span",{style:{color:Ce},children:[" ",Ve.time]})]},Ot))]}),t.jsxs("div",{style:{borderTop:`1px solid ${be}`,marginTop:"12px",paddingTop:"8px"},children:[t.jsx("div",{style:{color:Ce,fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"SENTIMENT ANALYSIS"}),t.jsxs("div",{style:{fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:be},children:"Bullish Posts:"}),t.jsx("span",{style:{color:ce},children:"68%"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:be},children:"Bearish Posts:"}),t.jsx("span",{style:{color:ee},children:"18%"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:be},children:"Neutral Posts:"}),t.jsx("span",{style:{color:Ce},children:"14%"})]}),t.jsxs("div",{style:{borderTop:`1px solid ${be}`,marginTop:"4px",paddingTop:"4px"},children:[t.jsx("span",{style:{color:se},children:"Overall Sentiment:"}),t.jsx("span",{style:{color:ce,fontWeight:"bold",marginLeft:"4px"},children:"+0.62 BULLISH"})]})]})]})]})]})}),t.jsx("div",{style:{borderTop:`1px solid ${be}`,backgroundColor:Me,padding:"2px 8px",fontSize:"10px",color:be,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsx("span",{children:"Fincept Global Forum v2.4.1 | Professional trading community"}),t.jsxs("span",{children:["Posts: ",rr.toLocaleString()," | Users: ",(Ae?.total_comments||47832).toLocaleString()," | Active: ",x]})]}),t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsxs("span",{children:["Category: ",d]}),t.jsxs("span",{children:["Sort: ",f]}),t.jsx("span",{style:{color:ce},children:"STATUS: LIVE"})]})]})}),mr,Cr,ts,As,Fs]})};var n0={exports:{}},Qu={},wf={},mj;function xv(){return mj||(mj=1,(function(s){(function(e,r){typeof window<"u"?r(s):(e=typeof globalThis<"u"?globalThis:e||self,r(e["fast-equals"]={}))})(wf,(function(e){function r(ge){return function(X,V,de,je,_e,Re,Be){return ge(X,V,Be)}}function n(ge){return function(X,V,de,je){if(!X||!V||typeof X!="object"||typeof V!="object")return ge(X,V,de,je);var _e=je.get(X),Re=je.get(V);if(_e&&Re)return _e===V&&Re===X;je.set(X,V),je.set(V,X);var Be=ge(X,V,de,je);return je.delete(X),je.delete(V),Be}}function i(ge,le){var X={};for(var V in ge)X[V]=ge[V];for(var V in le)X[V]=le[V];return X}function o(ge){return ge.constructor===Object||ge.constructor==null}function a(ge){return typeof ge.then=="function"}function l(ge,le){return ge===le||ge!==ge&&le!==le}var d="[object Arguments]",p="[object Boolean]",f="[object Date]",h="[object RegExp]",x="[object Map]",m="[object Number]",b="[object Object]",w="[object Set]",y="[object String]",C=Object.prototype.toString;function T(ge){var le=ge.areArraysEqual,X=ge.areDatesEqual,V=ge.areMapsEqual,de=ge.areObjectsEqual,je=ge.areRegExpsEqual,_e=ge.areSetsEqual,Re=ge.createIsNestedEqual,Be=Re(Se);function Se(ie,ve,Ae){if(ie===ve)return!0;if(!ie||!ve||typeof ie!="object"||typeof ve!="object")return ie!==ie&&ve!==ve;if(o(ie)&&o(ve))return de(ie,ve,Be,Ae);var $e=Array.isArray(ie),qe=Array.isArray(ve);if($e||qe)return $e===qe&&le(ie,ve,Be,Ae);var Ie=C.call(ie);return Ie!==C.call(ve)?!1:Ie===f?X(ie,ve,Be,Ae):Ie===h?je(ie,ve,Be,Ae):Ie===x?V(ie,ve,Be,Ae):Ie===w?_e(ie,ve,Be,Ae):Ie===b||Ie===d?a(ie)||a(ve)?!1:de(ie,ve,Be,Ae):Ie===p||Ie===m||Ie===y?l(ie.valueOf(),ve.valueOf()):!1}return Se}function E(ge,le,X,V){var de=ge.length;if(le.length!==de)return!1;for(;de-- >0;)if(!X(ge[de],le[de],de,de,ge,le,V))return!1;return!0}var j=n(E);function k(ge,le){return l(ge.valueOf(),le.valueOf())}function A(ge,le,X,V){var de=ge.size===le.size;if(!de)return!1;if(!ge.size)return!0;var je={},_e=0;return ge.forEach(function(Re,Be){if(de){var Se=!1,ie=0;le.forEach(function(ve,Ae){!Se&&!je[ie]&&(Se=X(Be,Ae,_e,ie,ge,le,V)&&X(Re,ve,Be,Ae,ge,le,V))&&(je[ie]=!0),ie++}),_e++,de=Se}}),de}var R=n(A),M="_owner",P=Object.prototype.hasOwnProperty;function I(ge,le,X,V){var de=Object.keys(ge),je=de.length;if(Object.keys(le).length!==je)return!1;for(var _e;je-- >0;){if(_e=de[je],_e===M){var Re=!!ge.$$typeof,Be=!!le.$$typeof;if((Re||Be)&&Re!==Be)return!1}if(!P.call(le,_e)||!X(ge[_e],le[_e],_e,_e,ge,le,V))return!1}return!0}var O=n(I);function G(ge,le){return ge.source===le.source&&ge.flags===le.flags}function B(ge,le,X,V){var de=ge.size===le.size;if(!de)return!1;if(!ge.size)return!0;var je={};return ge.forEach(function(_e,Re){if(de){var Be=!1,Se=0;le.forEach(function(ie,ve){!Be&&!je[Se]&&(Be=X(_e,ie,Re,ve,ge,le,V))&&(je[Se]=!0),Se++}),de=Be}}),de}var F=n(B),z=Object.freeze({areArraysEqual:E,areDatesEqual:k,areMapsEqual:A,areObjectsEqual:I,areRegExpsEqual:G,areSetsEqual:B,createIsNestedEqual:r}),$=Object.freeze({areArraysEqual:j,areDatesEqual:k,areMapsEqual:R,areObjectsEqual:O,areRegExpsEqual:G,areSetsEqual:F,createIsNestedEqual:r}),W=T(z);function D(ge,le){return W(ge,le,void 0)}var oe=T(i(z,{createIsNestedEqual:function(){return l}}));function Z(ge,le){return oe(ge,le,void 0)}var fe=T($);function Q(ge,le){return fe(ge,le,new WeakMap)}var _=T(i($,{createIsNestedEqual:function(){return l}}));function Y(ge,le){return _(ge,le,new WeakMap)}function he(ge){return T(i(z,ge(z)))}function me(ge){var le=T(i($,ge($)));return(function(X,V,de){return de===void 0&&(de=new WeakMap),le(X,V,de)})}e.circularDeepEqual=Q,e.circularShallowEqual=Y,e.createCustomCircularEqual=me,e.createCustomEqual=he,e.deepEqual=D,e.sameValueZeroEqual=l,e.shallowEqual=Z,Object.defineProperty(e,"__esModule",{value:!0})}))})(wf)),wf}var Ef={exports:{}},yj;function ax(){if(yj)return Ef.exports;yj=1;function s(r){var n,i,o="";if(typeof r=="string"||typeof r=="number")o+=r;else if(typeof r=="object")if(Array.isArray(r)){var a=r.length;for(n=0;n<a;n++)r[n]&&(i=s(r[n]))&&(o&&(o+=" "),o+=i)}else for(i in r)r[i]&&(o&&(o+=" "),o+=i);return o}function e(){for(var r,n,i=0,o="",a=arguments.length;i<a;i++)(r=arguments[i])&&(n=s(r))&&(o&&(o+=" "),o+=n);return o}return Ef.exports=e,Ef.exports.clsx=e,Ef.exports}var Lr={},s0,bj;function kW(){return bj||(bj=1,s0=function(e,r,n){return e===r?!0:e.className===r.className&&n(e.style,r.style)&&e.width===r.width&&e.autoSize===r.autoSize&&e.cols===r.cols&&e.draggableCancel===r.draggableCancel&&e.draggableHandle===r.draggableHandle&&n(e.verticalCompact,r.verticalCompact)&&n(e.compactType,r.compactType)&&n(e.layout,r.layout)&&n(e.margin,r.margin)&&n(e.containerPadding,r.containerPadding)&&e.rowHeight===r.rowHeight&&e.maxRows===r.maxRows&&e.isBounded===r.isBounded&&e.isDraggable===r.isDraggable&&e.isResizable===r.isResizable&&e.allowOverlap===r.allowOverlap&&e.preventCollision===r.preventCollision&&e.useCSSTransforms===r.useCSSTransforms&&e.transformScale===r.transformScale&&e.isDroppable===r.isDroppable&&n(e.resizeHandles,r.resizeHandles)&&n(e.resizeHandle,r.resizeHandle)&&e.onLayoutChange===r.onLayoutChange&&e.onDragStart===r.onDragStart&&e.onDrag===r.onDrag&&e.onDragStop===r.onDragStop&&e.onResizeStart===r.onResizeStart&&e.onResize===r.onResize&&e.onResizeStop===r.onResizeStop&&e.onDrop===r.onDrop&&n(e.droppingItem,r.droppingItem)&&n(e.innerRef,r.innerRef)}),s0}var vj;function Yd(){if(vj)return Lr;vj=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.bottom=d,Lr.childrenEqual=m,Lr.cloneLayout=p,Lr.cloneLayoutItem=x,Lr.collides=w,Lr.compact=y,Lr.compactItem=E,Lr.compactType=_e,Lr.correctBounds=j,Lr.fastPositionEqual=b,Lr.fastRGLPropsEqual=void 0,Lr.getAllCollisions=R,Lr.getFirstCollision=A,Lr.getLayoutItem=k,Lr.getStatics=M,Lr.modifyLayout=f,Lr.moveElement=P,Lr.moveElementAwayFromCollision=I,Lr.noop=void 0,Lr.perc=O,Lr.resizeItemInDirection=he,Lr.setTopLeft=ge,Lr.setTransform=me,Lr.sortLayoutItems=le,Lr.sortLayoutItemsByColRow=V,Lr.sortLayoutItemsByRowCol=X,Lr.synchronizeLayoutWithChildren=de,Lr.validateLayout=je,Lr.withLayoutItem=h;var s=xv(),e=r(po());function r(Se){return Se&&Se.__esModule?Se:{default:Se}}function n(Se,ie){var ve=Object.keys(Se);if(Object.getOwnPropertySymbols){var Ae=Object.getOwnPropertySymbols(Se);ie&&(Ae=Ae.filter(function($e){return Object.getOwnPropertyDescriptor(Se,$e).enumerable})),ve.push.apply(ve,Ae)}return ve}function i(Se){for(var ie=1;ie<arguments.length;ie++){var ve=arguments[ie]!=null?arguments[ie]:{};ie%2?n(Object(ve),!0).forEach(function(Ae){o(Se,Ae,ve[Ae])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Se,Object.getOwnPropertyDescriptors(ve)):n(Object(ve)).forEach(function(Ae){Object.defineProperty(Se,Ae,Object.getOwnPropertyDescriptor(ve,Ae))})}return Se}function o(Se,ie,ve){return(ie=a(ie))in Se?Object.defineProperty(Se,ie,{value:ve,enumerable:!0,configurable:!0,writable:!0}):Se[ie]=ve,Se}function a(Se){var ie=l(Se,"string");return typeof ie=="symbol"?ie:ie+""}function l(Se,ie){if(typeof Se!="object"||!Se)return Se;var ve=Se[Symbol.toPrimitive];if(ve!==void 0){var Ae=ve.call(Se,ie);if(typeof Ae!="object")return Ae;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ie==="string"?String:Number)(Se)}function d(Se){let ie=0,ve;for(let Ae=0,$e=Se.length;Ae<$e;Ae++)ve=Se[Ae].y+Se[Ae].h,ve>ie&&(ie=ve);return ie}function p(Se){const ie=Array(Se.length);for(let ve=0,Ae=Se.length;ve<Ae;ve++)ie[ve]=x(Se[ve]);return ie}function f(Se,ie){const ve=Array(Se.length);for(let Ae=0,$e=Se.length;Ae<$e;Ae++)ie.i===Se[Ae].i?ve[Ae]=ie:ve[Ae]=Se[Ae];return ve}function h(Se,ie,ve){let Ae=k(Se,ie);return Ae?(Ae=ve(x(Ae)),Se=f(Se,Ae),[Se,Ae]):[Se,null]}function x(Se){return{w:Se.w,h:Se.h,x:Se.x,y:Se.y,i:Se.i,minW:Se.minW,maxW:Se.maxW,minH:Se.minH,maxH:Se.maxH,moved:!!Se.moved,static:!!Se.static,isDraggable:Se.isDraggable,isResizable:Se.isResizable,resizeHandles:Se.resizeHandles,isBounded:Se.isBounded}}function m(Se,ie){return(0,s.deepEqual)(e.default.Children.map(Se,ve=>ve?.key),e.default.Children.map(ie,ve=>ve?.key))&&(0,s.deepEqual)(e.default.Children.map(Se,ve=>ve?.props["data-grid"]),e.default.Children.map(ie,ve=>ve?.props["data-grid"]))}Lr.fastRGLPropsEqual=kW();function b(Se,ie){return Se.left===ie.left&&Se.top===ie.top&&Se.width===ie.width&&Se.height===ie.height}function w(Se,ie){return!(Se.i===ie.i||Se.x+Se.w<=ie.x||Se.x>=ie.x+ie.w||Se.y+Se.h<=ie.y||Se.y>=ie.y+ie.h)}function y(Se,ie,ve,Ae){const $e=M(Se);let qe=d($e);const Ie=le(Se,ie),K=Array(Se.length);for(let Ee=0,Oe=Ie.length;Ee<Oe;Ee++){let q=x(Ie[Ee]);q.static||(q=E($e,q,ie,ve,Ie,Ae,qe),qe=Math.max(qe,q.y+q.h),$e.push(q)),K[Se.indexOf(Ie[Ee])]=q,q.moved=!1}return K}const C={x:"w",y:"h"};function T(Se,ie,ve,Ae){const $e=C[Ae];ie[Ae]+=1;const qe=Se.map(Ie=>Ie.i).indexOf(ie.i);for(let Ie=qe+1;Ie<Se.length;Ie++){const K=Se[Ie];if(!K.static){if(K.y>ie.y+ie.h)break;w(ie,K)&&T(Se,K,ve+ie[$e],Ae)}}ie[Ae]=ve}function E(Se,ie,ve,Ae,$e,qe,Ie){const K=ve==="vertical",Ee=ve==="horizontal";if(K)for(typeof Ie=="number"?ie.y=Math.min(Ie,ie.y):ie.y=Math.min(d(Se),ie.y);ie.y>0&&!A(Se,ie);)ie.y--;else if(Ee)for(;ie.x>0&&!A(Se,ie);)ie.x--;let Oe;for(;(Oe=A(Se,ie))&&!(ve===null&&qe);)if(Ee?T($e,ie,Oe.x+Oe.w,"x"):T($e,ie,Oe.y+Oe.h,"y"),Ee&&ie.x+ie.w>Ae)for(ie.x=Ae-ie.w,ie.y++;ie.x>0&&!A(Se,ie);)ie.x--;return ie.y=Math.max(ie.y,0),ie.x=Math.max(ie.x,0),ie}function j(Se,ie){const ve=M(Se);for(let Ae=0,$e=Se.length;Ae<$e;Ae++){const qe=Se[Ae];if(qe.x+qe.w>ie.cols&&(qe.x=ie.cols-qe.w),qe.x<0&&(qe.x=0,qe.w=ie.cols),!qe.static)ve.push(qe);else for(;A(ve,qe);)qe.y++}return Se}function k(Se,ie){for(let ve=0,Ae=Se.length;ve<Ae;ve++)if(Se[ve].i===ie)return Se[ve]}function A(Se,ie){for(let ve=0,Ae=Se.length;ve<Ae;ve++)if(w(Se[ve],ie))return Se[ve]}function R(Se,ie){return Se.filter(ve=>w(ve,ie))}function M(Se){return Se.filter(ie=>ie.static)}function P(Se,ie,ve,Ae,$e,qe,Ie,K,Ee){if(ie.static&&ie.isDraggable!==!0||ie.y===Ae&&ie.x===ve)return Se;"Moving element ".concat(ie.i," to [").concat(String(ve),",").concat(String(Ae),"] from [").concat(ie.x,",").concat(ie.y,"]");const Oe=ie.x,q=ie.y;typeof ve=="number"&&(ie.x=ve),typeof Ae=="number"&&(ie.y=Ae),ie.moved=!0;let ee=le(Se,Ie);(Ie==="vertical"&&typeof Ae=="number"?q>=Ae:Ie==="horizontal"&&typeof ve=="number"&&Oe>=ve)&&(ee=ee.reverse());const Ce=R(ee,ie),be=Ce.length>0;if(be&&Ee)return p(Se);if(be&&qe)return"Collision prevented on ".concat(ie.i,", reverting."),ie.x=Oe,ie.y=q,ie.moved=!1,Se;for(let We=0,J=Ce.length;We<J;We++){const se=Ce[We];"Resolving collision between ".concat(ie.i," at [").concat(ie.x,",").concat(ie.y,"] and ").concat(se.i," at [").concat(se.x,",").concat(se.y,"]"),!se.moved&&(se.static?Se=I(Se,se,ie,$e,Ie):Se=I(Se,ie,se,$e,Ie))}return Se}function I(Se,ie,ve,Ae,$e,qe){const Ie=$e==="horizontal",K=$e==="vertical",Ee=ie.static;if(Ae){Ae=!1;const ee={x:Ie?Math.max(ie.x-ve.w,0):ve.x,y:K?Math.max(ie.y-ve.h,0):ve.y,w:ve.w,h:ve.h,i:"-1"},ce=A(Se,ee),Ce=ce&&ce.y+ce.h>ie.y,be=ce&&ie.x+ie.w>ce.x;if(ce){if(Ce&&K)return P(Se,ve,void 0,ve.y+1,Ae,Ee,$e);if(Ce&&$e==null)return ie.y=ve.y,ve.y=ve.y+ve.h,Se;if(be&&Ie)return P(Se,ie,ve.x,void 0,Ae,Ee,$e)}else return"Doing reverse collision on ".concat(ve.i," up to [").concat(ee.x,",").concat(ee.y,"]."),P(Se,ve,Ie?ee.x:void 0,K?ee.y:void 0,Ae,Ee,$e)}const Oe=Ie?ve.x+1:void 0,q=K?ve.y+1:void 0;return Oe==null&&q==null?Se:P(Se,ve,Ie?ve.x+1:void 0,K?ve.y+1:void 0,Ae,Ee,$e)}function O(Se){return Se*100+"%"}const G=(Se,ie,ve,Ae)=>Se+ve>Ae?ie:ve,B=(Se,ie,ve)=>Se<0?ie:ve,F=Se=>Math.max(0,Se),z=Se=>Math.max(0,Se),$=(Se,ie,ve)=>{let{left:Ae,height:$e,width:qe}=ie;const Ie=Se.top-($e-Se.height);return{left:Ae,width:qe,height:B(Ie,Se.height,$e),top:z(Ie)}},W=(Se,ie,ve)=>{let{top:Ae,left:$e,height:qe,width:Ie}=ie;return{top:Ae,height:qe,width:G(Se.left,Se.width,Ie,ve),left:F($e)}},D=(Se,ie,ve)=>{let{top:Ae,height:$e,width:qe}=ie;const Ie=Se.left-(qe-Se.width);return{height:$e,width:Ie<0?Se.width:G(Se.left,Se.width,qe,ve),top:z(Ae),left:F(Ie)}},oe=(Se,ie,ve)=>{let{top:Ae,left:$e,height:qe,width:Ie}=ie;return{width:Ie,left:$e,height:B(Ae,Se.height,qe),top:z(Ae)}},Y={n:$,ne:function(){return $(arguments.length<=0?void 0:arguments[0],W(...arguments))},e:W,se:function(){return oe(arguments.length<=0?void 0:arguments[0],W(...arguments))},s:oe,sw:function(){return oe(arguments.length<=0?void 0:arguments[0],D(...arguments))},w:D,nw:function(){return $(arguments.length<=0?void 0:arguments[0],D(...arguments))}};function he(Se,ie,ve,Ae){const $e=Y[Se];return $e?$e(ie,i(i({},ie),ve),Ae):ve}function me(Se){let{top:ie,left:ve,width:Ae,height:$e}=Se;const qe="translate(".concat(ve,"px,").concat(ie,"px)");return{transform:qe,WebkitTransform:qe,MozTransform:qe,msTransform:qe,OTransform:qe,width:"".concat(Ae,"px"),height:"".concat($e,"px"),position:"absolute"}}function ge(Se){let{top:ie,left:ve,width:Ae,height:$e}=Se;return{top:"".concat(ie,"px"),left:"".concat(ve,"px"),width:"".concat(Ae,"px"),height:"".concat($e,"px"),position:"absolute"}}function le(Se,ie){return ie==="horizontal"?V(Se):ie==="vertical"?X(Se):Se}function X(Se){return Se.slice(0).sort(function(ie,ve){return ie.y>ve.y||ie.y===ve.y&&ie.x>ve.x?1:ie.y===ve.y&&ie.x===ve.x?0:-1})}function V(Se){return Se.slice(0).sort(function(ie,ve){return ie.x>ve.x||ie.x===ve.x&&ie.y>ve.y?1:-1})}function de(Se,ie,ve,Ae,$e){Se=Se||[];const qe=[];e.default.Children.forEach(ie,K=>{if(K?.key==null)return;const Ee=k(Se,String(K.key)),Oe=K.props["data-grid"];Ee&&Oe==null?qe.push(x(Ee)):Oe?qe.push(x(i(i({},Oe),{},{i:K.key}))):qe.push(x({w:1,h:1,x:0,y:d(qe),i:String(K.key)}))});const Ie=j(qe,{cols:ve});return $e?Ie:y(Ie,Ae,ve)}function je(Se){let ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout";const ve=["x","y","w","h"];if(!Array.isArray(Se))throw new Error(ie+" must be an array!");for(let Ae=0,$e=Se.length;Ae<$e;Ae++){const qe=Se[Ae];for(let Ie=0;Ie<ve.length;Ie++){const K=ve[Ie],Ee=qe[K];if(typeof Ee!="number"||Number.isNaN(Ee))throw new Error("ReactGridLayout: ".concat(ie,"[").concat(Ae,"].").concat(K," must be a number! Received: ").concat(Ee," (").concat(typeof Ee,")"))}if(typeof qe.i<"u"&&typeof qe.i!="string")throw new Error("ReactGridLayout: ".concat(ie,"[").concat(Ae,"].i must be a string! Received: ").concat(qe.i," (").concat(typeof qe.i,")"))}}function _e(Se){const{verticalCompact:ie,compactType:ve}=Se||{};return ie===!1?null:ve}function Re(){}const Be=()=>{};return Lr.noop=Be,Lr}var xa={},Sj;function mv(){if(Sj)return xa;Sj=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.calcGridColWidth=s,xa.calcGridItemPosition=r,xa.calcGridItemWHPx=e,xa.calcWH=i,xa.calcXY=n,xa.clamp=o;function s(a){const{margin:l,containerPadding:d,containerWidth:p,cols:f}=a;return(p-l[0]*(f-1)-d[0]*2)/f}function e(a,l,d){return Number.isFinite(a)?Math.round(l*a+Math.max(0,a-1)*d):a}function r(a,l,d,p,f,h){const{margin:x,containerPadding:m,rowHeight:b}=a,w=s(a),y={};return h&&h.resizing?(y.width=Math.round(h.resizing.width),y.height=Math.round(h.resizing.height)):(y.width=e(p,w,x[0]),y.height=e(f,b,x[1])),h&&h.dragging?(y.top=Math.round(h.dragging.top),y.left=Math.round(h.dragging.left)):h&&h.resizing&&typeof h.resizing.top=="number"&&typeof h.resizing.left=="number"?(y.top=Math.round(h.resizing.top),y.left=Math.round(h.resizing.left)):(y.top=Math.round((b+x[1])*d+m[1]),y.left=Math.round((w+x[0])*l+m[0])),y}function n(a,l,d,p,f){const{margin:h,containerPadding:x,cols:m,rowHeight:b,maxRows:w}=a,y=s(a);let C=Math.round((d-x[0])/(y+h[0])),T=Math.round((l-x[1])/(b+h[1]));return C=o(C,0,m-p),T=o(T,0,w-f),{x:C,y:T}}function i(a,l,d,p,f,h){const{margin:x,maxRows:m,cols:b,rowHeight:w}=a,y=s(a);let C=Math.round((l+x[0])/(y+x[0])),T=Math.round((d+x[1])/(w+x[1])),E=o(C,0,b-p),j=o(T,0,m-f);return["sw","w","nw"].indexOf(h)!==-1&&(E=o(C,0,b)),["nw","n","ne"].indexOf(h)!==-1&&(j=o(T,0,m)),{w:E,h:j}}function o(a,l,d){return Math.max(Math.min(a,d),l)}return xa}var Zu={},ep={exports:{}},i0={},Jn={},Za={},wj;function lx(){if(wj)return Za;wj=1,Object.defineProperty(Za,"__esModule",{value:!0}),Za.dontSetMe=i,Za.findInArray=s,Za.int=n,Za.isFunction=e,Za.isNum=r;function s(o,a){for(let l=0,d=o.length;l<d;l++)if(a.apply(a,[o[l],l,o]))return o[l]}function e(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Function]"}function r(o){return typeof o=="number"&&!isNaN(o)}function n(o){return parseInt(o,10)}function i(o,a,l){if(o[a])return new Error(`Invalid prop ${a} passed to ${l} - do not set this, set it on the child.`)}return Za}var el={},Ej;function AW(){if(Ej)return el;Ej=1,Object.defineProperty(el,"__esModule",{value:!0}),el.browserPrefixToKey=r,el.browserPrefixToStyle=n,el.default=void 0,el.getPrefix=e;const s=["Moz","Webkit","O","ms"];function e(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const a=window.document?.documentElement?.style;if(!a||o in a)return"";for(let l=0;l<s.length;l++)if(r(o,s[l])in a)return s[l];return""}function r(o,a){return a?`${a}${i(o)}`:o}function n(o,a){return a?`-${a.toLowerCase()}-${o}`:o}function i(o){let a="",l=!0;for(let d=0;d<o.length;d++)l?(a+=o[d].toUpperCase(),l=!1):o[d]==="-"?l=!0:a+=o[d];return a}return el.default=e(),el}var Cj;function yv(){if(Cj)return Jn;Cj=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.addClassName=k,Jn.addEvent=a,Jn.addUserSelectStyles=T,Jn.createCSSTransform=m,Jn.createSVGTransform=b,Jn.getTouch=y,Jn.getTouchIdentifier=C,Jn.getTranslation=w,Jn.innerHeight=f,Jn.innerWidth=h,Jn.matchesSelector=i,Jn.matchesSelectorAndParentsTo=o,Jn.offsetXYFromParent=x,Jn.outerHeight=d,Jn.outerWidth=p,Jn.removeClassName=A,Jn.removeEvent=l,Jn.scheduleRemoveUserSelectStyles=E;var s=lx(),e=r(AW());function r(R,M){if(typeof WeakMap=="function")var P=new WeakMap,I=new WeakMap;return(r=function(O,G){if(!G&&O&&O.__esModule)return O;var B,F,z={__proto__:null,default:O};if(O===null||typeof O!="object"&&typeof O!="function")return z;if(B=G?I:P){if(B.has(O))return B.get(O);B.set(O,z)}for(const $ in O)$!=="default"&&{}.hasOwnProperty.call(O,$)&&((F=(B=Object.defineProperty)&&Object.getOwnPropertyDescriptor(O,$))&&(F.get||F.set)?B(z,$,F):z[$]=O[$]);return z})(R,M)}let n="";function i(R,M){return n||(n=(0,s.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(P){return(0,s.isFunction)(R[P])})),(0,s.isFunction)(R[n])?R[n](M):!1}function o(R,M,P){let I=R;do{if(i(I,M))return!0;if(I===P)return!1;I=I.parentNode}while(I);return!1}function a(R,M,P,I){if(!R)return;const O={capture:!0,...I};R.addEventListener?R.addEventListener(M,P,O):R.attachEvent?R.attachEvent("on"+M,P):R["on"+M]=P}function l(R,M,P,I){if(!R)return;const O={capture:!0,...I};R.removeEventListener?R.removeEventListener(M,P,O):R.detachEvent?R.detachEvent("on"+M,P):R["on"+M]=null}function d(R){let M=R.clientHeight;const P=R.ownerDocument.defaultView.getComputedStyle(R);return M+=(0,s.int)(P.borderTopWidth),M+=(0,s.int)(P.borderBottomWidth),M}function p(R){let M=R.clientWidth;const P=R.ownerDocument.defaultView.getComputedStyle(R);return M+=(0,s.int)(P.borderLeftWidth),M+=(0,s.int)(P.borderRightWidth),M}function f(R){let M=R.clientHeight;const P=R.ownerDocument.defaultView.getComputedStyle(R);return M-=(0,s.int)(P.paddingTop),M-=(0,s.int)(P.paddingBottom),M}function h(R){let M=R.clientWidth;const P=R.ownerDocument.defaultView.getComputedStyle(R);return M-=(0,s.int)(P.paddingLeft),M-=(0,s.int)(P.paddingRight),M}function x(R,M,P){const O=M===M.ownerDocument.body?{left:0,top:0}:M.getBoundingClientRect(),G=(R.clientX+M.scrollLeft-O.left)/P,B=(R.clientY+M.scrollTop-O.top)/P;return{x:G,y:B}}function m(R,M){const P=w(R,M,"px");return{[(0,e.browserPrefixToKey)("transform",e.default)]:P}}function b(R,M){return w(R,M,"")}function w(R,M,P){let{x:I,y:O}=R,G=`translate(${I}${P},${O}${P})`;if(M){const B=`${typeof M.x=="string"?M.x:M.x+P}`,F=`${typeof M.y=="string"?M.y:M.y+P}`;G=`translate(${B}, ${F})`+G}return G}function y(R,M){return R.targetTouches&&(0,s.findInArray)(R.targetTouches,P=>M===P.identifier)||R.changedTouches&&(0,s.findInArray)(R.changedTouches,P=>M===P.identifier)}function C(R){if(R.targetTouches&&R.targetTouches[0])return R.targetTouches[0].identifier;if(R.changedTouches&&R.changedTouches[0])return R.changedTouches[0].identifier}function T(R){if(!R)return;let M=R.getElementById("react-draggable-style-el");M||(M=R.createElement("style"),M.type="text/css",M.id="react-draggable-style-el",M.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,M.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,R.getElementsByTagName("head")[0].appendChild(M)),R.body&&k(R.body,"react-draggable-transparent-selection")}function E(R){window.requestAnimationFrame?window.requestAnimationFrame(()=>{j(R)}):j(R)}function j(R){if(R)try{if(R.body&&A(R.body,"react-draggable-transparent-selection"),R.selection)R.selection.empty();else{const M=(R.defaultView||window).getSelection();M&&M.type!=="Caret"&&M.removeAllRanges()}}catch{}}function k(R,M){R.classList?R.classList.add(M):R.className.match(new RegExp(`(?:^|\\s)${M}(?!\\S)`))||(R.className+=` ${M}`)}function A(R,M){R.classList?R.classList.remove(M):R.className=R.className.replace(new RegExp(`(?:^|\\s)${M}(?!\\S)`,"g"),"")}return Jn}var Lo={},jj;function f2(){if(jj)return Lo;jj=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.canDragX=i,Lo.canDragY=o,Lo.createCoreData=l,Lo.createDraggableData=d,Lo.getBoundPosition=r,Lo.getControlPosition=a,Lo.snapToGrid=n;var s=lx(),e=yv();function r(h,x,m){if(!h.props.bounds)return[x,m];let{bounds:b}=h.props;b=typeof b=="string"?b:p(b);const w=f(h);if(typeof b=="string"){const{ownerDocument:y}=w,C=y.defaultView;let T;if(b==="parent"?T=w.parentNode:T=w.getRootNode().querySelector(b),!(T instanceof C.HTMLElement))throw new Error('Bounds selector "'+b+'" could not find an element.');const E=T,j=C.getComputedStyle(w),k=C.getComputedStyle(E);b={left:-w.offsetLeft+(0,s.int)(k.paddingLeft)+(0,s.int)(j.marginLeft),top:-w.offsetTop+(0,s.int)(k.paddingTop)+(0,s.int)(j.marginTop),right:(0,e.innerWidth)(E)-(0,e.outerWidth)(w)-w.offsetLeft+(0,s.int)(k.paddingRight)-(0,s.int)(j.marginRight),bottom:(0,e.innerHeight)(E)-(0,e.outerHeight)(w)-w.offsetTop+(0,s.int)(k.paddingBottom)-(0,s.int)(j.marginBottom)}}return(0,s.isNum)(b.right)&&(x=Math.min(x,b.right)),(0,s.isNum)(b.bottom)&&(m=Math.min(m,b.bottom)),(0,s.isNum)(b.left)&&(x=Math.max(x,b.left)),(0,s.isNum)(b.top)&&(m=Math.max(m,b.top)),[x,m]}function n(h,x,m){const b=Math.round(x/h[0])*h[0],w=Math.round(m/h[1])*h[1];return[b,w]}function i(h){return h.props.axis==="both"||h.props.axis==="x"}function o(h){return h.props.axis==="both"||h.props.axis==="y"}function a(h,x,m){const b=typeof x=="number"?(0,e.getTouch)(h,x):null;if(typeof x=="number"&&!b)return null;const w=f(m),y=m.props.offsetParent||w.offsetParent||w.ownerDocument.body;return(0,e.offsetXYFromParent)(b||h,y,m.props.scale)}function l(h,x,m){const b=!(0,s.isNum)(h.lastX),w=f(h);return b?{node:w,deltaX:0,deltaY:0,lastX:x,lastY:m,x,y:m}:{node:w,deltaX:x-h.lastX,deltaY:m-h.lastY,lastX:h.lastX,lastY:h.lastY,x,y:m}}function d(h,x){const m=h.props.scale;return{node:x.node,x:h.state.x+x.deltaX/m,y:h.state.y+x.deltaY/m,deltaX:x.deltaX/m,deltaY:x.deltaY/m,lastX:h.state.x,lastY:h.state.y}}function p(h){return{left:h.left,top:h.top,right:h.right,bottom:h.bottom}}function f(h){const x=h.findDOMNode();if(!x)throw new Error("<DraggableCore>: Unmounted during event!");return x}return Lo}var tp={},Cf={},kj;function g2(){if(kj)return Cf;kj=1,Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.default=s;function s(){}return Cf}var Aj;function TW(){if(Aj)return tp;Aj=1,Object.defineProperty(tp,"__esModule",{value:!0}),tp.default=void 0;var s=d(po()),e=l(kl()),r=l($g()),n=yv(),i=f2(),o=lx(),a=l(g2());function l(w){return w&&w.__esModule?w:{default:w}}function d(w,y){if(typeof WeakMap=="function")var C=new WeakMap,T=new WeakMap;return(d=function(E,j){if(!j&&E&&E.__esModule)return E;var k,A,R={__proto__:null,default:E};if(E===null||typeof E!="object"&&typeof E!="function")return R;if(k=j?T:C){if(k.has(E))return k.get(E);k.set(E,R)}for(const M in E)M!=="default"&&{}.hasOwnProperty.call(E,M)&&((A=(k=Object.defineProperty)&&Object.getOwnPropertyDescriptor(E,M))&&(A.get||A.set)?k(R,M,A):R[M]=E[M]);return R})(w,y)}function p(w,y,C){return(y=f(y))in w?Object.defineProperty(w,y,{value:C,enumerable:!0,configurable:!0,writable:!0}):w[y]=C,w}function f(w){var y=h(w,"string");return typeof y=="symbol"?y:y+""}function h(w,y){if(typeof w!="object"||!w)return w;var C=w[Symbol.toPrimitive];if(C!==void 0){var T=C.call(w,y);if(typeof T!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(y==="string"?String:Number)(w)}const x={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let m=x.mouse,b=class extends s.Component{constructor(){super(...arguments),p(this,"dragging",!1),p(this,"lastX",NaN),p(this,"lastY",NaN),p(this,"touchIdentifier",null),p(this,"mounted",!1),p(this,"handleDragStart",y=>{if(this.props.onMouseDown(y),!this.props.allowAnyClick&&typeof y.button=="number"&&y.button!==0)return!1;const C=this.findDOMNode();if(!C||!C.ownerDocument||!C.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:T}=C;if(this.props.disabled||!(y.target instanceof T.defaultView.Node)||this.props.handle&&!(0,n.matchesSelectorAndParentsTo)(y.target,this.props.handle,C)||this.props.cancel&&(0,n.matchesSelectorAndParentsTo)(y.target,this.props.cancel,C))return;y.type==="touchstart"&&!this.props.allowMobileScroll&&y.preventDefault();const E=(0,n.getTouchIdentifier)(y);this.touchIdentifier=E;const j=(0,i.getControlPosition)(y,E,this);if(j==null)return;const{x:k,y:A}=j,R=(0,i.createCoreData)(this,k,A);(0,a.default)("DraggableCore: handleDragStart: %j",R),(0,a.default)("calling",this.props.onStart),!(this.props.onStart(y,R)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,n.addUserSelectStyles)(T),this.dragging=!0,this.lastX=k,this.lastY=A,(0,n.addEvent)(T,m.move,this.handleDrag),(0,n.addEvent)(T,m.stop,this.handleDragStop))}),p(this,"handleDrag",y=>{const C=(0,i.getControlPosition)(y,this.touchIdentifier,this);if(C==null)return;let{x:T,y:E}=C;if(Array.isArray(this.props.grid)){let A=T-this.lastX,R=E-this.lastY;if([A,R]=(0,i.snapToGrid)(this.props.grid,A,R),!A&&!R)return;T=this.lastX+A,E=this.lastY+R}const j=(0,i.createCoreData)(this,T,E);if((0,a.default)("DraggableCore: handleDrag: %j",j),this.props.onDrag(y,j)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const R=document.createEvent("MouseEvents");R.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(R)}return}this.lastX=T,this.lastY=E}),p(this,"handleDragStop",y=>{if(!this.dragging)return;const C=(0,i.getControlPosition)(y,this.touchIdentifier,this);if(C==null)return;let{x:T,y:E}=C;if(Array.isArray(this.props.grid)){let R=T-this.lastX||0,M=E-this.lastY||0;[R,M]=(0,i.snapToGrid)(this.props.grid,R,M),T=this.lastX+R,E=this.lastY+M}const j=(0,i.createCoreData)(this,T,E);if(this.props.onStop(y,j)===!1||this.mounted===!1)return!1;const A=this.findDOMNode();A&&this.props.enableUserSelectHack&&(0,n.scheduleRemoveUserSelectStyles)(A.ownerDocument),(0,a.default)("DraggableCore: handleDragStop: %j",j),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,A&&((0,a.default)("DraggableCore: Removing handlers"),(0,n.removeEvent)(A.ownerDocument,m.move,this.handleDrag),(0,n.removeEvent)(A.ownerDocument,m.stop,this.handleDragStop))}),p(this,"onMouseDown",y=>(m=x.mouse,this.handleDragStart(y))),p(this,"onMouseUp",y=>(m=x.mouse,this.handleDragStop(y))),p(this,"onTouchStart",y=>(m=x.touch,this.handleDragStart(y))),p(this,"onTouchEnd",y=>(m=x.touch,this.handleDragStop(y)))}componentDidMount(){this.mounted=!0;const y=this.findDOMNode();y&&(0,n.addEvent)(y,x.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const y=this.findDOMNode();if(y){const{ownerDocument:C}=y;(0,n.removeEvent)(C,x.mouse.move,this.handleDrag),(0,n.removeEvent)(C,x.touch.move,this.handleDrag),(0,n.removeEvent)(C,x.mouse.stop,this.handleDragStop),(0,n.removeEvent)(C,x.touch.stop,this.handleDragStop),(0,n.removeEvent)(y,x.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,n.scheduleRemoveUserSelectStyles)(C)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:r.default.findDOMNode(this)}render(){return s.cloneElement(s.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return tp.default=b,p(b,"displayName","DraggableCore"),p(b,"propTypes",{allowAnyClick:e.default.bool,allowMobileScroll:e.default.bool,children:e.default.node.isRequired,disabled:e.default.bool,enableUserSelectHack:e.default.bool,offsetParent:function(w,y){if(w[y]&&w[y].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:e.default.arrayOf(e.default.number),handle:e.default.string,cancel:e.default.string,nodeRef:e.default.object,onStart:e.default.func,onDrag:e.default.func,onStop:e.default.func,onMouseDown:e.default.func,scale:e.default.number,className:o.dontSetMe,style:o.dontSetMe,transform:o.dontSetMe}),p(b,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),tp}var Tj;function RW(){return Tj||(Tj=1,(function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"DraggableCore",{enumerable:!0,get:function(){return d.default}}),s.default=void 0;var e=h(po()),r=f(kl()),n=f($g()),i=ax(),o=yv(),a=f2(),l=lx(),d=f(TW()),p=f(g2());function f(C){return C&&C.__esModule?C:{default:C}}function h(C,T){if(typeof WeakMap=="function")var E=new WeakMap,j=new WeakMap;return(h=function(k,A){if(!A&&k&&k.__esModule)return k;var R,M,P={__proto__:null,default:k};if(k===null||typeof k!="object"&&typeof k!="function")return P;if(R=A?j:E){if(R.has(k))return R.get(k);R.set(k,P)}for(const I in k)I!=="default"&&{}.hasOwnProperty.call(k,I)&&((M=(R=Object.defineProperty)&&Object.getOwnPropertyDescriptor(k,I))&&(M.get||M.set)?R(P,I,M):P[I]=k[I]);return P})(C,T)}function x(){return x=Object.assign?Object.assign.bind():function(C){for(var T=1;T<arguments.length;T++){var E=arguments[T];for(var j in E)({}).hasOwnProperty.call(E,j)&&(C[j]=E[j])}return C},x.apply(null,arguments)}function m(C,T,E){return(T=b(T))in C?Object.defineProperty(C,T,{value:E,enumerable:!0,configurable:!0,writable:!0}):C[T]=E,C}function b(C){var T=w(C,"string");return typeof T=="symbol"?T:T+""}function w(C,T){if(typeof C!="object"||!C)return C;var E=C[Symbol.toPrimitive];if(E!==void 0){var j=E.call(C,T);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(C)}class y extends e.Component{static getDerivedStateFromProps(T,E){let{position:j}=T,{prevPropsPosition:k}=E;return j&&(!k||j.x!==k.x||j.y!==k.y)?((0,p.default)("Draggable: getDerivedStateFromProps %j",{position:j,prevPropsPosition:k}),{x:j.x,y:j.y,prevPropsPosition:{...j}}):null}constructor(T){super(T),m(this,"onDragStart",(E,j)=>{if((0,p.default)("Draggable: onDragStart: %j",j),this.props.onStart(E,(0,a.createDraggableData)(this,j))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),m(this,"onDrag",(E,j)=>{if(!this.state.dragging)return!1;(0,p.default)("Draggable: onDrag: %j",j);const k=(0,a.createDraggableData)(this,j),A={x:k.x,y:k.y,slackX:0,slackY:0};if(this.props.bounds){const{x:M,y:P}=A;A.x+=this.state.slackX,A.y+=this.state.slackY;const[I,O]=(0,a.getBoundPosition)(this,A.x,A.y);A.x=I,A.y=O,A.slackX=this.state.slackX+(M-A.x),A.slackY=this.state.slackY+(P-A.y),k.x=A.x,k.y=A.y,k.deltaX=A.x-this.state.x,k.deltaY=A.y-this.state.y}if(this.props.onDrag(E,k)===!1)return!1;this.setState(A)}),m(this,"onDragStop",(E,j)=>{if(!this.state.dragging||this.props.onStop(E,(0,a.createDraggableData)(this,j))===!1)return!1;(0,p.default)("Draggable: onDragStop: %j",j);const A={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:M,y:P}=this.props.position;A.x=M,A.y=P}this.setState(A)}),this.state={dragging:!1,dragged:!1,x:T.position?T.position.x:T.defaultPosition.x,y:T.position?T.position.y:T.defaultPosition.y,prevPropsPosition:{...T.position},slackX:0,slackY:0,isElementSVG:!1},T.position&&!(T.onDrag||T.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??n.default.findDOMNode(this)}render(){const{axis:T,bounds:E,children:j,defaultPosition:k,defaultClassName:A,defaultClassNameDragging:R,defaultClassNameDragged:M,position:P,positionOffset:I,scale:O,...G}=this.props;let B={},F=null;const $=!!!P||this.state.dragging,W=P||k,D={x:(0,a.canDragX)(this)&&$?this.state.x:W.x,y:(0,a.canDragY)(this)&&$?this.state.y:W.y};this.state.isElementSVG?F=(0,o.createSVGTransform)(D,I):B=(0,o.createCSSTransform)(D,I);const oe=(0,i.clsx)(j.props.className||"",A,{[R]:this.state.dragging,[M]:this.state.dragged});return e.createElement(d.default,x({},G,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(j),{className:oe,style:{...j.props.style,...B},transform:F}))}}s.default=y,m(y,"displayName","Draggable"),m(y,"propTypes",{...d.default.propTypes,axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),m(y,"defaultProps",{...d.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(i0)),i0}var Rj;function bv(){if(Rj)return ep.exports;Rj=1;const{default:s,DraggableCore:e}=RW();return ep.exports=s,ep.exports.default=s,ep.exports.DraggableCore=e,ep.exports}var rp={exports:{}},np={},jf={},Nj;function NW(){if(Nj)return jf;Nj=1,jf.__esModule=!0,jf.cloneElement=l;var s=e(po());function e(d){return d&&d.__esModule?d:{default:d}}function r(d,p){var f=Object.keys(d);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(d);p&&(h=h.filter(function(x){return Object.getOwnPropertyDescriptor(d,x).enumerable})),f.push.apply(f,h)}return f}function n(d){for(var p=1;p<arguments.length;p++){var f=arguments[p]!=null?arguments[p]:{};p%2?r(Object(f),!0).forEach(function(h){i(d,h,f[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(f)):r(Object(f)).forEach(function(h){Object.defineProperty(d,h,Object.getOwnPropertyDescriptor(f,h))})}return d}function i(d,p,f){return p=o(p),p in d?Object.defineProperty(d,p,{value:f,enumerable:!0,configurable:!0,writable:!0}):d[p]=f,d}function o(d){var p=a(d,"string");return typeof p=="symbol"?p:String(p)}function a(d,p){if(typeof d!="object"||d===null)return d;var f=d[Symbol.toPrimitive];if(f!==void 0){var h=f.call(d,p);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(d)}function l(d,p){return p.style&&d.props.style&&(p.style=n(n({},d.props.style),p.style)),p.className&&d.props.className&&(p.className=d.props.className+" "+p.className),s.default.cloneElement(d,p)}return jf}var sp={},Oj;function x2(){if(Oj)return sp;Oj=1,sp.__esModule=!0,sp.resizableProps=void 0;var s=e(kl());bv();function e(n){return n&&n.__esModule?n:{default:n}}var r={axis:s.default.oneOf(["both","x","y","none"]),className:s.default.string,children:s.default.element.isRequired,draggableOpts:s.default.shape({allowAnyClick:s.default.bool,cancel:s.default.string,children:s.default.node,disabled:s.default.bool,enableUserSelectHack:s.default.bool,offsetParent:s.default.node,grid:s.default.arrayOf(s.default.number),handle:s.default.string,nodeRef:s.default.object,onStart:s.default.func,onDrag:s.default.func,onStop:s.default.func,onMouseDown:s.default.func,scale:s.default.number}),height:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var l=o[0];if(l.axis==="both"||l.axis==="y"){var d;return(d=s.default.number).isRequired.apply(d,o)}return s.default.number.apply(s.default,o)},handle:s.default.oneOfType([s.default.node,s.default.func]),handleSize:s.default.arrayOf(s.default.number),lockAspectRatio:s.default.bool,maxConstraints:s.default.arrayOf(s.default.number),minConstraints:s.default.arrayOf(s.default.number),onResizeStop:s.default.func,onResizeStart:s.default.func,onResize:s.default.func,resizeHandles:s.default.arrayOf(s.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:s.default.number,width:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var l=o[0];if(l.axis==="both"||l.axis==="x"){var d;return(d=s.default.number).isRequired.apply(d,o)}return s.default.number.apply(s.default,o)}};return sp.resizableProps=r,sp}var _j;function m2(){if(_j)return np;_j=1,np.__esModule=!0,np.default=void 0;var s=a(po()),e=bv(),r=NW(),n=x2(),i=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function o(C){if(typeof WeakMap!="function")return null;var T=new WeakMap,E=new WeakMap;return(o=function(k){return k?E:T})(C)}function a(C,T){if(C&&C.__esModule)return C;if(C===null||typeof C!="object"&&typeof C!="function")return{default:C};var E=o(T);if(E&&E.has(C))return E.get(C);var j={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in C)if(A!=="default"&&Object.prototype.hasOwnProperty.call(C,A)){var R=k?Object.getOwnPropertyDescriptor(C,A):null;R&&(R.get||R.set)?Object.defineProperty(j,A,R):j[A]=C[A]}return j.default=C,E&&E.set(C,j),j}function l(){return l=Object.assign?Object.assign.bind():function(C){for(var T=1;T<arguments.length;T++){var E=arguments[T];for(var j in E)Object.prototype.hasOwnProperty.call(E,j)&&(C[j]=E[j])}return C},l.apply(this,arguments)}function d(C,T){if(C==null)return{};var E={},j=Object.keys(C),k,A;for(A=0;A<j.length;A++)k=j[A],!(T.indexOf(k)>=0)&&(E[k]=C[k]);return E}function p(C,T){var E=Object.keys(C);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(C);T&&(j=j.filter(function(k){return Object.getOwnPropertyDescriptor(C,k).enumerable})),E.push.apply(E,j)}return E}function f(C){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?p(Object(E),!0).forEach(function(j){h(C,j,E[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(E)):p(Object(E)).forEach(function(j){Object.defineProperty(C,j,Object.getOwnPropertyDescriptor(E,j))})}return C}function h(C,T,E){return T=x(T),T in C?Object.defineProperty(C,T,{value:E,enumerable:!0,configurable:!0,writable:!0}):C[T]=E,C}function x(C){var T=m(C,"string");return typeof T=="symbol"?T:String(T)}function m(C,T){if(typeof C!="object"||C===null)return C;var E=C[Symbol.toPrimitive];if(E!==void 0){var j=E.call(C,T);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(C)}function b(C,T){C.prototype=Object.create(T.prototype),C.prototype.constructor=C,w(C,T)}function w(C,T){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,k){return j.__proto__=k,j},w(C,T)}var y=(function(C){b(T,C);function T(){for(var j,k=arguments.length,A=new Array(k),R=0;R<k;R++)A[R]=arguments[R];return j=C.call.apply(C,[this].concat(A))||this,j.handleRefs={},j.lastHandleRect=null,j.slack=null,j}var E=T.prototype;return E.componentWillUnmount=function(){this.resetData()},E.resetData=function(){this.lastHandleRect=this.slack=null},E.runConstraints=function(k,A){var R=this.props,M=R.minConstraints,P=R.maxConstraints,I=R.lockAspectRatio;if(!M&&!P&&!I)return[k,A];if(I){var O=this.props.width/this.props.height,G=k-this.props.width,B=A-this.props.height;Math.abs(G)>Math.abs(B*O)?A=k/O:k=A*O}var F=k,z=A,$=this.slack||[0,0],W=$[0],D=$[1];return k+=W,A+=D,M&&(k=Math.max(M[0],k),A=Math.max(M[1],A)),P&&(k=Math.min(P[0],k),A=Math.min(P[1],A)),this.slack=[W+(F-k),D+(z-A)],[k,A]},E.resizeHandler=function(k,A){var R=this;return function(M,P){var I=P.node,O=P.deltaX,G=P.deltaY;k==="onResizeStart"&&R.resetData();var B=(R.props.axis==="both"||R.props.axis==="x")&&A!=="n"&&A!=="s",F=(R.props.axis==="both"||R.props.axis==="y")&&A!=="e"&&A!=="w";if(!(!B&&!F)){var z=A[0],$=A[A.length-1],W=I.getBoundingClientRect();if(R.lastHandleRect!=null){if($==="w"){var D=W.left-R.lastHandleRect.left;O+=D}if(z==="n"){var oe=W.top-R.lastHandleRect.top;G+=oe}}R.lastHandleRect=W,$==="w"&&(O=-O),z==="n"&&(G=-G);var Z=R.props.width+(B?O/R.props.transformScale:0),fe=R.props.height+(F?G/R.props.transformScale:0),Q=R.runConstraints(Z,fe);Z=Q[0],fe=Q[1];var _=Z!==R.props.width||fe!==R.props.height,Y=typeof R.props[k]=="function"?R.props[k]:null,he=k==="onResize"&&!_;Y&&!he&&(M.persist==null||M.persist(),Y(M,{node:I,size:{width:Z,height:fe},handle:A})),k==="onResizeStop"&&R.resetData()}}},E.renderResizeHandle=function(k,A){var R=this.props.handle;if(!R)return s.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+k,ref:A});if(typeof R=="function")return R(k,A);var M=typeof R.type=="string",P=f({ref:A},M?{}:{handleAxis:k});return s.cloneElement(R,P)},E.render=function(){var k=this,A=this.props,R=A.children,M=A.className,P=A.draggableOpts;A.width,A.height,A.handle,A.handleSize,A.lockAspectRatio,A.axis,A.minConstraints,A.maxConstraints,A.onResize,A.onResizeStop,A.onResizeStart;var I=A.resizeHandles;A.transformScale;var O=d(A,i);return(0,r.cloneElement)(R,f(f({},O),{},{className:(M?M+" ":"")+"react-resizable",children:[].concat(R.props.children,I.map(function(G){var B,F=(B=k.handleRefs[G])!=null?B:k.handleRefs[G]=s.createRef();return s.createElement(e.DraggableCore,l({},P,{nodeRef:F,key:"resizableHandle-"+G,onStop:k.resizeHandler("onResizeStop",G),onStart:k.resizeHandler("onResizeStart",G),onDrag:k.resizeHandler("onResize",G)}),k.renderResizeHandle(G,F))}))}))},T})(s.Component);return np.default=y,y.propTypes=n.resizableProps,y.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1},np}var ip={},Dj;function OW(){if(Dj)return ip;Dj=1,ip.__esModule=!0,ip.default=void 0;var s=l(po()),e=o(kl()),r=o(m2()),n=x2(),i=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function o(T){return T&&T.__esModule?T:{default:T}}function a(T){if(typeof WeakMap!="function")return null;var E=new WeakMap,j=new WeakMap;return(a=function(A){return A?j:E})(T)}function l(T,E){if(T&&T.__esModule)return T;if(T===null||typeof T!="object"&&typeof T!="function")return{default:T};var j=a(E);if(j&&j.has(T))return j.get(T);var k={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in T)if(R!=="default"&&Object.prototype.hasOwnProperty.call(T,R)){var M=A?Object.getOwnPropertyDescriptor(T,R):null;M&&(M.get||M.set)?Object.defineProperty(k,R,M):k[R]=T[R]}return k.default=T,j&&j.set(T,k),k}function d(){return d=Object.assign?Object.assign.bind():function(T){for(var E=1;E<arguments.length;E++){var j=arguments[E];for(var k in j)Object.prototype.hasOwnProperty.call(j,k)&&(T[k]=j[k])}return T},d.apply(this,arguments)}function p(T,E){var j=Object.keys(T);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(T);E&&(k=k.filter(function(A){return Object.getOwnPropertyDescriptor(T,A).enumerable})),j.push.apply(j,k)}return j}function f(T){for(var E=1;E<arguments.length;E++){var j=arguments[E]!=null?arguments[E]:{};E%2?p(Object(j),!0).forEach(function(k){h(T,k,j[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(j)):p(Object(j)).forEach(function(k){Object.defineProperty(T,k,Object.getOwnPropertyDescriptor(j,k))})}return T}function h(T,E,j){return E=x(E),E in T?Object.defineProperty(T,E,{value:j,enumerable:!0,configurable:!0,writable:!0}):T[E]=j,T}function x(T){var E=m(T,"string");return typeof E=="symbol"?E:String(E)}function m(T,E){if(typeof T!="object"||T===null)return T;var j=T[Symbol.toPrimitive];if(j!==void 0){var k=j.call(T,E);if(typeof k!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(T)}function b(T,E){if(T==null)return{};var j={},k=Object.keys(T),A,R;for(R=0;R<k.length;R++)A=k[R],!(E.indexOf(A)>=0)&&(j[A]=T[A]);return j}function w(T,E){T.prototype=Object.create(E.prototype),T.prototype.constructor=T,y(T,E)}function y(T,E){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(k,A){return k.__proto__=A,k},y(T,E)}var C=(function(T){w(E,T);function E(){for(var k,A=arguments.length,R=new Array(A),M=0;M<A;M++)R[M]=arguments[M];return k=T.call.apply(T,[this].concat(R))||this,k.state={width:k.props.width,height:k.props.height,propsWidth:k.props.width,propsHeight:k.props.height},k.onResize=function(P,I){var O=I.size;k.props.onResize?(P.persist==null||P.persist(),k.setState(O,function(){return k.props.onResize&&k.props.onResize(P,I)})):k.setState(O)},k}E.getDerivedStateFromProps=function(A,R){return R.propsWidth!==A.width||R.propsHeight!==A.height?{width:A.width,height:A.height,propsWidth:A.width,propsHeight:A.height}:null};var j=E.prototype;return j.render=function(){var A=this.props,R=A.handle,M=A.handleSize;A.onResize;var P=A.onResizeStart,I=A.onResizeStop,O=A.draggableOpts,G=A.minConstraints,B=A.maxConstraints,F=A.lockAspectRatio,z=A.axis;A.width,A.height;var $=A.resizeHandles,W=A.style,D=A.transformScale,oe=b(A,i);return s.createElement(r.default,{axis:z,draggableOpts:O,handle:R,handleSize:M,height:this.state.height,lockAspectRatio:F,maxConstraints:B,minConstraints:G,onResizeStart:P,onResize:this.onResize,onResizeStop:I,resizeHandles:$,transformScale:D,width:this.state.width},s.createElement("div",d({},oe,{style:f(f({},W),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},E})(s.Component);return ip.default=C,C.propTypes=f(f({},n.resizableProps),{},{children:e.default.element}),ip}var Ij;function _W(){return Ij||(Ij=1,rp.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")},rp.exports.Resizable=m2().default,rp.exports.ResizableBox=OW().default),rp.exports}var ma={},Pj;function y2(){if(Pj)return ma;Pj=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.resizeHandleType=ma.resizeHandleAxesType=ma.default=void 0;var s=r(kl()),e=r(po());function r(o){return o&&o.__esModule?o:{default:o}}const n=ma.resizeHandleAxesType=s.default.arrayOf(s.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),i=ma.resizeHandleType=s.default.oneOfType([s.default.node,s.default.func]);return ma.default={className:s.default.string,style:s.default.object,width:s.default.number,autoSize:s.default.bool,cols:s.default.number,draggableCancel:s.default.string,draggableHandle:s.default.string,verticalCompact:function(o){o.verticalCompact},compactType:s.default.oneOf(["vertical","horizontal"]),layout:function(o){var a=o.layout;a!==void 0&&Yd().validateLayout(a,"layout")},margin:s.default.arrayOf(s.default.number),containerPadding:s.default.arrayOf(s.default.number),rowHeight:s.default.number,maxRows:s.default.number,isBounded:s.default.bool,isDraggable:s.default.bool,isResizable:s.default.bool,allowOverlap:s.default.bool,preventCollision:s.default.bool,useCSSTransforms:s.default.bool,transformScale:s.default.number,isDroppable:s.default.bool,resizeHandles:n,resizeHandle:i,onLayoutChange:s.default.func,onDragStart:s.default.func,onDrag:s.default.func,onDragStop:s.default.func,onResizeStart:s.default.func,onResize:s.default.func,onResizeStop:s.default.func,onDrop:s.default.func,droppingItem:s.default.shape({i:s.default.string.isRequired,w:s.default.number.isRequired,h:s.default.number.isRequired}),children:function(o,a){const l=o[a],d={};e.default.Children.forEach(l,function(p){if(p?.key!=null){if(d[p.key])throw new Error('Duplicate child key "'+p.key+'" found! This will cause problems in ReactGridLayout.');d[p.key]=!0}})},innerRef:s.default.any},ma}var Lj;function DW(){if(Lj)return Zu;Lj=1,Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.default=void 0;var s=p(po()),e=$g(),r=p(kl()),n=bv(),i=_W(),o=Yd(),a=mv(),l=y2(),d=p(ax());function p(y){return y&&y.__esModule?y:{default:y}}function f(y,C){var T=Object.keys(y);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(y);C&&(E=E.filter(function(j){return Object.getOwnPropertyDescriptor(y,j).enumerable})),T.push.apply(T,E)}return T}function h(y){for(var C=1;C<arguments.length;C++){var T=arguments[C]!=null?arguments[C]:{};C%2?f(Object(T),!0).forEach(function(E){x(y,E,T[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(T)):f(Object(T)).forEach(function(E){Object.defineProperty(y,E,Object.getOwnPropertyDescriptor(T,E))})}return y}function x(y,C,T){return(C=m(C))in y?Object.defineProperty(y,C,{value:T,enumerable:!0,configurable:!0,writable:!0}):y[C]=T,y}function m(y){var C=b(y,"string");return typeof C=="symbol"?C:C+""}function b(y,C){if(typeof y!="object"||!y)return y;var T=y[Symbol.toPrimitive];if(T!==void 0){var E=T.call(y,C);if(typeof E!="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return(C==="string"?String:Number)(y)}let w=class extends s.default.Component{constructor(){super(...arguments),x(this,"state",{resizing:null,dragging:null,className:""}),x(this,"elementRef",s.default.createRef()),x(this,"onDragStart",(C,T)=>{let{node:E}=T;const{onDragStart:j,transformScale:k}=this.props;if(!j)return;const A={top:0,left:0},{offsetParent:R}=E;if(!R)return;const M=R.getBoundingClientRect(),P=E.getBoundingClientRect(),I=P.left/k,O=M.left/k,G=P.top/k,B=M.top/k;A.left=I-O+R.scrollLeft,A.top=G-B+R.scrollTop,this.setState({dragging:A});const{x:F,y:z}=(0,a.calcXY)(this.getPositionParams(),A.top,A.left,this.props.w,this.props.h);return j.call(this,this.props.i,F,z,{e:C,node:E,newPosition:A})}),x(this,"onDrag",(C,T,E)=>{let{node:j,deltaX:k,deltaY:A}=T;const{onDrag:R}=this.props;if(!R)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let M=this.state.dragging.top+A,P=this.state.dragging.left+k;const{isBounded:I,i:O,w:G,h:B,containerWidth:F}=this.props,z=this.getPositionParams();if(I){const{offsetParent:oe}=j;if(oe){const{margin:Z,rowHeight:fe}=this.props,Q=oe.clientHeight-(0,a.calcGridItemWHPx)(B,fe,Z[1]);M=(0,a.clamp)(M,0,Q);const _=(0,a.calcGridColWidth)(z),Y=F-(0,a.calcGridItemWHPx)(G,_,Z[0]);P=(0,a.clamp)(P,0,Y)}}const $={top:M,left:P};E?this.setState({dragging:$}):(0,e.flushSync)(()=>{this.setState({dragging:$})});const{x:W,y:D}=(0,a.calcXY)(z,M,P,G,B);return R.call(this,O,W,D,{e:C,node:j,newPosition:$})}),x(this,"onDragStop",(C,T)=>{let{node:E}=T;const{onDragStop:j}=this.props;if(!j)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");const{w:k,h:A,i:R}=this.props,{left:M,top:P}=this.state.dragging,I={top:P,left:M};this.setState({dragging:null});const{x:O,y:G}=(0,a.calcXY)(this.getPositionParams(),P,M,k,A);return j.call(this,R,O,G,{e:C,node:E,newPosition:I})}),x(this,"onResizeStop",(C,T,E)=>this.onResizeHandler(C,T,E,"onResizeStop")),x(this,"onResizeStart",(C,T,E)=>this.onResizeHandler(C,T,E,"onResizeStart")),x(this,"onResize",(C,T,E)=>this.onResizeHandler(C,T,E,"onResize"))}shouldComponentUpdate(C,T){if(this.props.children!==C.children||this.props.droppingPosition!==C.droppingPosition)return!0;const E=(0,a.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),j=(0,a.calcGridItemPosition)(this.getPositionParams(C),C.x,C.y,C.w,C.h,T);return!(0,o.fastPositionEqual)(E,j)||this.props.useCSSTransforms!==C.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(C){this.moveDroppingItem(C)}moveDroppingItem(C){const{droppingPosition:T}=this.props;if(!T)return;const E=this.elementRef.current;if(!E)return;const j=C.droppingPosition||{left:0,top:0},{dragging:k}=this.state,A=k&&T.left!==j.left||T.top!==j.top;if(!k)this.onDragStart(T.e,{node:E,deltaX:T.left,deltaY:T.top});else if(A){const R=T.left-k.left,M=T.top-k.top;this.onDrag(T.e,{node:E,deltaX:R,deltaY:M},!0)}}getPositionParams(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:C.cols,containerPadding:C.containerPadding,containerWidth:C.containerWidth,margin:C.margin,maxRows:C.maxRows,rowHeight:C.rowHeight}}createStyle(C){const{usePercentages:T,containerWidth:E,useCSSTransforms:j}=this.props;let k;return j?k=(0,o.setTransform)(C):(k=(0,o.setTopLeft)(C),T&&(k.left=(0,o.perc)(C.left/E),k.width=(0,o.perc)(C.width/E))),k}mixinDraggable(C,T){return s.default.createElement(n.DraggableCore,{disabled:!T,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},C)}curryResizeHandler(C,T){return(E,j)=>T(E,j,C)}mixinResizable(C,T,E){const{cols:j,minW:k,minH:A,maxW:R,maxH:M,transformScale:P,resizeHandles:I,resizeHandle:O}=this.props,G=this.getPositionParams(),B=(0,a.calcGridItemPosition)(G,0,0,j,0).width,F=(0,a.calcGridItemPosition)(G,0,0,k,A),z=(0,a.calcGridItemPosition)(G,0,0,R,M),$=[F.width,F.height],W=[Math.min(z.width,B),Math.min(z.height,1/0)];return s.default.createElement(i.Resizable,{draggableOpts:{disabled:!E},className:E?void 0:"react-resizable-hide",width:T.width,height:T.height,minConstraints:$,maxConstraints:W,onResizeStop:this.curryResizeHandler(T,this.onResizeStop),onResizeStart:this.curryResizeHandler(T,this.onResizeStart),onResize:this.curryResizeHandler(T,this.onResize),transformScale:P,resizeHandles:I,handle:O},C)}onResizeHandler(C,T,E,j){let{node:k,size:A,handle:R}=T;const M=this.props[j];if(!M)return;const{x:P,y:I,i:O,maxH:G,minH:B,containerWidth:F}=this.props,{minW:z,maxW:$}=this.props;let W=A;k&&(W=(0,o.resizeItemInDirection)(R,E,A,F),(0,e.flushSync)(()=>{this.setState({resizing:j==="onResizeStop"?null:W})}));let{w:D,h:oe}=(0,a.calcWH)(this.getPositionParams(),W.width,W.height,P,I,R);D=(0,a.clamp)(D,Math.max(z,1),$),oe=(0,a.clamp)(oe,B,G),M.call(this,O,D,oe,{e:C,node:k,size:W,handle:R})}render(){const{x:C,y:T,w:E,h:j,isDraggable:k,isResizable:A,droppingPosition:R,useCSSTransforms:M}=this.props,P=(0,a.calcGridItemPosition)(this.getPositionParams(),C,T,E,j,this.state),I=s.default.Children.only(this.props.children);let O=s.default.cloneElement(I,{ref:this.elementRef,className:(0,d.default)("react-grid-item",I.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":k,"react-draggable-dragging":!!this.state.dragging,dropping:!!R,cssTransforms:M}),style:h(h(h({},this.props.style),I.props.style),this.createStyle(P))});return O=this.mixinResizable(O,P,A),O=this.mixinDraggable(O,k),O}};return Zu.default=w,x(w,"propTypes",{children:r.default.element,cols:r.default.number.isRequired,containerWidth:r.default.number.isRequired,rowHeight:r.default.number.isRequired,margin:r.default.array.isRequired,maxRows:r.default.number.isRequired,containerPadding:r.default.array.isRequired,x:r.default.number.isRequired,y:r.default.number.isRequired,w:r.default.number.isRequired,h:r.default.number.isRequired,minW:function(y,C){const T=y[C];if(typeof T!="number")return new Error("minWidth not Number");if(T>y.w||T>y.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(y,C){const T=y[C];if(typeof T!="number")return new Error("maxWidth not Number");if(T<y.w||T<y.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(y,C){const T=y[C];if(typeof T!="number")return new Error("minHeight not Number");if(T>y.h||T>y.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(y,C){const T=y[C];if(typeof T!="number")return new Error("maxHeight not Number");if(T<y.h||T<y.minH)return new Error("maxHeight smaller than item height/minHeight")},i:r.default.string.isRequired,resizeHandles:l.resizeHandleAxesType,resizeHandle:l.resizeHandleType,onDragStop:r.default.func,onDragStart:r.default.func,onDrag:r.default.func,onResizeStop:r.default.func,onResizeStart:r.default.func,onResize:r.default.func,isDraggable:r.default.bool.isRequired,isResizable:r.default.bool.isRequired,isBounded:r.default.bool.isRequired,static:r.default.bool,useCSSTransforms:r.default.bool.isRequired,transformScale:r.default.number,className:r.default.string,handle:r.default.string,cancel:r.default.string,droppingPosition:r.default.shape({e:r.default.object.isRequired,left:r.default.number.isRequired,top:r.default.number.isRequired})}),x(w,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1}),Zu}var zj;function b2(){if(zj)return Qu;zj=1,Object.defineProperty(Qu,"__esModule",{value:!0}),Qu.default=void 0;var s=d(po()),e=xv(),r=l(ax()),n=Yd(),i=mv(),o=l(DW()),a=l(y2());function l(C){return C&&C.__esModule?C:{default:C}}function d(C,T){if(typeof WeakMap=="function")var E=new WeakMap,j=new WeakMap;return(d=function(k,A){if(!A&&k&&k.__esModule)return k;var R,M,P={__proto__:null,default:k};if(k===null||typeof k!="object"&&typeof k!="function")return P;if(R=A?j:E){if(R.has(k))return R.get(k);R.set(k,P)}for(const I in k)I!=="default"&&{}.hasOwnProperty.call(k,I)&&((M=(R=Object.defineProperty)&&Object.getOwnPropertyDescriptor(k,I))&&(M.get||M.set)?R(P,I,M):P[I]=k[I]);return P})(C,T)}function p(C,T){var E=Object.keys(C);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(C);T&&(j=j.filter(function(k){return Object.getOwnPropertyDescriptor(C,k).enumerable})),E.push.apply(E,j)}return E}function f(C){for(var T=1;T<arguments.length;T++){var E=arguments[T]!=null?arguments[T]:{};T%2?p(Object(E),!0).forEach(function(j){h(C,j,E[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(E)):p(Object(E)).forEach(function(j){Object.defineProperty(C,j,Object.getOwnPropertyDescriptor(E,j))})}return C}function h(C,T,E){return(T=x(T))in C?Object.defineProperty(C,T,{value:E,enumerable:!0,configurable:!0,writable:!0}):C[T]=E,C}function x(C){var T=m(C,"string");return typeof T=="symbol"?T:T+""}function m(C,T){if(typeof C!="object"||!C)return C;var E=C[Symbol.toPrimitive];if(E!==void 0){var j=E.call(C,T);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(C)}const b="react-grid-layout";let w=!1;try{w=/firefox/i.test(navigator.userAgent)}catch{}let y=class extends s.Component{constructor(){super(...arguments),h(this,"state",{activeDrag:null,layout:(0,n.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,n.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),h(this,"dragEnterCounter",0),h(this,"onDragStart",(T,E,j,k)=>{let{e:A,node:R}=k;const{layout:M}=this.state,P=(0,n.getLayoutItem)(M,T);if(!P)return;const I={w:P.w,h:P.h,x:P.x,y:P.y,placeholder:!0,i:T};return this.setState({oldDragItem:(0,n.cloneLayoutItem)(P),oldLayout:M,activeDrag:I}),this.props.onDragStart(M,P,P,null,A,R)}),h(this,"onDrag",(T,E,j,k)=>{let{e:A,node:R}=k;const{oldDragItem:M}=this.state;let{layout:P}=this.state;const{cols:I,allowOverlap:O,preventCollision:G}=this.props,B=(0,n.getLayoutItem)(P,T);if(!B)return;const F={w:B.w,h:B.h,x:B.x,y:B.y,placeholder:!0,i:T};P=(0,n.moveElement)(P,B,E,j,!0,G,(0,n.compactType)(this.props),I,O),this.props.onDrag(P,M,B,F,A,R),this.setState({layout:O?P:(0,n.compact)(P,(0,n.compactType)(this.props),I),activeDrag:F})}),h(this,"onDragStop",(T,E,j,k)=>{let{e:A,node:R}=k;if(!this.state.activeDrag)return;const{oldDragItem:M}=this.state;let{layout:P}=this.state;const{cols:I,preventCollision:O,allowOverlap:G}=this.props,B=(0,n.getLayoutItem)(P,T);if(!B)return;P=(0,n.moveElement)(P,B,E,j,!0,O,(0,n.compactType)(this.props),I,G);const z=G?P:(0,n.compact)(P,(0,n.compactType)(this.props),I);this.props.onDragStop(z,M,B,null,A,R);const{oldLayout:$}=this.state;this.setState({activeDrag:null,layout:z,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(z,$)}),h(this,"onResizeStart",(T,E,j,k)=>{let{e:A,node:R}=k;const{layout:M}=this.state,P=(0,n.getLayoutItem)(M,T);P&&(this.setState({oldResizeItem:(0,n.cloneLayoutItem)(P),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(M,P,P,null,A,R))}),h(this,"onResize",(T,E,j,k)=>{let{e:A,node:R,size:M,handle:P}=k;const{oldResizeItem:I}=this.state,{layout:O}=this.state,{cols:G,preventCollision:B,allowOverlap:F}=this.props;let z=!1,$,W,D;const[oe,Z]=(0,n.withLayoutItem)(O,T,Q=>{let _;return W=Q.x,D=Q.y,["sw","w","nw","n","ne"].indexOf(P)!==-1&&(["sw","nw","w"].indexOf(P)!==-1&&(W=Q.x+(Q.w-E),E=Q.x!==W&&W<0?Q.w:E,W=W<0?0:W),["ne","n","nw"].indexOf(P)!==-1&&(D=Q.y+(Q.h-j),j=Q.y!==D&&D<0?Q.h:j,D=D<0?0:D),z=!0),B&&!F&&(_=(0,n.getAllCollisions)(O,f(f({},Q),{},{w:E,h:j,x:W,y:D})).filter(he=>he.i!==Q.i).length>0,_&&(D=Q.y,j=Q.h,W=Q.x,E=Q.w,z=!1)),Q.w=E,Q.h=j,Q});if(!Z)return;$=oe,z&&($=(0,n.moveElement)(oe,Z,W,D,!0,this.props.preventCollision,(0,n.compactType)(this.props),G,F));const fe={w:Z.w,h:Z.h,x:Z.x,y:Z.y,static:!0,i:T};this.props.onResize($,I,Z,fe,A,R),this.setState({layout:F?$:(0,n.compact)($,(0,n.compactType)(this.props),G),activeDrag:fe})}),h(this,"onResizeStop",(T,E,j,k)=>{let{e:A,node:R}=k;const{layout:M,oldResizeItem:P}=this.state,{cols:I,allowOverlap:O}=this.props,G=(0,n.getLayoutItem)(M,T),B=O?M:(0,n.compact)(M,(0,n.compactType)(this.props),I);this.props.onResizeStop(B,P,G,null,A,R);const{oldLayout:F}=this.state;this.setState({activeDrag:null,layout:B,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(B,F)}),h(this,"onDragOver",T=>{var E;if(T.preventDefault(),T.stopPropagation(),w&&!((E=T.nativeEvent.target)!==null&&E!==void 0&&E.classList.contains(b)))return!1;const{droppingItem:j,onDropDragOver:k,margin:A,cols:R,rowHeight:M,maxRows:P,width:I,containerPadding:O,transformScale:G}=this.props,B=k?.(T);if(B===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;const F=f(f({},j),B),{layout:z}=this.state,$=T.currentTarget.getBoundingClientRect(),W=T.clientX-$.left,D=T.clientY-$.top,oe={left:W/G,top:D/G,e:T};if(this.state.droppingDOMNode){if(this.state.droppingPosition){const{left:Z,top:fe}=this.state.droppingPosition;(Z!=W||fe!=D)&&this.setState({droppingPosition:oe})}}else{const Z={cols:R,margin:A,maxRows:P,rowHeight:M,containerWidth:I,containerPadding:O||A},fe=(0,i.calcXY)(Z,D,W,F.w,F.h);this.setState({droppingDOMNode:s.createElement("div",{key:F.i}),droppingPosition:oe,layout:[...z,f(f({},F),{},{x:fe.x,y:fe.y,static:!1,isDraggable:!0})]})}}),h(this,"removeDroppingPlaceholder",()=>{const{droppingItem:T,cols:E}=this.props,{layout:j}=this.state,k=(0,n.compact)(j.filter(A=>A.i!==T.i),(0,n.compactType)(this.props),E,this.props.allowOverlap);this.setState({layout:k,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),h(this,"onDragLeave",T=>{T.preventDefault(),T.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),h(this,"onDragEnter",T=>{T.preventDefault(),T.stopPropagation(),this.dragEnterCounter++}),h(this,"onDrop",T=>{T.preventDefault(),T.stopPropagation();const{droppingItem:E}=this.props,{layout:j}=this.state,k=j.find(A=>A.i===E.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(j,k,T)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(T,E){let j;return E.activeDrag?null:(!(0,e.deepEqual)(T.layout,E.propsLayout)||T.compactType!==E.compactType?j=T.layout:(0,n.childrenEqual)(T.children,E.children)||(j=E.layout),j?{layout:(0,n.synchronizeLayoutWithChildren)(j,T.children,T.cols,(0,n.compactType)(T),T.allowOverlap),compactType:T.compactType,children:T.children,propsLayout:T.layout}:null)}shouldComponentUpdate(T,E){return this.props.children!==T.children||!(0,n.fastRGLPropsEqual)(this.props,T,e.deepEqual)||this.state.activeDrag!==E.activeDrag||this.state.mounted!==E.mounted||this.state.droppingPosition!==E.droppingPosition}componentDidUpdate(T,E){if(!this.state.activeDrag){const j=this.state.layout,k=E.layout;this.onLayoutMaybeChanged(j,k)}}containerHeight(){if(!this.props.autoSize)return;const T=(0,n.bottom)(this.state.layout),E=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return T*this.props.rowHeight+(T-1)*this.props.margin[1]+E*2+"px"}onLayoutMaybeChanged(T,E){E||(E=this.state.layout),(0,e.deepEqual)(E,T)||this.props.onLayoutChange(T)}placeholder(){const{activeDrag:T}=this.state;if(!T)return null;const{width:E,cols:j,margin:k,containerPadding:A,rowHeight:R,maxRows:M,useCSSTransforms:P,transformScale:I}=this.props;return s.createElement(o.default,{w:T.w,h:T.h,x:T.x,y:T.y,i:T.i,className:"react-grid-placeholder ".concat(this.state.resizing?"placeholder-resizing":""),containerWidth:E,cols:j,margin:k,containerPadding:A||k,maxRows:M,rowHeight:R,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:P,transformScale:I},s.createElement("div",null))}processGridItem(T,E){if(!T||!T.key)return;const j=(0,n.getLayoutItem)(this.state.layout,String(T.key));if(!j)return null;const{width:k,cols:A,margin:R,containerPadding:M,rowHeight:P,maxRows:I,isDraggable:O,isResizable:G,isBounded:B,useCSSTransforms:F,transformScale:z,draggableCancel:$,draggableHandle:W,resizeHandles:D,resizeHandle:oe}=this.props,{mounted:Z,droppingPosition:fe}=this.state,Q=typeof j.isDraggable=="boolean"?j.isDraggable:!j.static&&O,_=typeof j.isResizable=="boolean"?j.isResizable:!j.static&&G,Y=j.resizeHandles||D,he=Q&&B&&j.isBounded!==!1;return s.createElement(o.default,{containerWidth:k,cols:A,margin:R,containerPadding:M||R,maxRows:I,rowHeight:P,cancel:$,handle:W,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:Q,isResizable:_,isBounded:he,useCSSTransforms:F&&Z,usePercentages:!Z,transformScale:z,w:j.w,h:j.h,x:j.x,y:j.y,i:j.i,minH:j.minH,minW:j.minW,maxH:j.maxH,maxW:j.maxW,static:j.static,droppingPosition:E?fe:void 0,resizeHandles:Y,resizeHandle:oe},T)}render(){const{className:T,style:E,isDroppable:j,innerRef:k}=this.props,A=(0,r.default)(b,T),R=f({height:this.containerHeight()},E);return s.createElement("div",{ref:k,className:A,style:R,onDrop:j?this.onDrop:n.noop,onDragLeave:j?this.onDragLeave:n.noop,onDragEnter:j?this.onDragEnter:n.noop,onDragOver:j?this.onDragOver:n.noop},s.Children.map(this.props.children,M=>this.processGridItem(M)),j&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}};return Qu.default=y,h(y,"displayName","ReactGridLayout"),h(y,"propTypes",a.default),h(y,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:n.noop,onDragStart:n.noop,onDrag:n.noop,onDragStop:n.noop,onResizeStart:n.noop,onResize:n.noop,onResizeStop:n.noop,onDrop:n.noop,onDropDragOver:n.noop}),Qu}var op={},Xl={},Mj;function v2(){if(Mj)return Xl;Mj=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.findOrGenerateResponsiveLayout=n,Xl.getBreakpointFromWidth=e,Xl.getColsFromBreakpoint=r,Xl.sortBreakpoints=i;var s=Yd();function e(o,a){const l=i(o);let d=l[0];for(let p=1,f=l.length;p<f;p++){const h=l[p];a>o[h]&&(d=h)}return d}function r(o,a){if(!a[o])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+o+" is missing!");return a[o]}function n(o,a,l,d,p,f){if(o[l])return(0,s.cloneLayout)(o[l]);let h=o[d];const x=i(a),m=x.slice(x.indexOf(l));for(let b=0,w=m.length;b<w;b++){const y=m[b];if(o[y]){h=o[y];break}}return h=(0,s.cloneLayout)(h||[]),(0,s.compact)((0,s.correctBounds)(h,{cols:p}),f,p)}function i(o){return Object.keys(o).sort(function(l,d){return o[l]-o[d]})}return Xl}var Bj;function IW(){if(Bj)return op;Bj=1,Object.defineProperty(op,"__esModule",{value:!0}),op.default=void 0;var s=d(po()),e=l(kl()),r=xv(),n=Yd(),i=v2(),o=l(b2());const a=["breakpoint","breakpoints","cols","layouts","margin","containerPadding","onBreakpointChange","onLayoutChange","onWidthChange"];function l(j){return j&&j.__esModule?j:{default:j}}function d(j,k){if(typeof WeakMap=="function")var A=new WeakMap,R=new WeakMap;return(d=function(M,P){if(!P&&M&&M.__esModule)return M;var I,O,G={__proto__:null,default:M};if(M===null||typeof M!="object"&&typeof M!="function")return G;if(I=P?R:A){if(I.has(M))return I.get(M);I.set(M,G)}for(const B in M)B!=="default"&&{}.hasOwnProperty.call(M,B)&&((O=(I=Object.defineProperty)&&Object.getOwnPropertyDescriptor(M,B))&&(O.get||O.set)?I(G,B,O):G[B]=M[B]);return G})(j,k)}function p(){return p=Object.assign?Object.assign.bind():function(j){for(var k=1;k<arguments.length;k++){var A=arguments[k];for(var R in A)({}).hasOwnProperty.call(A,R)&&(j[R]=A[R])}return j},p.apply(null,arguments)}function f(j,k){if(j==null)return{};var A,R,M=h(j,k);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(j);for(R=0;R<P.length;R++)A=P[R],k.indexOf(A)===-1&&{}.propertyIsEnumerable.call(j,A)&&(M[A]=j[A])}return M}function h(j,k){if(j==null)return{};var A={};for(var R in j)if({}.hasOwnProperty.call(j,R)){if(k.indexOf(R)!==-1)continue;A[R]=j[R]}return A}function x(j,k){var A=Object.keys(j);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(j);k&&(R=R.filter(function(M){return Object.getOwnPropertyDescriptor(j,M).enumerable})),A.push.apply(A,R)}return A}function m(j){for(var k=1;k<arguments.length;k++){var A=arguments[k]!=null?arguments[k]:{};k%2?x(Object(A),!0).forEach(function(R){b(j,R,A[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(j,Object.getOwnPropertyDescriptors(A)):x(Object(A)).forEach(function(R){Object.defineProperty(j,R,Object.getOwnPropertyDescriptor(A,R))})}return j}function b(j,k,A){return(k=w(k))in j?Object.defineProperty(j,k,{value:A,enumerable:!0,configurable:!0,writable:!0}):j[k]=A,j}function w(j){var k=y(j,"string");return typeof k=="symbol"?k:k+""}function y(j,k){if(typeof j!="object"||!j)return j;var A=j[Symbol.toPrimitive];if(A!==void 0){var R=A.call(j,k);if(typeof R!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(j)}const C=j=>Object.prototype.toString.call(j);function T(j,k){return j==null?null:Array.isArray(j)?j:j[k]}let E=class extends s.Component{constructor(){super(...arguments),b(this,"state",this.generateInitialState()),b(this,"onLayoutChange",k=>{this.props.onLayoutChange(k,m(m({},this.props.layouts),{},{[this.state.breakpoint]:k}))})}generateInitialState(){const{width:k,breakpoints:A,layouts:R,cols:M}=this.props,P=(0,i.getBreakpointFromWidth)(A,k),I=(0,i.getColsFromBreakpoint)(P,M),O=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,i.findOrGenerateResponsiveLayout)(R,A,P,P,I,O),breakpoint:P,cols:I}}static getDerivedStateFromProps(k,A){if(!(0,r.deepEqual)(k.layouts,A.layouts)){const{breakpoint:R,cols:M}=A;return{layout:(0,i.findOrGenerateResponsiveLayout)(k.layouts,k.breakpoints,R,R,M,k.compactType),layouts:k.layouts}}return null}componentDidUpdate(k){(this.props.width!=k.width||this.props.breakpoint!==k.breakpoint||!(0,r.deepEqual)(this.props.breakpoints,k.breakpoints)||!(0,r.deepEqual)(this.props.cols,k.cols))&&this.onWidthChange(k)}onWidthChange(k){const{breakpoints:A,cols:R,layouts:M,compactType:P}=this.props,I=this.props.breakpoint||(0,i.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),O=this.state.breakpoint,G=(0,i.getColsFromBreakpoint)(I,R),B=m({},M);if(O!==I||k.breakpoints!==A||k.cols!==R){O in B||(B[O]=(0,n.cloneLayout)(this.state.layout));let $=(0,i.findOrGenerateResponsiveLayout)(B,A,I,O,G,P);$=(0,n.synchronizeLayoutWithChildren)($,this.props.children,G,P,this.props.allowOverlap),B[I]=$,this.props.onBreakpointChange(I,G),this.props.onLayoutChange($,B),this.setState({breakpoint:I,layout:$,cols:G})}const F=T(this.props.margin,I),z=T(this.props.containerPadding,I);this.props.onWidthChange(this.props.width,F,G,z)}render(){const k=this.props,{breakpoint:A,breakpoints:R,cols:M,layouts:P,margin:I,containerPadding:O,onBreakpointChange:G,onLayoutChange:B,onWidthChange:F}=k,z=f(k,a);return s.createElement(o.default,p({},z,{margin:T(I,this.state.breakpoint),containerPadding:T(O,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}};return op.default=E,b(E,"propTypes",{breakpoint:e.default.string,breakpoints:e.default.object,allowOverlap:e.default.bool,cols:e.default.object,margin:e.default.oneOfType([e.default.array,e.default.object]),containerPadding:e.default.oneOfType([e.default.array,e.default.object]),layouts(j,k){if(C(j[k])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+C(j[k]));Object.keys(j[k]).forEach(A=>{if(!(A in j.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,n.validateLayout)(j.layouts[A],"layouts."+A)})},width:e.default.number.isRequired,onBreakpointChange:e.default.func,onLayoutChange:e.default.func,onWidthChange:e.default.func}),b(E,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:n.noop,onLayoutChange:n.noop,onWidthChange:n.noop}),op}var kf={},S2=(function(){if(typeof Map<"u")return Map;function s(e,r){var n=-1;return e.some(function(i,o){return i[0]===r?(n=o,!0):!1}),n}return(function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(r){var n=s(this.__entries__,r),i=this.__entries__[n];return i&&i[1]},e.prototype.set=function(r,n){var i=s(this.__entries__,r);~i?this.__entries__[i][1]=n:this.__entries__.push([r,n])},e.prototype.delete=function(r){var n=this.__entries__,i=s(n,r);~i&&n.splice(i,1)},e.prototype.has=function(r){return!!~s(this.__entries__,r)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(r,n){n===void 0&&(n=null);for(var i=0,o=this.__entries__;i<o.length;i++){var a=o[i];r.call(n,a[1],a[0])}},e})()})(),pb=typeof window<"u"&&typeof document<"u"&&window.document===document,wg=(function(){return typeof globalThis<"u"&&globalThis.Math===Math?globalThis:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()})(),PW=(function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(wg):function(s){return setTimeout(function(){return s(Date.now())},1e3/60)}})(),LW=2;function zW(s,e){var r=!1,n=!1,i=0;function o(){r&&(r=!1,s()),n&&l()}function a(){PW(o)}function l(){var d=Date.now();if(r){if(d-i<LW)return;n=!0}else r=!0,n=!1,setTimeout(a,e);i=d}return l}var MW=20,BW=["top","right","bottom","left","width","height","size","weight"],FW=typeof MutationObserver<"u",$W=(function(){function s(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=zW(this.refresh.bind(this),MW)}return s.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},s.prototype.removeObserver=function(e){var r=this.observers_,n=r.indexOf(e);~n&&r.splice(n,1),!r.length&&this.connected_&&this.disconnect_()},s.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},s.prototype.updateObservers_=function(){var e=this.observers_.filter(function(r){return r.gatherActive(),r.hasActive()});return e.forEach(function(r){return r.broadcastActive()}),e.length>0},s.prototype.connect_=function(){!pb||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),FW?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},s.prototype.disconnect_=function(){!pb||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},s.prototype.onTransitionEnd_=function(e){var r=e.propertyName,n=r===void 0?"":r,i=BW.some(function(o){return!!~n.indexOf(o)});i&&this.refresh()},s.getInstance=function(){return this.instance_||(this.instance_=new s),this.instance_},s.instance_=null,s})(),w2=(function(s,e){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];Object.defineProperty(s,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return s}),Pd=(function(s){var e=s&&s.ownerDocument&&s.ownerDocument.defaultView;return e||wg}),E2=cx(0,0,0,0);function Eg(s){return parseFloat(s)||0}function Fj(s){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.reduce(function(n,i){var o=s["border-"+i+"-width"];return n+Eg(o)},0)}function GW(s){for(var e=["top","right","bottom","left"],r={},n=0,i=e;n<i.length;n++){var o=i[n],a=s["padding-"+o];r[o]=Eg(a)}return r}function UW(s){var e=s.getBBox();return cx(0,0,e.width,e.height)}function WW(s){var e=s.clientWidth,r=s.clientHeight;if(!e&&!r)return E2;var n=Pd(s).getComputedStyle(s),i=GW(n),o=i.left+i.right,a=i.top+i.bottom,l=Eg(n.width),d=Eg(n.height);if(n.boxSizing==="border-box"&&(Math.round(l+o)!==e&&(l-=Fj(n,"left","right")+o),Math.round(d+a)!==r&&(d-=Fj(n,"top","bottom")+a)),!HW(s)){var p=Math.round(l+o)-e,f=Math.round(d+a)-r;Math.abs(p)!==1&&(l-=p),Math.abs(f)!==1&&(d-=f)}return cx(i.left,i.top,l,d)}var qW=(function(){return typeof SVGGraphicsElement<"u"?function(s){return s instanceof Pd(s).SVGGraphicsElement}:function(s){return s instanceof Pd(s).SVGElement&&typeof s.getBBox=="function"}})();function HW(s){return s===Pd(s).document.documentElement}function YW(s){return pb?qW(s)?UW(s):WW(s):E2}function KW(s){var e=s.x,r=s.y,n=s.width,i=s.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(o.prototype);return w2(a,{x:e,y:r,width:n,height:i,top:r,right:e+n,bottom:i+r,left:e}),a}function cx(s,e,r,n){return{x:s,y:e,width:r,height:n}}var VW=(function(){function s(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=cx(0,0,0,0),this.target=e}return s.prototype.isActive=function(){var e=YW(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},s.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},s})(),XW=(function(){function s(e,r){var n=KW(r);w2(this,{target:e,contentRect:n})}return s})(),JW=(function(){function s(e,r,n){if(this.activeObservations_=[],this.observations_=new S2,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=r,this.callbackCtx_=n}return s.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Pd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(e)||(r.set(e,new VW(e)),this.controller_.addObserver(this),this.controller_.refresh())}},s.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof Pd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var r=this.observations_;r.has(e)&&(r.delete(e),r.size||this.controller_.removeObserver(this))}},s.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},s.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(r){r.isActive()&&e.activeObservations_.push(r)})},s.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,r=this.activeObservations_.map(function(n){return new XW(n.target,n.broadcastRect())});this.callback_.call(e,r,e),this.clearActive()}},s.prototype.clearActive=function(){this.activeObservations_.splice(0)},s.prototype.hasActive=function(){return this.activeObservations_.length>0},s})(),C2=typeof WeakMap<"u"?new WeakMap:new S2,j2=(function(){function s(e){if(!(this instanceof s))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=$W.getInstance(),n=new JW(e,r,this);C2.set(this,n)}return s})();["observe","unobserve","disconnect"].forEach(function(s){j2.prototype[s]=function(){var e;return(e=C2.get(this))[s].apply(e,arguments)}});var QW=(function(){return typeof wg.ResizeObserver<"u"?wg.ResizeObserver:j2})(),$j;function ZW(){if($j)return kf;$j=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.default=b;var s=a(po()),e=o(kl()),r=o(QW),n=o(ax());const i=["measureBeforeMount"];function o(w){return w&&w.__esModule?w:{default:w}}function a(w,y){if(typeof WeakMap=="function")var C=new WeakMap,T=new WeakMap;return(a=function(E,j){if(!j&&E&&E.__esModule)return E;var k,A,R={__proto__:null,default:E};if(E===null||typeof E!="object"&&typeof E!="function")return R;if(k=j?T:C){if(k.has(E))return k.get(E);k.set(E,R)}for(const M in E)M!=="default"&&{}.hasOwnProperty.call(E,M)&&((A=(k=Object.defineProperty)&&Object.getOwnPropertyDescriptor(E,M))&&(A.get||A.set)?k(R,M,A):R[M]=E[M]);return R})(w,y)}function l(){return l=Object.assign?Object.assign.bind():function(w){for(var y=1;y<arguments.length;y++){var C=arguments[y];for(var T in C)({}).hasOwnProperty.call(C,T)&&(w[T]=C[T])}return w},l.apply(null,arguments)}function d(w,y){if(w==null)return{};var C,T,E=p(w,y);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(w);for(T=0;T<j.length;T++)C=j[T],y.indexOf(C)===-1&&{}.propertyIsEnumerable.call(w,C)&&(E[C]=w[C])}return E}function p(w,y){if(w==null)return{};var C={};for(var T in w)if({}.hasOwnProperty.call(w,T)){if(y.indexOf(T)!==-1)continue;C[T]=w[T]}return C}function f(w,y,C){return(y=h(y))in w?Object.defineProperty(w,y,{value:C,enumerable:!0,configurable:!0,writable:!0}):w[y]=C,w}function h(w){var y=x(w,"string");return typeof y=="symbol"?y:y+""}function x(w,y){if(typeof w!="object"||!w)return w;var C=w[Symbol.toPrimitive];if(C!==void 0){var T=C.call(w,y);if(typeof T!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(y==="string"?String:Number)(w)}const m="react-grid-layout";function b(w){var y;return y=class extends s.Component{constructor(){super(...arguments),f(this,"state",{width:1280}),f(this,"elementRef",s.createRef()),f(this,"mounted",!1),f(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new r.default(E=>{if(this.elementRef.current instanceof HTMLElement){const k=E[0].contentRect.width;this.setState({width:k})}});const T=this.elementRef.current;T instanceof HTMLElement&&this.resizeObserver.observe(T)}componentWillUnmount(){this.mounted=!1;const T=this.elementRef.current;T instanceof HTMLElement&&this.resizeObserver.unobserve(T),this.resizeObserver.disconnect()}render(){const T=this.props,{measureBeforeMount:E}=T,j=d(T,i);return E&&!this.mounted?s.createElement("div",{className:(0,n.default)(this.props.className,m),style:this.props.style,ref:this.elementRef}):s.createElement(w,l({innerRef:this.elementRef},j,this.state))}},f(y,"defaultProps",{measureBeforeMount:!1}),f(y,"propTypes",{measureBeforeMount:e.default.bool}),y}return kf}var Gj;function eq(){return Gj||(Gj=1,(function(s){s.exports=b2().default,s.exports.utils=Yd(),s.exports.calculateUtils=mv(),s.exports.Responsive=IW().default,s.exports.Responsive.utils=v2(),s.exports.WidthProvider=ZW().default})(n0)),n0.exports}var tq=eq();const Xo=({title:s,onRemove:e,onRefresh:r,onConfigure:n,children:i,isLoading:o=!1,error:a=null,headerColor:l})=>{const{colors:d,fontSize:p}=Er(),f=l||d.primary,h=parseInt(p.body)||12,x=`${Math.max(h-1,9)}px`,m=`${Math.max(h-2,8)}px`;return t.jsxs("div",{style:{height:"100%",width:"100%",backgroundColor:"#000000",border:`1px solid ${d.textMuted||"#787878"}`,display:"flex",flexDirection:"column",overflow:"hidden",fontSize:`${h}px`},children:[t.jsxs("div",{style:{backgroundColor:"#1a1a1a",borderBottom:`1px solid ${d.textMuted||"#787878"}`,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"space-between",minHeight:"28px",flexShrink:0},children:[t.jsx("div",{className:"widget-drag-handle",style:{color:f,fontSize:x,fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"move",flex:1,userSelect:"none"},children:s}),t.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[n&&t.jsx("button",{onClick:n,style:{background:"none",border:"none",color:d.textMuted||"#787878",cursor:"pointer",padding:"2px",display:"flex",alignItems:"center"},onMouseEnter:b=>b.currentTarget.style.color=d.text||"#FFFFFF",onMouseLeave:b=>b.currentTarget.style.color=d.textMuted||"#787878",title:"Configure",children:t.jsx(Mn,{size:12})}),r&&t.jsx("button",{onClick:r,disabled:o,style:{background:"none",border:"none",color:o?d.textMuted||"#787878":d.text||"#FFFFFF",cursor:o?"not-allowed":"pointer",padding:"2px",display:"flex",alignItems:"center"},onMouseEnter:b=>!o&&(b.currentTarget.style.color=f),onMouseLeave:b=>!o&&(b.currentTarget.style.color=d.text||"#FFFFFF"),title:"Refresh",children:t.jsx(xn,{size:12,style:{animation:o?"spin 1s linear infinite":"none"}})}),e&&t.jsx("button",{onClick:e,style:{background:"none",border:"none",color:d.textMuted||"#787878",cursor:"pointer",padding:"2px",display:"flex",alignItems:"center"},onMouseEnter:b=>b.currentTarget.style.color=d.alert||"#FF0000",onMouseLeave:b=>b.currentTarget.style.color=d.textMuted||"#787878",title:"Remove",children:t.jsx(ln,{size:12})})]})]}),t.jsx("div",{style:{flex:1,overflow:"auto",position:"relative",fontSize:m},children:a?t.jsxs("div",{style:{padding:"12px",color:d.alert||"#FF0000",fontSize:m,textAlign:"center"},children:["Error: ",a]}):o?t.jsx("div",{style:{padding:"12px",color:d.textMuted||"#787878",fontSize:m,textAlign:"center"},children:"Loading..."}):i}),t.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})},Cg=[{name:"Yahoo Finance",url:"https://finance.yahoo.com/news/rssindex",category:"MARKETS",region:"US",source:"YAHOO"},{name:"Investing.com",url:"https://www.investing.com/rss/news.rss",category:"MARKETS",region:"GLOBAL",source:"INVESTING.COM"},{name:"CoinDesk",url:"https://www.coindesk.com/arc/outboundfeeds/rss/",category:"CRYPTO",region:"GLOBAL",source:"COINDESK"},{name:"CoinTelegraph",url:"https://cointelegraph.com/rss",category:"CRYPTO",region:"GLOBAL",source:"COINTELEGRAPH"},{name:"Decrypt",url:"https://decrypt.co/feed",category:"CRYPTO",region:"GLOBAL",source:"DECRYPT"},{name:"TechCrunch",url:"https://techcrunch.com/feed/",category:"TECH",region:"US",source:"TECHCRUNCH"},{name:"The Verge",url:"https://www.theverge.com/rss/index.xml",category:"TECH",region:"US",source:"THE VERGE"},{name:"Ars Technica",url:"https://feeds.arstechnica.com/arstechnica/index",category:"TECH",region:"US",source:"ARS TECHNICA"},{name:"Oil Price",url:"https://oilprice.com/rss/main",category:"ENERGY",region:"GLOBAL",source:"OILPRICE"}],Uj=["https://api.allorigins.win/raw?url=","https://api.codetabs.com/v1/proxy?quest=","https://corsproxy.io/?","https://proxy.cors.sh/","https://api.allorigins.win/get?url="];function rq(s,e){const r=[];try{if(!s||s.trim().length===0||!s.trim().startsWith("<"))return r;const i=new DOMParser().parseFromString(s,"text/xml");if(i.querySelector("parsererror"))return r;i.querySelectorAll("item, entry").forEach((l,d)=>{try{const p=l.querySelector("title")?.textContent||"",f=l.querySelector("description, summary")?.textContent||"",h=l.querySelector("link")?.textContent||l.querySelector("link")?.getAttribute("href")||"",x=l.querySelector("pubDate, published, updated")?.textContent||"";if(!p)return;const m=x?new Date(x):new Date,b=m.toLocaleTimeString("en-US",{hour12:!1}),w=/\b[A-Z]{1,5}\b/g,y=(p+" "+f).match(w)||[],C=[...new Set(y.slice(0,5))];let T="ROUTINE";const E=p.toLowerCase();E.includes("breaking")||E.includes("alert")?T="FLASH":E.includes("urgent")||E.includes("emergency")?T="URGENT":(E.includes("announce")||E.includes("report"))&&(T="BREAKING");let j="NEUTRAL";const k=(p+" "+f).toLowerCase(),A=["surge","rally","gain","beat","growth","up","rise","jump","soar","high","record"],R=["fall","drop","decline","loss","down","crash","plunge","miss","weak","low"],M=A.filter(G=>k.includes(G)).length,P=R.filter(G=>k.includes(G)).length;M>P&&M>0?j="BULLISH":P>M&&P>0&&(j="BEARISH");let I="LOW";T==="FLASH"||T==="URGENT"?I="HIGH":T==="BREAKING"&&(I="MEDIUM");let O=e.category;k.includes("earnings")||k.includes("profit")||k.includes("revenue")?O="EARNINGS":k.includes("fed")||k.includes("inflation")||k.includes("gdp")||k.includes("jobs")?O="ECONOMIC":k.includes("tech")||k.includes("ai")||k.includes("software")||k.includes("cloud")?O="TECH":k.includes("energy")||k.includes("oil")||k.includes("gas")||k.includes("opec")?O="ENERGY":k.includes("bank")||k.includes("financial")||k.includes("credit")?O="BANKING":k.includes("crypto")||k.includes("bitcoin")||k.includes("ethereum")||k.includes("blockchain")?O="CRYPTO":(k.includes("china")||k.includes("russia")||k.includes("ukraine")||k.includes("war"))&&(O="GEOPOLITICS"),r.push({id:`${e.source}-${Date.now()}-${d}`,time:b,priority:T,category:O,headline:p.slice(0,200),summary:f.slice(0,300).replace(/<[^>]*>/g,""),source:e.source,region:e.region,sentiment:j,impact:I,tickers:C,classification:"PUBLIC",link:h,pubDate:m})}catch{}})}catch{}return r}async function nq(s){for(let e=0;e<Uj.length;e++)try{const r=Uj[e],n=`${r}${encodeURIComponent(s.url)}`,i=new AbortController,o=setTimeout(()=>i.abort(),15e3),a=await tn(n,{headers:{Accept:"application/rss+xml, application/xml, text/xml, */*"},signal:i.signal});if(clearTimeout(o),!a.ok)continue;let l=await a.text();if(r.includes("allorigins.win/get"))try{l=JSON.parse(l).contents||l}catch{}if(!l||!l.trim().startsWith("<"))continue;const d=rq(l,s);if(d.length>0)return d}catch{continue}return[]}async function sq(){const s=[];for(let r=0;r<Cg.length;r+=5){const i=Cg.slice(r,r+5).map(a=>nq(a));(await Promise.allSettled(i)).forEach(a=>{a.status==="fulfilled"&&a.value.length>0&&s.push(...a.value)})}return s.sort((r,n)=>{const i=r.pubDate||new Date(0);return(n.pubDate||new Date(0)).getTime()-i.getTime()}),s}let zo=[],Af=0;const iq=600*1e3;let Xf=!1;async function hb(s=!1){const e=Date.now();if(!s&&zo.length>0&&e-Af<iq)return zo;try{const r=await sq();return r.length>0?(zo=r,Xf=!1,Af=Date.now(),zo):(zo.length===0&&(zo=Wj(),Xf=!0,Af=Date.now()),zo)}catch{return zo.length===0&&(zo=Wj(),Xf=!0,Af=Date.now()),zo}}function oq(){return Xf}function o0(){return Cg.length}function ap(){return Cg.map(s=>s.source)}function Wj(){return[{id:"mock-1",time:new Date().toLocaleTimeString("en-US",{hour12:!1}),priority:"FLASH",category:"MARKETS",headline:"BREAKING: S&P 500 Reaches All-Time High on Strong Tech Earnings",summary:"The S&P 500 index surged to a record high today as major technology companies reported better-than-expected quarterly earnings. Investors are optimistic about continued growth in the AI and cloud computing sectors.",source:"REUTERS",region:"US",sentiment:"BULLISH",impact:"HIGH",tickers:["SPY","AAPL","MSFT","GOOGL"],classification:"PUBLIC",link:"https://www.reuters.com",pubDate:new Date},{id:"mock-2",time:new Date(Date.now()-3e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"URGENT",category:"ECONOMIC",headline:"Federal Reserve Signals Potential Rate Cut in Q4 2025",summary:"Fed Chairman indicated in today's speech that the central bank is considering interest rate adjustments based on recent inflation data showing continued cooling in consumer prices.",source:"WSJ",region:"US",sentiment:"BULLISH",impact:"HIGH",tickers:["TLT","IEF","SHY"],classification:"PUBLIC",link:"https://www.wsj.com",pubDate:new Date(Date.now()-3e5)},{id:"mock-3",time:new Date(Date.now()-6e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"BREAKING",category:"EARNINGS",headline:"Apple Reports Record iPhone Sales, Beats Estimates",summary:"Apple Inc. posted quarterly revenue of $89.5 billion, exceeding analyst expectations. iPhone sales drove the growth with strong demand in China and India markets.",source:"CNBC",region:"US",sentiment:"BULLISH",impact:"MEDIUM",tickers:["AAPL"],classification:"PUBLIC",link:"https://www.cnbc.com",pubDate:new Date(Date.now()-6e5)},{id:"mock-4",time:new Date(Date.now()-9e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"BREAKING",category:"CRYPTO",headline:"Bitcoin Surges Past $75,000 on ETF Inflows",summary:"Bitcoin reached a new milestone as institutional investors continue pouring money into spot Bitcoin ETFs. Total crypto market cap exceeds $2.5 trillion.",source:"COINDESK",region:"GLOBAL",sentiment:"BULLISH",impact:"MEDIUM",tickers:["BTC","ETH"],classification:"PUBLIC",link:"https://www.coindesk.com",pubDate:new Date(Date.now()-9e5)},{id:"mock-5",time:new Date(Date.now()-12e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"ROUTINE",category:"ENERGY",headline:"Oil Prices Steady as OPEC+ Maintains Production Levels",summary:"Crude oil futures traded flat as OPEC+ announced it will maintain current production quotas through the end of the year. WTI crude at $78.50/barrel.",source:"OILPRICE",region:"GLOBAL",sentiment:"NEUTRAL",impact:"LOW",tickers:["USO","XLE"],classification:"PUBLIC",link:"https://oilprice.com",pubDate:new Date(Date.now()-12e5)},{id:"mock-6",time:new Date(Date.now()-15e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"BREAKING",category:"TECH",headline:"Microsoft Unveils Advanced AI Models for Enterprise",summary:"Microsoft announced new AI capabilities integrated into Azure cloud platform, targeting enterprise customers with enhanced automation and analytics tools.",source:"TECHCRUNCH",region:"US",sentiment:"BULLISH",impact:"MEDIUM",tickers:["MSFT"],classification:"PUBLIC",link:"https://techcrunch.com",pubDate:new Date(Date.now()-15e5)},{id:"mock-7",time:new Date(Date.now()-18e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"URGENT",category:"BANKING",headline:"JPMorgan Chase Reports Strong Q3 Results, Raises Guidance",summary:"JPMorgan posted net income of $13.2 billion for the quarter, driven by robust investment banking and trading revenue. Bank raised full-year earnings guidance.",source:"MARKETWATCH",region:"US",sentiment:"BULLISH",impact:"HIGH",tickers:["JPM","BAC","XLF"],classification:"PUBLIC",link:"https://www.marketwatch.com",pubDate:new Date(Date.now()-18e5)},{id:"mock-8",time:new Date(Date.now()-21e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"ROUTINE",category:"MARKETS",headline:"European Markets Close Mixed on Economic Data",summary:"European stock indices ended the session with mixed results. FTSE 100 up 0.3%, DAX down 0.2% as investors digest latest GDP figures from Germany and France.",source:"INVESTING.COM",region:"EUROPE",sentiment:"NEUTRAL",impact:"LOW",tickers:["EWG","EWU","VGK"],classification:"PUBLIC",link:"https://www.investing.com",pubDate:new Date(Date.now()-21e5)},{id:"mock-9",time:new Date(Date.now()-24e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"BREAKING",category:"GEOPOLITICS",headline:"US-China Trade Talks Resume, Markets Rally",summary:"Renewed trade negotiations between Washington and Beijing boosted investor sentiment. Both sides expressed optimism about reaching a comprehensive trade agreement.",source:"REUTERS",region:"GLOBAL",sentiment:"BULLISH",impact:"MEDIUM",tickers:["FXI","MCHI","SPY"],classification:"PUBLIC",link:"https://www.reuters.com",pubDate:new Date(Date.now()-24e5)},{id:"mock-10",time:new Date(Date.now()-27e5).toLocaleTimeString("en-US",{hour12:!1}),priority:"ROUTINE",category:"EARNINGS",headline:"Tesla Misses Delivery Targets Despite Production Increase",summary:"Tesla reported Q3 deliveries below analyst expectations despite ramping up production. Stock declined 3% in after-hours trading on the news.",source:"CNBC",region:"US",sentiment:"BEARISH",impact:"MEDIUM",tickers:["TSLA"],classification:"PUBLIC",link:"https://www.cnbc.com",pubDate:new Date(Date.now()-27e5)}]}const aq=({id:s,category:e="ALL",limit:r=5,onRemove:n})=>{const{colors:i,fontSize:o}=Er(),[a,l]=S.useState([]),[d,p]=S.useState(!0),[f,h]=S.useState(null),x=o.small,m=o.tiny,b=o.tiny,w=async()=>{p(!0),h(null);try{const C=await hb(),T=e==="ALL"?C:C.filter(E=>E.category===e);l(T.slice(0,r))}catch(C){h(C instanceof Error?C.message:"Failed to load news")}finally{p(!1)}};S.useEffect(()=>{w();const C=setInterval(w,300*1e3);return()=>clearInterval(C)},[e,r]);const y=C=>{switch(C){case"FLASH":case"URGENT":return i.alert;case"BREAKING":return i.warning;default:return i.textMuted}};return t.jsx(Xo,{id:s,title:`NEWS - ${e}`,onRemove:n,onRefresh:w,isLoading:d,error:f,children:t.jsxs("div",{style:{padding:"8px"},children:[a.map((C,T)=>t.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"8px",borderBottom:T<a.length-1?`1px solid ${i.textMuted}`:"none"},children:[t.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"2px",fontSize:b},children:[t.jsxs("span",{style:{color:y(C.priority),fontWeight:"bold"},children:["[",C.priority,"]"]}),t.jsxs("span",{style:{color:i.info},children:["[",C.category,"]"]}),t.jsx("span",{style:{color:i.textMuted},children:C.time})]}),t.jsx("div",{style:{color:i.text,fontSize:x,fontWeight:"bold",marginBottom:"2px",lineHeight:"1.2"},children:C.headline}),t.jsxs("div",{style:{color:i.textMuted,fontSize:m,lineHeight:"1.2"},children:[C.summary.substring(0,100),"..."]}),t.jsx("div",{style:{color:i.textMuted,fontSize:b,marginTop:"2px"},children:C.source})]},C.id)),a.length===0&&!d&&!f&&t.jsx("div",{style:{color:i.textMuted,fontSize:x,textAlign:"center",padding:"12px"},children:"No news available"})]})})};class lq{constructor(){Pe(this,"isAvailable",null)}async checkHealth(){try{const e=await lt("check_market_data_health");return this.isAvailable=e,e}catch(e){return yo.error("Health check failed:",e),this.isAvailable=!1,!1}}async getQuote(e){try{const r=await lt("get_market_quote",{symbol:e});return r.success&&r.data?r.data:(yo.warn(`Failed to fetch quote for ${e}:`,r.error),null)}catch(r){return yo.error(`Error fetching quote for ${e}:`,r),null}}async getQuotes(e){try{const r=await lt("get_market_quotes",{symbols:e});return r.success?r.data:(yo.warn("Failed to fetch quotes:",r.error),[])}catch(r){return yo.error("Error fetching quotes:",r),[]}}async getPeriodReturns(e){try{const r=await lt("get_period_returns",{symbol:e});return r.success&&r.data?r.data:(yo.warn(`Failed to fetch returns for ${e}:`,r.error),null)}catch(r){return yo.error(`Error fetching returns for ${e}:`,r),null}}async getEnhancedQuote(e){const[r,n]=await Promise.all([this.getQuote(e),this.getPeriodReturns(e)]);return r?{...r,seven_day:n?.seven_day,thirty_day:n?.thirty_day}:null}async getEnhancedQuotes(e){const r=await this.getQuotes(e),n=e.map(o=>this.getPeriodReturns(o)),i=await Promise.all(n);return r.map((o,a)=>({...o,seven_day:i[a]?.seven_day,thirty_day:i[a]?.thirty_day}))}async getEnhancedQuotesWithCache(e,r,n=10){try{if(!Je.isReady())return yo.warn("Database not ready, fetching without cache"),await this.getEnhancedQuotes(e);const i=await Je.getCachedCategoryData(r,e,n),o=e.filter(d=>!i.has(d));if(o.length===0)return yo.debug(`Using cached data for ${e.length} symbols in ${r}`),e.map(d=>i.get(d));yo.debug(`Fetching ${o.length}/${e.length} symbols from API for ${r}`);const a=await this.getEnhancedQuotes(o);return await Promise.all(a.map(d=>Je.saveMarketDataCache(d.symbol,r,d))),e.map(d=>i.has(d)?i.get(d):a.find(f=>f.symbol===d)||null).filter(d=>d!==null)}catch(i){return yo.error("Cache error, falling back to direct fetch:",i),await this.getEnhancedQuotes(e)}}formatChange(e){return e>=0?`+${e.toFixed(2)}`:e.toFixed(2)}formatChangePercent(e){return e>=0?`+${e.toFixed(2)}%`:`${e.toFixed(2)}%`}isLikelyAvailable(){return this.isAvailable!==!1}}const Fi=new lq,cq=Object.freeze(Object.defineProperty({__proto__:null,marketDataService:Fi},Symbol.toStringTag,{value:"Module"})),a0="#FFFFFF",qj="#00C800",Hj="#FF0000",dq="#787878",uq=({id:s,category:e="Indices",tickers:r=["^GSPC","^IXIC","^DJI","^RUT"],onRemove:n})=>{const[i,o]=S.useState([]),[a,l]=S.useState(!0),[d,p]=S.useState(null),f=async()=>{l(!0),p(null);try{const m=await Fi.getEnhancedQuotesWithCache(r,e,10);o(m)}catch(m){p(m instanceof Error?m.message:"Failed to load market data")}finally{l(!1)}};S.useEffect(()=>{f();const m=setInterval(f,600*1e3);return()=>clearInterval(m)},[r.join(",")]);const h=m=>m>=0?`+${m.toFixed(2)}`:m.toFixed(2),x=m=>m>=0?`+${m.toFixed(2)}%`:`${m.toFixed(2)}%`;return t.jsx(Xo,{id:s,title:`MARKETS - ${e}`,onRemove:n,onRefresh:f,isLoading:a,error:d,children:t.jsxs("div",{style:{padding:"4px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:"9px",fontWeight:"bold",color:a0,borderBottom:`1px solid ${dq}`,padding:"4px 0",marginBottom:"4px"},children:[t.jsx("div",{children:"SYMBOL"}),t.jsx("div",{style:{textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHG"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"})]}),i.map((m,b)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:"9px",padding:"2px 0",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("div",{style:{color:a0},children:m.symbol}),t.jsx("div",{style:{color:a0,textAlign:"right"},children:m.price.toFixed(2)}),t.jsx("div",{style:{color:m.change>=0?qj:Hj,textAlign:"right"},children:h(m.change)}),t.jsx("div",{style:{color:m.change_percent>=0?qj:Hj,textAlign:"right"},children:x(m.change_percent)})]},b))]})})};class pq{constructor(){Pe(this,"db",null);Pe(this,"dbPath","sqlite:fincept_terminal.db");Pe(this,"isInitialized",!1)}async initialize(){if(!(this.isInitialized&&this.db))try{this.db=await Gg.load(this.dbPath),this.isInitialized=!0,Qc.info("Initialized successfully")}catch(e){throw Qc.error("Initialization failed:",e),e}}ensureInitialized(){if(!this.db||!this.isInitialized)throw new Error("WatchlistService not initialized. Call initialize() first.")}async createWatchlist(e,r,n="#FFA500"){this.ensureInitialized();const i=crypto.randomUUID();await this.db.execute(`INSERT INTO watchlists (id, name, description, color)
       VALUES ($1, $2, $3, $4)`,[i,e,r||null,n]);const o=await this.db.select("SELECT * FROM watchlists WHERE id = $1",[i]);return Qc.info(`Created watchlist: ${e}`,{id:i}),o[0]}async getWatchlists(){return this.ensureInitialized(),await this.db.select("SELECT * FROM watchlists ORDER BY created_at DESC")}async getWatchlist(e){this.ensureInitialized();const r=await this.db.select("SELECT * FROM watchlists WHERE id = $1",[e]);return r.length>0?r[0]:null}async updateWatchlist(e,r){this.ensureInitialized();const n=[],i=[];r.name!==void 0&&(n.push("name = $"+(i.length+1)),i.push(r.name)),r.description!==void 0&&(n.push("description = $"+(i.length+1)),i.push(r.description)),r.color!==void 0&&(n.push("color = $"+(i.length+1)),i.push(r.color)),n.length>0&&(n.push("updated_at = datetime('now')"),i.push(e),await this.db.execute(`UPDATE watchlists SET ${n.join(", ")} WHERE id = $${i.length}`,i))}async deleteWatchlist(e){this.ensureInitialized(),await this.db.execute("DELETE FROM watchlists WHERE id = $1",[e]),Qc.info(`Deleted watchlist: ${e}`)}async addStock(e,r,n){if(this.ensureInitialized(),(await this.db.select("SELECT * FROM watchlist_stocks WHERE watchlist_id = $1 AND symbol = $2",[e,r])).length>0)throw new Error(`Stock ${r} already exists in watchlist`);const o=crypto.randomUUID();await this.db.execute(`INSERT INTO watchlist_stocks (id, watchlist_id, symbol, notes)
       VALUES ($1, $2, $3, $4)`,[o,e,r.toUpperCase(),n||null]);const a=await this.db.select("SELECT * FROM watchlist_stocks WHERE id = $1",[o]);return Qc.info(`Added stock ${r} to watchlist`,{watchlistId:e}),a[0]}async removeStock(e,r){this.ensureInitialized(),await this.db.execute("DELETE FROM watchlist_stocks WHERE watchlist_id = $1 AND symbol = $2",[e,r.toUpperCase()]),Qc.info(`Removed stock ${r} from watchlist`,{watchlistId:e})}async updateStockNotes(e,r,n){this.ensureInitialized(),await this.db.execute("UPDATE watchlist_stocks SET notes = $1 WHERE watchlist_id = $2 AND symbol = $3",[n,e,r.toUpperCase()])}async getWatchlistStocks(e){return this.ensureInitialized(),await this.db.select("SELECT * FROM watchlist_stocks WHERE watchlist_id = $1 ORDER BY added_at DESC",[e])}async getWatchlistStocksWithQuotes(e){this.ensureInitialized();const r=await this.getWatchlistStocks(e);if(r.length===0)return[];const n=r.map(a=>a.symbol),i=await Fi.getEnhancedQuotesWithCache(n,`watchlist_${e}`,10),o=new Map;return i.forEach(a=>{o.set(a.symbol,a)}),r.map(a=>({...a,quote:o.get(a.symbol)||null}))}async getWatchlistWithStocks(e){this.ensureInitialized();const r=await this.getWatchlist(e);if(!r)return null;const n=await this.getWatchlistStocksWithQuotes(e);return{watchlist:r,stocks:n,stock_count:n.length}}async getWatchlistsWithCounts(){this.ensureInitialized();const e=await this.getWatchlists();return await Promise.all(e.map(async n=>{const i=await this.getWatchlistStocks(n.id);return{...n,stock_count:i.length}}))}async getMarketMovers(e=5){this.ensureInitialized();const r=await this.db.select("SELECT DISTINCT symbol FROM watchlist_stocks");if(r.length===0)return{gainers:[],losers:[]};const n=r.map(d=>d.symbol),o=(await Fi.getEnhancedQuotesWithCache(n,"market_movers",10)).sort((d,p)=>p.change_percent-d.change_percent),a=o.slice(0,e).map(d=>({id:"",watchlist_id:"",symbol:d.symbol,added_at:"",quote:d})),l=o.slice(-e).reverse().map(d=>({id:"",watchlist_id:"",symbol:d.symbol,added_at:"",quote:d}));return{gainers:a,losers:l}}async getVolumeLeaders(e=5){this.ensureInitialized();const r=await this.db.select("SELECT DISTINCT symbol FROM watchlist_stocks");if(r.length===0)return[];const n=r.map(a=>a.symbol);return(await Fi.getEnhancedQuotesWithCache(n,"volume_leaders",10)).filter(a=>a.volume!==void 0&&a.volume!==null).sort((a,l)=>(l.volume||0)-(a.volume||0)).slice(0,e).map(a=>({id:"",watchlist_id:"",symbol:a.symbol,added_at:"",quote:a}))}async exportWatchlistCSV(e){const r=await this.getWatchlistWithStocks(e);if(!r)throw new Error("Watchlist not found");let n=`Symbol,Price,Change,Change %,Volume,High,Low,Open,Prev Close,Notes
`;return r.stocks.forEach(i=>{const o=i.quote;o?n+=`${i.symbol},${o.price.toFixed(2)},${o.change.toFixed(2)},${o.change_percent.toFixed(2)},${o.volume||"N/A"},${o.high?.toFixed(2)||"N/A"},${o.low?.toFixed(2)||"N/A"},${o.open?.toFixed(2)||"N/A"},${o.previous_close?.toFixed(2)||"N/A"},"${i.notes||""}"
`:n+=`${i.symbol},N/A,N/A,N/A,N/A,N/A,N/A,N/A,N/A,"${i.notes||""}"
`}),n}isReady(){return this.isInitialized&&this.db!==null}getStatus(){return{initialized:this.isInitialized,ready:this.isReady()}}}const Zs=new pq,hq=({id:s,watchlistId:e,watchlistName:r="Watchlist",onRemove:n})=>{const{colors:i,fontSize:o}=Er(),[a,l]=S.useState([]),[d,p]=S.useState(!0),[f,h]=S.useState(null),x=o.small,m=async()=>{if(!e){h("No watchlist selected"),p(!1);return}p(!0),h(null);try{await Zs.initialize();const y=await Zs.getWatchlistStocksWithQuotes(e);l(y)}catch(y){h(y instanceof Error?y.message:"Failed to load watchlist")}finally{p(!1)}};S.useEffect(()=>{m();const y=setInterval(m,600*1e3);return()=>clearInterval(y)},[e]);const b=y=>y>=0?`+${y.toFixed(2)}`:y.toFixed(2),w=y=>y>=0?`+${y.toFixed(2)}%`:`${y.toFixed(2)}%`;return t.jsx(Xo,{id:s,title:`WATCHLIST - ${r}`,onRemove:n,onRefresh:m,isLoading:d,error:f,children:t.jsxs("div",{style:{padding:"4px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:x,fontWeight:"bold",color:i.text,borderBottom:`1px solid ${i.textMuted}`,padding:"4px 0",marginBottom:"4px"},children:[t.jsx("div",{children:"SYMBOL"}),t.jsx("div",{style:{textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHG"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"})]}),a.map((y,C)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:x,padding:"2px 0",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("div",{style:{color:i.accent},children:y.symbol}),t.jsx("div",{style:{color:i.text,textAlign:"right"},children:y.quote?.price?.toFixed(2)||"-"}),t.jsx("div",{style:{color:(y.quote?.change||0)>=0?i.secondary:i.alert,textAlign:"right"},children:y.quote?b(y.quote.change):"-"}),t.jsx("div",{style:{color:(y.quote?.change_percent||0)>=0?i.secondary:i.alert,textAlign:"right"},children:y.quote?w(y.quote.change_percent):"-"})]},C)),a.length===0&&!d&&!f&&t.jsx("div",{style:{color:i.textMuted,fontSize:x,textAlign:"center",padding:"12px"},children:"No stocks in watchlist"})]})})},fq=({id:s,categoryId:e,categoryName:r="Recent Posts",limit:n=5,onRemove:i})=>{const{colors:o,fontSize:a}=Er(),[l,d]=S.useState([]),[p,f]=S.useState(!0),[h,x]=S.useState(null),m=a.small,b=a.tiny,w=async()=>{f(!0),x(null);try{const y=localStorage.getItem("fincept_api_key")||void 0,C=localStorage.getItem("fincept_device_id")||void 0,T=e||1,E=await Qs.getPostsByCategory(T,"latest",n,y,C);if(E.success){const k=(E.data?.data?.posts||E.data?.posts||[]).map(A=>({id:A.post_uuid,title:A.title,author:A.author_display_name||"Anonymous",category:A.category_name||"General",likes:A.likes||0,replies:A.reply_count||0,time:new Date(A.created_at).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"})}));d(k)}else x(E.error||`HTTP ${E.status_code||"error"}`)}catch(y){x(y instanceof Error?y.message:"Failed to load forum posts")}finally{f(!1)}};return S.useEffect(()=>{w();const y=setInterval(w,600*1e3);return()=>clearInterval(y)},[e,n]),t.jsx(Xo,{id:s,title:`FORUM - ${r}`,onRemove:i,onRefresh:w,isLoading:p,error:h,children:t.jsxs("div",{style:{padding:"8px"},children:[l.map((y,C)=>t.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"8px",borderBottom:C<l.length-1?`1px solid ${o.textMuted}`:"none"},children:[t.jsxs("div",{style:{color:o.text,fontSize:m,fontWeight:"bold",marginBottom:"2px",lineHeight:"1.2"},children:[y.title.substring(0,60),y.title.length>60?"...":""]}),t.jsxs("div",{style:{display:"flex",gap:"8px",fontSize:b,color:o.textMuted},children:[t.jsxs("span",{style:{color:o.accent},children:["@",y.author]}),t.jsxs("span",{style:{color:o.info},children:["[",y.category,"]"]}),t.jsx("span",{children:y.time})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",fontSize:b,color:o.textMuted,marginTop:"2px"},children:[t.jsxs("span",{style:{color:o.secondary},children:[" ",y.likes]}),t.jsxs("span",{children:[" ",y.replies]})]})]},y.id)),l.length===0&&!p&&!h&&t.jsx("div",{style:{color:o.textMuted,fontSize:m,textAlign:"center",padding:"12px"},children:"No forum posts available"})]})})},gq=["BTC-USD","ETH-USD","BNB-USD","XRP-USD","ADA-USD","DOGE-USD","SOL-USD","DOT-USD","MATIC-USD","LTC-USD"],xq=({id:s,onRemove:e})=>{const{colors:r,fontSize:n}=Er(),[i,o]=S.useState([]),[a,l]=S.useState(!0),[d,p]=S.useState(null),f=n.small,h=async()=>{l(!0),p(null);try{const b=await Fi.getEnhancedQuotesWithCache(gq,"Crypto",10);o(b)}catch(b){p(b instanceof Error?b.message:"Failed to load crypto data")}finally{l(!1)}};S.useEffect(()=>{h();const b=setInterval(h,600*1e3);return()=>clearInterval(b)},[]);const x=b=>b>=0?`+${b.toFixed(2)}`:b.toFixed(2),m=b=>b>=0?`+${b.toFixed(2)}%`:`${b.toFixed(2)}%`;return t.jsx(Xo,{id:s,title:"CRYPTOCURRENCY MARKETS",onRemove:e,onRefresh:h,isLoading:a,error:d,children:t.jsxs("div",{style:{padding:"4px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,fontWeight:"bold",color:r.text,borderBottom:`1px solid ${r.textMuted}`,padding:"4px 0",marginBottom:"4px"},children:[t.jsx("div",{children:"SYMBOL"}),t.jsx("div",{style:{textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHG"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"})]}),i.map((b,w)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,padding:"2px 0",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("div",{style:{color:r.accent},children:b.symbol.replace("-USD","")}),t.jsxs("div",{style:{color:r.text,textAlign:"right"},children:["$",b.price.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),t.jsx("div",{style:{color:b.change>=0?r.secondary:r.alert,textAlign:"right"},children:x(b.change)}),t.jsx("div",{style:{color:b.change_percent>=0?r.secondary:r.alert,textAlign:"right"},children:m(b.change_percent)})]},w)),i.length===0&&!a&&!d&&t.jsx("div",{style:{color:r.textMuted,fontSize:f,textAlign:"center",padding:"12px"},children:"No crypto data available"})]})})},mq=["GC=F","SI=F","CL=F","HG=F","NG=F","ZC=F","ZS=F","KC=F"],yq={"GC=F":"Gold","SI=F":"Silver","CL=F":"Crude Oil","HG=F":"Copper","NG=F":"Nat Gas","ZC=F":"Corn","ZS=F":"Soybeans","KC=F":"Coffee"},bq=({id:s,onRemove:e})=>{const{colors:r,fontSize:n}=Er(),[i,o]=S.useState([]),[a,l]=S.useState(!0),[d,p]=S.useState(null),f=n.small,h=async()=>{l(!0),p(null);try{const b=await Fi.getEnhancedQuotesWithCache(mq,"Commodities",10);o(b)}catch(b){p(b instanceof Error?b.message:"Failed to load commodities")}finally{l(!1)}};S.useEffect(()=>{h();const b=setInterval(h,600*1e3);return()=>clearInterval(b)},[]);const x=b=>b>=0?`+${b.toFixed(2)}`:b.toFixed(2),m=b=>b>=0?`+${b.toFixed(2)}%`:`${b.toFixed(2)}%`;return t.jsx(Xo,{id:s,title:"COMMODITIES",onRemove:e,onRefresh:h,isLoading:a,error:d,children:t.jsxs("div",{style:{padding:"4px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,fontWeight:"bold",color:r.text,borderBottom:`1px solid ${r.textMuted}`,padding:"4px 0",marginBottom:"4px"},children:[t.jsx("div",{children:"COMMODITY"}),t.jsx("div",{style:{textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHG"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"})]}),i.map((b,w)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,padding:"2px 0",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("div",{style:{color:r.accent},children:yq[b.symbol]||b.symbol}),t.jsxs("div",{style:{color:r.text,textAlign:"right"},children:["$",b.price.toFixed(2)]}),t.jsx("div",{style:{color:b.change>=0?r.secondary:r.alert,textAlign:"right"},children:x(b.change)}),t.jsx("div",{style:{color:b.change_percent>=0?r.secondary:r.alert,textAlign:"right"},children:m(b.change_percent)})]},w)),i.length===0&&!a&&!d&&t.jsx("div",{style:{color:r.textMuted,fontSize:f,textAlign:"center",padding:"12px"},children:"No commodities data available"})]})})},vq=["^GSPC","^DJI","^IXIC","^RUT","^FTSE","^GDAXI","^FCHI","^N225","^HSI","000001.SS","^BSESN","^NSEI"],Sq={"^GSPC":"S&P 500","^DJI":"Dow Jones","^IXIC":"NASDAQ","^RUT":"Russell 2000","^FTSE":"FTSE 100","^GDAXI":"DAX","^FCHI":"CAC 40","^N225":"Nikkei 225","^HSI":"Hang Seng","000001.SS":"Shanghai","^BSESN":"Sensex","^NSEI":"Nifty 50"},wq=({id:s,onRemove:e})=>{const{colors:r,fontSize:n}=Er(),[i,o]=S.useState([]),[a,l]=S.useState(!0),[d,p]=S.useState(null),f=n.small,h=async()=>{l(!0),p(null);try{const b=await Fi.getEnhancedQuotesWithCache(vq,"Indices",10);o(b)}catch(b){p(b instanceof Error?b.message:"Failed to load indices")}finally{l(!1)}};S.useEffect(()=>{h();const b=setInterval(h,600*1e3);return()=>clearInterval(b)},[]);const x=b=>b>=0?`+${b.toFixed(2)}`:b.toFixed(2),m=b=>b>=0?`+${b.toFixed(2)}%`:`${b.toFixed(2)}%`;return t.jsx(Xo,{id:s,title:"GLOBAL INDICES - TOP 12",onRemove:e,onRefresh:h,isLoading:a,error:d,children:t.jsxs("div",{style:{padding:"4px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,fontWeight:"bold",color:r.text,borderBottom:`1px solid ${r.textMuted}`,padding:"4px 0",marginBottom:"4px"},children:[t.jsx("div",{children:"INDEX"}),t.jsx("div",{style:{textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHG"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"})]}),i.map((b,w)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,padding:"2px 0",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("div",{style:{color:r.accent},children:Sq[b.symbol]||b.symbol}),t.jsx("div",{style:{color:r.text,textAlign:"right"},children:b.price.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),t.jsx("div",{style:{color:b.change>=0?r.secondary:r.alert,textAlign:"right"},children:x(b.change)}),t.jsx("div",{style:{color:b.change_percent>=0?r.secondary:r.alert,textAlign:"right"},children:m(b.change_percent)})]},w)),i.length===0&&!a&&!d&&t.jsx("div",{style:{color:r.textMuted,fontSize:f,textAlign:"center",padding:"12px"},children:"No index data available"})]})})},Eq=["EURUSD=X","GBPUSD=X","USDJPY=X","AUDUSD=X","USDCAD=X","USDCHF=X","NZDUSD=X","EURCHF=X"],Cq={"EURUSD=X":"EUR/USD","GBPUSD=X":"GBP/USD","USDJPY=X":"USD/JPY","AUDUSD=X":"AUD/USD","USDCAD=X":"USD/CAD","USDCHF=X":"USD/CHF","NZDUSD=X":"NZD/USD","EURCHF=X":"EUR/CHF"},jq=({id:s,onRemove:e})=>{const{colors:r,fontSize:n}=Er(),[i,o]=S.useState([]),[a,l]=S.useState(!0),[d,p]=S.useState(null),f=n.small,h=async()=>{l(!0),p(null);try{const b=await Fi.getEnhancedQuotesWithCache(Eq,"Forex",10);o(b)}catch(b){p(b instanceof Error?b.message:"Failed to load forex data")}finally{l(!1)}};S.useEffect(()=>{h();const b=setInterval(h,600*1e3);return()=>clearInterval(b)},[]);const x=b=>b>=0?`+${b.toFixed(4)}`:b.toFixed(4),m=b=>b>=0?`+${b.toFixed(2)}%`:`${b.toFixed(2)}%`;return t.jsx(Xo,{id:s,title:"FOREX - MAJOR PAIRS",onRemove:e,onRefresh:h,isLoading:a,error:d,children:t.jsxs("div",{style:{padding:"4px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,fontWeight:"bold",color:r.text,borderBottom:`1px solid ${r.textMuted}`,padding:"4px 0",marginBottom:"4px"},children:[t.jsx("div",{children:"PAIR"}),t.jsx("div",{style:{textAlign:"right"},children:"RATE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHG"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"})]}),i.map((b,w)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"4px",fontSize:f,padding:"2px 0",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("div",{style:{color:r.accent},children:Cq[b.symbol]||b.symbol}),t.jsx("div",{style:{color:r.text,textAlign:"right"},children:b.price.toFixed(4)}),t.jsx("div",{style:{color:b.change>=0?r.secondary:r.alert,textAlign:"right"},children:x(b.change)}),t.jsx("div",{style:{color:b.change_percent>=0?r.secondary:r.alert,textAlign:"right"},children:m(b.change_percent)})]},w)),i.length===0&&!a&&!d&&t.jsx("div",{style:{color:r.textMuted,fontSize:f,textAlign:"center",padding:"12px"},children:"No forex data available"})]})})},kq=[{name:"Mumbai  Shanghai",value:"$156B",status:"active",vessels:89},{name:"Mumbai  Singapore",value:"$89B",status:"active",vessels:45},{name:"Mumbai  New York",value:"$123B",status:"active",vessels:56},{name:"Chennai  Tokyo",value:"$67B",status:"delayed",vessels:34},{name:"Mumbai  Dubai",value:"$78B",status:"critical",vessels:12}],Aq=({id:s,onRemove:e,onNavigate:r})=>{const{colors:n,fontSize:i}=Er(),[o,a]=S.useState({active_vessels:1247,monitored_routes:48,trade_volume:"$847.3B"}),l=S.useRef(null),d=i.tiny,p=i.small,f=i.tiny,h=i.tiny;S.useEffect(()=>{const b=setInterval(()=>{a(w=>({...w,active_vessels:w.active_vessels+Math.floor(Math.random()*10-5)}))},6e5);return()=>clearInterval(b)},[]);const x=b=>{switch(b){case"critical":return n.alert;case"delayed":return n.warning;case"active":return n.secondary;default:return n.textMuted}},m=`
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <style>
    body { margin: 0; padding: 0; background: #000; overflow: hidden; }
    #globeViz { height: 100%; width: 100%; background: #000; cursor: pointer; }
  </style>
</head>
<body>
  <div id="globeViz"></div>
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"><\/script>
  <script src="https://unpkg.com/globe.gl@2.27.2/dist/globe.gl.min.js"><\/script>
  <script>
    setTimeout(() => {
      try {
        const world = Globe()
          (document.getElementById('globeViz'))
          .globeImageUrl('https://unpkg.com/three-globe@2.31.1/example/img/earth-blue-marble.jpg')
          .bumpImageUrl('https://unpkg.com/three-globe@2.31.1/example/img/earth-topology.png')
          .backgroundColor('#000000')
          .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png')
          .showAtmosphere(true)
          .atmosphereColor('#00ffff')
          .atmosphereAltitude(0.12)
          .width(window.innerWidth)
          .height(window.innerHeight);

        const scene = world.scene();
        const ambientLight = new THREE.AmbientLight(0x808080, 0.7);
        const directionalLight = new THREE.DirectionalLight(0xaaaaaa, 0.6);
        directionalLight.position.set(5, 3, 5);
        scene.add(ambientLight);
        scene.add(directionalLight);

        world.pointOfView({ lat: 20, lng: 75, altitude: 2.0 }, 1000);

        // Trade routes
        const oceanRoutes = [
          { start: {lat: 18.9388, lng: 72.8354}, end: {lat: 51.9553, lng: 4.1392}, color: 'rgba(100, 180, 255, 0.6)', width: 0.8 },
          { start: {lat: 18.9388, lng: 72.8354}, end: {lat: 31.3548, lng: 121.6431}, color: 'rgba(120, 200, 255, 0.7)', width: 1.2 },
          { start: {lat: 18.9388, lng: 72.8354}, end: {lat: 1.2644, lng: 103.8224}, color: 'rgba(100, 180, 255, 0.65)', width: 1.0 },
          { start: {lat: 13.0827, lng: 80.2707}, end: {lat: 35.4437, lng: 139.6380}, color: 'rgba(150, 220, 255, 0.6)', width: 0.9 },
          { start: {lat: 22.5726, lng: 88.3639}, end: {lat: 22.2855, lng: 114.1577}, color: 'rgba(100, 180, 255, 0.55)', width: 0.8 },
          { start: {lat: 18.9388, lng: 72.8354}, end: {lat: 24.9857, lng: 55.0272}, color: 'rgba(255, 160, 100, 0.6)', width: 0.9 },
          { start: {lat: 18.9388, lng: 72.8354}, end: {lat: 40.6655, lng: -74.0781}, color: 'rgba(120, 200, 255, 0.75)', width: 1.2 },
          { start: {lat: 13.0827, lng: 80.2707}, end: {lat: -33.9544, lng: 151.2093}, color: 'rgba(130, 190, 255, 0.6)', width: 0.9 }
        ];

        const arcsData = oceanRoutes.map(route => ({
          startLat: route.start.lat,
          startLng: route.start.lng,
          endLat: route.end.lat,
          endLng: route.end.lng,
          color: route.color,
          width: route.width
        }));

        world.arcsData(arcsData)
          .arcColor('color')
          .arcStroke('width')
          .arcDashLength(1.0)
          .arcDashGap(0)
          .arcAltitude(0.1)
          .arcAltitudeAutoScale(0.5);

        // Ports
        const ports = [
          {lat: 18.9388, lng: 72.8354}, {lat: 31.3548, lng: 121.6431}, {lat: 1.2644, lng: 103.8224},
          {lat: 51.9553, lng: 4.1392}, {lat: 24.9857, lng: 55.0272}, {lat: 40.6655, lng: -74.0781}
        ];

        world.pointsData(ports)
          .pointAltitude(0.002)
          .pointRadius(0.6)
          .pointColor(() => 'rgba(255, 180, 100, 0.85)');

        // Ships
        const shipData = oceanRoutes.map((route, idx) => ({
          routeIdx: idx,
          progress: Math.random(),
          startLat: route.start.lat,
          startLng: route.start.lng,
          endLat: route.end.lat,
          endLng: route.end.lng
        }));

        function updateShips() {
          const shipPoints = shipData.map(ship => {
            const lat = ship.startLat + (ship.endLat - ship.startLat) * ship.progress;
            const lng = ship.startLng + (ship.endLng - ship.startLng) * ship.progress;
            return { lat, lng, size: 0.15, color: 'rgba(255, 255, 255, 0.95)', altitude: 0.003 };
          });
          world.customLayerData(shipPoints)
            .customThreeObject(() => {
              const geometry = new THREE.TetrahedronGeometry(0.7);
              const material = new THREE.MeshBasicMaterial({ color: 0x00ccff, transparent: true, opacity: 0.9 });
              return new THREE.Mesh(geometry, material);
            })
            .customThreeObjectUpdate((obj, d) => {
              Object.assign(obj.position, world.getCoords(d.lat, d.lng, d.altitude));
            });
        }

        updateShips();

        setInterval(() => {
          shipData.forEach(ship => {
            ship.progress = (ship.progress + 0.0002) % 1.0;
          });
          updateShips();
        }, 200);

        // Auto-rotate
        world.controls().autoRotate = true;
        world.controls().autoRotateSpeed = 0.3;
        world.controls().enableDamping = true;
        world.controls().dampingFactor = 0.05;

        // Click to notify parent
        document.getElementById('globeViz').addEventListener('click', () => {
          window.parent.postMessage('navigate-to-maritime', '*');
        });

        window.addEventListener('resize', () => {
          world.width(window.innerWidth).height(window.innerHeight);
        });
      } catch (error) {
        console.error('Globe error:', error);
      }
    }, 500);
  <\/script>
</body>
</html>
  `;return S.useEffect(()=>{const b=w=>{w.data==="navigate-to-maritime"&&r&&r()};return window.addEventListener("message",b),()=>window.removeEventListener("message",b)},[r]),t.jsx(Xo,{id:s,title:" MARITIME INTELLIGENCE",onRemove:e,headerColor:n.accent||"#00FFFF",children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[t.jsxs("div",{style:{flex:"0 0 60%",position:"relative",overflow:"hidden",cursor:"pointer",borderBottom:`2px solid ${n.accent||"#00FFFF"}`},title:"Click to open full Maritime Intelligence view",children:[t.jsx("iframe",{ref:l,srcDoc:m,style:{width:"100%",height:"100%",border:"none",background:"#000"}}),t.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",background:"rgba(0, 255, 255, 0.9)",color:"#000",padding:"2px 6px",fontSize:d,fontWeight:"bold",borderRadius:"2px"},children:"3D GLOBE"})]}),t.jsxs("div",{style:{flex:"0 0 40%",padding:"6px",fontSize:h,overflowY:"auto"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"4px",marginBottom:"6px",paddingBottom:"4px",borderBottom:`1px solid ${n.textMuted}`},children:[t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:n.textMuted||"#787878",fontSize:d},children:"VESSELS"}),t.jsx("div",{style:{color:n.accent||"#00FFFF",fontWeight:"bold",fontSize:p},children:o.active_vessels})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:n.textMuted||"#787878",fontSize:d},children:"ROUTES"}),t.jsx("div",{style:{color:n.accent||"#00FFFF",fontWeight:"bold",fontSize:p},children:o.monitored_routes})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:n.textMuted||"#787878",fontSize:d},children:"VOL 24H"}),t.jsx("div",{style:{color:n.secondary,fontWeight:"bold",fontSize:p},children:o.trade_volume})]})]}),t.jsx("div",{style:{color:n.accent||"#00FFFF",fontSize:f,fontWeight:"bold",marginBottom:"3px"},children:"TOP TRADE CORRIDORS"}),kq.map((b,w)=>t.jsxs("div",{style:{background:w%2===0?"rgba(255,255,255,0.02)":"transparent",padding:"3px",marginBottom:"2px",borderLeft:`2px solid ${x(b.status)}`,paddingLeft:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1px"},children:[t.jsx("span",{style:{color:n.text||"#FFFFFF",fontSize:f,fontWeight:"bold"},children:b.name}),t.jsx("span",{style:{color:x(b.status),fontSize:h,padding:"1px 2px",border:`1px solid ${x(b.status)}`},children:b.status.toUpperCase()})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:h},children:[t.jsx("span",{style:{color:n.textMuted||"#787878"},children:b.value}),t.jsxs("span",{style:{color:n.accent||"#00FFFF"},children:[b.vessels," ships"]})]})]},w))]})]})})};async function Tq(s){const e=crypto.randomUUID(),r={provider:s.provider,channel:s.channel,symbol:s.symbol,params:s.params},n={id:e,alias:s.alias,display_name:s.displayName,description:s.description,type:"websocket",provider:s.provider,category:s.category||"websocket",config:JSON.stringify(r),enabled:s.enabled!==!1,tags:s.tags?JSON.stringify(s.tags):void 0},i=await Je.saveDataSource(n);if(i.success&&n.enabled){const o=wo(),a=`${r.provider}.${r.channel}${r.symbol?"."+r.symbol:""}`;try{o.getProviderConfig(r.provider)||(o.setProviderConfig(r.provider,{provider_name:r.provider,enabled:!0,api_key:s.params?.api_key,api_secret:s.params?.api_secret,endpoint:s.params?.endpoint}),mp.debug(`Provider config set for: ${r.provider}`)),mp.debug(`WebSocket source created: ${s.alias} -> ${a}`)}catch(l){mp.error("Failed to initialize WS source:",l)}}return i}async function vv(){return await Je.getAllDataSources()}async function Rq(s){return await Je.getDataSourceByAlias(s)}async function Nq(s){return await Je.toggleDataSourceEnabled(s)}async function Oq(s){return await Je.deleteDataSource(s)}async function _q(s){const e=await Je.saveDataSource(s);return{success:e.success,message:e.message}}function k2(s){if(s.type!=="websocket")return null;try{const e=JSON.parse(s.config);return`${e.provider}.${e.channel}${e.symbol?"."+e.symbol:""}`}catch(e){return mp.error("Failed to parse WS config:",e),null}}function fb(s){try{return JSON.parse(s.config)}catch(e){return mp.error("Failed to parse config:",e),null}}async function Dq(){const s=await vv();return{total:s.length,websocket:s.filter(e=>e.type==="websocket").length,restApi:s.filter(e=>e.type==="rest_api").length,enabled:s.filter(e=>e.enabled).length,disabled:s.filter(e=>!e.enabled).length}}function Jf(s,e,r={}){const{autoConnect:n=!0,autoSubscribe:i=!0,params:o,onError:a,onStatusChange:l}=r,[d,p]=S.useState(null),[f,h]=S.useState([]),[x,m]=S.useState(null),[b,w]=S.useState(!1),[y,C]=S.useState(null),T=S.useRef(null),E=S.useRef(e||null);S.useEffect(()=>{E.current=e||null},[e]);const j=S.useCallback(I=>{(I.channel==="ohlc"||I.type==="candle")&&console.log("[useWebSocket]  Chart message:",{provider:I.provider,channel:I.channel,type:I.type,symbol:I.symbol,dataKeys:Object.keys(I.data||{})}),p(I),h(O=>[...O,I].slice(-100)),E.current&&E.current(I)},[]),k=S.useCallback(async(I,O)=>{console.log(`[useWebSocket]  Attempting to subscribe to: ${I}`),console.log("[useWebSocket] Params:",O||o);try{w(!0),C(null);const G=wo(),B=I.split(".")[0];console.log(`[useWebSocket] Provider: ${B}`);const F=G.getStatus(B);console.log(`[useWebSocket] WebSocket status for ${B}: ${F}`),console.log("[useWebSocket] Calling manager.subscribe()...");const z=await G.subscribe(I,j,O||o);T.current=z,console.log(`[useWebSocket]  Subscription created: ${z.id}`);const $=G.getStatus(B);m($),console.log(`[useWebSocket] Final status: ${$}`),l&&$&&l($)}catch(G){const B=G instanceof Error?G:new Error(String(G));C(B),console.error(`[useWebSocket]  Subscribe FAILED for ${I}:`,B.message),a&&a(B),!B.message.includes("not connected")&&!B.message.includes("not open")&&console.error("[useWebSocket] Subscribe error:",B)}finally{w(!1)}},[j,o,a,l]),A=S.useCallback(()=>{T.current&&(T.current.unsubscribe(),T.current=null,m(Ln.DISCONNECTED))},[]),R=S.useCallback(async I=>{if(!s)throw new Error("No topic specified");const O=wo(),G=s.split(".")[0],B=O.registry.get(G);if(!B)throw new Error(`Provider ${G} not connected`);await B.send(I)},[s]),M=S.useCallback(async()=>{if(!s)throw new Error("No topic specified");try{w(!0),C(null);const I=wo(),O=s.split(".")[0];await I.reconnect(O),T.current&&(A(),await k(s,o))}catch(I){const O=I instanceof Error?I:new Error(String(I));C(O),a&&a(O)}finally{w(!1)}},[s,o,a,k,A]),P=S.useCallback(()=>{h([]),p(null)},[]);return S.useEffect(()=>{let I=!0;return s&&i&&n&&I&&k(s,o),()=>{I=!1,A()}},[s,i,n]),S.useEffect(()=>{if(!s||!i)return;const I=wo(),O=s.split(".")[0];let G=!0,B=!1,F=0;const z=setInterval(async()=>{if(!G||B)return;if(I.getStatus(O)===Ln.CONNECTED&&!T.current){if(F>3){console.debug(`[useWebSocket] Too many consecutive failures for ${s}, pausing auto-resubscribe`);return}B=!0;try{console.log(`[useWebSocket] Auto-resubscribing to ${s} after reconnection`),await k(s,o),F=0}catch(W){F++;const D=W instanceof Error?W.message:String(W);!D.includes("not connected")&&!D.includes("not open")&&console.debug(`[useWebSocket] Auto-resubscribe failed (attempt ${F}):`,W)}finally{B=!1}}else T.current&&(F=0)},5e3);return()=>{G=!1,clearInterval(z)}},[s,i,o,k]),{message:d,messages:f,status:x,isLoading:b,error:y,subscribe:k,unsubscribe:A,send:R,reconnect:M,clearMessages:P}}function Iq(){const s=wo(),[e,r]=S.useState(s.getStats()),[n,i]=S.useState(s.getAllStatuses()),[o,a]=S.useState(s.getAllMetrics());return S.useEffect(()=>{let l=!0;const d=setInterval(()=>{l&&(r(s.getStats()),i(s.getAllStatuses()),a(s.getAllMetrics()))},1e3);return()=>{l=!1,clearInterval(d)}},[s]),{manager:s,stats:e,statuses:n,metrics:o}}const Sa=class Sa{constructor(){Pe(this,"cryptoKey",null)}async initialize(){if(!await this.isEncryptionEnabled())return;let r=localStorage.getItem(Sa.STORAGE_KEY);if(r){const n=JSON.parse(r);this.cryptoKey=await window.crypto.subtle.importKey("jwk",n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}else{const n=await window.crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),i=await window.crypto.subtle.exportKey("jwk",n);localStorage.setItem(Sa.STORAGE_KEY,JSON.stringify(i)),this.cryptoKey=n}}async encrypt(e){if(!await this.isEncryptionEnabled())return e;if(this.cryptoKey||await this.initialize(),!this.cryptoKey)throw new Error("Encryption key not initialized");const n=window.crypto.getRandomValues(new Uint8Array(12)),o=new TextEncoder().encode(e),a=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:n},this.cryptoKey,o),l=new Uint8Array(n.length+a.byteLength);return l.set(n),l.set(new Uint8Array(a),n.length),btoa(String.fromCharCode(...l))}async decrypt(e){if(!await this.isEncryptionEnabled())return e;if(this.cryptoKey||await this.initialize(),!this.cryptoKey)throw new Error("Encryption key not initialized");try{const n=Uint8Array.from(atob(e),d=>d.charCodeAt(0)),i=n.slice(0,12),o=n.slice(12),a=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},this.cryptoKey,o);return new TextDecoder().decode(a)}catch(n){return console.error("Decryption failed:",n),e}}async isEncryptionEnabled(){const e=localStorage.getItem(Sa.PREFERENCE_KEY);return e==="true"||e===null}async setEncryptionEnabled(e){localStorage.setItem(Sa.PREFERENCE_KEY,String(e)),e?await this.initialize():this.cryptoKey=null}async reEncryptCredentials(e,r){const n={};for(const[i,o]of Object.entries(e))r?n[i]=await this.encrypt(o):n[i]=await this.decrypt(o);return n}clearKey(){localStorage.removeItem(Sa.STORAGE_KEY),this.cryptoKey=null}};Pe(Sa,"STORAGE_KEY","data_mapping_encryption_key"),Pe(Sa,"PREFERENCE_KEY","data_mapping_encryption_enabled");let gb=Sa;const fi=new gb;class Pq{constructor(){Pe(this,"initialized",!1)}async initialize(){if(!this.initialized)try{Je.isReady()||await Je.initialize(),await Je.execute(`
        CREATE TABLE IF NOT EXISTS data_mappings (
          id TEXT PRIMARY KEY,
          name TEXT NOT NULL,
          description TEXT,
          config_json TEXT NOT NULL,
          created_at TEXT NOT NULL,
          updated_at TEXT NOT NULL
        )
      `),await Je.execute(`
        CREATE TABLE IF NOT EXISTS mapping_cache (
          cache_key TEXT PRIMARY KEY,
          mapping_id TEXT NOT NULL,
          params_hash TEXT NOT NULL,
          response_json TEXT NOT NULL,
          cached_at TEXT NOT NULL,
          expires_at TEXT NOT NULL,
          FOREIGN KEY(mapping_id) REFERENCES data_mappings(id) ON DELETE CASCADE
        )
      `),await Je.execute(`
        CREATE INDEX IF NOT EXISTS idx_mapping_cache_lookup
        ON mapping_cache(mapping_id, params_hash)
      `),await Je.execute(`
        CREATE TABLE IF NOT EXISTS mapping_preferences (
          key TEXT PRIMARY KEY,
          value TEXT NOT NULL
        )
      `),this.initialized=!0,console.log("MappingDatabase initialized successfully")}catch(e){throw console.error("Failed to initialize MappingDatabase:",e),e}}async saveMapping(e){await this.ensureInitialized();try{const r=await fi.isEncryptionEnabled();let n={...e};if(r&&e.source.type==="api"&&e.source.apiConfig){const o={...e.source.apiConfig};if(o.authentication.config){const a={...o.authentication.config};a.apiKey&&(a.apiKey={...a.apiKey,value:await fi.encrypt(a.apiKey.value)}),a.bearer&&(a.bearer={token:await fi.encrypt(a.bearer.token)}),a.basic&&(a.basic={username:a.basic.username,password:await fi.encrypt(a.basic.password)}),a.oauth2&&(a.oauth2={accessToken:await fi.encrypt(a.oauth2.accessToken),refreshToken:a.oauth2.refreshToken?await fi.encrypt(a.oauth2.refreshToken):void 0}),o.authentication={...o.authentication,config:a}}n={...n,source:{...n.source,apiConfig:o}}}const i=JSON.stringify(n);await Je.execute(`INSERT OR REPLACE INTO data_mappings (id, name, description, config_json, created_at, updated_at)
         VALUES (?, ?, ?, ?, ?, ?)`,[e.id,e.name,e.description,i,e.metadata.createdAt,e.metadata.updatedAt]),console.log(`Mapping '${e.name}' saved successfully`)}catch(r){throw console.error("Failed to save mapping:",r),r}}async getMapping(e){await this.ensureInitialized();try{const r=await Je.select("SELECT config_json FROM data_mappings WHERE id = ?",[e]);if(!r||r.length===0)return null;const n=JSON.parse(r[0].config_json);if(await fi.isEncryptionEnabled()&&n.source.type==="api"&&n.source.apiConfig){const o={...n.source.apiConfig};if(o.authentication.config){const a={...o.authentication.config};a.apiKey&&(a.apiKey={...a.apiKey,value:await fi.decrypt(a.apiKey.value)}),a.bearer&&(a.bearer={token:await fi.decrypt(a.bearer.token)}),a.basic&&(a.basic={username:a.basic.username,password:await fi.decrypt(a.basic.password)}),a.oauth2&&(a.oauth2={accessToken:await fi.decrypt(a.oauth2.accessToken),refreshToken:a.oauth2.refreshToken?await fi.decrypt(a.oauth2.refreshToken):void 0}),o.authentication={...o.authentication,config:a}}n.source={...n.source,apiConfig:o}}return n}catch(r){return console.error("Failed to get mapping:",r),null}}async getAllMappings(){await this.ensureInitialized();try{const e=await Je.select("SELECT config_json FROM data_mappings ORDER BY updated_at DESC");return!e||e.length===0?[]:await Promise.all(e.map(async n=>JSON.parse(n.config_json)))}catch(e){return console.error("Failed to get all mappings:",e),[]}}async deleteMapping(e){await this.ensureInitialized();try{await Je.execute("DELETE FROM data_mappings WHERE id = ?",[e]),console.log(`Mapping ${e} deleted`)}catch(r){throw console.error("Failed to delete mapping:",r),r}}async getCachedResponse(e,r){await this.ensureInitialized();try{const n=this.hashParams(r),i=`${e}_${n}`,o=await Je.select(`SELECT response_json, expires_at FROM mapping_cache
         WHERE cache_key = ? AND expires_at > datetime('now')`,[i]);return!o||o.length===0?null:(console.log(`Cache hit for mapping ${e}`),JSON.parse(o[0].response_json))}catch(n){return console.error("Failed to get cached response:",n),null}}async setCachedResponse(e,r,n,i){await this.ensureInitialized();try{const o=this.hashParams(r),a=`${e}_${o}`,l=new Date().toISOString(),d=new Date(Date.now()+i*1e3).toISOString(),p=JSON.stringify(n);await Je.execute(`INSERT OR REPLACE INTO mapping_cache (cache_key, mapping_id, params_hash, response_json, cached_at, expires_at)
         VALUES (?, ?, ?, ?, ?, ?)`,[a,e,o,p,l,d]),console.log(`Response cached for mapping ${e}`)}catch(o){console.error("Failed to cache response:",o)}}async clearCache(e){await this.ensureInitialized();try{e?(await Je.execute("DELETE FROM mapping_cache WHERE mapping_id = ?",[e]),console.log(`Cache cleared for mapping ${e}`)):(await Je.execute("DELETE FROM mapping_cache"),console.log("All cache cleared"))}catch(r){throw console.error("Failed to clear cache:",r),r}}async cleanExpiredCache(){await this.ensureInitialized();try{await Je.execute("DELETE FROM mapping_cache WHERE expires_at < datetime('now')"),console.log("Expired cache entries cleaned")}catch(e){console.error("Failed to clean expired cache:",e)}}async getPreference(e){await this.ensureInitialized();try{const r=await Je.select("SELECT value FROM mapping_preferences WHERE key = ?",[e]);return r&&r.length>0?r[0].value:null}catch(r){return console.error("Failed to get preference:",r),null}}async setPreference(e,r){await this.ensureInitialized();try{await Je.execute("INSERT OR REPLACE INTO mapping_preferences (key, value) VALUES (?, ?)",[e,r])}catch(n){throw console.error("Failed to set preference:",n),n}}async duplicateMapping(e){const r=await this.getMapping(e);if(!r)return null;const n={...r,id:`map_${Date.now()}`,name:`${r.name} (Copy)`,metadata:{...r.metadata,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}};return await this.saveMapping(n),n}hashParams(e){const r=JSON.stringify(e,Object.keys(e).sort());let n=0;for(let i=0;i<r.length;i++){const o=r.charCodeAt(i);n=(n<<5)-n+o,n=n&n}return n.toString(36)}async ensureInitialized(){this.initialized||await this.initialize()}}const Ea=new Pq;var At=(s=>(s.JSONPATH="jsonpath",s.JSONATA="jsonata",s.JMESPATH="jmespath",s.CUSTOM_JS="javascript",s.REGEX="regex",s.DIRECT="direct",s))(At||{});class Kd{async parse(e,r){try{const n=this.validate(r.expression);return n.valid?{success:!0,data:await this.execute(e,r.expression)}:{success:!1,error:n.error||"Invalid expression"}}catch(n){if(r.fallback)try{return{success:!0,data:await this.execute(e,r.fallback)}}catch{return{success:!1,error:`Primary and fallback parsing failed: ${n instanceof Error?n.message:String(n)}`}}return{success:!1,error:n instanceof Error?n.message:String(n)}}}extractNestedValue(e,r){const n=r.split(".");let i=e;for(const o of n){if(i==null)return;const a=o.match(/^(.+)\[(\d+)\]$/);if(a){const[,l,d]=a;i=i[l],Array.isArray(i)&&(i=i[parseInt(d,10)])}else i=i[o]}return i}}var l0={exports:{}};var Yj;function Lq(){return Yj||(Yj=1,(function(s,e){(function(r){if(typeof window<"u")s.exports=r();else{var n;typeof window<"u"?n=window:typeof globalThis<"u"?n=globalThis:typeof self<"u"?n=self:n=this,n.jsonpath=r()}})(function(){return(function r(n,i,o){function a(p,f){if(!i[p]){if(!n[p]){var h=typeof xl=="function"&&xl;if(!f&&h)return h(p,!0);if(l)return l(p,!0);var x=new Error("Cannot find module '"+p+"'");throw x.code="MODULE_NOT_FOUND",x}var m=i[p]={exports:{}};n[p][0].call(m.exports,function(b){var w=n[p][1][b];return a(w||b)},m,m.exports,r,n,i,o)}return i[p].exports}for(var l=typeof xl=="function"&&xl,d=0;d<o.length;d++)a(o[d]);return a})({"./aesprim":[function(r,n,i){(function(o,a){a(typeof window<"u"?i:o.esprima={})})(this,function(o){var a,l,d,p,f,h,x,m,b,w,y,C,T,E,j,k,A,R;a={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9},l={},l[a.BooleanLiteral]="Boolean",l[a.EOF]="<end>",l[a.Identifier]="Identifier",l[a.Keyword]="Keyword",l[a.NullLiteral]="Null",l[a.NumericLiteral]="Numeric",l[a.Punctuator]="Punctuator",l[a.StringLiteral]="String",l[a.RegularExpression]="RegularExpression",d=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],p={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},f={Data:1,Get:2,Set:4},h={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},x={NonAsciiIdentifierStart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]"),NonAsciiIdentifierPart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]")};function M(H,ae){if(!H)throw new Error("ASSERT: "+ae)}function P(H){return H>=48&&H<=57}function I(H){return"0123456789abcdefABCDEF".indexOf(H)>=0}function O(H){return"01234567".indexOf(H)>=0}function G(H){return H===32||H===9||H===11||H===12||H===160||H>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(H)>=0}function B(H){return H===10||H===13||H===8232||H===8233}function F(H){return H==64||H===36||H===95||H>=65&&H<=90||H>=97&&H<=122||H===92||H>=128&&x.NonAsciiIdentifierStart.test(String.fromCharCode(H))}function z(H){return H===36||H===95||H>=65&&H<=90||H>=97&&H<=122||H>=48&&H<=57||H===92||H>=128&&x.NonAsciiIdentifierPart.test(String.fromCharCode(H))}function $(H){switch(H){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function W(H){switch(H){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function D(H){return H==="eval"||H==="arguments"}function oe(H){if(w&&W(H))return!0;switch(H.length){case 2:return H==="if"||H==="in"||H==="do";case 3:return H==="var"||H==="for"||H==="new"||H==="try"||H==="let";case 4:return H==="this"||H==="else"||H==="case"||H==="void"||H==="with"||H==="enum";case 5:return H==="while"||H==="break"||H==="catch"||H==="throw"||H==="const"||H==="yield"||H==="class"||H==="super";case 6:return H==="return"||H==="typeof"||H==="delete"||H==="switch"||H==="export"||H==="import";case 7:return H==="default"||H==="finally"||H==="extends";case 8:return H==="function"||H==="continue"||H==="debugger";case 10:return H==="instanceof";default:return!1}}function Z(H,ae,De,Ke,ut){var kt;M(typeof De=="number","Comment must have valid position"),!(A.lastCommentStart>=De)&&(A.lastCommentStart=De,kt={type:H,value:ae},R.range&&(kt.range=[De,Ke]),R.loc&&(kt.loc=ut),R.comments.push(kt),R.attachComment&&(R.leadingComments.push(kt),R.trailingComments.push(kt)))}function fe(H){var ae,De,Ke,ut;for(ae=y-H,De={start:{line:C,column:y-T-H}};y<E;)if(Ke=b.charCodeAt(y),++y,B(Ke)){R.comments&&(ut=b.slice(ae+H,y-1),De.end={line:C,column:y-T-1},Z("Line",ut,ae,y-1,De)),Ke===13&&b.charCodeAt(y)===10&&++y,++C,T=y;return}R.comments&&(ut=b.slice(ae+H,y),De.end={line:C,column:y-T},Z("Line",ut,ae,y,De))}function Q(){var H,ae,De,Ke;for(R.comments&&(H=y-2,ae={start:{line:C,column:y-T-2}});y<E;)if(De=b.charCodeAt(y),B(De))De===13&&b.charCodeAt(y+1)===10&&++y,++C,++y,T=y,y>=E&&ee({},h.UnexpectedToken,"ILLEGAL");else if(De===42){if(b.charCodeAt(y+1)===47){++y,++y,R.comments&&(Ke=b.slice(H+2,y-2),ae.end={line:C,column:y-T},Z("Block",Ke,H,y,ae));return}++y}else++y;ee({},h.UnexpectedToken,"ILLEGAL")}function _(){var H,ae;for(ae=y===0;y<E;)if(H=b.charCodeAt(y),G(H))++y;else if(B(H))++y,H===13&&b.charCodeAt(y)===10&&++y,++C,T=y,ae=!0;else if(H===47)if(H=b.charCodeAt(y+1),H===47)++y,++y,fe(2),ae=!0;else if(H===42)++y,++y,Q();else break;else if(ae&&H===45)if(b.charCodeAt(y+1)===45&&b.charCodeAt(y+2)===62)y+=3,fe(3);else break;else if(H===60)if(b.slice(y+1,y+4)==="!--")++y,++y,++y,++y,fe(4);else break;else break}function Y(H){var ae,De,Ke,ut=0;for(De=H==="u"?4:2,ae=0;ae<De;++ae)if(y<E&&I(b[y]))Ke=b[y++],ut=ut*16+"0123456789abcdef".indexOf(Ke.toLowerCase());else return"";return String.fromCharCode(ut)}function he(){var H,ae;for(H=b.charCodeAt(y++),ae=String.fromCharCode(H),H===92&&(b.charCodeAt(y)!==117&&ee({},h.UnexpectedToken,"ILLEGAL"),++y,H=Y("u"),(!H||H==="\\"||!F(H.charCodeAt(0)))&&ee({},h.UnexpectedToken,"ILLEGAL"),ae=H);y<E&&(H=b.charCodeAt(y),!!z(H));)++y,ae+=String.fromCharCode(H),H===92&&(ae=ae.substr(0,ae.length-1),b.charCodeAt(y)!==117&&ee({},h.UnexpectedToken,"ILLEGAL"),++y,H=Y("u"),(!H||H==="\\"||!z(H.charCodeAt(0)))&&ee({},h.UnexpectedToken,"ILLEGAL"),ae+=H);return ae}function me(){var H,ae;for(H=y++;y<E;){if(ae=b.charCodeAt(y),ae===92)return y=H,he();if(z(ae))++y;else break}return b.slice(H,y)}function ge(){var H,ae,De;return H=y,ae=b.charCodeAt(y)===92?he():me(),ae.length===1?De=a.Identifier:oe(ae)?De=a.Keyword:ae==="null"?De=a.NullLiteral:ae==="true"||ae==="false"?De=a.BooleanLiteral:De=a.Identifier,{type:De,value:ae,lineNumber:C,lineStart:T,start:H,end:y}}function le(){var H=y,ae=b.charCodeAt(y),De,Ke=b[y],ut,kt,pr;switch(ae){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++y,R.tokenize&&(ae===40?R.openParenToken=R.tokens.length:ae===123&&(R.openCurlyToken=R.tokens.length)),{type:a.Punctuator,value:String.fromCharCode(ae),lineNumber:C,lineStart:T,start:H,end:y};default:if(De=b.charCodeAt(y+1),De===61)switch(ae){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return y+=2,{type:a.Punctuator,value:String.fromCharCode(ae)+String.fromCharCode(De),lineNumber:C,lineStart:T,start:H,end:y};case 33:case 61:return y+=2,b.charCodeAt(y)===61&&++y,{type:a.Punctuator,value:b.slice(H,y),lineNumber:C,lineStart:T,start:H,end:y}}}if(pr=b.substr(y,4),pr===">>>=")return y+=4,{type:a.Punctuator,value:pr,lineNumber:C,lineStart:T,start:H,end:y};if(kt=pr.substr(0,3),kt===">>>"||kt==="<<="||kt===">>=")return y+=3,{type:a.Punctuator,value:kt,lineNumber:C,lineStart:T,start:H,end:y};if(ut=kt.substr(0,2),Ke===ut[1]&&"+-<>&|".indexOf(Ke)>=0||ut==="=>")return y+=2,{type:a.Punctuator,value:ut,lineNumber:C,lineStart:T,start:H,end:y};if("<>=!+-*%&|^/".indexOf(Ke)>=0)return++y,{type:a.Punctuator,value:Ke,lineNumber:C,lineStart:T,start:H,end:y};ee({},h.UnexpectedToken,"ILLEGAL")}function X(H){for(var ae="";y<E&&I(b[y]);)ae+=b[y++];return ae.length===0&&ee({},h.UnexpectedToken,"ILLEGAL"),F(b.charCodeAt(y))&&ee({},h.UnexpectedToken,"ILLEGAL"),{type:a.NumericLiteral,value:parseInt("0x"+ae,16),lineNumber:C,lineStart:T,start:H,end:y}}function V(H){for(var ae="0"+b[y++];y<E&&O(b[y]);)ae+=b[y++];return(F(b.charCodeAt(y))||P(b.charCodeAt(y)))&&ee({},h.UnexpectedToken,"ILLEGAL"),{type:a.NumericLiteral,value:parseInt(ae,8),octal:!0,lineNumber:C,lineStart:T,start:H,end:y}}function de(){var H,ae,De;if(De=b[y],M(P(De.charCodeAt(0))||De===".","Numeric literal must start with a decimal digit or a decimal point"),ae=y,H="",De!=="."){if(H=b[y++],De=b[y],H==="0"){if(De==="x"||De==="X")return++y,X(ae);if(O(De))return V(ae);De&&P(De.charCodeAt(0))&&ee({},h.UnexpectedToken,"ILLEGAL")}for(;P(b.charCodeAt(y));)H+=b[y++];De=b[y]}if(De==="."){for(H+=b[y++];P(b.charCodeAt(y));)H+=b[y++];De=b[y]}if(De==="e"||De==="E")if(H+=b[y++],De=b[y],(De==="+"||De==="-")&&(H+=b[y++]),P(b.charCodeAt(y)))for(;P(b.charCodeAt(y));)H+=b[y++];else ee({},h.UnexpectedToken,"ILLEGAL");return F(b.charCodeAt(y))&&ee({},h.UnexpectedToken,"ILLEGAL"),{type:a.NumericLiteral,value:parseFloat(H),lineNumber:C,lineStart:T,start:ae,end:y}}function je(){var H="",ae,De,Ke,ut,kt,pr,Vr=!1,ns,$n;for(ns=C,$n=T,ae=b[y],M(ae==="'"||ae==='"',"String literal must starts with a quote"),De=y,++y;y<E;)if(Ke=b[y++],Ke===ae){ae="";break}else if(Ke==="\\")if(Ke=b[y++],!Ke||!B(Ke.charCodeAt(0)))switch(Ke){case"u":case"x":pr=y,kt=Y(Ke),kt?H+=kt:(y=pr,H+=Ke);break;case"n":H+=`
`;break;case"r":H+="\r";break;case"t":H+="	";break;case"b":H+="\b";break;case"f":H+="\f";break;case"v":H+="\v";break;default:O(Ke)?(ut="01234567".indexOf(Ke),ut!==0&&(Vr=!0),y<E&&O(b[y])&&(Vr=!0,ut=ut*8+"01234567".indexOf(b[y++]),"0123".indexOf(Ke)>=0&&y<E&&O(b[y])&&(ut=ut*8+"01234567".indexOf(b[y++]))),H+=String.fromCharCode(ut)):H+=Ke;break}else++C,Ke==="\r"&&b[y]===`
`&&++y,T=y;else{if(B(Ke.charCodeAt(0)))break;H+=Ke}return ae!==""&&ee({},h.UnexpectedToken,"ILLEGAL"),{type:a.StringLiteral,value:H,octal:Vr,startLineNumber:ns,startLineStart:$n,lineNumber:C,lineStart:T,start:De,end:y}}function _e(H,ae){var De;try{De=new RegExp(H,ae)}catch{ee({},h.InvalidRegExp)}return De}function Re(){var H,ae,De,Ke,ut;for(H=b[y],M(H==="/","Regular expression literal must start with a slash"),ae=b[y++],De=!1,Ke=!1;y<E;)if(H=b[y++],ae+=H,H==="\\")H=b[y++],B(H.charCodeAt(0))&&ee({},h.UnterminatedRegExp),ae+=H;else if(B(H.charCodeAt(0)))ee({},h.UnterminatedRegExp);else if(De)H==="]"&&(De=!1);else if(H==="/"){Ke=!0;break}else H==="["&&(De=!0);return Ke||ee({},h.UnterminatedRegExp),ut=ae.substr(1,ae.length-2),{value:ut,literal:ae}}function Be(){var H,ae,De,Ke;for(ae="",De="";y<E&&(H=b[y],!!z(H.charCodeAt(0)));)if(++y,H==="\\"&&y<E)if(H=b[y],H==="u"){if(++y,Ke=y,H=Y("u"),H)for(De+=H,ae+="\\u";Ke<y;++Ke)ae+=b[Ke];else y=Ke,De+="u",ae+="\\u";ce({},h.UnexpectedToken,"ILLEGAL")}else ae+="\\",ce({},h.UnexpectedToken,"ILLEGAL");else De+=H,ae+=H;return{value:De,literal:ae}}function Se(){var H,ae,De,Ke;return k=null,_(),H=y,ae=Re(),De=Be(),Ke=_e(ae.value,De.value),R.tokenize?{type:a.RegularExpression,value:Ke,lineNumber:C,lineStart:T,start:H,end:y}:{literal:ae.literal+De.literal,value:Ke,start:H,end:y}}function ie(){var H,ae,De,Ke;return _(),H=y,ae={start:{line:C,column:y-T}},De=Se(),ae.end={line:C,column:y-T},R.tokenize||(R.tokens.length>0&&(Ke=R.tokens[R.tokens.length-1],Ke.range[0]===H&&Ke.type==="Punctuator"&&(Ke.value==="/"||Ke.value==="/=")&&R.tokens.pop()),R.tokens.push({type:"RegularExpression",value:De.literal,range:[H,y],loc:ae})),De}function ve(H){return H.type===a.Identifier||H.type===a.Keyword||H.type===a.BooleanLiteral||H.type===a.NullLiteral}function Ae(){var H,ae;if(H=R.tokens[R.tokens.length-1],!H)return ie();if(H.type==="Punctuator"){if(H.value==="]")return le();if(H.value===")")return ae=R.tokens[R.openParenToken-1],ae&&ae.type==="Keyword"&&(ae.value==="if"||ae.value==="while"||ae.value==="for"||ae.value==="with")?ie():le();if(H.value==="}"){if(R.tokens[R.openCurlyToken-3]&&R.tokens[R.openCurlyToken-3].type==="Keyword"){if(ae=R.tokens[R.openCurlyToken-4],!ae)return le()}else if(R.tokens[R.openCurlyToken-4]&&R.tokens[R.openCurlyToken-4].type==="Keyword"){if(ae=R.tokens[R.openCurlyToken-5],!ae)return ie()}else return le();return d.indexOf(ae.value)>=0?le():ie()}return ie()}return H.type==="Keyword"?ie():le()}function $e(){var H;return _(),y>=E?{type:a.EOF,lineNumber:C,lineStart:T,start:y,end:y}:(H=b.charCodeAt(y),F(H)?ge():H===40||H===41||H===59?le():H===39||H===34?je():H===46?P(b.charCodeAt(y+1))?de():le():P(H)?de():R.tokenize&&H===47?Ae():le())}function qe(){var H,ae,De;return _(),H={start:{line:C,column:y-T}},ae=$e(),H.end={line:C,column:y-T},ae.type!==a.EOF&&(De=b.slice(ae.start,ae.end),R.tokens.push({type:l[ae.type],value:De,range:[ae.start,ae.end],loc:H})),ae}function Ie(){var H;return H=k,y=H.end,C=H.lineNumber,T=H.lineStart,k=typeof R.tokens<"u"?qe():$e(),y=H.end,C=H.lineNumber,T=H.lineStart,H}function K(){var H,ae,De;H=y,ae=C,De=T,k=typeof R.tokens<"u"?qe():$e(),y=H,C=ae,T=De}function Ee(H,ae){this.line=H,this.column=ae}function Oe(H,ae,De,Ke){this.start=new Ee(H,ae),this.end=new Ee(De,Ke)}m={name:"SyntaxTree",processComment:function(H){var ae,De;if(!(H.type===p.Program&&H.body.length>0)){for(R.trailingComments.length>0?R.trailingComments[0].range[0]>=H.range[1]?(De=R.trailingComments,R.trailingComments=[]):R.trailingComments.length=0:R.bottomRightStack.length>0&&R.bottomRightStack[R.bottomRightStack.length-1].trailingComments&&R.bottomRightStack[R.bottomRightStack.length-1].trailingComments[0].range[0]>=H.range[1]&&(De=R.bottomRightStack[R.bottomRightStack.length-1].trailingComments,delete R.bottomRightStack[R.bottomRightStack.length-1].trailingComments);R.bottomRightStack.length>0&&R.bottomRightStack[R.bottomRightStack.length-1].range[0]>=H.range[0];)ae=R.bottomRightStack.pop();ae?ae.leadingComments&&ae.leadingComments[ae.leadingComments.length-1].range[1]<=H.range[0]&&(H.leadingComments=ae.leadingComments,delete ae.leadingComments):R.leadingComments.length>0&&R.leadingComments[R.leadingComments.length-1].range[1]<=H.range[0]&&(H.leadingComments=R.leadingComments,R.leadingComments=[]),De&&(H.trailingComments=De),R.bottomRightStack.push(H)}},markEnd:function(H,ae){return R.range&&(H.range=[ae.start,y]),R.loc&&(H.loc=new Oe(ae.startLineNumber===void 0?ae.lineNumber:ae.startLineNumber,ae.start-(ae.startLineStart===void 0?ae.lineStart:ae.startLineStart),C,y-T),this.postProcess(H)),R.attachComment&&this.processComment(H),H},postProcess:function(H){return R.source&&(H.loc.source=R.source),H},createArrayExpression:function(H){return{type:p.ArrayExpression,elements:H}},createAssignmentExpression:function(H,ae,De){return{type:p.AssignmentExpression,operator:H,left:ae,right:De}},createBinaryExpression:function(H,ae,De){var Ke=H==="||"||H==="&&"?p.LogicalExpression:p.BinaryExpression;return{type:Ke,operator:H,left:ae,right:De}},createBlockStatement:function(H){return{type:p.BlockStatement,body:H}},createBreakStatement:function(H){return{type:p.BreakStatement,label:H}},createCallExpression:function(H,ae){return{type:p.CallExpression,callee:H,arguments:ae}},createCatchClause:function(H,ae){return{type:p.CatchClause,param:H,body:ae}},createConditionalExpression:function(H,ae,De){return{type:p.ConditionalExpression,test:H,consequent:ae,alternate:De}},createContinueStatement:function(H){return{type:p.ContinueStatement,label:H}},createDebuggerStatement:function(){return{type:p.DebuggerStatement}},createDoWhileStatement:function(H,ae){return{type:p.DoWhileStatement,body:H,test:ae}},createEmptyStatement:function(){return{type:p.EmptyStatement}},createExpressionStatement:function(H){return{type:p.ExpressionStatement,expression:H}},createForStatement:function(H,ae,De,Ke){return{type:p.ForStatement,init:H,test:ae,update:De,body:Ke}},createForInStatement:function(H,ae,De){return{type:p.ForInStatement,left:H,right:ae,body:De,each:!1}},createFunctionDeclaration:function(H,ae,De,Ke){return{type:p.FunctionDeclaration,id:H,params:ae,defaults:De,body:Ke,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(H,ae,De,Ke){return{type:p.FunctionExpression,id:H,params:ae,defaults:De,body:Ke,rest:null,generator:!1,expression:!1}},createIdentifier:function(H){return{type:p.Identifier,name:H}},createIfStatement:function(H,ae,De){return{type:p.IfStatement,test:H,consequent:ae,alternate:De}},createLabeledStatement:function(H,ae){return{type:p.LabeledStatement,label:H,body:ae}},createLiteral:function(H){return{type:p.Literal,value:H.value,raw:b.slice(H.start,H.end)}},createMemberExpression:function(H,ae,De){return{type:p.MemberExpression,computed:H==="[",object:ae,property:De}},createNewExpression:function(H,ae){return{type:p.NewExpression,callee:H,arguments:ae}},createObjectExpression:function(H){return{type:p.ObjectExpression,properties:H}},createPostfixExpression:function(H,ae){return{type:p.UpdateExpression,operator:H,argument:ae,prefix:!1}},createProgram:function(H){return{type:p.Program,body:H}},createProperty:function(H,ae,De){return{type:p.Property,key:ae,value:De,kind:H}},createReturnStatement:function(H){return{type:p.ReturnStatement,argument:H}},createSequenceExpression:function(H){return{type:p.SequenceExpression,expressions:H}},createSwitchCase:function(H,ae){return{type:p.SwitchCase,test:H,consequent:ae}},createSwitchStatement:function(H,ae){return{type:p.SwitchStatement,discriminant:H,cases:ae}},createThisExpression:function(){return{type:p.ThisExpression}},createThrowStatement:function(H){return{type:p.ThrowStatement,argument:H}},createTryStatement:function(H,ae,De,Ke){return{type:p.TryStatement,block:H,guardedHandlers:ae,handlers:De,finalizer:Ke}},createUnaryExpression:function(H,ae){return H==="++"||H==="--"?{type:p.UpdateExpression,operator:H,argument:ae,prefix:!0}:{type:p.UnaryExpression,operator:H,argument:ae,prefix:!0}},createVariableDeclaration:function(H,ae){return{type:p.VariableDeclaration,declarations:H,kind:ae}},createVariableDeclarator:function(H,ae){return{type:p.VariableDeclarator,id:H,init:ae}},createWhileStatement:function(H,ae){return{type:p.WhileStatement,test:H,body:ae}},createWithStatement:function(H,ae){return{type:p.WithStatement,object:H,body:ae}}};function q(){var H,ae,De,Ke;return H=y,ae=C,De=T,_(),Ke=C!==ae,y=H,C=ae,T=De,Ke}function ee(H,ae){var De,Ke=Array.prototype.slice.call(arguments,2),ut=ae.replace(/%(\d)/g,function(kt,pr){return M(pr<Ke.length,"Message reference must be in range"),Ke[pr]});throw typeof H.lineNumber=="number"?(De=new Error("Line "+H.lineNumber+": "+ut),De.index=H.start,De.lineNumber=H.lineNumber,De.column=H.start-T+1):(De=new Error("Line "+C+": "+ut),De.index=y,De.lineNumber=C,De.column=y-T+1),De.description=ut,De}function ce(){try{ee.apply(null,arguments)}catch(H){if(R.errors)R.errors.push(H);else throw H}}function Ce(H){if(H.type===a.EOF&&ee(H,h.UnexpectedEOS),H.type===a.NumericLiteral&&ee(H,h.UnexpectedNumber),H.type===a.StringLiteral&&ee(H,h.UnexpectedString),H.type===a.Identifier&&ee(H,h.UnexpectedIdentifier),H.type===a.Keyword){if($(H.value))ee(H,h.UnexpectedReserved);else if(w&&W(H.value)){ce(H,h.StrictReservedWord);return}ee(H,h.UnexpectedToken,H.value)}ee(H,h.UnexpectedToken,H.value)}function be(H){var ae=Ie();(ae.type!==a.Punctuator||ae.value!==H)&&Ce(ae)}function We(H){var ae=Ie();(ae.type!==a.Keyword||ae.value!==H)&&Ce(ae)}function J(H){return k.type===a.Punctuator&&k.value===H}function se(H){return k.type===a.Keyword&&k.value===H}function Te(){var H;return k.type!==a.Punctuator?!1:(H=k.value,H==="="||H==="*="||H==="/="||H==="%="||H==="+="||H==="-="||H==="<<="||H===">>="||H===">>>="||H==="&="||H==="^="||H==="|=")}function Me(){var H;if(b.charCodeAt(y)===59||J(";")){Ie();return}H=C,_(),C===H&&k.type!==a.EOF&&!J("}")&&Ce(k)}function Qe(H){return H.type===p.Identifier||H.type===p.MemberExpression}function ye(){var H=[],ae;for(ae=k,be("[");!J("]");)J(",")?(Ie(),H.push(null)):(H.push(it()),J("]")||be(","));return Ie(),j.markEnd(j.createArrayExpression(H),ae)}function ue(H,ae){var De,Ke,ut;return De=w,ut=k,Ke=Cn(),ae&&w&&D(H[0].name)&&ce(ae,h.StrictParamName),w=De,j.markEnd(j.createFunctionExpression(null,H,[],Ke),ut)}function re(){var H,ae;return ae=k,H=Ie(),H.type===a.StringLiteral||H.type===a.NumericLiteral?(w&&H.octal&&ce(H,h.StrictOctalLiteral),j.markEnd(j.createLiteral(H),ae)):j.markEnd(j.createIdentifier(H.value),ae)}function ke(){var H,ae,De,Ke,ut,kt;if(H=k,kt=k,H.type===a.Identifier)return De=re(),H.value==="get"&&!J(":")?(ae=re(),be("("),be(")"),Ke=ue([]),j.markEnd(j.createProperty("get",ae,Ke),kt)):H.value==="set"&&!J(":")?(ae=re(),be("("),H=k,H.type!==a.Identifier?(be(")"),ce(H,h.UnexpectedToken,H.value),Ke=ue([])):(ut=[mr()],be(")"),Ke=ue(ut,H)),j.markEnd(j.createProperty("set",ae,Ke),kt)):(be(":"),Ke=it(),j.markEnd(j.createProperty("init",De,Ke),kt));if(H.type===a.EOF||H.type===a.Punctuator)Ce(H);else return ae=re(),be(":"),Ke=it(),j.markEnd(j.createProperty("init",ae,Ke),kt)}function Ne(){var H=[],ae,De,Ke,ut,kt={},pr=String,Vr;for(Vr=k,be("{");!J("}");)ae=ke(),ae.key.type===p.Identifier?De=ae.key.name:De=pr(ae.key.value),ut=ae.kind==="init"?f.Data:ae.kind==="get"?f.Get:f.Set,Ke="$"+De,Object.prototype.hasOwnProperty.call(kt,Ke)?(kt[Ke]===f.Data?w&&ut===f.Data?ce({},h.StrictDuplicateProperty):ut!==f.Data&&ce({},h.AccessorDataProperty):ut===f.Data?ce({},h.AccessorDataProperty):kt[Ke]&ut&&ce({},h.AccessorGetSet),kt[Ke]|=ut):kt[Ke]=ut,H.push(ae),J("}")||be(",");return be("}"),j.markEnd(j.createObjectExpression(H),Vr)}function U(){var H;return be("("),H=vt(),be(")"),H}function ne(){var H,ae,De,Ke;if(J("("))return U();if(J("["))return ye();if(J("{"))return Ne();if(H=k.type,Ke=k,H===a.Identifier)De=j.createIdentifier(Ie().value);else if(H===a.StringLiteral||H===a.NumericLiteral)w&&k.octal&&ce(k,h.StrictOctalLiteral),De=j.createLiteral(Ie());else if(H===a.Keyword){if(se("function"))return cn();se("this")?(Ie(),De=j.createThisExpression()):Ce(Ie())}else H===a.BooleanLiteral?(ae=Ie(),ae.value=ae.value==="true",De=j.createLiteral(ae)):H===a.NullLiteral?(ae=Ie(),ae.value=null,De=j.createLiteral(ae)):J("/")||J("/=")?(typeof R.tokens<"u"?De=j.createLiteral(ie()):De=j.createLiteral(Se()),K()):Ce(Ie());return j.markEnd(De,Ke)}function xe(){var H=[];if(be("("),!J(")"))for(;y<E&&(H.push(it()),!J(")"));)be(",");return be(")"),H}function Le(){var H,ae;return ae=k,H=Ie(),ve(H)||Ce(H),j.markEnd(j.createIdentifier(H.value),ae)}function ze(){return be("."),Le()}function Ge(){var H;return be("["),H=vt(),be("]"),H}function Ze(){var H,ae,De;return De=k,We("new"),H=bt(),ae=J("(")?xe():[],j.markEnd(j.createNewExpression(H,ae),De)}function xt(){var H,ae,De,Ke,ut;for(ut=k,H=A.allowIn,A.allowIn=!0,ae=se("new")?Ze():ne(),A.allowIn=H;;){if(J("."))Ke=ze(),ae=j.createMemberExpression(".",ae,Ke);else if(J("("))De=xe(),ae=j.createCallExpression(ae,De);else if(J("["))Ke=Ge(),ae=j.createMemberExpression("[",ae,Ke);else break;j.markEnd(ae,ut)}return ae}function bt(){var H,ae,De,Ke;for(Ke=k,H=A.allowIn,ae=se("new")?Ze():ne(),A.allowIn=H;J(".")||J("[");)J("[")?(De=Ge(),ae=j.createMemberExpression("[",ae,De)):(De=ze(),ae=j.createMemberExpression(".",ae,De)),j.markEnd(ae,Ke);return ae}function Lt(){var H,ae,De=k;return H=xt(),k.type===a.Punctuator&&(J("++")||J("--"))&&!q()&&(w&&H.type===p.Identifier&&D(H.name)&&ce({},h.StrictLHSPostfix),Qe(H)||ce({},h.InvalidLHSInAssignment),ae=Ie(),H=j.markEnd(j.createPostfixExpression(ae.value,H),De)),H}function yt(){var H,ae,De;return k.type!==a.Punctuator&&k.type!==a.Keyword?ae=Lt():J("++")||J("--")?(De=k,H=Ie(),ae=yt(),w&&ae.type===p.Identifier&&D(ae.name)&&ce({},h.StrictLHSPrefix),Qe(ae)||ce({},h.InvalidLHSInAssignment),ae=j.createUnaryExpression(H.value,ae),ae=j.markEnd(ae,De)):J("+")||J("-")||J("~")||J("!")?(De=k,H=Ie(),ae=yt(),ae=j.createUnaryExpression(H.value,ae),ae=j.markEnd(ae,De)):se("delete")||se("void")||se("typeof")?(De=k,H=Ie(),ae=yt(),ae=j.createUnaryExpression(H.value,ae),ae=j.markEnd(ae,De),w&&ae.operator==="delete"&&ae.argument.type===p.Identifier&&ce({},h.StrictDelete)):ae=Lt(),ae}function Pt(H,ae){var De=0;if(H.type!==a.Punctuator&&H.type!==a.Keyword)return 0;switch(H.value){case"||":De=1;break;case"&&":De=2;break;case"|":De=3;break;case"^":De=4;break;case"&":De=5;break;case"==":case"!=":case"===":case"!==":De=6;break;case"<":case">":case"<=":case">=":case"instanceof":De=7;break;case"in":De=ae?7:0;break;case"<<":case">>":case">>>":De=8;break;case"+":case"-":De=9;break;case"*":case"/":case"%":De=11;break}return De}function Et(){var H,ae,De,Ke,ut,kt,pr,Vr,ns,$n;if(H=k,ns=yt(),Ke=k,ut=Pt(Ke,A.allowIn),ut===0)return ns;for(Ke.prec=ut,Ie(),ae=[H,k],pr=yt(),kt=[ns,Ke,pr];(ut=Pt(k,A.allowIn))>0;){for(;kt.length>2&&ut<=kt[kt.length-2].prec;)pr=kt.pop(),Vr=kt.pop().value,ns=kt.pop(),De=j.createBinaryExpression(Vr,ns,pr),ae.pop(),H=ae[ae.length-1],j.markEnd(De,H),kt.push(De);Ke=Ie(),Ke.prec=ut,kt.push(Ke),ae.push(k),De=yt(),kt.push(De)}for($n=kt.length-1,De=kt[$n],ae.pop();$n>1;)De=j.createBinaryExpression(kt[$n-1].value,kt[$n-2],De),$n-=2,H=ae.pop(),j.markEnd(De,H);return De}function tt(){var H,ae,De,Ke,ut;return ut=k,H=Et(),J("?")&&(Ie(),ae=A.allowIn,A.allowIn=!0,De=it(),A.allowIn=ae,be(":"),Ke=it(),H=j.createConditionalExpression(H,De,Ke),j.markEnd(H,ut)),H}function it(){var H,ae,De,Ke,ut;return H=k,ut=k,Ke=ae=tt(),Te()&&(Qe(ae)||ce({},h.InvalidLHSInAssignment),w&&ae.type===p.Identifier&&D(ae.name)&&ce(H,h.StrictLHSAssignment),H=Ie(),De=it(),Ke=j.markEnd(j.createAssignmentExpression(H.value,ae,De),ut)),Ke}function vt(){var H,ae=k;if(H=it(),J(",")){for(H=j.createSequenceExpression([H]);y<E&&J(",");)Ie(),H.expressions.push(it());j.markEnd(H,ae)}return H}function rr(){for(var H=[],ae;y<E&&!(J("}")||(ae=dn(),typeof ae>"u"));)H.push(ae);return H}function Zt(){var H,ae;return ae=k,be("{"),H=rr(),be("}"),j.markEnd(j.createBlockStatement(H),ae)}function mr(){var H,ae;return ae=k,H=Ie(),H.type!==a.Identifier&&Ce(H),j.markEnd(j.createIdentifier(H.value),ae)}function Cr(H){var ae=null,De,Ke;return Ke=k,De=mr(),w&&D(De.name)&&ce({},h.StrictVarName),H==="const"?(be("="),ae=it()):J("=")&&(Ie(),ae=it()),j.markEnd(j.createVariableDeclarator(De,ae),Ke)}function ts(H){var ae=[];do{if(ae.push(Cr(H)),!J(","))break;Ie()}while(y<E);return ae}function As(){var H;return We("var"),H=ts(),Me(),j.createVariableDeclaration(H,"var")}function Fs(H){var ae,De;return De=k,We(H),ae=ts(H),Me(),j.markEnd(j.createVariableDeclaration(ae,H),De)}function Ve(){return be(";"),j.createEmptyStatement()}function Ot(){var H=vt();return Me(),j.createExpressionStatement(H)}function It(){var H,ae,De;return We("if"),be("("),H=vt(),be(")"),ae=Pr(),se("else")?(Ie(),De=Pr()):De=null,j.createIfStatement(H,ae,De)}function Dt(){var H,ae,De;return We("do"),De=A.inIteration,A.inIteration=!0,H=Pr(),A.inIteration=De,We("while"),be("("),ae=vt(),be(")"),J(";")&&Ie(),j.createDoWhileStatement(H,ae)}function Ct(){var H,ae,De;return We("while"),be("("),H=vt(),be(")"),De=A.inIteration,A.inIteration=!0,ae=Pr(),A.inIteration=De,j.createWhileStatement(H,ae)}function or(){var H,ae,De;return De=k,H=Ie(),ae=ts(),j.markEnd(j.createVariableDeclaration(ae,H.value),De)}function rn(){var H,ae,De,Ke,ut,kt,pr;return H=ae=De=null,We("for"),be("("),J(";")?Ie():(se("var")||se("let")?(A.allowIn=!1,H=or(),A.allowIn=!0,H.declarations.length===1&&se("in")&&(Ie(),Ke=H,ut=vt(),H=null)):(A.allowIn=!1,H=vt(),A.allowIn=!0,se("in")&&(Qe(H)||ce({},h.InvalidLHSInForIn),Ie(),Ke=H,ut=vt(),H=null)),typeof Ke>"u"&&be(";")),typeof Ke>"u"&&(J(";")||(ae=vt()),be(";"),J(")")||(De=vt())),be(")"),pr=A.inIteration,A.inIteration=!0,kt=Pr(),A.inIteration=pr,typeof Ke>"u"?j.createForStatement(H,ae,De,kt):j.createForInStatement(Ke,ut,kt)}function $r(){var H=null,ae;return We("continue"),b.charCodeAt(y)===59?(Ie(),A.inIteration||ee({},h.IllegalContinue),j.createContinueStatement(null)):q()?(A.inIteration||ee({},h.IllegalContinue),j.createContinueStatement(null)):(k.type===a.Identifier&&(H=mr(),ae="$"+H.name,Object.prototype.hasOwnProperty.call(A.labelSet,ae)||ee({},h.UnknownLabel,H.name)),Me(),H===null&&!A.inIteration&&ee({},h.IllegalContinue),j.createContinueStatement(H))}function oi(){var H=null,ae;return We("break"),b.charCodeAt(y)===59?(Ie(),A.inIteration||A.inSwitch||ee({},h.IllegalBreak),j.createBreakStatement(null)):q()?(A.inIteration||A.inSwitch||ee({},h.IllegalBreak),j.createBreakStatement(null)):(k.type===a.Identifier&&(H=mr(),ae="$"+H.name,Object.prototype.hasOwnProperty.call(A.labelSet,ae)||ee({},h.UnknownLabel,H.name)),Me(),H===null&&!(A.inIteration||A.inSwitch)&&ee({},h.IllegalBreak),j.createBreakStatement(H))}function Ei(){var H=null;return We("return"),A.inFunctionBody||ce({},h.IllegalReturn),b.charCodeAt(y)===32&&F(b.charCodeAt(y+1))?(H=vt(),Me(),j.createReturnStatement(H)):q()?j.createReturnStatement(null):(J(";")||!J("}")&&k.type!==a.EOF&&(H=vt()),Me(),j.createReturnStatement(H))}function xs(){var H,ae;return w&&(_(),ce({},h.StrictModeWith)),We("with"),be("("),H=vt(),be(")"),ae=Pr(),j.createWithStatement(H,ae)}function $t(){var H,ae=[],De,Ke;for(Ke=k,se("default")?(Ie(),H=null):(We("case"),H=vt()),be(":");y<E&&!(J("}")||se("default")||se("case"));)De=Pr(),ae.push(De);return j.markEnd(j.createSwitchCase(H,ae),Ke)}function Wr(){var H,ae,De,Ke,ut;if(We("switch"),be("("),H=vt(),be(")"),be("{"),ae=[],J("}"))return Ie(),j.createSwitchStatement(H,ae);for(Ke=A.inSwitch,A.inSwitch=!0,ut=!1;y<E&&!J("}");)De=$t(),De.test===null&&(ut&&ee({},h.MultipleDefaultsInSwitch),ut=!0),ae.push(De);return A.inSwitch=Ke,be("}"),j.createSwitchStatement(H,ae)}function En(){var H;return We("throw"),q()&&ee({},h.NewlineAfterThrow),H=vt(),Me(),j.createThrowStatement(H)}function Ir(){var H,ae,De;return De=k,We("catch"),be("("),J(")")&&Ce(k),H=mr(),w&&D(H.name)&&ce({},h.StrictCatchVariable),be(")"),ae=Zt(),j.markEnd(j.createCatchClause(H,ae),De)}function Fn(){var H,ae=[],De=null;return We("try"),H=Zt(),se("catch")&&ae.push(Ir()),se("finally")&&(Ie(),De=Zt()),ae.length===0&&!De&&ee({},h.NoCatchOrFinally),j.createTryStatement(H,[],ae,De)}function us(){return We("debugger"),Me(),j.createDebuggerStatement()}function Pr(){var H=k.type,ae,De,Ke,ut;if(H===a.EOF&&Ce(k),H===a.Punctuator&&k.value==="{")return Zt();if(ut=k,H===a.Punctuator)switch(k.value){case";":return j.markEnd(Ve(),ut);case"(":return j.markEnd(Ot(),ut)}if(H===a.Keyword)switch(k.value){case"break":return j.markEnd(oi(),ut);case"continue":return j.markEnd($r(),ut);case"debugger":return j.markEnd(us(),ut);case"do":return j.markEnd(Dt(),ut);case"for":return j.markEnd(rn(),ut);case"function":return j.markEnd(Yn(),ut);case"if":return j.markEnd(It(),ut);case"return":return j.markEnd(Ei(),ut);case"switch":return j.markEnd(Wr(),ut);case"throw":return j.markEnd(En(),ut);case"try":return j.markEnd(Fn(),ut);case"var":return j.markEnd(As(),ut);case"while":return j.markEnd(Ct(),ut);case"with":return j.markEnd(xs(),ut)}return ae=vt(),ae.type===p.Identifier&&J(":")?(Ie(),Ke="$"+ae.name,Object.prototype.hasOwnProperty.call(A.labelSet,Ke)&&ee({},h.Redeclaration,"Label",ae.name),A.labelSet[Ke]=!0,De=Pr(),delete A.labelSet[Ke],j.markEnd(j.createLabeledStatement(ae,De),ut)):(Me(),j.markEnd(j.createExpressionStatement(ae),ut))}function Cn(){var H,ae=[],De,Ke,ut,kt,pr,Vr,ns,$n;for($n=k,be("{");y<E&&!(k.type!==a.StringLiteral||(De=k,H=dn(),ae.push(H),H.expression.type!==p.Literal));)Ke=b.slice(De.start+1,De.end-1),Ke==="use strict"?(w=!0,ut&&ce(ut,h.StrictOctalLiteral)):!ut&&De.octal&&(ut=De);for(kt=A.labelSet,pr=A.inIteration,Vr=A.inSwitch,ns=A.inFunctionBody,A.labelSet={},A.inIteration=!1,A.inSwitch=!1,A.inFunctionBody=!0;y<E&&!(J("}")||(H=dn(),typeof H>"u"));)ae.push(H);return be("}"),A.labelSet=kt,A.inIteration=pr,A.inSwitch=Vr,A.inFunctionBody=ns,j.markEnd(j.createBlockStatement(ae),$n)}function Gr(H){var ae,De=[],Ke,ut,kt,pr,Vr;if(be("("),!J(")"))for(kt={};y<E&&(Ke=k,ae=mr(),pr="$"+Ke.value,w?(D(Ke.value)&&(ut=Ke,Vr=h.StrictParamName),Object.prototype.hasOwnProperty.call(kt,pr)&&(ut=Ke,Vr=h.StrictParamDupe)):H||(D(Ke.value)?(H=Ke,Vr=h.StrictParamName):W(Ke.value)?(H=Ke,Vr=h.StrictReservedWord):Object.prototype.hasOwnProperty.call(kt,pr)&&(H=Ke,Vr=h.StrictParamDupe)),De.push(ae),kt[pr]=!0,!J(")"));)be(",");return be(")"),{params:De,stricted:ut,firstRestricted:H,message:Vr}}function Yn(){var H,ae=[],De,Ke,ut,kt,pr,Vr,ns,$n;return $n=k,We("function"),Ke=k,H=mr(),w?D(Ke.value)&&ce(Ke,h.StrictFunctionName):D(Ke.value)?(pr=Ke,Vr=h.StrictFunctionName):W(Ke.value)&&(pr=Ke,Vr=h.StrictReservedWord),kt=Gr(pr),ae=kt.params,ut=kt.stricted,pr=kt.firstRestricted,kt.message&&(Vr=kt.message),ns=w,De=Cn(),w&&pr&&ee(pr,Vr),w&&ut&&ce(ut,Vr),w=ns,j.markEnd(j.createFunctionDeclaration(H,ae,[],De),$n)}function cn(){var H,ae=null,De,Ke,ut,kt,pr=[],Vr,ns,$n;return $n=k,We("function"),J("(")||(H=k,ae=mr(),w?D(H.value)&&ce(H,h.StrictFunctionName):D(H.value)?(Ke=H,ut=h.StrictFunctionName):W(H.value)&&(Ke=H,ut=h.StrictReservedWord)),kt=Gr(Ke),pr=kt.params,De=kt.stricted,Ke=kt.firstRestricted,kt.message&&(ut=kt.message),ns=w,Vr=Cn(),w&&Ke&&ee(Ke,ut),w&&De&&ce(De,ut),w=ns,j.markEnd(j.createFunctionExpression(ae,pr,[],Vr),$n)}function dn(){if(k.type===a.Keyword)switch(k.value){case"const":case"let":return Fs(k.value);case"function":return Yn();default:return Pr()}if(k.type!==a.EOF)return Pr()}function ho(){for(var H,ae=[],De,Ke,ut;y<E&&(De=k,!(De.type!==a.StringLiteral||(H=dn(),ae.push(H),H.expression.type!==p.Literal)));)Ke=b.slice(De.start+1,De.end-1),Ke==="use strict"?(w=!0,ut&&ce(ut,h.StrictOctalLiteral)):!ut&&De.octal&&(ut=De);for(;y<E&&(H=dn(),!(typeof H>"u"));)ae.push(H);return ae}function jt(){var H,ae;return _(),K(),ae=k,w=!1,H=ho(),j.markEnd(j.createProgram(H),ae)}function Vs(){var H,ae,De,Ke=[];for(H=0;H<R.tokens.length;++H)ae=R.tokens[H],De={type:ae.type,value:ae.value},R.range&&(De.range=ae.range),R.loc&&(De.loc=ae.loc),Ke.push(De);R.tokens=Ke}function rs(H,ae){var De,Ke,ut;De=String,typeof H!="string"&&!(H instanceof String)&&(H=De(H)),j=m,b=H,y=0,C=b.length>0?1:0,T=0,E=b.length,k=null,A={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},R={},ae=ae||{},ae.tokens=!0,R.tokens=[],R.tokenize=!0,R.openParenToken=-1,R.openCurlyToken=-1,R.range=typeof ae.range=="boolean"&&ae.range,R.loc=typeof ae.loc=="boolean"&&ae.loc,typeof ae.comment=="boolean"&&ae.comment&&(R.comments=[]),typeof ae.tolerant=="boolean"&&ae.tolerant&&(R.errors=[]);try{if(K(),k.type===a.EOF)return R.tokens;for(Ke=Ie();k.type!==a.EOF;)try{Ke=Ie()}catch(kt){if(Ke=k,R.errors){R.errors.push(kt);break}else throw kt}Vs(),ut=R.tokens,typeof R.comments<"u"&&(ut.comments=R.comments),typeof R.errors<"u"&&(ut.errors=R.errors)}catch(kt){throw kt}finally{R={}}return ut}function Xs(H,ae){var De,Ke;Ke=String,typeof H!="string"&&!(H instanceof String)&&(H=Ke(H)),j=m,b=H,y=0,C=b.length>0?1:0,T=0,E=b.length,k=null,A={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},R={},typeof ae<"u"&&(R.range=typeof ae.range=="boolean"&&ae.range,R.loc=typeof ae.loc=="boolean"&&ae.loc,R.attachComment=typeof ae.attachComment=="boolean"&&ae.attachComment,R.loc&&ae.source!==null&&ae.source!==void 0&&(R.source=Ke(ae.source)),typeof ae.tokens=="boolean"&&ae.tokens&&(R.tokens=[]),typeof ae.comment=="boolean"&&ae.comment&&(R.comments=[]),typeof ae.tolerant=="boolean"&&ae.tolerant&&(R.errors=[]),R.attachComment&&(R.range=!0,R.comments=[],R.bottomRightStack=[],R.trailingComments=[],R.leadingComments=[]));try{De=jt(),typeof R.comments<"u"&&(De.comments=R.comments),typeof R.tokens<"u"&&(Vs(),De.tokens=R.tokens),typeof R.errors<"u"&&(De.errors=R.errors)}catch(ut){throw ut}finally{R={}}return De}o.version="1.2.2",o.tokenize=rs,o.parse=Xs,o.Syntax=(function(){var H,ae={};typeof Object.create=="function"&&(ae=Object.create(null));for(H in p)p.hasOwnProperty(H)&&(ae[H]=p[H]);return typeof Object.freeze=="function"&&Object.freeze(ae),ae})()})},{}],1:[function(r,n,i){(function(o){var a=(function(){var l={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(x,m,b,w,y,C,T){w.ast||(w.ast=d,d.initialize());var E=C.length-1;switch(y){case 1:return w.ast.set({expression:{type:"root",value:C[E]}}),w.ast.unshift(),w.ast.yield();case 2:return w.ast.set({expression:{type:"root",value:C[E-1]}}),w.ast.unshift(),w.ast.yield();case 3:return w.ast.unshift(),w.ast.yield();case 4:return w.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:C[E-1]}}),w.ast.unshift(),w.ast.yield();case 5:break;case 6:break;case 7:w.ast.set({operation:"member"}),w.ast.push();break;case 8:w.ast.set({operation:"subscript"}),w.ast.push();break;case 9:w.ast.set({scope:"child"});break;case 10:w.ast.set({scope:"descendant"});break;case 11:break;case 12:w.ast.set({scope:"child",operation:"member"});break;case 13:break;case 14:w.ast.set({expression:{type:"wildcard",value:C[E]}});break;case 15:w.ast.set({expression:{type:"identifier",value:C[E]}});break;case 16:w.ast.set({expression:{type:"script_expression",value:C[E]}});break;case 17:w.ast.set({expression:{type:"numeric_literal",value:parseInt(C[E])}});break;case 18:break;case 19:w.ast.set({scope:"child"});break;case 20:w.ast.set({scope:"descendant"});break;case 21:break;case 22:break;case 23:break;case 24:C[E].length>1?w.ast.set({expression:{type:"union",value:C[E]}}):this.$=C[E];break;case 25:this.$=[C[E]];break;case 26:this.$=C[E-2].concat(C[E]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(C[E])}},w.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:C[E]}},w.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:C[E]}},w.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:C[E]}},w.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:C[E]}},w.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:C[E]}},w.ast.set(this.$);break;case 33:this.$=C[E];break;case 34:this.$=C[E];break}},table:[{3:1,4:[1,2],6:3,13:4,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,12],12:[2,12],14:[2,12],22:[2,12]},{1:[2,14],12:[2,14],14:[2,14],22:[2,14]},{1:[2,15],12:[2,15],14:[2,15],22:[2,15]},{1:[2,16],12:[2,16],14:[2,16],22:[2,16]},{1:[2,17],12:[2,17],14:[2,17],22:[2,17]},{1:[2,18],12:[2,18],14:[2,18],22:[2,18]},{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,5],12:[2,5],14:[2,5],22:[2,5]},{1:[2,7],12:[2,7],14:[2,7],22:[2,7]},{1:[2,8],12:[2,8],14:[2,8],22:[2,8]},{1:[2,9],12:[2,9],14:[2,9],22:[2,9]},{1:[2,10],12:[2,10],14:[2,10],22:[2,10]},{1:[2,19],12:[2,19],14:[2,19],22:[2,19]},{1:[2,20],12:[2,20],14:[2,20],22:[2,20]},{13:23,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{13:24,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9],22:[1,25]},{15:[1,29],17:[1,30],18:[1,33],23:26,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,6],12:[2,6],14:[2,6],22:[2,6]},{1:[2,11],12:[2,11],14:[2,11],22:[2,11]},{1:[2,13],12:[2,13],14:[2,13],22:[2,13]},{15:[1,29],17:[1,30],18:[1,33],23:38,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},{24:[2,25],28:[2,25]},{24:[2,27],28:[2,27]},{24:[2,28],28:[2,28]},{24:[2,29],28:[2,29]},{24:[2,33],28:[2,33]},{24:[2,34],28:[2,34]},{24:[1,41]},{1:[2,21],12:[2,21],14:[2,21],22:[2,21]},{18:[1,33],27:42,29:34,30:[1,35],32:[1,36],33:[1,37]},{1:[2,22],12:[2,22],14:[2,22],22:[2,22]},{24:[2,26],28:[2,26]}],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(x,m){if(m.recoverable)this.trace(x);else throw new Error(x)},parse:function(x){var m=this,b=[0],w=[null],y=[],C=this.table,T="",E=0,j=0,k=2,A=1,R=y.slice.call(arguments,1);this.lexer.setInput(x),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc>"u"&&(this.lexer.yylloc={});var M=this.lexer.yylloc;y.push(M);var P=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function I(){var fe;return fe=m.lexer.lex()||A,typeof fe!="number"&&(fe=m.symbols_[fe]||fe),fe}for(var O,G,B,F,z={},$,W,D,oe;;){if(G=b[b.length-1],this.defaultActions[G]?B=this.defaultActions[G]:((O===null||typeof O>"u")&&(O=I()),B=C[G]&&C[G][O]),typeof B>"u"||!B.length||!B[0]){var Z="";oe=[];for($ in C[G])this.terminals_[$]&&$>k&&oe.push("'"+this.terminals_[$]+"'");this.lexer.showPosition?Z="Parse error on line "+(E+1)+`:
`+this.lexer.showPosition()+`
Expecting `+oe.join(", ")+", got '"+(this.terminals_[O]||O)+"'":Z="Parse error on line "+(E+1)+": Unexpected "+(O==A?"end of input":"'"+(this.terminals_[O]||O)+"'"),this.parseError(Z,{text:this.lexer.match,token:this.terminals_[O]||O,line:this.lexer.yylineno,loc:M,expected:oe})}if(B[0]instanceof Array&&B.length>1)throw new Error("Parse Error: multiple actions possible at state: "+G+", token: "+O);switch(B[0]){case 1:b.push(O),w.push(this.lexer.yytext),y.push(this.lexer.yylloc),b.push(B[1]),O=null,j=this.lexer.yyleng,T=this.lexer.yytext,E=this.lexer.yylineno,M=this.lexer.yylloc;break;case 2:if(W=this.productions_[B[1]][1],z.$=w[w.length-W],z._$={first_line:y[y.length-(W||1)].first_line,last_line:y[y.length-1].last_line,first_column:y[y.length-(W||1)].first_column,last_column:y[y.length-1].last_column},P&&(z._$.range=[y[y.length-(W||1)].range[0],y[y.length-1].range[1]]),F=this.performAction.apply(z,[T,j,E,this.yy,B[1],w,y].concat(R)),typeof F<"u")return F;W&&(b=b.slice(0,-1*W*2),w=w.slice(0,-1*W),y=y.slice(0,-1*W)),b.push(this.productions_[B[1]][0]),w.push(z.$),y.push(z._$),D=C[b[b.length-2]][b[b.length-1]],b.push(D);break;case 3:return!0}}return!0}},d={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(h){for(var x in h)this._node[x]=h[x];return this._node},node:function(h){return arguments.length&&(this._node=h),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var h=this._nodes;return this.initialize(),h}},p=(function(){var h={EOF:1,parseError:function(m,b){if(this.yy.parser)this.yy.parser.parseError(m,b);else throw new Error(m)},setInput:function(x){return this._input=x,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var x=this._input[0];this.yytext+=x,this.yyleng++,this.offset++,this.match+=x,this.matched+=x;var m=x.match(/(?:\r\n?|\n).*/g);return m?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),x},unput:function(x){var m=x.length,b=x.split(/(?:\r\n?|\n)/g);this._input=x+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-m-1),this.offset-=m;var w=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),b.length-1&&(this.yylineno-=b.length-1);var y=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:b?(b.length===w.length?this.yylloc.first_column:0)+w[w.length-b.length].length-b[0].length:this.yylloc.first_column-m},this.options.ranges&&(this.yylloc.range=[y[0],y[0]+this.yyleng-m]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(x){this.unput(this.match.slice(x))},pastInput:function(){var x=this.matched.substr(0,this.matched.length-this.match.length);return(x.length>20?"...":"")+x.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var x=this.match;return x.length<20&&(x+=this._input.substr(0,20-x.length)),(x.substr(0,20)+(x.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var x=this.pastInput(),m=new Array(x.length+1).join("-");return x+this.upcomingInput()+`
`+m+"^"},test_match:function(x,m){var b,w,y;if(this.options.backtrack_lexer&&(y={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(y.yylloc.range=this.yylloc.range.slice(0))),w=x[0].match(/(?:\r\n?|\n).*/g),w&&(this.yylineno+=w.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:w?w[w.length-1].length-w[w.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+x[0].length},this.yytext+=x[0],this.match+=x[0],this.matches=x,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(x[0].length),this.matched+=x[0],b=this.performAction.call(this,this.yy,this,m,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),b)return b;if(this._backtrack){for(var C in y)this[C]=y[C];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var x,m,b,w;this._more||(this.yytext="",this.match="");for(var y=this._currentRules(),C=0;C<y.length;C++)if(b=this._input.match(this.rules[y[C]]),b&&(!m||b[0].length>m[0].length)){if(m=b,w=C,this.options.backtrack_lexer){if(x=this.test_match(b,y[C]),x!==!1)return x;if(this._backtrack){m=!1;continue}else return!1}else if(!this.options.flex)break}return m?(x=this.test_match(m,y[w]),x!==!1?x:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var m=this.next();return m||this.lex()},begin:function(m){this.conditionStack.push(m)},popState:function(){var m=this.conditionStack.length-1;return m>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(m){return m=this.conditionStack.length-1-Math.abs(m||0),m>=0?this.conditionStack[m]:"INITIAL"},pushState:function(m){this.begin(m)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(m,b,w,y){switch(w){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return b.yytext=b.yytext.substr(1,b.yyleng-2),32;case 11:return b.yytext=b.yytext.substr(1,b.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return h})();l.lexer=p;function f(){this.yy={}}return f.prototype=l,l.Parser=f,new f})();typeof r<"u"&&typeof window<"u"&&(i.parser=a,i.Parser=a.Parser,i.parse=function(){return a.parse.apply(a,arguments)},i.main=function(d){d[1]||(console.log("Usage: "+d[0]+" FILE"),o.exit(1));var p=r("fs").readFileSync(r("path").normalize(d[1]),"utf8");return i.parser.parse(p)},typeof window<"u"&&r.main===n&&i.main(o.argv.slice(1)))}).call(this,r("_process"))},{_process:14,fs:12,path:13}],2:[function(r,n,i){n.exports={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"}},{}],3:[function(r,n,i){var o=r("./dict"),a=r("fs"),l={lex:{macros:{esc:"\\\\",int:o.integer},rules:[["\\$","return 'DOLLAR'"],["\\.\\.","return 'DOT_DOT'"],["\\.","return 'DOT'"],["\\*","return 'STAR'"],[o.identifier,"return 'IDENTIFIER'"],["\\[","return '['"],["\\]","return ']'"],[",","return ','"],["({int})?\\:({int})?(\\:({int})?)?","return 'ARRAY_SLICE'"],["{int}","return 'INTEGER'"],[o.qq_string,"yytext = yytext.substr(1,yyleng-2); return 'QQ_STRING';"],[o.q_string,"yytext = yytext.substr(1,yyleng-2); return 'Q_STRING';"],["\\(.+?\\)(?=\\])","return 'SCRIPT_EXPRESSION'"],["\\?\\(.+?\\)(?=\\])","return 'FILTER_EXPRESSION'"]]},start:"JSON_PATH",bnf:{JSON_PATH:[["DOLLAR",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["DOLLAR PATH_COMPONENTS",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["LEADING_CHILD_MEMBER_EXPRESSION","yy.ast.unshift(); return yy.ast.yield()"],["LEADING_CHILD_MEMBER_EXPRESSION PATH_COMPONENTS",'yy.ast.set({ operation: "member", scope: "child", expression: { type: "identifier", value: $1 }}); yy.ast.unshift(); return yy.ast.yield()']],PATH_COMPONENTS:[["PATH_COMPONENT",""],["PATH_COMPONENTS PATH_COMPONENT",""]],PATH_COMPONENT:[["MEMBER_COMPONENT",'yy.ast.set({ operation: "member" }); yy.ast.push()'],["SUBSCRIPT_COMPONENT",'yy.ast.set({ operation: "subscript" }); yy.ast.push() ']],MEMBER_COMPONENT:[["CHILD_MEMBER_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_MEMBER_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_MEMBER_COMPONENT:[["DOT MEMBER_EXPRESSION",""]],LEADING_CHILD_MEMBER_EXPRESSION:[["MEMBER_EXPRESSION",'yy.ast.set({ scope: "child", operation: "member" })']],DESCENDANT_MEMBER_COMPONENT:[["DOT_DOT MEMBER_EXPRESSION",""]],MEMBER_EXPRESSION:[["STAR",'yy.ast.set({ expression: { type: "wildcard", value: $1 } })'],["IDENTIFIER",'yy.ast.set({ expression: { type: "identifier", value: $1 } })'],["SCRIPT_EXPRESSION",'yy.ast.set({ expression: { type: "script_expression", value: $1 } })'],["INTEGER",'yy.ast.set({ expression: { type: "numeric_literal", value: parseInt($1) } })'],["END",""]],SUBSCRIPT_COMPONENT:[["CHILD_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_SUBSCRIPT_COMPONENT:[["[ SUBSCRIPT ]",""]],DESCENDANT_SUBSCRIPT_COMPONENT:[["DOT_DOT [ SUBSCRIPT ]",""]],SUBSCRIPT:[["SUBSCRIPT_EXPRESSION",""],["SUBSCRIPT_EXPRESSION_LIST",'$1.length > 1? yy.ast.set({ expression: { type: "union", value: $1 } }) : $$ = $1']],SUBSCRIPT_EXPRESSION_LIST:[["SUBSCRIPT_EXPRESSION_LISTABLE","$$ = [$1]"],["SUBSCRIPT_EXPRESSION_LIST , SUBSCRIPT_EXPRESSION_LISTABLE","$$ = $1.concat($3)"]],SUBSCRIPT_EXPRESSION_LISTABLE:[["INTEGER",'$$ = { expression: { type: "numeric_literal", value: parseInt($1) } }; yy.ast.set($$)'],["STRING_LITERAL",'$$ = { expression: { type: "string_literal", value: $1 } }; yy.ast.set($$)'],["ARRAY_SLICE",'$$ = { expression: { type: "slice", value: $1 } }; yy.ast.set($$)']],SUBSCRIPT_EXPRESSION:[["STAR",'$$ = { expression: { type: "wildcard", value: $1 } }; yy.ast.set($$)'],["SCRIPT_EXPRESSION",'$$ = { expression: { type: "script_expression", value: $1 } }; yy.ast.set($$)'],["FILTER_EXPRESSION",'$$ = { expression: { type: "filter_expression", value: $1 } }; yy.ast.set($$)']],STRING_LITERAL:[["QQ_STRING","$$ = $1"],["Q_STRING","$$ = $1"]]}};a.readFileSync&&(l.moduleInclude=a.readFileSync(r.resolve("../include/module.js")),l.actionInclude=a.readFileSync(r.resolve("../include/action.js"))),n.exports=l},{"./dict":2,fs:12}],4:[function(r,n,i){var o=r("./aesprim"),a=r("./slice"),l=r("static-eval"),d=r("underscore").uniq,p=function(){return this.initialize.apply(this,arguments)};p.prototype.initialize=function(){this.traverse=m(!0),this.descend=m()},p.prototype.keys=Object.keys,p.prototype.resolve=function(E){var j=[E.operation,E.scope,E.expression.type].join("-"),k=this._fns[j];if(!k)throw new Error("couldn't resolve key: "+j);return k.bind(this)},p.prototype.register=function(E,j){if(!j instanceof Function)throw new Error("handler must be a function");this._fns[E]=j},p.prototype._fns={"member-child-identifier":function(E,j){var k=E.expression.value,A=j.value;if(A instanceof Object&&k in A)return[{value:A[k],path:j.path.concat(k)}]},"member-descendant-identifier":w(function(E,j,k){return E==k}),"subscript-child-numeric_literal":b(function(E,j,k){return E===k}),"member-child-numeric_literal":b(function(E,j,k){return String(E)===String(k)}),"subscript-descendant-numeric_literal":w(function(E,j,k){return E===k}),"member-child-wildcard":b(function(){return!0}),"member-descendant-wildcard":w(function(){return!0}),"subscript-descendant-wildcard":w(function(){return!0}),"subscript-child-wildcard":b(function(){return!0}),"subscript-child-slice":function(E,j){if(h(j.value)){var k=E.expression.value.split(":").map(T),A=j.value.map(function(R,M){return{value:R,path:j.path.concat(M)}});return a.apply(null,[A].concat(k))}},"subscript-child-union":function(E,j){var k=[];return E.expression.value.forEach(function(A){var R={operation:"subscript",scope:"child",expression:A.expression},M=this.resolve(R),P=M(R,j);P&&(k=k.concat(P))},this),C(k)},"subscript-descendant-union":function(E,j,k){var A=r(".."),R=this,M=[],P=A.nodes(j,"$..*").slice(1);return P.forEach(function(I){M.length>=k||E.expression.value.forEach(function(O){var G={operation:"subscript",scope:"child",expression:O.expression},B=R.resolve(G),F=B(G,I);M=M.concat(F)})}),C(M)},"subscript-child-filter_expression":function(E,j,k){var A=E.expression.value.slice(2,-1),R=o.parse(A).body[0].expression,M=function(P,I){return y(R,{"@":I})};return this.descend(j,null,M,k)},"subscript-descendant-filter_expression":function(E,j,k){var A=E.expression.value.slice(2,-1),R=o.parse(A).body[0].expression,M=function(P,I){return y(R,{"@":I})};return this.traverse(j,null,M,k)},"subscript-child-script_expression":function(E,j){var k=E.expression.value.slice(1,-1);return f(j,k,"$[{{value}}]")},"member-child-script_expression":function(E,j){var k=E.expression.value.slice(1,-1);return f(j,k,"$.{{value}}")},"member-descendant-script_expression":function(E,j){var k=E.expression.value.slice(1,-1);return f(j,k,"$..value")}},p.prototype._fns["subscript-child-string_literal"]=p.prototype._fns["member-child-identifier"],p.prototype._fns["member-descendant-numeric_literal"]=p.prototype._fns["subscript-descendant-string_literal"]=p.prototype._fns["member-descendant-identifier"];function f(E,j,k){var A=r("./index"),R=o.parse(j).body[0].expression,M=y(R,{"@":E.value}),P=k.replace(/\{\{\s*value\s*\}\}/g,M),I=A.nodes(E.value,P);return I.forEach(function(O){O.path=E.path.concat(O.path.slice(1))}),I}function h(E){return Array.isArray(E)}function x(E){return E&&!(E instanceof Array)&&E instanceof Object}function m(E){return function(j,k,A,R){var M=j.value,P=j.path,I=[],O=function(G,B){h(G)?(G.forEach(function(F,z){I.length>=R||A(z,F,k)&&I.push({path:B.concat(z),value:F})}),G.forEach(function(F,z){I.length>=R||E&&O(F,B.concat(z))})):x(G)&&(this.keys(G).forEach(function(F){I.length>=R||A(F,G[F],k)&&I.push({path:B.concat(F),value:G[F]})}),this.keys(G).forEach(function(F){I.length>=R||E&&O(G[F],B.concat(F))}))}.bind(this);return O(M,P),I}}function b(E){return function(j,k,A){return this.descend(k,j.expression.value,E,A)}}function w(E){return function(j,k,A){return this.traverse(k,j.expression.value,E,A)}}function y(){try{return l.apply(this,arguments)}catch{}}function C(E){return E=E.filter(function(j){return j}),d(E,function(j){return j.path.map(function(k){return String(k).replace("-","--")}).join("-")})}function T(E){var j=String(E);return j.match(/^-?[0-9]+$/)?parseInt(j):null}n.exports=p},{"..":"jsonpath","./aesprim":"./aesprim","./index":5,"./slice":7,"static-eval":15,underscore:12}],5:[function(r,n,i){var o=r("assert"),a=r("./dict"),l=r("./parser"),d=r("./handlers"),p=function(){this.initialize.apply(this,arguments)};p.prototype.initialize=function(){this.parser=new l,this.handlers=new d},p.prototype.parse=function(x){return o.ok(f(x),"we need a path"),this.parser.parse(x)},p.prototype.parent=function(x,m){o.ok(x instanceof Object,"obj needs to be an object"),o.ok(m,"we need a path");var b=this.nodes(x,m)[0];return b.path.pop(),this.value(x,b.path)},p.prototype.apply=function(x,m,b){o.ok(x instanceof Object,"obj needs to be an object"),o.ok(m,"we need a path"),o.equal(typeof b,"function","fn needs to be function");var w=this.nodes(x,m).sort(function(y,C){return C.path.length-y.path.length});return w.forEach(function(y){var C=y.path.pop(),T=this.value(x,this.stringify(y.path)),E=y.value=b.call(x,T[C]);T[C]=E},this),w},p.prototype.value=function(x,m,b){if(o.ok(x instanceof Object,"obj needs to be an object"),o.ok(m,"we need a path"),arguments.length>=3){var w=this.nodes(x,m).shift();if(!w)return this._vivify(x,m,b);var y=w.path.slice(-1).shift(),C=this.parent(x,this.stringify(w.path));C[y]=b}return this.query(x,this.stringify(m),1).shift()},p.prototype._vivify=function(x,m,b){var w=this;o.ok(x instanceof Object,"obj needs to be an object"),o.ok(m,"we need a path");var y=this.parser.parse(m).map(function(T){return T.expression.value}),C=function(T,E){var j=T.pop(),k=w.value(x,T);k||(C(T.concat(),typeof j=="string"?{}:[]),k=w.value(x,T)),k[j]=E};return C(y,b),this.query(x,m)[0]},p.prototype.query=function(x,m,b){o.ok(x instanceof Object,"obj needs to be an object"),o.ok(f(m),"we need a path");var w=this.nodes(x,m,b).map(function(y){return y.value});return w},p.prototype.paths=function(x,m,b){o.ok(x instanceof Object,"obj needs to be an object"),o.ok(m,"we need a path");var w=this.nodes(x,m,b).map(function(y){return y.path});return w},p.prototype.nodes=function(x,m,b){if(o.ok(x instanceof Object,"obj needs to be an object"),o.ok(m,"we need a path"),b===0)return[];var w=this.parser.parse(m),y=this.handlers,C=[{path:["$"],value:x}],T=[];return w.length&&w[0].expression.type=="root"&&w.shift(),w.length?(w.forEach(function(E,j){if(!(T.length>=b)){var k=y.resolve(E),A=[];C.forEach(function(R){if(!(T.length>=b)){var M=k(E,R,b);j==w.length-1?T=T.concat(M||[]):A=A.concat(M||[])}}),C=A}}),b?T.slice(0,b):T):C},p.prototype.stringify=function(x){o.ok(x,"we need a path");var m="$",b={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return x=this._normalize(x),x.forEach(function(w){if(w.expression.type!="root"){var y=[w.scope,w.operation].join("-"),C=b[y],T;if(w.expression.type=="string_literal"?T=JSON.stringify(w.expression.value):T=w.expression.value,!C)throw new Error("couldn't find template "+y);m+=C.replace(/{{value}}/,T)}}),m},p.prototype._normalize=function(x){if(o.ok(x,"we need a path"),typeof x=="string")return this.parser.parse(x);if(Array.isArray(x)&&typeof x[0]=="string"){var m=[{expression:{type:"root",value:"$"}}];return x.forEach(function(b,w){if(!(b=="$"&&w===0))if(typeof b=="string"&&b.match("^"+a.identifier+"$"))m.push({operation:"member",scope:"child",expression:{value:b,type:"identifier"}});else{var y=typeof b=="number"?"numeric_literal":"string_literal";m.push({operation:"subscript",scope:"child",expression:{value:b,type:y}})}}),m}else if(Array.isArray(x)&&typeof x[0]=="object")return x;throw new Error("couldn't understand path "+x)};function f(x){return Object.prototype.toString.call(x)=="[object String]"}p.Handlers=d,p.Parser=l;var h=new p;h.JSONPath=p,n.exports=h},{"./dict":2,"./handlers":4,"./parser":6,assert:8}],6:[function(r,n,i){var o=r("./grammar"),a=r("../generated/parser"),l=function(){var d=new a.Parser,p=d.parseError;return d.yy.parseError=function(){d.yy.ast&&d.yy.ast.initialize(),p.apply(d,arguments)},d};l.grammar=o,n.exports=l},{"../generated/parser":1,"./grammar":3}],7:[function(r,n,i){n.exports=function(a,l,d,p){if(typeof l=="string")throw new Error("start cannot be a string");if(typeof d=="string")throw new Error("end cannot be a string");if(typeof p=="string")throw new Error("step cannot be a string");var f=a.length;if(p===0)throw new Error("step cannot be zero");if(p=p?o(p):1,l=l<0?f+l:l,d=d<0?f+d:d,l=o(l===0?0:l||(p>0?0:f-1)),d=o(d===0?0:d||(p>0?f:-1)),l=p>0?Math.max(0,l):Math.min(f,l),d=p>0?Math.min(d,f):Math.max(-1,d),p>0&&d<=l)return[];if(p<0&&l<=d)return[];for(var h=[],x=l;x!=d&&!(p<0&&x<=d||p>0&&x>=d);x+=p)h.push(a[x]);return h};function o(a){return String(a).match(/^[0-9]+$/)?parseInt(a):Number.isFinite(a)?parseInt(a,10):0}},{}],8:[function(r,n,i){var o=r("util/"),a=Array.prototype.slice,l=Object.prototype.hasOwnProperty,d=n.exports=m;d.AssertionError=function(k){this.name="AssertionError",this.actual=k.actual,this.expected=k.expected,this.operator=k.operator,k.message?(this.message=k.message,this.generatedMessage=!1):(this.message=h(this),this.generatedMessage=!0);var A=k.stackStartFunction||x;if(Error.captureStackTrace)Error.captureStackTrace(this,A);else{var R=new Error;if(R.stack){var M=R.stack,P=A.name,I=M.indexOf(`
`+P);if(I>=0){var O=M.indexOf(`
`,I+1);M=M.substring(O+1)}this.stack=M}}},o.inherits(d.AssertionError,Error);function p(j,k){return o.isUndefined(k)?""+k:o.isNumber(k)&&!isFinite(k)||o.isFunction(k)||o.isRegExp(k)?k.toString():k}function f(j,k){return o.isString(j)?j.length<k?j:j.slice(0,k):j}function h(j){return f(JSON.stringify(j.actual,p),128)+" "+j.operator+" "+f(JSON.stringify(j.expected,p),128)}function x(j,k,A,R,M){throw new d.AssertionError({message:A,actual:j,expected:k,operator:R,stackStartFunction:M})}d.fail=x;function m(j,k){j||x(j,!0,k,"==",d.ok)}d.ok=m,d.equal=function(k,A,R){k!=A&&x(k,A,R,"==",d.equal)},d.notEqual=function(k,A,R){k==A&&x(k,A,R,"!=",d.notEqual)},d.deepEqual=function(k,A,R){b(k,A)||x(k,A,R,"deepEqual",d.deepEqual)};function b(j,k){if(j===k)return!0;if(o.isBuffer(j)&&o.isBuffer(k)){if(j.length!=k.length)return!1;for(var A=0;A<j.length;A++)if(j[A]!==k[A])return!1;return!0}else return o.isDate(j)&&o.isDate(k)?j.getTime()===k.getTime():o.isRegExp(j)&&o.isRegExp(k)?j.source===k.source&&j.global===k.global&&j.multiline===k.multiline&&j.lastIndex===k.lastIndex&&j.ignoreCase===k.ignoreCase:!o.isObject(j)&&!o.isObject(k)?j==k:y(j,k)}function w(j){return Object.prototype.toString.call(j)=="[object Arguments]"}function y(j,k){if(o.isNullOrUndefined(j)||o.isNullOrUndefined(k)||j.prototype!==k.prototype)return!1;if(o.isPrimitive(j)||o.isPrimitive(k))return j===k;var A=w(j),R=w(k);if(A&&!R||!A&&R)return!1;if(A)return j=a.call(j),k=a.call(k),b(j,k);var M=E(j),P=E(k),I,O;if(M.length!=P.length)return!1;for(M.sort(),P.sort(),O=M.length-1;O>=0;O--)if(M[O]!=P[O])return!1;for(O=M.length-1;O>=0;O--)if(I=M[O],!b(j[I],k[I]))return!1;return!0}d.notDeepEqual=function(k,A,R){b(k,A)&&x(k,A,R,"notDeepEqual",d.notDeepEqual)},d.strictEqual=function(k,A,R){k!==A&&x(k,A,R,"===",d.strictEqual)},d.notStrictEqual=function(k,A,R){k===A&&x(k,A,R,"!==",d.notStrictEqual)};function C(j,k){return!j||!k?!1:Object.prototype.toString.call(k)=="[object RegExp]"?k.test(j):j instanceof k?!0:k.call({},j)===!0}function T(j,k,A,R){var M;o.isString(A)&&(R=A,A=null);try{k()}catch(P){M=P}if(R=(A&&A.name?" ("+A.name+").":".")+(R?" "+R:"."),j&&!M&&x(M,A,"Missing expected exception"+R),!j&&C(M,A)&&x(M,A,"Got unwanted exception"+R),j&&M&&A&&!C(M,A)||!j&&M)throw M}d.throws=function(j,k,A){T.apply(this,[!0].concat(a.call(arguments)))},d.doesNotThrow=function(j,k){T.apply(this,[!1].concat(a.call(arguments)))},d.ifError=function(j){if(j)throw j};var E=Object.keys||function(j){var k=[];for(var A in j)l.call(j,A)&&k.push(A);return k}},{"util/":11}],9:[function(r,n,i){typeof Object.create=="function"?n.exports=function(a,l){a.super_=l,a.prototype=Object.create(l.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(a,l){a.super_=l;var d=function(){};d.prototype=l.prototype,a.prototype=new d,a.prototype.constructor=a}},{}],10:[function(r,n,i){n.exports=function(a){return a&&typeof a=="object"&&typeof a.copy=="function"&&typeof a.fill=="function"&&typeof a.readUInt8=="function"}},{}],11:[function(r,n,i){(function(o,a){var l=/%[sdj%]/g;i.format=function(_){if(!P(_)){for(var Y=[],he=0;he<arguments.length;he++)Y.push(f(arguments[he]));return Y.join(" ")}for(var he=1,me=arguments,ge=me.length,le=String(_).replace(l,function(V){if(V==="%%")return"%";if(he>=ge)return V;switch(V){case"%s":return String(me[he++]);case"%d":return Number(me[he++]);case"%j":try{return JSON.stringify(me[he++])}catch{return"[Circular]"}default:return V}}),X=me[he];he<ge;X=me[++he])A(X)||!B(X)?le+=" "+X:le+=" "+f(X);return le},i.deprecate=function(_,Y){if(O(a.process))return function(){return i.deprecate(_,Y).apply(this,arguments)};if(o.noDeprecation===!0)return _;var he=!1;function me(){if(!he){if(o.throwDeprecation)throw new Error(Y);o.traceDeprecation?console.trace(Y):console.error(Y),he=!0}return _.apply(this,arguments)}return me};var d={},p;i.debuglog=function(_){if(O(p)&&(p=o.env.NODE_DEBUG||""),_=_.toUpperCase(),!d[_])if(new RegExp("\\b"+_+"\\b","i").test(p)){var Y=o.pid;d[_]=function(){var he=i.format.apply(i,arguments);console.error("%s %d: %s",_,Y,he)}}else d[_]=function(){};return d[_]};function f(_,Y){var he={seen:[],stylize:x};return arguments.length>=3&&(he.depth=arguments[2]),arguments.length>=4&&(he.colors=arguments[3]),k(Y)?he.showHidden=Y:Y&&i._extend(he,Y),O(he.showHidden)&&(he.showHidden=!1),O(he.depth)&&(he.depth=2),O(he.colors)&&(he.colors=!1),O(he.customInspect)&&(he.customInspect=!0),he.colors&&(he.stylize=h),b(he,_,he.depth)}i.inspect=f,f.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},f.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function h(_,Y){var he=f.styles[Y];return he?"\x1B["+f.colors[he][0]+"m"+_+"\x1B["+f.colors[he][1]+"m":_}function x(_,Y){return _}function m(_){var Y={};return _.forEach(function(he,me){Y[he]=!0}),Y}function b(_,Y,he){if(_.customInspect&&Y&&$(Y.inspect)&&Y.inspect!==i.inspect&&!(Y.constructor&&Y.constructor.prototype===Y)){var me=Y.inspect(he,_);return P(me)||(me=b(_,me,he)),me}var ge=w(_,Y);if(ge)return ge;var le=Object.keys(Y),X=m(le);if(_.showHidden&&(le=Object.getOwnPropertyNames(Y)),z(Y)&&(le.indexOf("message")>=0||le.indexOf("description")>=0))return y(Y);if(le.length===0){if($(Y)){var V=Y.name?": "+Y.name:"";return _.stylize("[Function"+V+"]","special")}if(G(Y))return _.stylize(RegExp.prototype.toString.call(Y),"regexp");if(F(Y))return _.stylize(Date.prototype.toString.call(Y),"date");if(z(Y))return y(Y)}var de="",je=!1,_e=["{","}"];if(j(Y)&&(je=!0,_e=["[","]"]),$(Y)){var Re=Y.name?": "+Y.name:"";de=" [Function"+Re+"]"}if(G(Y)&&(de=" "+RegExp.prototype.toString.call(Y)),F(Y)&&(de=" "+Date.prototype.toUTCString.call(Y)),z(Y)&&(de=" "+y(Y)),le.length===0&&(!je||Y.length==0))return _e[0]+de+_e[1];if(he<0)return G(Y)?_.stylize(RegExp.prototype.toString.call(Y),"regexp"):_.stylize("[Object]","special");_.seen.push(Y);var Be;return je?Be=C(_,Y,he,X,le):Be=le.map(function(Se){return T(_,Y,he,X,Se,je)}),_.seen.pop(),E(Be,de,_e)}function w(_,Y){if(O(Y))return _.stylize("undefined","undefined");if(P(Y)){var he="'"+JSON.stringify(Y).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return _.stylize(he,"string")}if(M(Y))return _.stylize(""+Y,"number");if(k(Y))return _.stylize(""+Y,"boolean");if(A(Y))return _.stylize("null","null")}function y(_){return"["+Error.prototype.toString.call(_)+"]"}function C(_,Y,he,me,ge){for(var le=[],X=0,V=Y.length;X<V;++X)Q(Y,String(X))?le.push(T(_,Y,he,me,String(X),!0)):le.push("");return ge.forEach(function(de){de.match(/^\d+$/)||le.push(T(_,Y,he,me,de,!0))}),le}function T(_,Y,he,me,ge,le){var X,V,de;if(de=Object.getOwnPropertyDescriptor(Y,ge)||{value:Y[ge]},de.get?de.set?V=_.stylize("[Getter/Setter]","special"):V=_.stylize("[Getter]","special"):de.set&&(V=_.stylize("[Setter]","special")),Q(me,ge)||(X="["+ge+"]"),V||(_.seen.indexOf(de.value)<0?(A(he)?V=b(_,de.value,null):V=b(_,de.value,he-1),V.indexOf(`
`)>-1&&(le?V=V.split(`
`).map(function(je){return"  "+je}).join(`
`).substr(2):V=`
`+V.split(`
`).map(function(je){return"   "+je}).join(`
`))):V=_.stylize("[Circular]","special")),O(X)){if(le&&ge.match(/^\d+$/))return V;X=JSON.stringify(""+ge),X.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.substr(1,X.length-2),X=_.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=_.stylize(X,"string"))}return X+": "+V}function E(_,Y,he){var me=_.reduce(function(ge,le){return le.indexOf(`
`)>=0,ge+le.replace(/\u001b\[\d\d?m/g,"").length+1},0);return me>60?he[0]+(Y===""?"":Y+`
 `)+" "+_.join(`,
  `)+" "+he[1]:he[0]+Y+" "+_.join(", ")+" "+he[1]}function j(_){return Array.isArray(_)}i.isArray=j;function k(_){return typeof _=="boolean"}i.isBoolean=k;function A(_){return _===null}i.isNull=A;function R(_){return _==null}i.isNullOrUndefined=R;function M(_){return typeof _=="number"}i.isNumber=M;function P(_){return typeof _=="string"}i.isString=P;function I(_){return typeof _=="symbol"}i.isSymbol=I;function O(_){return _===void 0}i.isUndefined=O;function G(_){return B(_)&&D(_)==="[object RegExp]"}i.isRegExp=G;function B(_){return typeof _=="object"&&_!==null}i.isObject=B;function F(_){return B(_)&&D(_)==="[object Date]"}i.isDate=F;function z(_){return B(_)&&(D(_)==="[object Error]"||_ instanceof Error)}i.isError=z;function $(_){return typeof _=="function"}i.isFunction=$;function W(_){return _===null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||typeof _=="symbol"||typeof _>"u"}i.isPrimitive=W,i.isBuffer=r("./support/isBuffer");function D(_){return Object.prototype.toString.call(_)}function oe(_){return _<10?"0"+_.toString(10):_.toString(10)}var Z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function fe(){var _=new Date,Y=[oe(_.getHours()),oe(_.getMinutes()),oe(_.getSeconds())].join(":");return[_.getDate(),Z[_.getMonth()],Y].join(" ")}i.log=function(){console.log("%s - %s",fe(),i.format.apply(i,arguments))},i.inherits=r("inherits"),i._extend=function(_,Y){if(!Y||!B(Y))return _;for(var he=Object.keys(Y),me=he.length;me--;)_[he[me]]=Y[he[me]];return _};function Q(_,Y){return Object.prototype.hasOwnProperty.call(_,Y)}}).call(this,r("_process"),typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":10,_process:14,inherits:9}],12:[function(r,n,i){},{}],13:[function(r,n,i){(function(o){function a(f,h){for(var x=0,m=f.length-1;m>=0;m--){var b=f[m];b==="."?f.splice(m,1):b===".."?(f.splice(m,1),x++):x&&(f.splice(m,1),x--)}if(h)for(;x--;x)f.unshift("..");return f}i.resolve=function(){for(var f="",h=!1,x=arguments.length-1;x>=-1&&!h;x--){var m=x>=0?arguments[x]:o.cwd();if(typeof m!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!m)continue;f=m+"/"+f,h=m.charAt(0)==="/"}return f=a(d(f.split("/"),function(b){return!!b}),!h).join("/"),(h?"/":"")+f||"."},i.normalize=function(f){var h=i.isAbsolute(f),x=p(f,-1)==="/";return f=a(d(f.split("/"),function(m){return!!m}),!h).join("/"),!f&&!h&&(f="."),f&&x&&(f+="/"),(h?"/":"")+f},i.isAbsolute=function(f){return f.charAt(0)==="/"},i.join=function(){var f=Array.prototype.slice.call(arguments,0);return i.normalize(d(f,function(h,x){if(typeof h!="string")throw new TypeError("Arguments to path.join must be strings");return h}).join("/"))},i.relative=function(f,h){f=i.resolve(f).substr(1),h=i.resolve(h).substr(1);function x(E){for(var j=0;j<E.length&&E[j]==="";j++);for(var k=E.length-1;k>=0&&E[k]==="";k--);return j>k?[]:E.slice(j,k-j+1)}for(var m=x(f.split("/")),b=x(h.split("/")),w=Math.min(m.length,b.length),y=w,C=0;C<w;C++)if(m[C]!==b[C]){y=C;break}for(var T=[],C=y;C<m.length;C++)T.push("..");return T=T.concat(b.slice(y)),T.join("/")},i.sep="/",i.delimiter=":",i.dirname=function(f){if(typeof f!="string"&&(f=f+""),f.length===0)return".";for(var h=f.charCodeAt(0),x=h===47,m=-1,b=!0,w=f.length-1;w>=1;--w)if(h=f.charCodeAt(w),h===47){if(!b){m=w;break}}else b=!1;return m===-1?x?"/":".":x&&m===1?"/":f.slice(0,m)};function l(f){typeof f!="string"&&(f=f+"");var h=0,x=-1,m=!0,b;for(b=f.length-1;b>=0;--b)if(f.charCodeAt(b)===47){if(!m){h=b+1;break}}else x===-1&&(m=!1,x=b+1);return x===-1?"":f.slice(h,x)}i.basename=function(f,h){var x=l(f);return h&&x.substr(-1*h.length)===h&&(x=x.substr(0,x.length-h.length)),x},i.extname=function(f){typeof f!="string"&&(f=f+"");for(var h=-1,x=0,m=-1,b=!0,w=0,y=f.length-1;y>=0;--y){var C=f.charCodeAt(y);if(C===47){if(!b){x=y+1;break}continue}m===-1&&(b=!1,m=y+1),C===46?h===-1?h=y:w!==1&&(w=1):h!==-1&&(w=-1)}return h===-1||m===-1||w===0||w===1&&h===m-1&&h===x+1?"":f.slice(h,m)};function d(f,h){if(f.filter)return f.filter(h);for(var x=[],m=0;m<f.length;m++)h(f[m],m,f)&&x.push(f[m]);return x}var p="ab".substr(-1)==="b"?function(f,h,x){return f.substr(h,x)}:function(f,h,x){return h<0&&(h=f.length+h),f.substr(h,x)}}).call(this,r("_process"))},{_process:14}],14:[function(r,n,i){var o=n.exports={},a,l;function d(){throw new Error("setTimeout has not been defined")}function p(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?a=setTimeout:a=d}catch{a=d}try{typeof clearTimeout=="function"?l=clearTimeout:l=p}catch{l=p}})();function f(j){if(a===setTimeout)return setTimeout(j,0);if((a===d||!a)&&setTimeout)return a=setTimeout,setTimeout(j,0);try{return a(j,0)}catch{try{return a.call(null,j,0)}catch{return a.call(this,j,0)}}}function h(j){if(l===clearTimeout)return clearTimeout(j);if((l===p||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(j);try{return l(j)}catch{try{return l.call(null,j)}catch{return l.call(this,j)}}}var x=[],m=!1,b,w=-1;function y(){!m||!b||(m=!1,b.length?x=b.concat(x):w=-1,x.length&&C())}function C(){if(!m){var j=f(y);m=!0;for(var k=x.length;k;){for(b=x,x=[];++w<k;)b&&b[w].run();w=-1,k=x.length}b=null,m=!1,h(j)}}o.nextTick=function(j){var k=new Array(arguments.length-1);if(arguments.length>1)for(var A=1;A<arguments.length;A++)k[A-1]=arguments[A];x.push(new T(j,k)),x.length===1&&!m&&f(C)};function T(j,k){this.fun=j,this.array=k}T.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={};function E(){}o.on=E,o.addListener=E,o.once=E,o.off=E,o.removeListener=E,o.removeAllListeners=E,o.emit=E,o.prependListener=E,o.prependOnceListener=E,o.listeners=function(j){return[]},o.binding=function(j){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(j){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],15:[function(r,n,i){var o=r("escodegen").generate;n.exports=function(a,l){l||(l={});var d={},p=(function f(h,x){if(h.type==="Literal")return h.value;if(h.type==="UnaryExpression"){var m=f(h.argument);return h.operator==="+"?+m:h.operator==="-"?-m:h.operator==="~"?~m:h.operator==="!"?!m:d}else if(h.type==="ArrayExpression"){for(var b=[],w=0,y=h.elements.length;w<y;w++){var C=f(h.elements[w]);if(C===d)return d;b.push(C)}return b}else if(h.type==="ObjectExpression"){for(var T={},w=0;w<h.properties.length;w++){var E=h.properties[w],j=E.value===null?E.value:f(E.value);if(j===d)return d;T[E.key.value||E.key.name]=j}return T}else if(h.type==="BinaryExpression"||h.type==="LogicalExpression"){var y=f(h.left);if(y===d)return d;var k=f(h.right);if(k===d)return d;var A=h.operator;return A==="=="?y==k:A==="==="?y===k:A==="!="?y!=k:A==="!=="?y!==k:A==="+"?y+k:A==="-"?y-k:A==="*"?y*k:A==="/"?y/k:A==="%"?y%k:A==="<"?y<k:A==="<="?y<=k:A===">"?y>k:A===">="?y>=k:A==="|"?y|k:A==="&"?y&k:A==="^"?y^k:A==="&&"?y&&k:A==="||"?y||k:d}else{if(h.type==="Identifier")return{}.hasOwnProperty.call(l,h.name)?l[h.name]:d;if(h.type==="ThisExpression")return{}.hasOwnProperty.call(l,"this")?l.this:d;if(h.type==="CallExpression"){var R=f(h.callee);if(R===d||typeof R!="function")return d;var M=h.callee.object?f(h.callee.object):d;M===d&&(M=null);for(var P=[],w=0,y=h.arguments.length;w<y;w++){var C=f(h.arguments[w]);if(C===d)return d;P.push(C)}return R.apply(M,P)}else if(h.type==="MemberExpression"){var T=f(h.object);if(T===d||typeof T=="function")return d;if(h.property.type==="Identifier")return T[h.property.name];var E=f(h.property);return E===d?d:T[E]}else if(h.type==="ConditionalExpression"){var m=f(h.test);return m===d?d:f(m?h.consequent:h.alternate)}else if(h.type==="ExpressionStatement"){var m=f(h.expression);return m===d?d:m}else{if(h.type==="ReturnStatement")return f(h.argument);if(h.type==="FunctionExpression"){var I=h.body.body,O={};Object.keys(l).forEach(function(Z){O[Z]=l[Z]});for(var w=0;w<h.params.length;w++){var G=h.params[w];if(G.type=="Identifier")l[G.name]=null;else return d}for(var w in I)if(f(I[w])===d)return d;l=O;var B=Object.keys(l),F=B.map(function(Z){return l[Z]});return Function(B.join(", "),"return "+o(h)).apply(null,F)}else if(h.type==="TemplateLiteral"){for(var z="",w=0;w<h.expressions.length;w++)z+=f(h.quasis[w]),z+=f(h.expressions[w]);return z+=f(h.quasis[w]),z}else if(h.type==="TaggedTemplateExpression"){var $=f(h.tag),W=h.quasi,D=W.quasis.map(f),oe=W.expressions.map(f);return $.apply(null,[D].concat(oe))}else return h.type==="TemplateElement"?h.value.cooked:d}}})(a);return p===d?void 0:p}},{escodegen:12}],jsonpath:[function(r,n,i){n.exports=r("./lib/index")},{"./lib/index":5}]},{},["jsonpath"])("jsonpath")})})(l0)),l0.exports}var Kj=Lq();class zq extends Kd{constructor(){super(...arguments);Pe(this,"name","JSONPath");Pe(this,"description","Query JSON using JSONPath syntax ($.data.field[*])")}async execute(r,n){try{const i=Kj.query(r,n);if(Array.isArray(i)){if(n.includes("[*]")||n.includes(".."))return i;if(i.length===1)return i[0];if(i.length===0)return}return i}catch(i){throw new Error(`JSONPath execution failed: ${i instanceof Error?i.message:String(i)}`)}}validate(r){if(!r||r.trim().length===0)return{valid:!1,error:"Expression cannot be empty"};if(!r.startsWith("$")&&!r.startsWith("@"))return{valid:!1,error:"JSONPath must start with $ or @"};const n=(r.match(/\[/g)||[]).length,i=(r.match(/\]/g)||[]).length;if(n!==i)return{valid:!1,error:"Unbalanced brackets"};try{return Kj.parse(r),{valid:!0}}catch(o){return{valid:!1,error:`Invalid JSONPath syntax: ${o instanceof Error?o.message:String(o)}`}}}getExample(){return"$.data.candles[*]"}getSyntaxHelp(){return`
JSONPath Syntax Examples:

Basic Selection:
  $.data                     - Select 'data' field
  $.data.candles            - Select nested field
  $.data.candles[0]         - Select first array element
  $.data.candles[*]         - Select all array elements
  $.data.candles[-1]        - Select last element

Recursive:
  $..price                  - Find all 'price' fields recursively
  $..candles[*]             - Find all candles arrays

Filtering:
  $.data.quotes[?(@.volume > 1000)]    - Filter by condition
  $.data.quotes[?(@.price)]            - Filter where field exists

Multiple Selection:
  $.data['open','close']    - Select multiple fields
  $.data.candles[0,2,4]     - Select specific indices
  $.data.candles[0:5]       - Slice (indices 0-4)
  $.data.candles[-5:]       - Last 5 elements
    `.trim()}generatePath(r){let n="$";for(const i of r)i.match(/^\[\d+\]$/)?n+=i:i.includes(".")||i.includes("[")?n+=`['${i}']`:n+=`.${i}`;return n}pathToKeys(r){let n=r.replace(/^\$\.?/,"");const i=[];let o="",a=!1;for(let l=0;l<n.length;l++){const d=n[l];d==="["?(o&&(i.push(o),o=""),a=!0,o+=d):d==="]"?(o+=d,i.push(o),o="",a=!1):d==="."&&!a?o&&(i.push(o),o=""):o+=d}return o&&i.push(o),i}}var c0={exports:{}},Vj;function Mq(){return Vj||(Vj=1,(function(s,e){(function(r){if(typeof window<"u")s.exports=r();else{var n;typeof window<"u"?n=window:typeof globalThis<"u"?n=globalThis:typeof self<"u"?n=self:n=this,n.jsonata=r()}})(function(){return(function(){function r(n,i,o){function a(p,f){if(!i[p]){if(!n[p]){var h=typeof xl=="function"&&xl;if(!f&&h)return h(p,!0);if(l)return l(p,!0);var x=new Error("Cannot find module '"+p+"'");throw x.code="MODULE_NOT_FOUND",x}var m=i[p]={exports:{}};n[p][0].call(m.exports,function(b){var w=n[p][1][b];return a(w||b)},m,m.exports,r,n,i,o)}return i[p].exports}for(var l=typeof xl=="function"&&xl,d=0;d<o.length;d++)a(o[d]);return a}return r})()({1:[function(r,n,i){const o=r("./utils"),a=(function(){const l=o.stringToArray,d=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],p=["Zeroth","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth","Eleventh","Twelfth","Thirteenth","Fourteenth","Fifteenth","Sixteenth","Seventeenth","Eighteenth","Nineteenth"],f=["Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety","Hundred"],h=["Thousand","Million","Billion","Trillion"];function x(le,X){var V=function(je,_e,Re){var Be="";if(je<=19)Be=(_e?" and ":"")+(Re?p[je]:d[je]);else if(je<100){const ie=Math.floor(je/10),ve=je%10;Be=(_e?" and ":"")+f[ie-2],ve>0?Be+="-"+V(ve,!1,Re):Re&&(Be=Be.substring(0,Be.length-1)+"ieth")}else if(je<1e3){const ie=Math.floor(je/100),ve=je%100;Be=(_e?", ":"")+d[ie]+" Hundred",ve>0?Be+=V(ve,!0,Re):Re&&(Be+="th")}else{var Se=Math.floor(Math.log10(je)/3);Se>h.length&&(Se=h.length);const ie=Math.pow(10,Se*3),ve=Math.floor(je/ie),Ae=je-ve*ie;Be=(_e?", ":"")+V(ve,!1,!1)+" "+h[Se-1],Ae>0?Be+=V(Ae,!0,Re):Re&&(Be+="th")}return Be},de=V(le,!1,X);return de}const m={};d.forEach(function(le,X){m[le.toLowerCase()]=X}),p.forEach(function(le,X){m[le.toLowerCase()]=X}),f.forEach(function(le,X){const V=le.toLowerCase();m[V]=(X+2)*10,m[V.substring(0,le.length-1)+"ieth"]=m[V]}),m.hundredth=100,h.forEach(function(le,X){const V=le.toLowerCase(),de=Math.pow(10,(X+1)*3);m[V]=de,m[V+"th"]=de});function b(le){const V=le.split(/,\s|\sand\s|[\s\\-]/).map(_e=>m[_e]);let de=[0];return V.forEach(_e=>{if(_e<100){let Re=de.pop();Re>=1e3&&(de.push(Re),Re=0),de.push(Re+_e)}else de.push(de.pop()*_e)}),de.reduce((_e,Re)=>_e+Re,0)}const w=[[1e3,"m"],[900,"cm"],[500,"d"],[400,"cd"],[100,"c"],[90,"xc"],[50,"l"],[40,"xl"],[10,"x"],[9,"ix"],[5,"v"],[4,"iv"],[1,"i"]],y={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1};function C(le){for(var X=0;X<w.length;X++){const V=w[X];if(le>=V[0])return V[1]+C(le-V[0])}return""}function T(le){for(var X=0,V=1,de=le.length-1;de>=0;de--){const je=le[de],_e=y[je];_e<V?X-=_e:(V=_e,X+=_e)}return X}function E(le,X){for(var V=[],de=X.charCodeAt(0);le>0;)V.unshift(String.fromCharCode((le-1)%26+de)),le=Math.floor((le-1)/26);return V.join("")}function j(le,X){for(var V=X.charCodeAt(0),de=0,je=0;je<le.length;je++)de+=(le.charCodeAt(le.length-je-1)-V+1)*Math.pow(26,je);return de}function k(le,X){if(typeof le>"u")return;le=Math.floor(le);const V=I(X);return M(le,V)}const A={DECIMAL:"decimal",LETTERS:"letters",ROMAN:"roman",WORDS:"words",SEQUENCE:"sequence"},R={UPPER:"upper",LOWER:"lower",TITLE:"title"};function M(le,X){let V;const de=le<0;switch(le=Math.abs(le),X.primary){case A.LETTERS:V=E(le,X.case===R.UPPER?"A":"a");break;case A.ROMAN:V=C(le),X.case===R.UPPER&&(V=V.toUpperCase());break;case A.WORDS:V=x(le,X.ordinal),X.case===R.UPPER?V=V.toUpperCase():X.case===R.LOWER&&(V=V.toLowerCase());break;case A.DECIMAL:V=""+le;var je=X.mandatoryDigits-V.length;if(je>0){var _e=new Array(je+1).join("0");V=_e+V}if(X.zeroCode!==48&&(V=l(V).map(ie=>String.fromCodePoint(ie.codePointAt(0)+X.zeroCode-48)).join("")),X.regular){const ie=Math.floor((V.length-1)/X.groupingSeparators.position);for(let ve=ie;ve>0;ve--){const Ae=V.length-ve*X.groupingSeparators.position;V=V.substr(0,Ae)+X.groupingSeparators.character+V.substr(Ae)}}else X.groupingSeparators.reverse().forEach(ie=>{const ve=V.length-ie.position;V=V.substr(0,ve)+ie.character+V.substr(ve)});if(X.ordinal){var Re={1:"st",2:"nd",3:"rd"},Be=V[V.length-1],Se=Re[Be];(!Se||V.length>1&&V[V.length-2]==="1")&&(Se="th"),V=V+Se}break;case A.SEQUENCE:throw{code:"D3130",value:X.token}}return de&&(V="-"+V),V}const P=[48,1632,1776,1984,2406,2534,2662,2790,2918,3046,3174,3302,3430,3558,3664,3792,3872,4160,4240,6112,6160,6470,6608,6784,6800,6992,7088,7232,7248,42528,43216,43264,43472,43504,43600,44016,65296];function I(le){const X={type:"integer",primary:A.DECIMAL,case:R.LOWER,ordinal:!1};let V,de;const je=le.lastIndexOf(";");switch(je===-1?V=le:(V=le.substring(0,je),de=le.substring(je+1),de[0]==="o"&&(X.ordinal=!0)),V){case"A":X.case=R.UPPER;case"a":X.primary=A.LETTERS;break;case"I":X.case=R.UPPER;case"i":X.primary=A.ROMAN;break;case"W":X.case=R.UPPER,X.primary=A.WORDS;break;case"Ww":X.case=R.TITLE,X.primary=A.WORDS;break;case"w":X.primary=A.WORDS;break;default:{let _e=null,Re=0,Be=0,Se=[],ie=0;if(l(V).map(Ae=>Ae.codePointAt(0)).reverse().forEach(Ae=>{let $e=!1;for(let qe=0;qe<P.length;qe++){const Ie=P[qe];if(Ae>=Ie&&Ae<=Ie+9){if($e=!0,Re++,ie++,_e===null)_e=Ie;else if(Ie!==_e)throw{code:"D3131"};break}}$e||(Ae===35?(ie++,Be++):Se.push({position:ie,character:String.fromCodePoint(Ae)}))}),Re>0){X.primary=A.DECIMAL,X.zeroCode=_e,X.mandatoryDigits=Re,X.optionalDigits=Be;const $e=function(qe){if(qe.length===0)return 0;const Ie=qe[0].character;for(let q=1;q<qe.length;q++)if(qe[q].character!==Ie)return 0;const K=qe.map(q=>q.position),Ee=function(q,ee){return ee===0?q:Ee(ee,q%ee)},Oe=K.reduce(Ee);for(let q=1;q<=K.length;q++)if(K.indexOf(q*Oe)===-1)return 0;return Oe}(Se);$e>0?(X.regular=!0,X.groupingSeparators={position:$e,character:Se[0].character}):(X.regular=!1,X.groupingSeparators=Se)}else X.primary=A.SEQUENCE,X.token=V}}return X}const O={Y:"1",M:"1",D:"1",d:"1",F:"n",W:"1",w:"1",X:"1",x:"1",H:"1",h:"1",P:"n",m:"01",s:"01",f:"1",Z:"01:01",z:"01:01",C:"n",E:"n"};function G(le){var X=[];const V={type:"datetime",parts:X},de=function($e,qe){if(qe>$e){let Ie=le.substring($e,qe);Ie=Ie.split("]]").join("]"),X.push({type:"literal",value:Ie})}};for(var je=0,_e=0;_e<le.length;){if(le.charAt(_e)==="["){if(le.charAt(_e+1)==="["){de(je,_e),X.push({type:"literal",value:"["}),_e+=2,je=_e;continue}if(de(je,_e),je=_e,_e=le.indexOf("]",je),_e===-1)throw{code:"D3135"};let $e=le.substring(je+1,_e);$e=$e.split(/\s+/).join("");var Re={type:"marker",component:$e.charAt(0)},Be=$e.lastIndexOf(","),Se;if(Be!==-1){const qe=$e.substring(Be+1),Ie=qe.indexOf("-");let K,Ee;const Oe=function(ee){if(!(typeof ee>"u"||ee==="*"))return parseInt(ee)};Ie===-1?K=qe:(K=qe.substring(0,Ie),Ee=qe.substring(Ie+1));const q={min:Oe(K),max:Oe(Ee)};Re.width=q,Se=$e.substring(1,Be)}else Se=$e.substring(1);if(Se.length===1)Re.presentation1=Se;else if(Se.length>1){var ie=Se.charAt(Se.length-1);"atco".indexOf(ie)!==-1?(Re.presentation2=ie,ie==="o"&&(Re.ordinal=!0),Re.presentation1=Se.substring(0,Se.length-1)):Re.presentation1=Se}else Re.presentation1=O[Re.component];if(typeof Re.presentation1>"u")throw{code:"D3132",value:Re.component};if(Re.presentation1[0]==="n")Re.names=R.LOWER;else if(Re.presentation1[0]==="N")Re.presentation1[1]==="n"?Re.names=R.TITLE:Re.names=R.UPPER;else if("YMDdFWwXxHhmsf".indexOf(Re.component)!==-1){var ve=Re.presentation1;if(Re.presentation2&&(ve+=";"+Re.presentation2),Re.integerFormat=I(ve),Re.width&&Re.width.min!==void 0&&Re.integerFormat.mandatoryDigits<Re.width.min&&(Re.integerFormat.mandatoryDigits=Re.width.min),Re.component==="Y")if(Re.n=-1,Re.width&&Re.width.max!==void 0)Re.n=Re.width.max,Re.integerFormat.mandatoryDigits=Re.n;else{var Ae=Re.integerFormat.mandatoryDigits+Re.integerFormat.optionalDigits;Ae>=2&&(Re.n=Ae)}const qe=X[X.length-1];qe&&qe.integerFormat&&(qe.integerFormat.parseWidth=qe.integerFormat.mandatoryDigits)}(Re.component==="Z"||Re.component==="z")&&(Re.integerFormat=I(Re.presentation1)),X.push(Re),je=_e+1}_e++}return de(je,_e),V}const B=["","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],F=["January","February","March","April","May","June","July","August","September","October","November","December"],z=1e3*60*60*24,$=function(le){const X=Date.UTC(le.year,le.month);var V=new Date(X).getUTCDay();return V===0&&(V=7),V>4?X+(8-V)*z:X-(V-1)*z},W=function(le,X){return{year:le,month:X,nextMonth:function(){return X===11?W(le+1,0):W(le,X+1)},previousMonth:function(){return X===0?W(le-1,11):W(le,X-1)},nextYear:function(){return W(le+1,X)},previousYear:function(){return W(le-1,X)}}},D=function(le,X){return(X-le)/(z*7)+1},oe=(le,X)=>{let V;switch(X){case"Y":V=le.getUTCFullYear();break;case"M":V=le.getUTCMonth()+1;break;case"D":V=le.getUTCDate();break;case"d":{const de=Date.UTC(le.getUTCFullYear(),le.getUTCMonth(),le.getUTCDate()),je=Date.UTC(le.getUTCFullYear(),0);V=(de-je)/z+1;break}case"F":V=le.getUTCDay(),V===0&&(V=7);break;case"W":{const de=W(le.getUTCFullYear(),0),je=$(de),_e=Date.UTC(de.year,le.getUTCMonth(),le.getUTCDate());let Re=D(je,_e);if(Re>52){const Be=$(de.nextYear());_e>=Be&&(Re=1)}else if(Re<1){const Be=$(de.previousYear());Re=D(Be,_e)}V=Math.floor(Re);break}case"w":{const de=W(le.getUTCFullYear(),le.getUTCMonth()),je=$(de),_e=Date.UTC(de.year,de.month,le.getUTCDate());let Re=D(je,_e);if(Re>4){const Be=$(de.nextMonth());_e>=Be&&(Re=1)}else if(Re<1){const Be=$(de.previousMonth());Re=D(Be,_e)}V=Math.floor(Re);break}case"X":{const de=W(le.getUTCFullYear(),0),je=$(de),_e=$(de.nextYear()),Re=le.getTime();Re<je?V=de.year-1:Re>=_e?V=de.year+1:V=de.year;break}case"x":{const de=W(le.getUTCFullYear(),le.getUTCMonth()),je=$(de),_e=de.nextMonth(),Re=$(_e),Be=le.getTime();Be<je?V=de.previousMonth().month+1:Be>=Re?V=_e.month+1:V=de.month+1;break}case"H":V=le.getUTCHours();break;case"h":V=le.getUTCHours(),V=V%12,V===0&&(V=12);break;case"P":V=le.getUTCHours()>=12?"pm":"am";break;case"m":V=le.getUTCMinutes();break;case"s":V=le.getUTCSeconds();break;case"f":V=le.getUTCMilliseconds();break;case"Z":case"z":break;case"C":V="ISO";break;case"E":V="ISO";break}return V};let Z=null;function fe(le,X,V){var de=0,je=0;if(typeof V<"u"){const ve=parseInt(V);de=Math.floor(ve/100),je=ve%100}var _e=function(ve,Ae){var $e=oe(ve,Ae.component);if("YMDdFWwXxHhms".indexOf(Ae.component)!==-1)if(Ae.component==="Y"&&Ae.n!==-1&&($e=$e%Math.pow(10,Ae.n)),Ae.names){if(Ae.component==="M"||Ae.component==="x")$e=F[$e-1];else if(Ae.component==="F")$e=B[$e];else throw{code:"D3133",value:Ae.component};Ae.names===R.UPPER?$e=$e.toUpperCase():Ae.names===R.LOWER&&($e=$e.toLowerCase()),Ae.width&&$e.length>Ae.width.max&&($e=$e.substring(0,Ae.width.max))}else $e=M($e,Ae.integerFormat);else if(Ae.component==="f")$e=M($e,Ae.integerFormat);else if(Ae.component==="Z"||Ae.component==="z"){const qe=de*100+je;if(Ae.integerFormat.regular)$e=M(qe,Ae.integerFormat);else{const Ie=Ae.integerFormat.mandatoryDigits;if(Ie===1||Ie===2)$e=M(de,Ae.integerFormat),je!==0&&($e+=":"+k(je,"00"));else if(Ie===3||Ie===4)$e=M(qe,Ae.integerFormat);else throw{code:"D3134",value:Ie}}qe>=0&&($e="+"+$e),Ae.component==="z"&&($e="GMT"+$e),qe===0&&Ae.presentation2==="t"&&($e="Z")}else Ae.component==="P"&&Ae.names===R.UPPER&&($e=$e.toUpperCase());return $e};let Re;typeof X>"u"?(Z===null&&(Z=G("[Y0001]-[M01]-[D01]T[H01]:[m01]:[s01].[f001][Z01:01t]")),Re=Z):Re=G(X);const Be=(60*de+je)*60*1e3,Se=new Date(le+Be);let ie="";return Re.parts.forEach(function(ve){ve.type==="literal"?ie+=ve.value:ie+=_e(Se,ve)}),ie}function Q(le){var X={};if(le.type==="datetime")X.type="datetime",X.parts=le.parts.map(function(V){var de={};if(V.type==="literal")de.regex=V.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");else if(V.component==="Z"||V.component==="z"){let _e;Array.isArray(V.integerFormat.groupingSeparators)||(_e=V.integerFormat.groupingSeparators),de.regex="",V.component==="z"&&(de.regex="GMT"),de.regex+="[-+][0-9]+",_e&&(de.regex+=_e.character+"[0-9]+"),de.parse=function(Re){V.component==="z"&&(Re=Re.substring(3));let Be=0,Se=0;return _e?(Be=Number.parseInt(Re.substring(0,Re.indexOf(_e.character))),Se=Number.parseInt(Re.substring(Re.indexOf(_e.character)+1))):Re.length-1<=2?Be=Number.parseInt(Re):(Be=Number.parseInt(Re.substring(0,3)),Se=Number.parseInt(Re.substring(3))),Be*60+Se}}else if(V.integerFormat)de=Q(V.integerFormat);else{de.regex="[a-zA-Z]+";var je={};if(V.component==="M"||V.component==="x")F.forEach(function(_e,Re){V.width&&V.width.max?je[_e.substring(0,V.width.max)]=Re+1:je[_e]=Re+1});else if(V.component==="F")B.forEach(function(_e,Re){Re>0&&(V.width&&V.width.max?je[_e.substring(0,V.width.max)]=Re:je[_e]=Re)});else if(V.component==="P")je={am:0,AM:0,pm:1,PM:1};else throw{code:"D3133",value:V.component};de.parse=function(_e){return je[_e]}}return de.component=V.component,de});else{X.type="integer";const V=le.case===R.UPPER;switch(le.primary){case A.LETTERS:X.regex=V?"[A-Z]+":"[a-z]+",X.parse=function(de){return j(de,V?"A":"a")};break;case A.ROMAN:X.regex=V?"[MDCLXVI]+":"[mdclxvi]+",X.parse=function(de){return T(V?de:de.toUpperCase())};break;case A.WORDS:X.regex="(?:"+Object.keys(m).concat("and","[\\-, ]").join("|")+")+",X.parse=function(de){return b(de.toLowerCase())};break;case A.DECIMAL:X.regex="[0-9]",le.parseWidth?X.regex+=`{${le.parseWidth}}`:X.regex+="+",le.ordinal&&(X.regex+="(?:th|st|nd|rd)"),X.parse=function(de){let je=de;return le.ordinal&&(je=de.substring(0,de.length-2)),le.regular?je=je.split(",").join(""):le.groupingSeparators.forEach(_e=>{je=je.split(_e.character).join("")}),le.zeroCode!==48&&(je=je.split("").map(_e=>String.fromCodePoint(_e.codePointAt(0)-le.zeroCode+48)).join("")),parseInt(je)};break;case A.SEQUENCE:throw{code:"D3130",value:le.token}}}return X}function _(le,X){if(typeof le>"u")return;const V=I(X);return Q(V).parse(le)}function Y(le,X){const V=G(X),de=Q(V),je="^"+de.parts.map(Se=>"("+Se.regex+")").join("")+"$";var Re=new RegExp(je,"i").exec(le);if(Re!==null){const Ie={};for(let ue=1;ue<Re.length;ue++){const re=de.parts[ue-1];re.parse&&(Ie[re.component]=re.parse(Re[ue]))}if(Object.getOwnPropertyNames(Ie).length===0)return;let K=0;const Ee=ue=>{K<<=1,K+=ue?1:0},Oe=ue=>!(~ue&K)&&!!(ue&K);"YXMxWwdD".split("").forEach(ue=>Ee(Ie[ue]));const ee=!Oe(161)&&Oe(130),ce=Oe(84),Ce=!ce&&Oe(72);K=0,"PHhmsf".split("").forEach(ue=>Ee(Ie[ue]));const We=!Oe(23)&&Oe(47),Te=(ee?"YD":ce?"XxwF":Ce?"XWF":"YMD")+(We?"Phmsf":"Hmsf"),Me=this.environment.timestamp;let Qe=!1,ye=!1;if(Te.split("").forEach(ue=>{if(typeof Ie[ue]>"u")Qe?(Ie[ue]="MDd".indexOf(ue)!==-1?1:0,ye=!0):Ie[ue]=oe(Me,ue);else if(Qe=!0,ye)throw{code:"D3136"}}),Ie.M>0?Ie.M-=1:Ie.M=0,ee){const ue=Date.UTC(Ie.Y,0),re=(Ie.d-1)*1e3*60*60*24,ke=new Date(ue+re);Ie.M=ke.getUTCMonth(),Ie.D=ke.getUTCDate()}if(ce)throw{code:"D3136"};if(Ce)throw{code:"D3136"};We&&(Ie.H=Ie.h===12?0:Ie.h,Ie.P===1&&(Ie.H+=12));var Be=Date.UTC(Ie.Y,Ie.M,Ie.D,Ie.H,Ie.m,Ie.s,Ie.f);return(Ie.Z||Ie.z)&&(Be-=(Ie.Z||Ie.z)*60*1e3),Be}}var he=new RegExp("^\\d{4}(-[01]\\d)*(-[0-3]\\d)*(T[0-2]\\d:[0-5]\\d:[0-5]\\d)*(\\.\\d+)?([+-][0-2]\\d:?[0-5]\\d|Z)?$");function me(le,X){if(!(typeof le>"u"))if(typeof X>"u"){if(!he.test(le))throw{stack:new Error().stack,code:"D3110",value:le};return Date.parse(le)}else return Y.call(this,le,X)}function ge(le,X,V){if(!(typeof le>"u"))return fe.call(this,le,X,V)}return{formatInteger:k,parseInteger:_,fromMillis:ge,toMillis:me}})();n.exports=a},{"./utils":6}],2:[function(r,n,i){(function(o){(function(){var a=r("./utils");const l=(()=>{var d=a.isNumeric,p=a.isArrayOfStrings,f=a.isArrayOfNumbers,h=a.createSequence,x=a.isSequence,m=a.isFunction,b=a.isLambda,w=a.isPromise,y=a.getFunctionArity,C=a.isDeepEqual,T=a.stringToArray;function E(U){if(!(typeof U>"u")){var ne=0;return U.forEach(function(xe){ne+=xe}),ne}}function j(U){return typeof U>"u"?0:U.length}function k(U){if(!(typeof U>"u"||U.length===0))return Math.max.apply(Math,U)}function A(U){if(!(typeof U>"u"||U.length===0))return Math.min.apply(Math,U)}function R(U){if(!(typeof U>"u"||U.length===0)){var ne=0;return U.forEach(function(xe){ne+=xe}),ne/U.length}}function M(U,ne=!1){if(!(typeof U>"u")){var xe;if(typeof U=="string")xe=U;else if(m(U))xe="";else{if(typeof U=="number"&&!isFinite(U))throw{code:"D3001",value:U,stack:new Error().stack};var Le=ne?2:0;Array.isArray(U)&&U.outerWrapper&&(U=U[0]),xe=JSON.stringify(U,function(ze,Ge){return typeof Ge<"u"&&Ge!==null&&Ge.toPrecision&&d(Ge)?Number(Ge.toPrecision(15)):Ge&&m(Ge)?"":Ge},Le)}return xe}}function P(U,ne,xe){if(!(typeof U>"u")){var Le=T(U),ze=Le.length;if(ze+ne<0&&(ne=0),typeof xe<"u"){if(xe<=0)return"";var Ge=ne>=0?ne+xe:ze+ne+xe;return Le.slice(ne,Ge).join("")}return Le.slice(ne).join("")}}function I(U,ne){if(!(typeof U>"u")){var xe=U.indexOf(ne);return xe>-1?U.substr(0,xe):U}}function O(U,ne){if(!(typeof U>"u")){var xe=U.indexOf(ne);return xe>-1?U.substr(xe+ne.length):U}}function G(U){if(!(typeof U>"u"))return U.toLowerCase()}function B(U){if(!(typeof U>"u"))return U.toUpperCase()}function F(U){if(!(typeof U>"u"))return T(U).length}function z(U){if(!(typeof U>"u")){var ne=U.replace(/[ \t\n\r]+/gm," ");return ne.charAt(0)===" "&&(ne=ne.substring(1)),ne.charAt(ne.length-1)===" "&&(ne=ne.substring(0,ne.length-1)),ne}}function $(U,ne,xe){if(!(typeof U>"u")){(typeof xe>"u"||xe.length===0)&&(xe=" ");var Le;ne=Math.trunc(ne);var ze=Math.abs(ne)-F(U);if(ze>0){var Ge=new Array(ze+1).join(xe);xe.length>1&&(Ge=P(Ge,0,ze)),ne>0?Le=U+Ge:Le=Ge+U}else Le=U;return Le}}async function W(U,ne){var xe=U.apply(this,[ne]);if(w(xe)&&(xe=await xe),xe&&!(typeof xe.start=="number"||xe.end==="number"||Array.isArray(xe.groups)||m(xe.next)))throw{code:"T1010",stack:new Error().stack};return xe}async function D(U,ne){if(!(typeof U>"u")){var xe;if(typeof ne=="string")xe=U.indexOf(ne)!==-1;else{var Le=await W(ne,U);xe=typeof Le<"u"}return xe}}async function oe(U,ne,xe){if(!(typeof U>"u")){if(xe<0)throw{stack:new Error().stack,value:xe,code:"D3040",index:3};var Le=h();if(typeof xe>"u"||xe>0){var ze=0,Ge=await W(ne,U);if(typeof Ge<"u")for(;typeof Ge<"u"&&(typeof xe>"u"||ze<xe);)Le.push({match:Ge.match,index:Ge.start,groups:Ge.groups}),Ge=await W(Ge.next),ze++}return Le}}async function Z(U,ne,xe,Le){if(!(typeof U>"u")){var ze=this;if(ne==="")throw{code:"D3010",stack:new Error().stack,value:ne,index:2};if(Le<0)throw{code:"D3011",stack:new Error().stack,value:Le,index:4};var Ge;typeof xe=="string"?Ge=function(Et){for(var tt="",it=0,vt=xe.indexOf("$",it);vt!==-1&&it<xe.length;){tt+=xe.substring(it,vt),it=vt+1;var rr=xe.charAt(it);if(rr==="$")tt+="$",it++;else if(rr==="0")tt+=Et.match,it++;else{var Zt;if(Et.groups.length===0?Zt=1:Zt=Math.floor(Math.log(Et.groups.length)*Math.LOG10E)+1,vt=parseInt(xe.substring(it,it+Zt),10),Zt>1&&vt>Et.groups.length&&(vt=parseInt(xe.substring(it,it+Zt-1),10)),isNaN(vt))tt+="$";else{if(Et.groups.length>0){var mr=Et.groups[vt-1];typeof mr<"u"&&(tt+=mr)}it+=vt.toString().length}}vt=xe.indexOf("$",it)}return tt+=xe.substring(it),tt}:Ge=xe;var Ze="",xt=0;if(typeof Le>"u"||Le>0){var bt=0;if(typeof ne=="string"){for(var Lt=U.indexOf(ne,xt);Lt!==-1&&(typeof Le>"u"||bt<Le);)Ze+=U.substring(xt,Lt),Ze+=xe,xt=Lt+ne.length,bt++,Lt=U.indexOf(ne,xt);Ze+=U.substring(xt)}else{var yt=await W(ne,U);if(typeof yt<"u"){for(;typeof yt<"u"&&(typeof Le>"u"||bt<Le);){Ze+=U.substring(xt,yt.start);var Pt=Ge.apply(ze,[yt]);if(w(Pt)&&(Pt=await Pt),typeof Pt=="string")Ze+=Pt;else throw{code:"D3012",stack:new Error().stack,value:Pt};xt=yt.start+yt.match.length,bt++,yt=await W(yt.next)}Ze+=U.substring(xt)}else Ze=U}}else Ze=U;return Ze}}function fe(U){if(!(typeof U>"u")){var ne=typeof window<"u"?window.btoa:function(xe){return new o.Buffer.from(xe,"binary").toString("base64")};return ne(U)}}function Q(U){if(!(typeof U>"u")){var ne=typeof window<"u"?window.atob:function(xe){return new o.Buffer.from(xe,"base64").toString("binary")};return ne(U)}}function _(U){if(!(typeof U>"u")){var ne;try{ne=encodeURIComponent(U)}catch{throw{code:"D3140",stack:new Error().stack,value:U,functionName:"encodeUrlComponent"}}return ne}}function Y(U){if(!(typeof U>"u")){var ne;try{ne=encodeURI(U)}catch{throw{code:"D3140",stack:new Error().stack,value:U,functionName:"encodeUrl"}}return ne}}function he(U){if(!(typeof U>"u")){var ne;try{ne=decodeURIComponent(U)}catch{throw{code:"D3140",stack:new Error().stack,value:U,functionName:"decodeUrlComponent"}}return ne}}function me(U){if(!(typeof U>"u")){var ne;try{ne=decodeURI(U)}catch{throw{code:"D3140",stack:new Error().stack,value:U,functionName:"decodeUrl"}}return ne}}async function ge(U,ne,xe){if(!(typeof U>"u")){if(xe<0)throw{code:"D3020",stack:new Error().stack,value:xe,index:3};var Le=[];if(typeof xe>"u"||xe>0)if(typeof ne=="string")Le=U.split(ne,xe);else{var ze=0,Ge=await W(ne,U);if(typeof Ge<"u"){for(var Ze=0;typeof Ge<"u"&&(typeof xe>"u"||ze<xe);)Le.push(U.substring(Ze,Ge.start)),Ze=Ge.end,Ge=await W(Ge.next),ze++;(typeof xe>"u"||ze<xe)&&Le.push(U.substring(Ze))}else Le.push(U)}return Le}}function le(U,ne){if(!(typeof U>"u"))return typeof ne>"u"&&(ne=""),U.join(ne)}function X(U,ne,xe){if(!(typeof U>"u")){var Le={"decimal-separator":".","grouping-separator":",","exponent-separator":"e",infinity:"Infinity","minus-sign":"-",NaN:"NaN",percent:"%","per-mille":"","zero-digit":"0",digit:"#","pattern-separator":";"},ze=Le;typeof xe<"u"&&Object.keys(xe).forEach(function($t){ze[$t]=xe[$t]});for(var Ge=[],Ze=ze["zero-digit"].charCodeAt(0),xt=Ze;xt<Ze+10;xt++)Ge.push(String.fromCharCode(xt));var bt=Ge.concat([ze["decimal-separator"],ze["exponent-separator"],ze["grouping-separator"],ze.digit,ze["pattern-separator"]]),Lt=ne.split(ze["pattern-separator"]);if(Lt.length>2)throw{code:"D3080",stack:new Error().stack};var yt=function($t){var Wr=(function(){for(var cn,dn=0;dn<$t.length;dn++)if(cn=$t.charAt(dn),bt.indexOf(cn)!==-1&&cn!==ze["exponent-separator"])return $t.substring(0,dn)})(),En=(function(){for(var cn,dn=$t.length-1;dn>=0;dn--)if(cn=$t.charAt(dn),bt.indexOf(cn)!==-1&&cn!==ze["exponent-separator"])return $t.substring(dn+1)})(),Ir=$t.substring(Wr.length,$t.length-En.length),Fn,us,Pr,Cn,Gr=$t.indexOf(ze["exponent-separator"],Wr.length);Gr===-1||Gr>$t.length-En.length?(Fn=Ir,us=void 0):(Fn=Ir.substring(0,Gr),us=Ir.substring(Gr+1));var Yn=Fn.indexOf(ze["decimal-separator"]);return Yn===-1?(Pr=Fn,Cn=En):(Pr=Fn.substring(0,Yn),Cn=Fn.substring(Yn+1)),{prefix:Wr,suffix:En,activePart:Ir,mantissaPart:Fn,exponentPart:us,integerPart:Pr,fractionalPart:Cn,subpicture:$t}},Pt=function($t){var Wr,En,Ir=$t.subpicture,Fn=Ir.indexOf(ze["decimal-separator"]);Fn!==Ir.lastIndexOf(ze["decimal-separator"])&&(Wr="D3081"),Ir.indexOf(ze.percent)!==Ir.lastIndexOf(ze.percent)&&(Wr="D3082"),Ir.indexOf(ze["per-mille"])!==Ir.lastIndexOf(ze["per-mille"])&&(Wr="D3083"),Ir.indexOf(ze.percent)!==-1&&Ir.indexOf(ze["per-mille"])!==-1&&(Wr="D3084");var us=!1;for(En=0;En<$t.mantissaPart.length;En++){var Pr=$t.mantissaPart.charAt(En);if(Ge.indexOf(Pr)!==-1||Pr===ze.digit){us=!0;break}}us||(Wr="D3085");var Cn=$t.activePart.split("").map(function(cn){return bt.indexOf(cn)===-1?"p":"a"}).join("");Cn.indexOf("p")!==-1&&(Wr="D3086"),Fn!==-1?(Ir.charAt(Fn-1)===ze["grouping-separator"]||Ir.charAt(Fn+1)===ze["grouping-separator"])&&(Wr="D3087"):$t.integerPart.charAt($t.integerPart.length-1)===ze["grouping-separator"]&&(Wr="D3088"),Ir.indexOf(ze["grouping-separator"]+ze["grouping-separator"])!==-1&&(Wr="D3089");var Gr=$t.integerPart.indexOf(ze.digit);Gr!==-1&&$t.integerPart.substring(0,Gr).split("").filter(function(cn){return Ge.indexOf(cn)>-1}).length>0&&(Wr="D3090"),Gr=$t.fractionalPart.lastIndexOf(ze.digit),Gr!==-1&&$t.fractionalPart.substring(Gr).split("").filter(function(cn){return Ge.indexOf(cn)>-1}).length>0&&(Wr="D3091");var Yn=typeof $t.exponentPart=="string";if(Yn&&$t.exponentPart.length>0&&(Ir.indexOf(ze.percent)!==-1||Ir.indexOf(ze["per-mille"])!==-1)&&(Wr="D3092"),Yn&&($t.exponentPart.length===0||$t.exponentPart.split("").filter(function(cn){return Ge.indexOf(cn)===-1}).length>0)&&(Wr="D3093"),Wr)throw{code:Wr,stack:new Error().stack}},Et=function($t){var Wr=function(jt,Vs){for(var rs=[],Xs=jt.indexOf(ze["grouping-separator"]);Xs!==-1;){var H=(Vs?jt.substring(0,Xs):jt.substring(Xs)).split("").filter(function(ae){return Ge.indexOf(ae)!==-1||ae===ze.digit}).length;rs.push(H),Xs=$t.integerPart.indexOf(ze["grouping-separator"],Xs+1)}return rs},En=Wr($t.integerPart),Ir=function(jt){if(jt.length===0)return 0;for(var Vs=function(H,ae){return ae===0?H:Vs(ae,H%ae)},rs=jt.reduce(Vs),Xs=1;Xs<=jt.length;Xs++)if(jt.indexOf(Xs*rs)===-1)return 0;return rs},Fn=Ir(En),us=Wr($t.fractionalPart,!0),Pr=$t.integerPart.split("").filter(function(jt){return Ge.indexOf(jt)!==-1}).length,Cn=Pr,Gr=$t.fractionalPart.split(""),Yn=Gr.filter(function(jt){return Ge.indexOf(jt)!==-1}).length,cn=Gr.filter(function(jt){return Ge.indexOf(jt)!==-1||jt===ze.digit}).length,dn=typeof $t.exponentPart=="string";Pr===0&&cn===0&&(dn?(Yn=1,cn=1):Pr=1),dn&&Pr===0&&$t.integerPart.indexOf(ze.digit)!==-1&&(Pr=1),Pr===0&&Yn===0&&(Yn=1);var ho=0;return dn&&(ho=$t.exponentPart.split("").filter(function(jt){return Ge.indexOf(jt)!==-1}).length),{integerPartGroupingPositions:En,regularGrouping:Fn,minimumIntegerPartSize:Pr,scalingFactor:Cn,prefix:$t.prefix,fractionalPartGroupingPositions:us,minimumFactionalPartSize:Yn,maximumFactionalPartSize:cn,minimumExponentSize:ho,suffix:$t.suffix,picture:$t.subpicture}},tt=Lt.map(yt);tt.forEach(Pt);var it=tt.map(Et),vt=ze["minus-sign"],rr=ze["zero-digit"],Zt=ze["decimal-separator"],mr=ze["grouping-separator"];it.length===1&&(it.push(JSON.parse(JSON.stringify(it[0]))),it[1].prefix=vt+it[1].prefix);var Cr;U>=0?Cr=it[0]:Cr=it[1];var ts;Cr.picture.indexOf(ze.percent)!==-1?ts=U*100:Cr.picture.indexOf(ze["per-mille"])!==-1?ts=U*1e3:ts=U;var As,Fs;if(Cr.minimumExponentSize===0)As=ts;else{var Ve=Math.pow(10,Cr.scalingFactor),Ot=Math.pow(10,Cr.scalingFactor-1);for(As=ts,Fs=0;As<Ot;)As*=10,Fs-=1;for(;As>Ve;)As/=10,Fs+=1}var It=Be(As,Cr.maximumFactionalPartSize),Dt=function($t,Wr){var En=Math.abs($t).toFixed(Wr);return rr!=="0"&&(En=En.split("").map(function(Ir){return Ir>="0"&&Ir<="9"?Ge[Ir.charCodeAt(0)-48]:Ir}).join("")),En},Ct=Dt(It,Cr.maximumFactionalPartSize),or=Ct.indexOf(".");for(or===-1?Ct=Ct+Zt:Ct=Ct.replace(".",Zt);Ct.charAt(0)===rr;)Ct=Ct.substring(1);for(;Ct.charAt(Ct.length-1)===rr;)Ct=Ct.substring(0,Ct.length-1);or=Ct.indexOf(Zt);var rn=Cr.minimumIntegerPartSize-or,$r=Cr.minimumFactionalPartSize-(Ct.length-or-1);if(Ct=(rn>0?new Array(rn+1).join(rr):"")+Ct,Ct=Ct+($r>0?new Array($r+1).join(rr):""),or=Ct.indexOf(Zt),Cr.regularGrouping>0)for(var oi=Math.floor((or-1)/Cr.regularGrouping),Ei=1;Ei<=oi;Ei++)Ct=[Ct.slice(0,or-Ei*Cr.regularGrouping),mr,Ct.slice(or-Ei*Cr.regularGrouping)].join("");else Cr.integerPartGroupingPositions.forEach(function($t){Ct=[Ct.slice(0,or-$t),mr,Ct.slice(or-$t)].join(""),or++});if(or=Ct.indexOf(Zt),Cr.fractionalPartGroupingPositions.forEach(function($t){Ct=[Ct.slice(0,$t+or+1),mr,Ct.slice($t+or+1)].join("")}),or=Ct.indexOf(Zt),(Cr.picture.indexOf(Zt)===-1||or===Ct.length-1)&&(Ct=Ct.substring(0,Ct.length-1)),typeof Fs<"u"){var xs=Dt(Fs,0);rn=Cr.minimumExponentSize-xs.length,rn>0&&(xs=new Array(rn+1).join(rr)+xs),Ct=Ct+ze["exponent-separator"]+(Fs<0?vt:"")+xs}return Ct=Cr.prefix+Ct+Cr.suffix,Ct}}function V(U,ne){if(!(typeof U>"u")){if(U=Be(U),typeof ne>"u"?ne=10:ne=Be(ne),ne<2||ne>36)throw{code:"D3100",stack:new Error().stack,value:ne};var xe=U.toString(ne);return xe}}function de(U){var ne;if(!(typeof U>"u")){if(typeof U=="number")ne=U;else if(typeof U=="string"&&/^-?[0-9]+(\.[0-9]+)?([Ee][-+]?[0-9]+)?$/.test(U)&&!isNaN(parseFloat(U))&&isFinite(U))ne=parseFloat(U);else if(typeof U=="string"&&/^(0[xX][0-9A-Fa-f]+)|(0[oO][0-7]+)|(0[bB][0-1]+)$/.test(U))ne=Number(U);else if(U===!0)ne=1;else if(U===!1)ne=0;else throw{code:"D3030",value:U,stack:new Error().stack,index:1};return ne}}function je(U){var ne;if(!(typeof U>"u"))return ne=Math.abs(U),ne}function _e(U){var ne;if(!(typeof U>"u"))return ne=Math.floor(U),ne}function Re(U){var ne;if(!(typeof U>"u"))return ne=Math.ceil(U),ne}function Be(U,ne){var xe;if(!(typeof U>"u")){if(ne){var Le=U.toString().split("e");U=+(Le[0]+"e"+(Le[1]?+Le[1]+ne:ne))}xe=Math.round(U);var ze=xe-U;return Math.abs(ze)===.5&&Math.abs(xe%2)===1&&(xe=xe-1),ne&&(Le=xe.toString().split("e"),xe=+(Le[0]+"e"+(Le[1]?+Le[1]-ne:-ne))),Object.is(xe,-0)&&(xe=0),xe}}function Se(U){var ne;if(!(typeof U>"u")){if(U<0)throw{stack:new Error().stack,code:"D3060",index:1,value:U};return ne=Math.sqrt(U),ne}}function ie(U,ne){var xe;if(!(typeof U>"u")){if(xe=Math.pow(U,ne),!isFinite(xe))throw{stack:new Error().stack,code:"D3061",index:1,value:U,exp:ne};return xe}}function ve(){return Math.random()}function Ae(U){if(!(typeof U>"u")){var ne=!1;if(Array.isArray(U)){if(U.length===1)ne=Ae(U[0]);else if(U.length>1){var xe=U.filter(function(Le){return Ae(Le)});ne=xe.length>0}}else typeof U=="string"?U.length>0&&(ne=!0):d(U)?U!==0&&(ne=!0):U!==null&&typeof U=="object"&&!m(U)?Object.keys(U).length>0&&(ne=!0):typeof U=="boolean"&&U===!0&&(ne=!0);return ne}}function $e(U){if(!(typeof U>"u"))return!Ae(U)}function qe(U,ne,xe,Le){var ze=[ne],Ge=y(U);return Ge>=2&&ze.push(xe),Ge>=3&&ze.push(Le),ze}async function Ie(U,ne){if(!(typeof U>"u")){for(var xe=h(),Le=0;Le<U.length;Le++){var ze=qe(ne,U[Le],Le,U),Ge=await ne.apply(this,ze);typeof Ge<"u"&&xe.push(Ge)}return xe}}async function K(U,ne){if(!(typeof U>"u")){for(var xe=h(),Le=0;Le<U.length;Le++){var ze=U[Le],Ge=qe(ne,ze,Le,U),Ze=await ne.apply(this,Ge);Ae(Ze)&&xe.push(ze)}return xe}}async function Ee(U,ne){if(!(typeof U>"u")){for(var xe=!1,Le,ze=0;ze<U.length;ze++){var Ge=U[ze],Ze=!0;if(typeof ne<"u"){var xt=qe(ne,Ge,ze,U),bt=await ne.apply(this,xt);Ze=Ae(bt)}if(Ze)if(!xe)Le=Ge,xe=!0;else throw{stack:new Error().stack,code:"D3138",index:ze}}if(!xe)throw{stack:new Error().stack,code:"D3139"};return Le}}function Oe(){for(var U=[],ne=Array.prototype.slice.call(arguments),xe=Math.min.apply(Math,ne.map(function(Ge){return Array.isArray(Ge)?Ge.length:0})),Le=0;Le<xe;Le++){var ze=ne.map(Ge=>Ge[Le]);U.push(ze)}return U}async function q(U,ne,xe){if(!(typeof U>"u")){var Le,ze=y(ne);if(ze<2)throw{stack:new Error().stack,code:"D3050",index:1};var Ge;for(typeof xe>"u"&&U.length>0?(Le=U[0],Ge=1):(Le=xe,Ge=0);Ge<U.length;){var Ze=[Le,U[Ge]];ze>=3&&Ze.push(Ge),ze>=4&&Ze.push(U),Le=await ne.apply(this,Ze),Ge++}return Le}}function ee(U){var ne=h();if(Array.isArray(U)){var xe={};U.forEach(function(Le){var ze=ee(Le);ze.forEach(function(Ge){xe[Ge]=!0})}),ne=ee(xe)}else U!==null&&typeof U=="object"&&!m(U)&&Object.keys(U).forEach(Le=>ne.push(Le));return ne}function ce(U,ne){var xe;if(Array.isArray(U)){xe=h();for(var Le=0;Le<U.length;Le++){var ze=ce(U[Le],ne);typeof ze<"u"&&(Array.isArray(ze)?ze.forEach(Ge=>xe.push(Ge)):xe.push(ze))}}else U!==null&&typeof U=="object"&&!m(U)&&(xe=U[ne]);return xe}function Ce(U,ne){return typeof U>"u"?ne:typeof ne>"u"?U:(Array.isArray(U)||(U=h(U)),Array.isArray(ne)||(ne=[ne]),U.concat(ne))}function be(U){return!(typeof U>"u")}function We(U){var ne=h();if(Array.isArray(U))U.forEach(function(ze){ne=Ce(ne,We(ze))});else if(U!==null&&typeof U=="object"&&!b(U))for(var xe in U){var Le={};Le[xe]=U[xe],ne.push(Le)}else ne=U;return ne}function J(U){if(!(typeof U>"u")){var ne={};return U.forEach(function(xe){for(var Le in xe)ne[Le]=xe[Le]}),ne}}function se(U){if(!(typeof U>"u")){if(U.length<=1)return U;for(var ne=U.length,xe=new Array(ne),Le=0;Le<ne;Le++)xe[ne-Le-1]=U[Le];return xe}}async function Te(U,ne){var xe=h();for(var Le in U){var ze=qe(ne,U[Le],Le,U),Ge=await ne.apply(this,ze);typeof Ge<"u"&&xe.push(Ge)}return xe}function Me(U){throw{code:"D3137",stack:new Error().stack,message:U||"$error() function evaluated"}}function Qe(U,ne){if(!U)throw{code:"D3141",stack:new Error().stack,message:ne||"$assert() statement failed"}}function ye(U){if(U!==void 0)return U===null?"null":d(U)?"number":typeof U=="string"?"string":typeof U=="boolean"?"boolean":Array.isArray(U)?"array":m(U)?"function":"object"}async function ue(U,ne){if(!(typeof U>"u")){if(U.length<=1)return U;var xe;if(typeof ne>"u"){if(!f(U)&&!p(U))throw{stack:new Error().stack,code:"D3070",index:1};xe=async function(Ze,xt){return Ze>xt}}else xe=ne;var Le=async function(Ze,xt){var bt=async function(yt,Pt,Et){Pt.length===0?Array.prototype.push.apply(yt,Et):Et.length===0?Array.prototype.push.apply(yt,Pt):await xe(Pt[0],Et[0])?(yt.push(Et[0]),await bt(yt,Pt,Et.slice(1))):(yt.push(Pt[0]),await bt(yt,Pt.slice(1),Et))},Lt=[];return await bt(Lt,Ze,xt),Lt},ze=async function(Ze){if(!Array.isArray(Ze)||Ze.length<=1)return Ze;var xt=Math.floor(Ze.length/2),bt=Ze.slice(0,xt),Lt=Ze.slice(xt);return bt=await ze(bt),Lt=await ze(Lt),await Le(bt,Lt)},Ge=await ze(U);return Ge}}function re(U){if(!(typeof U>"u")){if(U.length<=1)return U;for(var ne=new Array(U.length),xe=0;xe<U.length;xe++){var Le=Math.floor(Math.random()*(xe+1));xe!==Le&&(ne[xe]=ne[Le]),ne[Le]=U[xe]}return ne}}function ke(U){if(!(typeof U>"u")){if(!Array.isArray(U)||U.length<=1)return U;for(var ne=x(U)?h():[],xe=0;xe<U.length;xe++){for(var Le=U[xe],ze=!1,Ge=0;Ge<ne.length;Ge++)if(C(Le,ne[Ge])){ze=!0;break}ze||ne.push(Le)}return ne}}async function Ne(U,ne){var xe={};for(var Le in U){var ze=U[Le],Ge=qe(ne,ze,Le,U),Ze=await ne.apply(this,Ge);Ae(Ze)&&(xe[Le]=ze)}return Object.keys(xe).length===0&&(xe=void 0),xe}return{sum:E,count:j,max:k,min:A,average:R,string:M,substring:P,substringBefore:I,substringAfter:O,lowercase:G,uppercase:B,length:F,trim:z,pad:$,match:oe,contains:D,replace:Z,split:ge,join:le,formatNumber:X,formatBase:V,number:de,floor:_e,ceil:Re,round:Be,abs:je,sqrt:Se,power:ie,random:ve,boolean:Ae,not:$e,map:Ie,zip:Oe,filter:K,single:Ee,foldLeft:q,sift:Ne,keys:ee,lookup:ce,append:Ce,exists:be,spread:We,merge:J,reverse:se,each:Te,error:Me,assert:Qe,type:ye,sort:ue,shuffle:re,distinct:ke,base64encode:fe,base64decode:Q,encodeUrlComponent:_,encodeUrl:Y,decodeUrlComponent:he,decodeUrl:me}})();n.exports=l}).call(this)}).call(this,typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:{})},{"./utils":6}],3:[function(r,n,i){var o=r("./datetime"),a=r("./functions"),l=r("./utils"),d=r("./parser"),p=r("./signature"),f=(function(){var h=l.isNumeric,x=l.isArrayOfStrings,m=l.isArrayOfNumbers,b=l.createSequence,w=l.isSequence,y=l.isFunction,C=l.isLambda,T=l.isIterable,E=l.isPromise,j=l.getFunctionArity,k=l.isDeepEqual,A=Me(null);async function R(re,ke,Ne){var U,ne=Ne.lookup(Symbol.for("jsonata.__evaluate_entry"));switch(ne&&await ne(re,ke,Ne),re.type){case"path":U=await M(re,ke,Ne);break;case"binary":U=await F(re,ke,Ne);break;case"unary":U=await z(re,ke,Ne);break;case"name":U=$(re,ke);break;case"string":case"number":case"value":U=W(re);break;case"wildcard":U=D(re,ke);break;case"descendant":U=Z(re,ke);break;case"parent":U=Ne.lookup(re.slot.label);break;case"condition":U=await _e(re,ke,Ne);break;case"block":U=await Re(re,ke,Ne);break;case"bind":U=await je(re,ke,Ne);break;case"regex":U=Be(re);break;case"function":U=await qe(re,ke,Ne);break;case"variable":U=Se(re,ke,Ne);break;case"lambda":U=Ee(re,ke,Ne);break;case"partial":U=await Oe(re,ke,Ne);break;case"apply":U=await $e(re,ke,Ne);break;case"transform":U=ve(re,ke,Ne);break}if(Object.prototype.hasOwnProperty.call(re,"predicate"))for(var xe=0;xe<re.predicate.length;xe++)U=await B(re.predicate[xe].expr,U,Ne);re.type!=="path"&&Object.prototype.hasOwnProperty.call(re,"group")&&(U=await X(re.group,U,Ne));var Le=Ne.lookup(Symbol.for("jsonata.__evaluate_exit"));return Le&&await Le(re,ke,Ne,U),U&&w(U)&&!U.tupleStream&&(re.keepArray&&(U.keepSingleton=!0),U.length===0?U=void 0:U.length===1&&(U=U.keepSingleton?U:U[0])),U}async function M(re,ke,Ne){var U;Array.isArray(ke)&&re.steps[0].type!=="variable"?U=ke:U=b(ke);for(var ne,xe=!1,Le=void 0,ze=0;ze<re.steps.length;ze++){var Ge=re.steps[ze];if(Ge.tuple&&(xe=!0),ze===0&&Ge.consarray?ne=await R(Ge,U,Ne):xe?Le=await G(Ge,U,Le,Ne):ne=await I(Ge,U,Ne,ze===re.steps.length-1),!xe&&(typeof ne>"u"||ne.length===0))break;typeof Ge.focus>"u"&&(U=ne)}if(xe)if(re.tuple)ne=Le;else for(ne=b(),ze=0;ze<Le.length;ze++)ne.push(Le[ze]["@"]);return re.keepSingletonArray&&(Array.isArray(ne)&&ne.cons&&!ne.sequence&&(ne=b(ne)),ne.keepSingleton=!0),re.hasOwnProperty("group")&&(ne=await X(re.group,xe?Le:ne,Ne)),ne}function P(re,ke){var Ne=Me(re);for(const U in ke)Ne.bind(U,ke[U]);return Ne}async function I(re,ke,Ne,U){var ne;if(re.type==="sort")return ne=await ie(re,ke,Ne),re.stages&&(ne=await O(re.stages,ne,Ne)),ne;ne=b();for(var xe=0;xe<ke.length;xe++){var Le=await R(re,ke[xe],Ne);if(re.stages)for(var ze=0;ze<re.stages.length;ze++)Le=await B(re.stages[ze].expr,Le,Ne);typeof Le<"u"&&ne.push(Le)}var Ge=b();return U&&ne.length===1&&Array.isArray(ne[0])&&!w(ne[0])?Ge=ne[0]:ne.forEach(function(Ze){!Array.isArray(Ze)||Ze.cons?Ge.push(Ze):Ze.forEach(xt=>Ge.push(xt))}),Ge}async function O(re,ke,Ne){for(var U=ke,ne=0;ne<re.length;ne++){var xe=re[ne];switch(xe.type){case"filter":U=await B(xe.expr,U,Ne);break;case"index":for(var Le=0;Le<U.length;Le++){var ze=U[Le];ze[xe.value]=Le}break}}return U}async function G(re,ke,Ne,U){var ne;if(re.type==="sort"){if(Ne)ne=await ie(re,Ne,U);else{var xe=await ie(re,ke,U);ne=b(),ne.tupleStream=!0;for(var Le=0;Le<xe.length;Le++){var ze={"@":xe[Le]};ze[re.index]=Le,ne.push(ze)}}return re.stages&&(ne=await O(re.stages,ne,U)),ne}ne=b(),ne.tupleStream=!0;var Ge=U;Ne===void 0&&(Ne=ke.map(Lt=>({"@":Lt})));for(var Ze=0;Ze<Ne.length;Ze++){Ge=P(U,Ne[Ze]);var xt=await R(re,Ne[Ze]["@"],Ge);if(typeof xt<"u"){Array.isArray(xt)||(xt=[xt]);for(var bt=0;bt<xt.length;bt++)ze={},Object.assign(ze,Ne[Ze]),xt.tupleStream?Object.assign(ze,xt[bt]):(re.focus?(ze[re.focus]=xt[bt],ze["@"]=Ne[Ze]["@"]):ze["@"]=xt[bt],re.index&&(ze[re.index]=bt),re.ancestor&&(ze[re.ancestor.label]=Ne[Ze]["@"])),ne.push(ze)}}return re.stages&&(ne=await O(re.stages,ne,U)),ne}async function B(re,ke,Ne){var U=b();if(ke&&ke.tupleStream&&(U.tupleStream=!0),Array.isArray(ke)||(ke=b(ke)),re.type==="number"){var ne=Math.floor(re.value);ne<0&&(ne=ke.length+ne);var xe=await ke[ne];typeof xe<"u"&&(Array.isArray(xe)?U=xe:U.push(xe))}else for(ne=0;ne<ke.length;ne++){var xe=ke[ne],Le=xe,ze=Ne;ke.tupleStream&&(Le=xe["@"],ze=P(Ne,xe));var Ge=await R(re,Le,ze);h(Ge)&&(Ge=[Ge]),m(Ge)?Ge.forEach(function(xt){var bt=Math.floor(xt);bt<0&&(bt=ke.length+bt),bt===ne&&U.push(xe)}):a.boolean(Ge)&&U.push(xe)}return U}async function F(re,ke,Ne){var U,ne=await R(re.lhs,ke,Ne),xe=re.value,Le=async()=>await R(re.rhs,ke,Ne);if(xe==="and"||xe==="or")try{return await me(ne,Le,xe)}catch(Ge){throw Ge.position=re.position,Ge.token=xe,Ge}var ze=await Le();try{switch(xe){case"+":case"-":case"*":case"/":case"%":U=Q(ne,ze,xe);break;case"=":case"!=":U=_(ne,ze,xe);break;case"<":case"<=":case">":case">=":U=Y(ne,ze,xe);break;case"&":U=le(ne,ze);break;case"..":U=de(ne,ze);break;case"in":U=he(ne,ze);break}}catch(Ge){throw Ge.position=re.position,Ge.token=xe,Ge}return U}async function z(re,ke,Ne){var U;switch(re.value){case"-":if(U=await R(re.expression,ke,Ne),typeof U>"u")U=void 0;else if(h(U))U=-U;else throw{code:"D1002",stack:new Error().stack,position:re.position,token:re.value,value:U};break;case"[":U=[];let Le=await Promise.all(re.expressions.map(async(ze,Ge)=>(Ne.isParallelCall=Ge>0,[ze,await R(ze,ke,Ne)])));for(let ze of Le){var[ne,xe]=ze;typeof xe<"u"&&(ne.value==="["?U.push(xe):U=a.append(U,xe))}re.consarray&&Object.defineProperty(U,"cons",{enumerable:!1,configurable:!1,value:!0});break;case"{":U=await X(re,ke,Ne);break}return U}function $(re,ke,Ne){return a.lookup(ke,re.value)}function W(re){return re.value}function D(re,ke){var Ne=b();return Array.isArray(ke)&&ke.outerWrapper&&ke.length>0&&(ke=ke[0]),ke!==null&&typeof ke=="object"&&Object.keys(ke).forEach(function(U){var ne=ke[U];Array.isArray(ne)?(ne=oe(ne),Ne=a.append(Ne,ne)):Ne.push(ne)}),Ne}function oe(re,ke){return typeof ke>"u"&&(ke=[]),Array.isArray(re)?re.forEach(function(Ne){oe(Ne,ke)}):ke.push(re),ke}function Z(re,ke){var Ne,U=b();return typeof ke<"u"&&(fe(ke,U),U.length===1?Ne=U[0]:Ne=U),Ne}function fe(re,ke){Array.isArray(re)||ke.push(re),Array.isArray(re)?re.forEach(function(Ne){fe(Ne,ke)}):re!==null&&typeof re=="object"&&Object.keys(re).forEach(function(Ne){fe(re[Ne],ke)})}function Q(re,ke,Ne){var U;if(typeof re<"u"&&!h(re))throw{code:"T2001",stack:new Error().stack,value:re};if(typeof ke<"u"&&!h(ke))throw{code:"T2002",stack:new Error().stack,value:ke};if(typeof re>"u"||typeof ke>"u")return U;switch(Ne){case"+":U=re+ke;break;case"-":U=re-ke;break;case"*":U=re*ke;break;case"/":U=re/ke;break;case"%":U=re%ke;break}return U}function _(re,ke,Ne){var U,ne=typeof re,xe=typeof ke;if(ne==="undefined"||xe==="undefined")return!1;switch(Ne){case"=":U=k(re,ke);break;case"!=":U=!k(re,ke);break}return U}function Y(re,ke,Ne){var U,ne=typeof re,xe=typeof ke,Le=ne==="undefined"||ne==="string"||ne==="number",ze=xe==="undefined"||xe==="string"||xe==="number";if(!Le||!ze)throw{code:"T2010",stack:new Error().stack,value:ne==="string"||ne==="number"?ke:re};if(!(ne==="undefined"||xe==="undefined")){if(ne!==xe)throw{code:"T2009",stack:new Error().stack,value:re,value2:ke};switch(Ne){case"<":U=re<ke;break;case"<=":U=re<=ke;break;case">":U=re>ke;break;case">=":U=re>=ke;break}return U}}function he(re,ke){var Ne=!1;if(typeof re>"u"||typeof ke>"u")return!1;Array.isArray(ke)||(ke=[ke]);for(var U=0;U<ke.length;U++)if(ke[U]===re){Ne=!0;break}return Ne}async function me(re,ke,Ne){var U,ne=ge(re);switch(Ne){case"and":U=ne&&ge(await ke());break;case"or":U=ne||ge(await ke());break}return U}function ge(re){var ke=a.boolean(re);return typeof ke>"u"?!1:ke}function le(re,ke){var Ne,U="",ne="";return typeof re<"u"&&(U=a.string(re)),typeof ke<"u"&&(ne=a.string(ke)),Ne=U.concat(ne),Ne}async function X(re,ke,Ne){var U={},ne={},xe=!!(ke&&ke.tupleStream);Array.isArray(ke)||(ke=b(ke)),ke.length===0&&ke.push(void 0);for(var Le=0;Le<ke.length;Le++)for(var ze=ke[Le],Ge=xe?P(Ne,ze):Ne,Ze=0;Ze<re.lhs.length;Ze++){var xt=re.lhs[Ze],bt=await R(xt[0],xe?ze["@"]:ze,Ge);if(typeof bt!="string"&&bt!==void 0)throw{code:"T1003",stack:new Error().stack,position:re.position,value:bt};if(bt!==void 0){var Lt={data:ze,exprIndex:Ze};if(ne.hasOwnProperty(bt)){if(ne[bt].exprIndex!==Ze)throw{code:"D1009",stack:new Error().stack,position:re.position,value:bt};ne[bt].data=a.append(ne[bt].data,ze)}else ne[bt]=Lt}}let yt=await Promise.all(Object.keys(ne).map(async(Et,tt)=>{let it=ne[Et];var vt=it.data,rr=Ne;if(xe){var Zt=V(it.data);vt=Zt["@"],delete Zt["@"],rr=P(Ne,Zt)}return Ne.isParallelCall=tt>0,[Et,await R(re.lhs[it.exprIndex][1],vt,rr)]}));for(let Et of yt){var[bt,Pt]=await Et;typeof Pt<"u"&&(U[bt]=Pt)}return U}function V(re){if(!Array.isArray(re))return re;var ke={};Object.assign(ke,re[0]);for(var Ne=1;Ne<re.length;Ne++)for(const U in re[Ne])ke[U]=a.append(ke[U],re[Ne][U]);return ke}function de(re,ke){var Ne;if(typeof re<"u"&&!Number.isInteger(re))throw{code:"T2003",stack:new Error().stack,value:re};if(typeof ke<"u"&&!Number.isInteger(ke))throw{code:"T2004",stack:new Error().stack,value:ke};if(typeof re>"u"||typeof ke>"u"||re>ke)return Ne;var U=ke-re+1;if(U>1e7)throw{code:"D2014",stack:new Error().stack,value:U};Ne=new Array(U);for(var ne=re,xe=0;ne<=ke;ne++,xe++)Ne[xe]=ne;return Ne.sequence=!0,Ne}async function je(re,ke,Ne){var U=await R(re.rhs,ke,Ne);return Ne.bind(re.lhs.value,U),U}async function _e(re,ke,Ne){var U,ne=await R(re.condition,ke,Ne);return a.boolean(ne)?U=await R(re.then,ke,Ne):typeof re.else<"u"&&(U=await R(re.else,ke,Ne)),U}async function Re(re,ke,Ne){for(var U,ne=Me(Ne),xe=0;xe<re.expressions.length;xe++)U=await R(re.expressions[xe],ke,ne);return U}function Be(re){var ke=new ue.RegexEngine(re.value),Ne=function(U,ne){var xe;ke.lastIndex=ne||0;var Le=ke.exec(U);if(Le!==null){if(xe={match:Le[0],start:Le.index,end:Le.index+Le[0].length,groups:[]},Le.length>1)for(var ze=1;ze<Le.length;ze++)xe.groups.push(Le[ze]);xe.next=function(){if(!(ke.lastIndex>=U.length)){var Ge=Ne(U,ke.lastIndex);if(Ge&&Ge.match==="")throw{code:"D1004",stack:new Error().stack,position:re.position,value:re.value.source};return Ge}}}return xe};return Ne}function Se(re,ke,Ne){var U;return re.value===""?U=ke&&ke.outerWrapper?ke[0]:ke:U=Ne.lookup(re.value),U}async function ie(re,ke,Ne){var U,ne=ke,xe=!!ke.tupleStream,Le=async function(Ge,Ze){for(var xt=0,bt=0;xt===0&&bt<re.terms.length;bt++){var Lt=re.terms[bt],yt=Ge,Pt=Ne;xe&&(yt=Ge["@"],Pt=P(Ne,Ge));var Et=await R(Lt.expression,yt,Pt);yt=Ze,Pt=Ne,xe&&(yt=Ze["@"],Pt=P(Ne,Ze));var tt=await R(Lt.expression,yt,Pt),it=typeof Et,vt=typeof tt;if(it==="undefined"){xt=vt==="undefined"?0:1;continue}if(vt==="undefined"){xt=-1;continue}if(!(it==="string"||it==="number")||!(vt==="string"||vt==="number"))throw{code:"T2008",stack:new Error().stack,position:re.position,value:it==="string"||it==="number"?tt:Et};if(it!==vt)throw{code:"T2007",stack:new Error().stack,position:re.position,value:Et,value2:tt};Et!==tt&&(Et<tt?xt=-1:xt=1,Lt.descending===!0&&(xt=-xt))}return xt===1},ze={environment:Ne,input:ke};return U=await a.sort.apply(ze,[ne,Le]),U}function ve(re,ke,Ne){var U=async function(ne){if(!(typeof ne>"u")){var xe=Ne.lookup("clone");if(!y(xe))throw{code:"T2013",stack:new Error().stack,position:re.position};var Le=await Ie(xe,[ne],null,Ne),ze=await R(re.pattern,Le,Ne);if(typeof ze<"u"){Array.isArray(ze)||(ze=[ze]);for(var Ge=0;Ge<ze.length;Ge++){var Ze=ze[Ge];if(Ze&&(Ze.isPrototypeOf(Le)||Ze instanceof Object.constructor))throw{code:"D1010",stack:new Error().stack,position:re.position};var xt=await R(re.update,Ze,Ne),bt=typeof xt;if(bt!=="undefined"){if(bt!=="object"||xt===null||Array.isArray(xt))throw{code:"T2011",stack:new Error().stack,position:re.update.position,value:xt};for(var Lt in xt)Ze[Lt]=xt[Lt]}if(typeof re.delete<"u"){var yt=await R(re.delete,Ze,Ne);if(typeof yt<"u"){var Pt=yt;if(Array.isArray(yt)||(yt=[yt]),!x(yt))throw{code:"T2012",stack:new Error().stack,position:re.delete.position,value:Pt};for(var Et=0;Et<yt.length;Et++)typeof Ze=="object"&&Ze!==null&&delete Ze[yt[Et]]}}}}return Le}};return J(U,"<(oa):o>")}var Ae=d("function($f, $g) { function($x){ $g($f($x)) } }");async function $e(re,ke,Ne){var U,ne=await R(re.lhs,ke,Ne);if(re.rhs.type==="function")U=await qe(re.rhs,ke,Ne,{context:ne});else{var xe=await R(re.rhs,ke,Ne);if(!y(xe))throw{code:"T2006",stack:new Error().stack,position:re.position,value:xe};if(y(ne)){var Le=await R(Ae,null,Ne);U=await Ie(Le,[ne,xe],null,Ne)}else U=await Ie(xe,[ne],null,Ne)}return U}async function qe(re,ke,Ne,U){var ne,xe=await R(re.procedure,ke,Ne);if(typeof xe>"u"&&re.procedure.type==="path"&&Ne.lookup(re.procedure.steps[0].value))throw{code:"T1005",stack:new Error().stack,position:re.position,token:re.procedure.steps[0].value};var Le=[];typeof U<"u"&&Le.push(U.context);for(var ze=0;ze<re.arguments.length;ze++){const Ze=await R(re.arguments[ze],ke,Ne);if(y(Ze)){const xt=async function(...bt){return await Ie(Ze,bt,null,Ne)};xt.arity=j(Ze),Le.push(xt)}else Le.push(Ze)}var Ge=re.procedure.type==="path"?re.procedure.steps[0].value:re.procedure.value;try{typeof xe=="object"&&(xe.token=Ge,xe.position=re.position),ne=await Ie(xe,Le,ke,Ne)}catch(Ze){throw Ze.position||(Ze.position=re.position),Ze.token||(Ze.token=Ge),Ze}return ne}async function Ie(re,ke,Ne,U){var ne;for(ne=await K(re,ke,Ne,U);C(ne)&&ne.thunk===!0;){var xe=await R(ne.body.procedure,ne.input,ne.environment);ne.body.procedure.type==="variable"&&(xe.token=ne.body.procedure.value),xe.position=ne.body.procedure.position;for(var Le=[],ze=0;ze<ne.body.arguments.length;ze++)Le.push(await R(ne.body.arguments[ze],ne.input,ne.environment));ne=await K(xe,Le,Ne,U)}return ne}async function K(re,ke,Ne,U){var ne;try{var xe=ke;if(re&&(xe=q(re.signature,ke,Ne)),C(re))ne=await ee(re,xe);else if(re&&re._jsonata_function===!0){var Le={environment:U,input:Ne};ne=re.implementation.apply(Le,xe),T(ne)&&(ne=ne.next().value),E(ne)&&(ne=await ne)}else if(typeof re=="function")ne=re.apply(Ne,xe),E(ne)&&(ne=await ne);else throw{code:"T1006",stack:new Error().stack}}catch(ze){throw re&&(typeof ze.token>"u"&&typeof re.token<"u"&&(ze.token=re.token),ze.position=re.position||ze.position),ze}return ne}function Ee(re,ke,Ne){var U={_jsonata_lambda:!0,input:ke,environment:Ne,arguments:re.arguments,signature:re.signature,body:re.body};return re.thunk===!0&&(U.thunk=!0),U.apply=async function(ne,xe){return await Ie(U,xe,ke,ne?ne.environment:Ne)},U}async function Oe(re,ke,Ne){for(var U,ne=[],xe=0;xe<re.arguments.length;xe++){var Le=re.arguments[xe];Le.type==="operator"&&Le.value==="?"?ne.push(Le):ne.push(await R(Le,ke,Ne))}var ze=await R(re.procedure,ke,Ne);if(typeof ze>"u"&&re.procedure.type==="path"&&Ne.lookup(re.procedure.steps[0].value))throw{code:"T1007",stack:new Error().stack,position:re.position,token:re.procedure.steps[0].value};if(C(ze))U=ce(ze,ne);else if(ze&&ze._jsonata_function===!0)U=Ce(ze.implementation,ne);else if(typeof ze=="function")U=Ce(ze,ne);else throw{code:"T1008",stack:new Error().stack,position:re.position,token:re.procedure.type==="path"?re.procedure.steps[0].value:re.procedure.value};return U}function q(re,ke,Ne){if(typeof re>"u")return ke;var U=re.validate(ke,Ne);return U}async function ee(re,ke){var Ne,U=Me(re.environment);return re.arguments.forEach(function(ne,xe){U.bind(ne.value,ke[xe])}),typeof re.body=="function"?Ne=await be(re.body,U):Ne=await R(re.body,re.input,U),Ne}function ce(re,ke){var Ne=Me(re.environment),U=[];re.arguments.forEach(function(xe,Le){var ze=ke[Le];ze&&ze.type==="operator"&&ze.value==="?"?U.push(xe):Ne.bind(xe.value,ze)});var ne={_jsonata_lambda:!0,input:re.input,environment:Ne,arguments:U,body:re.body};return ne}function Ce(re,ke){var Ne=We(re);Ne=Ne.map(function(Le){return"$"+Le.trim()});var U="function("+Ne.join(", ")+"){ _ }",ne=d(U);ne.body=re;var xe=ce(ne,ke);return xe}async function be(re,ke){var Ne=We(re),U=Ne.map(function(Le){return ke.lookup(Le.trim())}),ne={environment:ke},xe=re.apply(ne,U);return E(xe)&&(xe=await xe),xe}function We(re){var ke=re.toString(),Ne=/\(([^)]*)\)/.exec(ke)[1],U=Ne.split(",");return U}function J(re,ke){var Ne={_jsonata_function:!0,implementation:re};return typeof ke<"u"&&(Ne.signature=p(ke)),Ne}async function se(re,ke){if(!(typeof re>"u")){var Ne=this.input;typeof ke<"u"&&(Ne=ke,Array.isArray(Ne)&&!w(Ne)&&(Ne=b(Ne),Ne.outerWrapper=!0));try{var U=d(re,!1)}catch(xe){throw ye(xe),{stack:new Error().stack,code:"D3120",value:xe.message,error:xe}}try{var ne=await R(U,Ne,this.environment)}catch(xe){throw ye(xe),{stack:new Error().stack,code:"D3121",value:xe.message,error:xe}}return ne}}function Te(re){if(!(typeof re>"u"))return JSON.parse(a.string(re))}function Me(re){var ke={};const Ne={bind:function(ne,xe){ke[ne]=xe},lookup:function(ne){var xe;return ke.hasOwnProperty(ne)?xe=ke[ne]:re&&(xe=re.lookup(ne)),xe},timestamp:re?re.timestamp:null,async:re?re.async:!1,isParallelCall:re?re.isParallelCall:!1,global:re?re.global:{ancestry:[null]}};if(re){var U=re.lookup(Symbol.for("jsonata.__createFrame_push"));U&&U(re,Ne)}return Ne}A.bind("sum",J(a.sum,"<a<n>:n>")),A.bind("count",J(a.count,"<a:n>")),A.bind("max",J(a.max,"<a<n>:n>")),A.bind("min",J(a.min,"<a<n>:n>")),A.bind("average",J(a.average,"<a<n>:n>")),A.bind("string",J(a.string,"<x-b?:s>")),A.bind("substring",J(a.substring,"<s-nn?:s>")),A.bind("substringBefore",J(a.substringBefore,"<s-s:s>")),A.bind("substringAfter",J(a.substringAfter,"<s-s:s>")),A.bind("lowercase",J(a.lowercase,"<s-:s>")),A.bind("uppercase",J(a.uppercase,"<s-:s>")),A.bind("length",J(a.length,"<s-:n>")),A.bind("trim",J(a.trim,"<s-:s>")),A.bind("pad",J(a.pad,"<s-ns?:s>")),A.bind("match",J(a.match,"<s-f<s:o>n?:a<o>>")),A.bind("contains",J(a.contains,"<s-(sf):b>")),A.bind("replace",J(a.replace,"<s-(sf)(sf)n?:s>")),A.bind("split",J(a.split,"<s-(sf)n?:a<s>>")),A.bind("join",J(a.join,"<a<s>s?:s>")),A.bind("formatNumber",J(a.formatNumber,"<n-so?:s>")),A.bind("formatBase",J(a.formatBase,"<n-n?:s>")),A.bind("formatInteger",J(o.formatInteger,"<n-s:s>")),A.bind("parseInteger",J(o.parseInteger,"<s-s:n>")),A.bind("number",J(a.number,"<(nsb)-:n>")),A.bind("floor",J(a.floor,"<n-:n>")),A.bind("ceil",J(a.ceil,"<n-:n>")),A.bind("round",J(a.round,"<n-n?:n>")),A.bind("abs",J(a.abs,"<n-:n>")),A.bind("sqrt",J(a.sqrt,"<n-:n>")),A.bind("power",J(a.power,"<n-n:n>")),A.bind("random",J(a.random,"<:n>")),A.bind("boolean",J(a.boolean,"<x-:b>")),A.bind("not",J(a.not,"<x-:b>")),A.bind("map",J(a.map,"<af>")),A.bind("zip",J(a.zip,"<a+>")),A.bind("filter",J(a.filter,"<af>")),A.bind("single",J(a.single,"<af?>")),A.bind("reduce",J(a.foldLeft,"<afj?:j>")),A.bind("sift",J(a.sift,"<o-f?:o>")),A.bind("keys",J(a.keys,"<x-:a<s>>")),A.bind("lookup",J(a.lookup,"<x-s:x>")),A.bind("append",J(a.append,"<xx:a>")),A.bind("exists",J(a.exists,"<x:b>")),A.bind("spread",J(a.spread,"<x-:a<o>>")),A.bind("merge",J(a.merge,"<a<o>:o>")),A.bind("reverse",J(a.reverse,"<a:a>")),A.bind("each",J(a.each,"<o-f:a>")),A.bind("error",J(a.error,"<s?:x>")),A.bind("assert",J(a.assert,"<bs?:x>")),A.bind("type",J(a.type,"<x:s>")),A.bind("sort",J(a.sort,"<af?:a>")),A.bind("shuffle",J(a.shuffle,"<a:a>")),A.bind("distinct",J(a.distinct,"<x:x>")),A.bind("base64encode",J(a.base64encode,"<s-:s>")),A.bind("base64decode",J(a.base64decode,"<s-:s>")),A.bind("encodeUrlComponent",J(a.encodeUrlComponent,"<s-:s>")),A.bind("encodeUrl",J(a.encodeUrl,"<s-:s>")),A.bind("decodeUrlComponent",J(a.decodeUrlComponent,"<s-:s>")),A.bind("decodeUrl",J(a.decodeUrl,"<s-:s>")),A.bind("eval",J(se,"<sx?:x>")),A.bind("toMillis",J(o.toMillis,"<s-s?:n>")),A.bind("fromMillis",J(o.fromMillis,"<n-s?s?:s>")),A.bind("clone",J(Te,"<(oa)-:o>"));var Qe={S0101:"String literal must be terminated by a matching quote",S0102:"Number out of range: {{token}}",S0103:"Unsupported escape sequence: \\{{token}}",S0104:"The escape sequence \\u must be followed by 4 hex digits",S0105:"Quoted property name must be terminated with a backquote (`)",S0106:"Comment has no closing tag",S0201:"Syntax error: {{token}}",S0202:"Expected {{value}}, got {{token}}",S0203:"Expected {{value}} before end of expression",S0204:"Unknown operator: {{token}}",S0205:"Unexpected token: {{token}}",S0206:"Unknown expression type: {{token}}",S0207:"Unexpected end of expression",S0208:"Parameter {{value}} of function definition must be a variable name (start with $)",S0209:"A predicate cannot follow a grouping expression in a step",S0210:"Each step can only have one grouping expression",S0211:"The symbol {{token}} cannot be used as a unary operator",S0212:"The left side of := must be a variable name (start with $)",S0213:"The literal value {{value}} cannot be used as a step within a path expression",S0214:"The right side of {{token}} must be a variable name (start with $)",S0215:"A context variable binding must precede any predicates on a step",S0216:"A context variable binding must precede the 'order-by' clause on a step",S0217:"The object representing the 'parent' cannot be derived from this expression",S0301:"Empty regular expressions are not allowed",S0302:"No terminating / in regular expression",S0402:"Choice groups containing parameterized types are not supported",S0401:"Type parameters can only be applied to functions and arrays",S0500:"Attempted to evaluate an expression containing syntax error(s)",T0410:"Argument {{index}} of function {{token}} does not match function signature",T0411:"Context value is not a compatible type with argument {{index}} of function {{token}}",T0412:"Argument {{index}} of function {{token}} must be an array of {{type}}",D1001:"Number out of range: {{value}}",D1002:"Cannot negate a non-numeric value: {{value}}",T1003:"Key in object structure must evaluate to a string; got: {{value}}",D1004:"Regular expression matches zero length string",T1005:"Attempted to invoke a non-function. Did you mean ${{{token}}}?",T1006:"Attempted to invoke a non-function",T1007:"Attempted to partially apply a non-function. Did you mean ${{{token}}}?",T1008:"Attempted to partially apply a non-function",D1009:"Multiple key definitions evaluate to same key: {{value}}",D1010:"Attempted to access the Javascript object prototype",T1010:"The matcher function argument passed to function {{token}} does not return the correct object structure",T2001:"The left side of the {{token}} operator must evaluate to a number",T2002:"The right side of the {{token}} operator must evaluate to a number",T2003:"The left side of the range operator (..) must evaluate to an integer",T2004:"The right side of the range operator (..) must evaluate to an integer",D2005:"The left side of := must be a variable name (start with $)",T2006:"The right side of the function application operator ~> must be a function",T2007:"Type mismatch when comparing values {{value}} and {{value2}} in order-by clause",T2008:"The expressions within an order-by clause must evaluate to numeric or string values",T2009:"The values {{value}} and {{value2}} either side of operator {{token}} must be of the same data type",T2010:"The expressions either side of operator {{token}} must evaluate to numeric or string values",T2011:"The insert/update clause of the transform expression must evaluate to an object: {{value}}",T2012:"The delete clause of the transform expression must evaluate to a string or array of strings: {{value}}",T2013:"The transform expression clones the input object using the $clone() function.  This has been overridden in the current scope by a non-function.",D2014:"The size of the sequence allocated by the range operator (..) must not exceed 1e6.  Attempted to allocate {{value}}.",D3001:"Attempting to invoke string function on Infinity or NaN",D3010:"Second argument of replace function cannot be an empty string",D3011:"Fourth argument of replace function must evaluate to a positive number",D3012:"Attempted to replace a matched string with a non-string value",D3020:"Third argument of split function must evaluate to a positive number",D3030:"Unable to cast value to a number: {{value}}",D3040:"Third argument of match function must evaluate to a positive number",D3050:"The second argument of reduce function must be a function with at least two arguments",D3060:"The sqrt function cannot be applied to a negative number: {{value}}",D3061:"The power function has resulted in a value that cannot be represented as a JSON number: base={{value}}, exponent={{exp}}",D3070:"The single argument form of the sort function can only be applied to an array of strings or an array of numbers.  Use the second argument to specify a comparison function",D3080:"The picture string must only contain a maximum of two sub-pictures",D3081:"The sub-picture must not contain more than one instance of the 'decimal-separator' character",D3082:"The sub-picture must not contain more than one instance of the 'percent' character",D3083:"The sub-picture must not contain more than one instance of the 'per-mille' character",D3084:"The sub-picture must not contain both a 'percent' and a 'per-mille' character",D3085:"The mantissa part of a sub-picture must contain at least one character that is either an 'optional digit character' or a member of the 'decimal digit family'",D3086:"The sub-picture must not contain a passive character that is preceded by an active character and that is followed by another active character",D3087:"The sub-picture must not contain a 'grouping-separator' character that appears adjacent to a 'decimal-separator' character",D3088:"The sub-picture must not contain a 'grouping-separator' at the end of the integer part",D3089:"The sub-picture must not contain two adjacent instances of the 'grouping-separator' character",D3090:"The integer part of the sub-picture must not contain a member of the 'decimal digit family' that is followed by an instance of the 'optional digit character'",D3091:"The fractional part of the sub-picture must not contain an instance of the 'optional digit character' that is followed by a member of the 'decimal digit family'",D3092:"A sub-picture that contains a 'percent' or 'per-mille' character must not contain a character treated as an 'exponent-separator'",D3093:"The exponent part of the sub-picture must comprise only of one or more characters that are members of the 'decimal digit family'",D3100:"The radix of the formatBase function must be between 2 and 36.  It was given {{value}}",D3110:"The argument of the toMillis function must be an ISO 8601 formatted timestamp. Given {{value}}",D3120:"Syntax error in expression passed to function eval: {{value}}",D3121:"Dynamic error evaluating the expression passed to function eval: {{value}}",D3130:"Formatting or parsing an integer as a sequence starting with {{value}} is not supported by this implementation",D3131:"In a decimal digit pattern, all digits must be from the same decimal group",D3132:"Unknown component specifier {{value}} in date/time picture string",D3133:"The 'name' modifier can only be applied to months and days in the date/time picture string, not {{value}}",D3134:"The timezone integer format specifier cannot have more than four digits",D3135:"No matching closing bracket ']' in date/time picture string",D3136:"The date/time picture string is missing specifiers required to parse the timestamp",D3137:"{{{message}}}",D3138:"The $single() function expected exactly 1 matching result.  Instead it matched more.",D3139:"The $single() function expected exactly 1 matching result.  Instead it matched 0.",D3140:"Malformed URL passed to ${{{functionName}}}(): {{value}}",D3141:"{{{message}}}"};function ye(re){var ke=Qe[re.code];if(typeof ke<"u"){var Ne=ke.replace(/\{\{\{([^}]+)}}}/g,function(){return re[arguments[1]]});Ne=Ne.replace(/\{\{([^}]+)}}/g,function(){return JSON.stringify(re[arguments[1]])}),re.message=Ne}}function ue(re,ke){var Ne,U;try{Ne=d(re,ke&&ke.recover),U=Ne.errors,delete Ne.errors}catch(Le){throw ye(Le),Le}var ne=Me(A),xe=new Date;return ne.bind("now",J(function(Le,ze){return o.fromMillis(xe.getTime(),Le,ze)},"<s?s?:s>")),ne.bind("millis",J(function(){return xe.getTime()},"<:n>")),ke&&ke.RegexEngine?ue.RegexEngine=ke.RegexEngine:ue.RegexEngine=RegExp,{evaluate:async function(Le,ze,Ge){if(typeof U<"u"){var Ze={code:"S0500",position:0};throw ye(Ze),Ze}if(typeof ze<"u"){var xt;xt=Me(ne);for(var bt in ze)xt.bind(bt,ze[bt])}else xt=ne;xt.bind("$",Le),xe=new Date,xt.timestamp=xe,Array.isArray(Le)&&!w(Le)&&(Le=b(Le),Le.outerWrapper=!0);var Lt;try{return Lt=await R(Ne,Le,xt),typeof Ge=="function"&&Ge(null,Lt),Lt}catch(yt){throw ye(yt),yt}},assign:function(Le,ze){ne.bind(Le,ze)},registerFunction:function(Le,ze,Ge){var Ze=J(ze,Ge);ne.bind(Le,Ze)},ast:function(){return Ne},errors:function(){return U}}}return ue.parser=d,ue})();n.exports=f},{"./datetime":1,"./functions":2,"./parser":4,"./signature":5,"./utils":6}],4:[function(r,n,i){var o=r("./signature");const a=(()=>{var l={".":75,"[":80,"]":0,"{":70,"}":0,"(":80,")":0,",":0,"@":80,"#":80,";":80,":":80,"?":20,"+":50,"-":50,"*":60,"/":60,"%":60,"|":20,"=":40,"<":40,">":40,"^":40,"**":60,"..":20,":=":10,"!=":40,"<=":40,">=":40,"~>":40,"?:":40,"??":40,and:30,or:25,in:40,"&":50,"!":0,"~":0},d={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},p=function(h){var x=0,m=h.length,b=function(C,T){var E={type:C,value:T,position:x};return E},w=function(){for(var C=x,T=0,E,j,k=function(R){if(h.charAt(R)==="/"&&T===0){for(var M=0;h.charAt(R-(M+1))==="\\";)M++;if(M%2===0)return!0}return!1};x<m;){var A=h.charAt(x);if(k(x)){if(E=h.substring(C,x),E==="")throw{code:"S0301",stack:new Error().stack,position:x};for(x++,A=h.charAt(x),C=x;A==="i"||A==="m";)x++,A=h.charAt(x);return j=h.substring(C,x)+"g",new RegExp(E,j)}(A==="("||A==="["||A==="{")&&h.charAt(x-1)!=="\\"&&T++,(A===")"||A==="]"||A==="}")&&h.charAt(x-1)!=="\\"&&T--,x++}throw{code:"S0302",stack:new Error().stack,position:x}},y=function(C){if(x>=m)return null;for(var T=h.charAt(x);x<m&&` 	
\r\v`.indexOf(T)>-1;)x++,T=h.charAt(x);if(T==="/"&&h.charAt(x+1)==="*"){var E=x;for(x+=2,T=h.charAt(x);!(T==="*"&&h.charAt(x+1)==="/");)if(T=h.charAt(++x),x>=m)throw{code:"S0106",stack:new Error().stack,position:E};return x+=2,T=h.charAt(x),y(C)}if(C!==!0&&T==="/")return x++,b("regex",w());if(T==="."&&h.charAt(x+1)===".")return x+=2,b("operator","..");if(T===":"&&h.charAt(x+1)==="=")return x+=2,b("operator",":=");if(T==="!"&&h.charAt(x+1)==="=")return x+=2,b("operator","!=");if(T===">"&&h.charAt(x+1)==="=")return x+=2,b("operator",">=");if(T==="<"&&h.charAt(x+1)==="=")return x+=2,b("operator","<=");if(T==="*"&&h.charAt(x+1)==="*")return x+=2,b("operator","**");if(T==="~"&&h.charAt(x+1)===">")return x+=2,b("operator","~>");if(T==="?"&&h.charAt(x+1)===":")return x+=2,b("operator","?:");if(T==="?"&&h.charAt(x+1)==="?")return x+=2,b("operator","??");if(Object.prototype.hasOwnProperty.call(l,T))return x++,b("operator",T);if(T==='"'||T==="'"){var j=T;x++;for(var k="";x<m;){if(T=h.charAt(x),T==="\\")if(x++,T=h.charAt(x),Object.prototype.hasOwnProperty.call(d,T))k+=d[T];else if(T==="u"){var A=h.substr(x+1,4);if(/^[0-9a-fA-F]+$/.test(A)){var R=parseInt(A,16);k+=String.fromCharCode(R),x+=4}else throw{code:"S0104",stack:new Error().stack,position:x}}else throw{code:"S0103",stack:new Error().stack,position:x,token:T};else{if(T===j)return x++,b("string",k);k+=T}x++}throw{code:"S0101",stack:new Error().stack,position:x}}var M=/^-?(0|([1-9][0-9]*))(\.[0-9]+)?([Ee][-+]?[0-9]+)?/,P=M.exec(h.substring(x));if(P!==null){var I=parseFloat(P[0]);if(!isNaN(I)&&isFinite(I))return x+=P[0].length,b("number",I);throw{code:"S0102",stack:new Error().stack,position:x,token:P[0]}}var O;if(T==="`"){x++;var G=h.indexOf("`",x);if(G!==-1)return O=h.substring(x,G),x=G+1,b("name",O);throw x=m,{code:"S0105",stack:new Error().stack,position:x}}for(var B=x,F;;)if(F=h.charAt(B),B===m||` 	
\r\v`.indexOf(F)>-1||Object.prototype.hasOwnProperty.call(l,F)){if(h.charAt(x)==="$")return O=h.substring(x+1,B),x=B,b("variable",O);switch(O=h.substring(x,B),x=B,O){case"or":case"in":case"and":return b("operator",O);case"true":return b("value",!0);case"false":return b("value",!1);case"null":return b("value",null);default:return x===m&&O===""?null:b("name",O)}}else B++};return y},f=function(h,x){var m,b,w={},y=[],C=function(){var Q=[];m.id!=="(end)"&&Q.push({type:m.type,value:m.value,position:m.position});for(var _=b();_!==null;)Q.push(_),_=b();return Q},T={nud:function(){var Q={code:"S0211",token:this.value,position:this.position};if(x)return Q.remaining=C(),Q.type="error",y.push(Q),Q;throw Q.stack=new Error().stack,Q}},E=function(Q,_){var Y=w[Q];return _=_||0,Y?_>=Y.lbp&&(Y.lbp=_):(Y=Object.create(T),Y.id=Y.value=Q,Y.lbp=_,w[Q]=Y),Y},j=function(Q){if(x){Q.remaining=C(),y.push(Q);var _=w["(error)"];return m=Object.create(_),m.error=Q,m.type="(error)",m}else throw Q.stack=new Error().stack,Q},k=function(Q,_){if(Q&&m.id!==Q){var Y;m.id==="(end)"?Y="S0203":Y="S0202";var he={code:Y,position:m.position,token:m.value,value:Q};return j(he)}var me=b(_);if(me===null)return m=w["(end)"],m.position=h.length,m;var ge=me.value,le=me.type,X;switch(le){case"name":case"variable":X=w["(name)"];break;case"operator":if(X=w[ge],!X)return j({code:"S0204",stack:new Error().stack,position:me.position,token:ge});break;case"string":case"number":case"value":X=w["(literal)"];break;case"regex":le="regex",X=w["(regex)"];break;default:return j({code:"S0205",stack:new Error().stack,position:me.position,token:ge})}return m=Object.create(X),m.value=ge,m.type=le,m.position=me.position,m},A=function(Q){var _,Y=m;for(k(null,!0),_=Y.nud();Q<m.lbp;)Y=m,k(),_=Y.led(_);return _},R=function(Q){var _=E(Q,0);_.nud=function(){return this}},M=function(Q,_,Y){var he=_||l[Q],me=E(Q,he);return me.led=Y||function(ge){return this.lhs=ge,this.rhs=A(he),this.type="binary",this},me},P=function(Q,_,Y){var he=E(Q,_);return he.led=Y,he},I=function(Q,_){var Y=E(Q);return Y.nud=_||function(){return this.expression=A(70),this.type="unary",this},Y};R("(end)"),R("(name)"),R("(literal)"),R("(regex)"),E(":"),E(";"),E(","),E(")"),E("]"),E("}"),E(".."),M("."),M("+"),M("-"),M("*"),M("/"),M("%"),M("="),M("<"),M(">"),M("!="),M("<="),M(">="),M("&"),M("and"),M("or"),M("in"),R("and"),R("or"),R("in"),I("-"),M("~>"),M("??",l["??"],function(Q){return this.type="condition",this.condition={type:"function",value:"(",procedure:{type:"variable",value:"exists"},arguments:[Q]},this.then=Q,this.else=A(0),this}),P("(error)",10,function(Q){return this.lhs=Q,this.error=m.error,this.remaining=C(),this.type="error",this}),I("*",function(){return this.type="wildcard",this}),I("**",function(){return this.type="descendant",this}),I("%",function(){return this.type="parent",this}),M("(",l["("],function(Q){if(this.procedure=Q,this.type="function",this.arguments=[],m.id!==")")for(;m.type==="operator"&&m.id==="?"?(this.type="partial",this.arguments.push(m),k("?")):this.arguments.push(A(0)),m.id===",";)k(",");if(k(")",!0),Q.type==="name"&&(Q.value==="function"||Q.value==="")){if(this.arguments.forEach(function(ge,le){if(ge.type!=="variable")return j({code:"S0208",stack:new Error().stack,position:ge.position,token:ge.value,value:le+1})}),this.type="lambda",m.id==="<"){for(var _=m.position,Y=1,he="<";Y>0&&m.id!=="{"&&m.id!=="(end)";){var me=k();me.id===">"?Y--:me.id==="<"&&Y++,he+=me.value}k(">");try{this.signature=o(he)}catch(ge){return ge.position=_+ge.offset,j(ge)}}k("{"),this.body=A(0),k("}")}return this}),I("(",function(){for(var Q=[];m.id!==")"&&(Q.push(A(0)),m.id===";");)k(";");return k(")",!0),this.type="block",this.expressions=Q,this}),I("[",function(){var Q=[];if(m.id!=="]")for(;;){var _=A(0);if(m.id===".."){var Y={type:"binary",value:"..",position:m.position,lhs:_};k(".."),Y.rhs=A(0),_=Y}if(Q.push(_),m.id!==",")break;k(",")}return k("]",!0),this.expressions=Q,this.type="unary",this}),M("[",l["["],function(Q){if(m.id==="]"){for(var _=Q;_&&_.type==="binary"&&_.value==="[";)_=_.lhs;return _.keepArray=!0,k("]"),Q}else return this.lhs=Q,this.rhs=A(l["]"]),this.type="binary",k("]",!0),this}),M("^",l["^"],function(Q){k("(");for(var _=[];;){var Y={descending:!1};if(m.id==="<"?k("<"):m.id===">"&&(Y.descending=!0,k(">")),Y.expression=A(0),_.push(Y),m.id!==",")break;k(",")}return k(")"),this.lhs=Q,this.rhs=_,this.type="binary",this});var O=function(Q){var _=[];if(m.id!=="}")for(;;){var Y=A(0);k(":");var he=A(0);if(_.push([Y,he]),m.id!==",")break;k(",")}return k("}",!0),typeof Q>"u"?(this.lhs=_,this.type="unary"):(this.lhs=Q,this.rhs=_,this.type="binary"),this};I("{",O),M("{",l["{"],O),P(":=",l[":="],function(Q){return Q.type!=="variable"?j({code:"S0212",stack:new Error().stack,position:Q.position,token:Q.value}):(this.lhs=Q,this.rhs=A(l[":="]-1),this.type="binary",this)}),M("@",l["@"],function(Q){return this.lhs=Q,this.rhs=A(l["@"]),this.rhs.type!=="variable"?j({code:"S0214",stack:new Error().stack,position:this.rhs.position,token:"@"}):(this.type="binary",this)}),M("#",l["#"],function(Q){return this.lhs=Q,this.rhs=A(l["#"]),this.rhs.type!=="variable"?j({code:"S0214",stack:new Error().stack,position:this.rhs.position,token:"#"}):(this.type="binary",this)}),M("?",l["?"],function(Q){return this.type="condition",this.condition=Q,this.then=A(0),m.id===":"&&(k(":"),this.else=A(0)),this}),M("?:",l["?:"],function(Q){return this.type="condition",this.condition=Q,this.then=Q,this.else=A(0),this}),I("|",function(){return this.type="transform",this.pattern=A(0),k("|"),this.update=A(0),m.id===","&&(k(","),this.delete=A(0)),k("|"),this});var G=function(Q){var _;if(Q.type==="function"&&!Q.predicate){var Y={type:"lambda",thunk:!0,arguments:[],position:Q.position};Y.body=Q,_=Y}else if(Q.type==="condition")Q.then=G(Q.then),typeof Q.else<"u"&&(Q.else=G(Q.else)),_=Q;else if(Q.type==="block"){var he=Q.expressions.length;he>0&&(Q.expressions[he-1]=G(Q.expressions[he-1])),_=Q}else _=Q;return _},B=0,F=0,z=[],$=function(Q,_){switch(Q.type){case"name":case"wildcard":_.level--,_.level===0&&(typeof Q.ancestor>"u"||(z[_.index].slot.label=Q.ancestor.label),Q.ancestor=_,Q.tuple=!0);break;case"parent":_.level++;break;case"block":Q.expressions.length>0&&(Q.tuple=!0,_=$(Q.expressions[Q.expressions.length-1],_));break;case"path":Q.tuple=!0;var Y=Q.steps.length-1;for(_=$(Q.steps[Y--],_);_.level>0&&Y>=0;)_=$(Q.steps[Y--],_);break;default:throw{code:"S0217",token:Q.type,position:Q.position}}return _},W=function(Q,_){if(typeof _.seekingParent<"u"||_.type==="parent"){var Y=typeof _.seekingParent<"u"?_.seekingParent:[];_.type==="parent"&&Y.push(_.slot),typeof Q.seekingParent>"u"?Q.seekingParent=Y:Array.prototype.push.apply(Q.seekingParent,Y)}},D=function(Q){var _=Q.steps.length-1,Y=Q.steps[_],he=typeof Y.seekingParent<"u"?Y.seekingParent:[];Y.type==="parent"&&he.push(Y.slot);for(var me=0;me<he.length;me++){var ge=he[me];for(_=Q.steps.length-2;ge.level>0;){if(_<0){typeof Q.seekingParent>"u"?Q.seekingParent=[ge]:Q.seekingParent.push(ge);break}for(var le=Q.steps[_--];_>=0&&le.focus&&Q.steps[_].focus;)le=Q.steps[_--];ge=$(le,ge)}}},oe=function(Q){var _;switch(Q.type){case"binary":switch(Q.value){case".":var Y=oe(Q.lhs);Y.type==="path"?_=Y:_={type:"path",steps:[Y]},Y.type==="parent"&&(_.seekingParent=[Y.slot]);var he=oe(Q.rhs);he.type==="function"&&he.procedure.type==="path"&&he.procedure.steps.length===1&&he.procedure.steps[0].type==="name"&&_.steps[_.steps.length-1].type==="function"&&(_.steps[_.steps.length-1].nextFunction=he.procedure.steps[0].value),he.type==="path"?Array.prototype.push.apply(_.steps,he.steps):(typeof he.predicate<"u"&&(he.stages=he.predicate,delete he.predicate),_.steps.push(he)),_.steps.filter(function(Be){if(Be.type==="number"||Be.type==="value")throw{code:"S0213",stack:new Error().stack,position:Be.position,value:Be.value};return Be.type==="string"}).forEach(function(Be){Be.type="name"}),_.steps.filter(function(Be){return Be.keepArray===!0}).length>0&&(_.keepSingletonArray=!0);var me=_.steps[0];me.type==="unary"&&me.value==="["&&(me.consarray=!0);var ge=_.steps[_.steps.length-1];ge.type==="unary"&&ge.value==="["&&(ge.consarray=!0),D(_);break;case"[":_=oe(Q.lhs);var le=_,X="predicate";if(_.type==="path"&&(le=_.steps[_.steps.length-1],X="stages"),typeof le.group<"u")throw{code:"S0209",stack:new Error().stack,position:Q.position};typeof le[X]>"u"&&(le[X]=[]);var V=oe(Q.rhs);typeof V.seekingParent<"u"&&(V.seekingParent.forEach(Be=>{Be.level===1?$(le,Be):Be.level--}),W(le,V)),le[X].push({type:"filter",expr:V,position:Q.position});break;case"{":if(_=oe(Q.lhs),typeof _.group<"u")throw{code:"S0210",stack:new Error().stack,position:Q.position};_.group={lhs:Q.rhs.map(function(Be){return[oe(Be[0]),oe(Be[1])]}),position:Q.position};break;case"^":_=oe(Q.lhs),_.type!=="path"&&(_={type:"path",steps:[_]});var de={type:"sort",position:Q.position};de.terms=Q.rhs.map(function(Be){var Se=oe(Be.expression);return W(de,Se),{descending:Be.descending,expression:Se}}),_.steps.push(de),D(_);break;case":=":_={type:"bind",value:Q.value,position:Q.position},_.lhs=oe(Q.lhs),_.rhs=oe(Q.rhs),W(_,_.rhs);break;case"@":if(_=oe(Q.lhs),le=_,_.type==="path"&&(le=_.steps[_.steps.length-1]),typeof le.stages<"u"||typeof le.predicate<"u")throw{code:"S0215",stack:new Error().stack,position:Q.position};if(le.type==="sort")throw{code:"S0216",stack:new Error().stack,position:Q.position};Q.keepArray&&(le.keepArray=!0),le.focus=Q.rhs.value,le.tuple=!0;break;case"#":_=oe(Q.lhs),le=_,_.type==="path"?le=_.steps[_.steps.length-1]:(_={type:"path",steps:[_]},typeof le.predicate<"u"&&(le.stages=le.predicate,delete le.predicate)),typeof le.stages>"u"?le.index=Q.rhs.value:le.stages.push({type:"index",value:Q.rhs.value,position:Q.position}),le.tuple=!0;break;case"~>":_={type:"apply",value:Q.value,position:Q.position},_.lhs=oe(Q.lhs),_.rhs=oe(Q.rhs),_.keepArray=_.lhs.keepArray||_.rhs.keepArray;break;default:_={type:Q.type,value:Q.value,position:Q.position},_.lhs=oe(Q.lhs),_.rhs=oe(Q.rhs),W(_,_.lhs),W(_,_.rhs)}break;case"unary":_={type:Q.type,value:Q.value,position:Q.position},Q.value==="["?_.expressions=Q.expressions.map(function(Be){var Se=oe(Be);return W(_,Se),Se}):Q.value==="{"?_.lhs=Q.lhs.map(function(Be){var Se=oe(Be[0]);W(_,Se);var ie=oe(Be[1]);return W(_,ie),[Se,ie]}):(_.expression=oe(Q.expression),Q.value==="-"&&_.expression.type==="number"?(_=_.expression,_.value=-_.value):W(_,_.expression));break;case"function":case"partial":_={type:Q.type,name:Q.name,value:Q.value,position:Q.position},_.arguments=Q.arguments.map(function(Be){var Se=oe(Be);return W(_,Se),Se}),_.procedure=oe(Q.procedure);break;case"lambda":_={type:Q.type,arguments:Q.arguments,signature:Q.signature,position:Q.position};var je=oe(Q.body);_.body=G(je);break;case"condition":_={type:Q.type,position:Q.position},_.condition=oe(Q.condition),W(_,_.condition),_.then=oe(Q.then),W(_,_.then),typeof Q.else<"u"&&(_.else=oe(Q.else),W(_,_.else));break;case"transform":_={type:Q.type,position:Q.position},_.pattern=oe(Q.pattern),_.update=oe(Q.update),typeof Q.delete<"u"&&(_.delete=oe(Q.delete));break;case"block":_={type:Q.type,position:Q.position},_.expressions=Q.expressions.map(function(Be){var Se=oe(Be);return W(_,Se),(Se.consarray||Se.type==="path"&&Se.steps[0].consarray)&&(_.consarray=!0),Se});break;case"name":_={type:"path",steps:[Q]},Q.keepArray&&(_.keepSingletonArray=!0);break;case"parent":_={type:"parent",slot:{label:"!"+B++,level:1,index:F++}},z.push(_);break;case"string":case"number":case"value":case"wildcard":case"descendant":case"variable":case"regex":_=Q;break;case"operator":if(Q.value==="and"||Q.value==="or"||Q.value==="in")Q.type="name",_=oe(Q);else if(Q.value==="?")_=Q;else throw{code:"S0201",stack:new Error().stack,position:Q.position,token:Q.value};break;case"error":_=Q,Q.lhs&&(_=oe(Q.lhs));break;default:var _e="S0206";Q.id==="(end)"&&(_e="S0207");var Re={code:_e,position:Q.position,token:Q.value};if(x)return y.push(Re),{type:"error",error:Re};throw Re.stack=new Error().stack,Re}return Q.keepArray&&(_.keepArray=!0),_};b=p(h),k();var Z=A(0);if(m.id!=="(end)"){var fe={code:"S0201",position:m.position,token:m.value};j(fe)}if(Z=oe(Z),Z.type==="parent"||typeof Z.seekingParent<"u")throw{code:"S0217",token:Z.type,position:Z.position};return y.length>0&&(Z.errors=y),Z};return f})();n.exports=a},{"./signature":5}],5:[function(r,n,i){var o=r("./utils");const a=(()=>{var l={a:"arrays",b:"booleans",f:"functions",n:"numbers",o:"objects",s:"strings"};function d(p){for(var f=1,h=[],x={},m=x;f<p.length;){var b=p.charAt(f);if(b===":")break;var w=function(){h.push(x),m=x,x={}},y=function(M,P,I,O){for(var G=1,B=P;B<M.length;)if(B++,b=M.charAt(B),b===O){if(G--,G===0)break}else b===I&&G++;return B};switch(b){case"s":case"n":case"b":case"l":case"o":x.regex="["+b+"m]",x.type=b,w();break;case"a":x.regex="[asnblfom]",x.type=b,x.array=!0,w();break;case"f":x.regex="f",x.type=b,w();break;case"j":x.regex="[asnblom]",x.type=b,w();break;case"x":x.regex="[asnblfom]",x.type=b,w();break;case"-":m.context=!0,m.contextRegex=new RegExp(m.regex),m.regex+="?";break;case"?":case"+":m.regex+=b;break;case"(":var C=y(p,f,"(",")"),T=p.substring(f+1,C);if(T.indexOf("<")===-1)x.regex="["+T+"m]";else throw{code:"S0402",stack:new Error().stack,value:T,offset:f};x.type="("+T+")",f=C,w();break;case"<":if(m.type==="a"||m.type==="f"){var E=y(p,f,"<",">");m.subtype=p.substring(f+1,E),f=E}else throw{code:"S0401",stack:new Error().stack,value:m.type,offset:f};break}f++}var j="^"+h.map(function(M){return"("+M.regex+")"}).join("")+"$",k=new RegExp(j),A=function(M){var P;if(o.isFunction(M))P="f";else{var I=typeof M;switch(I){case"string":P="s";break;case"number":P="n";break;case"boolean":P="b";break;case"object":M===null?P="l":Array.isArray(M)?P="a":P="o";break;default:P="m"}}return P},R=function(M,P){for(var I="^",O=0,G=0;G<h.length;G++){I+=h[G].regex;var B=P.match(I);if(B===null)throw{code:"T0410",stack:new Error().stack,value:M[O],index:O+1};O=B[0].length}throw{code:"T0410",stack:new Error().stack,value:M[O],index:O+1}};return{definition:p,validate:function(M,P){var I="";M.forEach(function(F){I+=A(F)});var O=k.exec(I);if(O){var G=[],B=0;return h.forEach(function(F,z){var $=M[B],W=O[z+1];if(W==="")if(F.context&&F.contextRegex){var D=A(P);if(F.contextRegex.test(D))G.push(P);else throw{code:"T0411",stack:new Error().stack,value:P,index:B+1}}else G.push($),B++;else W.split("").forEach(function(oe){if(F.type==="a"){if(oe==="m")$=void 0;else{$=M[B];var Z=!0;if(typeof F.subtype<"u"){if(oe!=="a"&&W!==F.subtype)Z=!1;else if(oe==="a"&&$.length>0){var fe=A($[0]);if(fe!==F.subtype.charAt(0))Z=!1;else{var Q=$.filter(function(_){return A(_)!==fe});Z=Q.length===0}}}if(!Z)throw{code:"T0412",stack:new Error().stack,value:$,index:B+1,type:l[F.subtype]};oe!=="a"&&($=[$])}G.push($),B++}else G.push($),B++})}),G}R(M,I)}}}return d})();n.exports=a},{"./utils":6}],6:[function(r,n,i){const o=(()=>{function a(E){var j=!1;if(typeof E=="number"&&(j=!isNaN(E),j&&!isFinite(E)))throw{code:"D1001",value:E,stack:new Error().stack};return j}function l(E){var j=!1;return Array.isArray(E)&&(j=E.filter(function(k){return typeof k!="string"}).length===0),j}function d(E){var j=!1;return Array.isArray(E)&&(j=E.filter(function(k){return!a(k)}).length===0),j}function p(){var E=[];return E.sequence=!0,arguments.length===1&&E.push(arguments[0]),E}function f(E){return E.sequence===!0&&Array.isArray(E)}function h(E){return E&&(E._jsonata_function===!0||E._jsonata_lambda===!0)||typeof E=="function"}function x(E){var j=typeof E.arity=="number"?E.arity:typeof E.implementation=="function"?E.implementation.length:typeof E.length=="number"?E.length:E.arguments.length;return j}function m(E){return E&&E._jsonata_lambda===!0}var b=(typeof Symbol=="function"?Symbol:{}).iterator||"@@iterator";function w(E){return typeof E=="object"&&E!==null&&b in E&&"next"in E&&typeof E.next=="function"}function y(E,j){if(E===j)return!0;if(typeof E=="object"&&typeof j=="object"&&E!==null&&j!==null){if(Array.isArray(E)&&Array.isArray(j)){if(E.length!==j.length)return!1;for(var k=0;k<E.length;k++)if(!y(E[k],j[k]))return!1;return!0}var A=Object.getOwnPropertyNames(E),R=Object.getOwnPropertyNames(j);if(A.length!==R.length)return!1;for(A=A.sort(),R=R.sort(),k=0;k<A.length;k++)if(A[k]!==R[k])return!1;for(k=0;k<A.length;k++){var M=A[k];if(!y(E[M],j[M]))return!1}return!0}return!1}function C(E){return typeof E=="object"&&E!==null&&"then"in E&&typeof E.then=="function"}function T(E){var j=[];for(let k of E)j.push(k);return j}return{isNumeric:a,isArrayOfStrings:l,isArrayOfNumbers:d,createSequence:p,isSequence:f,isFunction:h,isLambda:m,isIterable:w,getFunctionArity:x,isDeepEqual:y,stringToArray:T,isPromise:C}})();n.exports=o},{}]},{},[3])(3)})})(c0)),c0.exports}var Xj=Mq();class Bq extends Kd{constructor(){super(...arguments);Pe(this,"name","JSONata");Pe(this,"description","Powerful JSON transformation and query language")}async execute(r,n){try{return await Xj(n).evaluate(r)}catch(i){throw new Error(`JSONata execution failed: ${i instanceof Error?i.message:String(i)}`)}}validate(r){if(!r||r.trim().length===0)return{valid:!1,error:"Expression cannot be empty"};try{return Xj(r),{valid:!0}}catch(n){return{valid:!1,error:`Invalid JSONata syntax: ${n.message||String(n)}`}}}getExample(){return'data.candles.{ "timestamp": $[0], "open": $[1], "close": $[4] }'}getSyntaxHelp(){return`
JSONata Syntax Examples:

Basic Selection:
  data.candles              - Select field
  data.candles[0]           - First array element
  data.candles[-1]          - Last element

Array Transformation:
  data.candles[].price      - Extract price from all items
  data.candles.{ "open": $[1], "close": $[4] }  - Map array to object

Object Construction:
  {
    "symbol": data.symbol,
    "price": data.last_price,
    "volume": data.volume
  }

Filtering:
  data.quotes[volume > 1000]           - Filter by condition
  data.quotes[symbol = "AAPL"]         - Exact match
  data.quotes[$contains(symbol, "AA")] - String contains

Aggregation:
  $sum(data.candles.volume)            - Sum array
  $average(data.candles.close)         - Average
  $max(data.candles.high)              - Maximum
  $min(data.candles.low)               - Minimum
  $count(data.quotes)                  - Count items

String Functions:
  $uppercase(symbol)                    - UPPERCASE
  $lowercase(symbol)                    - lowercase
  $substring(symbol, 0, 3)             - Extract substring
  $replace(symbol, "NSE:", "")         - Replace text

Date/Time:
  $now()                               - Current timestamp
  $fromMillis(timestamp)               - Convert from unix ms
  $toMillis(datetime)                  - Convert to unix ms

Conditionals:
  volume > 1000 ? "high" : "low"       - Ternary operator
  status = "ok" ? data : null          - Conditional selection

Array of Arrays (Common in Financial APIs):
  data.candles.{
    "timestamp": $[0],
    "open": $[1],
    "high": $[2],
    "low": $[3],
    "close": $[4],
    "volume": $[5]
  }

Nested Object Access:
  data.quotes.*.{
    "symbol": symbol,
    "bid": spread.bid,
    "ask": spread.ask
  }
    `.trim()}buildObjectConstructor(r){return`{
  ${r.map(i=>`"${i.target}": ${i.source}`).join(`,
  `)}
}`}buildArrayMapper(r,n){const i=this.buildObjectConstructor(n);return`${r}.${i}`}buildArrayOfArraysMapper(r,n){const i=n.map(o=>`"${o.target}": $[${o.index}]`).join(`,
  `);return`${r}.{
  ${i}
}`}addFilter(r,n){const i=r.match(/^(.+?)(\.\{.+\})$/s);if(i){const[,o,a]=i;return`${o}[${n}]${a}`}else return`${r}[${n}]`}addSort(r,n,i="asc"){return`${r}^(${i==="asc"?"<":">"}${n})`}}var Tf={},Jj;function Fq(){return Jj||(Jj=1,(function(s){(function(e){function r(q){return q!==null?Object.prototype.toString.call(q)==="[object Array]":!1}function n(q){return q!==null?Object.prototype.toString.call(q)==="[object Object]":!1}function i(q,ee){if(q===ee)return!0;var ce=Object.prototype.toString.call(q);if(ce!==Object.prototype.toString.call(ee))return!1;if(r(q)===!0){if(q.length!==ee.length)return!1;for(var Ce=0;Ce<q.length;Ce++)if(i(q[Ce],ee[Ce])===!1)return!1;return!0}if(n(q)===!0){var be={};for(var We in q)if(hasOwnProperty.call(q,We)){if(i(q[We],ee[We])===!1)return!1;be[We]=!0}for(var J in ee)if(hasOwnProperty.call(ee,J)&&be[J]!==!0)return!1;return!0}return!1}function o(q){if(q===""||q===!1||q===null)return!0;if(r(q)&&q.length===0)return!0;if(n(q)){for(var ee in q)if(q.hasOwnProperty(ee))return!1;return!0}else return!1}function a(q){for(var ee=Object.keys(q),ce=[],Ce=0;Ce<ee.length;Ce++)ce.push(q[ee[Ce]]);return ce}var l;typeof String.prototype.trimLeft=="function"?l=function(q){return q.trimLeft()}:l=function(q){return q.match(/^\s*(.*)/)[1]};var d=0,p=1,f=2,h=3,x=4,m=5,b=6,w=7,y=8,C=9,T={0:"number",1:"any",2:"string",3:"array",4:"object",5:"boolean",6:"expression",7:"null",8:"Array<number>",9:"Array<string>"},E="EOF",j="UnquotedIdentifier",k="QuotedIdentifier",A="Rbracket",R="Rparen",M="Comma",P="Colon",I="Rbrace",O="Number",G="Current",B="Expref",F="Pipe",z="Or",$="And",W="EQ",D="GT",oe="LT",Z="GTE",fe="LTE",Q="NE",_="Flatten",Y="Star",he="Filter",me="Dot",ge="Not",le="Lbrace",X="Lbracket",V="Lparen",de="Literal",je={".":me,"*":Y,",":M,":":P,"{":le,"}":I,"]":A,"(":V,")":R,"@":G},_e={"<":!0,">":!0,"=":!0,"!":!0},Re={" ":!0,"	":!0,"\n":!0};function Be(q){return q>="a"&&q<="z"||q>="A"&&q<="Z"||q==="_"}function Se(q){return q>="0"&&q<="9"||q==="-"}function ie(q){return q>="a"&&q<="z"||q>="A"&&q<="Z"||q>="0"&&q<="9"||q==="_"}function ve(){}ve.prototype={tokenize:function(q){var ee=[];this._current=0;for(var ce,Ce,be;this._current<q.length;)if(Be(q[this._current]))ce=this._current,Ce=this._consumeUnquotedIdentifier(q),ee.push({type:j,value:Ce,start:ce});else if(je[q[this._current]]!==void 0)ee.push({type:je[q[this._current]],value:q[this._current],start:this._current}),this._current++;else if(Se(q[this._current]))be=this._consumeNumber(q),ee.push(be);else if(q[this._current]==="[")be=this._consumeLBracket(q),ee.push(be);else if(q[this._current]==='"')ce=this._current,Ce=this._consumeQuotedIdentifier(q),ee.push({type:k,value:Ce,start:ce});else if(q[this._current]==="'")ce=this._current,Ce=this._consumeRawStringLiteral(q),ee.push({type:de,value:Ce,start:ce});else if(q[this._current]==="`"){ce=this._current;var We=this._consumeLiteral(q);ee.push({type:de,value:We,start:ce})}else if(_e[q[this._current]]!==void 0)ee.push(this._consumeOperator(q));else if(Re[q[this._current]]!==void 0)this._current++;else if(q[this._current]==="&")ce=this._current,this._current++,q[this._current]==="&"?(this._current++,ee.push({type:$,value:"&&",start:ce})):ee.push({type:B,value:"&",start:ce});else if(q[this._current]==="|")ce=this._current,this._current++,q[this._current]==="|"?(this._current++,ee.push({type:z,value:"||",start:ce})):ee.push({type:F,value:"|",start:ce});else{var J=new Error("Unknown character:"+q[this._current]);throw J.name="LexerError",J}return ee},_consumeUnquotedIdentifier:function(q){var ee=this._current;for(this._current++;this._current<q.length&&ie(q[this._current]);)this._current++;return q.slice(ee,this._current)},_consumeQuotedIdentifier:function(q){var ee=this._current;this._current++;for(var ce=q.length;q[this._current]!=='"'&&this._current<ce;){var Ce=this._current;q[Ce]==="\\"&&(q[Ce+1]==="\\"||q[Ce+1]==='"')?Ce+=2:Ce++,this._current=Ce}return this._current++,JSON.parse(q.slice(ee,this._current))},_consumeRawStringLiteral:function(q){var ee=this._current;this._current++;for(var ce=q.length;q[this._current]!=="'"&&this._current<ce;){var Ce=this._current;q[Ce]==="\\"&&(q[Ce+1]==="\\"||q[Ce+1]==="'")?Ce+=2:Ce++,this._current=Ce}this._current++;var be=q.slice(ee+1,this._current-1);return be.replace("\\'","'")},_consumeNumber:function(q){var ee=this._current;this._current++;for(var ce=q.length;Se(q[this._current])&&this._current<ce;)this._current++;var Ce=parseInt(q.slice(ee,this._current));return{type:O,value:Ce,start:ee}},_consumeLBracket:function(q){var ee=this._current;return this._current++,q[this._current]==="?"?(this._current++,{type:he,value:"[?",start:ee}):q[this._current]==="]"?(this._current++,{type:_,value:"[]",start:ee}):{type:X,value:"[",start:ee}},_consumeOperator:function(q){var ee=this._current,ce=q[ee];if(this._current++,ce==="!")return q[this._current]==="="?(this._current++,{type:Q,value:"!=",start:ee}):{type:ge,value:"!",start:ee};if(ce==="<")return q[this._current]==="="?(this._current++,{type:fe,value:"<=",start:ee}):{type:oe,value:"<",start:ee};if(ce===">")return q[this._current]==="="?(this._current++,{type:Z,value:">=",start:ee}):{type:D,value:">",start:ee};if(ce==="="&&q[this._current]==="=")return this._current++,{type:W,value:"==",start:ee}},_consumeLiteral:function(q){this._current++;for(var ee=this._current,ce=q.length,Ce;q[this._current]!=="`"&&this._current<ce;){var be=this._current;q[be]==="\\"&&(q[be+1]==="\\"||q[be+1]==="`")?be+=2:be++,this._current=be}var We=l(q.slice(ee,this._current));return We=We.replace("\\`","`"),this._looksLikeJSON(We)?Ce=JSON.parse(We):Ce=JSON.parse('"'+We+'"'),this._current++,Ce},_looksLikeJSON:function(q){var ee='[{"',ce=["true","false","null"],Ce="-0123456789";if(q==="")return!1;if(ee.indexOf(q[0])>=0)return!0;if(ce.indexOf(q)>=0)return!0;if(Ce.indexOf(q[0])>=0)try{return JSON.parse(q),!0}catch{return!1}else return!1}};var Ae={};Ae[E]=0,Ae[j]=0,Ae[k]=0,Ae[A]=0,Ae[R]=0,Ae[M]=0,Ae[I]=0,Ae[O]=0,Ae[G]=0,Ae[B]=0,Ae[F]=1,Ae[z]=2,Ae[$]=3,Ae[W]=5,Ae[D]=5,Ae[oe]=5,Ae[Z]=5,Ae[fe]=5,Ae[Q]=5,Ae[_]=9,Ae[Y]=20,Ae[he]=21,Ae[me]=40,Ae[ge]=45,Ae[le]=50,Ae[X]=55,Ae[V]=60;function $e(){}$e.prototype={parse:function(q){this._loadTokens(q),this.index=0;var ee=this.expression(0);if(this._lookahead(0)!==E){var ce=this._lookaheadToken(0),Ce=new Error("Unexpected token type: "+ce.type+", value: "+ce.value);throw Ce.name="ParserError",Ce}return ee},_loadTokens:function(q){var ee=new ve,ce=ee.tokenize(q);ce.push({type:E,value:"",start:q.length}),this.tokens=ce},expression:function(q){var ee=this._lookaheadToken(0);this._advance();for(var ce=this.nud(ee),Ce=this._lookahead(0);q<Ae[Ce];)this._advance(),ce=this.led(Ce,ce),Ce=this._lookahead(0);return ce},_lookahead:function(q){return this.tokens[this.index+q].type},_lookaheadToken:function(q){return this.tokens[this.index+q]},_advance:function(){this.index++},nud:function(q){var ee,ce,Ce;switch(q.type){case de:return{type:"Literal",value:q.value};case j:return{type:"Field",name:q.value};case k:var be={type:"Field",name:q.value};if(this._lookahead(0)===V)throw new Error("Quoted identifier not allowed for function names.");return be;case ge:return ce=this.expression(Ae.Not),{type:"NotExpression",children:[ce]};case Y:return ee={type:"Identity"},ce=null,this._lookahead(0)===A?ce={type:"Identity"}:ce=this._parseProjectionRHS(Ae.Star),{type:"ValueProjection",children:[ee,ce]};case he:return this.led(q.type,{type:"Identity"});case le:return this._parseMultiselectHash();case _:return ee={type:_,children:[{type:"Identity"}]},ce=this._parseProjectionRHS(Ae.Flatten),{type:"Projection",children:[ee,ce]};case X:return this._lookahead(0)===O||this._lookahead(0)===P?(ce=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},ce)):this._lookahead(0)===Y&&this._lookahead(1)===A?(this._advance(),this._advance(),ce=this._parseProjectionRHS(Ae.Star),{type:"Projection",children:[{type:"Identity"},ce]}):this._parseMultiselectList();case G:return{type:G};case B:return Ce=this.expression(Ae.Expref),{type:"ExpressionReference",children:[Ce]};case V:for(var We=[];this._lookahead(0)!==R;)this._lookahead(0)===G?(Ce={type:G},this._advance()):Ce=this.expression(0),We.push(Ce);return this._match(R),We[0];default:this._errorToken(q)}},led:function(q,ee){var ce;switch(q){case me:var Ce=Ae.Dot;return this._lookahead(0)!==Y?(ce=this._parseDotRHS(Ce),{type:"Subexpression",children:[ee,ce]}):(this._advance(),ce=this._parseProjectionRHS(Ce),{type:"ValueProjection",children:[ee,ce]});case F:return ce=this.expression(Ae.Pipe),{type:F,children:[ee,ce]};case z:return ce=this.expression(Ae.Or),{type:"OrExpression",children:[ee,ce]};case $:return ce=this.expression(Ae.And),{type:"AndExpression",children:[ee,ce]};case V:for(var be=ee.name,We=[],J,se;this._lookahead(0)!==R;)this._lookahead(0)===G?(J={type:G},this._advance()):J=this.expression(0),this._lookahead(0)===M&&this._match(M),We.push(J);return this._match(R),se={type:"Function",name:be,children:We},se;case he:var Te=this.expression(0);return this._match(A),this._lookahead(0)===_?ce={type:"Identity"}:ce=this._parseProjectionRHS(Ae.Filter),{type:"FilterProjection",children:[ee,ce,Te]};case _:var Me={type:_,children:[ee]},Qe=this._parseProjectionRHS(Ae.Flatten);return{type:"Projection",children:[Me,Qe]};case W:case Q:case D:case Z:case oe:case fe:return this._parseComparator(ee,q);case X:var ye=this._lookaheadToken(0);return ye.type===O||ye.type===P?(ce=this._parseIndexExpression(),this._projectIfSlice(ee,ce)):(this._match(Y),this._match(A),ce=this._parseProjectionRHS(Ae.Star),{type:"Projection",children:[ee,ce]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(q){if(this._lookahead(0)===q)this._advance();else{var ee=this._lookaheadToken(0),ce=new Error("Expected "+q+", got: "+ee.type);throw ce.name="ParserError",ce}},_errorToken:function(q){var ee=new Error("Invalid token ("+q.type+'): "'+q.value+'"');throw ee.name="ParserError",ee},_parseIndexExpression:function(){if(this._lookahead(0)===P||this._lookahead(1)===P)return this._parseSliceExpression();var q={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match(A),q},_projectIfSlice:function(q,ee){var ce={type:"IndexExpression",children:[q,ee]};return ee.type==="Slice"?{type:"Projection",children:[ce,this._parseProjectionRHS(Ae.Star)]}:ce},_parseSliceExpression:function(){for(var q=[null,null,null],ee=0,ce=this._lookahead(0);ce!==A&&ee<3;){if(ce===P)ee++,this._advance();else if(ce===O)q[ee]=this._lookaheadToken(0).value,this._advance();else{var Ce=this._lookahead(0),be=new Error("Syntax error, unexpected token: "+Ce.value+"("+Ce.type+")");throw be.name="Parsererror",be}ce=this._lookahead(0)}return this._match(A),{type:"Slice",children:q}},_parseComparator:function(q,ee){var ce=this.expression(Ae[ee]);return{type:"Comparator",name:ee,children:[q,ce]}},_parseDotRHS:function(q){var ee=this._lookahead(0),ce=[j,k,Y];if(ce.indexOf(ee)>=0)return this.expression(q);if(ee===X)return this._match(X),this._parseMultiselectList();if(ee===le)return this._match(le),this._parseMultiselectHash()},_parseProjectionRHS:function(q){var ee;if(Ae[this._lookahead(0)]<10)ee={type:"Identity"};else if(this._lookahead(0)===X)ee=this.expression(q);else if(this._lookahead(0)===he)ee=this.expression(q);else if(this._lookahead(0)===me)this._match(me),ee=this._parseDotRHS(q);else{var ce=this._lookaheadToken(0),Ce=new Error("Sytanx error, unexpected token: "+ce.value+"("+ce.type+")");throw Ce.name="ParserError",Ce}return ee},_parseMultiselectList:function(){for(var q=[];this._lookahead(0)!==A;){var ee=this.expression(0);if(q.push(ee),this._lookahead(0)===M&&(this._match(M),this._lookahead(0)===A))throw new Error("Unexpected token Rbracket")}return this._match(A),{type:"MultiSelectList",children:q}},_parseMultiselectHash:function(){for(var q=[],ee=[j,k],ce,Ce,be,We;;){if(ce=this._lookaheadToken(0),ee.indexOf(ce.type)<0)throw new Error("Expecting an identifier token, got: "+ce.type);if(Ce=ce.value,this._advance(),this._match(P),be=this.expression(0),We={type:"KeyValuePair",name:Ce,value:be},q.push(We),this._lookahead(0)===M)this._match(M);else if(this._lookahead(0)===I){this._match(I);break}}return{type:"MultiSelectHash",children:q}}};function qe(q){this.runtime=q}qe.prototype={search:function(q,ee){return this.visit(q,ee)},visit:function(q,ee){var ce,Ce,be,We,J,se,Te,Me,Qe,ye;switch(q.type){case"Field":return ee!==null&&n(ee)?(se=ee[q.name],se===void 0?null:se):null;case"Subexpression":for(be=this.visit(q.children[0],ee),ye=1;ye<q.children.length;ye++)if(be=this.visit(q.children[1],be),be===null)return null;return be;case"IndexExpression":return Te=this.visit(q.children[0],ee),Me=this.visit(q.children[1],Te),Me;case"Index":if(!r(ee))return null;var ue=q.value;return ue<0&&(ue=ee.length+ue),be=ee[ue],be===void 0&&(be=null),be;case"Slice":if(!r(ee))return null;var re=q.children.slice(0),ke=this.computeSliceParams(ee.length,re),Ne=ke[0],U=ke[1],ne=ke[2];if(be=[],ne>0)for(ye=Ne;ye<U;ye+=ne)be.push(ee[ye]);else for(ye=Ne;ye>U;ye+=ne)be.push(ee[ye]);return be;case"Projection":var xe=this.visit(q.children[0],ee);if(!r(xe))return null;for(Qe=[],ye=0;ye<xe.length;ye++)Ce=this.visit(q.children[1],xe[ye]),Ce!==null&&Qe.push(Ce);return Qe;case"ValueProjection":if(xe=this.visit(q.children[0],ee),!n(xe))return null;Qe=[];var Le=a(xe);for(ye=0;ye<Le.length;ye++)Ce=this.visit(q.children[1],Le[ye]),Ce!==null&&Qe.push(Ce);return Qe;case"FilterProjection":if(xe=this.visit(q.children[0],ee),!r(xe))return null;var ze=[],Ge=[];for(ye=0;ye<xe.length;ye++)ce=this.visit(q.children[2],xe[ye]),o(ce)||ze.push(xe[ye]);for(var Ze=0;Ze<ze.length;Ze++)Ce=this.visit(q.children[1],ze[Ze]),Ce!==null&&Ge.push(Ce);return Ge;case"Comparator":switch(We=this.visit(q.children[0],ee),J=this.visit(q.children[1],ee),q.name){case W:be=i(We,J);break;case Q:be=!i(We,J);break;case D:be=We>J;break;case Z:be=We>=J;break;case oe:be=We<J;break;case fe:be=We<=J;break;default:throw new Error("Unknown comparator: "+q.name)}return be;case _:var xt=this.visit(q.children[0],ee);if(!r(xt))return null;var bt=[];for(ye=0;ye<xt.length;ye++)Ce=xt[ye],r(Ce)?bt.push.apply(bt,Ce):bt.push(Ce);return bt;case"Identity":return ee;case"MultiSelectList":if(ee===null)return null;for(Qe=[],ye=0;ye<q.children.length;ye++)Qe.push(this.visit(q.children[ye],ee));return Qe;case"MultiSelectHash":if(ee===null)return null;Qe={};var Lt;for(ye=0;ye<q.children.length;ye++)Lt=q.children[ye],Qe[Lt.name]=this.visit(Lt.value,ee);return Qe;case"OrExpression":return ce=this.visit(q.children[0],ee),o(ce)&&(ce=this.visit(q.children[1],ee)),ce;case"AndExpression":return We=this.visit(q.children[0],ee),o(We)===!0?We:this.visit(q.children[1],ee);case"NotExpression":return We=this.visit(q.children[0],ee),o(We);case"Literal":return q.value;case F:return Te=this.visit(q.children[0],ee),this.visit(q.children[1],Te);case G:return ee;case"Function":var yt=[];for(ye=0;ye<q.children.length;ye++)yt.push(this.visit(q.children[ye],ee));return this.runtime.callFunction(q.name,yt);case"ExpressionReference":var Pt=q.children[0];return Pt.jmespathType=B,Pt;default:throw new Error("Unknown node type: "+q.type)}},computeSliceParams:function(q,ee){var ce=ee[0],Ce=ee[1],be=ee[2],We=[null,null,null];if(be===null)be=1;else if(be===0){var J=new Error("Invalid slice, step cannot be 0");throw J.name="RuntimeError",J}var se=be<0;return ce===null?ce=se?q-1:0:ce=this.capSliceRange(q,ce,be),Ce===null?Ce=se?-1:q:Ce=this.capSliceRange(q,Ce,be),We[0]=ce,We[1]=Ce,We[2]=be,We},capSliceRange:function(q,ee,ce){return ee<0?(ee+=q,ee<0&&(ee=ce<0?-1:0)):ee>=q&&(ee=ce<0?q-1:q),ee}};function Ie(q){this._interpreter=q,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[d]}]},avg:{_func:this._functionAvg,_signature:[{types:[y]}]},ceil:{_func:this._functionCeil,_signature:[{types:[d]}]},contains:{_func:this._functionContains,_signature:[{types:[f,h]},{types:[p]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[f]},{types:[f]}]},floor:{_func:this._functionFloor,_signature:[{types:[d]}]},length:{_func:this._functionLength,_signature:[{types:[f,h,x]}]},map:{_func:this._functionMap,_signature:[{types:[b]},{types:[h]}]},max:{_func:this._functionMax,_signature:[{types:[y,C]}]},merge:{_func:this._functionMerge,_signature:[{types:[x],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[h]},{types:[b]}]},sum:{_func:this._functionSum,_signature:[{types:[y]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[f]},{types:[f]}]},min:{_func:this._functionMin,_signature:[{types:[y,C]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[h]},{types:[b]}]},type:{_func:this._functionType,_signature:[{types:[p]}]},keys:{_func:this._functionKeys,_signature:[{types:[x]}]},values:{_func:this._functionValues,_signature:[{types:[x]}]},sort:{_func:this._functionSort,_signature:[{types:[C,y]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[h]},{types:[b]}]},join:{_func:this._functionJoin,_signature:[{types:[f]},{types:[C]}]},reverse:{_func:this._functionReverse,_signature:[{types:[f,h]}]},to_array:{_func:this._functionToArray,_signature:[{types:[p]}]},to_string:{_func:this._functionToString,_signature:[{types:[p]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[p]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[p],variadic:!0}]}}}Ie.prototype={callFunction:function(q,ee){var ce=this.functionTable[q];if(ce===void 0)throw new Error("Unknown function: "+q+"()");return this._validateArgs(q,ee,ce._signature),ce._func.call(this,ee)},_validateArgs:function(q,ee,ce){var Ce;if(ce[ce.length-1].variadic){if(ee.length<ce.length)throw Ce=ce.length===1?" argument":" arguments",new Error("ArgumentError: "+q+"() takes at least"+ce.length+Ce+" but received "+ee.length)}else if(ee.length!==ce.length)throw Ce=ce.length===1?" argument":" arguments",new Error("ArgumentError: "+q+"() takes "+ce.length+Ce+" but received "+ee.length);for(var be,We,J,se=0;se<ce.length;se++){J=!1,be=ce[se].types,We=this._getTypeName(ee[se]);for(var Te=0;Te<be.length;Te++)if(this._typeMatches(We,be[Te],ee[se])){J=!0;break}if(!J){var Me=be.map(function(Qe){return T[Qe]}).join(",");throw new Error("TypeError: "+q+"() expected argument "+(se+1)+" to be type "+Me+" but received type "+T[We]+" instead.")}}},_typeMatches:function(q,ee,ce){if(ee===p)return!0;if(ee===C||ee===y||ee===h){if(ee===h)return q===h;if(q===h){var Ce;ee===y?Ce=d:ee===C&&(Ce=f);for(var be=0;be<ce.length;be++)if(!this._typeMatches(this._getTypeName(ce[be]),Ce,ce[be]))return!1;return!0}}else return q===ee},_getTypeName:function(q){switch(Object.prototype.toString.call(q)){case"[object String]":return f;case"[object Number]":return d;case"[object Array]":return h;case"[object Boolean]":return m;case"[object Null]":return w;case"[object Object]":return q.jmespathType===B?b:x}},_functionStartsWith:function(q){return q[0].lastIndexOf(q[1])===0},_functionEndsWith:function(q){var ee=q[0],ce=q[1];return ee.indexOf(ce,ee.length-ce.length)!==-1},_functionReverse:function(q){var ee=this._getTypeName(q[0]);if(ee===f){for(var ce=q[0],Ce="",be=ce.length-1;be>=0;be--)Ce+=ce[be];return Ce}else{var We=q[0].slice(0);return We.reverse(),We}},_functionAbs:function(q){return Math.abs(q[0])},_functionCeil:function(q){return Math.ceil(q[0])},_functionAvg:function(q){for(var ee=0,ce=q[0],Ce=0;Ce<ce.length;Ce++)ee+=ce[Ce];return ee/ce.length},_functionContains:function(q){return q[0].indexOf(q[1])>=0},_functionFloor:function(q){return Math.floor(q[0])},_functionLength:function(q){return n(q[0])?Object.keys(q[0]).length:q[0].length},_functionMap:function(q){for(var ee=[],ce=this._interpreter,Ce=q[0],be=q[1],We=0;We<be.length;We++)ee.push(ce.visit(Ce,be[We]));return ee},_functionMerge:function(q){for(var ee={},ce=0;ce<q.length;ce++){var Ce=q[ce];for(var be in Ce)ee[be]=Ce[be]}return ee},_functionMax:function(q){if(q[0].length>0){var ee=this._getTypeName(q[0][0]);if(ee===d)return Math.max.apply(Math,q[0]);for(var ce=q[0],Ce=ce[0],be=1;be<ce.length;be++)Ce.localeCompare(ce[be])<0&&(Ce=ce[be]);return Ce}else return null},_functionMin:function(q){if(q[0].length>0){var ee=this._getTypeName(q[0][0]);if(ee===d)return Math.min.apply(Math,q[0]);for(var ce=q[0],Ce=ce[0],be=1;be<ce.length;be++)ce[be].localeCompare(Ce)<0&&(Ce=ce[be]);return Ce}else return null},_functionSum:function(q){for(var ee=0,ce=q[0],Ce=0;Ce<ce.length;Ce++)ee+=ce[Ce];return ee},_functionType:function(q){switch(this._getTypeName(q[0])){case d:return"number";case f:return"string";case h:return"array";case x:return"object";case m:return"boolean";case b:return"expref";case w:return"null"}},_functionKeys:function(q){return Object.keys(q[0])},_functionValues:function(q){for(var ee=q[0],ce=Object.keys(ee),Ce=[],be=0;be<ce.length;be++)Ce.push(ee[ce[be]]);return Ce},_functionJoin:function(q){var ee=q[0],ce=q[1];return ce.join(ee)},_functionToArray:function(q){return this._getTypeName(q[0])===h?q[0]:[q[0]]},_functionToString:function(q){return this._getTypeName(q[0])===f?q[0]:JSON.stringify(q[0])},_functionToNumber:function(q){var ee=this._getTypeName(q[0]),ce;return ee===d?q[0]:ee===f&&(ce=+q[0],!isNaN(ce))?ce:null},_functionNotNull:function(q){for(var ee=0;ee<q.length;ee++)if(this._getTypeName(q[ee])!==w)return q[ee];return null},_functionSort:function(q){var ee=q[0].slice(0);return ee.sort(),ee},_functionSortBy:function(q){var ee=q[0].slice(0);if(ee.length===0)return ee;var ce=this._interpreter,Ce=q[1],be=this._getTypeName(ce.visit(Ce,ee[0]));if([d,f].indexOf(be)<0)throw new Error("TypeError");for(var We=this,J=[],se=0;se<ee.length;se++)J.push([se,ee[se]]);J.sort(function(Me,Qe){var ye=ce.visit(Ce,Me[1]),ue=ce.visit(Ce,Qe[1]);if(We._getTypeName(ye)!==be)throw new Error("TypeError: expected "+be+", received "+We._getTypeName(ye));if(We._getTypeName(ue)!==be)throw new Error("TypeError: expected "+be+", received "+We._getTypeName(ue));return ye>ue?1:ye<ue?-1:Me[0]-Qe[0]});for(var Te=0;Te<J.length;Te++)ee[Te]=J[Te][1];return ee},_functionMaxBy:function(q){for(var ee=q[1],ce=q[0],Ce=this.createKeyFunction(ee,[d,f]),be=-1/0,We,J,se=0;se<ce.length;se++)J=Ce(ce[se]),J>be&&(be=J,We=ce[se]);return We},_functionMinBy:function(q){for(var ee=q[1],ce=q[0],Ce=this.createKeyFunction(ee,[d,f]),be=1/0,We,J,se=0;se<ce.length;se++)J=Ce(ce[se]),J<be&&(be=J,We=ce[se]);return We},createKeyFunction:function(q,ee){var ce=this,Ce=this._interpreter,be=function(We){var J=Ce.visit(q,We);if(ee.indexOf(ce._getTypeName(J))<0){var se="TypeError: expected one of "+ee+", received "+ce._getTypeName(J);throw new Error(se)}return J};return be}};function K(q){var ee=new $e,ce=ee.parse(q);return ce}function Ee(q){var ee=new ve;return ee.tokenize(q)}function Oe(q,ee){var ce=new $e,Ce=new Ie,be=new qe(Ce);Ce._interpreter=be;var We=ce.parse(ee);return be.search(We,q)}e.tokenize=Ee,e.compile=K,e.search=Oe,e.strictDeepEqual=i})(typeof window<"u"?Tf.jmespath={}:s)})(Tf)),Tf}var jg=Fq();const $q=aP({__proto__:null,default:jg},[jg]);class Gq extends Kd{constructor(){super(...arguments);Pe(this,"name","JMESPath");Pe(this,"description","AWS-style JSON query language")}async execute(r,n){try{return jg.search(r,n)}catch(i){throw new Error(`JMESPath execution failed: ${i instanceof Error?i.message:String(i)}`)}}validate(r){if(!r||r.trim().length===0)return{valid:!1,error:"Expression cannot be empty"};try{return jg.search({},r),{valid:!0}}catch(n){return{valid:!1,error:`Invalid JMESPath syntax: ${n.message||String(n)}`}}}getExample(){return"data.candles[*].[timestamp, open, high, low, close, volume]"}getSyntaxHelp(){return`
JMESPath Syntax Examples:

Basic Selection:
  data.candles                    - Select field
  data.candles[0]                 - First element
  data.candles[-1]                - Last element
  data.candles[*]                 - All elements

Projection:
  data.candles[*].price           - Extract price from all
  data.candles[*].open            - Extract open from all

Multi-Select List (Array output):
  data.candles[*].[open, close]   - Arrays of [open, close]
  data[*].[timestamp, price]      - Multiple fields as arrays

Multi-Select Hash (Object output):
  data.candles[*].{
    open: open,
    close: close,
    volume: volume
  }

Filtering:
  data.quotes[?volume > \`1000\`]            - Filter by condition
  data.quotes[?price > \`100\` && volume > \`1000\`]  - Multiple conditions
  data.quotes[?contains(symbol, 'AA')]      - String contains

Pipe (Chaining):
  data.candles[*].open | [0]      - First open price
  data.quotes | sort_by(@, &volume) | reverse(@)  - Sort desc by volume

Functions:
  length(data.candles)            - Array length
  max(data.candles[*].high)       - Maximum value
  min(data.candles[*].low)        - Minimum value
  avg(data.candles[*].close)      - Average
  sum(data.candles[*].volume)     - Sum

Flattening:
  data[*].values[]                - Flatten nested arrays
  data.*.quotes[].price           - Multi-level flattening

Slicing:
  data.candles[0:5]               - First 5 elements
  data.candles[-5:]               - Last 5 elements
  data.candles[::2]               - Every 2nd element

Sorting:
  sort_by(data.quotes, &price)    - Sort ascending
  reverse(sort_by(data.quotes, &price))  - Sort descending
    `.trim()}buildObjectProjection(r,n){const i=n.map(o=>`${o.target}: ${o.source}`).join(", ");return`${r}.{${i}}`}buildArrayProjection(r,n){return`${r}.[${n.join(", ")}]`}addFilter(r,n){return`${r}[?${n}]`}addSort(r,n,i="asc"){const o=`sort_by(${r}, &${n})`;return i==="desc"?`reverse(${o})`:o}}class Uq extends Kd{constructor(){super(...arguments);Pe(this,"name","Direct");Pe(this,"description","Simple object property access (data.field.nested)")}async execute(r,n){try{return this.extractNestedValue(r,n)}catch(i){throw new Error(`Direct access failed: ${i instanceof Error?i.message:String(i)}`)}}validate(r){if(!r||r.trim().length===0)return{valid:!1,error:"Expression cannot be empty"};if(!/^[a-zA-Z0-9_.\[\]]+$/.test(r))return{valid:!1,error:"Expression can only contain alphanumeric characters, dots, and brackets"};const n=(r.match(/\[/g)||[]).length,i=(r.match(/\]/g)||[]).length;return n!==i?{valid:!1,error:"Unbalanced brackets"}:{valid:!0}}getExample(){return"data.candles[0].open"}getSyntaxHelp(){return`
Direct Access Syntax:

Simple field access:
  data                        - Access 'data' property
  data.candles               - Access nested property
  data.candles.0             - Access array element by index
  data.candles[0]            - Alternative array access

Nested access:
  data.quotes.AAPL.price     - Deep nested access
  response.data[0].value     - Mixed object/array access

Note: This parser is for simple cases. For complex queries
or transformations, use JSONPath, JSONata, or JMESPath.
    `.trim()}extractNestedValue(r,n){if(!n)return r;const o=n.replace(/\[(\d+)\]/g,".$1").split(".");let a=r;for(const l of o){if(a==null)return;a=a[l]}return a}pathExists(r,n){try{return this.extractNestedValue(r,n)!==void 0}catch{return!1}}getValueType(r,n){try{const i=this.extractNestedValue(r,n);return i===null?"null":i===void 0?"undefined":Array.isArray(i)?"array":typeof i}catch{return"undefined"}}}class Wq extends Kd{constructor(){super(...arguments);Pe(this,"name","JavaScript");Pe(this,"description","Custom JavaScript expressions (sandboxed)")}async execute(r,n){try{const i=this.createSandbox(r),o=Object.getPrototypeOf(async function(){}).constructor;let a=n.trim();return a.includes("return")||(a=`return ${a}`),await new o("data","helpers",a)(r,i.helpers)}catch(i){throw new Error(`JavaScript execution failed: ${i instanceof Error?i.message:String(i)}`)}}validate(r){if(!r||r.trim().length===0)return{valid:!1,error:"Expression cannot be empty"};const n=["eval","Function","setTimeout","setInterval","XMLHttpRequest","fetch","import"];for(const i of n)if(r.includes(i))return{valid:!1,error:`Unsafe operation: ${i} is not allowed for security reasons`};try{const i=Object.getPrototypeOf(async function(){}).constructor;let o=r.trim();return o.includes("return")||(o=`return ${o}`),new i("data","helpers",o),{valid:!0}}catch(i){return{valid:!1,error:`Syntax error: ${i.message||String(i)}`}}}getExample(){return`data.candles.map(c => ({
  timestamp: helpers.parseDate(c[0]),
  open: c[1],
  high: c[2],
  low: c[3],
  close: c[4],
  volume: c[5]
}))`}getSyntaxHelp(){return`
JavaScript Expression Syntax:

Available Variables:
  data       - The input data
  helpers    - Utility functions (see below)

Simple Expressions:
  data.price * 1.1                    - Calculate 10% markup
  data.quotes.filter(q => q.volume > 1000)  - Filter array
  data.candles.map(c => c.close)      - Extract field

Array of Arrays Transformation:
  data.candles.map(c => ({
    timestamp: c[0],
    open: c[1],
    high: c[2],
    low: c[3],
    close: c[4],
    volume: c[5]
  }))

Complex Object Restructuring:
  Object.entries(data.quotes).map(([symbol, quote]) => ({
    symbol: symbol.replace('NSE:', ''),
    price: quote.last_price,
    change: quote.change_percent
  }))

Conditional Logic:
  data.status === 'ok' ? data.quotes : []
  data.candles.filter(c => c.volume > helpers.avg(data.candles.map(x => x.volume)))

Available Helper Functions:

Date/Time:
  helpers.parseDate(str)              - Parse date string
  helpers.toISODate(timestamp)        - Convert to ISO format
  helpers.fromUnixTimestamp(ts)       - Unix timestamp to Date
  helpers.toUnixTimestamp(date)       - Date to Unix timestamp

Array Operations:
  helpers.flatten(array)              - Flatten nested arrays
  helpers.groupBy(array, key)         - Group by field
  helpers.sum(array)                  - Sum numbers
  helpers.avg(array)                  - Average
  helpers.min(array)                  - Minimum
  helpers.max(array)                  - Maximum
  helpers.unique(array)               - Remove duplicates

String Operations:
  helpers.uppercase(str)              - UPPERCASE
  helpers.lowercase(str)              - lowercase
  helpers.trim(str)                   - Remove whitespace
  helpers.replace(str, find, replace) - Replace text

Number Operations:
  helpers.round(num, decimals)        - Round number
  helpers.toFixed(num, decimals)      - Fixed decimals
  helpers.toPercent(num)              - Convert to percentage (0.15 -> 15)
  helpers.fromPercent(num)            - Convert from percentage (15 -> 0.15)

Security Note:
  For security, the following are disabled:
  - eval, Function constructor
  - setTimeout, setInterval
  - fetch, XMLHttpRequest
  - import, require
    `.trim()}createSandbox(r){return{data:r,helpers:{parseDate:n=>new Date(n),toISODate:n=>new Date(n).toISOString(),fromUnixTimestamp:n=>new Date(n*1e3).toISOString(),toUnixTimestamp:n=>Math.floor(new Date(n).getTime()/1e3),flatten:n=>n.flat(1/0),groupBy:(n,i)=>n.reduce((o,a)=>{const l=a[i];return(o[l]=o[l]||[]).push(a),o},{}),sum:n=>n.reduce((i,o)=>i+o,0),avg:n=>n.reduce((i,o)=>i+o,0)/n.length,min:n=>Math.min(...n),max:n=>Math.max(...n),unique:n=>[...new Set(n)],uppercase:n=>n.toUpperCase(),lowercase:n=>n.toLowerCase(),trim:n=>n.trim(),replace:(n,i,o)=>n.replace(new RegExp(i,"g"),o),round:(n,i=2)=>Math.round(n*Math.pow(10,i))/Math.pow(10,i),toFixed:(n,i=2)=>Number(n.toFixed(i)),toPercent:n=>n*100,fromPercent:n=>n/100,bpsToPercent:n=>n/100,percentToBps:n=>n*100}}}isSafe(r){return!["eval","Function","setTimeout","setInterval","XMLHttpRequest","fetch","import","require","__proto__","constructor","prototype"].some(i=>r.includes(i))}}class qq extends Kd{constructor(){super(...arguments);Pe(this,"name","Regex");Pe(this,"description","Pattern-based text extraction using regular expressions")}async execute(r,n){try{const i=this.parseExpression(n),o=this.toSearchableString(r),a=new RegExp(i.pattern,i.flags);if(i.flags.includes("g")){const l=[...o.matchAll(a)];return l.length===0?null:i.groupIndex!==void 0?l.map(d=>d[i.groupIndex]??null).filter(d=>d!==null):l[0].length>1?l.map(d=>d.slice(1)):l.map(d=>d[0])}else{const l=o.match(a);return l?i.groupIndex!==void 0?l[i.groupIndex]??null:l.length>1?l.slice(1):l[0]:null}}catch(i){throw new Error(`Regex execution failed: ${i instanceof Error?i.message:String(i)}`)}}validate(r){if(!r||r.trim().length===0)return{valid:!1,error:"Expression cannot be empty"};try{const n=this.parseExpression(r);return new RegExp(n.pattern,n.flags),n.groupIndex!==void 0&&n.groupIndex<0?{valid:!1,error:"Group index must be non-negative"}:{valid:!0}}catch(n){return{valid:!1,error:`Invalid regex: ${n.message||String(n)}`}}}getExample(){return"/price:\\s*(\\d+\\.?\\d*)/i:1"}getSyntaxHelp(){return`
Regex Parser Syntax:

Expression Format:
  /pattern/flags[:groupIndex]

Basic Examples:
  /\\d+/g                    - Find all numbers (global)
  /\\d+/                     - Find first number
  /[A-Z]+/gi                 - Find uppercase (case insensitive, global)

Capture Groups:
  /price: (\\d+)/i:1         - Extract first capture group
  /price: (\\d+)/            - Returns array of capture groups
  /(\\w+)@(\\w+)/            - Multiple groups [username, domain]

Named Groups (ES2018+):
  /(?<amount>\\d+)/          - Named capture group
  
Common Patterns:
  /\\$[\\d,]+\\.?\\d*/g       - Currency values
  /\\d{4}-\\d{2}-\\d{2}/     - ISO dates (YYYY-MM-DD)
  /[A-Z]{2,5}/g              - Stock ticker symbols
  /"(\\w+)":\\s*([^,}]+)/g   - JSON key-value extraction

Flags:
  g - Global (find all matches)
  i - Case insensitive
  m - Multiline (^ and $ match line boundaries)
  s - Dot matches newlines
  u - Unicode support

Group Index:
  Append :N to extract Nth captured group (0 = full match)
  /pattern/:0   - Full match
  /pattern/:1   - First capture group
  /pattern/:2   - Second capture group

Note: When input is not a string, it will be JSON.stringify'd
before matching. This allows regex to work on object data.
    `.trim()}parseExpression(r){const n=r.trim(),i=n.match(/^\/(.+)\/([gimsuvy]*)(?::(\d+))?$/);if(!i)return{pattern:n,flags:""};const[,o,a,l]=i;return{pattern:o,flags:a||"",groupIndex:l!==void 0?parseInt(l,10):void 0}}toSearchableString(r){return typeof r=="string"?r:r==null?"":JSON.stringify(r)}matches(r,n){try{const i=this.parseExpression(n),o=this.toSearchableString(r);return new RegExp(i.pattern,i.flags.replace("g","")).test(o)}catch{return!1}}replace(r,n,i){try{const o=this.parseExpression(n),a=this.toSearchableString(r),l=new RegExp(o.pattern,o.flags);return a.replace(l,i)}catch{return this.toSearchableString(r)}}split(r,n){try{const i=this.parseExpression(n),o=this.toSearchableString(r),a=new RegExp(i.pattern,i.flags);return o.split(a)}catch{return[this.toSearchableString(r)]}}}const Hq={[At.JSONPATH]:new zq,[At.JSONATA]:new Bq,[At.JMESPATH]:new Gq,[At.DIRECT]:new Uq,[At.CUSTOM_JS]:new Wq,[At.REGEX]:new qq};function sd(s){const e=Hq[s];if(!e)throw new Error(`Parser not found for engine: ${s}`);return e}const Yq={name:"toNumber",description:"Convert value to number",category:"type",examples:[{input:"123.45",output:123.45},{input:"1,234.56",output:1234.56}],implementation:s=>{if(typeof s=="number")return s;if(typeof s=="string"){const e=s.replace(/,/g,""),r=parseFloat(e);return isNaN(r)?null:r}return null}},Kq={name:"toString",description:"Convert value to string",category:"type",examples:[{input:123,output:"123"},{input:!0,output:"true"}],implementation:s=>String(s)},Vq={name:"toBoolean",description:"Convert value to boolean",category:"type",examples:[{input:"true",output:!0},{input:1,output:!0},{input:0,output:!1}],implementation:s=>!!s},Xq={name:"toISODate",description:"Convert to ISO 8601 date string",category:"date",examples:[{input:1696176e6,output:"2023-10-01T12:00:00.000Z"},{input:"2023-10-01",output:"2023-10-01T00:00:00.000Z"}],implementation:s=>{try{return new Date(s).toISOString()}catch{return null}}},Jq={name:"fromUnixTimestamp",description:"Convert Unix timestamp (seconds) to ISO date",category:"date",examples:[{input:1696176e3,output:"2023-10-01T12:00:00.000Z"}],implementation:s=>{try{return new Date(s*1e3).toISOString()}catch{return null}}},Qq={name:"fromUnixTimestampMs",description:"Convert Unix timestamp (milliseconds) to ISO date",category:"date",examples:[{input:1696176e6,output:"2023-10-01T12:00:00.000Z"}],implementation:s=>{try{return new Date(s).toISOString()}catch{return null}}},Zq={name:"toUnixTimestamp",description:"Convert date to Unix timestamp (seconds)",category:"date",examples:[{input:"2023-10-01T12:00:00.000Z",output:1696176e3}],implementation:s=>{try{return Math.floor(new Date(s).getTime()/1e3)}catch{return null}}},e9={name:"round",description:"Round number to specified decimal places",category:"math",parameters:[{name:"decimals",type:"number",required:!1,defaultValue:2}],examples:[{input:123.456,output:123.46,params:{decimals:2}},{input:123.456,output:123,params:{decimals:0}}],implementation:(s,e)=>{const r=e?.decimals??2,n=Math.pow(10,r);return Math.round(s*n)/n}},t9={name:"multiply",description:"Multiply by a constant",category:"math",parameters:[{name:"multiplier",type:"number",required:!0}],examples:[{input:10,output:100,params:{multiplier:10}}],implementation:(s,e)=>s*(e?.multiplier??1)},r9={name:"divide",description:"Divide by a constant",category:"math",parameters:[{name:"divisor",type:"number",required:!0}],examples:[{input:100,output:10,params:{divisor:10}}],implementation:(s,e)=>{const r=e?.divisor??1;return r!==0?s/r:null}},n9={name:"add",description:"Add a constant",category:"math",parameters:[{name:"addend",type:"number",required:!0}],examples:[{input:10,output:15,params:{addend:5}}],implementation:(s,e)=>s+(e?.addend??0)},s9={name:"subtract",description:"Subtract a constant",category:"math",parameters:[{name:"subtrahend",type:"number",required:!0}],examples:[{input:10,output:5,params:{subtrahend:5}}],implementation:(s,e)=>s-(e?.subtrahend??0)},i9={name:"uppercase",description:"Convert string to uppercase",category:"string",examples:[{input:"hello",output:"HELLO"}],implementation:s=>s.toUpperCase()},o9={name:"lowercase",description:"Convert string to lowercase",category:"string",examples:[{input:"HELLO",output:"hello"}],implementation:s=>s.toLowerCase()},a9={name:"trim",description:"Remove leading and trailing whitespace",category:"string",examples:[{input:"  hello  ",output:"hello"}],implementation:s=>s.trim()},l9={name:"replace",description:"Replace text in string",category:"string",parameters:[{name:"find",type:"string",required:!0},{name:"replace",type:"string",required:!0}],examples:[{input:"NSE:SBIN",output:"SBIN",params:{find:"NSE:",replace:""}}],implementation:(s,e)=>{const r=e?.find??"",n=e?.replace??"";return s.replace(new RegExp(r,"g"),n)}},c9={name:"substring",description:"Extract substring",category:"string",parameters:[{name:"start",type:"number",required:!0},{name:"end",type:"number",required:!1}],examples:[{input:"HELLO",output:"ELL",params:{start:1,end:4}}],implementation:(s,e)=>{const r=e?.start??0,n=e?.end;return s.substring(r,n)}},d9={name:"bpsToPercent",description:"Convert basis points to percentage",category:"math",examples:[{input:250,output:2.5}],implementation:s=>s/100},u9={name:"percentToBps",description:"Convert percentage to basis points",category:"math",examples:[{input:2.5,output:250}],implementation:s=>s*100},p9={name:"roundPrice",description:"Round price to 2 decimal places",category:"format",examples:[{input:123.456789,output:123.46}],implementation:s=>Math.round(s*100)/100},h9={toNumber:Yq,toString:Kq,toBoolean:Vq,toISODate:Xq,fromUnixTimestamp:Jq,fromUnixTimestampMs:Qq,toUnixTimestamp:Zq,round:e9,multiply:t9,divide:r9,add:n9,subtract:s9,uppercase:i9,lowercase:o9,trim:a9,replace:l9,substring:c9,bpsToPercent:d9,percentToBps:u9,roundPrice:p9};function f9(s){const e=h9[s];return e?e.implementation:null}function g9(s,e,r){const n=f9(e);if(!n)throw new Error(`Transform function not found: ${e}`);return n(s,r)}const oc={OHLCV:{name:"OHLCV (Candlestick Data)",category:"market-data",description:"Open, High, Low, Close, Volume - Standard candlestick/bar data",fields:{symbol:{type:"string",required:!0,description:"Trading symbol or ticker"},timestamp:{type:"datetime",required:!0,description:"Bar timestamp (start time)"},open:{type:"number",required:!0,description:"Opening price",validation:{min:0}},high:{type:"number",required:!0,description:"Highest price in the period",validation:{min:0}},low:{type:"number",required:!0,description:"Lowest price in the period",validation:{min:0}},close:{type:"number",required:!0,description:"Closing price",validation:{min:0}},volume:{type:"number",required:!0,description:"Trading volume",validation:{min:0}},vwap:{type:"number",required:!1,description:"Volume weighted average price",validation:{min:0}},trades:{type:"number",required:!1,description:"Number of trades",validation:{min:0}}},examples:[{symbol:"AAPL",timestamp:"2024-10-01T09:30:00.000Z",open:174.5,high:176.2,low:174.1,close:175.43,volume:52e5,vwap:175.15}]},QUOTE:{name:"Real-time Quote",category:"market-data",description:"Real-time or delayed quote with bid/ask spreads",fields:{symbol:{type:"string",required:!0,description:"Trading symbol"},timestamp:{type:"datetime",required:!0,description:"Quote timestamp"},price:{type:"number",required:!0,description:"Last traded price",validation:{min:0}},bid:{type:"number",required:!1,description:"Best bid price",validation:{min:0}},ask:{type:"number",required:!1,description:"Best ask price",validation:{min:0}},bidSize:{type:"number",required:!1,description:"Bid quantity",validation:{min:0}},askSize:{type:"number",required:!1,description:"Ask quantity",validation:{min:0}},volume:{type:"number",required:!1,description:"Total volume",validation:{min:0}},change:{type:"number",required:!1,description:"Change from previous close"},changePercent:{type:"number",required:!1,description:"Percentage change"},open:{type:"number",required:!1,description:"Day open price",validation:{min:0}},high:{type:"number",required:!1,description:"Day high price",validation:{min:0}},low:{type:"number",required:!1,description:"Day low price",validation:{min:0}},previousClose:{type:"number",required:!1,description:"Previous day close",validation:{min:0}}},examples:[{symbol:"SBIN",timestamp:"2024-10-01T15:30:00.000Z",price:590.5,bid:590.45,ask:590.55,bidSize:5e3,askSize:3800,volume:542e4,change:12.45,changePercent:2.15,open:580.25,high:592.1,low:579.8,previousClose:578.05}]},TICK:{name:"Tick Data",category:"market-data",description:"Individual trade ticks",fields:{symbol:{type:"string",required:!0,description:"Trading symbol"},timestamp:{type:"datetime",required:!0,description:"Trade timestamp"},price:{type:"number",required:!0,description:"Trade price",validation:{min:0}},quantity:{type:"number",required:!0,description:"Trade quantity",validation:{min:0}},side:{type:"enum",required:!1,description:"Buy or Sell",values:["BUY","SELL","UNKNOWN"]},tradeId:{type:"string",required:!1,description:"Unique trade identifier"}}},ORDER:{name:"Order",category:"trading",description:"Trading order (placed, pending, filled, cancelled)",fields:{orderId:{type:"string",required:!0,description:"Unique order identifier"},symbol:{type:"string",required:!0,description:"Trading symbol"},side:{type:"enum",required:!0,description:"Buy or Sell",values:["BUY","SELL"]},type:{type:"enum",required:!0,description:"Order type",values:["MARKET","LIMIT","STOP","STOP_LIMIT"]},quantity:{type:"number",required:!0,description:"Order quantity",validation:{min:0}},filledQuantity:{type:"number",required:!1,description:"Filled quantity",validation:{min:0}},price:{type:"number",required:!1,description:"Limit price (for limit orders)",validation:{min:0}},stopPrice:{type:"number",required:!1,description:"Stop price (for stop orders)",validation:{min:0}},averagePrice:{type:"number",required:!1,description:"Average fill price",validation:{min:0}},status:{type:"enum",required:!0,description:"Order status",values:["PENDING","OPEN","PARTIALLY_FILLED","FILLED","CANCELLED","REJECTED"]},timestamp:{type:"datetime",required:!0,description:"Order placement timestamp"},updatedAt:{type:"datetime",required:!1,description:"Last update timestamp"},timeInForce:{type:"enum",required:!1,description:"Time in force",values:["DAY","GTC","IOC","FOK"]},exchange:{type:"string",required:!1,description:"Exchange name"}}},POSITION:{name:"Position",category:"portfolio",description:"Open position in portfolio",fields:{symbol:{type:"string",required:!0,description:"Trading symbol"},quantity:{type:"number",required:!0,description:"Position quantity (positive for long, negative for short)"},averagePrice:{type:"number",required:!0,description:"Average entry price",validation:{min:0}},currentPrice:{type:"number",required:!0,description:"Current market price",validation:{min:0}},marketValue:{type:"number",required:!0,description:"Current market value"},costBasis:{type:"number",required:!0,description:"Total cost basis"},pnl:{type:"number",required:!0,description:"Unrealized profit/loss"},pnlPercent:{type:"number",required:!0,description:"Unrealized P&L percentage"},realizedPnl:{type:"number",required:!1,description:"Realized profit/loss"},exchange:{type:"string",required:!1,description:"Exchange name"},productType:{type:"enum",required:!1,description:"Product type",values:["DELIVERY","INTRADAY","MARGIN"]}}},PORTFOLIO:{name:"Portfolio Summary",category:"portfolio",description:"Overall portfolio summary",fields:{totalValue:{type:"number",required:!0,description:"Total portfolio value"},cash:{type:"number",required:!0,description:"Available cash balance"},invested:{type:"number",required:!0,description:"Total invested amount"},marketValue:{type:"number",required:!0,description:"Total market value of holdings"},pnl:{type:"number",required:!0,description:"Total unrealized P&L"},pnlPercent:{type:"number",required:!0,description:"Total P&L percentage"},realizedPnl:{type:"number",required:!1,description:"Total realized P&L"},dayPnl:{type:"number",required:!1,description:"Today's P&L"},buyingPower:{type:"number",required:!1,description:"Available buying power"},marginUsed:{type:"number",required:!1,description:"Margin used"},timestamp:{type:"datetime",required:!0,description:"Portfolio snapshot timestamp"}}},INSTRUMENT:{name:"Instrument",category:"reference",description:"Security/instrument master data",fields:{symbol:{type:"string",required:!0,description:"Trading symbol"},name:{type:"string",required:!0,description:"Instrument name"},exchange:{type:"string",required:!0,description:"Exchange"},instrumentType:{type:"enum",required:!0,description:"Type of instrument",values:["EQUITY","FUTURES","OPTIONS","CURRENCY","COMMODITY","INDEX"]},isin:{type:"string",required:!1,description:"ISIN code"},lotSize:{type:"number",required:!1,description:"Lot size",validation:{min:1}},tickSize:{type:"number",required:!1,description:"Minimum price movement",validation:{min:0}},expiry:{type:"datetime",required:!1,description:"Expiry date (for derivatives)"},strike:{type:"number",required:!1,description:"Strike price (for options)",validation:{min:0}},optionType:{type:"enum",required:!1,description:"Call or Put",values:["CALL","PUT"]}}}};function x9(s){return oc[s]||null}function m9(s){return Object.values(oc).filter(e=>e.category===s)}function kg(s){const e=/\{([^}]+)\}/g,r=[];let n;for(;(n=e.exec(s))!==null;)r.push(n[1]);return r}function Qj(s,e){let r=s;for(const[n,i]of Object.entries(e)){const o=`{${n}}`;r=r.replace(new RegExp(o,"g"),encodeURIComponent(String(i)))}return r}function xp(s,e={}){let r=s.baseUrl;r.endsWith("/")&&(r=r.slice(0,-1));let n=s.endpoint;n.startsWith("/")||(n="/"+n),n=Qj(n,e),r+=n;const i=new URLSearchParams;for(const[a,l]of Object.entries(s.queryParams||{})){const d=Qj(l,e);i.append(a,d)}s.authentication.type==="apikey"&&s.authentication.config?.apiKey?.location==="query"&&i.append(s.authentication.config.apiKey.keyName,s.authentication.config.apiKey.value);const o=i.toString();return o&&(r+="?"+o),r}function y9(s){const e={"Content-Type":"application/json",Accept:"application/json",...s.headers},{authentication:r}=s;if(r.type==="apikey"&&r.config?.apiKey?.location==="header")e[r.config.apiKey.keyName]=r.config.apiKey.value;else if(r.type==="bearer"&&r.config?.bearer)e.Authorization=`Bearer ${r.config.bearer.token}`;else if(r.type==="basic"&&r.config?.basic){const n=btoa(`${r.config.basic.username}:${r.config.basic.password}`);e.Authorization=`Basic ${n}`}else r.type==="oauth2"&&r.config?.oauth2&&(e.Authorization=`Bearer ${r.config.oauth2.accessToken}`);return e}function Zj(s){try{return new URL(s),{valid:!0}}catch{return{valid:!1,error:"Invalid URL format. Make sure it starts with http:// or https://"}}}function b9(s,e){const r=kg(s.endpoint),n=Object.values(s.queryParams||{}).flatMap(l=>kg(l)),i=[...new Set([...r,...n])],o=Object.keys(e),a=i.filter(l=>!o.includes(l));return a.length>0?{valid:!1,missing:a}:{valid:!0}}function v9(s,e={}){try{const r=xp(s,e);if(s.authentication.type==="apikey"&&s.authentication.config?.apiKey?.location==="query"){const n=s.authentication.config.apiKey.keyName;return r.replace(new RegExp(`${n}=[^&]+`),`${n}=***`)}return r}catch{return"Invalid URL configuration"}}class S9{constructor(){Pe(this,"DEFAULT_TIMEOUT",3e4)}async executeRequest(e,r={}){const n=Date.now();try{const i=this.validateConfig(e,r);if(!i.valid)return this.createErrorResponse("client",i.error||"Invalid configuration",n,e,r);const o=xp(e,r),a=y9(e),l={method:e.method,headers:a,signal:AbortSignal.timeout(e.timeout||this.DEFAULT_TIMEOUT)};if(["POST","PUT","PATCH"].includes(e.method)&&e.body)try{JSON.parse(e.body),l.body=e.body}catch{return this.createErrorResponse("client","Invalid JSON in request body",n,e,r)}const d=await tn(o,l);return await this.handleResponse(d,n,e,r)}catch(i){return this.handleError(i,n,e,r)}}async handleResponse(e,r,n,i){const o=Date.now()-r;if(!e.ok){const a=this.getErrorTypeFromStatus(e.status);let l=`HTTP ${e.status}: ${e.statusText}`;try{const d=await e.text();if(d)try{const p=JSON.parse(d);l+=` - ${JSON.stringify(p)}`}catch{l+=` - ${d.substring(0,200)}`}}catch{}return{success:!1,error:{type:a,statusCode:e.status,message:l},metadata:{duration:o,url:e.url,method:n.method,timestamp:new Date().toISOString()}}}try{const a=e.headers.get("content-type");let l;return a?.includes("application/json")?l=await e.json():l=await e.text(),{success:!0,data:l,metadata:{duration:o,url:e.url,method:n.method,timestamp:new Date().toISOString()}}}catch(a){return{success:!1,error:{type:"parse",message:"Failed to parse response: "+(a instanceof Error?a.message:String(a))},metadata:{duration:o,url:e.url,method:n.method,timestamp:new Date().toISOString()}}}}handleError(e,r,n,i){const o=Date.now()-r,a=xp(n,i);let l="network",d="Network error";return e.name==="AbortError"||e.name==="TimeoutError"?(l="timeout",d=`Request timeout (${n.timeout||this.DEFAULT_TIMEOUT}ms)`):e instanceof TypeError?(l="network",d="Network connection failed. Check internet connection or CORS settings."):d=e.message||String(e),{success:!1,error:{type:l,message:d,details:e.stack},metadata:{duration:o,url:a,method:n.method,timestamp:new Date().toISOString()}}}validateConfig(e,r={}){const n=Zj(e.baseUrl);if(!n.valid)return{valid:!1,error:`Invalid base URL: ${n.error}`};if(!e.endpoint||e.endpoint.trim().length===0)return{valid:!1,error:"Endpoint is required"};if(!["GET","POST","PUT","DELETE","PATCH"].includes(e.method))return{valid:!1,error:"Invalid HTTP method"};const i=b9(e,r);if(!i.valid)return{valid:!1,error:`Missing required parameters: ${i.missing?.join(", ")}`};if(["POST","PUT","PATCH"].includes(e.method)&&e.body)try{JSON.parse(e.body)}catch{return{valid:!1,error:"Request body must be valid JSON"}}return{valid:!0}}getErrorTypeFromStatus(e){return e===401||e===403?"auth":e>=400&&e<500?"client":"server"}createErrorResponse(e,r,n,i,o){return{success:!1,error:{type:e,message:r},metadata:{duration:Date.now()-n,url:xp(i,o),method:i.method,timestamp:new Date().toISOString()}}}async testConnection(e){try{const r=this.validateConfig(e,{});if(!r.valid)return{success:!1,message:r.error||"Invalid configuration"};const n=xp(e,{}),i=Zj(n);return i.valid?{success:!0,message:"Configuration is valid"}:{success:!1,message:i.error||"Invalid URL"}}catch(r){return{success:!1,message:r instanceof Error?r.message:String(r)}}}}const A2=new S9;class w9{async execute(e){const r=Date.now();try{const{mapping:n,parameters:i,options:o}=e;let a;if(e.data)a=e.data;else if(n.source.type==="api"&&n.source.apiConfig)a=await this.fetchData(n,i);else if(n.source.type==="sample"&&n.source.sampleData)a=n.source.sampleData;else throw new Error("No data source provided");const l=await this.extractData(a,n),d=await this.transformData(l,n);let p;if(n.validation.enabled&&!o?.skipValidation&&(p=await this.validateData(d,n),n.validation.strictMode&&!p.valid))throw new Error(`Validation failed: ${p.errors.map(h=>h.message).join(", ")}`);const f=Date.now()-r;return{success:!0,data:d,rawData:o?.returnRaw?a:void 0,metadata:{executedAt:new Date().toISOString(),duration:f,recordsProcessed:Array.isArray(l)?l.length:1,recordsReturned:Array.isArray(d)?d.length:1,validationResults:p}}}catch(n){const i=Date.now()-r;return{success:!1,errors:[n instanceof Error?n.message:String(n)],metadata:{executedAt:new Date().toISOString(),duration:i,recordsProcessed:0,recordsReturned:0}}}}async fetchData(e,r){if(e.source.type!=="api"||!e.source.apiConfig)throw new Error("API configuration not provided");const n=e.source.apiConfig;if(n.cacheEnabled&&e.id){const o=await Ea.getCachedResponse(e.id,r||{});if(o)return console.log("[MappingEngine] Using cached response"),o}console.log("[MappingEngine] Executing API request");const i=await A2.executeRequest(n,r||{});if(!i.success)throw new Error(`API request failed: ${i.error?.message||"Unknown error"}`);return n.cacheEnabled&&e.id&&i.data&&await Ea.setCachedResponse(e.id,r||{},i.data,n.cacheTTL||300),i.data}async extractData(e,r){const{extraction:n}=r;sd(n.engine);let i=e;return n.rootPath&&(i=await sd(n.engine).execute(e,n.rootPath)),n.isArray&&!Array.isArray(i)?[i]:i}async transformData(e,r){if(Array.isArray(e)){const n=await Promise.all(e.map(i=>this.transformSingle(i,r)));return await this.applyPostProcessing(n,r)}else return this.transformSingle(e,r)}async transformSingle(e,r){const n={};for(const i of r.fieldMappings)try{let o=await this.extractFieldValue(e,i);if(i.transform&&i.transform.length>0&&o!==null&&o!==void 0)for(const a of i.transform)o=g9(o,a,i.transformParams);if(o==null){if(i.defaultValue!==void 0)o=i.defaultValue;else if(i.required)throw new Error(`Required field ${i.targetField} is missing`)}n[i.targetField]=o}catch(o){if(console.error(`Error mapping field ${i.targetField}:`,o),i.required)throw o}return r.target.schemaType==="predefined"&&r.target.schema==="POSITION"&&(!n.costBasis&&n.quantity&&n.averagePrice&&(n.costBasis=Math.abs(n.quantity*n.averagePrice)),!n.marketValue&&n.quantity&&n.currentPrice&&(n.marketValue=n.quantity*n.currentPrice)),n}async extractFieldValue(e,r){if(r.source.type==="static")return r.source.value;if(!r.source.path)return r.defaultValue;const n=r.parserEngine||r.parser;let i;if(typeof n=="string"){const a={jsonpath:At.JSONPATH,jsonata:At.JSONATA,jmespath:At.JMESPATH,direct:At.DIRECT,javascript:At.CUSTOM_JS}[n.toLowerCase()]||At.DIRECT;i=sd(a)}else n!==void 0?i=sd(n):i=sd(At.DIRECT);try{const o=r.source.path||r.sourceExpression||"";return await i.execute(e,o)}catch(o){return console.error(`Failed to extract ${r.targetField}:`,o),r.defaultValue}}async applyPostProcessing(e,r){let n=e;const{postProcessing:i}=r;if(!i)return n;if(i.filter){const o=sd(At.JSONATA);n=(await Promise.all(n.map(async l=>{try{const d=await o.execute(l,i.filter);return{item:l,include:d}}catch{return{item:l,include:!0}}}))).filter(l=>l.include).map(l=>l.item)}if(i.sort){const{field:o,order:a}=i.sort;n=n.sort((l,d)=>{const p=l[o],f=d[o],h=p<f?-1:p>f?1:0;return a==="desc"?-h:h})}if(i.deduplicate){const o=new Set,a=i.deduplicate;n=n.filter(l=>{const d=l[a];return o.has(d)?!1:(o.add(d),!0)})}return i.limit&&i.limit>0&&(n=n.slice(0,i.limit)),n}async validateData(e,r){let n=[];if(r.target.schemaType==="predefined"){const a=x9(r.target.schema);if(!a)return{valid:!0,errors:[]};n=Object.entries(a.fields).map(([l,d])=>({name:l,...d}))}else if(r.target.schemaType==="custom")n=r.target.customFields||[];else return{valid:!0,errors:[]};const i=[],o=Array.isArray(e)?e:[e];for(let a=0;a<o.length;a++){const l=o[a];for(const d of n){const p=d.name,f=l[p];if(d.required&&f==null){i.push({field:p,message:`Field '${p}' is required but missing`,rule:"required"});continue}if(f!=null){const h=Array.isArray(f)?"array":typeof f,x=d.type;if(x==="datetime"?h!=="string"?i.push({field:p,message:`Field '${p}' should be a date string, got ${h}`,rule:"type"}):isNaN(Date.parse(f))&&i.push({field:p,message:`Field '${p}' is not a valid date string`,rule:"type"}):x!==h&&i.push({field:p,message:`Field '${p}' should be ${x}, got ${h}`,rule:"type"}),d.validation){const{min:m,max:b,pattern:w}=d.validation;m!==void 0&&typeof f=="number"&&f<m&&i.push({field:p,message:`Field '${p}' must be >= ${m}`,rule:"range"}),b!==void 0&&typeof f=="number"&&f>b&&i.push({field:p,message:`Field '${p}' must be <= ${b}`,rule:"range"}),w&&typeof f=="string"&&!new RegExp(w).test(f)&&i.push({field:p,message:`Field '${p}' does not match pattern ${w}`,rule:"pattern"})}}}}return{valid:i.length===0,errors:i}}async test(e,r,n){return this.execute({mapping:e,data:r,parameters:n,options:{debug:!0,returnRaw:!0}})}}const T2=new w9;function E9(s,e){const[r,n]=S.useState(null),[i,o]=S.useState(null),[a,l]=S.useState(null),[d,p]=S.useState(!0),[f,h]=S.useState(!1),x=S.useRef(null),m=S.useRef(null),b=Jf(r?.type==="websocket"&&r?.enabled?x.current||"":null,null,{autoSubscribe:r?.type==="websocket"&&r?.enabled===!0});S.useEffect(()=>(w(),()=>{m.current&&clearInterval(m.current)}),[s]),S.useEffect(()=>{r?.type==="websocket"&&b.message&&(o(b.message.data),h(b.status==="connected"),l(null),p(!1))},[b.message,b.status,r?.type]);async function w(){try{p(!0),l(null);const E=await Rq(s);if(!E){l(`Data source '${s}' not found`),p(!1);return}if(!E.enabled){l(`Data source '${s}' is disabled`),p(!1);return}n(E),E.type==="websocket"?await y(E):E.type==="rest_api"&&await C(E)}catch(E){const j=E instanceof Error?E.message:String(E);l(j),p(!1)}}async function y(E){try{const j=k2(E);if(!j)throw new Error("Invalid WebSocket configuration");const k=fb(E);if(k){const{getWebSocketManager:A}=await Br(async()=>{const{getWebSocketManager:P}=await Promise.resolve().then(()=>NP);return{getWebSocketManager:P}},void 0),R=A();R.getProviderConfig(k.provider)||(R.setProviderConfig(k.provider,{provider_name:k.provider,enabled:!0,api_key:k.params?.api_key,api_secret:k.params?.api_secret,endpoint:k.params?.endpoint}),console.log(`[useDataSource] Provider config set for: ${k.provider}`))}x.current=j,p(!1)}catch(j){const k=j instanceof Error?j.message:String(j);l(k),p(!1)}}async function C(E){try{const j=fb(E);if(!j||!j.mappingId)throw new Error("Invalid REST API configuration");const k=await Ea.getMapping(j.mappingId);if(!k)throw new Error(`Mapping '${j.mappingId}' not found`);const A=await T2.execute({mapping:k,parameters:e||j.parameters});if(A.success)o(A.data),h(!0),l(null);else throw new Error(A.errors?.join(", ")||"Mapping execution failed");p(!1)}catch(j){const k=j instanceof Error?j.message:String(j);l(k),p(!1)}}async function T(){r&&r.type==="rest_api"&&await C(r)}return{data:i,error:a,loading:d,connected:f,source:r,refresh:T}}const Jl="#FFA500",d0="#FFFFFF",Rf="#00ff00",ek="#ff0000",Ql="#787878",C9=({id:s,alias:e,displayName:r,onRemove:n})=>{const{data:i,error:o,loading:a,connected:l,source:d,refresh:p}=E9(e),[f,h]=S.useState(null),[x,m]=S.useState(0),[b,w]=S.useState(!1);S.useEffect(()=>{i&&console.log(`[DataSourceWidget ${e}] Data update #${x}:`,i)},[i,e,x]),S.useEffect(()=>{if(i&&!a){h(new Date),m(E=>E+1),w(!0);const T=setTimeout(()=>w(!1),300);return()=>clearTimeout(T)}},[i,a]);const y=T=>T==null?t.jsx("span",{style:{color:Ql},children:"N/A"}):typeof T=="object"?t.jsx("div",{style:{fontSize:"9px",fontFamily:"monospace"},children:Object.entries(T).slice(0,10).map(([E,j])=>t.jsxs("div",{style:{padding:"2px 0",borderBottom:"1px solid #1a1a1a"},children:[t.jsxs("span",{style:{color:Jl},children:[E,":"]})," ",t.jsx("span",{style:{color:d0},children:typeof j=="object"?JSON.stringify(j).substring(0,50):String(j)})]},E))}):t.jsx("span",{style:{color:d0},children:String(T)}),C=()=>o?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",padding:"20px",textAlign:"center"},children:[t.jsx(Rr,{size:32,color:ek}),t.jsx("div",{style:{color:ek,fontSize:"11px",marginTop:"8px"},children:o})]}):a&&!i?t.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"8px"},children:t.jsx("div",{style:{color:Jl,fontSize:"10px"},children:"Loading data source..."})}):i?t.jsxs("div",{style:{padding:"8px",fontSize:"10px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px",padding:"4px 8px",backgroundColor:b?"#1a1a1a":"#0a0a0a",border:`1px solid ${l?Rf:Ql}`,fontSize:"9px",transition:"background-color 0.3s ease"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[d?.type==="websocket"?t.jsx(Yb,{size:12,color:l?Rf:Ql}):t.jsx(js,{size:12,color:Jl}),t.jsx("span",{style:{color:d0},children:d?.type==="websocket"?"WebSocket":"REST API"}),t.jsx("span",{style:{color:l?Rf:Ql},children:l?" LIVE":" IDLE"}),x>0&&t.jsxs("span",{style:{color:Jl,fontSize:"8px"},children:["#",x]})]}),t.jsx("div",{style:{color:Ql,fontSize:"8px"},children:f&&t.jsx("span",{children:f.toLocaleTimeString()})})]}),t.jsx("div",{style:{maxHeight:"calc(100% - 60px)",overflowY:"auto",backgroundColor:"#050505",border:"1px solid #1a1a1a",padding:"8px"},children:y(i)}),d?.type==="rest_api"&&t.jsx("div",{style:{marginTop:"8px",textAlign:"center"},children:t.jsx("button",{onClick:p,disabled:a,style:{background:a?Ql:Jl,color:"#000",border:"none",padding:"4px 12px",fontSize:"9px",fontWeight:"bold",cursor:a?"not-allowed":"pointer",width:"100%"},children:a?"REFRESHING...":"REFRESH DATA"})})]}):t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"8px",color:Ql,fontSize:"10px"},children:[t.jsx(js,{size:24}),t.jsx("div",{children:"No data available yet"}),d?.type==="rest_api"&&t.jsx("button",{onClick:p,style:{background:Jl,color:"#000",border:"none",padding:"6px 12px",fontSize:"9px",fontWeight:"bold",cursor:"pointer",marginTop:"8px"},children:"LOAD DATA"})]});return t.jsx(Xo,{id:s,title:r||d?.display_name||e,onRemove:n,onRefresh:d?.type==="rest_api"?p:void 0,isLoading:a&&!i,error:null,headerColor:d?.type==="websocket"?Rf:Jl,children:C()})},Zl="#FFA500",tl="#FFFFFF",Qi="#787878",Mo="#000000",j9="#0a0a0a",k9=({isOpen:s,onClose:e,onAdd:r})=>{const[n,i]=S.useState("news"),[o,a]=S.useState([]),[l,d]=S.useState([]),[p,f]=S.useState("ALL"),[h,x]=S.useState("Indices"),[m,b]=S.useState(""),[w,y]=S.useState("Trending"),[C,T]=S.useState("");S.useEffect(()=>{s&&n==="watchlist"&&E(),s&&n==="datasource"&&j()},[s,n]);const E=async()=>{try{await Zs.initialize();const A=await Zs.getWatchlistsWithCounts();a(A),A.length>0&&b(A[0].id)}catch(A){console.error("Failed to load watchlists:",A)}},j=async()=>{try{const R=(await vv()).filter(M=>M.enabled);d(R),R.length>0&&T(R[0].alias)}catch(A){console.error("Failed to load data sources:",A)}},k=()=>{let A={};switch(n){case"news":A={newsCategory:p,newsLimit:5};break;case"market":A={marketCategory:h,marketTickers:h==="Indices"?["^GSPC","^IXIC","^DJI","^RUT"]:h==="Tech"?["AAPL","MSFT","GOOGL","AMZN","NVDA"]:["GC=F","CL=F","SI=F"]};break;case"watchlist":const M=o.find(I=>I.id===m);A={watchlistId:m,watchlistName:M?.name||"Watchlist"};break;case"forum":A={forumCategoryName:w,forumLimit:5};break;case"datasource":const P=l.find(I=>I.alias===C);A={dataSourceAlias:C,dataSourceDisplayName:P?.display_name};break}r(n,A),e()};return s?t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:j9,border:`2px solid ${Zl}`,borderRadius:"4px",width:"500px",maxHeight:"80vh",overflow:"auto",boxShadow:`0 0 20px ${Zl}`},children:[t.jsxs("div",{style:{backgroundColor:Mo,borderBottom:`2px solid ${Zl}`,padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("div",{style:{color:Zl,fontSize:"14px",fontWeight:"bold"},children:"ADD WIDGET"}),t.jsx("button",{onClick:e,style:{background:"none",border:"none",color:Qi,cursor:"pointer",padding:"0",display:"flex"},children:t.jsx(ln,{size:20})})]}),t.jsxs("div",{style:{padding:"16px"},children:[t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("div",{style:{color:tl,fontSize:"11px",marginBottom:"8px",fontWeight:"bold"},children:"WIDGET TYPE"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"8px"},children:["news","market","watchlist","forum","crypto","commodities","indices","forex","maritime","datasource"].map(A=>t.jsx("button",{onClick:()=>i(A),style:{backgroundColor:n===A?Zl:Mo,color:n===A?Mo:tl,border:`1px solid ${n===A?Zl:Qi}`,padding:"8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",textTransform:"uppercase"},children:A},A))})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("div",{style:{color:tl,fontSize:"11px",marginBottom:"8px",fontWeight:"bold"},children:"CONFIGURATION"}),n==="news"&&t.jsxs("select",{value:p,onChange:A=>f(A.target.value),style:{width:"100%",backgroundColor:Mo,border:`1px solid ${Qi}`,color:tl,padding:"8px",fontSize:"11px"},children:[t.jsx("option",{value:"ALL",children:"All News"}),t.jsx("option",{value:"MARKETS",children:"Markets"}),t.jsx("option",{value:"TECH",children:"Technology"}),t.jsx("option",{value:"EARNINGS",children:"Earnings"}),t.jsx("option",{value:"ECONOMIC",children:"Economic"})]}),n==="market"&&t.jsxs("select",{value:h,onChange:A=>x(A.target.value),style:{width:"100%",backgroundColor:Mo,border:`1px solid ${Qi}`,color:tl,padding:"8px",fontSize:"11px"},children:[t.jsx("option",{value:"Indices",children:"Market Indices"}),t.jsx("option",{value:"Tech",children:"Tech Stocks"}),t.jsx("option",{value:"Commodities",children:"Commodities"})]}),n==="watchlist"&&(o.length>0?t.jsx("select",{value:m,onChange:A=>b(A.target.value),style:{width:"100%",backgroundColor:Mo,border:`1px solid ${Qi}`,color:tl,padding:"8px",fontSize:"11px"},children:o.map(A=>t.jsx("option",{value:A.id,children:A.name},A.id))}):t.jsx("div",{style:{color:Qi,fontSize:"10px",padding:"8px"},children:"No watchlists available. Create one in the Watchlist tab first."})),n==="forum"&&t.jsxs("select",{value:w,onChange:A=>y(A.target.value),style:{width:"100%",backgroundColor:Mo,border:`1px solid ${Qi}`,color:tl,padding:"8px",fontSize:"11px"},children:[t.jsx("option",{value:"Trending",children:"Trending Posts"}),t.jsx("option",{value:"Recent",children:"Recent Posts"})]}),n==="datasource"&&(l.length>0?t.jsx("select",{value:C,onChange:A=>T(A.target.value),style:{width:"100%",backgroundColor:Mo,border:`1px solid ${Qi}`,color:tl,padding:"8px",fontSize:"11px"},children:l.map(A=>t.jsxs("option",{value:A.alias,children:[A.display_name," (",A.alias,") - ",A.type==="websocket"?"WebSocket":"REST API"]},A.alias))}):t.jsx("div",{style:{color:Qi,fontSize:"10px",padding:"8px"},children:"No data sources available. Create one in Settings  Data Sources first."})),["crypto","commodities","indices","forex","maritime"].includes(n)&&t.jsxs("div",{style:{color:Qi,fontSize:"10px",padding:"8px",fontStyle:"italic"},children:["This widget shows live ",n==="maritime"?"maritime intelligence":n," data with automatic updates. No configuration required."]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:e,style:{backgroundColor:Qi,color:Mo,border:"none",padding:"8px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px"},children:"CANCEL"}),t.jsx("button",{onClick:k,disabled:n==="watchlist"&&o.length===0||n==="datasource"&&l.length===0,style:{backgroundColor:n==="watchlist"&&o.length===0||n==="datasource"&&l.length===0?Qi:Zl,color:Mo,border:"none",padding:"8px 16px",fontSize:"11px",fontWeight:"bold",cursor:n==="watchlist"&&o.length===0||n==="datasource"&&l.length===0?"not-allowed":"pointer",borderRadius:"2px"},children:"ADD WIDGET"})]})]})]})}):null},Qn={PANEL_BG:"#141414",BORDER:"#333333",ORANGE:"#FFA500",CYAN:"#00D4FF",WHITE:"#FFFFFF",GRAY:"#888888",HOVER:"#1a1a1a"},Tl=({compact:s=!1,style:e})=>{const[r,n]=S.useState(!1),i=S.useRef(null),{timezone:o,setTimezone:a,options:l}=Xg(),{formattedTime:d}=vz();S.useEffect(()=>{const f=h=>{i.current&&!i.current.contains(h.target)&&n(!1)};return r&&document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[r]);const p=f=>{a(f),n(!1)};return t.jsxs("div",{ref:i,style:{position:"relative",display:"inline-block",...e},children:[t.jsxs("button",{onClick:()=>n(!r),style:{display:"flex",alignItems:"center",gap:"6px",padding:s?"2px 6px":"4px 10px",backgroundColor:"transparent",border:`1px solid ${r?Qn.CYAN:Qn.BORDER}`,borderRadius:"3px",color:Qn.CYAN,cursor:"pointer",fontSize:s?"10px":"11px",fontFamily:'"IBM Plex Mono", "Consolas", monospace',fontWeight:500,transition:"all 0.2s ease"},onMouseEnter:f=>{f.currentTarget.style.borderColor=Qn.CYAN,f.currentTarget.style.backgroundColor=Qn.HOVER},onMouseLeave:f=>{f.currentTarget.style.borderColor=r?Qn.CYAN:Qn.BORDER,f.currentTarget.style.backgroundColor="transparent"},title:`Current timezone: ${o.label}`,children:[t.jsx(uo,{size:s?10:12}),t.jsx("span",{style:{fontVariantNumeric:"tabular-nums"},children:d}),t.jsx("span",{style:{color:Qn.ORANGE,fontWeight:700,fontSize:s?"8px":"9px"},children:o.shortLabel}),t.jsx(bi,{size:s?8:10,style:{transform:r?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"}})]}),r&&t.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"4px",backgroundColor:Qn.PANEL_BG,border:`1px solid ${Qn.BORDER}`,borderRadius:"4px",minWidth:"200px",zIndex:9999,boxShadow:"0 4px 16px rgba(0,0,0,0.5)",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"8px 12px",borderBottom:`1px solid ${Qn.BORDER}`,display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(fc,{size:12,color:Qn.ORANGE}),t.jsx("span",{style:{color:Qn.ORANGE,fontSize:"10px",fontWeight:700,letterSpacing:"0.5px"},children:"SELECT TIMEZONE"})]}),l.map(f=>t.jsxs("div",{onClick:()=>p(f.id),style:{padding:"10px 12px",cursor:"pointer",fontSize:"11px",backgroundColor:o.id===f.id?`${Qn.ORANGE}15`:"transparent",borderLeft:o.id===f.id?`3px solid ${Qn.ORANGE}`:"3px solid transparent",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.15s ease"},onMouseEnter:h=>{o.id!==f.id&&(h.currentTarget.style.backgroundColor=Qn.HOVER)},onMouseLeave:h=>{o.id!==f.id&&(h.currentTarget.style.backgroundColor="transparent")},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:o.id===f.id?Qn.ORANGE:Qn.WHITE,fontWeight:600,marginBottom:"2px"},children:f.label}),t.jsx("div",{style:{color:Qn.GRAY,fontSize:"9px"},children:f.zone||"System default"})]}),t.jsx("span",{style:{color:o.id===f.id?Qn.ORANGE:Qn.CYAN,fontWeight:700,fontSize:"10px"},children:f.shortLabel})]},f.id))]})]})},u0=[{id:"indices-1",type:"indices",title:"Global Indices - Top 12",config:{},layout:{i:"indices-1",x:0,y:0,w:4,h:5,minW:3,minH:4}},{id:"crypto-1",type:"crypto",title:"Cryptocurrency Markets",config:{},layout:{i:"crypto-1",x:4,y:0,w:4,h:5,minW:3,minH:4}},{id:"news-1",type:"news",title:"Market News",config:{newsCategory:"MARKETS",newsLimit:5},layout:{i:"news-1",x:8,y:0,w:4,h:5,minW:2,minH:3}},{id:"forex-1",type:"forex",title:"Forex - Major Pairs",config:{},layout:{i:"forex-1",x:0,y:5,w:3,h:4,minW:2,minH:3}},{id:"commodities-1",type:"commodities",title:"Commodities",config:{},layout:{i:"commodities-1",x:3,y:5,w:3,h:4,minW:2,minH:3}},{id:"news-2",type:"news",title:"Tech News",config:{newsCategory:"TECH",newsLimit:5},layout:{i:"news-2",x:6,y:5,w:3,h:4,minW:2,minH:3}},{id:"news-3",type:"news",title:"Earnings News",config:{newsCategory:"EARNINGS",newsLimit:5},layout:{i:"news-3",x:9,y:5,w:3,h:4,minW:2,minH:3}},{id:"forum-1",type:"forum",title:"Trending Forum Posts",config:{forumCategoryName:"Trending",forumLimit:5},layout:{i:"forum-1",x:0,y:9,w:4,h:4,minW:2,minH:3}},{id:"maritime-1",type:"maritime",title:"Maritime Intelligence",config:{},layout:{i:"maritime-1",x:4,y:9,w:4,h:4,minW:2,minH:3}},{id:"market-2",type:"market",title:"Tech Stocks",config:{marketCategory:"Tech",marketTickers:["AAPL","MSFT","GOOGL","AMZN","NVDA"]},layout:{i:"market-2",x:8,y:9,w:4,h:4,minW:2,minH:3}}],p0="dashboard-widgets",A9=({onNavigateToTab:s})=>{const{colors:e,fontSize:r,fontFamily:n,fontWeight:i,fontStyle:o}=Er(),[a,l]=S.useState([]),[d,p]=S.useState(!1),[f,h]=S.useState(new Date),[x,m]=S.useState(1),[b,w]=S.useState(1200),[y,C]=S.useState(!1),[T,E]=S.useState(!1),j=S.useRef(null);S.useEffect(()=>{(async()=>{try{console.log("[Dashboard] Initializing database for caching..."),await Je.initialize();const G=await Je.healthCheck();G.healthy?(C(!0),console.log("[Dashboard]  SQLite database initialized and ready for caching")):(console.warn("[Dashboard] Database not healthy:",G.message),C(!0))}catch(G){console.error("[Dashboard] Database initialization error:",G),C(!0)}})()},[]),S.useEffect(()=>{const O=localStorage.getItem(p0);if(O)try{const G=JSON.parse(O);l(G.widgets),m(G.nextId||1)}catch(G){console.error("Failed to load dashboard layout:",G),l(u0)}else l(u0)},[]),S.useEffect(()=>{const O=setInterval(()=>{h(new Date)},1e3);return()=>clearInterval(O)},[]),S.useEffect(()=>{const O=()=>{if(j.current){const F=j.current.offsetWidth;console.log("[Dashboard] Container width updated:",F),w(F)}};O(),window.addEventListener("resize",O);const G=new ResizeObserver(()=>{O()});j.current&&G.observe(j.current);const B=setTimeout(O,100);return()=>{window.removeEventListener("resize",O),G.disconnect(),clearTimeout(B)}},[]);const k=()=>{localStorage.setItem(p0,JSON.stringify({widgets:a,nextId:x})),alert("Dashboard layout saved!")},A=()=>{confirm("Reset dashboard to default layout? This will remove all custom widgets.")&&(l(u0),localStorage.removeItem(p0))},R=(O,G)=>{const B={id:`${O}-${x}`,type:O,title:G.watchlistName||G.marketCategory||G.newsCategory||G.forumCategoryName||O,config:G,layout:{i:`${O}-${x}`,x:a.length*3%12,y:1/0,w:4,h:4,minW:2,minH:3}};l([...a,B]),m(x+1)},M=O=>{l(a.filter(G=>G.id!==O))},P=O=>{l(a.map(G=>{const B=O.find(F=>F.i===G.id);return B?{...G,layout:B}:G}))},I=O=>{switch(O.type){case"news":return t.jsx(aq,{id:O.id,category:O.config?.newsCategory,limit:O.config?.newsLimit,onRemove:()=>M(O.id)});case"market":return t.jsx(uq,{id:O.id,category:O.config?.marketCategory,tickers:O.config?.marketTickers,onRemove:()=>M(O.id)});case"watchlist":return t.jsx(hq,{id:O.id,watchlistId:O.config?.watchlistId,watchlistName:O.config?.watchlistName,onRemove:()=>M(O.id)});case"forum":return t.jsx(fq,{id:O.id,categoryId:O.config?.forumCategoryId,categoryName:O.config?.forumCategoryName,limit:O.config?.forumLimit,onRemove:()=>M(O.id)});case"crypto":return t.jsx(xq,{id:O.id,onRemove:()=>M(O.id)});case"commodities":return t.jsx(bq,{id:O.id,onRemove:()=>M(O.id)});case"indices":return t.jsx(wq,{id:O.id,onRemove:()=>M(O.id)});case"forex":return t.jsx(jq,{id:O.id,onRemove:()=>M(O.id)});case"maritime":return t.jsx(Aq,{id:O.id,onRemove:()=>M(O.id),onNavigate:()=>s?.("maritime")});case"datasource":return t.jsx(C9,{id:O.id,alias:O.config?.dataSourceAlias||"",displayName:O.config?.dataSourceDisplayName,onRemove:()=>M(O.id)});default:return t.jsx("div",{children:"Unknown widget type"})}};return y?t.jsxs("div",{style:{height:"100%",backgroundColor:e.background,color:e.text,fontFamily:n,fontWeight:i,fontStyle:o,overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        /* Scrollbar styling */
        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        *::-webkit-scrollbar-track {
          background: #1a1a1a;
        }
        *::-webkit-scrollbar-thumb {
          background: #404040;
          border-radius: 4px;
        }
        *::-webkit-scrollbar-thumb:hover {
          background: #525252;
        }

        /* Grid layout drag handle styling */
        .react-grid-item.react-grid-placeholder {
          background: ${e.primary} !important;
          opacity: 0.3;
          border-radius: 4px;
        }

        .react-grid-item.resizing {
          opacity: 0.9;
          z-index: 100;
        }

        .react-grid-item {
          transition: all 200ms ease;
          transition-property: left, top, width, height;
        }

        .react-grid-item.cssTransforms {
          transition-property: transform, width, height;
        }

        .react-grid-item.react-draggable-dragging {
          transition: none;
          z-index: 100;
          will-change: transform;
        }

        .react-resizable-handle {
          opacity: 0;
          transition: opacity 0.2s;
        }

        .react-grid-item:hover .react-resizable-handle {
          opacity: 0.5;
        }

        .react-resizable-handle::after {
          border-right: 2px solid ${e.primary};
          border-bottom: 2px solid ${e.primary};
        }
      `}),t.jsx("div",{style:{backgroundColor:e.panel,borderBottom:`1px solid ${e.textMuted}`,padding:"8px 12px",flexShrink:0},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:e.primary,fontWeight:"bold",fontSize:r.subheading},children:"CUSTOMIZABLE DASHBOARD"}),t.jsx("span",{style:{color:e.text},children:"|"}),t.jsx("span",{style:{color:e.secondary,fontSize:r.small},children:" LIVE"}),t.jsx("span",{style:{color:e.text},children:"|"}),t.jsx(Tl,{compact:!0}),t.jsx("span",{style:{color:e.text},children:"|"}),t.jsxs("span",{style:{color:e.textMuted,fontSize:r.small},children:["WIDGETS: ",a.length]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsxs("button",{onClick:()=>p(!0),style:{background:e.secondary,color:"black",border:"none",padding:"6px 12px",fontSize:r.small,fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",borderRadius:"2px"},children:[t.jsx(wn,{size:12}),"ADD WIDGET"]}),t.jsxs("button",{onClick:k,style:{background:e.primary,color:"black",border:"none",padding:"6px 12px",fontSize:r.small,fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",borderRadius:"2px"},children:[t.jsx(ao,{size:12}),"SAVE LAYOUT"]}),t.jsxs("button",{onClick:A,style:{background:e.textMuted,color:"black",border:"none",padding:"6px 12px",fontSize:r.small,fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",borderRadius:"2px"},children:[t.jsx(GT,{size:12}),"RESET"]})]})]})}),t.jsx("div",{style:{backgroundColor:e.panel,borderBottom:`1px solid ${e.textMuted}`,padding:"4px 12px",fontSize:r.small,color:e.textMuted,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsxs("span",{children:[" ",t.jsx("span",{style:{color:e.text},children:"Drag widgets to rearrange"})]}),t.jsxs("span",{children:[" ",t.jsx("span",{style:{color:e.text},children:"Resize from bottom-right corner"})]}),t.jsxs("span",{children:[" ",t.jsx("span",{style:{color:e.text},children:"Remove widgets with X button"})]}),t.jsxs("span",{children:[" ",t.jsx("span",{style:{color:e.text},children:"Responsive layout - uses full width"})]})]})}),t.jsx("div",{ref:j,style:{flex:1,overflow:"auto",padding:"8px",backgroundColor:"#050505"},children:a.length===0?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"16px"},children:[t.jsx("div",{style:{color:e.textMuted,fontSize:r.subheading},children:"No widgets on dashboard"}),t.jsx("button",{onClick:()=>p(!0),style:{background:e.primary,color:"black",border:"none",padding:"12px 24px",fontSize:r.body,fontWeight:"bold",cursor:"pointer",borderRadius:"4px"},children:"ADD YOUR FIRST WIDGET"})]}):t.jsx(tq,{className:"layout",layout:a.map(O=>O.layout),cols:12,rowHeight:60,width:b-16,onLayoutChange:P,draggableHandle:".widget-drag-handle",isDraggable:!0,isResizable:!0,compactType:"vertical",preventCollision:!1,children:a.map(O=>t.jsx("div",{children:I(O)},O.id))})}),t.jsx("div",{style:{borderTop:`1px solid ${e.textMuted}`,backgroundColor:e.panel,padding:"4px 12px",fontSize:r.tiny,color:e.textMuted,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{children:"Fincept Customizable Dashboard v2.0.0 | Drag & drop workspace"}),t.jsxs("span",{children:["Widgets: ",a.length," | Layout: ",a.length>0?"Custom":"Empty"," | Status: ",t.jsx("span",{style:{color:e.secondary},children:"ACTIVE"}),y&&t.jsx("span",{style:{marginLeft:"8px",color:e.secondary},children:"| Cache: ENABLED"})]})]})}),t.jsx(k9,{isOpen:d,onClose:()=>p(!1),onAdd:R})]}):t.jsxs("div",{style:{height:"100%",backgroundColor:e.background,color:e.text,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"20px"},children:[t.jsx("div",{style:{width:"60px",height:"60px",border:"4px solid #404040",borderTop:"4px solid #ea580c",borderRadius:"50%",animation:"spin 1s linear infinite"}}),t.jsx("style",{children:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `}),t.jsxs("div",{style:{textAlign:"center",maxWidth:"500px"},children:[t.jsx("h3",{style:{color:"#ea580c",fontSize:"18px",marginBottom:"10px"},children:"Initializing Dashboard"}),t.jsx("p",{style:{color:"#a3a3a3",fontSize:"13px",lineHeight:"1.5"},children:"Setting up database cache for faster data loading..."}),t.jsx("p",{style:{color:"#787878",fontSize:"11px",marginTop:"10px"},children:"This will only take a moment on first launch"})]})]})},tk="fincept_market_preferences",rk={globalMarkets:[{category:"Stock Indices",tickers:["^GSPC","^IXIC","^DJI","^RUT","^VIX","^FTSE","^GDAXI","^N225","^FCHI","^HSI","^AXJO","^BSESN"]},{category:"Forex",tickers:["EURUSD=X","GBPUSD=X","JPY=X","CHF=X","CAD=X","AUDUSD=X","NZDUSD=X","EURGBP=X","EURJPY=X","GBPJPY=X","USDCNY=X","USDINR=X"]},{category:"Commodities",tickers:["GC=F","SI=F","CL=F","BZ=F","NG=F","HG=F","PL=F","PA=F","ZW=F","ZC=F","ZS=F","KC=F"]},{category:"Bonds",tickers:["^TNX","^TYX","^IRX","DE10Y=X","GB10Y=X","JP10Y=X","FR10Y=X","IT10Y=X","ES10Y=X","CA10Y=X","AU10Y=X","IN10Y=X"]},{category:"ETFs",tickers:["SPY","QQQ","DIA","EEM","GLD","XLK","XLE","XLF","XLV","VNQ","IWM","VTI"]},{category:"Cryptocurrencies",tickers:["BTC-USD","ETH-USD","BNB-USD","SOL-USD","XRP-USD","ADA-USD","DOGE-USD","MATIC-USD","LINK-USD","DOT-USD","AVAX-USD","UNI-USD"]}],regionalMarkets:[{region:"India",tickers:[{symbol:"RELIANCE.NS",name:"Reliance Industries"},{symbol:"TCS.NS",name:"Tata Consultancy"},{symbol:"HDFCBANK.NS",name:"HDFC Bank"},{symbol:"INFY.NS",name:"Infosys"},{symbol:"HINDUNILVR.NS",name:"Hindustan Unilever"},{symbol:"ICICIBANK.NS",name:"ICICI Bank"},{symbol:"SBIN.NS",name:"State Bank of India"},{symbol:"BHARTIARTL.NS",name:"Bharti Airtel"},{symbol:"ITC.NS",name:"ITC Limited"},{symbol:"KOTAKBANK.NS",name:"Kotak Mahindra Bank"},{symbol:"LT.NS",name:"Larsen & Toubro"},{symbol:"WIPRO.NS",name:"Wipro Limited"}]},{region:"China",tickers:[{symbol:"BABA",name:"Alibaba Group"},{symbol:"PDD",name:"PDD Holdings"},{symbol:"JD",name:"JD.com"},{symbol:"BIDU",name:"Baidu"},{symbol:"TCEHY",name:"Tencent Holdings"},{symbol:"NIO",name:"NIO Inc"},{symbol:"LI",name:"Li Auto"},{symbol:"XPEV",name:"XPeng"},{symbol:"BILI",name:"Bilibili"},{symbol:"NTES",name:"NetEase"},{symbol:"TME",name:"Tencent Music"},{symbol:"BEKE",name:"KE Holdings"}]},{region:"United States",tickers:[{symbol:"AAPL",name:"Apple Inc"},{symbol:"MSFT",name:"Microsoft Corp"},{symbol:"GOOGL",name:"Alphabet Inc"},{symbol:"AMZN",name:"Amazon.com"},{symbol:"NVDA",name:"NVIDIA Corp"},{symbol:"META",name:"Meta Platforms"},{symbol:"TSLA",name:"Tesla Inc"},{symbol:"JPM",name:"JPMorgan Chase"},{symbol:"V",name:"Visa Inc"},{symbol:"WMT",name:"Walmart Inc"},{symbol:"UNH",name:"UnitedHealth Group"},{symbol:"MA",name:"Mastercard Inc"}]}],lastUpdated:Date.now()};class T9{loadPreferences(){try{const e=localStorage.getItem(tk);if(e)return JSON.parse(e)}catch(e){console.error("[TickerStorage] Failed to load preferences:",e)}return rk}savePreferences(e){try{return e.lastUpdated=Date.now(),localStorage.setItem(tk,JSON.stringify(e)),!0}catch(r){return console.error("[TickerStorage] Failed to save preferences:",r),!1}}getCategoryTickers(e){return this.loadPreferences().globalMarkets.find(i=>i.category===e)?.tickers||[]}updateCategoryTickers(e,r){const n=this.loadPreferences(),i=n.globalMarkets.findIndex(o=>o.category===e);return i!==-1?(n.globalMarkets[i].tickers=r,this.savePreferences(n)):!1}addTickerToCategory(e,r){const n=this.getCategoryTickers(e);return n.includes(r)?!1:(n.push(r),this.updateCategoryTickers(e,n))}removeTickerFromCategory(e,r){const n=this.getCategoryTickers(e),i=n.filter(o=>o!==r);return i.length!==n.length?this.updateCategoryTickers(e,i):!1}reorderCategoryTickers(e,r,n){const i=this.getCategoryTickers(e),[o]=i.splice(r,1);return i.splice(n,0,o),this.updateCategoryTickers(e,i)}getRegionalTickers(e){return this.loadPreferences().regionalMarkets.find(i=>i.region===e)?.tickers||[]}updateRegionalTickers(e,r){const n=this.loadPreferences(),i=n.regionalMarkets.findIndex(o=>o.region===e);return i!==-1?(n.regionalMarkets[i].tickers=r,this.savePreferences(n)):!1}resetToDefaults(){return this.savePreferences(rk)}exportPreferences(){const e=this.loadPreferences();return JSON.stringify(e,null,2)}importPreferences(e){try{const r=JSON.parse(e);return this.savePreferences(r)}catch(r){return console.error("[TickerStorage] Failed to import preferences:",r),!1}}}const id=new T9;class R9{constructor(){Pe(this,"activeSessions",new Map)}async initialize(){Je.isReady()||await Je.initialize(),Oi.info("Service initialized")}async startRecording(e,r){const n=crypto.randomUUID(),i={id:n,tab_name:e,is_active:!0,auto_record:r?.autoRecord||!1,filters:r?.dataTypes?JSON.stringify({dataTypes:r.dataTypes}):void 0};return await Je.startRecordingSession(i),this.activeSessions.set(e,n),Oi.info(`Started recording for ${e} (Session: ${n})`),n}async stopRecording(e){await Je.stopRecordingSession(e),this.activeSessions.delete(e),Oi.info(`Stopped recording for ${e}`)}async isRecording(e){const r=await Je.getActiveRecordingSession(e);return r!==null&&r.is_active}async getActiveSession(e){return await Je.getActiveRecordingSession(e)}async recordData(e,r,n,i,o,a){const l=await Je.getActiveRecordingSession(e);if(!l||!l.is_active)return Oi.warn(`No active recording session for ${e}`),null;if(l.filters)try{const x=JSON.parse(l.filters);if(x.dataTypes&&!x.dataTypes.includes(r))return Oi.debug(`Skipping ${r} - filtered out`),null}catch(x){Oi.error("Error parsing filters:",x)}const d=crypto.randomUUID(),p=typeof n=="string"?n:JSON.stringify(n,null,2),f={...a,timestamp:new Date().toISOString(),session_id:l.id},h={id:d,tab_name:e,data_type:r,label:i||`${e} - ${r}`,raw_data:p,metadata:JSON.stringify(f),data_size:0,tags:o?.join(",")};return await Je.saveRecordedContext(h),Oi.debug(`Recorded ${r} for ${e} (ID: ${d}, Size: ${p.length} bytes)`),d}async recordApiResponse(e,r,n,i,o){return await this.recordData(e,"api_response",n,i||`API: ${r}`,o,{endpoint:r,timestamp:new Date().toISOString()})}async recordWebSocketData(e,r,n,i){return await this.recordData(e,"websocket",r,n||"WebSocket Data",i)}async recordTableData(e,r,n,i){return await this.recordData(e,"table_data",r,n||"Table Data",i)}async getRecordedContexts(e){return await Je.getRecordedContexts(e)}async getContextById(e){return await Je.getRecordedContext(e)}async getContextsByTab(e,r){return await Je.getRecordedContexts({tabName:e,limit:r})}async searchContexts(e,r=50){const n=await Je.getRecordedContexts({limit:1e3}),i=e.toLowerCase();return n.filter(o=>o.label?.toLowerCase().includes(i)||o.tab_name.toLowerCase().includes(i)||o.data_type.toLowerCase().includes(i)||o.tags?.toLowerCase().includes(i)||o.raw_data.toLowerCase().includes(i)).slice(0,r)}async linkToChat(e,r){await Je.linkContextToChat(e,r),Oi.debug(`Linked context ${r} to chat ${e}`)}async unlinkFromChat(e,r){await Je.unlinkContextFromChat(e,r),Oi.debug(`Unlinked context ${r} from chat ${e}`)}async getChatContexts(e){return await Je.getChatContexts(e)}async toggleChatContextActive(e,r){await Je.toggleChatContextActive(e,r)}async formatContextForLLM(e,r="markdown"){const n=await Je.getRecordedContext(e);if(!n)return"";if(r==="json")return`## Context: ${n.label}
**Source:** ${n.tab_name}
**Type:** ${n.data_type}
**Recorded:** ${new Date(n.created_at).toLocaleString()}

\`\`\`json
${n.raw_data}
\`\`\``;if(r==="markdown")return`## Context: ${n.label}

- **Source Tab:** ${n.tab_name}
- **Data Type:** ${n.data_type}
- **Recorded At:** ${new Date(n.created_at).toLocaleString()}
${n.tags?`- **Tags:** ${n.tags}`:""}

### Data:
\`\`\`
${n.raw_data}
\`\`\``;try{const i=JSON.parse(n.raw_data),o=this.generateSummary(i);return`## ${n.label}
**From:** ${n.tab_name}
**Summary:** ${o}`}catch{const i=n.raw_data.length>500?n.raw_data.substring(0,500)+"...":n.raw_data;return`## ${n.label}
**From:** ${n.tab_name}
**Data:** ${i}`}}async formatMultipleContexts(e,r="markdown"){const n=await Promise.all(e.map(i=>this.formatContextForLLM(i,r)));return`# Recorded Contexts (${e.length} items)

${n.join(`

---

`)}`}async deleteContext(e){await Je.deleteRecordedContext(e),Oi.debug(`Deleted context ${e}`)}async clearOldContexts(e){await Je.clearOldContexts(e),Oi.debug(`Cleared contexts older than ${e} days`)}async getStorageStats(){const e=await Je.getContextStorageStats();return{...e,formattedSize:this.formatBytes(e.totalSize)}}async exportContext(e){const r=await Je.getRecordedContext(e);if(!r)throw new Error(`Context ${e} not found`);return JSON.stringify(r,null,2)}async exportContexts(e){const r=await Promise.all(e.map(n=>Je.getRecordedContext(n)));return JSON.stringify(r.filter(n=>n!==null),null,2)}async importContext(e){try{const r=JSON.parse(e),n=crypto.randomUUID(),i={...r,id:n};return await Je.saveRecordedContext(i),Oi.debug(`Imported context as ${n}`),n}catch(r){throw Oi.error("Failed to import context:",r),new Error("Invalid context JSON")}}generateSummary(e){if(Array.isArray(e))return`Array with ${e.length} items`;if(typeof e=="object"&&e!==null){const r=Object.keys(e);return r.length<=3?`Object with keys: ${r.join(", ")}`:`Object with ${r.length} properties`}return typeof e=="string"?e.length>100?`${e.substring(0,100)}...`:e:String(e)}formatBytes(e){if(e===0)return"0 Bytes";const r=1024,n=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(r));return Math.round(e/Math.pow(r,i)*100)/100+" "+n[i]}isReady(){return Je.isReady()}}const qn=new R9,N9=({isOpen:s,onClose:e,title:r,tickers:n,onSave:i})=>{const[o,a]=S.useState([...n]),[l,d]=S.useState("");if(S.useEffect(()=>{a([...n])},[n]),!s)return null;const p=()=>{const E=l.trim().toUpperCase();E&&!o.includes(E)&&(a([...o,E]),d(""))},f=E=>{a(o.filter((j,k)=>k!==E))},h=E=>{if(E===0)return;const j=[...o];[j[E-1],j[E]]=[j[E],j[E-1]],a(j)},x=E=>{if(E===o.length-1)return;const j=[...o];[j[E],j[E+1]]=[j[E+1],j[E]],a(j)},m=()=>{i(o),e()},b="#FFA500",w="#FFFFFF",y="#787878",C="#1a1a1a",T="#000000";return t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:t.jsxs("div",{style:{backgroundColor:T,border:`2px solid ${b}`,width:"90%",maxWidth:"600px",maxHeight:"80vh",display:"flex",flexDirection:"column",fontFamily:"Consolas, monospace"},children:[t.jsxs("div",{style:{backgroundColor:C,color:b,padding:"12px 16px",fontSize:"14px",fontWeight:"bold",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${y}`},children:[t.jsxs("span",{children:["EDIT ",r.toUpperCase()]}),t.jsx(ln,{size:20,style:{cursor:"pointer",color:w},onClick:e})]}),t.jsx("div",{style:{padding:"16px",borderBottom:`1px solid ${y}`,backgroundColor:C},children:t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("input",{type:"text",value:l,onChange:E=>d(E.target.value),onKeyPress:E=>E.key==="Enter"&&p(),placeholder:"Enter ticker symbol (e.g., AAPL)",style:{flex:1,backgroundColor:T,border:`1px solid ${y}`,color:w,padding:"8px 12px",fontSize:"12px",fontFamily:"Consolas, monospace"}}),t.jsxs("button",{onClick:p,style:{backgroundColor:b,border:"none",color:"black",padding:"8px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(wn,{size:14})," ADD"]})]})}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:o.length===0?t.jsx("div",{style:{color:y,fontSize:"12px",textAlign:"center",padding:"32px"},children:"No tickers added. Add tickers using the form above."}):o.map((E,j)=>t.jsxs("div",{style:{backgroundColor:j%2===0?"rgba(255,255,255,0.05)":"transparent",border:`1px solid ${y}`,padding:"8px 12px",marginBottom:"4px",display:"flex",alignItems:"center",gap:"12px",fontSize:"12px"},children:[t.jsxs("div",{style:{color:y,fontSize:"10px",minWidth:"20px",textAlign:"center"},children:["#",j+1]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[t.jsx("button",{onClick:()=>h(j),disabled:j===0,style:{backgroundColor:j===0?"transparent":C,border:`1px solid ${y}`,color:j===0?y:b,cursor:j===0?"not-allowed":"pointer",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center",opacity:j===0?.3:1},title:"Move up",children:t.jsx(Hp,{size:12})}),t.jsx("button",{onClick:()=>x(j),disabled:j===o.length-1,style:{backgroundColor:j===o.length-1?"transparent":C,border:`1px solid ${y}`,color:j===o.length-1?y:b,cursor:j===o.length-1?"not-allowed":"pointer",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center",opacity:j===o.length-1?.3:1},title:"Move down",children:t.jsx(bi,{size:12})})]}),t.jsx("span",{style:{color:w,flex:1,fontWeight:"bold"},children:E}),t.jsxs("button",{onClick:()=>f(j),style:{backgroundColor:"transparent",border:`1px solid ${y}`,color:"#FF0000",cursor:"pointer",padding:"4px 8px",display:"flex",alignItems:"center",gap:"4px",fontSize:"10px"},title:"Remove ticker",children:[t.jsx(On,{size:12}),"REMOVE"]})]},j))}),t.jsxs("div",{style:{padding:"16px",borderTop:`1px solid ${y}`,display:"flex",justifyContent:"flex-end",gap:"8px",backgroundColor:C},children:[t.jsx("button",{onClick:e,style:{backgroundColor:y,border:"none",color:"black",padding:"8px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:m,style:{backgroundColor:b,border:"none",color:"black",padding:"8px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"SAVE CHANGES"})]})]})})},Sv=({tabName:s,onRecordingChange:e,onRecordingStart:r})=>{const{colors:n}=Er(),[i,o]=S.useState(!1),[a,l]=S.useState(!1),[d,p]=S.useState(!1),[f,h]=S.useState(["api_response","websocket","table_data"]),[x,m]=S.useState(""),[b,w]=S.useState("");S.useEffect(()=>{y();const j=setInterval(()=>{y()},2e3);return()=>clearInterval(j)},[s]);const y=async()=>{try{const j=await qn.isRecording(s);j!==i&&(console.log(`[RecordingPanel] ${s} recording status: ${j?"ACTIVE":"STOPPED"}`),o(j),e?.(j))}catch(j){console.error("[RecordingPanel] Failed to check status:",j)}},C=async()=>{try{await qn.startRecording(s,{autoRecord:d,dataTypes:f.length>0?f:void 0,label:x||void 0,tags:b?b.split(",").map(j=>j.trim()):void 0}),o(!0),e?.(!0),console.log(`[RecordingPanel] Started recording for ${s}`),r&&(console.log(`[RecordingPanel] Triggering onRecordingStart for ${s}`),await r())}catch(j){console.error("[RecordingPanel] Failed to start recording:",j)}},T=async()=>{try{await qn.stopRecording(s),o(!1),e?.(!1),console.log(`[RecordingPanel] Stopped recording for ${s}`)}catch(j){console.error("[RecordingPanel] Failed to stop recording:",j)}},E=j=>{h(k=>k.includes(j)?k.filter(A=>A!==j):[...k,j])};return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",position:"relative"},children:[i&&t.jsx("span",{style:{color:n.alert,fontSize:"11px",fontWeight:"bold",animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:" REC"}),t.jsx("button",{onClick:i?T:C,style:{backgroundColor:i?n.alert:n.primary,color:"black",border:"none",padding:"4px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:j=>{j.currentTarget.style.opacity="0.8"},onMouseLeave:j=>{j.currentTarget.style.opacity="1"},children:i?t.jsxs(t.Fragment,{children:[t.jsx(xc,{size:12}),"STOP"]}):t.jsxs(t.Fragment,{children:[t.jsx(Ms,{size:12}),"RECORD"]})}),t.jsx("button",{onClick:()=>l(!a),style:{backgroundColor:n.primary,color:"black",border:"none",padding:"4px 8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center"},onMouseEnter:j=>{j.currentTarget.style.opacity="0.8"},onMouseLeave:j=>{j.currentTarget.style.opacity="1"},title:"Recording Settings",children:t.jsx(HB,{size:14})}),a&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:()=>l(!1)}),t.jsxs("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"4px",backgroundColor:n.panel,border:`1px solid ${n.textMuted}`,width:"320px",padding:"12px",zIndex:1e3,boxShadow:"0 4px 12px rgba(0,0,0,0.5)"},children:[t.jsxs("div",{style:{borderBottom:`1px solid ${n.textMuted}`,paddingBottom:"8px",marginBottom:"12px"},children:[t.jsx("div",{style:{color:n.primary,fontSize:"12px",fontWeight:"bold"},children:"RECORDING SETTINGS"}),t.jsx("div",{style:{color:n.textMuted,fontSize:"10px",marginTop:"2px"},children:"Configure data capture options"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px",padding:"6px",backgroundColor:n.background},children:[t.jsx("span",{style:{color:n.text,fontSize:"11px"},children:"Auto Record"}),t.jsx("input",{type:"checkbox",checked:d,onChange:j=>p(j.target.checked),disabled:i,style:{cursor:i?"not-allowed":"pointer"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:n.text,fontSize:"11px",marginBottom:"6px",fontWeight:"bold"},children:"DATA TYPES"}),[{key:"api_response",label:"API Responses"},{key:"websocket",label:"WebSocket Data"},{key:"table_data",label:"Table Data"}].map(({key:j,label:k})=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 6px",backgroundColor:f.includes(j)?"rgba(255,120,0,0.1)":n.background,marginBottom:"4px"},children:[t.jsx("span",{style:{color:n.text,fontSize:"10px"},children:k}),t.jsx("input",{type:"checkbox",checked:f.includes(j),onChange:()=>E(j),disabled:i,style:{cursor:i?"not-allowed":"pointer"}})]},j))]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:n.text,fontSize:"11px",display:"block",marginBottom:"4px"},children:"SESSION LABEL"}),t.jsx("input",{type:"text",value:x,onChange:j=>m(j.target.value),disabled:i,placeholder:"e.g., Market Analysis",style:{width:"100%",backgroundColor:n.background,border:`1px solid ${n.textMuted}`,color:n.text,padding:"4px 8px",fontSize:"10px",outline:"none"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:n.text,fontSize:"11px",display:"block",marginBottom:"4px"},children:"TAGS (comma-separated)"}),t.jsx("input",{type:"text",value:b,onChange:j=>w(j.target.value),disabled:i,placeholder:"e.g., analysis, portfolio",style:{width:"100%",backgroundColor:n.background,border:`1px solid ${n.textMuted}`,color:n.text,padding:"4px 8px",fontSize:"10px",outline:"none"}})]})]})]}),t.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }
      `})]})},O9=()=>{const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState(new Date),[l,d]=S.useState(new Date),[p,f]=S.useState(!1),[h,x]=S.useState(!0),[m,b]=S.useState(6e5),[w,y]=S.useState(!1),[C,T]=S.useState({}),[E,j]=S.useState({}),[k,A]=S.useState(!1),[R,M]=S.useState(""),[P,I]=S.useState([]),[O,G]=S.useState("global"),[B,F]=S.useState(id.loadPreferences()),[z,$]=S.useState(!1),W=async()=>{if(Object.keys(C).length>0||Object.keys(E).length>0)try{const me={globalMarkets:C,regionalMarkets:E,timestamp:new Date().toISOString(),updateInterval:m};console.log("[MarketsTab] Recording current data:",me),await qn.recordApiResponse("Markets","market-data",me,`Market Data (Snapshot) - ${new Date().toLocaleString()}`,["markets","quotes","snapshot"]),console.log("[MarketsTab] Current data recorded successfully")}catch(me){console.error("[MarketsTab] Failed to record current data:",me)}},D=async()=>{f(!0);const me=m/6e4,ge=[],le={},X={};if(B.globalMarkets.forEach(V=>{const de=(async()=>{try{const je=await Fi.getEnhancedQuotesWithCache(V.tickers,V.category,me);le[V.category]=je,T(_e=>({..._e,[V.category]:je}))}catch(je){console.error(`Failed to fetch ${V.category}:`,je)}})();ge.push(de)}),B.regionalMarkets.forEach(V=>{const de=(async()=>{try{const je=V.tickers.map(Re=>Re.symbol),_e=await Fi.getEnhancedQuotesWithCache(je,V.region,me);X[V.region]=_e,j(Re=>({...Re,[V.region]:_e}))}catch(je){console.error(`Failed to fetch ${V.region}:`,je)}})();ge.push(de)}),await Promise.all(ge),d(new Date),f(!1),z)try{const V={globalMarkets:le,regionalMarkets:X,timestamp:new Date().toISOString(),updateInterval:m};console.log("[MarketsTab] Recording data:",V),await qn.recordApiResponse("Markets","market-data",V,`Market Data - ${new Date().toLocaleString()}`,["markets","quotes","live-data"]),console.log("[MarketsTab] Data recorded successfully")}catch(V){console.error("[MarketsTab] Failed to record data:",V)}};S.useEffect(()=>{(async()=>{try{await Je.initialize();const ge=await Je.healthCheck();ge.healthy?(y(!0),console.log("[MarketsTab] Database initialized and ready for caching")):console.warn("[MarketsTab] Database not healthy:",ge.message)}catch(ge){console.error("[MarketsTab] Database initialization error:",ge)}})()},[]),S.useEffect(()=>{D()},[]),S.useEffect(()=>{const me=setInterval(()=>{a(new Date),h&&D()},m);return()=>clearInterval(me)},[h,m,B]);const oe=me=>{const ge=id.getCategoryTickers(me);M(me),I(ge),G("global"),A(!0)},Z=me=>{const le=id.getRegionalTickers(me).map(X=>X.symbol);M(me),I(le),G("regional"),A(!0)},fe=me=>{if(O==="global")id.updateCategoryTickers(R,me);else{const ge=me.map(le=>({symbol:le,name:le}));id.updateRegionalTickers(R,ge)}F(id.loadPreferences()),D()},Q=me=>me>=0?`+${me.toFixed(2)}`:me.toFixed(2),_=me=>me>=0?`+${me.toFixed(2)}%`:`${me.toFixed(2)}%`,Y=(me,ge)=>t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,flex:"1 1 calc(33.333% - 16px)",minWidth:"300px",maxWidth:"600px",height:"280px",margin:"8px",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:s.background,color:s.primary,padding:"8px",fontSize:e.subheading,fontWeight:"bold",textAlign:"center",borderBottom:`1px solid ${s.textMuted}`,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[me.toUpperCase(),t.jsx(ug,{size:14,style:{cursor:"pointer",color:s.text},onClick:()=>oe(me)})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr",gap:"4px",padding:"4px 8px",backgroundColor:s.background,color:s.text,fontSize:e.body,fontWeight:"bold",borderBottom:`1px solid ${s.textMuted}`},children:[t.jsx("div",{children:"SYMBOL"}),t.jsx("div",{style:{textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHANGE"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"}),t.jsx("div",{style:{textAlign:"right"},children:"HIGH"}),t.jsx("div",{style:{textAlign:"right"},children:"LOW"})]}),t.jsx("div",{style:{flex:1,overflow:"auto"},children:ge.length===0?t.jsx("div",{style:{color:s.textMuted,fontSize:e.body,textAlign:"center",padding:"16px"},children:p?"Loading...":"No data available"}):ge.map((le,X)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr 1fr",gap:"4px",padding:"2px 8px",fontSize:e.small,backgroundColor:X%2===0?"rgba(255,255,255,0.05)":"transparent",borderBottom:"1px solid rgba(120,120,120,0.3)",minHeight:"18px",alignItems:"center"},children:[t.jsx("div",{style:{color:s.text},children:le.symbol}),t.jsx("div",{style:{color:s.text,textAlign:"right"},children:le.price.toFixed(2)}),t.jsx("div",{style:{color:le.change>=0?s.secondary:s.alert,textAlign:"right"},children:Q(le.change)}),t.jsx("div",{style:{color:le.change_percent>=0?s.secondary:s.alert,textAlign:"right"},children:_(le.change_percent)}),t.jsx("div",{style:{color:s.text,textAlign:"right"},children:le.high?le.high.toFixed(2):"-"}),t.jsx("div",{style:{color:s.text,textAlign:"right"},children:le.low?le.low.toFixed(2):"-"})]},X))})]}),he=(me,ge)=>{const le=B.regionalMarkets.find(X=>X.region===me);return t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,flex:"1 1 calc(33.333% - 16px)",minWidth:"300px",maxWidth:"600px",height:"300px",margin:"8px",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:s.background,color:s.primary,padding:"8px",fontSize:e.subheading,fontWeight:"bold",textAlign:"center",borderBottom:`1px solid ${s.textMuted}`,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[me.toUpperCase()," - LIVE DATA",t.jsx(ug,{size:14,style:{cursor:"pointer",color:s.text},onClick:()=>Z(me)})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr 1fr 1fr 1fr",gap:"4px",padding:"4px 8px",backgroundColor:s.background,color:s.text,fontSize:e.body,fontWeight:"bold",borderBottom:`1px solid ${s.textMuted}`},children:[t.jsx("div",{children:"SYMBOL"}),t.jsx("div",{children:"NAME"}),t.jsx("div",{style:{textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{textAlign:"right"},children:"CHANGE"}),t.jsx("div",{style:{textAlign:"right"},children:"%CHG"})]}),t.jsx("div",{style:{flex:1,overflow:"auto"},children:ge.length===0?t.jsx("div",{style:{color:s.textMuted,fontSize:e.body,textAlign:"center",padding:"16px"},children:p?"Loading...":"No data available"}):ge.map((X,V)=>{const de=le?.tickers.find(je=>je.symbol===X.symbol);return t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr 1fr 1fr 1fr",gap:"4px",padding:"2px 8px",fontSize:e.small,backgroundColor:V%2===0?"rgba(255,255,255,0.05)":"transparent",borderBottom:"1px solid rgba(120,120,120,0.3)",minHeight:"18px",alignItems:"center"},children:[t.jsx("div",{style:{color:s.text},children:X.symbol}),t.jsx("div",{style:{color:s.text,overflow:"hidden",textOverflow:"ellipsis"},children:de?.name||X.symbol}),t.jsx("div",{style:{color:s.text,textAlign:"right"},children:X.price.toFixed(2)}),t.jsx("div",{style:{color:X.change>=0?s.secondary:s.alert,textAlign:"right"},children:Q(X.change)}),t.jsx("div",{style:{color:X.change_percent>=0?s.secondary:s.alert,textAlign:"right"},children:_(X.change_percent)})]},V)})})]})};return t.jsxs("div",{style:{height:"100%",backgroundColor:s.background,color:s.text,fontFamily:r,fontWeight:n,fontStyle:i,overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        *::-webkit-scrollbar-track {
          background: #1a1a1a;
        }
        *::-webkit-scrollbar-thumb {
          background: #404040;
          border-radius: 4px;
        }
        *::-webkit-scrollbar-thumb:hover {
          background: #525252;
        }
      `}),t.jsxs("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",padding:"8px 12px",backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,fontSize:"13px",gap:"8px",flexShrink:0},children:[t.jsx("span",{style:{color:s.primary,fontWeight:"bold"},children:"FINCEPT"}),t.jsx("span",{style:{color:s.text},children:"MARKET TERMINAL - LIVE DATA"}),t.jsx("span",{style:{color:s.textMuted},children:"|"}),t.jsx(Tl,{compact:!0})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",padding:"8px 12px",backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,fontSize:"12px",gap:"8px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[t.jsx("button",{onClick:D,style:{backgroundColor:s.primary,color:"black",border:"none",padding:"4px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"REFRESH"}),t.jsxs("button",{onClick:()=>x(!h),style:{backgroundColor:h?s.secondary:s.textMuted,color:"black",border:"none",padding:"4px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:["AUTO ",h?"ON":"OFF"]}),t.jsxs("select",{value:m,onChange:me=>b(Number(me.target.value)),style:{backgroundColor:s.background,border:`1px solid ${s.textMuted}`,color:s.text,padding:"4px 8px",fontSize:"11px",cursor:"pointer"},children:[t.jsx("option",{value:6e5,children:"10 min"}),t.jsx("option",{value:9e5,children:"15 min"}),t.jsx("option",{value:18e5,children:"30 min"}),t.jsx("option",{value:36e5,children:"1 hour"})]}),t.jsx("span",{style:{color:s.textMuted},children:"|"}),t.jsx("span",{style:{color:s.textMuted,fontSize:"11px"},children:"LAST UPDATE:"}),t.jsx("span",{style:{color:s.text,fontSize:"11px"},children:l.toTimeString().substring(0,8)}),t.jsx("span",{style:{color:s.textMuted},children:"|"}),t.jsx("span",{style:{color:p?s.primary:s.secondary,fontSize:"14px"},children:""}),t.jsx("span",{style:{color:p?s.primary:s.secondary,fontSize:"11px",fontWeight:"bold"},children:p?"UPDATING":"LIVE"})]}),t.jsx(Sv,{tabName:"Markets",onRecordingChange:$,onRecordingStart:W})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"12px",display:"flex",flexDirection:"column"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"0.5px"},children:"GLOBAL MARKETS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"16px"}}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0",marginBottom:"24px"},children:B.globalMarkets.map(me=>Y(me.category,C[me.category]||[]))}),t.jsx("div",{style:{color:s.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"8px",marginTop:"16px",letterSpacing:"0.5px"},children:"REGIONAL MARKETS - LIVE DATA"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"16px"}}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0"},children:B.regionalMarkets.map(me=>he(me.region,E[me.region]||[]))})]}),t.jsx("div",{style:{borderTop:`1px solid ${s.textMuted}`,backgroundColor:s.panel,padding:"6px 12px",fontSize:"10px",color:s.textMuted,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"8px"},children:[t.jsx("span",{children:"Data provided by Yahoo Finance API | Real-time updates"}),t.jsxs("span",{style:{whiteSpace:"nowrap"},children:["Connected: ",Object.keys(E).length," regional markets",w&&t.jsx("span",{style:{marginLeft:"8px",color:s.secondary},children:"| Cache: ENABLED"})]})]})}),t.jsx(N9,{isOpen:k,onClose:()=>A(!1),title:R,tickers:P,onSave:fe})]})},_9=()=>{const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState(new Date),[l,d]=S.useState("ALL"),[p,f]=S.useState(0),[h,x]=S.useState(0),[m,b]=S.useState([]),[w,y]=S.useState(!0),[C,T]=S.useState([]),[E,j]=S.useState(null),[k,A]=S.useState(!1),[R,M]=S.useState(10),[P,I]=S.useState(!1),[O,G]=S.useState(!1),B=async()=>{if(m.length>0)try{const V={articles:m,totalCount:m.length,alertCount:m.filter(de=>de.priority==="FLASH"||de.priority==="URGENT").length,sources:ap(),timestamp:new Date().toISOString(),filter:l};await qn.recordApiResponse("News","news-feed",V,`News Feed (Snapshot) - ${new Date().toLocaleString()}`,["news","rss","snapshot",l.toLowerCase()])}catch{}},F=async()=>{y(!0);try{const V=await hb(!0);if(b(V),x(V.filter(de=>de.priority==="FLASH"||de.priority==="URGENT").length),T(ap()),f(de=>de+1),O&&V.length>0)try{const de={articles:V,totalCount:V.length,alertCount:V.filter(je=>je.priority==="FLASH"||je.priority==="URGENT").length,sources:ap(),timestamp:new Date().toISOString(),filter:l};await qn.recordApiResponse("News","news-feed",de,`News Feed - ${new Date().toLocaleString()}`,["news","rss","live-feed",l.toLowerCase()])}catch{}}catch{}finally{y(!1)}};S.useEffect(()=>{const V=async()=>{y(!0);try{const je=await hb();if(b(je),x(je.filter(_e=>_e.priority==="FLASH"||_e.priority==="URGENT").length),T(ap()),f(_e=>_e+1),O&&je.length>0)try{const _e={articles:je,totalCount:je.length,alertCount:je.filter(Re=>Re.priority==="FLASH"||Re.priority==="URGENT").length,sources:ap(),timestamp:new Date().toISOString(),filter:l};await qn.recordApiResponse("News","news-feed",_e,`News Feed - ${new Date().toLocaleString()}`,["news","rss","live-feed",l.toLowerCase()])}catch{}}catch{}finally{y(!1)}};V();const de=setInterval(V,R*60*1e3);return()=>clearInterval(de)},[R,O,l]),S.useEffect(()=>{const V=setInterval(()=>{a(new Date)},1e3);return()=>clearInterval(V)},[]);const $=m.length===0?"Loading news feeds...":m.map(V=>` ${V.priority} | ${V.source} | ${V.headline.toUpperCase()}     `).join(""),W=Math.max(1200,Math.min(4800,$.length/1e3*1600)),D=V=>{switch(V){case"FLASH":return s.alert;case"URGENT":return s.primary;case"BREAKING":return s.warning;case"ROUTINE":return s.secondary;default:return s.textMuted}},oe=V=>{switch(V){case"BULLISH":return s.secondary;case"BEARISH":return s.alert;case"NEUTRAL":return s.warning;default:return s.textMuted}},Z=V=>{switch(V){case"HIGH":return s.alert;case"MEDIUM":return s.warning;case"LOW":return s.secondary;default:return s.textMuted}},fe=l==="ALL"?m:m.filter(V=>V.category===l),Q=m.filter(V=>V.sentiment==="BULLISH").length,_=m.filter(V=>V.sentiment==="BEARISH").length,Y=m.filter(V=>V.sentiment==="NEUTRAL").length,he=m.length||1,me=((Q-_)/he).toFixed(2),ge=m.filter(V=>V.priority==="BREAKING"||V.priority==="FLASH").length,le=m.filter(V=>V.category==="EARNINGS").length,X=m.filter(V=>V.category==="ECONOMIC").length;return t.jsxs("div",{style:{height:"100%",backgroundColor:s.background,color:s.text,fontFamily:r,fontWeight:n,fontStyle:i,overflow:"hidden",display:"flex",flexDirection:"column",fontSize:e.body},children:[t.jsxs("div",{style:{backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,padding:"4px 8px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.primary,fontWeight:"bold"},children:"FINCEPT TERMINAL PROFESSIONAL NEWS"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.alert,fontWeight:"bold",animation:"blink 1s infinite"},children:"LIVE FEED"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:s.warning},children:["ALERTS: ",h]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:s.secondary},children:[" ",o0()," SOURCES"]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx(Tl,{compact:!0}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("button",{onClick:F,disabled:w,style:{backgroundColor:w?s.textMuted:s.secondary,color:s.background,border:"none",padding:"2px 8px",fontSize:"11px",fontWeight:"bold",cursor:w?"not-allowed":"pointer",borderRadius:"2px",display:"flex",alignItems:"center",gap:"4px"},title:"Refresh news feeds",children:[" ",w?"UPDATING...":"REFRESH"]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("button",{onClick:()=>I(!P),style:{backgroundColor:s.info,color:s.background,border:"none",padding:"2px 8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px"},title:"Auto-refresh settings",children:[" ",R,"min"]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx(Sv,{tabName:"News",onRecordingChange:G,onRecordingStart:B})]}),P&&t.jsxs("div",{style:{position:"absolute",top:"30px",right:"8px",backgroundColor:s.panel,border:`2px solid ${s.primary}`,borderRadius:"4px",padding:"8px",zIndex:1e3,boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:[t.jsx("div",{style:{fontSize:"11px",color:s.warning,fontWeight:"bold",marginBottom:"6px"},children:"AUTO-REFRESH INTERVAL"}),[1,2,5,10,15,30].map(V=>t.jsxs("button",{onClick:()=>{M(V),I(!1)},style:{width:"100%",backgroundColor:R===V?s.primary:s.background,color:R===V?s.background:s.text,border:`1px solid ${s.textMuted}`,padding:"4px 8px",fontSize:"10px",fontWeight:R===V?"bold":"normal",cursor:"pointer",marginBottom:"2px",textAlign:"left"},children:[V," minute",V>1?"s":""]},V))]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"11px",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.warning,fontWeight:"bold"},children:"BREAKING:"}),t.jsx("div",{className:"ticker-wrap",style:{flex:1,overflow:"hidden",position:"relative",height:"20px"},children:t.jsxs("div",{className:"ticker-move",children:[t.jsx("span",{className:"ticker-item",children:$}),t.jsx("span",{className:"ticker-item",children:$})]})}),t.jsx("span",{style:{color:s.secondary,fontSize:"9px"},children:" LIVE"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"10px",flexWrap:"wrap"},children:[t.jsx("span",{style:{color:s.textMuted},children:"ACTIVE SOURCES:"}),C.slice(0,12).map((V,de)=>t.jsxs("span",{style:{color:s.secondary},children:[V,""]},de)),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.textMuted},children:"ARTICLES:"}),t.jsx("span",{style:{color:s.accent},children:m.length}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.textMuted},children:"STATUS:"}),t.jsx("span",{style:{color:w?s.warning:s.secondary},children:w?"UPDATING...":oq()?" DEMO MODE":" LIVE"})]})]}),t.jsx("div",{style:{backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,padding:"2px 4px",flexShrink:0},children:t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"2px"},children:[{key:"F1",label:"ALL",filter:"ALL"},{key:"F2",label:"MARKETS",filter:"MARKETS"},{key:"F3",label:"EARNINGS",filter:"EARNINGS"},{key:"F4",label:"ECON",filter:"ECONOMIC"},{key:"F5",label:"TECH",filter:"TECH"},{key:"F6",label:"ENERGY",filter:"ENERGY"},{key:"F7",label:"BANKING",filter:"BANKING"},{key:"F8",label:"CRYPTO",filter:"CRYPTO"},{key:"F9",label:"GEOPO",filter:"GEOPOLITICS"},{key:"F10",label:"FLASH",filter:"FLASH"},{key:"F11",label:"URGENT",filter:"URGENT"},{key:"F12",label:"REFRESH",filter:"REFRESH"}].map(V=>t.jsxs("button",{onClick:()=>{V.filter==="REFRESH"?window.location.reload():V.filter==="FLASH"?(d("ALL"),b(de=>de.filter(je=>je.priority==="FLASH"))):V.filter==="URGENT"?(d("ALL"),b(de=>de.filter(je=>je.priority==="URGENT"||je.priority==="FLASH"))):d(V.filter)},style:{backgroundColor:l===V.filter?s.primary:s.background,border:`1px solid ${s.textMuted}`,color:l===V.filter?s.background:s.text,padding:"2px 4px",fontSize:"9px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:l===V.filter?"bold":"normal",cursor:"pointer"},children:[t.jsxs("span",{style:{color:s.warning},children:[V.key,":"]}),t.jsx("span",{style:{marginLeft:"2px"},children:V.label})]},V.key))})}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"4px",backgroundColor:"#050505"},children:t.jsxs("div",{style:{display:"flex",gap:"4px",height:"100%"},children:[t.jsxs("div",{style:{flex:1,backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:["PRIMARY NEWS FEED [",l,"]"]}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),w&&m.length===0?t.jsxs("div",{style:{color:s.warning,fontSize:"10px",textAlign:"center",padding:"20px"},children:["Loading news from ",o0()," RSS feeds..."]}):fe.length===0?t.jsxs("div",{style:{color:s.textMuted,fontSize:"10px",textAlign:"center",padding:"20px"},children:["No articles found for filter: ",l]}):null,fe.slice(0,Math.ceil(fe.length/3)).map((V,de)=>t.jsxs("div",{style:{marginBottom:"6px",borderLeft:`3px solid ${D(V.priority)}`,paddingLeft:"4px",backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"transparent",cursor:V.link?"pointer":"default"},onClick:()=>j(V),children:[t.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"1px",fontSize:"8px"},children:[t.jsx("span",{style:{color:s.textMuted,minWidth:"50px"},children:V.time}),t.jsxs("span",{style:{color:D(V.priority),fontWeight:"bold",minWidth:"60px"},children:["[",V.priority,"]"]}),t.jsxs("span",{style:{color:s.info,minWidth:"50px"},children:["[",V.category,"]"]}),t.jsx("span",{style:{color:s.purple,minWidth:"30px"},children:V.region}),t.jsx("span",{style:{color:oe(V.sentiment),minWidth:"50px"},children:V.sentiment})]}),t.jsx("div",{style:{color:s.text,fontWeight:"bold",fontSize:"10px",lineHeight:"1.2",marginBottom:"2px"},children:V.headline}),t.jsx("div",{style:{color:s.textMuted,fontSize:"9px",lineHeight:"1.2",marginBottom:"2px"},children:V.summary}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"8px"},children:[t.jsx("span",{style:{color:s.accent},children:V.source}),t.jsxs("span",{style:{color:Z(V.impact)},children:["IMPACT: ",V.impact]})]})]},V.id))]}),t.jsxs("div",{style:{flex:1,backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:["SECONDARY NEWS FEED [",l,"]"]}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),fe.slice(Math.ceil(fe.length/3),Math.ceil(fe.length*2/3)).map((V,de)=>t.jsxs("div",{style:{marginBottom:"6px",borderLeft:`3px solid ${D(V.priority)}`,paddingLeft:"4px",backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"transparent",cursor:V.link?"pointer":"default"},onClick:()=>j(V),children:[t.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"1px",fontSize:"8px"},children:[t.jsx("span",{style:{color:s.textMuted,minWidth:"50px"},children:V.time}),t.jsxs("span",{style:{color:D(V.priority),fontWeight:"bold",minWidth:"60px"},children:["[",V.priority,"]"]}),t.jsxs("span",{style:{color:s.info,minWidth:"50px"},children:["[",V.category,"]"]}),t.jsx("span",{style:{color:s.purple,minWidth:"30px"},children:V.region}),t.jsx("span",{style:{color:oe(V.sentiment),minWidth:"50px"},children:V.sentiment})]}),t.jsx("div",{style:{color:s.text,fontWeight:"bold",fontSize:"10px",lineHeight:"1.2",marginBottom:"2px"},children:V.headline}),t.jsx("div",{style:{color:s.textMuted,fontSize:"9px",lineHeight:"1.2",marginBottom:"2px"},children:V.summary}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"8px"},children:[t.jsx("span",{style:{color:s.accent},children:V.source}),t.jsxs("span",{style:{color:Z(V.impact)},children:["IMPACT: ",V.impact]})]})]},V.id))]}),t.jsxs("div",{style:{width:"400px",backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:"REAL-TIME NEWS ANALYTICS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"6px"}}),t.jsxs("div",{style:{marginBottom:"8px",fontSize:"9px"},children:[t.jsx("div",{style:{color:s.warning,fontWeight:"bold",marginBottom:"3px"},children:"SENTIMENT ANALYSIS"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Bullish Articles:"}),t.jsxs("span",{style:{color:s.secondary},children:[Q," (",Math.round(Q/he*100),"%)"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Bearish Articles:"}),t.jsxs("span",{style:{color:s.alert},children:[_," (",Math.round(_/he*100),"%)"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Neutral Articles:"}),t.jsxs("span",{style:{color:s.warning},children:[Y," (",Math.round(Y/he*100),"%)"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"2px",paddingTop:"2px",borderTop:`1px solid ${s.textMuted}`},children:[t.jsx("span",{style:{color:s.accent,fontWeight:"bold"},children:"Sentiment Score:"}),t.jsxs("span",{style:{color:parseFloat(me)>0?s.secondary:parseFloat(me)<0?s.alert:s.warning,fontWeight:"bold"},children:[me," (",parseFloat(me)>0?"BULLISH":parseFloat(me)<0?"BEARISH":"NEUTRAL",")"]})]})]}),t.jsxs("div",{style:{marginBottom:"8px",fontSize:"9px"},children:[t.jsx("div",{style:{color:s.warning,fontWeight:"bold",marginBottom:"3px"},children:"NEWS FLOW STATS"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Total Articles:"}),t.jsx("span",{style:{color:s.text},children:m.length})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Breaking News:"}),t.jsx("span",{style:{color:s.alert},children:ge})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Earnings Reports:"}),t.jsx("span",{style:{color:s.info},children:le})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Economic Data:"}),t.jsx("span",{style:{color:s.purple},children:X})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"High Priority:"}),t.jsx("span",{style:{color:s.primary},children:h})]})]})]}),t.jsxs("div",{style:{borderTop:`2px solid ${s.textMuted}`,paddingTop:"4px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:"ADDITIONAL HEADLINES"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),fe.slice(Math.ceil(fe.length*2/3)).map((V,de)=>t.jsxs("div",{style:{marginBottom:"6px",borderLeft:`3px solid ${D(V.priority)}`,paddingLeft:"4px",backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"transparent",cursor:V.link?"pointer":"default"},onClick:()=>j(V),children:[t.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"1px",fontSize:"8px"},children:[t.jsx("span",{style:{color:s.textMuted,minWidth:"50px"},children:V.time}),t.jsxs("span",{style:{color:D(V.priority),fontWeight:"bold",minWidth:"60px"},children:["[",V.priority,"]"]}),t.jsxs("span",{style:{color:s.info,minWidth:"50px"},children:["[",V.category,"]"]})]}),t.jsx("div",{style:{color:s.text,fontWeight:"bold",fontSize:"10px",lineHeight:"1.2",marginBottom:"2px"},children:V.headline}),t.jsxs("div",{style:{color:s.textMuted,fontSize:"9px",lineHeight:"1.2",marginBottom:"2px"},children:[V.summary.slice(0,150),"..."]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"8px"},children:[t.jsx("span",{style:{color:s.accent},children:V.source}),t.jsx("span",{style:{color:oe(V.sentiment)},children:V.sentiment})]})]},V.id))]})]})]})}),t.jsx("div",{style:{borderTop:`1px solid ${s.textMuted}`,backgroundColor:s.panel,padding:"2px 8px",fontSize:"10px",color:s.textMuted,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsxs("span",{children:["FinceptTerminal Professional News v1.0.0 | Real-time from ",o0()," RSS feeds"]}),t.jsxs("span",{children:["Articles: ",m.length," | Filter: ",l," | Updates: ",p]})]}),t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsxs("span",{children:["High Priority: ",h," | Sentiment: ",me]}),t.jsxs("span",{children:["Session: ",o.toTimeString().substring(0,8)]}),t.jsx("span",{style:{color:w?s.warning:s.secondary},children:w?"UPDATING...":"FEED: LIVE"})]})]})}),E&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>j(null),children:t.jsxs("div",{style:{backgroundColor:s.panel,border:`2px solid ${s.primary}`,borderRadius:"4px",width:k?"90vw":"600px",maxWidth:"95vw",height:k?"90vh":"auto",maxHeight:"90vh",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:`0 0 20px ${s.primary}`,transition:"all 0.3s ease"},onClick:V=>V.stopPropagation(),children:[t.jsxs("div",{style:{backgroundColor:s.background,borderBottom:`2px solid ${s.primary}`,padding:"8px 12px",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",fontSize:"11px"},children:[t.jsx("span",{style:{color:s.primary,fontWeight:"bold"},children:"ARTICLE DETAILS"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:D(E.priority),fontWeight:"bold"},children:["[",E.priority,"]"]}),t.jsxs("span",{style:{color:s.info},children:["[",E.category,"]"]})]}),t.jsx("button",{onClick:()=>{j(null),A(!1)},style:{backgroundColor:s.alert,color:s.text,border:"none",padding:"4px 8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px"},children:" CLOSE"})]}),t.jsx("div",{style:{padding:k?"0":"12px",overflow:"auto",flex:1,display:"flex",flexDirection:"column"},children:k&&E.link?t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{backgroundColor:s.background,padding:"8px",borderBottom:`1px solid ${s.textMuted}`,display:"flex",alignItems:"center",gap:"8px",fontSize:"10px"},children:[t.jsx("button",{onClick:()=>A(!1),style:{backgroundColor:s.primary,color:s.background,border:"none",padding:"4px 8px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px"},children:" BACK TO SUMMARY"}),t.jsx("span",{style:{color:s.textMuted},children:"|"}),t.jsx("span",{style:{color:s.warning,fontWeight:"bold"},children:"READER VIEW"}),t.jsx("span",{style:{color:s.textMuted},children:"|"}),t.jsx("span",{style:{color:s.text,flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:E.source}),t.jsx("button",{onClick:async()=>{if(window.__TAURI__){const{openUrl:V}=await Br(async()=>{const{openUrl:de}=await import("./index-2yLhyArq.js");return{openUrl:de}},__vite__mapDeps([0,1]));await V(E.link)}else window.open(E.link,"_blank")},style:{backgroundColor:s.info,color:s.text,border:"none",padding:"4px 8px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px"},children:" OPEN FULL ARTICLE"})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"24px",backgroundColor:"#1a1a1a",color:"#e0e0e0"},children:[t.jsxs("div",{style:{marginBottom:"24px",paddingBottom:"16px",borderBottom:`2px solid ${s.primary}`},children:[t.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px",fontSize:"11px"},children:[t.jsx("span",{style:{backgroundColor:D(E.priority),color:s.background,padding:"2px 8px",borderRadius:"2px",fontWeight:"bold"},children:E.priority}),t.jsx("span",{style:{backgroundColor:s.info,color:s.text,padding:"2px 8px",borderRadius:"2px",fontWeight:"bold"},children:E.category}),t.jsx("span",{style:{backgroundColor:oe(E.sentiment),color:s.background,padding:"2px 8px",borderRadius:"2px",fontWeight:"bold"},children:E.sentiment})]}),t.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",lineHeight:"1.3",marginBottom:"12px",color:s.text},children:E.headline}),t.jsxs("div",{style:{display:"flex",gap:"16px",fontSize:"12px",color:s.textMuted},children:[t.jsxs("span",{children:[" ",E.source]}),t.jsxs("span",{children:[" ",E.time]}),t.jsxs("span",{children:[" ",E.region]}),E.tickers&&E.tickers.length>0&&t.jsxs("span",{children:[" ",E.tickers.join(", ")]})]})]}),t.jsxs("div",{style:{fontSize:"16px",lineHeight:"1.8",color:"#d0d0d0",maxWidth:"800px",margin:"0 auto"},children:[t.jsx("p",{style:{marginBottom:"16px",fontSize:"18px",fontWeight:"500",color:"#e0e0e0"},children:E.summary}),t.jsxs("div",{style:{backgroundColor:"rgba(255, 165, 0, 0.1)",border:`1px solid ${s.primary}`,borderRadius:"4px",padding:"16px",marginTop:"24px"},children:[t.jsx("p",{style:{fontSize:"14px",color:s.warning,marginBottom:"8px",fontWeight:"bold"},children:" Reader View Limitation"}),t.jsx("p",{style:{fontSize:"13px",lineHeight:"1.6",color:s.textMuted,marginBottom:"12px"},children:"Most news websites block embedding for security reasons. This reader view shows the article summary from the RSS feed."}),t.jsx("p",{style:{fontSize:"13px",lineHeight:"1.6",color:s.textMuted},children:'For the complete article with images, videos, and full content, please click the " OPEN FULL ARTICLE" button above to view it in your browser.'})]})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"12px",padding:"8px",backgroundColor:"rgba(255, 165, 0, 0.05)",border:`1px solid ${s.textMuted}`,fontSize:"10px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"SOURCE: "}),t.jsx("span",{style:{color:s.accent,fontWeight:"bold"},children:E.source})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"TIME: "}),t.jsx("span",{style:{color:s.text},children:E.time})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"REGION: "}),t.jsx("span",{style:{color:s.purple},children:E.region})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"SENTIMENT: "}),t.jsx("span",{style:{color:oe(E.sentiment),fontWeight:"bold"},children:E.sentiment})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"IMPACT: "}),t.jsx("span",{style:{color:Z(E.impact),fontWeight:"bold"},children:E.impact})]}),E.tickers&&E.tickers.length>0&&t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"TICKERS: "}),t.jsx("span",{style:{color:s.secondary,fontWeight:"bold"},children:E.tickers.join(", ")})]})]}),t.jsx("div",{style:{color:s.text,fontSize:"14px",fontWeight:"bold",lineHeight:"1.4",marginBottom:"12px",padding:"8px",backgroundColor:"rgba(255, 255, 255, 0.05)",borderLeft:`4px solid ${D(E.priority)}`},children:E.headline}),t.jsx("div",{style:{color:s.textMuted,fontSize:"12px",lineHeight:"1.6",marginBottom:"16px"},children:E.summary}),E.link&&t.jsxs("div",{style:{display:"flex",gap:"8px",paddingTop:"12px",borderTop:`1px solid ${s.textMuted}`},children:[t.jsx("button",{onClick:V=>{V.stopPropagation(),A(!0)},style:{backgroundColor:s.secondary,color:s.background,border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px",flex:1},children:" READ IN APP"}),t.jsx("button",{onClick:async V=>{V.stopPropagation();const de=E.link;if(de)try{if(window.__TAURI__){const{openUrl:je}=await Br(async()=>{const{openUrl:_e}=await import("./index-2yLhyArq.js");return{openUrl:_e}},__vite__mapDeps([0,1]));await je(de)}else{const je=document.createElement("a");je.href=de,je.target="_blank",je.rel="noopener noreferrer",document.body.appendChild(je),je.click(),document.body.removeChild(je)}}catch{await navigator.clipboard.writeText(de)}},style:{backgroundColor:s.info,color:s.text,border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px",flex:1},children:" OPEN IN BROWSER"}),t.jsx("button",{onClick:V=>{V.stopPropagation();const de=E.link;de&&(navigator.clipboard.writeText(de),V.currentTarget.textContent=" COPIED!",setTimeout(()=>{V.currentTarget.textContent=" COPY"},2e3))},style:{backgroundColor:s.textMuted,color:s.text,border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"2px"},title:"Copy link to clipboard",children:" COPY"})]})]})})]})}),t.jsx("style",{children:`
        .ticker-wrap {
          width: 100%;
          overflow: hidden;
          background-color: transparent;
          padding: 0;
        }

        .ticker-move {
          display: inline-block;
          white-space: nowrap;
          animation: tickerScroll ${W}s linear infinite;
          padding-right: 100%;
        }

        .ticker-item {
          display: inline-block;
          padding-right: 3em;
          color: ${s.text};
          font-size: 11px;
          white-space: nowrap;
        }

        @keyframes tickerScroll {
          0% {
            transform: translateX(0);
          }
          100% {
            transform: translateX(-50%);
          }
        }

        @keyframes blink {
          0%, 50% { opacity: 1; }
          51%, 100% { opacity: 0.3; }
        }

        /* Transparent scrollbars for all browsers */
        * {
          scrollbar-width: thin;
          scrollbar-color: rgba(120, 120, 120, 0.3) transparent;
        }

        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }

        *::-webkit-scrollbar-track {
          background: transparent;
        }

        *::-webkit-scrollbar-thumb {
          background-color: rgba(120, 120, 120, 0.3);
          border-radius: 4px;
          border: 2px solid transparent;
        }

        *::-webkit-scrollbar-thumb:hover {
          background-color: rgba(120, 120, 120, 0.5);
        }

        *::-webkit-scrollbar-corner {
          background: transparent;
        }
      `})]})},R2=()=>{const s=zi.getTheme();return{ORANGE:s.colors.primary,WHITE:s.colors.text,RED:s.colors.alert,GREEN:s.colors.secondary,YELLOW:s.colors.warning,GRAY:s.colors.textMuted,BLUE:s.colors.info,PURPLE:s.colors.purple,CYAN:s.colors.accent,DARK_BG:s.colors.background,PANEL_BG:s.colors.panel}},xr=R2(),hl=s=>s==null?"N/A":`$${s.toFixed(2)}`,N2=s=>s==null?"N/A":`${s>=0?"+":""}${s.toFixed(2)}%`,D9=s=>s==null?"N/A":s>=1e12?`${(s/1e12).toFixed(2)}T`:s>=1e9?`${(s/1e9).toFixed(2)}B`:s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}K`:s.toFixed(0),O2=s=>D9(s),Qf=s=>s==null?xr.GRAY:s>=0?xr.GREEN:xr.RED,I9=(s,e,r=!1)=>{const n=[...s];return n.sort((i,o)=>{let a=0;switch(e){case"TICKER":a=i.symbol.localeCompare(o.symbol);break;case"CHANGE":const l=i.quote?.change_percent||0;a=(o.quote?.change_percent||0)-l;break;case"VOLUME":const p=i.quote?.volume||0;a=(o.quote?.volume||0)-p;break;case"PRICE":const h=i.quote?.price||0;a=(o.quote?.price||0)-h;break}return r?-a:a}),n},h0=["#FFA500","#6496FA","#00C800","#00FFFF","#C864FF","#FFFF00","#FF0000","#FFFFFF"],P9=({watchlists:s,selectedWatchlistId:e,onSelectWatchlist:r,onCreateWatchlist:n,onDeleteWatchlist:i,marketMovers:o,volumeLeaders:a})=>{const{ORANGE:l,WHITE:d,GRAY:p,GREEN:f,RED:h,CYAN:x,YELLOW:m,PANEL_BG:b}=xr,w=(y,C)=>{y.stopPropagation(),i(C)};return t.jsxs("div",{style:{width:"280px",backgroundColor:b,border:`1px solid ${p}`,padding:"4px",overflow:"auto",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{color:l,fontSize:"11px",fontWeight:"bold",marginBottom:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("span",{children:["WATCHLIST GROUPS (",s.length,")"]}),t.jsxs("button",{onClick:n,style:{background:"transparent",border:`1px solid ${l}`,color:l,padding:"2px 4px",fontSize:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"2px"},title:"Create new watchlist",children:[t.jsx(wn,{size:10}),"NEW"]})]}),t.jsx("div",{style:{borderBottom:`1px solid ${p}`,marginBottom:"8px"}}),t.jsx("div",{style:{flex:1,overflow:"auto",marginBottom:"8px"},children:s.length===0?t.jsxs("div",{style:{padding:"16px",textAlign:"center",color:p,fontSize:"10px"},children:["No watchlists yet.",t.jsx("br",{}),"Click NEW to create one."]}):s.map(y=>t.jsxs("div",{style:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px",marginBottom:"3px",backgroundColor:e===y.id?"rgba(255,165,0,0.1)":"rgba(255,255,255,0.02)",border:`1px solid ${e===y.id?l:"transparent"}`,cursor:"pointer",fontSize:"10px",fontFamily:"Consolas, monospace",transition:"all 0.2s"},onClick:()=>r(y.id),onMouseEnter:C=>{e!==y.id&&(C.currentTarget.style.backgroundColor="rgba(255,255,255,0.05)")},onMouseLeave:C=>{e!==y.id&&(C.currentTarget.style.backgroundColor="rgba(255,255,255,0.02)")},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:y.color,fontWeight:"bold",marginBottom:"2px"},children:y.name}),t.jsxs("div",{style:{color:x,fontSize:"9px"},children:[y.stock_count," stocks"]})]}),t.jsx("button",{onClick:C=>w(C,y.id),style:{background:"transparent",border:"none",color:h,cursor:"pointer",padding:"2px",display:"flex"},title:`Delete ${y.name}`,children:t.jsx(On,{size:12})})]},y.id))}),o&&o.gainers.length>0&&t.jsxs("div",{style:{borderTop:`1px solid ${p}`,marginTop:"8px",paddingTop:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:m,fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"MARKET MOVERS"}),o.gainers.slice(0,3).map((y,C)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"3px",marginBottom:"2px",backgroundColor:"rgba(255,255,255,0.02)",fontSize:"9px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:x},children:y.symbol}),t.jsx("span",{style:{color:p,marginLeft:"4px",fontSize:"8px"},children:"[GAINER]"})]}),t.jsxs("span",{style:{color:f,fontWeight:"bold"},children:["+",y.quote?.change_percent.toFixed(2),"%"]})]},`gainer-${C}`)),o.losers.slice(0,2).map((y,C)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"3px",marginBottom:"2px",backgroundColor:"rgba(255,255,255,0.02)",fontSize:"9px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:x},children:y.symbol}),t.jsx("span",{style:{color:p,marginLeft:"4px",fontSize:"8px"},children:"[LOSER]"})]}),t.jsxs("span",{style:{color:h,fontWeight:"bold"},children:[y.quote?.change_percent.toFixed(2),"%"]})]},`loser-${C}`))]}),a&&a.length>0&&t.jsxs("div",{style:{borderTop:`1px solid ${p}`,marginTop:"8px",paddingTop:"8px"},children:[t.jsx("div",{style:{color:m,fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"VOLUME LEADERS"}),a.slice(0,4).map((y,C)=>{const T=y.quote?.volume||0,E=T>=1e6?`${(T/1e6).toFixed(1)}M`:T>=1e3?`${(T/1e3).toFixed(1)}K`:T.toString();return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"3px",marginBottom:"2px",backgroundColor:"rgba(255,255,255,0.02)",fontSize:"9px"},children:[t.jsx("span",{style:{color:x},children:y.symbol}),t.jsx("span",{style:{color:d},children:E})]},`volume-${C}`)})]})]})},L9=({stocks:s,watchlistName:e,sortBy:r,onSortChange:n,onStockClick:i,onRemoveStock:o,selectedSymbol:a})=>{const{ORANGE:l,WHITE:d,GRAY:p,RED:f,YELLOW:h,CYAN:x,DARK_BG:m,PANEL_BG:b}=xr,w=(y,C)=>{y.stopPropagation(),confirm(`Remove ${C} from watchlist?`)&&o(C)};return t.jsxs("div",{style:{flex:1,backgroundColor:b,border:`1px solid ${p}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsxs("div",{style:{color:l,fontSize:"11px",fontWeight:"bold"},children:["WATCHLIST: ",e]}),t.jsxs("div",{style:{display:"flex",gap:"4px",fontSize:"9px"},children:[t.jsx("button",{onClick:()=>n("TICKER"),style:{padding:"2px 6px",backgroundColor:r==="TICKER"?l:m,color:r==="TICKER"?m:d,border:`1px solid ${p}`,cursor:"pointer",fontFamily:"Consolas, monospace",fontWeight:r==="TICKER"?"bold":"normal"},children:"TICKER"}),t.jsx("button",{onClick:()=>n("CHANGE"),style:{padding:"2px 6px",backgroundColor:r==="CHANGE"?l:m,color:r==="CHANGE"?m:d,border:`1px solid ${p}`,cursor:"pointer",fontFamily:"Consolas, monospace",fontWeight:r==="CHANGE"?"bold":"normal"},children:"CHANGE"}),t.jsx("button",{onClick:()=>n("VOLUME"),style:{padding:"2px 6px",backgroundColor:r==="VOLUME"?l:m,color:r==="VOLUME"?m:d,border:`1px solid ${p}`,cursor:"pointer",fontFamily:"Consolas, monospace",fontWeight:r==="VOLUME"?"bold":"normal"},children:"VOLUME"}),t.jsx("button",{onClick:()=>n("PRICE"),style:{padding:"2px 6px",backgroundColor:r==="PRICE"?l:m,color:r==="PRICE"?m:d,border:`1px solid ${p}`,cursor:"pointer",fontFamily:"Consolas, monospace",fontWeight:r==="PRICE"?"bold":"normal"},children:"PRICE"})]})]}),t.jsx("div",{style:{borderBottom:`1px solid ${p}`,marginBottom:"8px"}}),s.length===0?t.jsxs("div",{style:{padding:"32px",textAlign:"center",color:p,fontSize:"11px"},children:[t.jsx("div",{style:{marginBottom:"8px",fontSize:"12px"},children:"No stocks in this watchlist yet"}),t.jsx("div",{children:'Click "ADD STOCK" to add stocks'})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"100px 90px 90px 90px 50px",gap:"4px",padding:"4px",backgroundColor:"rgba(255,255,255,0.05)",fontSize:"9px",fontWeight:"bold",marginBottom:"2px"},children:[t.jsx("div",{style:{color:p},children:"SYMBOL"}),t.jsx("div",{style:{color:p},children:"PRICE"}),t.jsx("div",{style:{color:p},children:"CHANGE"}),t.jsx("div",{style:{color:p},children:"VOLUME"}),t.jsx("div",{style:{color:p},children:"ACTION"})]}),s.map(y=>{const C=y.quote,T=a===y.symbol;return t.jsxs("div",{onClick:()=>i(y),style:{display:"grid",gridTemplateColumns:"100px 90px 90px 90px 50px",gap:"4px",padding:"8px 4px",backgroundColor:T?"rgba(255,165,0,0.1)":"rgba(255,255,255,0.02)",borderLeft:`3px solid ${C?Qf(C.change):p}`,fontSize:"10px",marginBottom:"1px",cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:E=>{T||(E.currentTarget.style.backgroundColor="rgba(255,255,255,0.05)")},onMouseLeave:E=>{T||(E.currentTarget.style.backgroundColor="rgba(255,255,255,0.02)")},children:[t.jsx("div",{style:{color:x,fontWeight:"bold",letterSpacing:"0.5px"},children:y.symbol}),C?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{color:d,fontWeight:"bold"},children:hl(C.price)}),t.jsxs("div",{children:[t.jsx("div",{style:{color:Qf(C.change)},children:hl(C.change)}),t.jsxs("div",{style:{color:Qf(C.change_percent),fontSize:"8px"},children:["(",N2(C.change_percent),")"]})]}),t.jsx("div",{style:{color:h},children:O2(C.volume)})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{color:p},children:"N/A"}),t.jsx("div",{style:{color:p},children:"N/A"}),t.jsx("div",{style:{color:p},children:"N/A"})]}),t.jsx("div",{children:t.jsx("button",{onClick:E=>w(E,y.symbol),style:{background:"transparent",border:"none",color:f,cursor:"pointer",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center"},title:`Remove ${y.symbol}`,children:t.jsx(On,{size:14})})})]},y.id)})]})]})},z9=({stock:s})=>{const{ORANGE:e,WHITE:r,GRAY:n,GREEN:i,RED:o,YELLOW:a,CYAN:l,PANEL_BG:d}=xr;if(!s)return t.jsxs("div",{style:{width:"320px",backgroundColor:d,border:`1px solid ${n}`,padding:"12px",overflow:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:n,fontSize:"11px",textAlign:"center"},children:[t.jsx("div",{style:{marginBottom:"8px",fontSize:"12px"},children:"NO STOCK SELECTED"}),t.jsx("div",{children:"Click on a stock to view details"})]});const p=s.quote;return t.jsxs("div",{style:{width:"320px",backgroundColor:d,border:`1px solid ${n}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:["STOCK DETAIL: ",s.symbol]}),t.jsx("div",{style:{borderBottom:`1px solid ${n}`,marginBottom:"8px"}}),p?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{marginBottom:"12px"},children:t.jsxs("div",{style:{padding:"6px",backgroundColor:"rgba(255,165,0,0.1)",marginBottom:"4px"},children:[t.jsx("div",{style:{color:n,fontSize:"9px",marginBottom:"2px"},children:"LAST PRICE"}),t.jsx("div",{style:{color:r,fontSize:"20px",fontWeight:"bold"},children:hl(p.price)}),t.jsxs("div",{style:{color:Qf(p.change),fontSize:"12px"},children:[hl(p.change)," (",N2(p.change_percent),")"]})]})}),t.jsxs("div",{style:{fontSize:"9px",lineHeight:"1.5",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:n},children:"Open:"}),t.jsx("span",{style:{color:r},children:hl(p.open)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:n},children:"Prev Close:"}),t.jsx("span",{style:{color:r},children:hl(p.previous_close)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:n},children:"Day High:"}),t.jsx("span",{style:{color:i},children:hl(p.high)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:n},children:"Day Low:"}),t.jsx("span",{style:{color:o},children:hl(p.low)})]}),t.jsx("div",{style:{borderTop:`1px solid ${n}`,marginTop:"4px",paddingTop:"4px"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:n},children:"Volume:"}),t.jsx("span",{style:{color:a},children:O2(p.volume)})]})})]}),s.notes&&t.jsxs("div",{style:{borderTop:`1px solid ${n}`,paddingTop:"8px",marginTop:"8px"},children:[t.jsx("div",{style:{color:a,fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"NOTES"}),t.jsx("div",{style:{fontSize:"9px",color:r,backgroundColor:"rgba(255,255,255,0.05)",padding:"6px",borderLeft:`2px solid ${l}`,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s.notes})]}),t.jsxs("div",{style:{borderTop:`1px solid ${n}`,paddingTop:"8px",marginTop:"12px",fontSize:"8px",color:n,textAlign:"center"},children:["Last Updated: ",new Date(p.timestamp*1e3).toLocaleString()]})]}):t.jsx("div",{style:{padding:"16px",textAlign:"center",color:o,fontSize:"10px"},children:"Failed to load market data"})]})},M9=({onClose:s,onCreate:e,existingColors:r})=>{const[n,i]=S.useState(""),[o,a]=S.useState(""),[l,d]=S.useState(h0.find(x=>!r.includes(x))||h0[0]),[p,f]=S.useState(!1),h=async()=>{if(!n.trim()){alert("Please enter a watchlist name");return}f(!0);try{await e(n.trim(),o.trim(),l),s()}catch(x){console.error("Error creating watchlist:",x),alert("Failed to create watchlist")}finally{f(!1)}};return t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:xr.DARK_BG,border:`2px solid ${xr.ORANGE}`,padding:"24px",minWidth:"400px",maxWidth:"500px"},children:[t.jsx("div",{style:{color:xr.ORANGE,fontSize:"14px",fontWeight:"bold",marginBottom:"16px"},children:"CREATE NEW WATCHLIST"}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:xr.GRAY,fontSize:"10px",display:"block",marginBottom:"4px"},children:"WATCHLIST NAME *"}),t.jsx("input",{type:"text",value:n,onChange:x=>i(x.target.value),style:{width:"100%",background:xr.PANEL_BG,border:`1px solid ${xr.GRAY}`,color:xr.WHITE,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"},placeholder:"My Watchlist",maxLength:50})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:xr.GRAY,fontSize:"10px",display:"block",marginBottom:"4px"},children:"DESCRIPTION"}),t.jsx("textarea",{value:o,onChange:x=>a(x.target.value),style:{width:"100%",background:xr.PANEL_BG,border:`1px solid ${xr.GRAY}`,color:xr.WHITE,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace",resize:"vertical",minHeight:"60px"},placeholder:"Optional description...",maxLength:200})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:xr.GRAY,fontSize:"10px",display:"block",marginBottom:"8px"},children:"COLOR"}),t.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:h0.map(x=>t.jsx("button",{onClick:()=>d(x),style:{width:"32px",height:"32px",backgroundColor:x,border:l===x?`3px solid ${xr.WHITE}`:`1px solid ${xr.GRAY}`,cursor:"pointer",borderRadius:"2px"},title:x},x))})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:s,disabled:p,style:{background:xr.GRAY,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:p?"not-allowed":"pointer",opacity:p?.5:1},children:"CANCEL"}),t.jsx("button",{onClick:h,disabled:p||!n.trim(),style:{background:!n.trim()||p?xr.GRAY:xr.ORANGE,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:!n.trim()||p?"not-allowed":"pointer"},children:p?"CREATING...":"CREATE"})]})]})})},B9=({onClose:s,onAdd:e,existingSymbols:r})=>{const[n,i]=S.useState(""),[o,a]=S.useState(""),[l,d]=S.useState(!1),p=async()=>{const h=n.trim().toUpperCase();if(!h){alert("Please enter a stock symbol");return}if(r.includes(h)){alert(`${h} is already in this watchlist`);return}d(!0);try{await e(h,o.trim()),s()}catch(x){console.error("Error adding stock:",x),alert(x instanceof Error?x.message:"Failed to add stock")}finally{d(!1)}},f=h=>{h.key==="Enter"&&!l&&n.trim()&&p()};return t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:xr.DARK_BG,border:`2px solid ${xr.GREEN}`,padding:"24px",minWidth:"400px"},children:[t.jsx("div",{style:{color:xr.GREEN,fontSize:"14px",fontWeight:"bold",marginBottom:"16px"},children:"ADD STOCK TO WATCHLIST"}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:xr.GRAY,fontSize:"10px",display:"block",marginBottom:"4px"},children:"SYMBOL *"}),t.jsx("input",{type:"text",value:n,onChange:h=>i(h.target.value.toUpperCase()),onKeyPress:f,style:{width:"100%",background:xr.PANEL_BG,border:`1px solid ${xr.GRAY}`,color:xr.WHITE,padding:"8px",fontSize:"14px",fontFamily:"Consolas, monospace",textTransform:"uppercase",fontWeight:"bold",letterSpacing:"1px"},placeholder:"AAPL",maxLength:10,autoFocus:!0}),t.jsx("div",{style:{color:xr.GRAY,fontSize:"9px",marginTop:"4px"},children:"Enter stock ticker symbol (e.g., AAPL, MSFT, GOOGL)"})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:xr.GRAY,fontSize:"10px",display:"block",marginBottom:"4px"},children:"NOTES (OPTIONAL)"}),t.jsx("textarea",{value:o,onChange:h=>a(h.target.value),style:{width:"100%",background:xr.PANEL_BG,border:`1px solid ${xr.GRAY}`,color:xr.WHITE,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace",resize:"vertical",minHeight:"60px"},placeholder:"Add notes about this stock...",maxLength:200})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:s,disabled:l,style:{background:xr.GRAY,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:l?"not-allowed":"pointer",opacity:l?.5:1},children:"CANCEL"}),t.jsx("button",{onClick:p,disabled:l||!n.trim(),style:{background:!n.trim()||l?xr.GRAY:xr.GREEN,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:!n.trim()||l?"not-allowed":"pointer"},children:l?"ADDING...":"ADD STOCK"})]})]})})},F9=()=>{const{colors:s}=Er(),e=R2(),[r,n]=S.useState(new Date),[i,o]=S.useState([]),[a,l]=S.useState(null),[d,p]=S.useState([]),[f,h]=S.useState(null),[x,m]=S.useState(!1),[b,w]=S.useState(!1),[y,C]=S.useState("CHANGE"),[T,E]=S.useState(!1),[j,k]=S.useState(!1),[A,R]=S.useState(!1),M=async()=>{if(a&&d.length>0)try{const de={watchlistId:a.id,watchlistName:a.name,stocks:d.map(je=>({symbol:je.symbol,quote:je.quote,notes:je.notes})),timestamp:new Date().toISOString()};console.log("[WatchlistTab] Recording current data:",de),await qn.recordApiResponse("Watchlist","watchlist-stocks",de,`Watchlist (Snapshot): ${a.name} - ${new Date().toLocaleString()}`,["watchlist","stocks","snapshot"]),console.log("[WatchlistTab] Current data recorded successfully")}catch(de){console.error("[WatchlistTab] Failed to record current data:",de)}},[P,I]=S.useState(null),[O,G]=S.useState([]),{ORANGE:B,WHITE:F,GREEN:z,GRAY:$,DARK_BG:W,PANEL_BG:D,CYAN:oe,YELLOW:Z}=e;S.useEffect(()=>{(async()=>{m(!0);try{await Zs.initialize(),await fe()}catch(je){console.error("[WatchlistTab] Initialization error:",je)}finally{m(!1)}})()},[]),S.useEffect(()=>{const de=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(de)},[]),S.useEffect(()=>{if(a){const de=setInterval(()=>{Y()},6e5);return()=>clearInterval(de)}},[a]);const fe=async()=>{try{const de=await Zs.getWatchlistsWithCounts();o(de),de.length>0&&!a&&l(de[0])}catch(de){console.error("[WatchlistTab] Error loading watchlists:",de)}},Q=async de=>{try{w(!0);const je=await Zs.getWatchlistStocksWithQuotes(de);if(p(je),f){const _e=je.find(Re=>Re.symbol===f.symbol);_e&&h(_e)}if(A&&a)try{const _e={watchlistId:de,watchlistName:a.name,stocks:je.map(Re=>({symbol:Re.symbol,quote:Re.quote,notes:Re.notes})),timestamp:new Date().toISOString()};await qn.recordApiResponse("Watchlist","watchlist-stocks",_e,`Watchlist: ${a.name} - ${new Date().toLocaleString()}`,["watchlist","stocks","quotes"])}catch(_e){console.error("[WatchlistTab] Failed to record data:",_e)}}catch(je){console.error("[WatchlistTab] Error loading stocks:",je)}finally{w(!1)}},_=async()=>{try{const[de,je]=await Promise.all([Zs.getMarketMovers(5),Zs.getVolumeLeaders(5)]);I(de),G(je)}catch(de){console.error("[WatchlistTab] Error loading market data:",de)}},Y=()=>{a&&(Q(a.id),_())};S.useEffect(()=>{a&&(Q(a.id),_())},[a]);const he=async(de,je,_e)=>{try{const Re=await Zs.createWatchlist(de,je,_e);await fe();const Se=(await Zs.getWatchlistsWithCounts()).find(ie=>ie.id===Re.id);Se&&l(Se)}catch(Re){throw console.error("[WatchlistTab] Error creating watchlist:",Re),Re}},me=async de=>{if(confirm("Are you sure you want to delete this watchlist? This action cannot be undone."))try{await Zs.deleteWatchlist(de),await fe(),a?.id===de&&(l(i.length>1?i[0]:null),p([]),h(null))}catch(je){console.error("[WatchlistTab] Error deleting watchlist:",je),alert("Failed to delete watchlist")}},ge=async(de,je)=>{if(a)try{await Zs.addStock(a.id,de,je),await Q(a.id),await fe()}catch(_e){throw console.error("[WatchlistTab] Error adding stock:",_e),_e}},le=async de=>{if(a)try{await Zs.removeStock(a.id,de),await Q(a.id),await fe(),f?.symbol===de&&h(null)}catch(je){console.error("[WatchlistTab] Error removing stock:",je),alert("Failed to remove stock")}},X=async()=>{if(a)try{const de=await Zs.exportWatchlistCSV(a.id),je=new Blob([de],{type:"text/csv"}),_e=URL.createObjectURL(je),Re=document.createElement("a");Re.href=_e,Re.download=`${a.name.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),URL.revokeObjectURL(_e)}catch(de){console.error("[WatchlistTab] Error exporting CSV:",de),alert("Failed to export CSV")}},V=I9(d,y);return t.jsxs("div",{style:{height:"100%",backgroundColor:W,color:F,fontFamily:"Consolas, monospace",overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar { width: 8px; height: 8px; }
        *::-webkit-scrollbar-track { background: #1a1a1a; }
        *::-webkit-scrollbar-thumb { background: #404040; border-radius: 4px; }
        *::-webkit-scrollbar-thumb:hover { background: #525252; }
      `}),t.jsxs("div",{style:{backgroundColor:D,borderBottom:`1px solid ${$}`,padding:"8px 12px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:B,fontWeight:"bold",fontSize:"14px"},children:"FINCEPT WATCHLIST MONITOR"}),t.jsx("span",{style:{color:F},children:"|"}),t.jsxs("span",{style:{color:b?B:z,fontSize:"10px"},children:[" ",b?"UPDATING":"LIVE"]}),t.jsx("span",{style:{color:F},children:"|"}),t.jsx(Tl,{compact:!0})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.jsx(Sv,{tabName:"Watchlist",onRecordingChange:R,onRecordingStart:M}),t.jsxs("button",{onClick:Y,disabled:!a||b,style:{background:a&&!b?z:$,color:"black",border:"none",padding:"4px 12px",fontSize:"10px",fontWeight:"bold",cursor:a&&!b?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"4px",opacity:a&&!b?1:.5},children:[t.jsx(xn,{size:12}),"REFRESH"]}),t.jsxs("button",{onClick:X,disabled:!a,style:{background:a?oe:$,color:"black",border:"none",padding:"4px 12px",fontSize:"10px",fontWeight:"bold",cursor:a?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"4px",opacity:a?1:.5},children:[t.jsx(Mi,{size:12}),"EXPORT CSV"]})]})]}),a&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"11px",marginTop:"8px"},children:[t.jsx("span",{style:{color:$},children:"WATCHLIST:"}),t.jsx("span",{style:{color:Z,fontWeight:"bold"},children:a.name}),t.jsx("span",{style:{color:F},children:"|"}),t.jsx("span",{style:{color:$},children:"STOCKS:"}),t.jsx("span",{style:{color:oe},children:d.length})]})]}),t.jsx("div",{style:{backgroundColor:D,borderBottom:`1px solid ${$}`,padding:"4px 8px",flexShrink:0},children:t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"4px"},children:[{key:"F1",label:"ADD STOCK",action:()=>k(!0)},{key:"F2",label:"REFRESH",action:Y},{key:"F3",label:"EXPORT",action:X},{key:"F4",label:"SORT",action:()=>C("CHANGE")},{key:"F5",label:"CREATE",action:()=>E(!0)},{key:"F6",label:"TICKER",action:()=>C("TICKER")},{key:"F7",label:"PRICE",action:()=>C("PRICE")},{key:"F8",label:"VOLUME",action:()=>C("VOLUME")},{key:"F9",label:"UNUSED",action:()=>{}},{key:"F10",label:"UNUSED",action:()=>{}},{key:"F11",label:"UNUSED",action:()=>{}},{key:"F12",label:"HELP",action:()=>{}}].map(de=>t.jsxs("button",{onClick:()=>{(de.label==="ADD STOCK"||de.label==="CREATE"||a)&&de.action()},disabled:!a&&de.label!=="CREATE",style:{backgroundColor:W,border:`1px solid ${$}`,color:F,padding:"4px 6px",fontSize:"9px",cursor:a||de.label==="CREATE"?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",opacity:!a&&de.label!=="CREATE"?.5:1},children:[t.jsxs("span",{style:{color:Z},children:[de.key,":"]}),t.jsx("span",{children:de.label})]},de.key))})}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsx(P9,{watchlists:i,selectedWatchlistId:a?.id||null,onSelectWatchlist:de=>{const je=i.find(_e=>_e.id===de);je&&l(je)},onCreateWatchlist:()=>E(!0),onDeleteWatchlist:me,marketMovers:P||void 0,volumeLeaders:O}),a?t.jsx(L9,{stocks:V,watchlistName:a.name,sortBy:y,onSortChange:C,onStockClick:h,onRemoveStock:le,selectedSymbol:f?.symbol}):t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px"},children:t.jsx("div",{style:{color:$,fontSize:"14px"},children:"Select a watchlist or create a new one to get started"})}),t.jsx(z9,{stock:f})]}),t.jsx("div",{style:{borderTop:`1px solid ${$}`,backgroundColor:D,padding:"4px 12px",fontSize:"9px",color:$,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{children:"Fincept Watchlist Monitor v2.0.0 | Real-time tracking with yfinance integration"}),a&&t.jsxs("span",{children:["Watchlist: ",a.name," | Stocks: ",d.length," | Status: ",t.jsx("span",{style:{color:z},children:"CONNECTED"})]})]})}),T&&t.jsx(M9,{onClose:()=>E(!1),onCreate:he,existingColors:i.map(de=>de.color)}),j&&a&&t.jsx(B9,{onClose:()=>k(!1),onAdd:ge,existingSymbols:d.map(de=>de.symbol)})]})};class $9{constructor(){Pe(this,"wtoApiKey","d7a9d5f751404d189deb99efcb855d12")}async getWTOQRNotifications(){try{const e=await lt("execute_wto_command",{command:"qr_notifications",args:[this.wtoApiKey]}),r=typeof e=="string"?JSON.parse(e):e;return Ji.debug("QR raw:",r),r}catch(e){return Ji.error("Failed to fetch WTO QR notifications:",e),null}}async getWTOEPingNotifications(e=20){try{const r=await lt("execute_wto_command",{command:"eping_search",args:[`--page_size=${e}`,this.wtoApiKey]}),n=typeof r=="string"?JSON.parse(r):r;return Ji.debug("ePing raw:",n),n}catch(r){return Ji.error("Failed to fetch WTO ePing notifications:",r),null}}async getWTOTimeseriesData(e,r,n){try{const i=await lt("execute_wto_command",{command:"timeseries_data",args:[`--i=${e}`,`--reporters=${r}`,`--periods=${n}`,this.wtoApiKey]}),o=typeof i=="string"?JSON.parse(i):i;return Ji.debug("Tariff raw:",o),o}catch(i){return Ji.error("Failed to fetch WTO timeseries data:",i),null}}async getWTOQRList(e){try{const r=await lt("execute_wto_command",{command:"qr_list",args:[`--reporter_member_code=${e}`,this.wtoApiKey]});return typeof r=="string"?JSON.parse(r):r}catch(r){return Ji.error("Failed to fetch WTO QR list:",r),null}}async getWTOQRProducts(e="2017"){try{const r=await lt("execute_wto_command",{command:"qr_products",args:[`--hs_version=${e}`,this.wtoApiKey]});return typeof r=="string"?JSON.parse(r):r}catch(r){return Ji.error("Failed to fetch WTO QR products:",r),null}}async getWTOReporters(){try{const e=await lt("execute_wto_command",{command:"timeseries_reporters",args:[this.wtoApiKey]});return typeof e=="string"?JSON.parse(e):e}catch(e){return Ji.error("Failed to fetch WTO reporters:",e),null}}async getWTOPartners(){try{const e=await lt("execute_wto_command",{command:"timeseries_partners",args:[this.wtoApiKey]});return typeof e=="string"?JSON.parse(e):e}catch(e){return Ji.error("Failed to fetch WTO partners:",e),null}}async getWTOTFAD(e){try{const r=await lt("execute_wto_command",{command:"tfad_data",args:[`--countries=${e}`,this.wtoApiKey]});return typeof r=="string"?JSON.parse(r):r}catch(r){return Ji.error("Failed to fetch WTO TFAD data:",r),null}}async getWTOTradeFlow(e,r,n,i){try{const o=await lt("execute_wto_command",{command:"timeseries_data",args:[`--i=${e}`,`--reporters=${r}`,`--partners=${n}`,`--periods=${i}`,this.wtoApiKey]});return typeof o=="string"?JSON.parse(o):o}catch(o){return Ji.error("Failed to fetch WTO trade flow data:",o),null}}async getComprehensiveGeopoliticsData(e="840"){const r=new Date().getFullYear(),[n,i,o,a,l,d,p,f,h]=await Promise.all([this.getWTOQRNotifications(),this.getWTOEPingNotifications(50),this.getWTOTimeseriesData("TP_A_0010",e,`${r-10}-${r-1}`),this.getWTOQRList(e),this.getWTOQRProducts("2017"),this.getWTOTFAD(e),this.getWTOTradeFlow("ITS_MTV_AM",e,"all",`${r-5}-${r-1}`),this.getWTOReporters(),this.getWTOPartners()]),x=n?.data?.data||[],m=i?.data?.items||[],b=o?.data?.Dataset||[],w=a?.data?.data||[],y=l?.data?.data||[],C=d?.data||null,T=p?.data?.Dataset||[],E=f?.data||[],j=h?.data||[];return{tariffData:b,qrNotifications:x,epingNotifications:m,qrRestrictions:w,qrProducts:y,tradeFlowData:T,tfadData:C,tradeIndicators:[],reporters:E,partners:j}}}const G9=new $9,U9=()=>{const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState(new Date),[l,d]=S.useState(!0),[p,f]=S.useState([]),[h,x]=S.useState([]),[m,b]=S.useState([]),[w,y]=S.useState([]),[C,T]=S.useState([]),[E,j]=S.useState([]),[k,A]=S.useState(null),[R,M]=S.useState("840"),[P,I]=S.useState(null),[O,G]=S.useState(null),[B,F]=S.useState(null),z=[{code:"840",name:"United States"},{code:"156",name:"China"},{code:"276",name:"Germany"},{code:"392",name:"Japan"},{code:"826",name:"United Kingdom"},{code:"356",name:"India"},{code:"124",name:"Canada"},{code:"076",name:"Brazil"},{code:"036",name:"Australia"}];S.useEffect(()=>{const ge=setInterval(()=>a(new Date),2e3);return()=>clearInterval(ge)},[]),S.useEffect(()=>{$()},[R]);const $=async()=>{try{d(!0);const ge=await G9.getComprehensiveGeopoliticsData(R);f(ge.qrNotifications),x(ge.epingNotifications),b(ge.tariffData),y(ge.qrRestrictions),T(ge.qrProducts),j(ge.tradeFlowData),A(ge.tfadData)}catch(ge){console.error("Failed to load geopolitics data:",ge)}finally{d(!1)}},W=()=>{const ge=p.length;let le=0;ge>0&&(le=Math.min(2+ge/50*8,10));let X=0;if(m.length>0){const Re=m.map($e=>$e.Value||0),Be=Re[Re.length-1]||0,Se=Re[Re.length-2]||Be,ie=Be-Se,ve=Math.min(Be/20*7,7);let Ae=0;ie>.5?Ae=3:ie>.1?Ae=1.5:ie<-.5?Ae=-2:ie<-.1&&(Ae=-1),X=Math.max(0,Math.min(ve+Ae,10))}let V=0;if(h.length>0){const Re=Math.min(h.length/100*4,4),Be=new Date,Se=h.filter($e=>{if(!$e.commentDeadlineDate)return!1;const Ie=(new Date($e.commentDeadlineDate).getTime()-Be.getTime())/(1e3*60*60*24);return Ie>0&&Ie<=60}).length,ie=Math.min(Se/20*3,3),ve=h.filter($e=>$e.objectives?.some(qe=>qe.name?.toLowerCase().includes("health")||qe.name?.toLowerCase().includes("safety"))).length,Ae=Math.min(ve/10*3,3);V=Math.min(Re+ie+Ae,10)}let de=0;const je=new Set(h.flatMap(Re=>(Re.countriesAffected||[]).map(Be=>Be.id||Be.name))).size;if(je>0){de=Math.min(je/50*6,6);const Re=h.filter(Se=>Se.area==="SPS").length,Be=h.length>0?Re/h.length:0;de+=Be*4,de=Math.min(de,10)}let _e=0;if(p.length>0||m.length>0){const Re=p.filter(ie=>{if(!ie.notification_dt)return!1;const ve=new Date(ie.notification_dt);return(new Date().getTime()-ve.getTime())/(1e3*60*60*24*30)<=12}).length,Be=Math.min(Re/20*5,5);let Se=0;if(m.length>=3){const ie=m.slice(-3).map(Ae=>Ae.Value||0),ve=Math.max(...ie)-Math.min(...ie);Se=Math.min(ve/5*5,5)}_e=Math.min(Be+Se,10)}return[{threat:"Trade Restrictions",current:Number(le.toFixed(1)),max:10},{threat:"Tariff Pressure",current:Number(X.toFixed(1)),max:10},{threat:"Regulatory Burden",current:Number(V.toFixed(1)),max:10},{threat:"Market Access",current:Number(de.toFixed(1)),max:10},{threat:"Supply Chain",current:Number(_e.toFixed(1)),max:10}]},D=()=>{if(m.length===0)return{min:0,max:0,avg:0,latest:0,change:0};const ge=m.map(Re=>Re.Value||0),le=Math.min(...ge),X=Math.max(...ge),V=ge.reduce((Re,Be)=>Re+Be,0)/ge.length,de=ge[ge.length-1],je=ge[ge.length-2]||de,_e=de-je;return{min:le,max:X,avg:V,latest:de,change:_e}},oe=()=>h.filter(ge=>ge.commentDeadlineDate||ge.proposedEntryIntoForceDate).map(ge=>({title:ge.documentSymbol||"N/A",member:ge.notifyingMember||"N/A",commentDeadline:ge.commentDeadlineDate,entryIntoForce:ge.proposedEntryIntoForceDate,area:ge.area})).slice(0,10),Z=()=>{const ge={};return h.forEach(le=>{le.countriesAffected&&Array.isArray(le.countriesAffected)&&le.countriesAffected.forEach(X=>{const V=X.name||X.id||"Unknown";ge[V]=(ge[V]||0)+1})}),Object.entries(ge).map(([le,X])=>({name:le,count:X})).sort((le,X)=>X.count-le.count).slice(0,10)},fe=()=>{const ge={};return h.forEach(le=>{const X=le.area||"Unknown";ge[X]=(ge[X]||0)+1}),Object.entries(ge).map(([le,X])=>({name:le,value:X}))},Q=W(),_=D(),Y=oe(),he=Z(),me=fe();return l?t.jsx("div",{style:{height:"100%",backgroundColor:s.background,display:"flex",alignItems:"center",justifyContent:"center",color:s.text,fontFamily:r},children:"Loading geopolitical intelligence data..."}):t.jsxs("div",{style:{height:"100%",backgroundColor:s.background,color:s.text,fontFamily:r,fontWeight:n,fontStyle:i,overflow:"hidden",display:"flex",flexDirection:"column",fontSize:e.body},children:[t.jsx("div",{style:{backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,padding:"8px",flexShrink:0},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"14px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:s.primary,fontWeight:"bold"},children:"GEOPOLITICAL INTELLIGENCE"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.secondary},children:" LIVE"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("select",{value:R,onChange:ge=>M(ge.target.value),style:{backgroundColor:s.background,color:s.text,border:`1px solid ${s.textMuted}`,padding:"2px 8px",fontSize:"12px",borderRadius:"2px",cursor:"pointer"},children:z.map(ge=>t.jsx("option",{value:ge.code,children:ge.name},ge.code))}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:s.info},children:["QR: ",p.length]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:s.warning},children:["ePing: ",h.length]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:s.text},children:[o.toISOString().substring(0,19)," UTC"]})]}),t.jsx("button",{onClick:$,disabled:l,style:{backgroundColor:l?s.textMuted:s.primary,color:s.background,border:"none",padding:"4px 12px",fontSize:"12px",cursor:l?"not-allowed":"pointer",borderRadius:"2px",fontWeight:"bold"},children:l?"LOADING...":" REFRESH"})]})}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"8px",backgroundColor:"#050505"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px",marginBottom:"8px"},children:[t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"TARIFF STATISTICS"}),t.jsxs("div",{style:{fontSize:"10px",lineHeight:"1.6"},children:[t.jsxs("div",{children:["Latest: ",t.jsxs("span",{style:{color:s.secondary,fontWeight:"bold"},children:[_.latest.toFixed(2),"%"]})]}),t.jsxs("div",{children:["Avg: ",t.jsxs("span",{style:{color:s.text},children:[_.avg.toFixed(2),"%"]})]}),t.jsxs("div",{children:["Min: ",t.jsxs("span",{style:{color:s.success},children:[_.min.toFixed(2),"%"]})]}),t.jsxs("div",{children:["Max: ",t.jsxs("span",{style:{color:s.alert},children:[_.max.toFixed(2),"%"]})]}),t.jsxs("div",{children:["Change: ",t.jsxs("span",{style:{color:_.change>=0?s.alert:s.success},children:[_.change>=0?"+":"",_.change.toFixed(2),"%"]})]})]})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"QR RESTRICTIONS"}),t.jsxs("div",{style:{fontSize:"10px",lineHeight:"1.6"},children:[t.jsxs("div",{children:["Total: ",t.jsx("span",{style:{color:s.warning,fontWeight:"bold"},children:p.length})]}),t.jsx("div",{children:"Type: Complete Notifications"}),t.jsx("div",{children:"Coverage: Global"}),t.jsx("div",{children:"Updated: Live"})]})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"REGULATORY ALERTS"}),t.jsxs("div",{style:{fontSize:"10px",lineHeight:"1.6"},children:[t.jsxs("div",{children:["Total: ",t.jsx("span",{style:{color:s.info,fontWeight:"bold"},children:h.length})]}),t.jsxs("div",{children:["SPS: ",h.filter(ge=>ge.area==="SPS").length]}),t.jsxs("div",{children:["TBT: ",h.filter(ge=>ge.area==="TBT").length]}),t.jsxs("div",{children:["Pending Comments: ",h.filter(ge=>ge.commentDeadlineDate).length]})]})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"THREAT LEVEL"}),t.jsx("div",{style:{fontSize:"10px",lineHeight:"1.6"},children:Q.map(ge=>t.jsxs("div",{children:[ge.threat,": ",t.jsxs("span",{style:{color:ge.current>7?s.alert:ge.current>5?s.warning:s.success,fontWeight:"bold"},children:[ge.current.toFixed(1),"/10"]})]},ge.threat))})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"8px",marginBottom:"8px",height:"280px"},children:[t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px"},children:[t.jsxs("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:["MFN TARIFF RATES - ",z.find(ge=>ge.code===R)?.name.toUpperCase()]}),t.jsx(ml,{width:"100%",height:230,children:t.jsxs(tg,{data:m,children:[t.jsx(vd,{strokeDasharray:"3 3",stroke:s.textMuted,opacity:.3}),t.jsx(bl,{dataKey:"Year",stroke:s.text,fontSize:9}),t.jsx(vl,{stroke:s.text,fontSize:9}),t.jsx(Sl,{contentStyle:{backgroundColor:s.background,border:`1px solid ${s.textMuted}`,color:s.text,fontSize:"10px"}}),t.jsx(rg,{type:"monotone",dataKey:"Value",stroke:s.secondary,strokeWidth:2,name:"Tariff %"})]})})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"THREAT RADAR"}),t.jsx(ml,{width:"100%",height:230,children:t.jsxs(GI,{data:Q,children:[t.jsx(UI,{stroke:s.textMuted}),t.jsx(WI,{dataKey:"threat",tick:{fontSize:9,fill:s.text}}),t.jsx(qI,{angle:90,domain:[0,10],tick:{fontSize:8,fill:s.textMuted}}),t.jsx(HI,{dataKey:"current",stroke:s.alert,fill:s.alert,fillOpacity:.3,strokeWidth:2})]})})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"NOTIFICATION TYPES"}),t.jsx(ml,{width:"100%",height:230,children:t.jsxs(aA,{data:me,children:[t.jsx(vd,{strokeDasharray:"3 3",stroke:s.textMuted,opacity:.3}),t.jsx(bl,{dataKey:"name",stroke:s.text,fontSize:9}),t.jsx(vl,{stroke:s.text,fontSize:9}),t.jsx(Sl,{contentStyle:{backgroundColor:s.background,border:`1px solid ${s.textMuted}`,color:s.text,fontSize:"10px"}}),t.jsx(lA,{dataKey:"value",fill:s.info})]})})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"8px",height:"320px"},children:[t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"QR NOTIFICATIONS DETAILS"}),p.slice(0,20).map((ge,le)=>t.jsxs("div",{style:{marginBottom:"8px",fontSize:"10px",borderLeft:`2px solid ${s.warning}`,paddingLeft:"6px",backgroundColor:P===le?"rgba(255,255,255,0.05)":le%2===0?"rgba(255,255,255,0.02)":"transparent",cursor:"pointer"},onClick:()=>I(P===le?null:le),children:[t.jsx("div",{style:{color:s.text,fontWeight:"bold"},children:ge.reporter_member?.name?.en||ge.reporter_member?.code||"N/A"}),t.jsxs("div",{style:{color:s.textMuted,fontSize:"9px"},children:[ge.document_symbol||"N/A"," | ",ge.notification_dt||"N/A"]}),P===le&&t.jsxs("div",{style:{marginTop:"4px",fontSize:"9px",color:s.textMuted},children:[t.jsxs("div",{children:["Type: ",ge.type||"N/A"]}),t.jsxs("div",{children:["Language: ",ge.original_language||"N/A"]}),t.jsxs("div",{children:["Periods: ",ge.covered_periods?.join(", ")||"N/A"]}),ge.document_url&&t.jsx("a",{href:ge.document_url,target:"_blank",rel:"noopener noreferrer",style:{color:s.info,textDecoration:"underline"},children:"View Document"})]})]},le))]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"EPING NOTIFICATIONS DETAILS"}),h.slice(0,20).map((ge,le)=>t.jsxs("div",{style:{marginBottom:"8px",fontSize:"10px",borderLeft:`2px solid ${ge.area==="SPS"?s.success:s.info}`,paddingLeft:"6px",backgroundColor:O===le?"rgba(255,255,255,0.05)":le%2===0?"rgba(255,255,255,0.02)":"transparent",cursor:"pointer"},onClick:()=>G(O===le?null:le),children:[t.jsx("div",{style:{color:s.text,fontWeight:"bold"},children:ge.documentSymbol?.trim()||"N/A"}),t.jsxs("div",{style:{color:s.textMuted,fontSize:"9px"},children:[ge.notifyingMember," | ",ge.area," | ",ge.distributionDate?.substring(0,10)]}),O===le&&t.jsxs("div",{style:{marginTop:"4px",fontSize:"9px",color:s.textMuted},children:[t.jsxs("div",{style:{marginBottom:"2px",fontWeight:"bold"},children:[ge.titlePlain?.substring(0,100),"..."]}),t.jsxs("div",{children:["Type: ",ge.notificationType||"N/A"]}),ge.commentDeadlineDate&&t.jsxs("div",{children:["Comment Deadline: ",ge.commentDeadlineDate.substring(0,10)]}),ge.proposedEntryIntoForceDate&&t.jsxs("div",{children:["Entry into Force: ",ge.proposedEntryIntoForceDate.substring(0,10)]}),ge.keywords&&ge.keywords.length>0&&t.jsxs("div",{children:["Keywords: ",ge.keywords.map(X=>X.name).join(", ")]}),ge.objectives&&ge.objectives.length>0&&t.jsxs("div",{children:["Objectives: ",ge.objectives.map(X=>X.name).join(", ")]}),ge.linkToNotification&&t.jsx("a",{href:ge.linkToNotification,target:"_blank",rel:"noopener noreferrer",style:{color:s.info,textDecoration:"underline"},children:"View Document"})]})]},le))]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"UPCOMING DEADLINES"}),Y.length>0?Y.map((ge,le)=>t.jsxs("div",{style:{marginBottom:"8px",fontSize:"10px",borderLeft:`2px solid ${ge.area==="SPS"?s.success:s.info}`,paddingLeft:"6px",backgroundColor:le%2===0?"rgba(255,255,255,0.02)":"transparent"},children:[t.jsx("div",{style:{color:s.text,fontWeight:"bold"},children:ge.title}),t.jsxs("div",{style:{color:s.textMuted,fontSize:"9px"},children:[ge.member," | ",ge.area]}),ge.commentDeadline&&t.jsxs("div",{style:{color:s.warning,fontSize:"9px"},children:["Comment by: ",ge.commentDeadline.substring(0,10)]}),ge.entryIntoForce&&t.jsxs("div",{style:{color:s.alert,fontSize:"9px"},children:["Effective: ",ge.entryIntoForce.substring(0,10)]})]},le)):t.jsx("div",{style:{color:s.textMuted,fontSize:"10px"},children:"No upcoming deadlines"})]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"8px",height:"200px",marginBottom:"8px"},children:t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"AFFECTED COUNTRIES & REGIONS"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"8px"},children:he.length>0?he.map((ge,le)=>t.jsxs("div",{style:{padding:"6px",backgroundColor:"rgba(255,255,255,0.03)",border:`1px solid ${s.textMuted}`,fontSize:"10px"},children:[t.jsx("div",{style:{color:s.text,fontWeight:"bold"},children:ge.name}),t.jsxs("div",{style:{color:s.warning,fontSize:"9px"},children:[ge.count," notification",ge.count>1?"s":""]})]},le)):t.jsx("div",{style:{color:s.textMuted,fontSize:"10px",gridColumn:"1 / -1"},children:"No specific country restrictions identified"})})]})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",marginBottom:"8px",height:"320px"},children:[t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsxs("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:["ACTIVE QR RESTRICTIONS - ",z.find(ge=>ge.code===R)?.name.toUpperCase()]}),w.length>0?w.slice(0,20).map((ge,le)=>t.jsxs("div",{style:{marginBottom:"8px",fontSize:"10px",borderLeft:`2px solid ${s.alert}`,paddingLeft:"6px",backgroundColor:B===le?"rgba(255,255,255,0.05)":le%2===0?"rgba(255,255,255,0.02)":"transparent",cursor:"pointer"},onClick:()=>F(B===le?null:le),children:[t.jsx("div",{style:{color:s.text,fontWeight:"bold"},children:ge.measure_description||"Restriction"}),t.jsxs("div",{style:{color:s.textMuted,fontSize:"9px"},children:["HS Code: ",ge.product_code||"N/A"," | ",ge.in_force?"In Force":"Not Active"]}),B===le&&t.jsxs("div",{style:{marginTop:"4px",fontSize:"9px",color:s.textMuted},children:[t.jsxs("div",{children:["Entry: ",ge.date_of_entry_into_force||"N/A"]}),t.jsxs("div",{children:["Legal Basis: ",ge.legal_basis||"N/A"]}),t.jsxs("div",{children:["Measure Type: ",ge.measure_type||"N/A"]})]})]},le)):t.jsx("div",{style:{color:s.textMuted,fontSize:"10px"},children:"No active restrictions for this country"})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"TRADE FLOW (MERCHANDISE)"}),E.length>0?t.jsx(ml,{width:"100%",height:280,children:t.jsxs(tg,{data:E,children:[t.jsx(vd,{strokeDasharray:"3 3",stroke:s.textMuted,opacity:.3}),t.jsx(bl,{dataKey:"Year",stroke:s.text,fontSize:9}),t.jsx(vl,{stroke:s.text,fontSize:9}),t.jsx(Sl,{contentStyle:{backgroundColor:s.background,border:`1px solid ${s.textMuted}`,color:s.text,fontSize:"10px"}}),t.jsx(rg,{type:"monotone",dataKey:"Value",stroke:s.info,strokeWidth:2,name:"Trade Value"})]})}):t.jsx("div",{style:{color:s.textMuted,fontSize:"10px"},children:"No trade flow data available"})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"TRADE FACILITATION (TFAD)"}),k?t.jsxs("div",{style:{fontSize:"10px",lineHeight:"1.6"},children:[t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("div",{style:{color:s.secondary,fontWeight:"bold",marginBottom:"4px"},children:"Single Window"}),t.jsx("div",{style:{color:s.text},children:k.single_window_available?"Available":"Not Available"}),k.single_window_url&&t.jsx("a",{href:k.single_window_url,target:"_blank",rel:"noopener noreferrer",style:{color:s.info,textDecoration:"underline",fontSize:"9px"},children:"Visit Single Window"})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("div",{style:{color:s.secondary,fontWeight:"bold",marginBottom:"4px"},children:"Enquiry Points"}),t.jsxs("div",{style:{color:s.text},children:[k.enquiry_points?.length||0," contact(s) available"]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("div",{style:{color:s.secondary,fontWeight:"bold",marginBottom:"4px"},children:"Procedures"}),t.jsxs("div",{style:{color:s.text},children:[k.procedures?.length||0," procedure(s) documented"]})]})]}):t.jsx("div",{style:{color:s.textMuted,fontSize:"10px"},children:"No TFAD data available for this country"})]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"8px",height:"250px"},children:t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"8px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"PRODUCTS AFFECTED BY QR (HS CODES)"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"6px"},children:C.length>0?C.slice(0,40).map((ge,le)=>t.jsxs("div",{style:{padding:"6px",backgroundColor:"rgba(255,255,255,0.03)",border:`1px solid ${s.textMuted}`,fontSize:"9px"},children:[t.jsx("div",{style:{color:s.secondary,fontWeight:"bold"},children:ge.code||"N/A"}),t.jsxs("div",{style:{color:s.textMuted},children:[ge.description?.substring(0,40)||"No description","..."]})]},le)):t.jsx("div",{style:{color:s.textMuted,fontSize:"10px",gridColumn:"1 / -1"},children:"No product data available"})})]})})]}),t.jsx("div",{style:{borderTop:`1px solid ${s.textMuted}`,backgroundColor:s.panel,padding:"4px 8px",fontSize:"10px",color:s.textMuted,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs("span",{children:["Geopolitical Intelligence System v5.0 | WTO Real-time Data | ",p.length+h.length," Total Notifications"]}),t.jsxs("span",{children:["Last Updated: ",o.toTimeString().substring(0,8)]})]})})]})};class W9{async callOpenAI(e,r,n){const i=`${r.baseUrl||"https://api.openai.com/v1"}/chat/completions`;try{const o=await tn(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.apiKey}`},body:JSON.stringify({model:r.model,messages:e,temperature:r.temperature,max_tokens:r.maxTokens,stream:!!n})});if(!o.ok){const a=await o.json();throw new Error(a.error?.message||`OpenAI API error: ${o.status}`)}if(n)return await this.handleOpenAIStream(o,n);{const a=await o.json();return{content:a.choices[0].message.content,usage:{promptTokens:a.usage?.prompt_tokens||0,completionTokens:a.usage?.completion_tokens||0,totalTokens:a.usage?.total_tokens||0}}}}catch(o){return vr.error("OpenAI API Error:",o),{content:"",error:o instanceof Error?o.message:"Unknown error"}}}async handleOpenAIStream(e,r){const n=e.body?.getReader(),i=new TextDecoder;let o="";if(!n)throw new Error("No response body");try{for(;;){const{done:a,value:l}=await n.read();if(a)break;const p=i.decode(l).split(`
`).filter(f=>f.trim().startsWith("data: "));for(const f of p){const h=f.replace("data: ","").trim();if(h!=="[DONE]")try{const m=JSON.parse(h).choices[0]?.delta?.content||"";m&&(o+=m,r(m,!1))}catch{}}}return r("",!0),{content:o}}finally{n.releaseLock()}}async callGemini(e,r,n){const i=`https://generativelanguage.googleapis.com/v1beta/models/${r.model}:${n?"streamGenerateContent":"generateContent"}?key=${r.apiKey}`,o=e.find(f=>f.role==="system")?.content||"",a=e.filter(f=>f.role!=="system"&&f.content.trim()!==""&&f.content!=="(No response generated)"),l=[];let d=null;for(const f of a){const h=f.role==="assistant"?"model":"user";h===d&&l.length>0?l[l.length-1].parts.push({text:`

`+f.content}):(l.push({role:h,parts:[{text:f.content}]}),d=h)}if(l.length===0)return{content:"",error:"No messages to send to Gemini"};const p={contents:l,systemInstruction:o?{parts:[{text:o}]}:void 0,generationConfig:{temperature:r.temperature,maxOutputTokens:r.maxTokens}};vr.debug("[Gemini] Request details:"),vr.debug("[Gemini] - Contents count:",l.length),vr.debug("[Gemini] - System instruction length: "+(o?.length||0)+" characters"),vr.debug("[Gemini] - First content role:",l[0]?.role),vr.debug("[Gemini] - First content preview:",JSON.stringify(l[0]).substring(0,200));try{const f=await tn(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!f.ok){const h=await f.text();let x=`Gemini API error: ${f.status}`;try{const m=JSON.parse(h);x=m.error?.message||x,vr.error("[Gemini] API Error Response:",m)}catch{vr.error("[Gemini] API Error Text:",h)}throw new Error(x)}if(n)return await this.handleGeminiStream(f,n);{const h=await f.json(),x=h.candidates?.[0];if(!x)throw new Error("No candidates in Gemini response");const m=x.content?.parts;if(!m||m.length===0)throw new Error("No content parts in Gemini response");const b=m[0].text;if(!b)throw new Error("No text in Gemini response parts");return{content:b,usage:{promptTokens:h.usageMetadata?.promptTokenCount||0,completionTokens:h.usageMetadata?.candidatesTokenCount||0,totalTokens:h.usageMetadata?.totalTokenCount||0}}}}catch(f){return vr.error("Gemini API Error:",f),{content:"",error:f instanceof Error?f.message:"Unknown error"}}}async handleGeminiStream(e,r){const n=e.body?.getReader(),i=new TextDecoder;let o="",a="";if(!n)throw new Error("No response body");try{for(;;){const{done:l,value:d}=await n.read();if(l)break;const p=i.decode(d);a+=p}try{const l=JSON.parse(a);if(Array.isArray(l))for(const d of l){const p=d.candidates?.[0]?.content?.parts?.[0]?.text||"";p&&(o+=p,r(p,!1))}else{const d=l.candidates?.[0]?.content?.parts?.[0]?.text||"";d&&(o=d,r(d,!1))}}catch(l){throw vr.error("[Gemini Stream] Failed to parse JSON:",l),vr.debug("[Gemini Stream] Accumulated JSON:",a),new Error("Failed to parse Gemini response")}return r("",!0),{content:o}}finally{n.releaseLock()}}async callGeminiWithTools(e,r,n,i,o,a){const l=`https://generativelanguage.googleapis.com/v1beta/models/${i.model}:generateContent?key=${i.apiKey}`,d=n.map(x=>{const m=x.inputSchema?{...x.inputSchema}:{type:"object",properties:{}};return delete m.$schema,delete m.additionalProperties,{name:`${x.serverId}__${x.name}`,description:x.description||"",parameters:m}});vr.debug("[MCP] Sending tools to Gemini: "+d.length+" tools");const p=r.find(x=>x.role==="system")?.content||i.systemPrompt||"",h=[...r.filter(x=>x.role!=="system").map(x=>({role:x.role==="assistant"?"model":"user",parts:[{text:x.content}]})),{role:"user",parts:[{text:e}]}];try{let x=await tn(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:h,systemInstruction:p?{parts:[{text:p}]}:void 0,tools:[{functionDeclarations:d}],generationConfig:{temperature:i.temperature,maxOutputTokens:i.maxTokens}})});if(!x.ok){const T=await x.json();throw new Error(T.error?.message||`Gemini API error: ${x.status}`)}let m=await x.json();const b=m.candidates?.[0];let w="";const y=b?.content?.parts?.find(T=>T.functionCall);if(y){vr.info("[MCP] Gemini requested function call:",y.functionCall.name);const T=y.functionCall.name,E=y.functionCall.args||{};a&&a(T,E);const{mcpManager:j}=await Br(async()=>{const{mcpManager:M}=await Promise.resolve().then(()=>eg);return{mcpManager:M}},void 0),[k,A]=T.includes("__")?T.split("__"):[T,T];let R;try{R=await j.callTool(k,A,E),R.content&&Array.isArray(R.content)?w=R.content.map(M=>M.text?M.text:M.data?typeof M.data=="string"?M.data:JSON.stringify(M.data,null,2):JSON.stringify(M,null,2)).join(`

`):R.content?w=typeof R.content=="string"?R.content:JSON.stringify(R.content,null,2):w=JSON.stringify(R,null,2),a&&a(T,E,R),vr.debug("[MCP] Tool result:",w),h.push({role:"model",parts:[{functionCall:y.functionCall}]}),h.push({role:"user",parts:[{functionResponse:{name:T,response:{result:w}}}]})}catch(M){vr.error("[MCP] Tool execution error:",M),h.push({role:"user",parts:[{functionResponse:{name:T,response:{error:M instanceof Error?M.message:"Unknown error"}}}]})}if(x=await tn(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:h,systemInstruction:p?{parts:[{text:p}]}:void 0,generationConfig:{temperature:i.temperature,maxOutputTokens:i.maxTokens}})}),!x.ok){const M=await x.json();throw new Error(M.error?.message||`Gemini API error: ${x.status}`)}m=await x.json()}let C=m.candidates?.[0]?.content?.parts?.[0]?.text||"";return!C&&w&&(C=w),vr.debug("[MCP] Gemini final response length:",C.length),o&&C&&(o(C,!1),o("",!0)),{content:C,usage:{promptTokens:m.usageMetadata?.promptTokenCount||0,completionTokens:m.usageMetadata?.candidatesTokenCount||0,totalTokens:m.usageMetadata?.totalTokenCount||0}}}catch(x){return vr.error("Gemini function calling error:",x),{content:"",error:x instanceof Error?x.message:"Unknown error"}}}async callDeepSeek(e,r,n){const i={...r,baseUrl:r.baseUrl||"https://api.deepseek.com"};return this.callOpenAI(e,i,n)}async callOllama(e,r,n){const i=`${r.baseUrl||"http://localhost:11434"}/api/chat`;try{const o=await tn(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:r.model,messages:e,stream:!!n,options:{temperature:r.temperature,num_predict:r.maxTokens}})});if(!o.ok){if(o.status===404){let a="";try{const l=await o.json();l.error&&l.error.includes("model")?a=`Ollama model '${r.model}' not found. Please pull the model first using: ollama pull ${r.model}`:a=l.error||"Ollama server not found. Please ensure Ollama is running at http://localhost:11434"}catch{a="Ollama server not found. Please ensure Ollama is running at http://localhost:11434"}throw new Error(a)}throw new Error(`Ollama API error: ${o.status}`)}if(n)return await this.handleOllamaStream(o,n);{const a=await o.json();return{content:a.message.content,usage:{promptTokens:a.prompt_eval_count||0,completionTokens:a.eval_count||0,totalTokens:(a.prompt_eval_count||0)+(a.eval_count||0)}}}}catch(o){return vr.error("Ollama API Error:",o),{content:"",error:o instanceof Error?o.message:"Unknown error. Is Ollama running?"}}}async handleOllamaStream(e,r){const n=e.body?.getReader(),i=new TextDecoder;let o="";if(!n)throw new Error("No response body");try{for(;;){const{done:a,value:l}=await n.read();if(a)break;const p=i.decode(l).split(`
`).filter(f=>f.trim());for(const f of p)try{const h=JSON.parse(f),x=h.message?.content||"";if(x&&(o+=x,r(x,!1)),h.done)break}catch{}}return r("",!0),{content:o}}finally{n.releaseLock()}}async callOllamaWithTools(e,r,n,i,o,a){const l=`${i.baseUrl||"http://localhost:11434"}/api/chat`,d=n.map(x=>{const m=x.inputSchema?{...x.inputSchema}:{type:"object",properties:{}};return delete m.$schema,delete m.additionalProperties,{type:"function",function:{name:`${x.serverId}__${x.name}`,description:x.description||"",parameters:m}}});vr.debug("[MCP] Sending tools to Ollama: "+d.length+" tools");const p=r.find(x=>x.role==="system")?.content||i.systemPrompt||"",f=r.filter(x=>x.role!=="system");let h=[{role:"system",content:p+`

You have access to tools. Use them when the user asks for specific data or actions.`},...f.map(x=>({role:x.role,content:x.content})),{role:"user",content:e}];try{let x=await tn(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:i.model,messages:h,tools:d,stream:!1,options:{temperature:i.temperature,num_predict:i.maxTokens}})});if(!x.ok)throw x.status===404?new Error(`Ollama model '${i.model}' not found. Please pull the model first using: ollama pull ${i.model}`):new Error(`Ollama API error: ${x.status}`);let m=await x.json(),b=m.message,w="";if(b.tool_calls&&b.tool_calls.length>0){vr.info("[MCP] Ollama requested tool calls:",b.tool_calls.length),h.push(b);for(const C of b.tool_calls){const T=C.function.name,E=C.function.arguments;vr.debug(`[MCP] Calling tool: ${T}`,E),a&&a(T,E);const{mcpManager:j}=await Br(async()=>{const{mcpManager:k}=await Promise.resolve().then(()=>eg);return{mcpManager:k}},void 0);try{const[k,A]=T.includes("__")?T.split("__"):[T,T],R=await j.callTool(k,A,E);R.content&&Array.isArray(R.content)?w=R.content.map(M=>M.text?M.text:M.data?typeof M.data=="string"?M.data:JSON.stringify(M.data,null,2):JSON.stringify(M,null,2)).join(`

`):R.content?w=typeof R.content=="string"?R.content:JSON.stringify(R.content,null,2):w=JSON.stringify(R,null,2),h.push({role:"tool",content:w}),a&&a(T,E,R),vr.debug("[MCP] Tool result:",w)}catch(k){vr.error("[MCP] Tool execution error:",k),h.push({role:"tool",content:`Error: ${k instanceof Error?k.message:"Unknown error"}`})}}if(x=await tn(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:i.model,messages:h,stream:!1,options:{temperature:i.temperature,num_predict:i.maxTokens}})}),!x.ok)throw new Error(`Ollama API error: ${x.status}`);m=await x.json(),b=m.message}let y=b.content||"";return!y&&w&&(y=w),vr.debug("[MCP] Ollama final response length:",y.length),o&&y&&(o(y,!1),o("",!0)),{content:y,usage:{promptTokens:m.prompt_eval_count||0,completionTokens:m.eval_count||0,totalTokens:(m.prompt_eval_count||0)+(m.eval_count||0)}}}catch(x){return vr.error("Ollama function calling error:",x),{content:"",error:x instanceof Error?x.message:"Unknown error"}}}async callOpenRouter(e,r,n){const i=`${r.baseUrl||"https://openrouter.ai/api/v1"}/chat/completions`;try{const o=await tn(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.apiKey}`,"HTTP-Referer":window.location.origin,"X-Title":"Fincept Terminal"},body:JSON.stringify({model:r.model,messages:e,temperature:r.temperature,max_tokens:r.maxTokens,stream:!!n})});if(!o.ok){const a=await o.json();vr.debug("OpenRouter full error response:",JSON.stringify(a,null,2));const l=a.error?.message||a.message||JSON.stringify(a);throw new Error(`OpenRouter error (${o.status}): ${l}`)}if(n)return await this.handleOpenAIStream(o,n);{const a=await o.json();return{content:a.choices[0].message.content,usage:{promptTokens:a.usage?.prompt_tokens||0,completionTokens:a.usage?.completion_tokens||0,totalTokens:a.usage?.total_tokens||0}}}}catch(o){return vr.error("OpenRouter API Error:",o),{content:"",error:o instanceof Error?o.message:"Unknown error"}}}async chat(e,r=[],n){try{const i=await Je.getActiveLLMConfig();if(!i)return{content:"",error:"No active LLM provider configured. Please check settings."};const o=await Je.getLLMGlobalSettings(),a={provider:i.provider,apiKey:i.api_key,baseUrl:i.base_url,model:i.model,temperature:o.temperature,maxTokens:o.max_tokens,systemPrompt:o.system_prompt};if(a.provider!=="ollama"&&!a.apiKey)return{content:"",error:`${a.provider} requires an API key. Please configure it in settings.`};const l=[{role:"system",content:a.systemPrompt||"You are a helpful assistant."},...r,{role:"user",content:e}];switch(a.provider){case"openai":return this.callOpenAI(l,a,n);case"gemini":return this.callGemini(l,a,n);case"deepseek":return this.callDeepSeek(l,a,n);case"ollama":return this.callOllama(l,a,n);case"openrouter":return this.callOpenRouter(l,a,n);default:return{content:"",error:`Unknown provider: ${a.provider}`}}}catch(i){return vr.error("Error in chat:",i),{content:"",error:i instanceof Error?i.message:"Unknown error"}}}async chatWithTools(e,r=[],n=[],i,o){try{const a=await Je.getActiveLLMConfig();if(!a)return{content:"",error:"No active LLM provider configured. Please check settings."};if(!["openai","openrouter","gemini","deepseek","ollama"].includes(a.provider)&&n.length>0)return vr.warn(`Provider '${a.provider}' does not support function calling. Available tools: ${n.length}`),{content:` MCP Tools Not Supported

Your current LLM provider (${a.provider.toUpperCase()}) does not support function calling with MCP tools.

**Available MCP Tools:** ${n.length} tools detected
**Supported Providers:** OpenAI, Gemini, DeepSeek, OpenRouter, Ollama

To use MCP tools, please switch to a supported provider in Settings (CONFIG button).`,error:void 0};if(n.length===0)return this.chat(e,r,i);const d=await Je.getLLMGlobalSettings(),p={provider:a.provider,apiKey:a.api_key,baseUrl:a.base_url,model:a.model,temperature:d.temperature,maxTokens:d.max_tokens,systemPrompt:d.system_prompt};if(a.provider==="gemini")return this.callGeminiWithTools(e,r,n,p,i,o);if(a.provider==="ollama")return this.callOllamaWithTools(e,r,n,p,i,o);let f=[{role:"system",content:p.systemPrompt||"You are a helpful assistant with access to tools. Use them when needed."},...r.map(T=>({role:T.role,content:T.content})),{role:"user",content:e}];const h=n.map(T=>({type:"function",function:{name:`${T.serverId}__${T.name}`,description:T.description||"",parameters:T.inputSchema||{type:"object",properties:{}}}}));vr.debug("[MCP] Sending tools to API:",h.length+" tools"),vr.debug("[MCP] Tool names:",h.map(T=>T.function.name));let x=p.baseUrl;x||(a.provider==="deepseek"?x="https://api.deepseek.com":a.provider==="openrouter"?x="https://openrouter.ai/api/v1":x="https://api.openai.com/v1");const m=`${x}/chat/completions`;let b=await tn(m,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p.apiKey}`,...a.provider==="openrouter"?{"HTTP-Referer":window.location.origin,"X-Title":"Fincept Terminal"}:{}},body:JSON.stringify({model:p.model,messages:f,tools:h,tool_choice:"auto",temperature:p.temperature,max_tokens:p.maxTokens})});if(!b.ok){const T=await b.json();throw new Error(T.error?.message||`API error: ${b.status}`)}let w=await b.json(),y=w.choices[0].message;if(y.tool_calls&&y.tool_calls.length>0){vr.info("[MCP] AI requested tool calls:",y.tool_calls.length),f.push(y);for(const T of y.tool_calls){const E=T.function.name,j=JSON.parse(T.function.arguments);vr.debug(`[MCP] Calling tool: ${E}`,j),o&&o(E,j);const{mcpManager:k}=await Br(async()=>{const{mcpManager:A}=await Promise.resolve().then(()=>eg);return{mcpManager:A}},void 0);try{const[A,R]=E.includes("__")?E.split("__"):[E,E],M=await k.callTool(A,R,j);let P="";M.content&&Array.isArray(M.content)?P=M.content.map(I=>I.text?I.text:I.data?typeof I.data=="string"?I.data:JSON.stringify(I.data,null,2):JSON.stringify(I,null,2)).join(`

`):M.content?P=typeof M.content=="string"?M.content:JSON.stringify(M.content,null,2):P=JSON.stringify(M,null,2),f.push({role:"tool",tool_call_id:T.id,content:P}),o&&o(E,j,M),vr.debug("[MCP] Tool result:",P)}catch(A){vr.error("[MCP] Tool execution error:",A),f.push({role:"tool",tool_call_id:T.id,content:`Error: ${A instanceof Error?A.message:"Unknown error"}`})}}if(b=await tn(m,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p.apiKey}`,...a.provider==="openrouter"?{"HTTP-Referer":window.location.origin,"X-Title":"Fincept Terminal"}:{}},body:JSON.stringify({model:p.model,messages:f,temperature:p.temperature,max_tokens:p.maxTokens})}),!b.ok){const T=await b.json();throw new Error(T.error?.message||`API error: ${b.status}`)}w=await b.json(),y=w.choices[0].message}const C=y.content||"";return vr.debug("[MCP] Final response length:",C.length),{content:C,usage:{promptTokens:w.usage?.prompt_tokens||0,completionTokens:w.usage?.completion_tokens||0,totalTokens:w.usage?.total_tokens||0}}}catch(a){return vr.error("Error in chatWithTools:",a),{content:"",error:a instanceof Error?a.message:"Unknown error"}}}async testConnection(){try{const e=await Je.getActiveLLMConfig();if(!e)return{success:!1,error:"No active provider configured"};const r=await this.chat("Hello",[],void 0);return r.error?{success:!1,error:r.error}:{success:!0,model:e.model}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Connection test failed"}}}}const Pp=new W9,lp={openai:"gpt-4o-mini",gemini:"gemini-2.0-flash-exp",deepseek:"deepseek-chat",ollama:"llama3.2:3b",openrouter:"google/gemini-2.0-flash-exp:free"},q9={ollama:"http://localhost:11434"},nk="fincept-llm-settings",Nf=()=>({openai:{apiKey:"",model:lp.openai},gemini:{apiKey:"",model:lp.gemini},deepseek:{apiKey:"",model:lp.deepseek},ollama:{baseUrl:q9.ollama,model:lp.ollama},openrouter:{apiKey:"",model:lp.openrouter},activeProvider:"ollama",globalSettings:{temperature:.7,maxTokens:2048,systemPrompt:"You are Fincept AI, a helpful financial analysis assistant. You provide insights on markets, trading, portfolio management, and financial data analysis."}});class H9{constructor(){Pe(this,"settings");this.settings=this.loadSettings()}loadSettings(){try{const e=localStorage.getItem(nk);if(e){const r=JSON.parse(e);return{...Nf(),...r}}}catch(e){console.error("Failed to load LLM settings:",e)}return Nf()}saveSettings(){try{localStorage.setItem(nk,JSON.stringify(this.settings))}catch(e){console.error("Failed to save LLM settings:",e)}}getSettings(){return{...this.settings}}getActiveConfig(){const e=this.settings.activeProvider,r=this.settings[e],n=this.settings.globalSettings;return{provider:e,apiKey:"apiKey"in r?r.apiKey:"",baseUrl:"baseUrl"in r?r.baseUrl:void 0,model:r.model,temperature:n.temperature,maxTokens:n.maxTokens,systemPrompt:n.systemPrompt}}updateProviderSettings(e,r){this.settings[e]={...this.settings[e],...r},this.saveSettings()}updateGlobalSettings(e){this.settings.globalSettings={...this.settings.globalSettings,...e},this.saveSettings()}setActiveProvider(e){this.settings.activeProvider=e,this.saveSettings()}getActiveProvider(){return this.settings.activeProvider}validateConfig(e){const r=e||this.settings.activeProvider,n=this.settings[r];switch(r){case"openai":case"gemini":case"deepseek":case"openrouter":if(!("apiKey"in n)||!n.apiKey)return{valid:!1,error:`API key required for ${r}`};break;case"ollama":if(!("baseUrl"in n)||!n.baseUrl)return{valid:!1,error:"Ollama base URL required"};break}return n.model?{valid:!0}:{valid:!1,error:"Model selection required"}}resetToDefaults(){this.settings=Nf(),this.saveSettings()}exportSettings(){return JSON.stringify(this.settings,null,2)}importSettings(e){try{const r=JSON.parse(e);return this.settings={...Nf(),...r},this.saveSettings(),!0}catch(r){return console.error("Failed to import settings:",r),!1}}}const Of=new H9,Y9=({isOpen:s,onClose:e,onNavigateToSettings:r})=>{const n="#FFA500",i="#FFFFFF",o="#000000",a="#0a0a0a";return s?t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,fontFamily:"Consolas, monospace"},children:t.jsxs("div",{style:{backgroundColor:a,border:`2px solid ${n}`,borderRadius:"4px",width:"90%",maxWidth:"600px",boxShadow:"0 4px 20px rgba(255, 165, 0, 0.3)",padding:"24px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(Mn,{size:20,color:n}),t.jsx("span",{style:{color:n,fontSize:"16px",fontWeight:"bold"},children:"LLM CONFIGURATION"})]}),t.jsx("button",{onClick:e,style:{backgroundColor:"transparent",border:"none",color:"#ff0000",cursor:"pointer",padding:"4px"},children:t.jsx(ln,{size:20})})]}),t.jsxs("div",{style:{padding:"32px",textAlign:"center"},children:[t.jsxs("div",{style:{marginBottom:"24px",display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[t.jsx(Mn,{size:48,color:n}),t.jsx("h3",{style:{color:i,fontSize:"18px",fontWeight:"bold",margin:0},children:"Configure LLM Settings"}),t.jsx("p",{style:{color:"#888",fontSize:"12px",maxWidth:"400px",lineHeight:"1.6",margin:0},children:"LLM configuration has been moved to the Settings screen for a unified configuration experience. Please navigate to the Settings tab to configure your AI providers."})]}),t.jsx("div",{style:{background:o,border:"1px solid #2a2a2a",borderRadius:"4px",padding:"16px",marginBottom:"24px"},children:t.jsxs("div",{style:{color:"#888",fontSize:"11px",lineHeight:"1.6",textAlign:"left"},children:[t.jsx("div",{style:{marginBottom:"8px",color:n,fontWeight:"bold"},children:"What you can configure in Settings:"}),t.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[t.jsx("li",{children:"Select active LLM provider (OpenAI, Gemini, DeepSeek, Ollama, OpenRouter)"}),t.jsx("li",{children:"Configure API keys and base URLs"}),t.jsx("li",{children:"Set model names"}),t.jsx("li",{children:"Adjust temperature and max tokens"}),t.jsx("li",{children:"Customize system prompts"})]})]})}),t.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[t.jsxs("button",{onClick:()=>{e(),r?.()},style:{backgroundColor:n,color:"black",border:"none",padding:"12px 24px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(Mn,{size:16}),"GO TO SETTINGS TAB"]}),t.jsx("button",{onClick:e,style:{backgroundColor:o,color:i,border:"1px solid #2a2a2a",padding:"12px 24px",fontSize:"12px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"})]})]})]})}):null},K9=({chatSessionUuid:s,onContextsChange:e})=>{const{colors:r}=Er(),[n,i]=S.useState([]),[o,a]=S.useState([]),[l,d]=S.useState(!1),[p,f]=S.useState(null),[h,x]=S.useState(""),[m,b]=S.useState(null),[w,y]=S.useState(null);S.useEffect(()=>{s&&C()},[s]),S.useEffect(()=>{l&&T()},[l]);const C=async()=>{if(s)try{const P=await qn.getChatContexts(s);i(P),e?.(P)}catch(P){console.error("[ContextSelector] Failed to load linked contexts:",P)}},T=async()=>{try{const P=await qn.getRecordedContexts({limit:500});console.log("[ContextSelector] Loaded available contexts:",P.length,P),a(P)}catch(P){console.error("[ContextSelector] Failed to load available contexts:",P)}},E=async P=>{if(s)try{await qn.linkToChat(s,P),await C()}catch(I){console.error("[ContextSelector] Failed to link context:",I)}},j=async P=>{if(s)try{await qn.unlinkFromChat(s,P),await C()}catch(I){console.error("[ContextSelector] Failed to unlink context:",I)}},k=async P=>{if(s)try{await qn.toggleChatContextActive(s,P),await C()}catch(I){console.error("[ContextSelector] Failed to toggle context:",I)}},A=async P=>{f(P);try{const I=await qn.formatContextForLLM(P.id,"markdown");x(I)}catch(I){console.error("[ContextSelector] Failed to load preview:",I),x("Error loading preview")}},R=P=>n.some(I=>I.id===P),M=P=>{if(P===0)return"0 B";const I=1024,O=["B","KB","MB"],G=Math.floor(Math.log(P)/Math.log(I));return Math.round(P/Math.pow(I,G)*100)/100+" "+O[G]};return s?t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("span",{style:{fontSize:"11px",fontWeight:"bold",color:r.text},children:["ACTIVE CONTEXTS (",n.length,")"]}),t.jsxs("button",{onClick:()=>d(!0),style:{backgroundColor:r.primary,color:"black",border:"none",padding:"3px 8px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:P=>P.currentTarget.style.opacity="0.8",onMouseLeave:P=>P.currentTarget.style.opacity="1",children:[t.jsx(wn,{size:12}),"ADD"]})]}),n.length===0?t.jsx("div",{style:{fontSize:"10px",color:r.textMuted,padding:"8px",border:`1px dashed ${r.textMuted}`,textAlign:"center"},children:'No contexts linked. Click "ADD" to include recorded data.'}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:n.map(P=>t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px",border:`1px solid ${r.textMuted}`,backgroundColor:r.background,fontSize:"10px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",flex:1,minWidth:0},children:[t.jsx("input",{type:"checkbox",checked:!0,onChange:()=>k(P.id),style:{width:"12px",height:"12px",cursor:"pointer",accentColor:r.primary}}),t.jsx(js,{size:12,style:{flexShrink:0,color:r.primary}}),t.jsx("span",{style:{fontWeight:"bold",color:r.text,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:P.label||"Unnamed"}),t.jsx("span",{style:{fontSize:"9px",padding:"1px 4px",backgroundColor:"rgba(255,120,0,0.2)",border:`1px solid ${r.primary}`,color:r.primary,flexShrink:0},children:P.tab_name})]}),t.jsxs("div",{style:{display:"flex",gap:"4px",flexShrink:0},children:[t.jsx("button",{onMouseEnter:()=>b(P.id),onMouseLeave:()=>b(null),onClick:()=>y(P),style:{backgroundColor:"transparent",border:"none",padding:"2px",cursor:"pointer",color:m===P.id?r.primary:r.textMuted},children:t.jsx(vi,{size:12})}),t.jsx("button",{onClick:()=>j(P.id),style:{backgroundColor:"transparent",border:"none",padding:"2px",cursor:"pointer",color:r.alert},onMouseEnter:I=>I.currentTarget.style.opacity="0.7",onMouseLeave:I=>I.currentTarget.style.opacity="1",children:t.jsx(On,{size:12})})]})]},P.id))}),w&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:()=>y(null)}),t.jsxs("div",{style:{position:"fixed",top:"50%",right:"420px",transform:"translateY(-50%)",backgroundColor:r.panel,border:`1px solid ${r.primary}`,width:"384px",maxHeight:"300px",zIndex:1e3,boxShadow:"0 4px 12px rgba(0,0,0,0.5)"},children:[t.jsxs("div",{style:{padding:"12px",borderBottom:`1px solid ${r.textMuted}`},children:[t.jsx("div",{style:{fontWeight:"bold",fontSize:"11px",color:r.text},children:w.label}),t.jsxs("div",{style:{fontSize:"9px",color:r.textMuted,marginTop:"2px"},children:[w.tab_name,"  ",w.data_type,"  ",M(w.data_size)]})]}),t.jsx("div",{style:{padding:"8px",backgroundColor:r.background,maxHeight:"200px",overflow:"auto"},children:t.jsxs("pre",{style:{fontSize:"9px",whiteSpace:"pre-wrap",fontFamily:"monospace",color:r.text,margin:0},children:[w.raw_data.substring(0,500),w.raw_data.length>500?"...":""]})})]})]}),l&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",zIndex:1e3},onClick:()=>d(!1)}),t.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:r.panel,border:`2px solid ${r.primary}`,width:"90%",maxWidth:"800px",maxHeight:"80vh",zIndex:1001,boxShadow:"0 8px 24px rgba(0,0,0,0.7)",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{padding:"16px",borderBottom:`2px solid ${r.primary}`,backgroundColor:r.background},children:[t.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",color:r.primary,textTransform:"uppercase"},children:"ADD CONTEXT TO CHAT"}),t.jsx("div",{style:{fontSize:"10px",color:r.textMuted,marginTop:"4px"},children:"Select recorded contexts to provide additional information to the AI"})]}),t.jsx("div",{style:{padding:"16px",overflowY:"auto",flex:1},children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[o.map(P=>t.jsxs("div",{style:{display:"flex",alignItems:"start",justifyContent:"space-between",padding:"12px",border:`1px solid ${r.textMuted}`,backgroundColor:r.background},children:[t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[t.jsx("span",{style:{fontSize:"11px",fontWeight:"bold",color:r.text,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:P.label||"Unnamed Context"}),t.jsx("span",{style:{fontSize:"9px",padding:"2px 6px",border:`1px solid ${r.primary}`,color:r.primary,backgroundColor:"rgba(255,120,0,0.1)",flexShrink:0},children:P.tab_name}),t.jsx("span",{style:{fontSize:"9px",padding:"2px 6px",border:`1px solid ${r.textMuted}`,color:r.textMuted,flexShrink:0},children:P.data_type})]}),t.jsxs("div",{style:{fontSize:"10px",color:r.textMuted},children:[M(P.data_size),"  ",new Date(P.created_at).toLocaleDateString()]})]}),t.jsxs("div",{style:{display:"flex",gap:"4px",marginLeft:"12px"},children:[t.jsx("button",{onClick:()=>A(P),style:{backgroundColor:r.background,border:`1px solid ${r.textMuted}`,color:r.text,padding:"4px 8px",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:I=>{I.currentTarget.style.backgroundColor=r.panel,I.currentTarget.style.borderColor=r.primary},onMouseLeave:I=>{I.currentTarget.style.backgroundColor=r.background,I.currentTarget.style.borderColor=r.textMuted},children:t.jsx(vi,{size:12})}),R(P.id)?t.jsxs("button",{onClick:()=>j(P.id),style:{backgroundColor:r.alert,border:"none",color:"black",padding:"4px 10px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:I=>I.currentTarget.style.opacity="0.8",onMouseLeave:I=>I.currentTarget.style.opacity="1",children:[t.jsx(ln,{size:12}),"REMOVE"]}):t.jsxs("button",{onClick:()=>E(P.id),style:{backgroundColor:r.primary,border:"none",color:"black",padding:"4px 10px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:I=>I.currentTarget.style.opacity="0.8",onMouseLeave:I=>I.currentTarget.style.opacity="1",children:[t.jsx(wn,{size:12}),"ADD"]})]})]},P.id)),o.length===0&&t.jsx("div",{style:{textAlign:"center",padding:"32px",color:r.textMuted,fontSize:"11px"},children:"No recorded contexts available. Start recording data from tabs."})]})}),t.jsx("div",{style:{padding:"12px 16px",borderTop:`1px solid ${r.textMuted}`,backgroundColor:r.background,display:"flex",justifyContent:"flex-end"},children:t.jsx("button",{onClick:()=>d(!1),style:{backgroundColor:r.panel,border:`1px solid ${r.textMuted}`,color:r.text,padding:"6px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},onMouseEnter:P=>{P.currentTarget.style.backgroundColor=r.background,P.currentTarget.style.borderColor=r.primary},onMouseLeave:P=>{P.currentTarget.style.backgroundColor=r.panel,P.currentTarget.style.borderColor=r.textMuted},children:"CLOSE"})})]})]}),p&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",zIndex:1e3},onClick:()=>f(null)}),t.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:r.panel,border:`2px solid ${r.primary}`,width:"90%",maxWidth:"800px",maxHeight:"80vh",zIndex:1001,boxShadow:"0 8px 24px rgba(0,0,0,0.7)",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{padding:"16px",borderBottom:`2px solid ${r.primary}`,backgroundColor:r.background},children:[t.jsx("div",{style:{fontSize:"12px",fontWeight:"bold",color:r.primary,textTransform:"uppercase"},children:p.label||"CONTEXT PREVIEW"}),t.jsxs("div",{style:{fontSize:"10px",color:r.textMuted,marginTop:"4px"},children:[p.tab_name,"  ",p.data_type]})]}),t.jsx("div",{style:{padding:"16px",overflowY:"auto",flex:1,backgroundColor:r.background},children:t.jsx("pre",{style:{fontSize:"10px",whiteSpace:"pre-wrap",fontFamily:"monospace",color:r.text,margin:0},children:h})}),t.jsx("div",{style:{padding:"12px 16px",borderTop:`1px solid ${r.textMuted}`,backgroundColor:r.background,display:"flex",justifyContent:"flex-end"},children:t.jsx("button",{onClick:()=>f(null),style:{backgroundColor:r.panel,border:`1px solid ${r.textMuted}`,color:r.text,padding:"6px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},onMouseEnter:P=>{P.currentTarget.style.backgroundColor=r.background,P.currentTarget.style.borderColor=r.primary},onMouseLeave:P=>{P.currentTarget.style.backgroundColor=r.panel,P.currentTarget.style.borderColor=r.textMuted},children:"CLOSE"})})]})]})]}):t.jsx("div",{style:{fontSize:"11px",color:r.textMuted,padding:"8px"},children:"Start a chat session to use contexts"})},V9=({onNavigateToSettings:s,onNavigateToTab:e})=>{const{colors:r,fontSize:n,fontFamily:i,fontWeight:o,fontStyle:a}=Er(),[l,d]=S.useState(new Date),[p,f]=S.useState(null),[h,x]=S.useState([]),[m,b]=S.useState(""),[w,y]=S.useState(""),[C,T]=S.useState(!1),[E,j]=S.useState([]),[k,A]=S.useState("STATUS: INITIALIZING..."),[R,M]=S.useState(!1),[P,I]=S.useState("ollama"),[O,G]=S.useState(""),[B,F]=S.useState({totalSessions:0,totalMessages:0,totalTokens:0}),[z,$]=S.useState(0),[W,D]=S.useState([]),oe=J=>{D(J)},[Z,fe]=S.useState(null),[Q,_]=S.useState(""),[Y,he]=S.useState(""),me=S.useRef(null),ge=S.useRef(null),le=S.useRef(""),X=()=>["openai","openrouter","gemini","deepseek","ollama"].includes(P.toLowerCase());S.useEffect(()=>{(async()=>{try{A("STATUS: INITIALIZING DATABASE..."),["chat-sessions","chat-messages","fincept-chat-data","fincept-llm-settings"].forEach(Me=>localStorage.removeItem(Me)),await Je.initialize();const Te=await Je.healthCheck();if(!Te.healthy)throw new Error(Te.message);await Je.ensureDefaultLLMConfigs(),await de(),await je(),await _e(),await Re(),A("STATUS: READY")}catch(se){console.error("Database initialization error:",se);const Te=se instanceof Error?se.message:"Unknown error";A(`ERROR: ${Te}`)}})()},[]),S.useEffect(()=>{const J=setInterval(()=>{d(new Date)},1e3);return()=>clearInterval(J)},[]),S.useEffect(()=>{const J=setInterval(()=>{Re()},1e4);return()=>clearInterval(J)},[]),S.useEffect(()=>{V()},[h,O]);const V=()=>{me.current?.scrollIntoView({behavior:"smooth"})},de=async()=>{try{const J=await Je.getChatSessions();j(J)}catch(J){console.error("Failed to load sessions:",J)}},je=async()=>{try{const J=await Je.getChatSessions(1e4),se=[];for(const Me of J){const Qe=await Je.getChatMessages(Me.session_uuid);se.push(...Qe)}const Te=se.reduce((Me,Qe)=>Me+(Qe.tokens_used||0),0);F({totalSessions:J.length,totalMessages:se.length,totalTokens:Te})}catch(J){console.error("Failed to load statistics:",J)}},_e=async()=>{try{const J=await Je.getActiveLLMConfig();J&&I(J.provider)}catch(J){console.error("Failed to load LLM provider:",J)}},Re=async(J=0,se=5)=>{try{const{mcpToolService:Te}=await Br(async()=>{const{mcpToolService:Qe}=await Promise.resolve().then(()=>bk);return{mcpToolService:Qe}},void 0),Me=await Te.getAllTools();if($(Me.length),Me.length===0&&J<se){const Qe=Math.min(1e3*Math.pow(2,J),1e4);setTimeout(()=>Re(J+1,se),Qe)}}catch{$(0)}},Be=async J=>{try{A("STATUS: LOADING MESSAGES...");const se=await Je.getChatMessages(J);x(se),A("STATUS: READY")}catch(se){console.error("Failed to load messages:",se),A("ERROR: Failed to load messages")}},Se=J=>{const se=J.replace(/[^\w\s]/g,"").trim(),Te=se.split(" ");return Te.length===0?`Chat ${new Date().toLocaleString()}`:Te.length<=4?se.substring(0,40):Te.slice(0,4).join(" ")+"..."},ie=async()=>{try{const J=m.trim()?Se(m):`Chat ${new Date().toLocaleString()}`,se=await Je.createChatSession(J);j(Te=>[se,...Te]),f(se.session_uuid),x([]),await je(),A("STATUS: NEW SESSION CREATED")}catch(J){console.error("Failed to create session:",J),A("ERROR: Failed to create session")}},ve=async J=>{f(J),await Be(J)},Ae=async J=>{try{await Je.deleteChatSession(J),j(se=>se.filter(Te=>Te.session_uuid!==J)),p===J&&(f(null),x([])),await je(),A("STATUS: SESSION DELETED")}catch(se){console.error("Failed to delete session:",se),A("ERROR: Failed to delete session")}},$e=(J,se)=>{fe(J),_(se)},qe=async J=>{if(!Q.trim()){fe(null);return}try{await Je.updateChatSessionTitle(J,Q.trim()),j(se=>se.map(Te=>Te.session_uuid===J?{...Te,title:Q.trim()}:Te)),fe(null),A("STATUS: SESSION RENAMED")}catch(se){console.error("Failed to rename session:",se),A("ERROR: Failed to rename session")}},Ie=()=>{fe(null),_("")},K=async()=>{if(p)try{await Je.clearChatSessionMessages(p),x([]),await de(),await je(),A("STATUS: CHAT CLEARED")}catch(J){console.error("Failed to clear chat:",J),A("ERROR: Failed to clear chat")}},Ee=async()=>{if(confirm("Delete ALL sessions and messages? This cannot be undone!"))try{for(const J of E)await Je.deleteChatSession(J.session_uuid);j([]),x([]),f(null),await je(),A("STATUS: ALL SESSIONS DELETED")}catch(J){console.error("Failed to delete all sessions:",J),A("ERROR: Failed to delete all sessions")}},Oe=async()=>{if(!m.trim())return;if(p||(await ie(),await new Promise(Te=>setTimeout(Te,100))),!p){A("ERROR: No active session");return}const J=await Je.getActiveLLMConfig();if(!J){A("ERROR: No active LLM provider configured"),alert(`LLM Configuration Error: No active provider configured

Please configure your LLM settings first.`),M(!0);return}if(J.provider!=="ollama"&&!J.api_key){A(`ERROR: ${J.provider} requires API key`),alert(`LLM Configuration Error: ${J.provider} requires an API key

Please configure your LLM settings first.`),M(!0);return}const se=m.trim();b(""),T(!0),G(""),A(`STATUS: CALLING ${P.toUpperCase()} API...`);try{const Te=await Je.addChatMessage({session_uuid:p,role:"user",content:se});x(ue=>[...ue,Te]);const Me=h.map(ue=>({role:ue.role,content:ue.content}));if(W.length>0){console.log("[ChatTab]  Active contexts linked:",W.length);const ue=W.map(Ne=>Ne.id);console.log("[ChatTab]  Context IDs:",ue);const re=await qn.formatMultipleContexts(ue,"markdown");console.log("[ChatTab]  Formatted context data length:",re.length,"characters"),console.log(`[ChatTab]  Context data preview (first 500 chars):
`,re.substring(0,500));const ke={role:"system",content:`The following recorded data contexts are provided for your reference:

${re}

---

Please use this information to help answer the user's questions.`};Me.unshift(ke),console.log("[ChatTab]  System message with context added to conversation"),console.log("[ChatTab]  Total conversation history length:",Me.length)}else console.log("[ChatTab]  No active contexts linked");let Qe=[];try{const{mcpToolService:ue}=await Br(async()=>{const{mcpToolService:re}=await Promise.resolve().then(()=>bk);return{mcpToolService:re}},void 0);Qe=await ue.getAllTools()}catch{}le.current="";const ye=Qe.length>0?await Pp.chatWithTools(se,Me,Qe,(ue,re)=>{re?wa.flushSync(()=>{T(!1),G(""),A("STATUS: READY")}):(le.current+=ue,wa.flushSync(()=>{G(ke=>ke+ue)}))},(ue,re,ke)=>{ke?(console.log(`[Tool Result] ${ue}`,ke),A("STATUS: Processing response...")):(console.log(`[Tool Call] ${ue}`,re),A("STATUS: Fetching data..."))}):await Pp.chat(se,Me,(ue,re)=>{re?wa.flushSync(()=>{T(!1),G(""),A("STATUS: READY")}):(le.current+=ue,wa.flushSync(()=>{G(ke=>ke+ue)}))});if(ye.error){const ue=await Je.addChatMessage({session_uuid:p,role:"assistant",content:` Error: ${ye.error}

Please check your LLM configuration and try again.`});x(re=>[...re,ue]),T(!1),G(""),A(`ERROR: ${ye.error}`)}else{const ue=ye.content||le.current||"(No response generated)",re=await Je.addChatMessage({session_uuid:p,role:"assistant",content:ue,provider:J.provider,model:J.model,tokens_used:ye.usage?.totalTokens});x(ke=>[...ke,re]),T(!1),G(""),le.current=""}await de(),await je()}catch(Te){console.error("Chat error:",Te);const Me=await Je.addChatMessage({session_uuid:p,role:"assistant",content:` Unexpected error: ${Te instanceof Error?Te.message:"Unknown error"}`});x(Qe=>[...Qe,Me]),T(!1),G(""),A("STATUS: ERROR")}},q=Y?E.filter(J=>J.title.toLowerCase().includes(Y.toLowerCase())):E,ee=J=>{if(!J)return"00:00:00";try{const se=typeof J=="string"?new Date(J):J;return isNaN(se.getTime())?"00:00:00":se.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(se){return console.error("Error formatting time:",se,J),"00:00:00"}},ce=J=>{if(!J)return"00:00";try{const se=new Date(J);if(isNaN(se.getTime()))return"00:00";const Me=Math.floor((new Date().getTime()-se.getTime())/(1e3*60*60));return Me<24?se.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}):Me<168?se.toLocaleDateString("en-US",{weekday:"short",hour:"2-digit",minute:"2-digit"}):se.toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(se){return console.error("Error formatting session time:",se,J),"00:00"}},Ce=()=>t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",backgroundColor:r.panel},children:t.jsxs("div",{style:{textAlign:"center",padding:"24px"},children:[t.jsx(xi,{size:48,color:r.primary,style:{marginBottom:"16px"}}),t.jsx("div",{style:{color:r.primary,fontSize:"20px",fontWeight:"bold",marginBottom:"8px"},children:"FINCEPT AI ASSISTANT"}),t.jsx("div",{style:{color:r.text,fontSize:"14px",marginBottom:"16px"},children:"Financial Intelligence System"}),t.jsxs("div",{style:{color:r.warning,fontSize:"12px",marginBottom:"16px"},children:["Provider: ",P.toUpperCase()," | Model: ",Of.getActiveConfig().model]}),t.jsx("button",{onClick:ie,style:{backgroundColor:r.primary,color:"black",border:"none",padding:"10px 20px",fontSize:"12px",fontWeight:"bold",borderRadius:"4px",cursor:"pointer"},children:"START NEW CHAT"})]})}),be=J=>{try{return t.jsx("div",{style:{marginBottom:"12px"},children:t.jsx("div",{style:{display:"flex",justifyContent:J.role==="user"?"flex-end":"flex-start",marginBottom:"4px"},children:t.jsxs("div",{style:{maxWidth:"85%",minWidth:"120px",backgroundColor:r.panel,border:`1px solid ${J.role==="user"?r.warning:r.primary}`,borderRadius:"4px",padding:"10px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[J.role==="user"?t.jsx(Kp,{size:12,color:r.warning}):t.jsx(xi,{size:12,color:r.primary}),t.jsx("span",{style:{color:J.role==="user"?r.warning:r.primary,fontSize:"11px",fontWeight:"bold"},children:J.role==="user"?"YOU":"AI"}),t.jsx(uo,{size:10,color:r.textMuted}),t.jsx("span",{style:{color:r.textMuted,fontSize:"10px"},children:ee(J.timestamp)}),J.provider&&t.jsxs("span",{style:{color:r.textMuted,fontSize:"10px"},children:["| ",J.provider]})]}),J.role==="assistant"&&J.content?t.jsx(vg,{content:J.content}):t.jsx("div",{style:{color:r.text,fontSize:"13px",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:J.content||"(Empty message)"})]})})},J.id)}catch(se){return console.error("Error rendering message:",se,J),t.jsx("div",{style:{marginBottom:"12px",color:r.alert},children:"Error rendering message"},J.id)}},We=()=>O?t.jsx("div",{style:{marginBottom:"12px",display:"flex",justifyContent:"flex-start"},children:t.jsxs("div",{style:{maxWidth:"85%",backgroundColor:r.panel,border:`2px solid ${r.primary}`,borderRadius:"4px",padding:"10px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[t.jsx(xi,{size:12,color:r.primary}),t.jsx("span",{style:{color:r.primary,fontSize:"11px",fontWeight:"bold"},children:"AI TYPING..."})]}),t.jsxs("div",{style:{color:r.text,fontSize:"13px",lineHeight:"1.5",whiteSpace:"pre-wrap"},children:[O,t.jsx("span",{style:{color:r.primary},children:""})]})]})}):null;return t.jsxs("div",{style:{height:"100%",backgroundColor:r.background,color:r.text,fontFamily:i,fontWeight:o,fontStyle:a,display:"flex",flexDirection:"column",fontSize:n.body},children:[t.jsx("style",{children:`
        /* Transparent/hidden scrollbar styling */
        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        *::-webkit-scrollbar-track {
          background: transparent;
        }
        *::-webkit-scrollbar-thumb {
          background: rgba(255, 165, 0, 0.2);
          border-radius: 4px;
        }
        *::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 165, 0, 0.4);
        }
        /* For Firefox */
        * {
          scrollbar-width: thin;
          scrollbar-color: rgba(255, 165, 0, 0.2) transparent;
        }
      `}),t.jsxs("div",{style:{backgroundColor:r.panel,borderBottom:`1px solid ${r.textMuted}`,padding:"6px 10px",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t.jsx("span",{style:{color:r.primary,fontWeight:"bold",fontSize:"12px"},children:"FINCEPT AI"}),t.jsx("span",{style:{color:r.textMuted},children:"|"}),t.jsx("span",{style:{color:r.warning,fontSize:"10px"},children:P.toUpperCase()}),t.jsx("span",{style:{color:r.textMuted},children:"|"}),t.jsx(Tl,{compact:!0})]}),t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsxs("button",{onClick:()=>M(!0),style:{backgroundColor:r.background,border:`1px solid ${r.textMuted}`,color:r.text,padding:"4px 8px",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Mn,{size:12}),"CONFIG"]}),t.jsxs("button",{onClick:ie,style:{backgroundColor:r.primary,border:"none",color:"black",padding:"4px 8px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(wn,{size:12}),"NEW"]})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsxs("div",{style:{width:"250px",backgroundColor:r.panel,borderRight:`1px solid ${r.textMuted}`,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[t.jsxs("div",{style:{color:r.warning,fontSize:"11px",fontWeight:"bold"},children:["SESSIONS (",B.totalSessions,")"]}),E.length>0&&t.jsx("button",{onClick:Ee,style:{backgroundColor:r.alert,color:r.text,border:"none",padding:"2px 6px",fontSize:"8px",cursor:"pointer",fontWeight:"bold"},title:"Delete all sessions",children:"DELETE ALL"})]}),t.jsxs("div",{style:{position:"relative",marginBottom:"8px"},children:[t.jsx(Ho,{size:12,color:r.textMuted,style:{position:"absolute",left:"6px",top:"6px"}}),t.jsx("input",{id:"session-search",type:"text",placeholder:"Search chats...",value:Y,onChange:J=>he(J.target.value),style:{width:"100%",backgroundColor:r.background,border:`1px solid ${r.textMuted}`,color:r.text,padding:"4px 4px 4px 24px",fontSize:"10px"}})]}),t.jsxs("div",{style:{fontSize:"9px",color:r.textMuted,marginBottom:"6px"},children:["Messages: ",B.totalMessages," | Tokens: ",B.totalTokens.toLocaleString()]})]}),t.jsx("div",{ref:ge,style:{flex:1,overflow:"auto",padding:"0 8px 8px"},children:q.map(J=>t.jsxs("div",{style:{backgroundColor:p===J.session_uuid?r.primary+"30":r.background,border:`1px solid ${p===J.session_uuid?r.primary:r.textMuted}`,padding:"6px",marginBottom:"4px",cursor:Z===J.session_uuid?"default":"pointer"},onClick:()=>Z!==J.session_uuid&&ve(J.session_uuid),children:[Z===J.session_uuid?t.jsxs("div",{style:{marginBottom:"3px",display:"flex",gap:"4px",alignItems:"center"},children:[t.jsx("input",{type:"text",value:Q,onChange:se=>_(se.target.value),onKeyDown:se=>{se.key==="Enter"&&qe(J.session_uuid),se.key==="Escape"&&Ie()},autoFocus:!0,style:{flex:1,backgroundColor:r.background,border:`1px solid ${r.primary}`,color:r.text,fontSize:"11px",padding:"2px 4px",fontFamily:"Consolas, monospace"}}),t.jsx("button",{onClick:se=>{se.stopPropagation(),qe(J.session_uuid)},style:{backgroundColor:"transparent",color:r.secondary,border:"none",cursor:"pointer",padding:"0",display:"flex"},children:t.jsx(Es,{size:12})}),t.jsx("button",{onClick:se=>{se.stopPropagation(),Ie()},style:{backgroundColor:"transparent",color:r.alert,border:"none",cursor:"pointer",padding:"0",display:"flex"},children:t.jsx(ln,{size:12})})]}):t.jsx("div",{style:{color:r.text,fontSize:"11px",marginBottom:"3px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:J.title}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("span",{style:{color:r.textMuted,fontSize:"9px"},children:[J.message_count," msgs  ",ce(J.updated_at)]}),t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsx("button",{onClick:se=>{se.stopPropagation(),$e(J.session_uuid,J.title)},style:{backgroundColor:"transparent",color:r.warning,border:"none",fontSize:"9px",cursor:"pointer",padding:"0",display:"flex"},title:"Rename session",children:t.jsx(ug,{size:10})}),t.jsx("button",{onClick:se=>{se.stopPropagation(),Ae(J.session_uuid)},style:{backgroundColor:"transparent",color:r.alert,border:"none",fontSize:"9px",cursor:"pointer",padding:"0",display:"flex"},title:"Delete session",children:t.jsx(On,{size:10})})]})]})]},J.session_uuid))})]}),t.jsxs("div",{style:{flex:1,backgroundColor:r.panel,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"6px 10px",borderBottom:`1px solid ${r.textMuted}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{color:r.text,fontSize:"11px"},children:p?E.find(J=>J.session_uuid===p)?.title||"Chat":"No Active Session"}),p&&t.jsx("button",{onClick:K,style:{backgroundColor:r.alert,color:r.text,border:"none",padding:"3px 8px",fontSize:"9px",cursor:"pointer"},children:"CLEAR"})]}),t.jsx("div",{style:{flex:1,padding:"10px",overflow:"auto",backgroundColor:r.background},children:h.length===0&&!O?Ce():t.jsxs("div",{children:[h.map(be),O&&We(),C&&!O&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",color:r.textMuted,fontSize:"11px"},children:[t.jsx(xi,{size:12}),t.jsx("span",{children:"AI is thinking..."})]}),t.jsx("div",{ref:me})]})}),t.jsxs("div",{style:{padding:"8px",borderTop:`1px solid ${r.textMuted}`},children:[t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsx("textarea",{value:m,onChange:J=>b(J.target.value),onKeyDown:J=>{J.key==="Enter"&&!J.shiftKey&&(J.preventDefault(),Oe())},placeholder:"Type your message... (Shift+Enter for new line)",style:{flex:1,backgroundColor:r.background,border:`1px solid ${r.textMuted}`,color:r.text,padding:"6px",fontSize:"11px",resize:"none",height:"60px",fontFamily:"Consolas, monospace"}}),t.jsxs("button",{onClick:Oe,disabled:!m.trim()||C,style:{backgroundColor:m.trim()&&!C?r.primary:r.textMuted,color:"black",border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:m.trim()&&!C?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Zg,{size:12}),"SEND"]})]}),t.jsx("div",{style:{color:r.textMuted,fontSize:"9px",marginTop:"4px"},children:m.length>0?`${m.length} chars`:k})]})]}),t.jsxs("div",{style:{width:"250px",backgroundColor:r.panel,borderLeft:`1px solid ${r.textMuted}`,padding:"8px",overflow:"auto",display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:r.warning,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"DATA CONTEXTS"}),t.jsx(K9,{chatSessionUuid:p,onContextsChange:oe})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:r.warning,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"QUICK PROMPTS"}),[{cmd:"MARKET TRENDS",prompt:"Analyze current market trends and key insights"},{cmd:"PORTFOLIO",prompt:"Portfolio diversification recommendations"},{cmd:"RISK",prompt:"Investment risk assessment strategies"},{cmd:"TECHNICAL",prompt:"Key technical analysis indicators"}].map(J=>t.jsx("button",{onClick:()=>b(J.prompt),style:{width:"100%",backgroundColor:r.background,color:r.text,border:`1px solid ${r.textMuted}`,padding:"5px",fontSize:"9px",textAlign:"left",cursor:"pointer",marginBottom:"4px"},children:J.cmd},J.cmd))]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:r.warning,fontSize:"11px",fontWeight:"bold",marginBottom:"6px"},children:"SYSTEM INFO"}),t.jsxs("div",{style:{color:r.text,fontSize:"9px",marginBottom:"2px"},children:["Provider: ",P.toUpperCase()]}),t.jsxs("div",{style:{color:r.text,fontSize:"9px",marginBottom:"2px"},children:["Model: ",Of.getActiveConfig().model]}),t.jsxs("div",{style:{color:r.text,fontSize:"9px",marginBottom:"2px"},children:["Temp: ",Of.getActiveConfig().temperature]}),t.jsx("div",{style:{color:r.secondary,fontSize:"9px",marginBottom:"2px"},children:"Streaming: Enabled"}),t.jsxs("div",{style:{marginTop:"6px",paddingTop:"6px",borderTop:`1px solid ${r.textMuted}`},children:[t.jsxs("div",{style:{color:z>0?r.secondary:r.textMuted,fontSize:"9px",marginBottom:"6px"},children:["MCP Tools: ",z>0?`${z} Available `:"None"]}),t.jsx("button",{onClick:()=>e?.("mcp"),style:{width:"100%",backgroundColor:r.primary,color:"black",border:"none",padding:"5px 8px",fontSize:"9px",fontWeight:"bold",cursor:"pointer",marginBottom:"6px",borderRadius:"2px"},title:"Configure MCP servers and tools",children:" MCP INTEGRATION"}),z>0&&!X()&&t.jsxs("div",{style:{color:r.alert,fontSize:"8px",marginTop:"4px",padding:"4px",backgroundColor:r.background,border:`1px solid ${r.alert}`,borderRadius:"2px"},children:[" ",P.toUpperCase()," doesn't support MCP tools"]})]})]})]})]}),t.jsx(Y9,{isOpen:R,onClose:()=>M(!1),onSave:()=>{I(Of.getActiveProvider()),A("STATUS: SETTINGS UPDATED")},onNavigateToSettings:s})]})},X9={BASE_URL:"https://finceptbackend.share.zrok.io"},xb=s=>`${X9.BASE_URL}${s}`;async function An(s,e="GET",r,n){try{const i={method:e,headers:{"Content-Type":"application/json","X-API-Key":r}};n&&(e==="POST"||e==="PUT")&&(i.body=JSON.stringify(n)),console.log(`[UserAPI] ${e} ${s}`,n||"");const o=await tn(xb(s),i),a=await o.json();return console.log("[UserAPI] Response:",a),{success:o.ok,data:a,error:o.ok?void 0:a.detail||a.error||"Request failed",status_code:o.status}}catch(i){return console.error(`[UserAPI] Error in ${e} ${s}:`,i),{success:!1,error:i instanceof Error?i.message:"Network error",status_code:500}}}class bo{static async getUserProfile(e){return An("/user/profile","GET",e)}static async updateUserProfile(e,r){return An("/user/profile","PUT",e,r)}static async regenerateApiKey(e){return An("/user/regenerate-api-key","POST",e)}static async getUserUsage(e){return An("/user/usage","GET",e)}static async getUserCredits(e){return An("/user/credits","GET",e)}static async deleteUserAccount(e,r){return An("/user/account","DELETE",e,r)}static async subscribeToDatabase(e,r){return An("/user/subscribe","POST",e,{database_name:r})}static async getUserSubscriptions(e){return An("/user/subscriptions","GET",e)}static async getUserTransactions(e){return An("/user/transactions","GET",e)}static async getUserSubscription(e){return An("/payment/subscription","GET",e)}static async getUsageDetails(e){return An("/payment/usage","GET",e)}static async cancelSubscription(e){return An("/payment/cancel","POST",e)}static async reactivateSubscription(e){return An("/payment/reactivate","POST",e)}static async getPaymentHistory(e,r=1,n=10){return An(`/payment/payments?page=${r}&limit=${n}`,"GET",e)}static async getPaymentDetails(e,r){return An(`/payment/payments/${r}`,"GET",e)}static async getGuestStatus(e){return An("/guest/status","GET",e)}static async extendGuestSession(e){return An("/guest/extend","POST",e)}static async getGuestUsage(e){return An("/guest/usage","GET",e)}static async deleteGuestSession(e){return An("/guest/session","DELETE",e)}static async getUserTickets(e){return An("/support/tickets","GET",e)}static async createTicket(e,r){return An("/support/tickets","POST",e,r)}static async getTicketDetails(e,r){return An(`/support/tickets/${r}`,"GET",e)}static async updateTicket(e,r,n){return An(`/support/tickets/${r}`,"PUT",e,{status:n})}static async addTicketMessage(e,r,n){return An(`/support/tickets/${r}/messages`,"POST",e,{message:n})}static async getSupportStats(e){return An("/support/stats","GET",e)}static async subscribeToNewsletter(e,r){try{const n=await tn(xb("/support/newsletter/subscribe"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,name:r,source:"terminal"})}),i=await n.json();return{success:n.ok,data:i,error:n.ok?void 0:i.detail||"Subscription failed",status_code:n.status}}catch(n){return{success:!1,error:n instanceof Error?n.message:"Network error",status_code:500}}}static async checkNewsletterStatus(e){try{const r=await tn(xb(`/support/newsletter/status?email=${encodeURIComponent(e)}`)),n=await r.json();return{success:r.ok,data:n,error:r.ok?void 0:n.detail,status_code:r.status}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Network error",status_code:500}}}}const J9=()=>{const{colors:s}=Er(),{session:e,logout:r}=Ao(),n=gA(),[i,o]=S.useState(new Date),[a,l]=S.useState("overview"),[d,p]=S.useState(!1),[f,h]=S.useState(null),[x,m]=S.useState([]),[b,w]=S.useState([]),[y,C]=S.useState([]),[T,E]=S.useState(null);S.useEffect(()=>{const fe=setInterval(()=>o(new Date),1e3);return()=>clearInterval(fe)},[]);const j=()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()},k=async(fe=!1)=>{if(e?.api_key){p(!0);try{if(a==="usage")if(e.user_type==="guest"){const Q=await bo.getGuestUsage(e.api_key||"");Q.success&&h(Q.data)}else{const Q=await bo.getUserUsage(e.api_key||"");Q.success&&h(Q.data);const _=await bo.getUsageDetails(e.api_key||"");_.success&&E(_.data)}else if(a==="payments"){const Q=await bo.getPaymentHistory(e.api_key||"",1,20);Q.success&&m(Q.data?.payments||Q.data||[])}else if(a==="subscriptions"){const Q=await bo.getUserSubscriptions(e.api_key||"");Q.success&&w(Q.data?.subscriptions||Q.data||[])}else if(a==="support"){const Q=await bo.getUserTickets(e.api_key||"");Q.success&&C(Q.data?.tickets||Q.data||[])}fe&&alert(" Profile data refreshed successfully!")}catch(Q){console.error("Error fetching data:",Q),fe&&alert(" Failed to refresh data. Please try again.")}finally{p(!1)}}};S.useEffect(()=>{k()},[a,e]);const A=async()=>{confirm("Are you sure you want to logout?")&&await r()},R=async()=>{if(e?.api_key&&confirm("Are you sure you want to regenerate your API key? Your old key will be invalidated.")){p(!0);const fe=await bo.regenerateApiKey(e.api_key||"");p(!1),fe.success?(alert(`New API Key: ${fe.data?.new_api_key||"Check your profile"}

Please save this key securely. You will need to re-login.`),await r()):alert(`Failed to regenerate API key: ${fe.error}`)}},M=async()=>{if(!e?.api_key)return;p(!0);const fe=await bo.extendGuestSession(e.api_key||"");p(!1),fe.success?alert("Session extended successfully!"):alert(`Failed to extend session: ${fe.error}`)},P=async()=>{if(e?.api_key&&confirm("Are you sure you want to cancel your subscription? It will remain active until the end of the billing period.")){p(!0);const fe=await bo.cancelSubscription(e.api_key||"");p(!1),fe.success?alert("Subscription cancelled successfully. It will remain active until the end of your billing period."):alert(`Failed to cancel subscription: ${fe.error}`)}},I=async()=>{if(!e?.api_key)return;if(prompt('This action cannot be undone. Type "DELETE MY ACCOUNT" to confirm:')==="DELETE MY ACCOUNT"){p(!0);const Q=await bo.deleteUserAccount(e.api_key||"",{confirm:!0});p(!1),Q.success?(alert("Your account has been deleted."),await r()):alert(`Failed to delete account: ${Q.error}`)}},O=fe=>fe?new Date(fe).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",G=fe=>`$${(fe/100).toFixed(2)}`,B=()=>{const fe=e?.device_id?.substring(0,30)+"..."||"Unknown",Q=e?.requests_today||f?.requests_today||0,_=e?.daily_limit||f?.daily_limit||50,Y=Math.max(0,_-Q),he=Q/_*100;return t.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",backgroundColor:s.background,overflow:"hidden"},children:[t.jsx("div",{style:{backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,padding:"4px 8px",flexShrink:0},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.primary,fontWeight:"bold"},children:"FINCEPT TERMINAL GUEST PROFILE"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:s.text},children:[i.toISOString().replace("T"," ").substring(0,19)," UTC"]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.textMuted},children:"REQUESTS:"}),t.jsxs("span",{style:{color:s.accent},children:[Q,"/",_]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.textMuted},children:"REMAINING:"}),t.jsx("span",{style:{color:Y>10?s.secondary:s.alert},children:Y}),t.jsx("button",{onClick:()=>k(!0),disabled:d,style:{marginLeft:"auto",padding:"2px 8px",backgroundColor:s.primary,color:s.background,border:"none",borderRadius:"2px",fontSize:"11px",cursor:d?"not-allowed":"pointer",fontWeight:"bold",opacity:d?.5:1},children:d?"LOADING...":" REFRESH"})]})}),t.jsx("div",{style:{backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,padding:"2px 4px",flexShrink:0},children:t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"2px"},children:[{key:"F1",label:"OVERVIEW",screen:"overview"},{key:"F2",label:"USAGE",screen:"usage"},{key:"F3",label:"SETTINGS",screen:"settings"},{key:"F4",label:"REFRESH",action:"refresh"},{key:"F5",label:"PRICING",action:"pricing"},{key:"F6",label:"LOGOUT",action:"logout"}].map(me=>t.jsxs("button",{onClick:()=>{me.action==="refresh"?window.location.reload():me.action==="extend"?M():me.action==="pricing"?n.navigateToPricing():me.action==="logout"?A():me.screen&&l(me.screen)},disabled:d&&(me.action==="extend"||me.action==="refresh"),style:{backgroundColor:a===me.screen?s.primary:s.background,border:`1px solid ${s.textMuted}`,color:a===me.screen?s.background:s.text,padding:"2px 4px",fontSize:"12px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:a===me.screen?"bold":"normal",cursor:"pointer"},children:[t.jsxs("span",{style:{color:s.warning},children:[me.key,":"]}),t.jsx("span",{style:{marginLeft:"2px"},children:me.label})]},me.key))})}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"4px",backgroundColor:"#050505"},children:[a==="overview"&&t.jsxs("div",{style:{display:"flex",gap:"4px",height:"100%"},children:[t.jsxs("div",{style:{flex:1,backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"SESSION INFORMATION"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{marginBottom:"8px",fontSize:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Account Type:"}),t.jsx("span",{style:{color:s.warning,fontWeight:"bold"},children:"GUEST"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Session Expires:"}),t.jsx("span",{style:{color:s.alert},children:e?.expires_at?O(e.expires_at):"N/A"})]}),t.jsxs("div",{style:{marginBottom:"2px",paddingTop:"4px",borderTop:`1px solid ${s.textMuted}`},children:[t.jsx("span",{style:{color:s.textMuted},children:"Device ID:"}),t.jsx("div",{style:{color:s.text,fontSize:"11px",marginTop:"2px",wordBreak:"break-all"},children:fe})]}),t.jsxs("div",{style:{marginBottom:"2px",paddingTop:"4px",borderTop:`1px solid ${s.textMuted}`},children:[t.jsx("span",{style:{color:s.textMuted},children:"API Key:"}),t.jsx("div",{style:{color:s.text,fontSize:"11px",marginTop:"2px",wordBreak:"break-all"},children:e?.api_key?`${e.api_key.substring(0,40)}...`:"N/A"})]})]}),t.jsxs("div",{style:{marginTop:"12px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"DAILY USAGE STATS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{fontSize:"12px",marginBottom:"6px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Today's Requests:"}),t.jsxs("span",{style:{color:s.text,fontWeight:"bold"},children:[Q,"/",_]})]}),t.jsx("div",{style:{backgroundColor:s.background,height:"6px",marginBottom:"4px",border:`1px solid ${s.textMuted}`},children:t.jsx("div",{style:{width:`${he}%`,height:"100%",backgroundColor:Y>10?s.secondary:s.alert,transition:"width 0.3s"}})}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Remaining:"}),t.jsx("span",{style:{color:Y>10?s.secondary:s.alert,fontWeight:"bold"},children:Y})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Status:"}),t.jsx("span",{style:{color:s.secondary},children:"ACTIVE"})]})]})]})]}),t.jsxs("div",{style:{flex:1,backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"UPGRADE TO FULL ACCESS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{fontSize:"12px",color:s.text,lineHeight:"1.4",marginBottom:"8px"},children:[t.jsx("div",{style:{color:s.warning,fontWeight:"bold",marginBottom:"4px"},children:"Create a free account to unlock:"}),t.jsxs("div",{style:{marginLeft:"8px"},children:[t.jsx("div",{children:"- Unlimited API requests"}),t.jsx("div",{children:"- Permanent API key"}),t.jsx("div",{children:"- All database access"}),t.jsx("div",{children:"- Premium features & tools"}),t.jsx("div",{children:"- Data marketplace"}),t.jsx("div",{children:"- Advanced analytics"})]})]}),t.jsx("button",{onClick:()=>n.navigateToPricing(),style:{width:"100%",padding:"6px",backgroundColor:s.primary,border:"none",color:s.background,fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"VIEW PRICING PLANS"})]})]}),a==="usage"&&z(),a==="settings"&&Z()]}),t.jsx("div",{style:{borderTop:`1px solid ${s.textMuted}`,backgroundColor:s.panel,padding:"2px 8px",fontSize:"11px",color:s.textMuted,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"FinceptTerminal v3.0.11 | Guest Session"}),t.jsxs("span",{children:["Device: ",e?.device_id?.substring(0,20)||"UNKNOWN"," | Status: ",d?"UPDATING":"READY"]})]})})]})},F=()=>{const fe=e?.user_info,Q=fe?.account_type||"free",_=e?.subscription?.data?.has_subscription||e?.subscription?.has_subscription,Y=e?.subscription?.data?.subscription?.plan||e?.subscription?.subscription?.plan,he=e?.subscription?.data?.subscription?.status||e?.subscription?.subscription?.status,me=fe?.credit_balance??0,ge={free:s.textMuted,starter:s.info,professional:s.purple,enterprise:s.primary,unlimited:s.warning}[Q]||s.text,le=f?.total_requests||0,X=f?.requests_today||f?.today_requests||0;return t.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",backgroundColor:s.background,overflow:"hidden"},children:[t.jsx("div",{style:{backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,padding:"4px 8px",flexShrink:0},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.primary,fontWeight:"bold"},children:"FINCEPT TERMINAL PROFILE"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.accent,fontWeight:"bold"},children:fe?.username?.toUpperCase()||fe?.email?.split("@")[0]?.toUpperCase()||"USER"}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsxs("span",{style:{color:s.text},children:[i.toISOString().replace("T"," ").substring(0,19)," UTC"]}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.textMuted},children:"CREDITS:"}),t.jsx("span",{style:{color:me>0?s.secondary:s.alert,fontWeight:"bold"},children:me.toFixed(2)}),t.jsx("span",{style:{color:s.text},children:"|"}),t.jsx("span",{style:{color:s.textMuted},children:"PLAN:"}),t.jsx("span",{style:{color:ge,fontWeight:"bold"},children:Q.toUpperCase()}),t.jsx("button",{onClick:()=>k(!0),disabled:d,style:{marginLeft:"auto",padding:"3px 12px",backgroundColor:s.primary,color:s.background,border:"none",borderRadius:"3px",fontSize:"11px",cursor:d?"not-allowed":"pointer",fontWeight:"bold",opacity:d?.5:1},children:d?"LOADING...":" REFRESH"})]})}),t.jsx("div",{style:{backgroundColor:s.panel,borderBottom:`1px solid ${s.textMuted}`,padding:"2px 4px",flexShrink:0},children:t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"2px"},children:[{key:"F1",label:"OVERVIEW",screen:"overview"},{key:"F2",label:"USAGE",screen:"usage"},{key:"F3",label:"PAYMENTS",screen:"payments"},{key:"F4",label:"SUBS",screen:"subscriptions"},{key:"F5",label:"SUPPORT",screen:"support"},{key:"F6",label:"SETTINGS",screen:"settings"},{key:"F7",label:"CREDITS",action:"pricing"},{key:"F8",label:"REGEN",action:"regen"},{key:"F9",label:"",screen:""},{key:"F10",label:"",screen:""},{key:"F11",label:"FULL",action:"fullscreen"},{key:"F12",label:"LOGOUT",action:"logout"}].map(V=>t.jsxs("button",{onClick:()=>{V.action==="logout"?A():V.action==="pricing"?n.navigateToPricing():V.action==="regen"?R():V.action==="fullscreen"?j():V.screen&&l(V.screen)},disabled:!V.label||d&&V.action==="regen",style:{backgroundColor:a===V.screen?s.primary:s.background,border:`1px solid ${s.textMuted}`,color:a===V.screen?s.background:s.text,padding:"2px 4px",fontSize:"12px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:a===V.screen?"bold":"normal",cursor:V.label?"pointer":"default",opacity:V.label?1:.3},children:[t.jsxs("span",{style:{color:s.warning},children:[V.key,":"]}),V.label&&t.jsx("span",{style:{marginLeft:"2px"},children:V.label})]},V.key))})}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"4px",backgroundColor:"#050505"},children:[a==="overview"&&t.jsxs("div",{style:{display:"flex",gap:"4px",height:"100%"},children:[t.jsxs("div",{style:{flex:1,backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"CREDIT BALANCE"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[t.jsx("div",{style:{color:s.text,fontSize:"24px",fontWeight:"bold"},children:me.toFixed(2)}),t.jsx("button",{onClick:()=>n.navigateToPricing(),style:{padding:"4px 8px",backgroundColor:s.secondary,border:"none",color:s.background,fontSize:"12px",fontWeight:"bold",cursor:"pointer"},children:"ADD CREDITS"})]}),t.jsx("div",{style:{color:s.textMuted,fontSize:"11px"},children:"Available for API calls and premium features"})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"ACCOUNT DETAILS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Username:"}),t.jsx("span",{style:{color:s.text,fontWeight:"bold"},children:fe?.username||"N/A"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Email:"}),t.jsx("span",{style:{color:s.text},children:fe?.email||"N/A"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Account Type:"}),t.jsx("span",{style:{color:ge,fontWeight:"bold"},children:Q.toUpperCase()})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Member Since:"}),t.jsx("span",{style:{color:s.text},children:O(fe?.created_at)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:s.textMuted},children:"User ID:"}),t.jsxs("span",{style:{color:s.textMuted,fontSize:"11px"},children:["#",fe?.id||"N/A"]})]})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"API AUTHENTICATION"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsx("div",{style:{color:s.textMuted,marginBottom:"2px"},children:"API Key:"}),t.jsx("div",{style:{backgroundColor:s.background,padding:"4px",marginBottom:"4px",border:`1px solid ${s.textMuted}`,fontSize:"11px",wordBreak:"break-all",color:s.text},children:e?.api_key||"No API key available"}),t.jsx("button",{onClick:R,disabled:d,style:{padding:"4px 8px",backgroundColor:s.background,border:`1px solid ${s.purple}`,color:s.purple,fontSize:"12px",fontWeight:"bold",cursor:"pointer",width:"100%"},children:"REGENERATE API KEY"})]})]})]}),t.jsxs("div",{style:{flex:1,backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",overflow:"auto"},children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"SUBSCRIPTION STATUS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),_&&Y?t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Plan:"}),t.jsx("span",{style:{color:s.secondary,fontWeight:"bold"},children:Y.name})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Price:"}),t.jsxs("span",{style:{color:s.text},children:["$",Y.price_usd/100,"/mo"]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"API Calls:"}),t.jsx("span",{style:{color:s.accent,fontWeight:"bold"},children:Y.api_calls_limit===-1?"UNLIMITED":Y.api_calls_limit!=null?Y.api_calls_limit.toLocaleString():"N/A"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Status:"}),t.jsx("span",{style:{color:s.secondary,fontWeight:"bold"},children:he?.toUpperCase()})]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{onClick:P,disabled:d,style:{flex:1,padding:"4px",backgroundColor:s.background,border:`1px solid ${s.alert}`,color:s.alert,fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:()=>n.navigateToPricing(),style:{flex:1,padding:"4px",backgroundColor:s.background,border:`1px solid ${s.info}`,color:s.info,fontSize:"11px",fontWeight:"bold",cursor:"pointer"},children:"CHANGE"})]})]}):t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsx("div",{style:{color:s.warning,marginBottom:"4px",fontWeight:"bold"},children:"No active subscription"}),t.jsxs("div",{style:{color:s.text,marginBottom:"6px",lineHeight:"1.4"},children:[t.jsx("div",{children:"- Unlimited API requests"}),t.jsx("div",{children:"- Priority support"}),t.jsx("div",{children:"- Advanced features"}),t.jsx("div",{children:"- Data marketplace access"})]}),t.jsx("button",{onClick:()=>n.navigateToPricing(),style:{width:"100%",padding:"6px",backgroundColor:s.primary,border:"none",color:s.background,fontSize:"12px",fontWeight:"bold",cursor:"pointer"},children:"VIEW PLANS"})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"API USAGE SUMMARY"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Total Requests:"}),t.jsx("span",{style:{color:s.text},children:le.toLocaleString()})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Today's Requests:"}),t.jsx("span",{style:{color:s.accent},children:X})]})]})]})]})]}),a==="usage"&&z(),a==="payments"&&$(),a==="subscriptions"&&W(),a==="support"&&D(),a==="settings"&&oe()]}),t.jsx("div",{style:{borderTop:`1px solid ${s.textMuted}`,backgroundColor:s.panel,padding:"2px 8px",fontSize:"11px",color:s.textMuted,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs("span",{children:["FinceptTerminal v3.0.11 | User: ",fe?.username||"N/A"]}),t.jsxs("span",{children:["Account: ",Q.toUpperCase()," | Requests: ",X.toLocaleString()," | Status: ",d?"UPDATING":"READY"]})]})})]})},z=()=>t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",height:"100%",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"API USAGE STATISTICS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),d?t.jsx("div",{style:{color:s.textMuted,fontSize:"12px"},children:"Loading usage data..."}):f?t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Total Requests:"}),t.jsx("span",{style:{color:s.text,fontWeight:"bold"},children:f.total_requests?.toLocaleString()||"N/A"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Today's Requests:"}),t.jsx("span",{style:{color:s.accent,fontWeight:"bold"},children:f.requests_today||f.today_requests||0})]}),T&&t.jsx(t.Fragment,{children:t.jsxs("div",{style:{borderTop:`1px solid ${s.textMuted}`,marginTop:"6px",paddingTop:"6px"},children:[t.jsx("div",{style:{color:s.warning,fontWeight:"bold",marginBottom:"4px"},children:"Detailed Usage"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"This Month:"}),t.jsx("span",{style:{color:s.text},children:T.this_month?.toLocaleString()||"N/A"})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Last 30 Days:"}),t.jsx("span",{style:{color:s.text},children:T.last_30_days?.toLocaleString()||"N/A"})]})]})})]}):t.jsx("div",{style:{color:s.textMuted,fontSize:"12px"},children:"No usage data available"})]}),$=()=>t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",height:"100%",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"PAYMENT HISTORY"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),d?t.jsx("div",{style:{color:s.textMuted,fontSize:"12px"},children:"Loading payment history..."}):x.length>0?x.map((fe,Q)=>t.jsxs("div",{style:{backgroundColor:Q%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`2px solid ${s.secondary}`,paddingLeft:"4px",marginBottom:"4px",fontSize:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Amount:"}),t.jsx("span",{style:{color:s.secondary,fontWeight:"bold"},children:G(fe.amount||fe.amount_paid||0)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1px"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Date:"}),t.jsx("span",{style:{color:s.text},children:O(fe.created_at||fe.payment_date)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Status:"}),t.jsx("span",{style:{color:fe.status==="completed"?s.secondary:s.warning,fontWeight:"bold"},children:fe.status?.toUpperCase()||"N/A"})]})]},Q)):t.jsx("div",{style:{color:s.textMuted,fontSize:"12px"},children:"No payment history found"})]}),W=()=>t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",height:"100%",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"DATABASE SUBSCRIPTIONS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),d?t.jsx("div",{style:{color:s.textMuted,fontSize:"12px"},children:"Loading subscriptions..."}):b.length>0?b.map((fe,Q)=>t.jsxs("div",{style:{backgroundColor:Q%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`2px solid ${s.purple}`,paddingLeft:"4px",marginBottom:"4px",fontSize:"12px"},children:[t.jsx("div",{style:{color:s.purple,fontWeight:"bold",marginBottom:"1px"},children:fe.database_name||fe.name||"Unknown Database"}),t.jsxs("div",{style:{color:s.textMuted},children:["Subscribed: ",O(fe.subscribed_at||fe.created_at)]})]},Q)):t.jsx("div",{style:{color:s.textMuted,fontSize:"12px"},children:"No database subscriptions found"})]}),D=()=>t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",height:"100%",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"SUPPORT TICKETS"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),d?t.jsx("div",{style:{color:s.textMuted,fontSize:"12px"},children:"Loading tickets..."}):y.length>0?y.map((fe,Q)=>t.jsxs("div",{style:{backgroundColor:Q%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`2px solid ${s.info}`,paddingLeft:"4px",marginBottom:"4px",fontSize:"12px"},children:[t.jsxs("div",{style:{color:s.info,fontWeight:"bold",marginBottom:"1px"},children:["#",fe.id," - ",fe.subject]}),t.jsxs("div",{style:{color:s.textMuted,marginBottom:"2px",fontSize:"11px"},children:[fe.description?.substring(0,100),"..."]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:s.textMuted},children:"Status:"}),t.jsx("span",{style:{color:fe.status==="closed"?s.secondary:s.warning,fontWeight:"bold"},children:fe.status?.toUpperCase()})]})]},Q)):t.jsxs("div",{children:[t.jsx("div",{style:{color:s.textMuted,fontSize:"12px",marginBottom:"6px"},children:"No support tickets found"}),t.jsx("button",{onClick:()=>alert("Create ticket feature coming soon"),style:{padding:"6px",backgroundColor:s.info,border:"none",color:s.background,fontSize:"12px",fontWeight:"bold",cursor:"pointer"},children:"CREATE NEW TICKET"})]})]}),oe=()=>t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",height:"100%",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"ACCOUNT SETTINGS - DANGER ZONE"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsx("div",{style:{color:s.warning,fontWeight:"bold",marginBottom:"4px"},children:"WARNING"}),t.jsx("div",{style:{color:s.textMuted,marginBottom:"8px",lineHeight:"1.4"},children:"Deleting your account is permanent and cannot be undone. All your data, subscriptions, payment history, and API access will be permanently removed."}),t.jsx("button",{onClick:I,disabled:d,style:{padding:"6px 12px",backgroundColor:s.alert,border:"none",color:s.text,fontSize:"12px",fontWeight:"bold",cursor:"pointer"},children:"DELETE ACCOUNT PERMANENTLY"})]})]}),Z=()=>t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,padding:"4px",height:"100%",overflow:"auto"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:"SESSION SETTINGS - DANGER ZONE"}),t.jsx("div",{style:{borderBottom:`1px solid ${s.textMuted}`,marginBottom:"4px"}}),t.jsxs("div",{style:{fontSize:"12px"},children:[t.jsx("div",{style:{color:s.warning,fontWeight:"bold",marginBottom:"4px"},children:"WARNING"}),t.jsx("div",{style:{color:s.textMuted,marginBottom:"8px",lineHeight:"1.4"},children:"Deleting your guest session will remove all your data. This action cannot be undone."}),t.jsx("button",{onClick:async()=>{if(confirm("Are you sure you want to delete your guest session?")&&e?.api_key){p(!0);const fe=await bo.deleteGuestSession(e.api_key||"");p(!1),fe.success?(alert("Guest session deleted successfully."),await r()):alert(`Failed to delete session: ${fe.error}`)}},disabled:d,style:{padding:"6px 12px",backgroundColor:s.alert,border:"none",color:s.text,fontSize:"12px",fontWeight:"bold",cursor:"pointer"},children:"DELETE SESSION PERMANENTLY"})]})]});return e?e.user_type==="guest"?B():F():t.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:s.background,color:s.text},children:t.jsxs("div",{style:{textAlign:"center",fontSize:"12px"},children:[t.jsx("div",{style:{color:s.alert,marginBottom:"8px",fontWeight:"bold"},children:"NO SESSION"}),t.jsx("div",{style:{color:s.textMuted},children:"Unable to load profile"})]})})},Q9={BASE_URL:"https://finceptbackend.share.zrok.io"},Z9=s=>`${Q9.BASE_URL}${s}`,$s=async(s,e,r,n,i=!1)=>{try{const o={...i?{}:{"Content-Type":"application/json"},...n},a=Z9(e);console.log(" Making marketplace request:",{method:s,url:a,endpoint:e,isFormData:i,headers:{...o,"X-API-Key":o["X-API-Key"]?"[REDACTED]":void 0}});const l={method:s,headers:o,mode:"cors"};r&&(i?l.body=r:(s==="POST"||s==="PUT")&&(l.body=JSON.stringify(r)));const d=await tn(a,l);console.log(" Marketplace response received:",{status:d.status,statusText:d.statusText,url:d.url});const p=await d.text();console.log(" Raw marketplace response text:",p.substring(0,200));let f;try{f=JSON.parse(p),console.log(" Parsed marketplace JSON:",f)}catch(h){return console.error(" Marketplace JSON parse failed:",h),{success:!1,error:`Invalid JSON response: ${p.substring(0,100)}...`,status_code:d.status}}return{success:d.ok,data:f,status_code:d.status,error:d.ok?void 0:f.message||`HTTP ${d.status}`}}catch(o){return console.error(" Marketplace request failed:",o),o instanceof TypeError&&o.message.includes("Failed to fetch")?{success:!1,error:"Network error: Unable to connect to server. Please check your internet connection."}:{success:!1,error:o instanceof Error?o.message:"Network error"}}};class zs{static async uploadDataset(e,r,n){try{const i=new FormData;i.append("file",r);const o={title:n.title,description:n.description,category:n.category,price_tier:n.price_tier,...n.tags&&n.tags.length>0?{tags:n.tags}:{}},a=JSON.stringify(o);console.log("Upload metadata:",o);const l=`/marketplace/upload?metadata=${encodeURIComponent(a)}`;return $s("POST",l,i,{"X-API-Key":e},!0)}catch(i){return console.error("Upload dataset error:",i),{success:!1,error:i instanceof Error?i.message:"Upload failed"}}}static async browseDatasets(e,r){const n=new URLSearchParams;r?.category&&n.append("category",r.category),r?.search&&n.append("search",r.search),r?.price_tier&&n.append("price_tier",r.price_tier),r?.page&&n.append("page",r.page.toString()),r?.limit&&n.append("limit",r.limit.toString()),r?.sort_by&&n.append("sort_by",r.sort_by),r?.sort_order&&n.append("sort_order",r.sort_order);const i=`/marketplace/datasets${n.toString()?`?${n.toString()}`:""}`;return $s("GET",i,void 0,{"X-API-Key":e})}static async getDatasetDetails(e,r){return $s("GET",`/marketplace/datasets/${r}`,void 0,{"X-API-Key":e})}static async purchaseDataset(e,r,n){return $s("POST",`/marketplace/datasets/${r}/purchase`,n||{payment_method:"subscription_credit"},{"X-API-Key":e})}static async downloadDataset(e,r){return $s("POST",`/marketplace/datasets/${r}/download`,void 0,{"X-API-Key":e})}static async getUserPurchases(e,r=1,n=20){return $s("GET",`/marketplace/my-purchases?page=${r}&limit=${n}`,void 0,{"X-API-Key":e})}static async getPricingTiers(e){return $s("GET","/marketplace/pricing",void 0,{"X-API-Key":e})}static async getMyDatasets(e,r=1,n=20,i){const o=new URLSearchParams;return o.append("page",r.toString()),o.append("limit",n.toString()),i&&o.append("status",i),$s("GET",`/marketplace/my-datasets?${o.toString()}`,void 0,{"X-API-Key":e})}static async updateDataset(e,r,n){return $s("PATCH",`/marketplace/datasets/${r}`,n,{"X-API-Key":e})}static async deleteDataset(e,r){return $s("DELETE",`/marketplace/datasets/${r}`,void 0,{"X-API-Key":e})}static async getDatasetAnalytics(e){return $s("GET","/marketplace/my-datasets/analytics",void 0,{"X-API-Key":e})}static async getAdminRevenueAnalytics(e){return $s("GET","/marketplace/admin/revenue-analytics",void 0,{"X-API-Key":e})}static async getMarketplaceStats(e){return $s("GET","/marketplace/admin/stats",void 0,{"X-API-Key":e})}static async getPendingDatasets(e){return $s("GET","/marketplace/admin/pending-datasets",void 0,{"X-API-Key":e})}static async approveDataset(e,r){return $s("POST",`/marketplace/admin/datasets/${r}/approve`,void 0,{"X-API-Key":e})}static async rejectDataset(e,r,n){return $s("POST",`/marketplace/admin/datasets/${r}/reject`,{reason:n},{"X-API-Key":e})}}const eH=()=>{const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),o={ORANGE:s.primary,WHITE:s.text,RED:s.alert,GREEN:s.secondary,YELLOW:s.warning,GRAY:s.textMuted,BLUE:s.info,PURPLE:s.purple,CYAN:s.accent,DARK_BG:s.background,PANEL_BG:s.panel},{session:a}=Ao(),[l,d]=S.useState("BROWSE"),[p,f]=S.useState(null),[h,x]=S.useState("ALL"),[m,b]=S.useState(""),[w,y]=S.useState(!1),[C,T]=S.useState([]),[E,j]=S.useState([]),[k,A]=S.useState(!1),[R,M]=S.useState(1),[P,I]=S.useState(1),[O,G]=S.useState([]),[B,F]=S.useState(null),[z,$]=S.useState({title:"",description:"",category:"stocks",price_tier:"free",tags:""}),W=async()=>{if(a?.api_key){A(!0);try{const X=await zs.browseDatasets(a.api_key,{category:h==="ALL"?void 0:h,search:m||void 0,page:R,limit:20,sort_by:"uploaded_at",sort_order:"desc"});if(console.log(" Browse datasets response:",X),X.success&&X.data){const V=X.data,de=V.data?.datasets||V.datasets||[],_e=(V.data?.pagination||V.pagination||{}).total_pages||V.total_pages||1;console.log(" Raw datasets from API:",de);const Re=de.map(Be=>({id:Be.id,title:Be.title,description:Be.description,category:Be.category,price_tier:Be.pricing?.tier||"free",price_credits:Be.pricing?.price_usd||0,uploader_id:Be.uploader?.id||0,uploader_username:Be.uploader?.username||"Unknown",file_name:Be.metadata?.file_name||"",file_size:(Be.metadata?.file_size_mb||0)*1024*1024,downloads_count:Be.statistics?.download_count||0,rating:Be.statistics?.rating||0,tags:Be.tags||[],status:Be.status||"approved",rejection_reason:Be.rejection_reason,uploaded_at:Be.uploaded_at,updated_at:Be.updated_at||Be.uploaded_at}));console.log(" Transformed datasets:",Re.length,Re),j(Re),I(_e)}else console.error(" Failed to fetch datasets:",X.error),j([])}catch(X){console.error(" Failed to fetch datasets:",X),j([])}finally{A(!1)}}},D=async()=>{if(a?.api_key)try{const X=await zs.getMyDatasets(a.api_key,1,100);if(console.log(" My uploaded datasets response:",X),X.success&&X.data){const de=X.data.datasets||[];console.log(" My uploaded datasets:",de),G(de)}}catch(X){console.error("Failed to fetch my datasets:",X)}};S.useEffect(()=>{W(),D()},[a?.api_key,h,m,R]);const oe=X=>{const V={stocks:"DATA",forex:"DATA",crypto:"DATA",commodities:"DATA",bonds:"DATA",indices:"DATA",economic_data:"SIGNAL"},de={free:"FREE",basic:"MONTHLY",premium:"ANNUAL",enterprise:"USAGE_BASED"};return{id:X.id.toString(),type:V[X.category]||"DATA",name:X.title,vendor:X.uploader_username,category:X.category,price:X.price_credits,pricingModel:de[X.price_tier]||"FREE",shortDescription:X.description,rating:X.rating||0,reviews:X.downloads_count||0,users:X.downloads_count||0,accuracy:"N/A",latency:"N/A",verified:!0,trending:X.downloads_count>100,featured:X.rating>4.5}},Z=w?[...E,...O.filter(X=>!E.some(V=>V.id===X.id))]:E,fe=Z.map(oe),Q=E.reduce((X,V)=>(X[V.category]=(X[V.category]||0)+1,X),{}),_=[{name:"ALL",count:E.length},...Object.entries(Q).map(([X,V])=>({name:X,count:V}))],Y=fe.filter(X=>(h==="ALL"||X.category===h)&&(m===""||X.name.toLowerCase().includes(m.toLowerCase())||X.vendor.toLowerCase().includes(m.toLowerCase()))),he=X=>({DATA:o.BLUE,ALGO:o.GREEN,API:o.PURPLE,MODEL:o.CYAN,SIGNAL:o.YELLOW,PLUGIN:o.ORANGE})[X]||o.WHITE,me=async X=>{if(a?.api_key)try{const V=await zs.purchaseDataset(a.api_key,parseInt(X));V.success?(alert("Purchase successful! Dataset access granted."),T(C.filter(de=>de!==X))):alert(`Purchase failed: ${V.error||"Unknown error"}`)}catch(V){console.error("Purchase error:",V),alert("Purchase failed. Please try again.")}},ge=async()=>{if(!a?.api_key||!B){alert("Please select a file and fill in all details");return}A(!0);try{const X=await zs.uploadDataset(a.api_key,B,{title:z.title,description:z.description,category:z.category,price_tier:z.price_tier,tags:z.tags?z.tags.split(",").map(V=>V.trim()):[]});if(console.log(" Upload response:",X),console.log(" Upload response.data:",X.data),console.log(" Upload response full:",JSON.stringify(X,null,2)),X.success){const V=X.data?.data||X.data;console.log(" Dataset uploaded successfully:",V),console.log(" Dataset ID:",V?.id),console.log(" Dataset full object:",JSON.stringify(V,null,2)),alert(`Dataset uploaded successfully! ID: ${V?.id||"Unknown"}
Title: ${V?.title||"Unknown"}`),F(null),$({title:"",description:"",category:"stocks",price_tier:"free",tags:""}),V?.id&&a?.api_key&&(console.log(` Attempting to fetch dataset ${V.id} directly...`),zs.getDatasetDetails(a.api_key,V.id).then(de=>{console.log(" Dataset details response:",de)})),setTimeout(()=>{console.log(" Refreshing datasets list..."),W(),D(),d("BROWSE")},1500)}else console.error(" Upload failed:",X.error),alert(`Upload failed: ${X.error||"Unknown error"}`)}catch(X){console.error("Upload error:",X),alert("Upload failed. Please try again.")}finally{A(!1)}},le=a?.user_type==="guest"||a?.api_key?.startsWith("fk_guest_");return t.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:o.DARK_BG,color:o.WHITE,fontFamily:"Consolas, monospace",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        .marketplace-scroll::-webkit-scrollbar { width: 8px; }
        .marketplace-scroll::-webkit-scrollbar-track { background: #1a1a1a; }
        .marketplace-scroll::-webkit-scrollbar-thumb { background: #404040; border-radius: 4px; }
        .marketplace-scroll::-webkit-scrollbar-thumb:hover { background: #525252; }
      `}),t.jsx("div",{style:{backgroundColor:o.PANEL_BG,borderBottom:`2px solid ${o.GRAY}`,padding:"8px 16px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"8px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:o.ORANGE,fontWeight:"bold",fontSize:"16px"},children:"FINCEPT MARKETPLACE"}),t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsxs("span",{style:{color:o.CYAN,fontSize:"12px"},children:[E.length," Datasets Available"]}),l==="BROWSE"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsxs("span",{style:{color:o.YELLOW,fontSize:"12px"},children:["My Uploads: ",O.length]}),t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsx("button",{onClick:()=>{W(),D()},disabled:k,style:{padding:"4px 8px",backgroundColor:o.DARK_BG,border:`2px solid ${o.BLUE}`,color:o.BLUE,fontSize:"10px",fontWeight:"bold",cursor:k?"not-allowed":"pointer",fontFamily:"Consolas, monospace"},children:k?" LOADING...":" REFRESH"})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>d("BROWSE"),style:{padding:"6px 12px",backgroundColor:l==="BROWSE"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="BROWSE"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"BROWSE"}),t.jsx("button",{onClick:()=>d("UPLOAD"),style:{padding:"6px 12px",backgroundColor:l==="UPLOAD"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="UPLOAD"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" UPLOAD"}),t.jsx("button",{onClick:()=>d("MY_PURCHASES"),style:{padding:"6px 12px",backgroundColor:l==="MY_PURCHASES"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="MY_PURCHASES"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" MY PURCHASES"}),t.jsx("button",{onClick:()=>d("MY_DATASETS"),style:{padding:"6px 12px",backgroundColor:l==="MY_DATASETS"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="MY_DATASETS"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" MY DATASETS"}),t.jsx("button",{onClick:()=>d("ANALYTICS"),style:{padding:"6px 12px",backgroundColor:l==="ANALYTICS"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="ANALYTICS"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" ANALYTICS"}),t.jsx("button",{onClick:()=>d("PRICING"),style:{padding:"6px 12px",backgroundColor:l==="PRICING"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="PRICING"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" PRICING"}),a?.user_info?.is_admin&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>d("ADMIN_STATS"),style:{padding:"6px 12px",backgroundColor:l==="ADMIN_STATS"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="ADMIN_STATS"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" STATS"}),t.jsx("button",{onClick:()=>d("ADMIN_PENDING"),style:{padding:"6px 12px",backgroundColor:l==="ADMIN_PENDING"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="ADMIN_PENDING"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" PENDING"}),t.jsx("button",{onClick:()=>d("ADMIN_REVENUE"),style:{padding:"6px 12px",backgroundColor:l==="ADMIN_REVENUE"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="ADMIN_REVENUE"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" REVENUE"})]}),t.jsxs("button",{onClick:()=>d("CART"),style:{padding:"6px 12px",backgroundColor:l==="CART"?o.ORANGE:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:l==="CART"?o.DARK_BG:o.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[" CART ",C.length>0&&`(${C.length})`]})]})]})}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:[le&&t.jsx("div",{style:{backgroundColor:o.ORANGE,padding:"12px 20px",borderBottom:`2px solid ${o.GRAY}`},children:t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"16px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flex:1},children:[t.jsx("span",{style:{fontSize:"20px"},children:""}),t.jsxs("div",{children:[t.jsx("div",{style:{color:o.DARK_BG,fontSize:"14px",fontWeight:"bold",marginBottom:"2px"},children:"MARKETPLACE REQUIRES REGISTERED ACCOUNT"}),t.jsx("div",{style:{color:"rgba(0,0,0,0.8)",fontSize:"12px"},children:"Guest users cannot access marketplace features. Please register to upload, purchase, and trade datasets."})]})]})})}),l==="BROWSE"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{padding:"12px",backgroundColor:o.PANEL_BG,borderBottom:`2px solid ${o.GRAY}`},children:[t.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"12px"},children:[t.jsx("input",{type:"text",placeholder:"Search products...",value:m,onChange:X=>b(X.target.value),style:{flex:1,padding:"10px 16px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"14px",fontFamily:"Consolas, monospace"}}),t.jsx("button",{style:{padding:"10px 24px",backgroundColor:o.ORANGE,border:"none",color:o.DARK_BG,fontSize:"14px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"SEARCH"})]}),t.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",alignItems:"center",marginBottom:"8px"},children:_.map(X=>t.jsxs("button",{onClick:()=>x(X.name),style:{padding:"8px 16px",backgroundColor:h===X.name?o.ORANGE:o.DARK_BG,border:`2px solid ${h===X.name?o.ORANGE:o.GRAY}`,color:h===X.name?o.DARK_BG:o.WHITE,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[X.name.toUpperCase()," (",X.count,")"]},X.name))}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"8px",backgroundColor:"rgba(255,255,255,0.05)",borderRadius:"4px"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:w,onChange:X=>y(X.target.checked),style:{cursor:"pointer"}}),t.jsx("span",{style:{color:o.WHITE,fontSize:"12px"},children:"Show ALL datasets (including pending/my uploads)"})]}),t.jsxs("span",{style:{color:o.GRAY,fontSize:"11px"},children:["| API returned: ",E.length," datasets | Filtered: ",Y.length," visible"]})]})]}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"16px"},children:k?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:o.GRAY},children:t.jsx("div",{style:{fontSize:"18px",marginBottom:"12px"},children:"Loading datasets..."})}):Y.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"40px",color:o.GRAY},children:[t.jsx("div",{style:{fontSize:"18px",marginBottom:"12px"},children:"No datasets found"}),t.jsx("div",{style:{fontSize:"14px"},children:"Try adjusting your filters or search query"})]}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(380px, 1fr))",gap:"16px"},children:Y.map(X=>{const de=Z.find(_e=>_e.id.toString()===X.id)?.status||"approved",je=de==="approved"?o.GREEN:de==="pending"?o.YELLOW:o.RED;return t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`2px solid ${o.GRAY}`,borderLeft:`6px solid ${he(X.type)}`,padding:"16px"},children:[t.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{display:"inline-block",backgroundColor:he(X.type),color:o.DARK_BG,padding:"4px 10px",fontSize:"10px",fontWeight:"bold"},children:X.type}),w&&t.jsx("div",{style:{display:"inline-block",backgroundColor:je,color:o.DARK_BG,padding:"4px 10px",fontSize:"10px",fontWeight:"bold"},children:de.toUpperCase()})]}),t.jsx("div",{style:{color:o.WHITE,fontSize:"16px",fontWeight:"bold",marginBottom:"4px"},children:X.name}),t.jsxs("div",{style:{color:o.GRAY,fontSize:"12px",marginBottom:"8px"},children:["by ",t.jsx("span",{style:{color:o.CYAN},children:X.vendor})]}),t.jsx("div",{style:{color:o.WHITE,fontSize:"13px",lineHeight:"1.5",marginBottom:"12px",minHeight:"60px"},children:X.shortDescription}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"12px",padding:"10px",backgroundColor:"rgba(255,255,255,0.03)",border:`1px solid ${o.GRAY}`},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:o.GRAY,fontSize:"9px"},children:"RATING"}),t.jsxs("div",{style:{color:o.YELLOW,fontSize:"13px",fontWeight:"bold"},children:[" ",X.rating," (",X.reviews,")"]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:o.GRAY,fontSize:"9px"},children:"USERS"}),t.jsx("div",{style:{color:o.CYAN,fontSize:"13px",fontWeight:"bold"},children:X.users.toLocaleString()})]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:()=>{f(X),d("DETAILS")},style:{flex:1,padding:"10px",backgroundColor:o.DARK_BG,border:`2px solid ${o.BLUE}`,color:o.BLUE,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"VIEW DETAILS"}),t.jsx("button",{onClick:()=>!C.includes(X.id)&&T([...C,X.id]),style:{flex:1,padding:"10px",backgroundColor:C.includes(X.id)?o.GREEN:o.DARK_BG,border:`2px solid ${o.GREEN}`,color:C.includes(X.id)?o.DARK_BG:o.GREEN,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:C.includes(X.id)?" IN CART":"ADD TO CART"})]})]},X.id)})})})]}),l==="DETAILS"&&p&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:o.PANEL_BG,borderBottom:`2px solid ${o.GRAY}`},children:t.jsx("button",{onClick:()=>d("BROWSE"),style:{padding:"8px 16px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" BACK TO MARKETPLACE"})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`2px solid ${o.GRAY}`,borderLeft:`8px solid ${he(p.type)}`,padding:"24px",marginBottom:"20px"},children:[t.jsx("div",{style:{display:"inline-block",backgroundColor:he(p.type),color:o.DARK_BG,padding:"6px 14px",fontSize:"12px",fontWeight:"bold",marginBottom:"12px"},children:p.type}),t.jsx("div",{style:{color:o.WHITE,fontSize:"28px",fontWeight:"bold",marginBottom:"8px"},children:p.name}),t.jsxs("div",{style:{color:o.GRAY,fontSize:"16px",marginBottom:"12px"},children:["by ",t.jsx("span",{style:{color:o.CYAN,fontWeight:"bold"},children:p.vendor}),"  ",t.jsx("span",{style:{color:o.BLUE},children:p.category})]}),t.jsxs("div",{style:{color:o.GREEN,fontSize:"36px",fontWeight:"bold",marginTop:"16px"},children:[p.pricingModel==="FREE"?"FREE":`$${p.price.toLocaleString()}`,t.jsxs("span",{style:{color:o.GRAY,fontSize:"13px",marginLeft:"8px"},children:[p.pricingModel==="MONTHLY"&&"/ month",p.pricingModel==="ANNUAL"&&"/ year",p.pricingModel==="USAGE_BASED"&&"/ request"]})]}),t.jsx("button",{onClick:()=>!C.includes(p.id)&&T([...C,p.id]),style:{marginTop:"16px",padding:"14px 32px",backgroundColor:C.includes(p.id)?o.GREEN:o.DARK_BG,border:`2px solid ${o.GREEN}`,color:C.includes(p.id)?o.DARK_BG:o.GREEN,fontSize:"14px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:C.includes(p.id)?" ADDED TO CART":"ADD TO CART"})]}),t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`2px solid ${o.GRAY}`,padding:"20px"},children:[t.jsx("div",{style:{color:o.ORANGE,fontSize:"16px",fontWeight:"bold",marginBottom:"12px"},children:"PRODUCT DESCRIPTION"}),t.jsx("div",{style:{color:o.WHITE,fontSize:"14px",lineHeight:"1.7"},children:p.shortDescription})]})]})})]}),l==="CART"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"16px",backgroundColor:o.PANEL_BG,borderBottom:`2px solid ${o.GRAY}`},children:t.jsxs("div",{style:{color:o.ORANGE,fontSize:"20px",fontWeight:"bold"},children:["SHOPPING CART (",C.length," items)"]})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsx("div",{style:{maxWidth:"1000px",margin:"0 auto"},children:C.length===0?t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`2px solid ${o.GRAY}`,padding:"40px",textAlign:"center"},children:[t.jsx("div",{style:{color:o.GRAY,fontSize:"18px",marginBottom:"16px"},children:"Your cart is empty"}),t.jsx("button",{onClick:()=>d("BROWSE"),style:{padding:"12px 24px",backgroundColor:o.ORANGE,border:"none",color:o.DARK_BG,fontSize:"14px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"BROWSE MARKETPLACE"})]}):t.jsx(t.Fragment,{children:fe.filter(X=>C.includes(X.id)).map(X=>t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`2px solid ${o.GRAY}`,borderLeft:`6px solid ${he(X.type)}`,padding:"20px",marginBottom:"16px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:o.WHITE,fontSize:"18px",fontWeight:"bold",marginBottom:"4px"},children:X.name}),t.jsxs("div",{style:{color:o.GRAY,fontSize:"13px",marginBottom:"8px"},children:["by ",X.vendor]})]}),t.jsxs("div",{style:{textAlign:"right",marginLeft:"24px"},children:[t.jsx("div",{style:{color:o.GREEN,fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:X.pricingModel==="FREE"?"FREE":`${X.price} Credits`}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:()=>me(X.id),style:{padding:"8px 16px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GREEN}`,color:o.GREEN,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"PURCHASE"}),t.jsx("button",{onClick:()=>T(C.filter(V=>V!==X.id)),style:{padding:"8px 16px",backgroundColor:o.DARK_BG,border:`2px solid ${o.RED}`,color:o.RED,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"REMOVE"})]})]})]},X.id))})})})]}),l==="UPLOAD"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:o.PANEL_BG,borderBottom:`2px solid ${o.GRAY}`},children:t.jsx("div",{style:{color:o.ORANGE,fontSize:"20px",fontWeight:"bold"},children:"UPLOAD DATASET"})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",backgroundColor:o.PANEL_BG,border:`2px solid ${o.GRAY}`,padding:"24px"},children:[t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:o.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"Dataset Title"}),t.jsx("input",{type:"text",value:z.title,onChange:X=>$({...z,title:X.target.value}),style:{width:"100%",padding:"10px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"14px",fontFamily:"Consolas, monospace"},placeholder:"Enter dataset title"})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:o.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"Description"}),t.jsx("textarea",{value:z.description,onChange:X=>$({...z,description:X.target.value}),style:{width:"100%",padding:"10px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"14px",fontFamily:"Consolas, monospace",minHeight:"100px"},placeholder:"Describe your dataset"})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:o.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"Category"}),t.jsxs("select",{value:z.category,onChange:X=>$({...z,category:X.target.value}),style:{width:"100%",padding:"10px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"14px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"stocks",children:"Stocks"}),t.jsx("option",{value:"forex",children:"Forex"}),t.jsx("option",{value:"crypto",children:"Cryptocurrency"}),t.jsx("option",{value:"commodities",children:"Commodities"}),t.jsx("option",{value:"bonds",children:"Bonds"}),t.jsx("option",{value:"indices",children:"Indices"}),t.jsx("option",{value:"economic_data",children:"Economic Data"})]})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:o.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"Price Tier"}),t.jsxs("select",{value:z.price_tier,onChange:X=>$({...z,price_tier:X.target.value}),style:{width:"100%",padding:"10px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"14px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"free",children:"Free (0 credits)"}),t.jsx("option",{value:"basic",children:"Basic (10 credits)"}),t.jsx("option",{value:"premium",children:"Premium (50 credits)"}),t.jsx("option",{value:"enterprise",children:"Enterprise (100 credits)"})]})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:o.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"Tags (comma separated)"}),t.jsx("input",{type:"text",value:z.tags,onChange:X=>$({...z,tags:X.target.value}),style:{width:"100%",padding:"10px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"14px",fontFamily:"Consolas, monospace"},placeholder:"stocks, real-time, equity"})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:o.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"Upload File"}),t.jsx("input",{type:"file",onChange:X=>F(X.target.files?.[0]||null),style:{width:"100%",padding:"10px",backgroundColor:o.DARK_BG,border:`2px solid ${o.GRAY}`,color:o.WHITE,fontSize:"14px",fontFamily:"Consolas, monospace"}}),B&&t.jsxs("div",{style:{marginTop:"8px",color:o.CYAN,fontSize:"12px"},children:["Selected: ",B.name," (",(B.size/1024/1024).toFixed(2)," MB)"]})]}),t.jsx("button",{onClick:ge,disabled:k,style:{padding:"12px 32px",backgroundColor:k?o.GRAY:o.ORANGE,border:"none",color:o.DARK_BG,fontSize:"14px",fontWeight:"bold",cursor:k?"not-allowed":"pointer",fontFamily:"Consolas, monospace"},children:k?"UPLOADING...":"UPLOAD DATASET"})]})})]}),l==="MY_PURCHASES"&&t.jsx(tH,{session:a,C:o}),l==="MY_DATASETS"&&t.jsx(sH,{session:a,C:o,fetchMyDatasets:D}),l==="ANALYTICS"&&t.jsx(rH,{session:a,C:o}),l==="PRICING"&&t.jsx(iH,{session:a,C:o}),l==="ADMIN_STATS"&&t.jsx(nH,{session:a,C:o}),l==="ADMIN_PENDING"&&t.jsx(oH,{session:a,C:o}),l==="ADMIN_REVENUE"&&t.jsx(aH,{session:a,C:o})]}),t.jsx("div",{style:{borderTop:`3px solid ${o.ORANGE}`,backgroundColor:o.PANEL_BG,padding:"12px 16px",fontSize:"11px"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("span",{style:{color:o.ORANGE,fontWeight:"bold",fontSize:"13px"},children:"FINCEPT MARKETPLACE v3.0"}),t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsx("span",{style:{color:o.CYAN},children:" SECURE PRODUCTS"}),t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsx("span",{style:{color:o.GREEN},children:" VERIFIED VENDORS"})]}),t.jsxs("div",{style:{color:o.GRAY},children:["Screen: ",t.jsx("span",{style:{color:o.ORANGE,fontWeight:"bold"},children:l})," | Showing: ",Y.length," / ",fe.length]})]})})]})},tH=({session:s,C:e})=>{const[r,n]=S.useState([]),[i,o]=S.useState(!1);S.useEffect(()=>{(async()=>{if(s?.api_key){o(!0);try{const d=await zs.getUserPurchases(s.api_key,1,50);d.success&&d.data&&n(d.data.purchases||[])}catch(d){console.error("Failed to fetch purchases:",d)}finally{o(!1)}}})()},[s?.api_key]);const a=async l=>{if(s?.api_key)try{const d=await zs.downloadDataset(s.api_key,l);d.success&&d.data?.download_url&&window.open(d.data.download_url,"_blank")}catch{alert("Download failed")}};return t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:e.PANEL_BG,borderBottom:`2px solid ${e.GRAY}`},children:t.jsxs("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold"},children:["MY PURCHASES (",r.length,")"]})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:i?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:e.GRAY},children:"Loading..."}):r.length===0?t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"40px",textAlign:"center"},children:t.jsx("div",{style:{color:e.GRAY,fontSize:"18px"},children:"No purchases yet"})}):r.map(l=>t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,borderLeft:`6px solid ${e.GREEN}`,padding:"20px",marginBottom:"16px"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:e.WHITE,fontSize:"18px",fontWeight:"bold",marginBottom:"4px"},children:l.dataset_title}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"13px",marginBottom:"8px"},children:["Purchased: ",new Date(l.purchased_at).toLocaleDateString()," | Paid: ",l.price_paid," credits"]})]}),t.jsx("button",{onClick:()=>a(l.dataset_id),style:{padding:"10px 20px",backgroundColor:e.DARK_BG,border:`2px solid ${e.BLUE}`,color:e.BLUE,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" DOWNLOAD"})]})},l.id))})})]})},rH=({session:s,C:e})=>{const[r,n]=S.useState(null),[i,o]=S.useState(!1);return S.useEffect(()=>{(async()=>{if(s?.api_key){o(!0);try{const l=await zs.getDatasetAnalytics(s.api_key);l.success&&l.data&&n(l.data)}catch(l){console.error("Failed to fetch analytics:",l)}finally{o(!1)}}})()},[s?.api_key]),t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:e.PANEL_BG,borderBottom:`2px solid ${e.GRAY}`},children:t.jsx("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold"},children:"MY DATASET ANALYTICS"})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:i?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:e.GRAY},children:"Loading..."}):r?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginBottom:"24px"},children:[t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.BLUE}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.BLUE,fontSize:"36px",fontWeight:"bold"},children:r.total_datasets||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Total Datasets"})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GREEN}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.GREEN,fontSize:"36px",fontWeight:"bold"},children:r.total_downloads||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Total Downloads"})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.ORANGE}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"36px",fontWeight:"bold"},children:r.total_revenue||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Total Revenue (credits)"})]})]}),r.datasets&&r.datasets.length>0&&t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"20px"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"16px",fontWeight:"bold",marginBottom:"16px"},children:"DATASET PERFORMANCE"}),r.datasets.map(a=>t.jsx("div",{style:{borderBottom:`1px solid ${e.GRAY}`,padding:"12px 0"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("div",{style:{color:e.WHITE,fontSize:"14px"},children:a.title}),t.jsxs("div",{style:{display:"flex",gap:"24px"},children:[t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:e.CYAN,fontSize:"18px",fontWeight:"bold"},children:a.downloads}),t.jsx("div",{style:{color:e.GRAY,fontSize:"11px"},children:"Downloads"})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:e.GREEN,fontSize:"18px",fontWeight:"bold"},children:a.revenue}),t.jsx("div",{style:{color:e.GRAY,fontSize:"11px"},children:"Revenue"})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsxs("div",{style:{color:e.YELLOW,fontSize:"18px",fontWeight:"bold"},children:[" ",a.rating.toFixed(1)]}),t.jsx("div",{style:{color:e.GRAY,fontSize:"11px"},children:"Rating"})]})]})]})},a.id))]})]}):t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"40px",textAlign:"center"},children:t.jsx("div",{style:{color:e.GRAY,fontSize:"18px"},children:"No analytics data available"})})})})]})},nH=({session:s,C:e})=>{const[r,n]=S.useState(null),[i,o]=S.useState(!1);return S.useEffect(()=>{(async()=>{if(s?.api_key){o(!0);try{const l=await zs.getMarketplaceStats(s.api_key);l.success&&l.data&&n(l.data)}catch(l){console.error("Failed to fetch admin stats:",l)}finally{o(!1)}}})()},[s?.api_key]),t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:e.PANEL_BG,borderBottom:`2px solid ${e.GRAY}`},children:t.jsx("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold"},children:" ADMIN MARKETPLACE STATISTICS"})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:i?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:e.GRAY},children:"Loading..."}):r?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginBottom:"24px"},children:[t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.BLUE}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.BLUE,fontSize:"36px",fontWeight:"bold"},children:r.total_datasets||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Total Datasets"})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GREEN}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.GREEN,fontSize:"36px",fontWeight:"bold"},children:r.total_purchases||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Total Purchases"})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.ORANGE}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"36px",fontWeight:"bold"},children:r.total_revenue||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Total Revenue (credits)"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:[t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.CYAN}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.CYAN,fontSize:"36px",fontWeight:"bold"},children:r.total_uploads||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Total Uploads"})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.PURPLE}`,padding:"20px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.PURPLE,fontSize:"36px",fontWeight:"bold"},children:r.active_users||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",marginTop:"8px"},children:"Active Users"})]})]}),r.popular_categories&&t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"20px",marginTop:"24px"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"16px",fontWeight:"bold",marginBottom:"16px"},children:"POPULAR CATEGORIES"}),Object.entries(r.popular_categories).map(([a,l])=>t.jsxs("div",{style:{borderBottom:`1px solid ${e.GRAY}`,padding:"12px 0",display:"flex",justifyContent:"space-between"},children:[t.jsx("div",{style:{color:e.WHITE,fontSize:"14px"},children:a}),t.jsxs("div",{style:{color:e.CYAN,fontSize:"14px",fontWeight:"bold"},children:[l," datasets"]})]},a))]})]}):t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"40px",textAlign:"center"},children:t.jsx("div",{style:{color:e.GRAY,fontSize:"18px"},children:"No statistics available"})})})})]})},sH=({session:s,C:e,fetchMyDatasets:r})=>{const[n,i]=S.useState([]),[o,a]=S.useState(!1),[l,d]=S.useState(null),[p,f]=S.useState({title:"",description:"",category:"",price_tier:"",tags:""});S.useEffect(()=>{h()},[s?.api_key]);const h=async()=>{if(s?.api_key){a(!0);try{const y=await zs.getMyDatasets(s.api_key,1,100);y.success&&y.data&&i(y.data.datasets||[])}catch(y){console.error("Failed to fetch my datasets:",y)}finally{a(!1)}}},x=y=>{d(y),f({title:y.title,description:y.description,category:y.category,price_tier:y.price_tier,tags:y.tags.join(", ")})},m=async()=>{if(!(!s?.api_key||!l)){a(!0);try{const y=await zs.updateDataset(s.api_key,l.id,{title:p.title,description:p.description,category:p.category,price_tier:p.price_tier,tags:p.tags.split(",").map(C=>C.trim()).filter(C=>C)});y.success?(alert("Dataset updated successfully!"),d(null),h(),r()):alert(`Update failed: ${y.error}`)}catch{alert("Update failed")}finally{a(!1)}}},b=async(y,C)=>{if(s?.api_key&&confirm(`Are you sure you want to delete "${C}"? This action cannot be undone.`)){a(!0);try{const T=await zs.deleteDataset(s.api_key,y);T.success?(alert("Dataset deleted successfully!"),h(),r()):alert(`Delete failed: ${T.error}`)}catch{alert("Delete failed")}finally{a(!1)}}},w=y=>{switch(y){case"approved":return e.GREEN;case"pending":return e.YELLOW;case"rejected":return e.RED;default:return e.GRAY}};return t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:e.PANEL_BG,borderBottom:`2px solid ${e.GRAY}`},children:t.jsxs("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold"},children:[" MY UPLOADED DATASETS (",n.length,")"]})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[l?t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.ORANGE}`,padding:"24px",marginBottom:"20px"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"18px",fontWeight:"bold",marginBottom:"20px"},children:"EDIT DATASET"}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{display:"block",color:e.WHITE,fontSize:"13px",fontWeight:"bold",marginBottom:"6px"},children:"Title"}),t.jsx("input",{type:"text",value:p.title,onChange:y=>f({...p,title:y.target.value}),style:{width:"100%",padding:"8px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"13px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{display:"block",color:e.WHITE,fontSize:"13px",fontWeight:"bold",marginBottom:"6px"},children:"Description"}),t.jsx("textarea",{value:p.description,onChange:y=>f({...p,description:y.target.value}),style:{width:"100%",padding:"8px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"13px",fontFamily:"Consolas, monospace",minHeight:"80px"}})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:e.WHITE,fontSize:"13px",fontWeight:"bold",marginBottom:"6px"},children:"Category"}),t.jsxs("select",{value:p.category,onChange:y=>f({...p,category:y.target.value}),style:{width:"100%",padding:"8px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"13px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"stocks",children:"Stocks"}),t.jsx("option",{value:"forex",children:"Forex"}),t.jsx("option",{value:"crypto",children:"Cryptocurrency"}),t.jsx("option",{value:"commodities",children:"Commodities"}),t.jsx("option",{value:"bonds",children:"Bonds"}),t.jsx("option",{value:"indices",children:"Indices"}),t.jsx("option",{value:"economic_data",children:"Economic Data"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:e.WHITE,fontSize:"13px",fontWeight:"bold",marginBottom:"6px"},children:"Price Tier"}),t.jsxs("select",{value:p.price_tier,onChange:y=>f({...p,price_tier:y.target.value}),style:{width:"100%",padding:"8px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"13px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"free",children:"Free"}),t.jsx("option",{value:"basic",children:"Basic"}),t.jsx("option",{value:"premium",children:"Premium"}),t.jsx("option",{value:"enterprise",children:"Enterprise"})]})]})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:e.WHITE,fontSize:"13px",fontWeight:"bold",marginBottom:"6px"},children:"Tags (comma separated)"}),t.jsx("input",{type:"text",value:p.tags,onChange:y=>f({...p,tags:y.target.value}),style:{width:"100%",padding:"8px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"13px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"12px"},children:[t.jsx("button",{onClick:m,disabled:o,style:{padding:"10px 20px",backgroundColor:o?e.GRAY:e.GREEN,border:"none",color:e.DARK_BG,fontSize:"12px",fontWeight:"bold",cursor:o?"not-allowed":"pointer",fontFamily:"Consolas, monospace"},children:o?"UPDATING...":" SAVE CHANGES"}),t.jsx("button",{onClick:()=>d(null),style:{padding:"10px 20px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" CANCEL"})]})]}):null,o&&!l?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:e.GRAY},children:"Loading..."}):n.length===0?t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"40px",textAlign:"center"},children:t.jsx("div",{style:{color:e.GRAY,fontSize:"18px"},children:"No datasets uploaded yet"})}):n.map(y=>t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,borderLeft:`6px solid ${w(y.status||"pending")}`,padding:"20px",marginBottom:"16px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"4px"},children:[t.jsx("div",{style:{color:e.WHITE,fontSize:"18px",fontWeight:"bold"},children:y.title}),t.jsx("div",{style:{display:"inline-block",backgroundColor:w(y.status||"pending"),color:e.DARK_BG,padding:"2px 8px",fontSize:"10px",fontWeight:"bold",borderRadius:"3px"},children:(y.status||"pending").toUpperCase()})]}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"13px",marginBottom:"8px"},children:[y.category,"  ",y.price_tier,"  ",y.downloads_count," downloads  Uploaded: ",new Date(y.uploaded_at).toLocaleDateString()]}),t.jsx("div",{style:{color:e.WHITE,fontSize:"13px",lineHeight:"1.5"},children:y.description}),y.rejection_reason&&t.jsxs("div",{style:{marginTop:"12px",backgroundColor:"rgba(255,0,0,0.1)",border:`1px solid ${e.RED}`,padding:"10px",borderRadius:"4px"},children:[t.jsx("div",{style:{color:e.RED,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:" REJECTION REASON:"}),t.jsx("div",{style:{color:e.RED,fontSize:"12px"},children:y.rejection_reason})]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",marginLeft:"20px"},children:[(y.status==="pending"||y.status==="rejected")&&t.jsx("button",{onClick:()=>x(y),style:{padding:"8px 16px",backgroundColor:e.DARK_BG,border:`2px solid ${e.BLUE}`,color:e.BLUE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" EDIT"}),t.jsx("button",{onClick:()=>b(y.id,y.title),style:{padding:"8px 16px",backgroundColor:e.DARK_BG,border:`2px solid ${e.RED}`,color:e.RED,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" DELETE"})]})]}),y.tags&&y.tags.length>0&&t.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:y.tags.map((C,T)=>t.jsxs("span",{style:{display:"inline-block",backgroundColor:"rgba(255,255,255,0.1)",color:e.CYAN,padding:"2px 8px",fontSize:"10px",borderRadius:"3px"},children:["#",C]},T))})]},y.id))]})})]})},iH=({session:s,C:e})=>{const[r,n]=S.useState([]),[i,o]=S.useState(!1);return S.useEffect(()=>{(async()=>{if(s?.api_key){o(!0);try{const l=await zs.getPricingTiers(s.api_key);l.success&&l.data&&n(l.data.tiers||[])}catch(l){console.error("Failed to fetch pricing tiers:",l)}finally{o(!1)}}})()},[s?.api_key]),t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:e.PANEL_BG,borderBottom:`2px solid ${e.GRAY}`},children:t.jsx("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold"},children:" PRICING TIERS"})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:i?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:e.GRAY},children:"Loading..."}):r.length===0?t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"40px",textAlign:"center"},children:t.jsx("div",{style:{color:e.GRAY,fontSize:"18px"},children:"No pricing information available"})}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"20px"},children:r.map((a,l)=>t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.ORANGE}`,padding:"24px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold",textTransform:"uppercase",marginBottom:"12px"},children:a.tier}),t.jsx("div",{style:{color:e.GREEN,fontSize:"42px",fontWeight:"bold",marginBottom:"8px"},children:a.price_credits}),t.jsx("div",{style:{color:e.GRAY,fontSize:"13px",marginBottom:"16px"},children:"Credits"}),t.jsx("div",{style:{color:e.WHITE,fontSize:"13px",lineHeight:"1.6",marginBottom:"20px"},children:a.description}),a.features&&a.features.length>0&&t.jsxs("div",{style:{textAlign:"left",borderTop:`1px solid ${e.GRAY}`,paddingTop:"16px"},children:[t.jsx("div",{style:{color:e.CYAN,fontSize:"12px",fontWeight:"bold",marginBottom:"12px"},children:"FEATURES:"}),a.features.map((d,p)=>t.jsxs("div",{style:{color:e.WHITE,fontSize:"12px",marginBottom:"6px",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:e.GREEN},children:""}),t.jsx("span",{children:d})]},p))]})]},l))})})})]})},oH=({session:s,C:e})=>{const[r,n]=S.useState([]),[i,o]=S.useState(!1),[a,l]=S.useState(""),[d,p]=S.useState(null);S.useEffect(()=>{f()},[s?.api_key]);const f=async()=>{if(s?.api_key){o(!0);try{const m=await zs.getPendingDatasets(s.api_key);m.success&&m.data&&n(m.data.datasets||[])}catch(m){console.error("Failed to fetch pending datasets:",m)}finally{o(!1)}}},h=async(m,b)=>{if(s?.api_key&&confirm(`Approve dataset "${b}"?`)){o(!0);try{const w=await zs.approveDataset(s.api_key,m);w.success?(alert("Dataset approved successfully!"),f()):alert(`Approval failed: ${w.error}`)}catch{alert("Approval failed")}finally{o(!1)}}},x=async m=>{if(!s?.api_key||!a.trim()){alert("Please provide a rejection reason");return}o(!0);try{const b=await zs.rejectDataset(s.api_key,m,a);b.success?(alert("Dataset rejected successfully!"),p(null),l(""),f()):alert(`Rejection failed: ${b.error}`)}catch{alert("Rejection failed")}finally{o(!1)}};return t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:e.PANEL_BG,borderBottom:`2px solid ${e.GRAY}`},children:t.jsxs("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold"},children:[" PENDING DATASETS APPROVAL (",r.length,")"]})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:i?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:e.GRAY},children:"Loading..."}):r.length===0?t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"40px",textAlign:"center"},children:t.jsx("div",{style:{color:e.GRAY,fontSize:"18px"},children:"No pending datasets"})}):r.map(m=>t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.YELLOW}`,borderLeft:`6px solid ${e.YELLOW}`,padding:"20px",marginBottom:"16px"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:e.WHITE,fontSize:"18px",fontWeight:"bold",marginBottom:"4px"},children:m.title}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"13px",marginBottom:"8px"},children:["by ",m.uploader_username,"  ",m.category,"  ",m.price_tier,"  ",(m.file_size/1024/1024).toFixed(2)," MB"]}),t.jsx("div",{style:{color:e.WHITE,fontSize:"13px",lineHeight:"1.5",marginBottom:"12px"},children:m.description}),m.tags&&m.tags.length>0&&t.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap",marginBottom:"12px"},children:m.tags.map((b,w)=>t.jsxs("span",{style:{display:"inline-block",backgroundColor:"rgba(255,255,255,0.1)",color:e.CYAN,padding:"2px 8px",fontSize:"10px",borderRadius:"3px"},children:["#",b]},w))})]})}),d===m.id?t.jsxs("div",{style:{backgroundColor:"rgba(255,0,0,0.1)",border:`1px solid ${e.RED}`,padding:"16px",borderRadius:"4px",marginTop:"12px"},children:[t.jsx("div",{style:{color:e.RED,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"REJECTION REASON:"}),t.jsx("textarea",{value:a,onChange:b=>l(b.target.value),placeholder:"Enter reason for rejection...",style:{width:"100%",padding:"10px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"13px",fontFamily:"Consolas, monospace",minHeight:"80px",marginBottom:"12px"}}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:()=>x(m.id),disabled:!a.trim(),style:{padding:"8px 16px",backgroundColor:e.RED,border:"none",color:e.WHITE,fontSize:"11px",fontWeight:"bold",cursor:a.trim()?"pointer":"not-allowed",fontFamily:"Consolas, monospace"},children:" CONFIRM REJECT"}),t.jsx("button",{onClick:()=>{p(null),l("")},style:{padding:"8px 16px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GRAY}`,color:e.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"CANCEL"})]})]}):t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:()=>h(m.id,m.title),style:{padding:"10px 20px",backgroundColor:e.DARK_BG,border:`2px solid ${e.GREEN}`,color:e.GREEN,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" APPROVE"}),t.jsx("button",{onClick:()=>p(m.id),style:{padding:"10px 20px",backgroundColor:e.DARK_BG,border:`2px solid ${e.RED}`,color:e.RED,fontSize:"12px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:" REJECT"})]})]},m.id))})})]})},aH=({session:s,C:e})=>{const[r,n]=S.useState(null),[i,o]=S.useState(!1);return S.useEffect(()=>{(async()=>{if(s?.api_key){o(!0);try{const l=await zs.getAdminRevenueAnalytics(s.api_key);l.success&&l.data&&n(l.data)}catch(l){console.error("Failed to fetch revenue analytics:",l)}finally{o(!1)}}})()},[s?.api_key]),t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{padding:"12px",backgroundColor:e.PANEL_BG,borderBottom:`2px solid ${e.GRAY}`},children:t.jsx("div",{style:{color:e.ORANGE,fontSize:"20px",fontWeight:"bold"},children:" REVENUE ANALYTICS"})}),t.jsx("div",{className:"marketplace-scroll",style:{flex:1,overflowY:"auto",backgroundColor:"#050505",padding:"20px"},children:t.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:i?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:e.GRAY},children:"Loading..."}):r?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",marginBottom:"24px"},children:[t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GREEN}`,padding:"24px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.GREEN,fontSize:"48px",fontWeight:"bold"},children:r.total_revenue||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"16px",marginTop:"8px"},children:"Total Revenue (credits)"})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.BLUE}`,padding:"24px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.BLUE,fontSize:"48px",fontWeight:"bold"},children:r.total_transactions||0}),t.jsx("div",{style:{color:e.WHITE,fontSize:"16px",marginTop:"8px"},children:"Total Transactions"})]})]}),r.revenue_by_tier&&Object.keys(r.revenue_by_tier).length>0&&t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"20px",marginBottom:"24px"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"16px",fontWeight:"bold",marginBottom:"16px"},children:"REVENUE BY TIER"}),Object.entries(r.revenue_by_tier).map(([a,l])=>t.jsxs("div",{style:{borderBottom:`1px solid ${e.GRAY}`,padding:"12px 0",display:"flex",justifyContent:"space-between"},children:[t.jsx("div",{style:{color:e.WHITE,fontSize:"14px",textTransform:"uppercase"},children:a}),t.jsxs("div",{style:{color:e.GREEN,fontSize:"14px",fontWeight:"bold"},children:[l," credits"]})]},a))]}),r.top_datasets&&r.top_datasets.length>0&&t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"20px"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"16px",fontWeight:"bold",marginBottom:"16px"},children:"TOP PERFORMING DATASETS"}),r.top_datasets.map((a,l)=>t.jsxs("div",{style:{borderBottom:`1px solid ${e.GRAY}`,padding:"12px 0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{color:e.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"4px"},children:["#",l+1," ",a.title]}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"12px"},children:[a.downloads," downloads"]})]}),t.jsxs("div",{style:{color:e.GREEN,fontSize:"18px",fontWeight:"bold",marginLeft:"20px"},children:[a.revenue," credits"]})]},a.id))]})]}):t.jsx("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.GRAY}`,padding:"40px",textAlign:"center"},children:t.jsx("div",{style:{color:e.GRAY,fontSize:"18px"},children:"No revenue data available"})})})})]})};class lH{constructor(){Pe(this,"db",null);Pe(this,"dbPath","sqlite:fincept_terminal.db");Pe(this,"isInitialized",!1)}async initialize(){if(!(this.isInitialized&&this.db))try{this.db=await Gg.load(this.dbPath),this.isInitialized=!0,Do.info("Initialized successfully")}catch(e){throw Do.error("Initialization failed:",e),e}}ensureInitialized(){if(!this.db||!this.isInitialized)throw new Error("PortfolioService not initialized. Call initialize() first.")}async createPortfolio(e,r,n="USD",i){this.ensureInitialized();const o=crypto.randomUUID();await this.db.execute(`INSERT INTO portfolios (id, name, owner, currency, description)
       VALUES ($1, $2, $3, $4, $5)`,[o,e,r,n,i||null]);const a=await this.db.select("SELECT * FROM portfolios WHERE id = $1",[o]);return Do.info(`Created portfolio: ${e}`,{id:o}),a[0]}async getPortfolios(){return this.ensureInitialized(),await this.db.select("SELECT * FROM portfolios ORDER BY created_at DESC")}async getPortfolio(e){this.ensureInitialized();const r=await this.db.select("SELECT * FROM portfolios WHERE id = $1",[e]);return r.length>0?r[0]:null}async updatePortfolio(e,r){this.ensureInitialized();const n=[],i=[];r.name!==void 0&&(n.push("name = $"+(i.length+1)),i.push(r.name)),r.owner!==void 0&&(n.push("owner = $"+(i.length+1)),i.push(r.owner)),r.currency!==void 0&&(n.push("currency = $"+(i.length+1)),i.push(r.currency)),r.description!==void 0&&(n.push("description = $"+(i.length+1)),i.push(r.description)),n.length>0&&(n.push("updated_at = datetime('now')"),i.push(e),await this.db.execute(`UPDATE portfolios SET ${n.join(", ")} WHERE id = $${i.length}`,i))}async deletePortfolio(e){this.ensureInitialized(),await this.db.execute("DELETE FROM portfolios WHERE id = $1",[e]),Do.info(`Deleted portfolio: ${e}`)}async addAsset(e,r,n,i,o){this.ensureInitialized();const a=await this.db.select("SELECT * FROM portfolio_assets WHERE portfolio_id = $1 AND symbol = $2",[e,r]);if(a.length>0){const l=a[0],d=l.quantity+n,p=(l.avg_buy_price*l.quantity+i*n)/d;return await this.db.execute(`UPDATE portfolio_assets
         SET quantity = $1, avg_buy_price = $2, last_updated = datetime('now')
         WHERE id = $3`,[d,p,l.id]),await this.addTransaction(e,r,"BUY",n,i,o),(await this.db.select("SELECT * FROM portfolio_assets WHERE id = $1",[l.id]))[0]}else{const l=crypto.randomUUID();await this.db.execute(`INSERT INTO portfolio_assets (id, portfolio_id, symbol, quantity, avg_buy_price, first_purchase_date)
         VALUES ($1, $2, $3, $4, $5, $6)`,[l,e,r,n,i,o||new Date().toISOString()]),await this.addTransaction(e,r,"BUY",n,i,o);const d=await this.db.select("SELECT * FROM portfolio_assets WHERE id = $1",[l]);return Do.info(`Added asset: ${r} to portfolio`,{portfolioId:e}),d[0]}}async removeAsset(e,r){this.ensureInitialized(),await this.db.execute("DELETE FROM portfolio_assets WHERE portfolio_id = $1 AND symbol = $2",[e,r]),Do.info(`Removed asset: ${r} from portfolio`,{portfolioId:e})}async updateAsset(e,r,n,i){this.ensureInitialized(),await this.db.execute(`UPDATE portfolio_assets
       SET quantity = $1, avg_buy_price = $2, last_updated = datetime('now')
       WHERE portfolio_id = $3 AND symbol = $4`,[n,i,e,r]),Do.info(`Updated asset: ${r} in portfolio`,{portfolioId:e})}async sellAsset(e,r,n,i,o){this.ensureInitialized();const a=await this.db.select("SELECT * FROM portfolio_assets WHERE portfolio_id = $1 AND symbol = $2",[e,r]);if(a.length===0)throw new Error(`Asset ${r} not found in portfolio`);const l=a[0];if(n>l.quantity)throw new Error(`Cannot sell ${n} shares of ${r}. Only ${l.quantity} available.`);const d=l.quantity-n;d===0?await this.removeAsset(e,r):await this.db.execute(`UPDATE portfolio_assets
         SET quantity = $1, last_updated = datetime('now')
         WHERE portfolio_id = $2 AND symbol = $3`,[d,e,r]),await this.addTransaction(e,r,"SELL",n,i,o),Do.info(`Sold ${n} shares of ${r}`,{portfolioId:e})}async getPortfolioAssets(e){return this.ensureInitialized(),await this.db.select("SELECT * FROM portfolio_assets WHERE portfolio_id = $1 ORDER BY symbol",[e])}async addTransaction(e,r,n,i,o,a,l){this.ensureInitialized();const d=crypto.randomUUID(),p=i*o,f=a||new Date().toISOString();return await this.db.execute(`INSERT INTO portfolio_transactions
       (id, portfolio_id, symbol, transaction_type, quantity, price, total_value, transaction_date, notes)
       VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)`,[d,e,r,n,i,o,p,f,l||null]),(await this.db.select("SELECT * FROM portfolio_transactions WHERE id = $1",[d]))[0]}async getPortfolioTransactions(e,r=100){return this.ensureInitialized(),await this.db.select("SELECT * FROM portfolio_transactions WHERE portfolio_id = $1 ORDER BY transaction_date DESC LIMIT $2",[e,r])}async getSymbolTransactions(e,r){return this.ensureInitialized(),await this.db.select("SELECT * FROM portfolio_transactions WHERE portfolio_id = $1 AND symbol = $2 ORDER BY transaction_date DESC",[e,r])}async fetchMarketPrices(e){const r=await Fi.getQuotes(e),n=new Map;return r.forEach(i=>{n.set(i.symbol,i)}),n}async calculatePortfolioValue(e){this.ensureInitialized();const r=await this.getPortfolioAssets(e);if(r.length===0)return 0;const n=r.map(a=>a.symbol),i=await this.fetchMarketPrices(n);let o=0;return r.forEach(a=>{const l=i.get(a.symbol);l&&(o+=l.price*a.quantity)}),o}async getPortfolioHoldings(e){this.ensureInitialized();const r=await this.getPortfolioAssets(e);if(r.length===0)return[];const n=r.map(l=>l.symbol),i=await this.fetchMarketPrices(n),o=[];let a=0;return r.forEach(l=>{const d=i.get(l.symbol);d&&(a+=d.price*l.quantity)}),r.forEach(l=>{const d=i.get(l.symbol);if(d){const p=d.price*l.quantity,f=l.avg_buy_price*l.quantity,h=p-f,x=h/f*100,m=d.change*l.quantity,b=d.change_percent,w=p/a*100;o.push({...l,current_price:d.price,market_value:p,cost_basis:f,unrealized_pnl:h,unrealized_pnl_percent:x,day_change:m,day_change_percent:b,weight:w})}}),o}async getPortfolioSummary(e){this.ensureInitialized();const r=await this.getPortfolio(e);if(!r)throw new Error(`Portfolio ${e} not found`);const n=await this.getPortfolioHoldings(e);let i=0,o=0,a=0,l=0;n.forEach(f=>{i+=f.market_value,o+=f.cost_basis,a+=f.unrealized_pnl,l+=f.day_change});const d=o>0?a/o*100:0,p=i-l>0?l/(i-l)*100:0;return{portfolio:r,total_positions:n.length,total_market_value:i,total_cost_basis:o,total_unrealized_pnl:a,total_unrealized_pnl_percent:d,total_day_change:l,total_day_change_percent:p,holdings:n,last_updated:new Date().toISOString()}}async calculateReturns(e){this.ensureInitialized();const n=(await this.getPortfolioSummary(e)).total_unrealized_pnl,i=await this.getPortfolioTransactions(e);let o=0;const a=new Map;return i.forEach(l=>{a.has(l.symbol)||a.set(l.symbol,[]),a.get(l.symbol).push(l)}),a.forEach((l,d)=>{const p=l.filter(h=>h.transaction_type==="BUY").reverse();l.filter(h=>h.transaction_type==="SELL").reverse().forEach(h=>{let x=h.quantity;for(const m of p){if(x<=0)break;const b=Math.min(x,m.quantity),w=m.price*b,y=h.price*b;o+=y-w,x-=b}})}),{realized_pnl:o,unrealized_pnl:n,total_pnl:o+n}}async saveSnapshot(e){this.ensureInitialized();const r=await this.getPortfolioSummary(e),n=crypto.randomUUID(),i=JSON.stringify({holdings:r.holdings,total_positions:r.total_positions});await this.db.execute(`INSERT INTO portfolio_snapshots
       (id, portfolio_id, total_value, total_cost_basis, total_pnl, total_pnl_percent, snapshot_data)
       VALUES ($1, $2, $3, $4, $5, $6, $7)`,[n,e,r.total_market_value,r.total_cost_basis,r.total_unrealized_pnl,r.total_unrealized_pnl_percent,i]);const o=await this.db.select("SELECT * FROM portfolio_snapshots WHERE id = $1",[n]);return Do.info("Saved snapshot for portfolio",{portfolioId:e}),o[0]}async getPortfolioPerformanceHistory(e,r=30){return this.ensureInitialized(),await this.db.select("SELECT * FROM portfolio_snapshots WHERE portfolio_id = $1 ORDER BY snapshot_date DESC LIMIT $2",[e,r])}async rebalancePortfolio(e,r){this.ensureInitialized();const n=await this.getPortfolioHoldings(e),i=n.reduce((a,l)=>a+l.market_value,0),o=new Map;if(r==="equal"){const a=100/n.length;n.forEach(l=>{const d=l.weight,p=a-d;if(Math.abs(p)>.5){const f=a/100*i,h=l.market_value,m=(f-h)/l.current_price;o.set(l.symbol,{action:m>0?"BUY":"SELL",quantity:Math.abs(m),reason:`Rebalance from ${d.toFixed(2)}% to ${a.toFixed(2)}%`})}})}else n.forEach(a=>{const l=r.get(a.symbol)||0,d=a.weight,p=l-d;if(Math.abs(p)>.5){const f=l/100*i,h=a.market_value,m=(f-h)/a.current_price;o.set(a.symbol,{action:m>0?"BUY":"SELL",quantity:Math.abs(m),reason:`Rebalance from ${d.toFixed(2)}% to ${l.toFixed(2)}%`})}});return o}async exportPortfolioCSV(e){const r=await this.getPortfolioSummary(e);let n=`Symbol,Quantity,Avg Buy Price,Current Price,Market Value,Cost Basis,Unrealized P&L,Unrealized P&L %,Day Change,Day Change %,Weight %
`;return r.holdings.forEach(i=>{n+=`${i.symbol},${i.quantity},${i.avg_buy_price.toFixed(2)},${i.current_price.toFixed(2)},${i.market_value.toFixed(2)},${i.cost_basis.toFixed(2)},${i.unrealized_pnl.toFixed(2)},${i.unrealized_pnl_percent.toFixed(2)},${i.day_change.toFixed(2)},${i.day_change_percent.toFixed(2)},${i.weight.toFixed(2)}
`}),n+=`
TOTAL,,,,${r.total_market_value.toFixed(2)},${r.total_cost_basis.toFixed(2)},${r.total_unrealized_pnl.toFixed(2)},${r.total_unrealized_pnl_percent.toFixed(2)},${r.total_day_change.toFixed(2)},${r.total_day_change_percent.toFixed(2)},100.00
`,n}async exportTransactionsCSV(e){const r=await this.getPortfolioTransactions(e,1e3);let n=`Date,Symbol,Type,Quantity,Price,Total Value,Notes
`;return r.forEach(i=>{n+=`${i.transaction_date},${i.symbol},${i.transaction_type},${i.quantity},${i.price.toFixed(2)},${i.total_value.toFixed(2)},"${i.notes||""}"
`}),n}isReady(){return this.isInitialized&&this.db!==null}getStatus(){return{initialized:this.isInitialized,ready:this.isReady()}}async fetchHistoricalReturnsForHoldings(e,r=252){const n={};for(const i of e)try{const o=await Fi.getPeriodReturns(i.symbol);if(o){const a=Math.abs(o.seven_day/100)/Math.sqrt(7),l=o.thirty_day/100/30;n[i.symbol]=Array.from({length:r},()=>l+(Math.random()-.5)*2*a)}else n[i.symbol]=Array.from({length:r},()=>(Math.random()-.5)*.02)}catch(o){Do.warn(`Failed to fetch returns for ${i.symbol}:`,o),n[i.symbol]=Array.from({length:r},()=>(Math.random()-.5)*.02)}return n}async calculateAdvancedMetrics(e,r=.03){const{invoke:n}=await Br(async()=>{const{invoke:d}=await import("./tauri-vendor-CMSE6dGk.js").then(p=>p.c);return{invoke:d}},[]),i=await this.getPortfolioHoldings(e);if(i.length===0)throw new Error("Portfolio has no holdings to analyze");const o=await this.fetchHistoricalReturnsForHoldings(i),a=i.map(d=>d.weight/100),l=await n("calculate_portfolio_metrics",{returnsData:JSON.stringify(o),weights:JSON.stringify(a),riskFreeRate:r});return JSON.parse(l)}async optimizePortfolioWeights(e,r="max_sharpe",n=.03){const{invoke:i}=await Br(async()=>{const{invoke:d}=await import("./tauri-vendor-CMSE6dGk.js").then(p=>p.c);return{invoke:d}},[]),o=await this.getPortfolioHoldings(e);if(o.length<2)throw new Error("Need at least 2 assets to optimize portfolio");const a=await this.fetchHistoricalReturnsForHoldings(o),l=await i("optimize_portfolio",{returnsData:JSON.stringify(a),method:r,riskFreeRate:n});return JSON.parse(l)}async generateEfficientFrontier(e,r=50,n=.03){const{invoke:i}=await Br(async()=>{const{invoke:d}=await import("./tauri-vendor-CMSE6dGk.js").then(p=>p.c);return{invoke:d}},[]),o=await this.getPortfolioHoldings(e),a=await this.fetchHistoricalReturnsForHoldings(o),l=await i("generate_efficient_frontier",{returnsData:JSON.stringify(a),numPoints:r,riskFreeRate:n});return JSON.parse(l)}async getAnalyticsOverview(e){const{invoke:r}=await Br(async()=>{const{invoke:l}=await import("./tauri-vendor-CMSE6dGk.js").then(d=>d.c);return{invoke:l}},[]),n=await this.getPortfolioHoldings(e),i=await this.fetchHistoricalReturnsForHoldings(n),o=n.map(l=>l.weight/100),a=await r("get_portfolio_overview",{returnsData:JSON.stringify(i),weights:JSON.stringify(o)});return JSON.parse(a)}async calculateRiskMetrics(e){const{invoke:r}=await Br(async()=>{const{invoke:l}=await import("./tauri-vendor-CMSE6dGk.js").then(d=>d.c);return{invoke:l}},[]),n=await this.getPortfolioHoldings(e);if(n.length===0)throw new Error("Portfolio has no holdings to analyze");const i={};for(const l of n)i[l.symbol]=Array.from({length:252},()=>(Math.random()-.5)*.02);const o=n.map(l=>l.weight/100),a=await r("calculate_risk_metrics",{returnsData:JSON.stringify(i),weights:JSON.stringify(o)});return JSON.parse(a)}async generateAssetAllocation(e,r,n){const{invoke:i}=await Br(async()=>{const{invoke:a}=await import("./tauri-vendor-CMSE6dGk.js").then(l=>l.c);return{invoke:a}},[]),o=await i("generate_asset_allocation",{age:e,riskTolerance:r,yearsToRetirement:n});return JSON.parse(o)}async calculateRetirementPlan(e,r,n,i){const{invoke:o}=await Br(async()=>{const{invoke:l}=await import("./tauri-vendor-CMSE6dGk.js").then(d=>d.c);return{invoke:l}},[]),a=await o("calculate_retirement_plan",{currentAge:e,retirementAge:r,currentSavings:n,annualContribution:i});return JSON.parse(a)}async analyzeBehavioralBiases(e){const{invoke:r}=await Br(async()=>{const{invoke:a}=await import("./tauri-vendor-CMSE6dGk.js").then(l=>l.c);return{invoke:a}},[]),n=await this.getPortfolioHoldings(e),i={weights:n.map(a=>a.weight/100),symbols:n.map(a=>a.symbol),returns:n.map(a=>a.unrealized_pnl_percent/100)},o=await r("analyze_behavioral_biases",{portfolioData:JSON.stringify(i)});return JSON.parse(o)}async analyzeEtfCosts(e,r){const{invoke:n}=await Br(async()=>{const{invoke:o}=await import("./tauri-vendor-CMSE6dGk.js").then(a=>a.c);return{invoke:o}},[]),i=await n("analyze_etf_costs",{symbols:JSON.stringify(e),expenseRatios:JSON.stringify(r)});return JSON.parse(i)}}const Li=new lH,dx=()=>{const s=zi.getTheme();return{ORANGE:s.colors.primary,WHITE:s.colors.text,RED:s.colors.alert,GREEN:s.colors.secondary,GRAY:s.colors.textMuted,DARK_BG:"#1a1a1a",PANEL_BG:s.colors.background,CYAN:s.colors.accent,YELLOW:s.colors.warning,BLUE:s.colors.info,PURPLE:s.colors.purple}},Rl=dx(),cH={USD:"$",EUR:"",GBP:"",INR:"",JPY:"",CNY:"",AUD:"A$",CAD:"C$",CHF:"CHF"},dH={USD:"en-US",EUR:"de-DE",GBP:"en-GB",INR:"en-IN",JPY:"ja-JP",CNY:"zh-CN",AUD:"en-AU",CAD:"en-CA",CHF:"de-CH"},sr=(s,e="USD")=>{const r=dH[e]||"en-US";return new Intl.NumberFormat(r,{style:"currency",currency:e,minimumFractionDigits:2,maximumFractionDigits:2}).format(s)},uH=s=>cH[s]||s,Lp=(s,e=2)=>s.toFixed(e),cs=s=>`${s>=0?"+":""}${s.toFixed(2)}%`,cp=(s,e)=>{const r=Math.abs(s),n=e?uH(e):"";return r>=1e9?`${n}${(s/1e9).toFixed(2)}B`:r>=1e6?`${n}${(s/1e6).toFixed(2)}M`:r>=1e3?`${n}${(s/1e3).toFixed(2)}K`:e?sr(s,e):s.toFixed(2)},pH=(s,e=.03)=>{if(s.length===0)return 0;const r=s.reduce((o,a)=>o+a,0)/s.length,n=s.reduce((o,a)=>o+Math.pow(a-r,2),0)/s.length,i=Math.sqrt(n);return i===0?0:(r-e)/i},hH=(s,e)=>{if(s.length!==e.length||s.length===0)return 1;const r=s.length,n=s.reduce((l,d)=>l+d,0)/r,i=e.reduce((l,d)=>l+d,0)/r;let o=0,a=0;for(let l=0;l<r;l++)o+=(s[l]-n)*(e[l]-i),a+=Math.pow(e[l]-i,2);return a===0?1:o/a},fH=s=>{if(s.length===0)return 0;const e=s.reduce((i,o)=>i+o,0)/s.length,r=s.reduce((i,o)=>i+Math.pow(o-e,2),0)/s.length;return Math.sqrt(r)*Math.sqrt(252)*100},gH=s=>{if(s.length===0)return 0;let e=0,r=s[0];for(const n of s){n>r&&(r=n);const i=(r-n)/r*100;i>e&&(e=i)}return e},xH=(s,e=.95)=>{if(s.length===0)return 0;const r=[...s].sort((i,o)=>i-o),n=Math.floor(r.length*(1-e));return r[n]||0},mH=(s,e=.15,r=.2,n=365)=>{let i=0,o=0;const a=new Map;return s.forEach(l=>{a.has(l.symbol)||a.set(l.symbol,[]),a.get(l.symbol).push(l)}),a.forEach((l,d)=>{const p=l.filter(h=>h.transaction_type==="BUY").sort((h,x)=>new Date(h.transaction_date).getTime()-new Date(x.transaction_date).getTime());l.filter(h=>h.transaction_type==="SELL").sort((h,x)=>new Date(h.transaction_date).getTime()-new Date(x.transaction_date).getTime()).forEach(h=>{let x=h.quantity;const m=new Date(h.transaction_date);for(const b of p){if(x<=0)break;const w=Math.min(x,b.quantity),y=new Date(b.transaction_date),C=Math.floor((m.getTime()-y.getTime())/(1e3*60*60*24)),T=(h.price-b.price)*w;C>n?o+=T:i+=T,x-=w}})}),{shortTermGains:i,longTermGains:o,shortTermTax:i*e,longTermTax:o*r,totalTax:i*e+o*r}},yH=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),bH=s=>new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),vH=s=>`${yH(s)} ${bH(s)}`,SH=({portfolioSummary:s})=>{const{ORANGE:e,WHITE:r,RED:n,GREEN:i,GRAY:o,CYAN:a,YELLOW:l}=Rl,d=s.portfolio.currency;return t.jsxs("div",{children:[t.jsx("div",{style:{color:e,fontSize:"12px",fontWeight:"bold",marginBottom:"12px"},children:"CURRENT POSITIONS"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr 1fr 1fr 1.2fr 1fr",gap:"8px",padding:"8px",backgroundColor:"rgba(255,165,0,0.1)",fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:[t.jsx("div",{style:{color:r},children:"SYMBOL"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"QTY"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"AVG PRICE"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"CURRENT"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"MKT VALUE"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"COST BASIS"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"P&L"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"DAY CHANGE"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"WEIGHT"})]}),s.holdings.length===0?t.jsx("div",{style:{padding:"32px",textAlign:"center",color:o,fontSize:"11px"},children:'No positions yet. Click F2 or "ADD ASSET" to add your first position.'}):s.holdings.map((p,f)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr 1fr 1fr 1.2fr 1fr",gap:"8px",padding:"8px",backgroundColor:f%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`3px solid ${p.unrealized_pnl>=0?i:n}`,fontSize:"10px",marginBottom:"2px"},children:[t.jsx("div",{style:{color:a,fontWeight:"bold"},children:p.symbol}),t.jsx("div",{style:{color:r,textAlign:"right"},children:Lp(p.quantity,4)}),t.jsx("div",{style:{color:o,textAlign:"right"},children:sr(p.avg_buy_price,d)}),t.jsx("div",{style:{color:r,textAlign:"right"},children:sr(p.current_price,d)}),t.jsx("div",{style:{color:r,textAlign:"right",fontWeight:"bold"},children:sr(p.market_value,d)}),t.jsx("div",{style:{color:o,textAlign:"right"},children:sr(p.cost_basis,d)}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:p.unrealized_pnl>=0?i:n,fontWeight:"bold"},children:sr(p.unrealized_pnl,d)}),t.jsx("div",{style:{color:p.unrealized_pnl>=0?i:n,fontSize:"9px"},children:cs(p.unrealized_pnl_percent)})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:p.day_change>=0?i:n},children:sr(p.day_change,d)}),t.jsx("div",{style:{color:p.day_change>=0?i:n,fontSize:"9px"},children:cs(p.day_change_percent)})]}),t.jsxs("div",{style:{color:l,textAlign:"right",fontWeight:"bold"},children:[Lp(p.weight),"%"]})]},p.id)),s.holdings.length>0&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr 1fr 1fr 1.2fr 1fr",gap:"8px",padding:"8px",backgroundColor:"rgba(255,165,0,0.15)",borderTop:`2px solid ${e}`,fontSize:"10px",fontWeight:"bold",marginTop:"8px"},children:[t.jsx("div",{style:{color:e},children:"TOTAL"}),t.jsx("div",{}),t.jsx("div",{}),t.jsx("div",{}),t.jsx("div",{style:{color:r,textAlign:"right"},children:sr(s.total_market_value,d)}),t.jsx("div",{style:{color:o,textAlign:"right"},children:sr(s.total_cost_basis,d)}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:s.total_unrealized_pnl>=0?i:n},children:sr(s.total_unrealized_pnl,d)}),t.jsx("div",{style:{color:s.total_unrealized_pnl>=0?i:n,fontSize:"9px"},children:cs(s.total_unrealized_pnl_percent)})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:s.total_day_change>=0?i:n},children:sr(s.total_day_change,d)}),t.jsx("div",{style:{color:s.total_day_change>=0?i:n,fontSize:"9px"},children:cs(s.total_day_change_percent)})]}),t.jsx("div",{style:{color:l,textAlign:"right"},children:"100.0%"})]})]})},wH=({transactions:s,currency:e})=>{const{ORANGE:r,WHITE:n,RED:i,GREEN:o,GRAY:a,CYAN:l,YELLOW:d}=Rl;return t.jsxs("div",{children:[t.jsx("div",{style:{color:r,fontSize:"12px",fontWeight:"bold",marginBottom:"12px"},children:"TRANSACTION HISTORY"}),s.length===0?t.jsx("div",{style:{padding:"32px",textAlign:"center",color:a,fontSize:"11px"},children:"No transactions yet"}):t.jsxs("div",{children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr 0.8fr 1fr 1fr 1fr 2fr",gap:"8px",padding:"8px",backgroundColor:"rgba(255,165,0,0.1)",fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:[t.jsx("div",{style:{color:n},children:"DATE"}),t.jsx("div",{style:{color:n},children:"SYMBOL"}),t.jsx("div",{style:{color:n},children:"TYPE"}),t.jsx("div",{style:{color:n,textAlign:"right"},children:"QTY"}),t.jsx("div",{style:{color:n,textAlign:"right"},children:"PRICE"}),t.jsx("div",{style:{color:n,textAlign:"right"},children:"TOTAL"}),t.jsx("div",{style:{color:n},children:"NOTES"})]}),s.map((p,f)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr 0.8fr 1fr 1fr 1fr 2fr",gap:"8px",padding:"8px",backgroundColor:f%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`3px solid ${p.transaction_type==="BUY"?o:i}`,fontSize:"10px",marginBottom:"2px"},children:[t.jsx("div",{style:{color:a},children:vH(p.transaction_date)}),t.jsx("div",{style:{color:l},children:p.symbol}),t.jsx("div",{style:{color:p.transaction_type==="BUY"?o:i,fontWeight:"bold"},children:p.transaction_type}),t.jsx("div",{style:{color:n,textAlign:"right"},children:Lp(p.quantity,4)}),t.jsx("div",{style:{color:n,textAlign:"right"},children:sr(p.price,e)}),t.jsx("div",{style:{color:d,textAlign:"right",fontWeight:"bold"},children:sr(p.total_value,e)}),t.jsx("div",{style:{color:a,fontSize:"9px"},children:p.notes||"-"})]},p.id))]})]})},EH=({portfolioSummary:s})=>{const{ORANGE:e,WHITE:r,RED:n,GREEN:i,GRAY:o,CYAN:a,YELLOW:l,BLUE:d}=Rl,p=s.portfolio.currency,[f,h]=S.useState(null),[x,m]=S.useState(null),[b,w]=S.useState(!1),[y,C]=S.useState(!1),[T,E]=S.useState(null),j=s.total_market_value,k=s.total_unrealized_pnl,A=s.total_unrealized_pnl_percent,R=s.total_day_change,M=s.total_day_change_percent,P=s.total_positions,I=[...s.holdings].sort((z,$)=>$.unrealized_pnl_percent-z.unrealized_pnl_percent).slice(0,5),O=[...s.holdings].sort((z,$)=>z.unrealized_pnl_percent-$.unrealized_pnl_percent).slice(0,5),G=[...s.holdings].sort((z,$)=>$.market_value-z.market_value).slice(0,5);S.useEffect(()=>{B()},[s.portfolio.id]);const B=async()=>{w(!0),E(null);try{const z=await Li.calculateAdvancedMetrics(s.portfolio.id);h(z)}catch(z){console.error("Error loading advanced metrics:",z),E(z instanceof Error?z.message:"Failed to load analytics")}finally{w(!1)}},F=async()=>{C(!0),E(null);try{const z=await Li.optimizePortfolioWeights(s.portfolio.id,"max_sharpe");m(z)}catch(z){console.error("Error optimizing portfolio:",z),E(z instanceof Error?z.message:"Failed to optimize portfolio")}finally{C(!1)}};return t.jsxs("div",{children:[t.jsx("div",{style:{color:e,fontSize:"12px",fontWeight:"bold",marginBottom:"16px"},children:"PORTFOLIO ANALYTICS DASHBOARD"}),T&&t.jsxs("div",{style:{backgroundColor:"rgba(255,0,0,0.1)",border:`1px solid ${n}`,padding:"12px",marginBottom:"16px",borderRadius:"4px",color:n,fontSize:"10px"},children:[" ",T]}),f&&t.jsxs("div",{style:{backgroundColor:"rgba(100,150,250,0.05)",border:`1px solid ${d}`,padding:"16px",marginBottom:"20px",borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[t.jsxs("div",{style:{color:d,fontSize:"11px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(Cs,{size:14}),"ADVANCED PORTFOLIO METRICS (Python-Powered)"]}),t.jsxs("button",{onClick:F,disabled:y,style:{background:y?o:e,color:"black",border:"none",padding:"4px 12px",fontSize:"9px",fontWeight:"bold",cursor:y?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(ka,{size:10}),y?"OPTIMIZING...":"OPTIMIZE WEIGHTS"]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"12px"},children:[t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:o,fontSize:"8px",marginBottom:"4px"},children:"SHARPE RATIO"}),t.jsx("div",{style:{color:i,fontSize:"14px",fontWeight:"bold"},children:f.sharpe_ratio?.toFixed(2)||"N/A"})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:o,fontSize:"8px",marginBottom:"4px"},children:"VOLATILITY"}),t.jsxs("div",{style:{color:l,fontSize:"14px",fontWeight:"bold"},children:[(f.portfolio_volatility*100).toFixed(2),"%"]})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:o,fontSize:"8px",marginBottom:"4px"},children:"VaR (95%)"}),t.jsxs("div",{style:{color:n,fontSize:"14px",fontWeight:"bold"},children:[(f.value_at_risk_95*100).toFixed(2),"%"]})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:o,fontSize:"8px",marginBottom:"4px"},children:"MAX DRAWDOWN"}),t.jsxs("div",{style:{color:n,fontSize:"14px",fontWeight:"bold"},children:[(f.max_drawdown*100).toFixed(2),"%"]})]}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:o,fontSize:"8px",marginBottom:"4px"},children:"ANNUAL RETURN"}),t.jsxs("div",{style:{color:i,fontSize:"14px",fontWeight:"bold"},children:[(f.portfolio_return*100).toFixed(2),"%"]})]})]}),x&&t.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:`1px solid ${o}`},children:[t.jsx("div",{style:{color:e,fontSize:"10px",fontWeight:"bold",marginBottom:"8px"},children:"OPTIMIZED ALLOCATION (Max Sharpe Ratio)"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"8px"},children:s.holdings.map((z,$)=>{const W=z.weight,D=x.optimal_weights[$]*100,oe=D-W;return t.jsxs("div",{style:{padding:"6px",backgroundColor:"rgba(255,165,0,0.05)",border:`1px solid ${e}`,borderRadius:"2px"},children:[t.jsx("div",{style:{color:a,fontSize:"9px",fontWeight:"bold",marginBottom:"2px"},children:z.symbol}),t.jsxs("div",{style:{fontSize:"8px",color:o},children:["Current: ",W.toFixed(1),"%"]}),t.jsxs("div",{style:{fontSize:"8px",color:l},children:["Optimal: ",D.toFixed(1),"%"]}),t.jsxs("div",{style:{fontSize:"8px",color:oe>0?i:oe<0?n:o},children:[oe>0?"":oe<0?"":"="," ",Math.abs(oe).toFixed(1),"%"]})]},z.id)})}),t.jsxs("div",{style:{marginTop:"8px",fontSize:"9px",color:o},children:["Optimized Sharpe: ",t.jsx("span",{style:{color:i,fontWeight:"bold"},children:x.sharpe_ratio?.toFixed(2)})," | Expected Return: ",t.jsxs("span",{style:{color:i,fontWeight:"bold"},children:[(x.expected_return*100).toFixed(2),"%"]})," | Volatility: ",t.jsxs("span",{style:{color:l,fontWeight:"bold"},children:[(x.volatility*100).toFixed(2),"%"]})]})]})]}),b&&!f&&t.jsx("div",{style:{backgroundColor:"rgba(100,150,250,0.05)",border:`1px solid ${d}`,padding:"16px",marginBottom:"20px",borderRadius:"4px",textAlign:"center",color:a,fontSize:"10px"},children:"Loading advanced analytics..."}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"20px"},children:[t.jsxs("div",{style:{backgroundColor:"rgba(255,165,0,0.1)",border:`1px solid ${e}`,padding:"12px",borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"TOTAL VALUE"}),t.jsx("div",{style:{color:l,fontSize:"16px",fontWeight:"bold"},children:cp(j,p)}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:sr(j,p)})]}),t.jsxs("div",{style:{backgroundColor:k>=0?"rgba(0,200,0,0.1)":"rgba(255,0,0,0.1)",border:`1px solid ${k>=0?i:n}`,padding:"12px",borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"TOTAL P&L"}),t.jsx("div",{style:{color:k>=0?i:n,fontSize:"16px",fontWeight:"bold"},children:cp(k,p)}),t.jsx("div",{style:{color:k>=0?i:n,fontSize:"10px",marginTop:"2px"},children:cs(A)})]}),t.jsxs("div",{style:{backgroundColor:R>=0?"rgba(0,200,0,0.1)":"rgba(255,0,0,0.1)",border:`1px solid ${R>=0?i:n}`,padding:"12px",borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"DAY CHANGE"}),t.jsx("div",{style:{color:R>=0?i:n,fontSize:"16px",fontWeight:"bold"},children:cp(R,p)}),t.jsx("div",{style:{color:R>=0?i:n,fontSize:"10px",marginTop:"2px"},children:cs(M)})]}),t.jsxs("div",{style:{backgroundColor:"rgba(0,255,255,0.1)",border:`1px solid ${a}`,padding:"12px",borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"POSITIONS"}),t.jsx("div",{style:{color:a,fontSize:"16px",fontWeight:"bold"},children:P}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:"Active Holdings"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"16px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:i,fontSize:"11px",fontWeight:"bold",marginBottom:"8px",paddingBottom:"4px",borderBottom:`1px solid ${i}`},children:"TOP GAINERS"}),I.length===0?t.jsx("div",{style:{color:o,fontSize:"10px",padding:"8px"},children:"No data"}):I.map(z=>t.jsxs("div",{style:{padding:"8px",marginBottom:"4px",backgroundColor:"rgba(0,200,0,0.05)",borderLeft:`3px solid ${i}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"10px",fontWeight:"bold"},children:z.symbol}),t.jsx("div",{style:{color:o,fontSize:"8px"},children:sr(z.market_value,p)})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:i,fontSize:"10px",fontWeight:"bold"},children:cs(z.unrealized_pnl_percent)}),t.jsx("div",{style:{color:i,fontSize:"8px"},children:sr(z.unrealized_pnl,p)})]})]},z.id))]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:n,fontSize:"11px",fontWeight:"bold",marginBottom:"8px",paddingBottom:"4px",borderBottom:`1px solid ${n}`},children:"TOP LOSERS"}),O.length===0?t.jsx("div",{style:{color:o,fontSize:"10px",padding:"8px"},children:"No data"}):O.map(z=>t.jsxs("div",{style:{padding:"8px",marginBottom:"4px",backgroundColor:"rgba(255,0,0,0.05)",borderLeft:`3px solid ${n}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"10px",fontWeight:"bold"},children:z.symbol}),t.jsx("div",{style:{color:o,fontSize:"8px"},children:sr(z.market_value,p)})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:n,fontSize:"10px",fontWeight:"bold"},children:cs(z.unrealized_pnl_percent)}),t.jsx("div",{style:{color:n,fontSize:"8px"},children:sr(z.unrealized_pnl,p)})]})]},z.id))]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:d,fontSize:"11px",fontWeight:"bold",marginBottom:"8px",paddingBottom:"4px",borderBottom:`1px solid ${d}`},children:"LARGEST POSITIONS"}),G.length===0?t.jsx("div",{style:{color:o,fontSize:"10px",padding:"8px"},children:"No data"}):G.map(z=>t.jsxs("div",{style:{padding:"8px",marginBottom:"4px",backgroundColor:"rgba(100,150,250,0.05)",borderLeft:`3px solid ${d}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"10px",fontWeight:"bold"},children:z.symbol}),t.jsxs("div",{style:{color:o,fontSize:"8px"},children:["Weight: ",z.weight.toFixed(1),"%"]})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:r,fontSize:"10px",fontWeight:"bold"},children:cp(z.market_value,p)}),t.jsx("div",{style:{color:z.unrealized_pnl>=0?i:n,fontSize:"8px"},children:cs(z.unrealized_pnl_percent)})]})]},z.id))]})]}),t.jsxs("div",{style:{marginTop:"20px"},children:[t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${e}`},children:"ALLOCATION BREAKDOWN"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:s.holdings.map(z=>t.jsxs("div",{style:{padding:"8px",backgroundColor:"rgba(255,255,255,0.02)",border:"1px solid rgba(120,120,120,0.3)",borderRadius:"2px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsx("span",{style:{color:a,fontSize:"10px",fontWeight:"bold"},children:z.symbol}),t.jsxs("span",{style:{color:l,fontSize:"10px",fontWeight:"bold"},children:[z.weight.toFixed(1),"%"]})]}),t.jsx("div",{style:{width:"100%",height:"4px",backgroundColor:"rgba(120,120,120,0.3)",borderRadius:"2px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${z.weight}%`,height:"100%",backgroundColor:l,transition:"width 0.3s"}})}),t.jsxs("div",{style:{marginTop:"4px",display:"flex",justifyContent:"space-between",fontSize:"8px",color:o},children:[t.jsx("span",{children:cp(z.market_value,p)}),t.jsx("span",{style:{color:z.unrealized_pnl>=0?i:n},children:cs(z.unrealized_pnl_percent)})]})]},z.id))})]})]})},_t={TECHNOLOGY:"Technology",HEALTHCARE:"Healthcare",FINANCIAL:"Financial Services",CONSUMER_CYCLICAL:"Consumer Cyclical",CONSUMER_DEFENSIVE:"Consumer Defensive",INDUSTRIALS:"Industrials",ENERGY:"Energy",UTILITIES:"Utilities",REAL_ESTATE:"Real Estate",MATERIALS:"Basic Materials",COMMUNICATION:"Communication Services",CRYPTO:"Cryptocurrency",OTHER:"Other"},dp={AAPL:{sector:_t.TECHNOLOGY,industry:"Consumer Electronics"},MSFT:{sector:_t.TECHNOLOGY,industry:"Software"},GOOGL:{sector:_t.COMMUNICATION,industry:"Internet Content"},GOOG:{sector:_t.COMMUNICATION,industry:"Internet Content"},AMZN:{sector:_t.CONSUMER_CYCLICAL,industry:"Internet Retail"},META:{sector:_t.COMMUNICATION,industry:"Social Media"},NVDA:{sector:_t.TECHNOLOGY,industry:"Semiconductors"},TSLA:{sector:_t.CONSUMER_CYCLICAL,industry:"Auto Manufacturers"},AMD:{sector:_t.TECHNOLOGY,industry:"Semiconductors"},INTC:{sector:_t.TECHNOLOGY,industry:"Semiconductors"},CRM:{sector:_t.TECHNOLOGY,industry:"Software"},ORCL:{sector:_t.TECHNOLOGY,industry:"Software"},ADBE:{sector:_t.TECHNOLOGY,industry:"Software"},CSCO:{sector:_t.TECHNOLOGY,industry:"Communication Equipment"},IBM:{sector:_t.TECHNOLOGY,industry:"Information Technology Services"},JNJ:{sector:_t.HEALTHCARE,industry:"Drug Manufacturers"},UNH:{sector:_t.HEALTHCARE,industry:"Healthcare Plans"},PFE:{sector:_t.HEALTHCARE,industry:"Drug Manufacturers"},ABBV:{sector:_t.HEALTHCARE,industry:"Drug Manufacturers"},TMO:{sector:_t.HEALTHCARE,industry:"Diagnostics & Research"},ABT:{sector:_t.HEALTHCARE,industry:"Medical Devices"},MRK:{sector:_t.HEALTHCARE,industry:"Drug Manufacturers"},JPM:{sector:_t.FINANCIAL,industry:"Banks"},BAC:{sector:_t.FINANCIAL,industry:"Banks"},WFC:{sector:_t.FINANCIAL,industry:"Banks"},GS:{sector:_t.FINANCIAL,industry:"Capital Markets"},MS:{sector:_t.FINANCIAL,industry:"Capital Markets"},V:{sector:_t.FINANCIAL,industry:"Credit Services"},MA:{sector:_t.FINANCIAL,industry:"Credit Services"},"BRK.B":{sector:_t.FINANCIAL,industry:"Insurance"},WMT:{sector:_t.CONSUMER_DEFENSIVE,industry:"Discount Stores"},PG:{sector:_t.CONSUMER_DEFENSIVE,industry:"Household Products"},KO:{sector:_t.CONSUMER_DEFENSIVE,industry:"Beverages"},PEP:{sector:_t.CONSUMER_DEFENSIVE,industry:"Beverages"},COST:{sector:_t.CONSUMER_DEFENSIVE,industry:"Discount Stores"},NKE:{sector:_t.CONSUMER_CYCLICAL,industry:"Footwear & Accessories"},MCD:{sector:_t.CONSUMER_CYCLICAL,industry:"Restaurants"},SBUX:{sector:_t.CONSUMER_CYCLICAL,industry:"Restaurants"},DIS:{sector:_t.COMMUNICATION,industry:"Entertainment"},NFLX:{sector:_t.COMMUNICATION,industry:"Entertainment"},XOM:{sector:_t.ENERGY,industry:"Oil & Gas"},CVX:{sector:_t.ENERGY,industry:"Oil & Gas"},COP:{sector:_t.ENERGY,industry:"Oil & Gas"},BA:{sector:_t.INDUSTRIALS,industry:"Aerospace & Defense"},HON:{sector:_t.INDUSTRIALS,industry:"Conglomerates"},UPS:{sector:_t.INDUSTRIALS,industry:"Integrated Freight & Logistics"},CAT:{sector:_t.INDUSTRIALS,industry:"Farm & Heavy Machinery"},"RELIANCE.NS":{sector:_t.ENERGY,industry:"Oil & Gas Refining"},"RELIANCE.BO":{sector:_t.ENERGY,industry:"Oil & Gas Refining"},"TCS.NS":{sector:_t.TECHNOLOGY,industry:"Information Technology Services"},"TCS.BO":{sector:_t.TECHNOLOGY,industry:"Information Technology Services"},"INFY.NS":{sector:_t.TECHNOLOGY,industry:"Information Technology Services"},"INFY.BO":{sector:_t.TECHNOLOGY,industry:"Information Technology Services"},"HDFCBANK.NS":{sector:_t.FINANCIAL,industry:"Banks"},"HDFCBANK.BO":{sector:_t.FINANCIAL,industry:"Banks"},"ITC.NS":{sector:_t.CONSUMER_DEFENSIVE,industry:"Tobacco"},"ITC.BO":{sector:_t.CONSUMER_DEFENSIVE,industry:"Tobacco"},"BTC-USD":{sector:_t.CRYPTO,industry:"Cryptocurrency"},"ETH-USD":{sector:_t.CRYPTO,industry:"Cryptocurrency"},"USDT-USD":{sector:_t.CRYPTO,industry:"Stablecoin"},"BNB-USD":{sector:_t.CRYPTO,industry:"Cryptocurrency"},"XRP-USD":{sector:_t.CRYPTO,industry:"Cryptocurrency"},"SOL-USD":{sector:_t.CRYPTO,industry:"Cryptocurrency"},"ADA-USD":{sector:_t.CRYPTO,industry:"Cryptocurrency"},"DOGE-USD":{sector:_t.CRYPTO,industry:"Cryptocurrency"},SPY:{sector:_t.OTHER,industry:"Index ETF"},QQQ:{sector:_t.OTHER,industry:"Index ETF"},VOO:{sector:_t.OTHER,industry:"Index ETF"},VTI:{sector:_t.OTHER,industry:"Index ETF"},IWM:{sector:_t.OTHER,industry:"Index ETF"}};class CH{getSectorInfo(e){const r=e.toUpperCase().trim();if(dp[r])return dp[r];const n=r.split(".")[0];return dp[n]?dp[n]:this.classifyByPattern(r)}classifyByPattern(e){return e.endsWith("-USD")||e.endsWith("USD")||e.endsWith("USDT")?{sector:_t.CRYPTO,industry:"Cryptocurrency"}:e.length===3&&(e.startsWith("V")||e.startsWith("I")||e.startsWith("S"))?{sector:_t.OTHER,industry:"Index ETF"}:e.endsWith(".NS")||e.endsWith(".BO")?{sector:_t.OTHER,industry:"Indian Stock"}:{sector:_t.OTHER,industry:"Unknown"}}getUniqueSectors(e){const r=new Set;return e.forEach(n=>{const i=this.getSectorInfo(n);r.add(i.sector)}),Array.from(r).sort()}groupBySector(e){const r={};return e.forEach(n=>{const i=this.getSectorInfo(n);r[i.sector]||(r[i.sector]=[]),r[i.sector].push(n)}),r}addSectorMapping(e,r){dp[e.toUpperCase()]=r}getAllSectors(){return Object.values(_t)}}const jH=new CH,kH=({portfolioSummary:s})=>{const{ORANGE:e,WHITE:r,RED:n,GREEN:i,GRAY:o,CYAN:a,YELLOW:l,BLUE:d,PURPLE:p}=Rl,f=s.portfolio.currency,h=S.useMemo(()=>{const E=new Map,j=s.total_market_value;s.holdings.forEach(A=>{const M=jH.getSectorInfo(A.symbol).sector,P=E.get(M)||{value:0,holdings:[]};E.set(M,{value:P.value+A.market_value,holdings:[...P.holdings,A]})});const k=[d,i,e,p,a,l,n];return Array.from(E.entries()).map(([A,R],M)=>({sector:A,value:R.value,weight:j>0?R.value/j*100:0,holdings:R.holdings,color:k[M%k.length]})).sort((A,R)=>R.weight-A.weight)},[s.holdings,s.total_market_value]);let x=0;const m=h.map(E=>{const j=x,k=E.weight/100*360;return x+=k,{...E,startAngle:j,endAngle:x}}),b=120,w=150,y=150,C=E=>{const j=(E-90)*Math.PI/180;return{x:w+b*Math.cos(j),y:y+b*Math.sin(j)}},T=(E,j)=>{const k=C(E),A=C(j),R=j-E>180?1:0;return`M ${w} ${y} L ${k.x} ${k.y} A ${b} ${b} 0 ${R} 1 ${A.x} ${A.y} Z`};return t.jsxs("div",{children:[t.jsx("div",{style:{color:e,fontSize:"12px",fontWeight:"bold",marginBottom:"16px"},children:"SECTOR ALLOCATION"}),h.length===0?t.jsx("div",{style:{padding:"32px",textAlign:"center",color:o,fontSize:"11px"},children:"No sector data available. Add holdings with sector information."}):t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"400px 1fr",gap:"24px"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[t.jsxs("svg",{width:"300",height:"300",style:{marginBottom:"16px"},children:[m.map((E,j)=>t.jsxs("g",{children:[t.jsx("path",{d:T(E.startAngle,E.endAngle),fill:E.color,stroke:"#000000",strokeWidth:"2",opacity:"0.8"}),E.weight>5&&t.jsxs("text",{x:w+b*.7*Math.cos(((E.startAngle+E.endAngle)/2-90)*Math.PI/180),y:y+b*.7*Math.sin(((E.startAngle+E.endAngle)/2-90)*Math.PI/180),textAnchor:"middle",fill:"#FFFFFF",fontSize:"11",fontWeight:"bold",fontFamily:"Consolas, monospace",children:[E.weight.toFixed(1),"%"]})]},E.sector)),t.jsx("circle",{cx:w,cy:y,r:b*.4,fill:"#1a1a1a",stroke:"#FFA500",strokeWidth:"2"}),t.jsx("text",{x:w,y:y-10,textAnchor:"middle",fill:"#FFA500",fontSize:"12",fontWeight:"bold",fontFamily:"Consolas, monospace",children:"SECTORS"}),t.jsx("text",{x:w,y:y+10,textAnchor:"middle",fill:"#FFFFFF",fontSize:"14",fontWeight:"bold",fontFamily:"Consolas, monospace",children:h.length})]}),t.jsx("div",{style:{width:"100%"},children:h.map(E=>t.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"6px",padding:"6px",backgroundColor:"rgba(255,255,255,0.02)",borderLeft:`4px solid ${E.color}`},children:[t.jsx("div",{style:{width:"12px",height:"12px",backgroundColor:E.color,marginRight:"8px",border:"1px solid #000"}}),t.jsx("div",{style:{flex:1},children:t.jsx("span",{style:{color:r,fontSize:"10px",fontWeight:"bold"},children:E.sector})}),t.jsx("div",{style:{textAlign:"right"},children:t.jsxs("span",{style:{color:l,fontSize:"10px",fontWeight:"bold"},children:[E.weight.toFixed(1),"%"]})})]},E.sector))})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"8px",paddingBottom:"4px",borderBottom:`1px solid ${e}`},children:"SECTOR BREAKDOWN"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr 1fr 1fr",gap:"8px",padding:"8px",backgroundColor:"rgba(255,165,0,0.1)",fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:[t.jsx("div",{style:{color:r},children:"SECTOR"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"VALUE"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"WEIGHT"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"HOLDINGS"})]}),h.map((E,j)=>t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr 1fr 1fr",gap:"8px",padding:"8px",backgroundColor:j%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`3px solid ${E.color}`,fontSize:"10px",marginBottom:"4px"},children:[t.jsx("div",{style:{color:E.color,fontWeight:"bold"},children:E.sector}),t.jsx("div",{style:{color:l,textAlign:"right",fontWeight:"bold"},children:sr(E.value,f)}),t.jsxs("div",{style:{color:l,textAlign:"right",fontWeight:"bold"},children:[E.weight.toFixed(2),"%"]}),t.jsx("div",{style:{color:a,textAlign:"right"},children:E.holdings.length})]}),E.holdings.map(k=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.5fr 1fr 1fr 1fr",gap:"8px",padding:"6px 8px 6px 20px",backgroundColor:"rgba(255,255,255,0.01)",fontSize:"9px",borderLeft:`1px solid ${E.color}`,marginLeft:"8px"},children:[t.jsxs("div",{style:{color:a},children:[" ",k.symbol]}),t.jsx("div",{style:{color:r,textAlign:"right"},children:sr(k.market_value,f)}),t.jsxs("div",{style:{color:o,textAlign:"right"},children:[k.weight.toFixed(2),"%"]}),t.jsx("div",{style:{color:k.unrealized_pnl>=0?i:n,textAlign:"right",fontWeight:"bold"},children:cs(k.unrealized_pnl_percent)})]},k.id))]},E.sector)),t.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"rgba(255,165,0,0.05)",border:`1px solid ${e}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:e,fontSize:"10px",fontWeight:"bold",marginBottom:"8px"},children:"DIVERSIFICATION METRICS"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"2px"},children:"Total Sectors"}),t.jsx("div",{style:{color:a,fontSize:"14px",fontWeight:"bold"},children:h.length})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"2px"},children:"Largest Sector"}),t.jsxs("div",{style:{color:l,fontSize:"14px",fontWeight:"bold"},children:[h[0]?.sector||"N/A"," (",h[0]?.weight.toFixed(1),"%)"]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"2px"},children:"Concentration Risk"}),t.jsx("div",{style:{color:h[0]?.weight>40?n:h[0]?.weight>25?l:i,fontSize:"14px",fontWeight:"bold"},children:h[0]?.weight>40?"HIGH":h[0]?.weight>25?"MEDIUM":"LOW"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"2px"},children:"Diversification"}),t.jsx("div",{style:{color:h.length>=5?i:h.length>=3?l:n,fontSize:"14px",fontWeight:"bold"},children:h.length>=5?"GOOD":h.length>=3?"MODERATE":"POOR"})]})]})]})]})]})]})},AH=({portfolioSummary:s})=>{const{ORANGE:e,WHITE:r,RED:n,GREEN:i,GRAY:o,CYAN:a,YELLOW:l}=Rl,d=s.portfolio.currency,[p,f]=S.useState([]),[h,x]=S.useState(!0);if(S.useEffect(()=>{(async()=>{try{const F=await Li.getPortfolioPerformanceHistory(s.portfolio.id,30);if(F.length===0)f([{date:new Date().toISOString().split("T")[0],value:s.total_market_value,change:s.total_unrealized_pnl,changePercent:s.total_unrealized_pnl_percent}]);else{const z=F.reverse().map(D=>({date:D.snapshot_date.split("T")[0],value:D.total_value,change:D.total_pnl,changePercent:D.total_pnl_percent})),$=new Date().toISOString().split("T")[0];z.some(D=>D.date===$)||z.push({date:$,value:s.total_market_value,change:s.total_unrealized_pnl,changePercent:s.total_unrealized_pnl_percent}),f(z)}}catch(F){console.error("Failed to load performance data:",F),f([{date:new Date().toISOString().split("T")[0],value:s.total_market_value,change:s.total_unrealized_pnl,changePercent:s.total_unrealized_pnl_percent}])}finally{x(!1)}})()},[s.portfolio.id,s.total_market_value]),h)return t.jsxs("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:e,fontSize:"14px",marginBottom:"8px"},children:"Loading performance data..."}),t.jsx("div",{style:{color:o,fontSize:"10px"},children:"Fetching portfolio snapshots from database"})]});if(p.length===0)return t.jsxs("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"14px",marginBottom:"8px"},children:"No performance data available"}),t.jsx("div",{style:{color:o,fontSize:"10px"},children:"Portfolio snapshots will be created automatically as you use the application"})]});const m=800,b=300,w={top:20,right:40,bottom:40,left:60},y=m-w.left-w.right,C=b-w.top-w.bottom,T=Math.max(...p.map(B=>B.value)),E=Math.min(...p.map(B=>B.value)),j=T-E,k=B=>B/(p.length-1)*y+w.left,A=B=>b-w.bottom-(B-E)/j*C,R=p.map((B,F)=>{const z=k(F),$=A(B.value);return`${F===0?"M":"L"} ${z} ${$}`}).join(" "),M=R+` L ${k(p.length-1)} ${b-w.bottom} L ${w.left} ${b-w.bottom} Z`,P=p[p.length-1].value,I=p[0].value,O=(P-I)/I*100,G=P-I;return t.jsxs("div",{children:[t.jsxs("div",{style:{color:e,fontSize:"12px",fontWeight:"bold",marginBottom:"16px"},children:["PERFORMANCE CHART (",p.length," DAY",p.length>1?"S":"",")"]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"12px",marginBottom:"20px"},children:[t.jsxs("div",{style:{padding:"10px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"PERIOD RETURN"}),t.jsx("div",{style:{color:O>=0?i:n,fontSize:"14px",fontWeight:"bold"},children:cs(O)})]}),t.jsxs("div",{style:{padding:"10px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"PERIOD GAIN"}),t.jsx("div",{style:{color:G>=0?i:n,fontSize:"14px",fontWeight:"bold"},children:sr(G,d)})]}),t.jsxs("div",{style:{padding:"10px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"CURRENT VALUE"}),t.jsx("div",{style:{color:l,fontSize:"14px",fontWeight:"bold"},children:sr(P,d)})]}),t.jsxs("div",{style:{padding:"10px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"START VALUE"}),t.jsx("div",{style:{color:a,fontSize:"14px",fontWeight:"bold"},children:sr(I,d)})]}),t.jsxs("div",{style:{padding:"10px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"VOLATILITY"}),t.jsxs("div",{style:{color:e,fontSize:"14px",fontWeight:"bold"},children:[(j/I*100).toFixed(2),"%"]})]})]}),t.jsx("div",{style:{backgroundColor:"rgba(0,0,0,0.3)",border:`1px solid ${o}`,borderRadius:"4px",padding:"16px",marginBottom:"20px"},children:t.jsxs("svg",{width:m,height:b,children:[[0,.25,.5,.75,1].map((B,F)=>{const z=b-w.bottom-C*B,$=E+j*B;return t.jsxs("g",{children:[t.jsx("line",{x1:w.left,y1:z,x2:m-w.right,y2:z,stroke:o,strokeWidth:"0.5",strokeDasharray:"4,4",opacity:"0.3"}),t.jsx("text",{x:w.left-10,y:z+4,textAnchor:"end",fill:o,fontSize:"9",fontFamily:"Consolas, monospace",children:sr($,d)})]},F)}),p.filter((B,F)=>F%5===0).map((B,F)=>{const z=F*5,$=k(z);return t.jsx("text",{x:$,y:b-w.bottom+20,textAnchor:"middle",fill:o,fontSize:"8",fontFamily:"Consolas, monospace",children:B.date.substring(5)},F)}),t.jsx("path",{d:M,fill:O>=0?i:n,opacity:"0.1"}),t.jsx("path",{d:R,fill:"none",stroke:O>=0?i:n,strokeWidth:"2"}),p.map((B,F)=>t.jsx("circle",{cx:k(F),cy:A(B.value),r:"3",fill:B.changePercent>=0?i:n,stroke:"#000",strokeWidth:"1"},F)),t.jsx("line",{x1:w.left,y1:A(s.total_cost_basis),x2:m-w.right,y2:A(s.total_cost_basis),stroke:l,strokeWidth:"2",strokeDasharray:"8,4"}),t.jsx("text",{x:m-w.right-10,y:A(s.total_cost_basis)-8,textAnchor:"end",fill:l,fontSize:"10",fontWeight:"bold",fontFamily:"Consolas, monospace",children:"COST BASIS"}),t.jsx("text",{x:m/2,y:15,textAnchor:"middle",fill:e,fontSize:"12",fontWeight:"bold",fontFamily:"Consolas, monospace",children:"PORTFOLIO VALUE OVER TIME"})]})}),t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"8px",paddingBottom:"4px",borderBottom:`1px solid ${e}`},children:"DAILY PERFORMANCE DATA"}),t.jsxs("div",{style:{maxHeight:"300px",overflow:"auto"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1.2fr 1fr 1fr",gap:"8px",padding:"8px",backgroundColor:"rgba(255,165,0,0.1)",fontSize:"10px",fontWeight:"bold",position:"sticky",top:0,zIndex:1},children:[t.jsx("div",{style:{color:r},children:"DATE"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"VALUE"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"CHANGE"}),t.jsx("div",{style:{color:r,textAlign:"right"},children:"CHANGE %"})]}),p.slice().reverse().map((B,F)=>t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1.2fr 1fr 1fr",gap:"8px",padding:"8px",backgroundColor:F%2===0?"rgba(255,255,255,0.02)":"transparent",borderLeft:`3px solid ${B.changePercent>=0?i:n}`,fontSize:"10px",marginBottom:"2px"},children:[t.jsx("div",{style:{color:o},children:B.date}),t.jsx("div",{style:{color:r,textAlign:"right",fontWeight:"bold"},children:sr(B.value,d)}),t.jsx("div",{style:{color:B.change>=0?i:n,textAlign:"right",fontWeight:"bold"},children:sr(B.change,d)}),t.jsx("div",{style:{color:B.changePercent>=0?i:n,textAlign:"right",fontWeight:"bold"},children:cs(B.changePercent)})]},B.date))]}),p.length<7&&t.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"rgba(255,165,0,0.05)",border:`1px solid ${e}`,borderRadius:"4px",fontSize:"9px",color:o},children:[t.jsx("strong",{style:{color:e},children:"TIP:"})," Portfolio snapshots are created automatically. More historical data will be available as you continue to use the application. Current data points: ",p.length]})]})},TH=({portfolioSummary:s})=>{const{ORANGE:e,WHITE:r,RED:n,GREEN:i,GRAY:o,CYAN:a,YELLOW:l,BLUE:d}=Rl,[p,f]=S.useState(!0),[h,x]=S.useState([]),[m,b]=S.useState([]);S.useEffect(()=>{(async()=>{try{const G=await Li.getPortfolioPerformanceHistory(s.portfolio.id,252);if(G.length>1){const B=[],F=[];for(let z=G.length-1;z>=0;z--)if(F.push(G[z].total_value),z<G.length-1){const $=G[z+1].total_value,D=(G[z].total_value-$)/$;B.push(D)}x(B),b(F)}else x([]),b([s.total_market_value])}catch(G){console.error("Failed to load risk metrics data:",G),x([]),b([s.total_market_value])}finally{f(!1)}})()},[s.portfolio.id]);const w=h.length>0?pH(h):0,y=h.length>0?hH(h,h):1,C=h.length>0?fH(h):0,T=m.length>1?gH(m):0,E=h.length>0?xH(h,.95):0,j=h.length<5,A=(O=>O>2?{level:"LOW",color:i}:O>1?{level:"MODERATE",color:l}:O>0?{level:"HIGH",color:e}:{level:"VERY HIGH",color:n})(w),M=(O=>O<.8?{rating:"DEFENSIVE",color:d}:O<1.2?{rating:"NEUTRAL",color:a}:{rating:"AGGRESSIVE",color:e})(y),I=(O=>O<10?{rating:"LOW",color:i}:O<20?{rating:"MODERATE",color:l}:O<30?{rating:"HIGH",color:e}:{rating:"VERY HIGH",color:n})(C);return p?t.jsxs("div",{style:{padding:"40px",textAlign:"center",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:e,fontSize:"14px",marginBottom:"8px"},children:"Loading risk metrics..."}),t.jsx("div",{style:{color:o,fontSize:"10px"},children:"Calculating portfolio risk from historical data"})]}):t.jsxs("div",{children:[t.jsxs("div",{style:{color:e,fontSize:"12px",fontWeight:"bold",marginBottom:"16px"},children:["RISK METRICS & ANALYTICS ",j&&"(LIMITED DATA)"]}),j&&t.jsxs("div",{style:{padding:"12px",marginBottom:"16px",backgroundColor:"rgba(255,165,0,0.1)",border:`1px solid ${e}`,borderRadius:"4px",fontSize:"10px",color:e},children:[" ",t.jsx("strong",{children:"INSUFFICIENT HISTORICAL DATA:"})," Risk metrics require at least 5 days of portfolio snapshots for accurate calculations. Current data points: ",h.length,". Metrics shown are preliminary."]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginBottom:"24px"},children:[t.jsxs("div",{style:{padding:"16px",backgroundColor:"rgba(255,165,0,0.1)",border:`2px solid ${A.color}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"8px"},children:"OVERALL RISK"}),t.jsx("div",{style:{color:A.color,fontSize:"20px",fontWeight:"bold",marginBottom:"4px"},children:A.level}),t.jsxs("div",{style:{color:o,fontSize:"8px"},children:["Based on Sharpe Ratio: ",w.toFixed(2)]})]}),t.jsxs("div",{style:{padding:"16px",backgroundColor:"rgba(255,255,255,0.02)",border:`2px solid ${M.color}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"8px"},children:"MARKET SENSITIVITY"}),t.jsx("div",{style:{color:M.color,fontSize:"20px",fontWeight:"bold",marginBottom:"4px"},children:M.rating}),t.jsxs("div",{style:{color:o,fontSize:"8px"},children:["Beta: ",y.toFixed(2)]})]}),t.jsxs("div",{style:{padding:"16px",backgroundColor:"rgba(255,255,255,0.02)",border:`2px solid ${I.color}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"8px"},children:"VOLATILITY"}),t.jsx("div",{style:{color:I.color,fontSize:"20px",fontWeight:"bold",marginBottom:"4px"},children:I.rating}),t.jsxs("div",{style:{color:o,fontSize:"8px"},children:["Annualized: ",C.toFixed(2),"%"]})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"24px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${e}`},children:"RISK-ADJUSTED RETURNS"}),t.jsxs("div",{style:{padding:"12px",marginBottom:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:"SHARPE RATIO"}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:"Risk-adjusted return measure"})]}),t.jsx("div",{style:{color:w>1?i:w>0?l:n,fontSize:"18px",fontWeight:"bold"},children:w.toFixed(3)})]}),t.jsx("div",{style:{marginTop:"8px",fontSize:"8px",color:o},children:"> 2: Excellent | 1-2: Good | 0-1: Fair | < 0: Poor"})]}),t.jsxs("div",{style:{padding:"12px",marginBottom:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:"BETA ()"}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:"Market correlation coefficient"})]}),t.jsx("div",{style:{color:M.color,fontSize:"18px",fontWeight:"bold"},children:y.toFixed(3)})]}),t.jsx("div",{style:{marginTop:"8px",fontSize:"8px",color:o},children:"< 1: Less volatile | 1: Market neutral | > 1: More volatile"})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:"VOLATILITY"}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:"Annualized standard deviation"})]}),t.jsxs("div",{style:{color:I.color,fontSize:"18px",fontWeight:"bold"},children:[C.toFixed(2),"%"]})]}),t.jsx("div",{style:{marginTop:"8px",fontSize:"8px",color:o},children:"Lower volatility indicates more stable returns"})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${e}`},children:"DOWNSIDE RISK METRICS"}),t.jsxs("div",{style:{padding:"12px",marginBottom:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:"MAX DRAWDOWN"}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:"Largest peak-to-trough decline"})]}),t.jsxs("div",{style:{color:T>20?n:T>10?e:i,fontSize:"18px",fontWeight:"bold"},children:["-",T.toFixed(2),"%"]})]}),t.jsx("div",{style:{marginTop:"8px",fontSize:"8px",color:o},children:"Maximum loss from peak value"})]}),t.jsxs("div",{style:{padding:"12px",marginBottom:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:"VALUE AT RISK (95%)"}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:"Expected loss at 95% confidence"})]}),t.jsxs("div",{style:{color:E<-.03?n:E<-.02?e:l,fontSize:"18px",fontWeight:"bold"},children:[(E*100).toFixed(2),"%"]})]}),t.jsx("div",{style:{marginTop:"8px",fontSize:"8px",color:o},children:"5% chance of losing more than this in a day"})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,0,0,0.05)",border:`2px solid ${A.color}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:A.color,fontSize:"11px",fontWeight:"bold"},children:"COMPOSITE RISK SCORE"}),t.jsx("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:"Weighted risk assessment"})]}),t.jsxs("div",{style:{color:A.color,fontSize:"18px",fontWeight:"bold"},children:[(1/(w+1)*100).toFixed(0),"/100"]})]}),t.jsx("div",{style:{marginTop:"8px"},children:t.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"rgba(120,120,120,0.3)",borderRadius:"4px",overflow:"hidden"},children:t.jsx("div",{style:{width:`${1/(w+1)*100}%`,height:"100%",backgroundColor:A.color,transition:"width 0.3s"}})})})]})]})]}),t.jsxs("div",{style:{padding:"16px",backgroundColor:"rgba(255,165,0,0.05)",border:`1px solid ${e}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"12px"},children:"RISK MANAGEMENT RECOMMENDATIONS"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[w<1&&t.jsxs("div",{style:{fontSize:"9px",color:r,padding:"8px",backgroundColor:"rgba(255,0,0,0.1)",borderRadius:"2px"},children:[" ",t.jsx("strong",{children:"LOW SHARPE RATIO:"})," Consider diversifying to improve risk-adjusted returns"]}),y>1.5&&t.jsxs("div",{style:{fontSize:"9px",color:r,padding:"8px",backgroundColor:"rgba(255,165,0,0.1)",borderRadius:"2px"},children:[" ",t.jsx("strong",{children:"HIGH BETA:"})," Portfolio is more volatile than market. Consider defensive assets"]}),C>25&&t.jsxs("div",{style:{fontSize:"9px",color:r,padding:"8px",backgroundColor:"rgba(255,0,0,0.1)",borderRadius:"2px"},children:[" ",t.jsx("strong",{children:"HIGH VOLATILITY:"})," Consider adding bonds or stable assets to reduce swings"]}),T>20&&t.jsxs("div",{style:{fontSize:"9px",color:r,padding:"8px",backgroundColor:"rgba(255,0,0,0.1)",borderRadius:"2px"},children:[" ",t.jsx("strong",{children:"LARGE DRAWDOWN:"})," Review stop-loss strategies and position sizing"]}),w>2&&t.jsxs("div",{style:{fontSize:"9px",color:r,padding:"8px",backgroundColor:"rgba(0,200,0,0.1)",borderRadius:"2px"},children:[" ",t.jsx("strong",{children:"EXCELLENT SHARPE:"})," Portfolio shows strong risk-adjusted performance"]}),y>=.8&&y<=1.2&&t.jsxs("div",{style:{fontSize:"9px",color:r,padding:"8px",backgroundColor:"rgba(0,255,255,0.1)",borderRadius:"2px"},children:[" ",t.jsx("strong",{children:"BALANCED BETA:"})," Good market correlation, neither too aggressive nor defensive"]})]})]}),t.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"rgba(120,120,120,0.1)",border:`1px solid ${o}`,borderRadius:"4px",fontSize:"8px",color:o},children:[t.jsx("strong",{style:{color:e},children:"DISCLAIMER:"})," Risk metrics are calculated from portfolio snapshot history.",j&&" More data points are needed for statistically significant results."," ","Beta calculations use portfolio returns as market proxy until real market benchmarks are integrated. Past performance does not guarantee future results. Consult a financial advisor before making investment decisions."]})]})},RH=({portfolioSummary:s,transactions:e})=>{const{ORANGE:r,WHITE:n,RED:i,GREEN:o,GRAY:a,CYAN:l,YELLOW:d}=Rl,p=s.portfolio.currency,f=mH(e,.15,.2,365);return t.jsxs("div",{children:[t.jsx("div",{style:{color:r,fontSize:"12px",fontWeight:"bold",marginBottom:"16px"},children:"TAX REPORTS & STATEMENTS"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"24px"},children:[t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,165,0,0.1)",border:`1px solid ${r}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:a,fontSize:"9px",marginBottom:"4px"},children:"TOTAL TAX LIABILITY"}),t.jsx("div",{style:{color:r,fontSize:"16px",fontWeight:"bold"},children:sr(f.totalTax,p)})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(0,200,0,0.1)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:a,fontSize:"9px",marginBottom:"4px"},children:"LONG-TERM GAINS"}),t.jsx("div",{style:{color:o,fontSize:"16px",fontWeight:"bold"},children:sr(f.longTermGains,p)}),t.jsxs("div",{style:{color:a,fontSize:"8px",marginTop:"2px"},children:["Tax: ",sr(f.longTermTax,p)]})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,255,0,0.1)",border:`1px solid ${d}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:a,fontSize:"9px",marginBottom:"4px"},children:"SHORT-TERM GAINS"}),t.jsx("div",{style:{color:d,fontSize:"16px",fontWeight:"bold"},children:sr(f.shortTermGains,p)}),t.jsxs("div",{style:{color:a,fontSize:"8px",marginTop:"2px"},children:["Tax: ",sr(f.shortTermTax,p)]})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(0,255,255,0.1)",border:`1px solid ${l}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:a,fontSize:"9px",marginBottom:"4px"},children:"UNREALIZED GAINS"}),t.jsx("div",{style:{color:s.total_unrealized_pnl>=0?o:i,fontSize:"16px",fontWeight:"bold"},children:sr(s.total_unrealized_pnl,p)}),t.jsx("div",{style:{color:a,fontSize:"8px",marginTop:"2px"},children:"Not taxable until sold"})]})]}),t.jsx("div",{style:{color:r,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${r}`},children:"TAX BREAKDOWN (FIFO METHOD)"}),t.jsxs("div",{style:{padding:"16px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${a}`,borderRadius:"4px",marginBottom:"24px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[t.jsx("div",{style:{color:n,fontSize:"10px",fontWeight:"bold"},children:"CATEGORY"}),t.jsx("div",{style:{color:n,fontSize:"10px",fontWeight:"bold",textAlign:"right"},children:"GAINS"}),t.jsx("div",{style:{color:n,fontSize:"10px",fontWeight:"bold",textAlign:"right"},children:"TAX RATE"}),t.jsx("div",{style:{color:n,fontSize:"10px",fontWeight:"bold",textAlign:"right"},children:"TAX DUE"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"12px",padding:"12px",backgroundColor:"rgba(255,255,0,0.05)",borderLeft:`3px solid ${d}`,marginBottom:"8px"},children:[t.jsx("div",{style:{color:d,fontSize:"10px",fontWeight:"bold"},children:"Short-Term Capital Gains (< 1 year)"}),t.jsx("div",{style:{color:n,fontSize:"10px",textAlign:"right"},children:sr(f.shortTermGains,p)}),t.jsx("div",{style:{color:a,fontSize:"10px",textAlign:"right"},children:"15%"}),t.jsx("div",{style:{color:r,fontSize:"10px",textAlign:"right",fontWeight:"bold"},children:sr(f.shortTermTax,p)})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"12px",padding:"12px",backgroundColor:"rgba(0,200,0,0.05)",borderLeft:`3px solid ${o}`,marginBottom:"8px"},children:[t.jsx("div",{style:{color:o,fontSize:"10px",fontWeight:"bold"},children:"Long-Term Capital Gains (> 1 year)"}),t.jsx("div",{style:{color:n,fontSize:"10px",textAlign:"right"},children:sr(f.longTermGains,p)}),t.jsx("div",{style:{color:a,fontSize:"10px",textAlign:"right"},children:"20%"}),t.jsx("div",{style:{color:r,fontSize:"10px",textAlign:"right",fontWeight:"bold"},children:sr(f.longTermTax,p)})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"12px",padding:"12px",backgroundColor:"rgba(255,165,0,0.1)",borderTop:`2px solid ${r}`,marginTop:"8px"},children:[t.jsx("div",{style:{color:r,fontSize:"11px",fontWeight:"bold"},children:"TOTAL TAX DUE"}),t.jsx("div",{}),t.jsx("div",{}),t.jsx("div",{style:{color:r,fontSize:"12px",textAlign:"right",fontWeight:"bold"},children:sr(f.totalTax,p)})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:r,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${r}`},children:"TRANSACTION SUMMARY"}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${a}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("span",{style:{color:a,fontSize:"10px"},children:"Total Transactions:"}),t.jsx("span",{style:{color:n,fontSize:"10px",fontWeight:"bold"},children:e.length})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("span",{style:{color:a,fontSize:"10px"},children:"Buy Transactions:"}),t.jsx("span",{style:{color:o,fontSize:"10px",fontWeight:"bold"},children:e.filter(m=>m.transaction_type==="BUY").length})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("span",{style:{color:a,fontSize:"10px"},children:"Sell Transactions:"}),t.jsx("span",{style:{color:i,fontSize:"10px",fontWeight:"bold"},children:e.filter(m=>m.transaction_type==="SELL").length})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:a,fontSize:"10px"},children:"Current Positions:"}),t.jsx("span",{style:{color:l,fontSize:"10px",fontWeight:"bold"},children:s.holdings.length})]})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:r,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${r}`},children:"DIVIDEND INCOME"}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${a}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("span",{style:{color:a,fontSize:"10px"},children:"Total Dividends (YTD):"}),t.jsx("span",{style:{color:o,fontSize:"10px",fontWeight:"bold"},children:sr(0,p)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",paddingBottom:"8px",borderBottom:"1px solid rgba(120,120,120,0.3)"},children:[t.jsx("span",{style:{color:a,fontSize:"10px"},children:"Portfolio Yield:"}),t.jsxs("span",{style:{color:l,fontSize:"10px",fontWeight:"bold"},children:[0 .toFixed(2),"%"]})]}),t.jsx("div",{style:{padding:"8px",backgroundColor:"rgba(120,120,120,0.1)",borderRadius:"2px",marginTop:"8px"},children:t.jsx("div",{style:{color:a,fontSize:"9px",textAlign:"center"},children:"Dividend tracking coming soon..."})})]})]})]}),t.jsxs("div",{style:{marginTop:"24px",padding:"16px",backgroundColor:"rgba(255,165,0,0.05)",border:`1px solid ${r}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:r,fontSize:"11px",fontWeight:"bold",marginBottom:"12px"},children:"EXPORT OPTIONS"}),t.jsxs("div",{style:{display:"flex",gap:"12px"},children:[t.jsx("button",{style:{padding:"10px 16px",backgroundColor:r,color:"black",border:"none",borderRadius:"4px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"EXPORT TAX REPORT (PDF)"}),t.jsx("button",{style:{padding:"10px 16px",backgroundColor:o,color:"black",border:"none",borderRadius:"4px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"EXPORT TRANSACTIONS (CSV)"}),t.jsx("button",{style:{padding:"10px 16px",backgroundColor:l,color:"black",border:"none",borderRadius:"4px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"EXPORT HOLDINGS (XLSX)"})]}),t.jsx("div",{style:{marginTop:"12px",fontSize:"8px",color:a},children:"Reports are generated for the current tax year. Consult with a tax professional for accurate filing."})]})]})},NH=({portfolioSummary:s})=>{const{ORANGE:e,WHITE:r,RED:n,GREEN:i,GRAY:o,CYAN:a,YELLOW:l}=Rl,d=s.portfolio.currency,[p,f]=S.useState([]),[h,x]=S.useState(!1),[m,b]=S.useState({total:0,active:0,triggered:0,byType:{}});S.useEffect(()=>{x(!1)},[s.portfolio.id]);const w=async T=>{f(E=>E.filter(j=>j.id!==T))},y=T=>{switch(T){case"PRICE_TARGET":return t.jsx(ka,{size:14});case"STOP_LOSS":return t.jsx(Dd,{size:14});case"TAKE_PROFIT":return t.jsx(Nr,{size:14});default:return t.jsx(Py,{size:14})}},C=T=>{switch(T){case"PRICE_TARGET":return a;case"STOP_LOSS":return n;case"TAKE_PROFIT":return i;default:return l}};return t.jsxs("div",{children:[t.jsx("div",{style:{color:e,fontSize:"12px",fontWeight:"bold",marginBottom:"16px"},children:"PRICE ALERTS & NOTIFICATIONS"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"20px"},children:[t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,165,0,0.1)",border:`1px solid ${e}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"TOTAL ALERTS"}),t.jsx("div",{style:{color:e,fontSize:"16px",fontWeight:"bold"},children:m.total})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(0,200,0,0.1)",border:`1px solid ${i}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"ACTIVE"}),t.jsx("div",{style:{color:i,fontSize:"16px",fontWeight:"bold"},children:m.active})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,0,0,0.1)",border:`1px solid ${n}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"TRIGGERED"}),t.jsx("div",{style:{color:n,fontSize:"16px",fontWeight:"bold"},children:m.triggered})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(0,255,255,0.1)",border:`1px solid ${a}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:o,fontSize:"9px",marginBottom:"4px"},children:"POSITIONS TRACKED"}),t.jsx("div",{style:{color:a,fontSize:"16px",fontWeight:"bold"},children:new Set(p.map(T=>T.symbol)).size})]})]}),t.jsx("div",{style:{marginBottom:"20px"},children:t.jsxs("button",{style:{padding:"12px 20px",backgroundColor:e,color:"black",border:"none",borderRadius:"4px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(Py,{size:14}),"CREATE NEW ALERT"]})}),t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${e}`},children:"ACTIVE ALERTS"}),h?t.jsx("div",{style:{padding:"32px",textAlign:"center",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px",marginBottom:"20px"},children:t.jsx("div",{style:{color:e,fontSize:"11px"},children:"Loading alerts..."})}):p.filter(T=>!T.is_triggered).length===0?t.jsxs("div",{style:{padding:"32px",textAlign:"center",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px",marginBottom:"20px"},children:[t.jsx(Py,{size:48,color:o,style:{margin:"0 auto 12px"}}),t.jsx("div",{style:{color:o,fontSize:"11px"},children:"No active alerts. Create one to get notified about price movements."})]}):t.jsx("div",{style:{marginBottom:"20px"},children:p.filter(T=>!T.is_triggered).map(T=>{const j=s.holdings.find(k=>k.symbol===T.symbol)?.current_price||0;return t.jsxs("div",{style:{padding:"12px",marginBottom:"8px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${C(T.type)}`,borderLeft:`4px solid ${C(T.type)}`,borderRadius:"4px",display:"grid",gridTemplateColumns:"40px 100px 1fr 150px 150px 80px",gap:"12px",alignItems:"center"},children:[t.jsx("div",{style:{color:C(T.type),display:"flex",justifyContent:"center"},children:y(T.type)}),t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:T.symbol}),t.jsx("div",{style:{color:o,fontSize:"8px"},children:T.type.replace("_"," ")})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{color:r,fontSize:"10px"},children:["Alert when price ",T.condition.toLowerCase().replace("_"," ")]}),t.jsxs("div",{style:{color:o,fontSize:"8px",marginTop:"2px"},children:["Created: ",T.created_at.split("T")[0]]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:o,fontSize:"8px"},children:"TARGET PRICE"}),t.jsx("div",{style:{color:C(T.type),fontSize:"12px",fontWeight:"bold"},children:sr(T.target_value,d)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:o,fontSize:"8px"},children:"CURRENT PRICE"}),t.jsx("div",{style:{color:r,fontSize:"12px",fontWeight:"bold"},children:j>0?sr(j,d):"N/A"})]}),t.jsx("div",{style:{display:"flex",gap:"4px",justifyContent:"flex-end"},children:t.jsx("button",{onClick:()=>w(T.id),style:{padding:"6px 10px",backgroundColor:n,color:"white",border:"none",borderRadius:"2px",fontSize:"9px",fontWeight:"bold",cursor:"pointer"},children:"DELETE"})})]},T.id)})}),t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"12px",paddingBottom:"4px",borderBottom:`1px solid ${e}`},children:"SUGGESTED ALERTS FOR YOUR POSITIONS"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px",marginBottom:"20px"},children:s.holdings.slice(0,4).map(T=>{const E=T.avg_buy_price*.9,j=T.avg_buy_price*1.2;return t.jsxs("div",{style:{padding:"12px",backgroundColor:"rgba(255,255,255,0.02)",border:`1px solid ${o}`,borderRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:T.symbol}),t.jsx("div",{style:{color:r,fontSize:"10px"},children:sr(T.current_price,d)})]}),t.jsxs("div",{style:{fontSize:"9px",marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px",color:o},children:[t.jsx("span",{children:"Stop Loss (10%):"}),t.jsx("span",{style:{color:n},children:sr(E,d)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:o},children:[t.jsx("span",{children:"Take Profit (20%):"}),t.jsx("span",{style:{color:i},children:sr(j,d)})]})]}),t.jsx("button",{style:{width:"100%",padding:"6px",backgroundColor:e,color:"black",border:"none",borderRadius:"2px",fontSize:"9px",fontWeight:"bold",cursor:"pointer"},children:"CREATE ALERTS"})]},T.id)})}),t.jsxs("div",{style:{padding:"16px",backgroundColor:"rgba(255,165,0,0.05)",border:`1px solid ${e}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:e,fontSize:"11px",fontWeight:"bold",marginBottom:"12px"},children:"NOTIFICATION SETTINGS"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsxs("div",{children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",defaultChecked:!0}),t.jsx("span",{style:{color:r,fontSize:"10px"},children:"Desktop notifications"})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",defaultChecked:!0}),t.jsx("span",{style:{color:r,fontSize:"10px"},children:"Email notifications"})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox"}),t.jsx("span",{style:{color:r,fontSize:"10px"},children:"SMS notifications (Premium)"})]})]}),t.jsxs("div",{children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",defaultChecked:!0}),t.jsx("span",{style:{color:r,fontSize:"10px"},children:"Daily portfolio summary"})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox"}),t.jsx("span",{style:{color:r,fontSize:"10px"},children:"Weekly performance report"})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",defaultChecked:!0}),t.jsx("span",{style:{color:r,fontSize:"10px"},children:"Large position movements (>5%)"})]})]})]})]})]})};class OH{async calculateValueAdded(e,r,n){try{const i=await lt("calculate_active_value_added",{portfolioReturns:JSON.stringify(e),benchmarkReturns:JSON.stringify(r),portfolioWeights:n?JSON.stringify(n):null}),o=JSON.parse(i);if(o.error)throw new Error(o.error);return o}catch(i){throw console.error("[ActiveManagementService] Value added calculation error:",i),i}}async calculateInformationRatio(e,r){try{const n=await lt("calculate_active_information_ratio",{portfolioReturns:JSON.stringify(e),benchmarkReturns:JSON.stringify(r)}),i=JSON.parse(n);if(i.error)throw new Error(i.error);return i}catch(n){throw console.error("[ActiveManagementService] Information ratio calculation error:",n),n}}async calculateTrackingRisk(e,r){try{const n=await lt("calculate_active_tracking_risk",{portfolioReturns:JSON.stringify(e),benchmarkReturns:JSON.stringify(r)}),i=JSON.parse(n);if(i.error)throw new Error(i.error);return i}catch(n){throw console.error("[ActiveManagementService] Tracking risk calculation error:",n),n}}async comprehensiveAnalysis(e,r){try{const n=await lt("comprehensive_active_analysis",{portfolioData:JSON.stringify(e),benchmarkData:JSON.stringify(r)}),i=JSON.parse(n);if(i.error)throw new Error(i.error);return i}catch(n){throw console.error("[ActiveManagementService] Comprehensive analysis error:",n),n}}async analyzeManagerSelection(e){try{const r=await lt("analyze_manager_selection",{managerCandidates:JSON.stringify(e)}),n=JSON.parse(r);if(n.error)throw new Error(n.error);return n}catch(r){throw console.error("[ActiveManagementService] Manager selection error:",r),r}}calculatePortfolioReturns(e){if(e.length===0)return[];const r=Math.max(...e.map(i=>i.prices.length)),n=[];for(let i=1;i<r;i++){let o=0,a=0;e.forEach(l=>{if(i<l.prices.length){const d=(l.prices[i]-l.prices[i-1])/l.prices[i-1],p=l.quantities[i]*l.prices[i];o+=d*p,a+=p}}),n.push(a>0?o/a:0)}return n}async fetchBenchmarkReturns(e="SPY",r=252){try{const{marketDataService:n}=await Br(async()=>{const{marketDataService:l}=await Promise.resolve().then(()=>cq);return{marketDataService:l}},void 0),i=await n.getPeriodReturns(e);if(i){const l=Math.abs(i.seven_day/100)/Math.sqrt(7),d=i.thirty_day/100/30;return Array.from({length:r},()=>d+(Math.random()-.5)*2*l)}const o=.1/252,a=.16/Math.sqrt(252);return Array.from({length:r},()=>o+(Math.random()-.5)*2*a)}catch(n){return console.error("[ActiveManagementService] Benchmark fetch error:",n),Array.from({length:r},()=>(Math.random()-.5)*.02)}}}const sk=new OH,_H=({portfolioId:s,portfolioData:e})=>{const r=dx(),{ORANGE:n,WHITE:i,RED:o,GREEN:a,GRAY:l,PANEL_BG:d,CYAN:p,YELLOW:f}=r,[h,x]=S.useState(!1),[m,b]=S.useState(null),[w,y]=S.useState(null),[C,T]=S.useState("^GSPC");S.useEffect(()=>{e?.returns&&e.returns.length>0&&E()},[e]);const E=async()=>{if(!e?.returns||e.returns.length===0){y("No portfolio return data available");return}x(!0),y(null);try{const M=await sk.fetchBenchmarkReturns(C==="^GSPC"?"SPY":C,e.returns.length),P=M.length>0?M:e.returns.map(()=>Math.random()*.01-.005),I=await sk.comprehensiveAnalysis({returns:e.returns,weights:e.weights},{returns:P});b(I)}catch(M){y(M instanceof Error?M.message:"Analysis failed"),console.error("[ActiveManagementView] Analysis error:",M)}finally{x(!1)}};if(h)return t.jsxs("div",{style:{padding:"24px",textAlign:"center"},children:[t.jsx("div",{style:{color:n,fontSize:"12px",marginBottom:"12px"},children:"Running Active Management Analysis..."}),t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mx-auto"})]});if(w)return t.jsxs("div",{style:{padding:"24px",backgroundColor:"rgba(255,0,0,0.1)",border:`1px solid ${o}`,color:o,fontSize:"11px"},children:[t.jsx(Cl,{size:16,style:{display:"inline-block",marginRight:"8px"}}),w]});if(!m)return t.jsxs("div",{style:{padding:"24px",textAlign:"center",color:l,fontSize:"11px"},children:[t.jsx(Cs,{size:48,color:l,style:{margin:"0 auto 12px"}}),t.jsx("div",{children:"No analysis data yet"}),t.jsx("div",{style:{marginTop:"8px",fontSize:"10px"},children:"Portfolio needs return data to perform active management analysis"})]});const{value_added_analysis:j,information_ratio_analysis:k,active_management_assessment:A,improvement_recommendations:R}=m;return t.jsxs("div",{style:{height:"100%",overflow:"auto"},children:[t.jsxs("div",{style:{backgroundColor:d,borderBottom:`1px solid ${l}`,padding:"12px",position:"sticky",top:0,zIndex:10},children:[t.jsx("div",{style:{color:n,fontWeight:"bold",fontSize:"12px",marginBottom:"8px"},children:"ACTIVE MANAGEMENT ANALYTICS"}),t.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"10px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:l},children:"BENCHMARK: "}),t.jsx("span",{style:{color:p},children:C})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:l},children:"QUALITY RATING: "}),t.jsx("span",{style:{color:A.quality_rating==="Excellent"?a:A.quality_rating==="Good"?p:A.quality_rating==="Average"?f:o,fontWeight:"bold"},children:A.quality_rating})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:l},children:"QUALITY SCORE: "}),t.jsxs("span",{style:{color:i},children:[A.quality_score,"/100"]})]})]})]}),t.jsxs("div",{style:{padding:"12px",display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[t.jsx(od,{title:"ACTIVE RETURN",value:cs(j.active_return_annualized),icon:t.jsx(Nr,{size:16}),color:j.active_return_annualized>=0?a:o,subtitle:"Annualized"}),t.jsx(od,{title:"INFORMATION RATIO",value:Lp(k.information_ratio_annualized,2),icon:t.jsx(ka,{size:16}),color:k.information_ratio_annualized>.5?a:f,subtitle:"Risk-Adjusted Performance"}),t.jsx(od,{title:"TRACKING ERROR",value:cs(k.tracking_error_annualized),icon:t.jsx(Cs,{size:16}),color:p,subtitle:"Annualized"}),t.jsx(od,{title:"HIT RATE",value:cs(j.hit_rate),icon:t.jsx(MM,{size:16}),color:j.hit_rate>.55?a:f,subtitle:"Positive Periods"}),t.jsx(od,{title:"SIGNIFICANCE",value:j.statistical_significance.is_significant?"YES":"NO",icon:t.jsx(Nr,{size:16}),color:j.statistical_significance.is_significant?a:o,subtitle:`p-value: ${j.statistical_significance.p_value.toFixed(3)}`}),t.jsx(od,{title:"T-STATISTIC",value:Lp(j.statistical_significance.t_statistic,2),icon:t.jsx(Cs,{size:16}),color:Math.abs(j.statistical_significance.t_statistic)>2?a:f,subtitle:"Statistical Measure"})]}),t.jsx("div",{style:{padding:"0 12px 12px"},children:t.jsxs("div",{style:{backgroundColor:d,border:`1px solid ${l}`,padding:"12px"},children:[t.jsx("div",{style:{color:n,fontSize:"11px",fontWeight:"bold",marginBottom:"12px"},children:"VALUE ADDED DECOMPOSITION"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px",fontSize:"10px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:l,marginBottom:"4px"},children:"ALLOCATION EFFECT"}),t.jsx("div",{style:{color:i,fontSize:"12px",fontWeight:"bold"},children:cs(j.value_added_decomposition.estimated_allocation_effect)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:l,marginBottom:"4px"},children:"SELECTION EFFECT"}),t.jsx("div",{style:{color:i,fontSize:"12px",fontWeight:"bold"},children:cs(j.value_added_decomposition.estimated_selection_effect)})]})]}),j.value_added_decomposition.note&&t.jsxs("div",{style:{color:l,fontSize:"9px",marginTop:"8px",fontStyle:"italic"},children:["Note: ",j.value_added_decomposition.note]})]})}),t.jsxs("div",{style:{padding:"0 12px 12px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsxs("div",{style:{backgroundColor:d,border:`1px solid ${a}`,padding:"12px"},children:[t.jsx("div",{style:{color:a,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"KEY STRENGTHS"}),t.jsx("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"10px",color:i},children:A.key_strengths.map((M,P)=>t.jsx("li",{style:{marginBottom:"4px"},children:M},P))})]}),t.jsxs("div",{style:{backgroundColor:d,border:`1px solid ${f}`,padding:"12px"},children:[t.jsx("div",{style:{color:f,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"AREAS FOR IMPROVEMENT"}),t.jsx("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"10px",color:i},children:A.areas_for_improvement.map((M,P)=>t.jsx("li",{style:{marginBottom:"4px"},children:M},P))})]})]}),R&&R.length>0&&t.jsx("div",{style:{padding:"0 12px 12px"},children:t.jsxs("div",{style:{backgroundColor:d,border:`1px solid ${p}`,padding:"12px"},children:[t.jsx("div",{style:{color:p,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"IMPROVEMENT RECOMMENDATIONS"}),t.jsx("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"10px",color:i},children:R.map((M,P)=>t.jsx("li",{style:{marginBottom:"6px"},children:M},P))})]})})]})},od=({title:s,value:e,icon:r,color:n,subtitle:i})=>{const{PANEL_BG:o,GRAY:a}=dx();return t.jsxs("div",{style:{backgroundColor:o,border:`1px solid ${a}`,padding:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("div",{style:{color:a,fontSize:"9px",fontWeight:"bold"},children:s}),t.jsx("div",{style:{color:n},children:r})]}),t.jsx("div",{style:{color:n,fontSize:"16px",fontWeight:"bold",marginBottom:"4px"},children:e}),i&&t.jsx("div",{style:{color:a,fontSize:"9px"},children:i})]})},DH=()=>{const{colors:s}=Er(),e=dx(),[r,n]=S.useState(new Date),[i,o]=S.useState([]),[a,l]=S.useState(null),[d,p]=S.useState(null),[f,h]=S.useState([]),[x,m]=S.useState(!1),[b,w]=S.useState(!1),[y,C]=S.useState("POSITIONS"),[T,E]=S.useState(!1),[j,k]=S.useState(!1),[A,R]=S.useState(!1),[M,P]=S.useState(""),[I,O]=S.useState(""),[G,B]=S.useState("USD"),[F,z]=S.useState(""),[$,W]=S.useState(""),[D,oe]=S.useState(""),[Z,fe]=S.useState(""),[Q,_]=S.useState(""),[Y,he]=S.useState(""),{ORANGE:me,WHITE:ge,RED:le,GREEN:X,GRAY:V,DARK_BG:de,PANEL_BG:je,CYAN:_e,YELLOW:Re}=e;S.useEffect(()=>{(async()=>{m(!0);try{await Li.initialize(),await Be()}catch(Oe){console.error("[PortfolioTab] Initialization error:",Oe)}finally{m(!1)}})()},[]),S.useEffect(()=>{const Ee=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(Ee)},[]),S.useEffect(()=>{if(a){const Ee=setInterval(()=>{ie()},6e4);return()=>clearInterval(Ee)}},[a]);const Be=async()=>{try{const Ee=await Li.getPortfolios();o(Ee),Ee.length>0&&!a&&l(Ee[0])}catch(Ee){console.error("[PortfolioTab] Error loading portfolios:",Ee)}},Se=async Ee=>{try{w(!0);const Oe=await Li.getPortfolioSummary(Ee);p(Oe);const q=await Li.getPortfolioTransactions(Ee,20);h(q)}catch(Oe){console.error("[PortfolioTab] Error loading portfolio summary:",Oe)}finally{w(!1)}},ie=()=>{a&&Se(a.id)};S.useEffect(()=>{a&&Se(a.id)},[a]);const ve=async()=>{if(!M||!I){alert("Please fill in all required fields");return}try{const Ee=await Li.createPortfolio(M,I,G);await Be(),l(Ee),E(!1),P(""),O(""),B("USD")}catch(Ee){console.error("[PortfolioTab] Error creating portfolio:",Ee),alert("Failed to create portfolio")}},Ae=async()=>{if(!a||!F||!$||!D){alert("Please fill in all required fields");return}try{await Li.addAsset(a.id,F.toUpperCase(),parseFloat($),parseFloat(D)),await ie(),k(!1),z(""),W(""),oe("")}catch(Ee){console.error("[PortfolioTab] Error adding asset:",Ee),alert("Failed to add asset")}},$e=async()=>{if(!a||!Z||!Q||!Y){alert("Please fill in all required fields");return}try{await Li.sellAsset(a.id,Z.toUpperCase(),parseFloat(Q),parseFloat(Y)),await ie(),R(!1),fe(""),_(""),he("")}catch(Ee){console.error("[PortfolioTab] Error selling asset:",Ee),alert(Ee instanceof Error?Ee.message:"Failed to sell asset")}},qe=async Ee=>{if(confirm("Are you sure you want to delete this portfolio? This action cannot be undone."))try{await Li.deletePortfolio(Ee),await Be(),a?.id===Ee&&(l(i.length>1?i[0]:null),p(null))}catch(Oe){console.error("[PortfolioTab] Error deleting portfolio:",Oe),alert("Failed to delete portfolio")}},Ie=async()=>{if(a)try{const Ee=await Li.exportPortfolioCSV(a.id),Oe=new Blob([Ee],{type:"text/csv"}),q=URL.createObjectURL(Oe),ee=document.createElement("a");ee.href=q,ee.download=`${a.name}_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(q)}catch(Ee){console.error("[PortfolioTab] Error exporting CSV:",Ee),alert("Failed to export CSV")}},K=a?.currency||"USD";return t.jsxs("div",{style:{height:"100%",backgroundColor:de,color:ge,fontFamily:"Consolas, monospace",overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar { width: 8px; height: 8px; }
        *::-webkit-scrollbar-track { background: #1a1a1a; }
        *::-webkit-scrollbar-thumb { background: #404040; border-radius: 4px; }
        *::-webkit-scrollbar-thumb:hover { background: #525252; }
      `}),t.jsxs("div",{style:{backgroundColor:je,borderBottom:`1px solid ${V}`,padding:"8px 12px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:me,fontWeight:"bold",fontSize:"14px"},children:"FINCEPT PORTFOLIO MANAGER"}),t.jsx("span",{style:{color:ge},children:"|"}),t.jsxs("span",{style:{color:b?me:X,fontSize:"10px"},children:[" ",b?"UPDATING":"LIVE"]}),t.jsx("span",{style:{color:ge},children:"|"}),t.jsx(Tl,{compact:!0})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsxs("button",{onClick:()=>E(!0),style:{background:me,color:"black",border:"none",padding:"4px 12px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(wn,{size:12}),"NEW PORTFOLIO"]}),t.jsxs("button",{onClick:ie,disabled:!a||b,style:{background:a&&!b?X:V,color:"black",border:"none",padding:"4px 12px",fontSize:"10px",fontWeight:"bold",cursor:a&&!b?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"4px",opacity:a&&!b?1:.5},children:[t.jsx(xn,{size:12}),"REFRESH"]}),t.jsxs("button",{onClick:Ie,disabled:!a,style:{background:a?_e:V,color:"black",border:"none",padding:"4px 12px",fontSize:"10px",fontWeight:"bold",cursor:a?"pointer":"not-allowed",display:"flex",alignItems:"center",gap:"4px",opacity:a?1:.5},children:[t.jsx(Mi,{size:12}),"EXPORT CSV"]})]})]}),d&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"11px",marginTop:"8px"},children:[t.jsx("span",{style:{color:V},children:"TOTAL VALUE:"}),t.jsx("span",{style:{color:Re,fontWeight:"bold"},children:sr(d.total_market_value,K)}),t.jsx("span",{style:{color:ge},children:"|"}),t.jsx("span",{style:{color:V},children:"DAY P&L:"}),t.jsxs("span",{style:{color:d.total_day_change>=0?X:le,fontWeight:"bold"},children:[sr(d.total_day_change,K)," (",cs(d.total_day_change_percent),")"]}),t.jsx("span",{style:{color:ge},children:"|"}),t.jsx("span",{style:{color:V},children:"TOTAL P&L:"}),t.jsxs("span",{style:{color:d.total_unrealized_pnl>=0?X:le,fontWeight:"bold"},children:[sr(d.total_unrealized_pnl,K)," (",cs(d.total_unrealized_pnl_percent),")"]}),t.jsx("span",{style:{color:ge},children:"|"}),t.jsx("span",{style:{color:V},children:"POSITIONS:"}),t.jsx("span",{style:{color:_e},children:d.total_positions})]})]}),t.jsx("div",{style:{backgroundColor:je,borderBottom:`1px solid ${V}`,padding:"4px 8px",flexShrink:0},children:t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(12, 1fr)",gap:"4px"},children:[{key:"F1",label:"POSITIONS",view:"POSITIONS"},{key:"F2",label:"ADD ASSET",action:()=>k(!0)},{key:"F3",label:"SELL ASSET",action:()=>R(!0)},{key:"F4",label:"ANALYTICS",view:"ANALYTICS"},{key:"F5",label:"HISTORY",view:"HISTORY"},{key:"F6",label:"ACTIVE MGMT",view:"ACTIVE_MGMT"},{key:"F7",label:"PERFORMANCE",view:"PERFORMANCE"},{key:"F8",label:"REBALANCE",view:"REBALANCE"},{key:"F9",label:"REPORTS",view:"REPORTS"},{key:"F10",label:"ALERTS",view:"ALERTS"},{key:"F11",label:"SECTORS",view:"SECTORS"},{key:"F12",label:"HELP",view:"HELP"}].map(Ee=>t.jsxs("button",{onClick:()=>{Ee.action?a&&Ee.action():Ee.view&&C(Ee.view)},disabled:!a&&!Ee.view,style:{backgroundColor:y===Ee.view?me:de,border:`1px solid ${V}`,color:y===Ee.view?"black":ge,padding:"4px 6px",fontSize:"9px",cursor:a||Ee.view?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",opacity:!a&&!Ee.view?.5:1},children:[t.jsxs("span",{style:{color:Re},children:[Ee.key,":"]}),t.jsx("span",{children:Ee.label})]},Ee.key))})}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsxs("div",{style:{width:"250px",backgroundColor:je,borderRight:`1px solid ${V}`,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"8px",backgroundColor:de,borderBottom:`1px solid ${V}`,color:me,fontSize:"11px",fontWeight:"bold"},children:["PORTFOLIOS (",i.length,")"]}),t.jsx("div",{style:{flex:1,overflow:"auto"},children:x?t.jsx("div",{style:{padding:"16px",textAlign:"center",color:V,fontSize:"10px"},children:"Loading portfolios..."}):i.length===0?t.jsxs("div",{style:{padding:"16px",textAlign:"center",color:V,fontSize:"10px"},children:["No portfolios yet.",t.jsx("br",{}),"Click NEW PORTFOLIO to create one."]}):i.map(Ee=>t.jsxs("div",{onClick:()=>l(Ee),style:{padding:"12px",backgroundColor:a?.id===Ee.id?"rgba(255,165,0,0.1)":"transparent",borderLeft:a?.id===Ee.id?`3px solid ${me}`:"3px solid transparent",cursor:"pointer",borderBottom:"1px solid rgba(120,120,120,0.3)",transition:"all 0.2s"},onMouseEnter:Oe=>{a?.id!==Ee.id&&(Oe.currentTarget.style.backgroundColor="rgba(255,255,255,0.05)")},onMouseLeave:Oe=>{a?.id!==Ee.id&&(Oe.currentTarget.style.backgroundColor="transparent")},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsx("div",{style:{color:a?.id===Ee.id?me:ge,fontSize:"11px",fontWeight:"bold"},children:Ee.name}),t.jsx("button",{onClick:Oe=>{Oe.stopPropagation(),qe(Ee.id)},style:{background:"transparent",border:"none",color:le,cursor:"pointer",padding:"2px",display:"flex"},children:t.jsx(On,{size:12})})]}),t.jsxs("div",{style:{fontSize:"9px",color:V},children:["Owner: ",Ee.owner]}),t.jsxs("div",{style:{fontSize:"9px",color:_e},children:["Currency: ",Ee.currency]})]},Ee.id))})]}),t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:a?d?t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:[y==="POSITIONS"&&t.jsx(SH,{portfolioSummary:d}),y==="HISTORY"&&t.jsx(wH,{transactions:f,currency:K}),y==="ANALYTICS"&&t.jsx(EH,{portfolioSummary:d}),y==="SECTORS"&&t.jsx(kH,{portfolioSummary:d}),y==="PERFORMANCE"&&t.jsx(AH,{portfolioSummary:d}),y==="REBALANCE"&&t.jsx(TH,{portfolioSummary:d}),y==="REPORTS"&&t.jsx(RH,{portfolioSummary:d,transactions:f}),y==="ALERTS"&&t.jsx(NH,{portfolioSummary:d}),y==="ACTIVE_MGMT"&&t.jsx(_H,{portfolioId:a.id,portfolioData:{returns:d.holdings.length>0?d.holdings.map(Ee=>(Ee.day_change_percent||0)/100):[],weights:d.holdings.map(Ee=>Ee.weight/100)}}),!["POSITIONS","HISTORY","ANALYTICS","SECTORS","PERFORMANCE","REBALANCE","REPORTS","ALERTS","ACTIVE_MGMT"].includes(y)&&t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"16px"},children:[t.jsx(Jg,{size:64,color:V}),t.jsxs("div",{style:{color:V,fontSize:"12px"},children:[y," view coming soon..."]})]})]}):t.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:V,fontSize:"12px"},children:"Loading portfolio data..."}):t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"16px"},children:[t.jsx(ja,{size:64,color:V}),t.jsx("div",{style:{color:V,fontSize:"14px"},children:"Select a portfolio or create a new one to get started"})]})})]}),t.jsx("div",{style:{borderTop:`1px solid ${V}`,backgroundColor:je,padding:"4px 12px",fontSize:"9px",color:V,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{children:"Fincept Portfolio Manager v2.1.0 | Real-time tracking with yfinance integration"}),d&&t.jsxs("span",{children:["Last Updated: ",new Date(d.last_updated).toLocaleTimeString()," | Status: ",t.jsx("span",{style:{color:X},children:"CONNECTED"})]})]})}),T&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:de,border:`2px solid ${me}`,padding:"24px",minWidth:"400px"},children:[t.jsx("div",{style:{color:me,fontSize:"14px",fontWeight:"bold",marginBottom:"16px"},children:"CREATE NEW PORTFOLIO"}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"PORTFOLIO NAME *"}),t.jsx("input",{type:"text",value:M,onChange:Ee=>P(Ee.target.value),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px"},placeholder:"My Portfolio"})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"OWNER *"}),t.jsx("input",{type:"text",value:I,onChange:Ee=>O(Ee.target.value),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px"},placeholder:"John Doe"})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"CURRENCY"}),t.jsxs("select",{value:G,onChange:Ee=>B(Ee.target.value),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px"},children:[t.jsx("option",{value:"USD",children:"USD - US Dollar"}),t.jsx("option",{value:"EUR",children:"EUR - Euro"}),t.jsx("option",{value:"GBP",children:"GBP - British Pound"}),t.jsx("option",{value:"INR",children:"INR - Indian Rupee"})]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:()=>E(!1),style:{background:V,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:ve,style:{background:me,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"CREATE"})]})]})}),j&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:de,border:`2px solid ${X}`,padding:"24px",minWidth:"400px"},children:[t.jsx("div",{style:{color:X,fontSize:"14px",fontWeight:"bold",marginBottom:"16px"},children:"ADD ASSET TO PORTFOLIO"}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"SYMBOL *"}),t.jsx("input",{type:"text",value:F,onChange:Ee=>z(Ee.target.value.toUpperCase()),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px",textTransform:"uppercase"},placeholder:"AAPL"})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"QUANTITY *"}),t.jsx("input",{type:"number",value:$,onChange:Ee=>W(Ee.target.value),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px"},placeholder:"100",step:"0.0001"})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"BUY PRICE *"}),t.jsx("input",{type:"number",value:D,onChange:Ee=>oe(Ee.target.value),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px"},placeholder:"150.00",step:"0.01"})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:()=>k(!1),style:{background:V,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:Ae,style:{background:X,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"ADD"})]})]})}),A&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:de,border:`2px solid ${le}`,padding:"24px",minWidth:"400px"},children:[t.jsx("div",{style:{color:le,fontSize:"14px",fontWeight:"bold",marginBottom:"16px"},children:"SELL ASSET FROM PORTFOLIO"}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"SYMBOL *"}),t.jsx("input",{type:"text",value:Z,onChange:Ee=>fe(Ee.target.value.toUpperCase()),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px",textTransform:"uppercase"},placeholder:"AAPL"})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"QUANTITY *"}),t.jsx("input",{type:"number",value:Q,onChange:Ee=>_(Ee.target.value),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px"},placeholder:"50",step:"0.0001"})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:V,fontSize:"10px",display:"block",marginBottom:"4px"},children:"SELL PRICE *"}),t.jsx("input",{type:"number",value:Y,onChange:Ee=>he(Ee.target.value),style:{width:"100%",background:je,border:`1px solid ${V}`,color:ge,padding:"8px",fontSize:"11px"},placeholder:"180.00",step:"0.01"})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:()=>R(!1),style:{background:V,color:"black",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:$e,style:{background:le,color:"white",border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"SELL"})]})]})})]})};var wv=(s=>(s.DRAWING="drawing",s.INDICATOR="indicator",s.ANNOTATION="annotation",s.INTERACTIVE="interactive",s.OVERLAY="overlay",s))(wv||{});class _2{constructor(e,r={}){Pe(this,"metadata");Pe(this,"options");Pe(this,"chart",null);Pe(this,"series",null);Pe(this,"primitive",null);Pe(this,"eventListeners",new Map);this.metadata={...e},this.options={...this.getDefaultOptions(),...r}}getDefaultOptions(){return{visible:!0,interactive:!1,color:"#2196F3",lineWidth:2,lineStyle:0}}initialize(e,r){this.chart=e,this.series=r,this.primitive=this.createPrimitive(),this.primitive&&this.metadata.enabled&&this.attachPrimitive()}attachPrimitive(){this.primitive&&this.series&&this.series.attachPrimitive(this.primitive)}detachPrimitive(){this.primitive&&this.series&&this.series.detachPrimitive(this.primitive)}applyOptions(e){this.options={...this.options,...e},this.onOptionsChanged()}onOptionsChanged(){this.chart&&this.chart.timeScale().fitContent()}getPrimitive(){return this.primitive}setEnabled(e){this.metadata.enabled!==e&&(this.metadata.enabled=e,e?this.attachPrimitive():this.detachPrimitive())}destroy(){this.detachPrimitive(),this.eventListeners.clear(),this.chart=null,this.series=null,this.primitive=null}addEventListener(e,r){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(r)}removeEventListener(e,r){const n=this.eventListeners.get(e);if(n){const i=n.indexOf(r);i>-1&&n.splice(i,1)}}emitEvent(e){const r=this.eventListeners.get(e.type);r&&r.forEach(n=>n(e))}}class IH{constructor(e,r){Pe(this,"plugins",new Map);Pe(this,"chart",null);Pe(this,"series",null);e&&(this.chart=e),r&&(this.series=r)}setContext(e,r){this.chart=e,this.series=r,this.plugins.forEach(n=>{this.chart&&this.series&&n.initialize(this.chart,this.series)})}register(e){const r=e.metadata.id;if(this.plugins.has(r)){console.warn(`Plugin with id "${r}" is already registered. Skipping.`);return}this.chart&&this.series&&e.initialize(this.chart,this.series),this.plugins.set(r,e),console.log(`Plugin "${e.metadata.name}" registered successfully.`)}unregister(e){const r=this.plugins.get(e);if(!r){console.warn(`Plugin with id "${e}" not found.`);return}r.destroy(),this.plugins.delete(e),console.log(`Plugin "${r.metadata.name}" unregistered.`)}getPlugins(){return Array.from(this.plugins.values())}getPluginsByCategory(e){return this.getPlugins().filter(r=>r.metadata.category===e)}togglePlugin(e,r){const n=this.plugins.get(e);if(!n){console.warn(`Plugin with id "${e}" not found.`);return}n.setEnabled(r),console.log(`Plugin "${n.metadata.name}" ${r?"enabled":"disabled"}.`)}getPlugin(e){return this.plugins.get(e)}enableAll(){this.plugins.forEach(e=>e.setEnabled(!0))}disableAll(){this.plugins.forEach(e=>e.setEnabled(!1))}clear(){this.plugins.forEach(e=>e.destroy()),this.plugins.clear()}getEnabledCount(){return this.getPlugins().filter(e=>e.metadata.enabled).length}getStats(){const e=this.getPlugins(),r={};return e.forEach(n=>{const i=n.metadata.category;r[i]=(r[i]||0)+1}),{total:e.length,enabled:this.getEnabledCount(),byCategory:r}}destroy(){this.clear(),this.chart=null,this.series=null}}class PH{constructor(e){Pe(this,"_data",null);Pe(this,"_options");this._options=e}update(e){this._data=e}renderer(){return{draw:e=>{!this._data||!this._data.visible||e.useBitmapCoordinateSpace(r=>{const n=r.context,i=this._data.x+(this._options.offsetX||10),o=this._data.y+(this._options.offsetY||10),a=[];if(this._options.customFormatter?a.push(this._options.customFormatter(this._data)):(this._options.showTime&&this._data.time&&a.push(`Time: ${this.formatTime(this._data.time)}`),this._options.showOHLC&&this._data.ohlc?(a.push(`O: ${this._data.ohlc.open.toFixed(2)}`),a.push(`H: ${this._data.ohlc.high.toFixed(2)}`),a.push(`L: ${this._data.ohlc.low.toFixed(2)}`),a.push(`C: ${this._data.ohlc.close.toFixed(2)}`)):this._options.showPrice&&this._data.price!==void 0&&a.push(`Price: ${this._data.price.toFixed(2)}`),this._options.showVolume&&this._data.volume!==void 0&&a.push(`Vol: ${this.formatVolume(this._data.volume)}`)),a.length===0)return;const l=this._options.fontSize||12,d=this._options.fontFamily||"monospace",p=this._options.padding||8,f=l*1.4;n.font=`${l}px ${d}`;const x=Math.max(...a.map(w=>n.measureText(w).width))+p*2,m=a.length*f+p*2;n.fillStyle=this._options.backgroundColor||"rgba(0, 0, 0, 0.8)",n.strokeStyle=this._options.borderColor||"rgba(255, 255, 255, 0.2)",n.lineWidth=this._options.borderWidth||1;const b=this._options.borderRadius||4;this.roundRect(n,i,o,x,m,b),n.fill(),n.stroke(),n.fillStyle=this._options.textColor||"#ffffff",a.forEach((w,y)=>{n.fillText(w,i+p,o+p+(y+1)*f-4)})})}}}roundRect(e,r,n,i,o,a){e.beginPath(),e.moveTo(r+a,n),e.lineTo(r+i-a,n),e.quadraticCurveTo(r+i,n,r+i,n+a),e.lineTo(r+i,n+o-a),e.quadraticCurveTo(r+i,n+o,r+i-a,n+o),e.lineTo(r+a,n+o),e.quadraticCurveTo(r,n+o,r,n+o-a),e.lineTo(r,n+a),e.quadraticCurveTo(r,n,r+a,n),e.closePath()}formatTime(e){return typeof e=="number"?new Date(e*1e3).toLocaleString():typeof e=="object"&&"year"in e?`${e.year}-${String(e.month).padStart(2,"0")}-${String(e.day).padStart(2,"0")}`:String(e)}formatVolume(e){return e>=1e9?(e/1e9).toFixed(2)+"B":e>=1e6?(e/1e6).toFixed(2)+"M":e>=1e3?(e/1e3).toFixed(2)+"K":e.toFixed(0)}}class LH{constructor(e){Pe(this,"_paneViews");Pe(this,"_options");this._options=e,this._paneViews=[new PH(e)]}updateAllViews(){this._paneViews.forEach(e=>e.update(null))}paneViews(){return this._paneViews}update(e){this._paneViews[0].update(e)}updateOptions(e){this._options={...this._options,...e}}}class zH extends _2{constructor(r={}){const n={visible:!0,backgroundColor:"rgba(0, 0, 0, 0.85)",textColor:"#ffffff",borderColor:"rgba(255, 255, 255, 0.2)",borderWidth:1,borderRadius:6,padding:10,fontSize:11,fontFamily:"monospace",followCursor:!0,offsetX:15,offsetY:15,showTime:!0,showPrice:!1,showOHLC:!0,showVolume:!0,...r};super({id:"tooltip",name:"Tooltip",description:"Displays price and time information on hover",category:wv.INTERACTIVE,version:"1.0.0",author:"Fincept Terminal",enabled:!0},n);Pe(this,"tooltipPrimitive",null)}getDefaultOptions(){return{visible:!0,showTime:!0,showOHLC:!0,showVolume:!0}}createPrimitive(){return this.tooltipPrimitive=new LH(this.options),this.tooltipPrimitive}updateTooltip(r){this.tooltipPrimitive&&this.tooltipPrimitive.update(r)}onOptionsChanged(){this.tooltipPrimitive&&this.tooltipPrimitive.updateOptions(this.options),super.onOptionsChanged()}}var Nn=(s=>(s.TREND_LINE="trendline",s.HORIZONTAL_LINE="horizontal",s.VERTICAL_LINE="vertical",s.RAY="ray",s.EXTENDED_LINE="extended",s.PARALLEL_CHANNEL="channel",s.REGRESSION_CHANNEL="regression",s.PITCHFORK="pitchfork",s.RECTANGLE="rectangle",s.ELLIPSE="ellipse",s.TRIANGLE="triangle",s.ARROW="arrow",s.FIBO_RETRACEMENT="fibo_retracement",s.FIBO_EXTENSION="fibo_extension",s.FIBO_FAN="fibo_fan",s.FIBO_CIRCLE="fibo_circle",s.FIBO_SPIRAL="fibo_spiral",s.GANN_FAN="gann_fan",s.GANN_BOX="gann_box",s.LONG_POSITION="long_position",s.SHORT_POSITION="short_position",s.STOP_LOSS="stop_loss",s.TAKE_PROFIT="take_profit",s.ENTRY_ORDER="entry_order",s.TEXT="text",s.CALLOUT="callout",s.LABEL="label",s.PRICE_NOTE="price_note",s.MEASURE="measure",s.ANGLE="angle",s))(Nn||{});class MH{constructor(e){Pe(this,"_drawings",[]);Pe(this,"_positions",[]);Pe(this,"_options");Pe(this,"_chart",null);Pe(this,"_series",null);Pe(this,"_selectedDrawingId",null);Pe(this,"_hoveredDrawingId",null);this._options=e}setSelectedDrawing(e){this._selectedDrawingId=e}setHoveredDrawing(e){this._hoveredDrawingId=e}update(e,r,n,i){this._drawings=e,this._positions=r,this._chart=n,this._series=i}renderer(){return{draw:e=>{!this._chart||!this._series||e.useBitmapCoordinateSpace(r=>{const n=r.context,i=r.horizontalPixelRatio||1,o=r.verticalPixelRatio||1;n.save(),n.scale(i,o);const a=r.bitmapSize.width/i,l=r.bitmapSize.height/o;this._drawings.forEach(d=>{d.visible!==!1&&this.drawObject(n,d,a,l)}),this._positions.forEach(d=>{this.drawPosition(n,d)}),n.restore()})}}}drawObject(e,r,n,i){const o=this.getCoordinates(r.points);if(o.some(d=>d===null)){console.warn("[TradingToolkit] Skipping drawing - null coordinates:",{type:r.type,points:r.points});return}const a=r.id===this._selectedDrawingId,l=r.id===this._hoveredDrawingId;switch(a?this.applyStyle(e,{...r.style,color:"#FF8800",lineWidth:(r.style.lineWidth||2)+1}):l?this.applyStyle(e,{...r.style,color:"#00D66F"}):this.applyStyle(e,r.style),r.type){case"trendline":this.drawTrendLine(e,o,r);break;case"horizontal":this.drawHorizontalLine(e,o,r,n);break;case"vertical":this.drawVerticalLine(e,o,r,i);break;case"ray":this.drawRay(e,o,r);break;case"channel":this.drawChannel(e,o,r);break;case"regression":this.drawRegressionChannel(e,o,r);break;case"pitchfork":this.drawPitchfork(e,o,r);break;case"rectangle":this.drawRectangle(e,o,r);break;case"ellipse":this.drawEllipse(e,o,r);break;case"triangle":this.drawTriangle(e,o,r);break;case"fibo_retracement":this.drawFibonacci(e,o,r);break;case"long_position":case"short_position":this.drawPositionBox(e,o,r);break;case"text":this.drawText(e,o,r);break;case"callout":this.drawCallout(e,o,r);break;case"arrow":this.drawArrow(e,o,r);break;default:console.warn("[TradingToolkit] No renderer for tool type:",r.type)}}drawTrendLine(e,r,n){if(r.length<2)return;const[i,o]=r[0],[a,l]=r[1];e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.stroke(),this.drawAnchor(e,i,o,n.style.color),this.drawAnchor(e,a,l,n.style.color)}drawHorizontalLine(e,r,n,i){if(r.length<1)return;const[o,a]=r[0];e.beginPath(),e.moveTo(0,a),e.lineTo(i,a),e.stroke(),this.drawAnchor(e,o,a,n.style.color)}drawVerticalLine(e,r,n,i){if(r.length<1)return;const[o,a]=r[0];e.beginPath(),e.moveTo(o,0),e.lineTo(o,i),e.stroke(),this.drawAnchor(e,o,a,n.style.color)}drawRay(e,r,n){if(r.length<2)return;const[i,o]=r[0],[a,l]=r[1],d=a-i,p=l-o,f=Math.atan2(p,d),h=1e4,x=i+Math.cos(f)*h,m=o+Math.sin(f)*h;e.beginPath(),e.moveTo(i,o),e.lineTo(x,m),e.stroke(),this.drawAnchor(e,i,o,n.style.color),this.drawAnchor(e,a,l,n.style.color)}drawTriangle(e,r,n){if(r.length<3)return;const[i,o]=r[0],[a,l]=r[1],[d,p]=r[2];n.style.fillColor&&(e.fillStyle=n.style.fillColor,e.globalAlpha=n.style.fillOpacity||.2,e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.lineTo(d,p),e.closePath(),e.fill(),e.globalAlpha=1),e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.lineTo(d,p),e.closePath(),e.stroke(),this.drawAnchor(e,i,o,n.style.color),this.drawAnchor(e,a,l,n.style.color),this.drawAnchor(e,d,p,n.style.color)}drawChannel(e,r,n){if(r.length<3)return;const[i,o]=r[0],[a,l]=r[1],[d,p]=r[2],f=p-o;e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.stroke(),e.beginPath(),e.moveTo(i,o+f),e.lineTo(a,l+f),e.stroke(),n.style.fillColor&&(e.fillStyle=n.style.fillColor,e.globalAlpha=n.style.fillOpacity||.1,e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.lineTo(a,l+f),e.lineTo(i,o+f),e.closePath(),e.fill(),e.globalAlpha=1),this.drawAnchor(e,i,o,n.style.color),this.drawAnchor(e,a,l,n.style.color),this.drawAnchor(e,d,p,n.style.color)}drawRegressionChannel(e,r,n){if(r.length<3)return;const[i,o]=r[0],[a,l]=r[1],[d,p]=r[2],f=Math.abs(p-o);e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.stroke(),e.beginPath(),e.moveTo(i,o-f),e.lineTo(a,l-f),e.stroke(),e.beginPath(),e.moveTo(i,o+f),e.lineTo(a,l+f),e.stroke(),n.style.fillColor&&(e.fillStyle=n.style.fillColor,e.globalAlpha=n.style.fillOpacity||.1,e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.lineTo(a,l-f),e.lineTo(i,o-f),e.closePath(),e.fill(),e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.lineTo(a,l+f),e.lineTo(i,o+f),e.closePath(),e.fill(),e.globalAlpha=1),this.drawAnchor(e,i,o,n.style.color),this.drawAnchor(e,a,l,n.style.color),this.drawAnchor(e,d,p,n.style.color)}drawPitchfork(e,r,n){if(r.length<3)return;const[i,o]=r[0],[a,l]=r[1],[d,p]=r[2],f=(a+d)/2,h=(l+p)/2,x=f-i,m=h-o,b=2,w=i+x*b,y=o+m*b;e.setLineDash([5,5]),e.beginPath(),e.moveTo(i,o),e.lineTo(w,y),e.stroke(),e.setLineDash([]);const C=a-i,T=l-o,E=i+C*b,j=o+T*b;e.beginPath(),e.moveTo(i,o),e.lineTo(E,j),e.stroke();const k=d-i,A=p-o,R=i+k*b,M=o+A*b;e.beginPath(),e.moveTo(i,o),e.lineTo(R,M),e.stroke(),n.style.fillColor&&(e.fillStyle=n.style.fillColor,e.globalAlpha=n.style.fillOpacity||.05,e.beginPath(),e.moveTo(i,o),e.lineTo(E,j),e.lineTo(R,M),e.closePath(),e.fill(),e.globalAlpha=1),this.drawAnchor(e,i,o,n.style.color),this.drawAnchor(e,a,l,n.style.color),this.drawAnchor(e,d,p,n.style.color)}drawRectangle(e,r,n){if(r.length<2)return;const[i,o]=r[0],[a,l]=r[1],d=Math.min(i,a),p=Math.min(o,l),f=Math.abs(a-i),h=Math.abs(l-o);n.style.fillColor&&(e.fillStyle=n.style.fillColor,e.globalAlpha=n.style.fillOpacity||.2,e.fillRect(d,p,f,h),e.globalAlpha=1),e.strokeRect(d,p,f,h),this.drawAnchor(e,i,o,n.style.color),this.drawAnchor(e,a,l,n.style.color)}drawEllipse(e,r,n){if(r.length<2)return;const[i,o]=r[0],[a,l]=r[1],d=(i+a)/2,p=(o+l)/2,f=Math.abs(a-i)/2,h=Math.abs(l-o)/2;e.beginPath(),e.ellipse(d,p,f,h,0,0,2*Math.PI),n.style.fillColor&&(e.fillStyle=n.style.fillColor,e.globalAlpha=n.style.fillOpacity||.2,e.fill(),e.globalAlpha=1),e.stroke()}drawFibonacci(e,r,n){if(r.length<2)return;const[i,o]=r[0],[a,l]=r[1];(this._options.fibonacciLevels||[{level:0,label:"0%",color:"#787878",showLabel:!0},{level:.236,label:"23.6%",color:"#f23645",showLabel:!0},{level:.382,label:"38.2%",color:"#ff9800",showLabel:!0},{level:.5,label:"50%",color:"#fbbf24",showLabel:!0},{level:.618,label:"61.8%",color:"#4caf50",showLabel:!0},{level:.786,label:"78.6%",color:"#2196f3",showLabel:!0},{level:1,label:"100%",color:"#787878",showLabel:!0}]).forEach(p=>{const f=o+(l-o)*p.level;e.strokeStyle=p.color,e.setLineDash([5,5]),e.beginPath(),e.moveTo(i,f),e.lineTo(a,f),e.stroke(),e.setLineDash([]),p.showLabel&&(e.fillStyle=p.color,e.font="11px monospace",e.fillText(p.label,a+5,f+4))}),e.strokeStyle=n.style.color,e.beginPath(),e.moveTo(i,o),e.lineTo(a,o),e.stroke(),e.beginPath(),e.moveTo(i,l),e.lineTo(a,l),e.stroke()}drawPositionBox(e,r,n){if(r.length<2)return;const[i,o]=r[0],[a,l]=r[1],d=n.type==="long_position",p=d?this._options.longColor||"#10b981":this._options.shortColor||"#ef4444";e.fillStyle=p+"20",e.strokeStyle=p,e.lineWidth=2;const f=Math.min(i,a),h=Math.min(o,l),x=Math.abs(a-i),m=Math.abs(l-o);if(e.fillRect(f,h,x,m),e.strokeRect(f,h,x,m),e.fillStyle=p,e.font="bold 12px monospace",e.fillText(d?"LONG":"SHORT",f+5,h+15),n.data?.pnl!==void 0){const b=n.data.pnl>=0?this._options.profitColor||"#10b981":this._options.lossColor||"#ef4444";e.fillStyle=b,e.fillText(`${n.data.pnl>=0?"+":""}${n.data.pnl.toFixed(2)}%`,f+5,h+30)}}drawText(e,r,n){if(r.length<1||!n.data?.text)return;const[i,o]=r[0];e.fillStyle=n.style.textColor||n.style.color,e.font=`bold ${n.style.fontSize||14}px monospace`,e.fillText(n.data.text,i,o),this.drawAnchor(e,i,o,n.style.color)}drawCallout(e,r,n){if(r.length<1||!n.data?.text)return;const[i,o]=r[0],a=n.data.text;e.font=`${n.style.fontSize||14}px monospace`;const d=e.measureText(a).width,p=n.style.fontSize||14,f=8,h=d+f*2,x=p+f*2;e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(i,o-x,h,x),e.strokeStyle=n.style.color,e.lineWidth=2,e.strokeRect(i,o-x,h,x);const m=o+15;e.beginPath(),e.moveTo(i+h/2,o),e.lineTo(i+h/2,m),e.stroke(),e.fillStyle=n.style.textColor||"#FFFFFF",e.fillText(a,i+f,o-f-2),this.drawAnchor(e,i+h/2,m,n.style.color)}drawArrow(e,r,n){if(r.length<2)return;const[i,o]=r[0],[a,l]=r[1];e.beginPath(),e.moveTo(i,o),e.lineTo(a,l),e.stroke();const d=Math.atan2(l-o,a-i),p=15;e.beginPath(),e.moveTo(a,l),e.lineTo(a-p*Math.cos(d-Math.PI/6),l-p*Math.sin(d-Math.PI/6)),e.moveTo(a,l),e.lineTo(a-p*Math.cos(d+Math.PI/6),l-p*Math.sin(d+Math.PI/6)),e.stroke()}drawPosition(e,r){if(!this._chart||!this._series)return;const n=this._chart.timeScale().timeToCoordinate(r.time),i=this._series.priceToCoordinate(r.price);if(n===null||i===null)return;const o=r.type==="long",a=12;e.fillStyle=r.color,e.beginPath(),o?(e.moveTo(n,i-a),e.lineTo(n-a/2,i),e.lineTo(n+a/2,i)):(e.moveTo(n,i+a),e.lineTo(n-a/2,i),e.lineTo(n+a/2,i)),e.closePath(),e.fill(),e.strokeStyle="#ffffff",e.lineWidth=1,e.stroke(),r.label&&(e.fillStyle="#ffffff",e.font="10px monospace",e.fillText(r.label,n+8,i+4))}getCoordinates(e){return!this._chart||!this._series?e.map(()=>null):e.map(r=>{const n=this._chart.timeScale().timeToCoordinate(r.time),i=this._series.priceToCoordinate(r.price);return n!==null&&i!==null?[n,i]:null})}applyStyle(e,r){switch(e.strokeStyle=r.color,e.lineWidth=r.lineWidth,r.lineStyle){case"dashed":e.setLineDash([5,5]);break;case"dotted":e.setLineDash([2,2]);break;default:e.setLineDash([])}}drawAnchor(e,r,n,i){e.fillStyle=i,e.strokeStyle="#ffffff",e.lineWidth=2,e.beginPath(),e.arc(r,n,5,0,2*Math.PI),e.fill(),e.stroke()}findDrawingAtPoint(e,r){for(let i=this._drawings.length-1;i>=0;i--){const o=this._drawings[i],a=this.getCoordinates(o.points);if(!a.some(l=>l===null))switch(o.type){case"trendline":case"ray":case"horizontal":case"vertical":if(this.hitTestLine(e,r,a,10))return o.id;break;case"rectangle":case"channel":case"regression":if(this.hitTestRectangle(e,r,a,10))return o.id;break;case"ellipse":if(this.hitTestEllipse(e,r,a,10))return o.id;break;case"text":case"callout":if(this.hitTestPoint(e,r,a,10))return o.id;break;default:if(this.hitTestAnyAnchor(e,r,a,10))return o.id}}return null}findAnchorAtPoint(e,r,n){const i=this._drawings.find(l=>l.id===e);if(!i)return-1;const o=this.getCoordinates(i.points);if(o.some(l=>l===null))return-1;const a=12;for(let l=0;l<o.length;l++){const d=o[l];if(d===null)continue;const[p,f]=d;if(Math.sqrt((r-p)**2+(n-f)**2)<=a)return l}return-1}hitTestLine(e,r,n,i){if(n.length<2)return!1;const[o,a]=n[0],[l,d]=n[1];return this.pointToLineDistance(e,r,o,a,l,d)<=i}hitTestRectangle(e,r,n,i){if(n.length<2)return!1;const[o,a]=n[0],[l,d]=n[1],p=Math.min(o,l),f=Math.max(o,l),h=Math.min(a,d),x=Math.max(a,d);if(e>=p-i&&e<=f+i&&r>=h-i&&r<=x+i){const m=Math.abs(e-p)<=i,b=Math.abs(e-f)<=i,w=Math.abs(r-h)<=i,y=Math.abs(r-x)<=i;return m||b||w||y||e>=p&&e<=f&&r>=h&&r<=x}return!1}hitTestEllipse(e,r,n,i){if(n.length<2)return!1;const[o,a]=n[0],[l,d]=n[1],p=(o+l)/2,f=(a+d)/2,h=Math.abs(l-o)/2,x=Math.abs(d-a)/2,m=((e-p)/h)**2+((r-f)/x)**2;return Math.abs(m-1)*Math.min(h,x)<=i}hitTestPoint(e,r,n,i){if(n.length<1)return!1;const[o,a]=n[0];return Math.sqrt((e-o)**2+(r-a)**2)<=i*2}hitTestAnyAnchor(e,r,n,i){for(const[o,a]of n)if(Math.sqrt((e-o)**2+(r-a)**2)<=i)return!0;return!1}pointToLineDistance(e,r,n,i,o,a){const l=e-n,d=r-i,p=o-n,f=a-i,h=l*p+d*f,x=p*p+f*f;let m=-1;x!==0&&(m=h/x);let b,w;m<0?(b=n,w=i):m>1?(b=o,w=a):(b=n+m*p,w=i+m*f);const y=e-b,C=r-w;return Math.sqrt(y*y+C*C)}}class BH{constructor(e){Pe(this,"_paneViews");Pe(this,"_drawings",[]);Pe(this,"_positions",[]);Pe(this,"_options");Pe(this,"_param",null);this._options=e,this._paneViews=[new MH(e)]}attached(e){this._param=e,this.updateAllViews()}updateAllViews(){this._param&&(this._paneViews.forEach(e=>e.update(this._drawings,this._positions,this._param.chart,this._param.series)),this._param.requestUpdate())}paneViews(){return this._paneViews}addDrawing(e){this._drawings.push(e),this.updateAllViews()}removeDrawing(e){this._drawings=this._drawings.filter(r=>r.id!==e),this.updateAllViews()}addPosition(e){this._positions.push(e),this.updateAllViews()}removePosition(e){this._positions=this._positions.filter(r=>r.id!==e),this.updateAllViews()}getDrawings(){return[...this._drawings]}getPositions(){return[...this._positions]}clearAll(){this._drawings=[],this._positions=[],this.updateAllViews()}setSelectedDrawing(e){this._paneViews.forEach(r=>r.setSelectedDrawing(e)),this.updateAllViews()}setHoveredDrawing(e){this._paneViews.forEach(r=>r.setHoveredDrawing(e)),this.updateAllViews()}findDrawingAtPoint(e,r){return this._paneViews[0]?.findDrawingAtPoint(e,r)||null}findAnchorAtPoint(e,r,n){return this._paneViews[0]?.findAnchorAtPoint(e,r,n)||-1}updateDrawingPoint(e,r,n){const i=this._drawings.find(o=>o.id===e);i&&r>=0&&r<i.points.length&&(i.points[r]=n,this.updateAllViews())}moveDrawing(e,r,n){const i=this._drawings.find(o=>o.id===e);i&&(i.points=i.points.map(o=>({time:o.time+r,price:o.price+n})),this.updateAllViews())}}class FH extends _2{constructor(r={}){const n={visible:!0,interactive:!0,defaultLineColor:"#2196F3",defaultFillColor:"#2196F320",defaultTextColor:"#ffffff",defaultLineWidth:2,longColor:"#10b981",shortColor:"#ef4444",profitColor:"#10b981",lossColor:"#ef4444",snapToPrice:!0,snapToTime:!1,showMagnetMode:!0,...r};super({id:"trading-toolkit",name:"Trading Toolkit",description:"Complete TradingView-style drawing and analysis tools",category:wv.DRAWING,version:"1.0.0",author:"Fincept Terminal",enabled:!0},n);Pe(this,"toolkitPrimitive",null);Pe(this,"currentTool",null);Pe(this,"tempPoints",[]);Pe(this,"drawingIdCounter",0);Pe(this,"positionIdCounter",0);Pe(this,"onToolDeactivated");Pe(this,"selectedDrawingId",null);Pe(this,"isDragging",!1);Pe(this,"draggedAnchorIndex",-1);Pe(this,"dragStartPoint",null)}createPrimitive(){return this.toolkitPrimitive=new BH(this.options),this.toolkitPrimitive}activateTool(r){this.currentTool=r,this.tempPoints=[]}deactivateTool(){this.currentTool=null,this.tempPoints=[],this.onToolDeactivated&&this.onToolDeactivated()}getCurrentTool(){return this.currentTool}setOnToolDeactivated(r){this.onToolDeactivated=r}handleMouseDown(r,n,i){if(!this.toolkitPrimitive||this.currentTool)return!1;const o=this.toolkitPrimitive.findDrawingAtPoint(n,i);if(o){this.selectedDrawingId=o,this.toolkitPrimitive.setSelectedDrawing(o);const a=this.toolkitPrimitive.findAnchorAtPoint(o,n,i);return a>=0?(this.isDragging=!0,this.draggedAnchorIndex=a,this.dragStartPoint=r,!0):(this.isDragging=!0,this.draggedAnchorIndex=-1,this.dragStartPoint=r,!0)}else this.selectedDrawingId=null,this.toolkitPrimitive.setSelectedDrawing(null);return!1}handleMouseMove(r,n,i){if(this.toolkitPrimitive){if(this.isDragging&&this.dragStartPoint&&this.selectedDrawingId){const o=r.time-this.dragStartPoint.time,a=r.price-this.dragStartPoint.price;this.draggedAnchorIndex>=0?this.toolkitPrimitive.updateDrawingPoint(this.selectedDrawingId,this.draggedAnchorIndex,r):this.toolkitPrimitive.moveDrawing(this.selectedDrawingId,o,a),this.dragStartPoint=r;return}if(!this.currentTool&&!this.isDragging){const o=this.toolkitPrimitive.findDrawingAtPoint(n,i);this.toolkitPrimitive.setHoveredDrawing(o)}}}handleMouseUp(){this.isDragging=!1,this.draggedAnchorIndex=-1,this.dragStartPoint=null}selectDrawing(r){this.selectedDrawingId=r,this.toolkitPrimitive&&this.toolkitPrimitive.setSelectedDrawing(r)}getSelectedDrawingId(){return this.selectedDrawingId}handleClick(r){if(!this.currentTool||!this.toolkitPrimitive)return;this.tempPoints.push(r);const n=this.getRequiredPoints(this.currentTool);this.tempPoints.length>=n&&this.completeDrawing()}completeDrawing(){if(!this.currentTool||!this.toolkitPrimitive)return;const r={id:`drawing-${++this.drawingIdCounter}`,type:this.currentTool,points:[...this.tempPoints],style:{color:this.options.defaultLineColor||"#2196F3",lineWidth:this.options.defaultLineWidth||2,lineStyle:"solid",fillColor:this.options.defaultFillColor,fillOpacity:.2,textColor:this.options.defaultTextColor||"#FFFFFF",fontSize:14,showLabels:!0},visible:!0,locked:!1};if(this.currentTool==="text"||this.currentTool==="callout"){const n=prompt("Enter annotation text:");if(n)r.data={text:n};else{this.tempPoints=[];return}}this.toolkitPrimitive.addDrawing(r),this.tempPoints=[],this.deactivateTool(),this.chart&&this.chart.timeScale().scrollToPosition(0,!1)}getRequiredPoints(r){switch(r){case"horizontal":case"vertical":case"text":case"callout":return 1;case"trendline":case"ray":case"rectangle":case"ellipse":case"arrow":case"fibo_retracement":case"fibo_extension":case"long_position":case"short_position":return 2;case"channel":case"regression":case"triangle":case"pitchfork":return 3;default:return 2}}addLongPosition(r,n,i,o,a){return this.addPosition("long","entry",r,n,a)}addShortPosition(r,n,i,o,a){return this.addPosition("short","entry",r,n,a)}addPosition(r,n,i,o,a){if(!this.toolkitPrimitive)return"";const l=r==="long"?this.options.longColor||"#10b981":this.options.shortColor||"#ef4444",d={id:`position-${++this.positionIdCounter}`,type:r,orderType:n,time:i,price:o,color:l,...a};return this.toolkitPrimitive.addPosition(d),this.chart?.timeScale().fitContent(),d.id}getDrawings(){return this.toolkitPrimitive?.getDrawings()||[]}getPositions(){return this.toolkitPrimitive?.getPositions()||[]}removeDrawing(r){this.toolkitPrimitive&&(this.toolkitPrimitive.removeDrawing(r),this.chart?.timeScale().fitContent())}removePosition(r){this.toolkitPrimitive&&(this.toolkitPrimitive.removePosition(r),this.chart?.timeScale().fitContent())}clearAll(){this.toolkitPrimitive&&(this.toolkitPrimitive.clearAll(),this.chart?.timeScale().fitContent())}clearDrawings(){this.toolkitPrimitive&&this.getDrawings().forEach(r=>this.removeDrawing(r.id))}deleteLastDrawing(){const r=this.getDrawings();r.length>0&&this.removeDrawing(r[r.length-1].id)}clearPositions(){this.toolkitPrimitive&&this.getPositions().forEach(r=>this.removePosition(r.id))}}function $H({toolkit:s,onToolSelect:e,activeTool:r}){const[n,i]=S.useState(null),[o,a]=S.useState(!1),l=[{name:"Lines",icon:t.jsx(Nr,{size:16}),tools:[{id:Nn.TREND_LINE,name:"Trend Line",icon:t.jsx(Nr,{size:14}),shortcut:"T"},{id:Nn.HORIZONTAL_LINE,name:"Horizontal Line",icon:t.jsx(Op,{size:14}),shortcut:"H"},{id:Nn.VERTICAL_LINE,name:"Vertical Line",icon:t.jsx(Op,{size:14,style:{transform:"rotate(90deg)"}}),shortcut:"V"},{id:Nn.RAY,name:"Ray",icon:t.jsx(KE,{size:14})}]},{name:"Channels",icon:t.jsx(xf,{size:16,style:{transform:"rotate(90deg)"}}),tools:[{id:Nn.PARALLEL_CHANNEL,name:"Parallel Channel",icon:t.jsx(xf,{size:14,style:{transform:"rotate(90deg)"}})},{id:Nn.REGRESSION_CHANNEL,name:"Regression Channel",icon:t.jsx(xf,{size:14})},{id:Nn.PITCHFORK,name:"Andrew's Pitchfork",icon:t.jsx(xf,{size:14})}]},{name:"Shapes",icon:t.jsx(xc,{size:16}),tools:[{id:Nn.RECTANGLE,name:"Rectangle",icon:t.jsx(xc,{size:14}),shortcut:"R"},{id:Nn.ELLIPSE,name:"Ellipse",icon:t.jsx(cg,{size:14}),shortcut:"E"},{id:Nn.TRIANGLE,name:"Triangle",icon:t.jsx(d3,{size:14})}]},{name:"Fibonacci",icon:t.jsx(Kl,{size:16}),tools:[{id:Nn.FIBO_RETRACEMENT,name:"Fibonacci Retracement",icon:t.jsx(Kl,{size:14}),shortcut:"F"},{id:Nn.FIBO_EXTENSION,name:"Fibonacci Extension",icon:t.jsx(Kl,{size:14})},{id:Nn.FIBO_FAN,name:"Fibonacci Fan",icon:t.jsx(Kl,{size:14})},{id:Nn.FIBO_CIRCLE,name:"Fibonacci Circle",icon:t.jsx(cg,{size:14})}]},{name:"Positions",icon:t.jsx(ka,{size:16}),tools:[{id:Nn.LONG_POSITION,name:"Long Position",icon:t.jsx(LM,{size:14}),shortcut:"L"},{id:Nn.SHORT_POSITION,name:"Short Position",icon:t.jsx(OM,{size:14}),shortcut:"S"},{id:Nn.STOP_LOSS,name:"Stop Loss",icon:t.jsx(BT,{size:14})},{id:Nn.TAKE_PROFIT,name:"Take Profit",icon:t.jsx(wl,{size:14})}]},{name:"Annotations",icon:t.jsx(Sd,{size:16}),tools:[{id:Nn.TEXT,name:"Text",icon:t.jsx(Sd,{size:14}),shortcut:"A"},{id:Nn.ARROW,name:"Arrow",icon:t.jsx(KE,{size:14})},{id:Nn.CALLOUT,name:"Callout",icon:t.jsx(Sd,{size:14})}]},{name:"Measure",icon:t.jsx(Kl,{size:16}),tools:[{id:Nn.MEASURE,name:"Price & Date Range",icon:t.jsx(Kl,{size:14})},{id:Nn.ANGLE,name:"Angle",icon:t.jsx(Kl,{size:14})}]}],d=x=>{console.log("[ToolkitToolbar] Tool selected:",x,"hasToolkit:",!!s),s&&(console.log("[ToolkitToolbar] Activating tool in toolkit plugin"),s.activateTool(x)),console.log("[ToolkitToolbar] Calling onToolSelect callback"),e?.(x),i(null)},p=()=>{s&&confirm("Clear all drawings?")&&s.clearDrawings()},f=()=>{s&&s.deleteLastDrawing()},h=s?{drawings:s.getDrawings().length,positions:s.getPositions().length}:{drawings:0,positions:0};return t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"4px 12px",backgroundColor:"#000000",borderBottom:"1px solid #2A2A2A",fontSize:"10px",position:"relative",height:"28px"},children:[l.map(x=>t.jsxs("div",{style:{position:"relative"},children:[t.jsxs("button",{onClick:()=>i(n===x.name?null:x.name),title:x.name,style:{padding:"6px 8px",display:"flex",alignItems:"center",gap:"4px",border:"none",borderRadius:"3px",backgroundColor:n===x.name?"#FF8800":"#1A1A1A",color:"#ffffff",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:m=>{n!==x.name&&(m.currentTarget.style.backgroundColor="#2A2A2A")},onMouseLeave:m=>{n!==x.name&&(m.currentTarget.style.backgroundColor="#1A1A1A")},children:[x.icon,t.jsx("span",{style:{fontSize:"10px"},children:x.name})]}),n===x.name&&t.jsx("div",{style:{position:"absolute",top:"100%",left:0,marginTop:"4px",backgroundColor:"#0F0F0F",border:"1px solid #2A2A2A",borderRadius:"4px",padding:"4px",minWidth:"200px",zIndex:1e3,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.5)"},children:x.tools.map(m=>t.jsxs("button",{onClick:()=>d(m.id),style:{width:"100%",padding:"8px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",border:"none",borderRadius:"3px",backgroundColor:r===m.id?"#FF8800":"transparent",color:"#ffffff",cursor:"pointer",textAlign:"left",fontSize:"11px",transition:"all 0.15s"},onMouseEnter:b=>{r!==m.id&&(b.currentTarget.style.backgroundColor="#1A1A1A")},onMouseLeave:b=>{r!==m.id&&(b.currentTarget.style.backgroundColor="transparent")},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[m.icon,t.jsx("span",{children:m.name})]}),m.shortcut&&t.jsx("span",{style:{fontSize:"9px",color:"#6b7280",backgroundColor:"#0a0a0a",padding:"2px 6px",borderRadius:"2px"},children:m.shortcut})]},m.id))})]},x.name)),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#2a2a2a",margin:"0 4px"}}),t.jsx("button",{onClick:f,title:"Undo Last Drawing (Delete/Backspace)",disabled:h.drawings===0,style:{padding:"6px 8px",display:"flex",alignItems:"center",gap:"4px",border:"none",borderRadius:"3px",backgroundColor:h.drawings===0?"#0F0F0F":"#1A1A1A",color:h.drawings===0?"#4A4A4A":"#ffffff",cursor:h.drawings===0?"not-allowed":"pointer",transition:"all 0.2s",opacity:h.drawings===0?.5:1},onMouseEnter:x=>{h.drawings>0&&(x.currentTarget.style.backgroundColor="#2A2A2A")},onMouseLeave:x=>{h.drawings>0&&(x.currentTarget.style.backgroundColor="#1A1A1A")},children:t.jsx(f3,{size:14})}),t.jsx("button",{onClick:p,title:"Clear All Drawings",disabled:h.drawings===0,style:{padding:"6px 8px",display:"flex",alignItems:"center",gap:"4px",border:"none",borderRadius:"3px",backgroundColor:h.drawings===0?"#0F0F0F":"#1A1A1A",color:h.drawings===0?"#4A4A4A":"#ffffff",cursor:h.drawings===0?"not-allowed":"pointer",transition:"all 0.2s",opacity:h.drawings===0?.5:1},onMouseEnter:x=>{h.drawings>0&&(x.currentTarget.style.backgroundColor="#2A2A2A")},onMouseLeave:x=>{h.drawings>0&&(x.currentTarget.style.backgroundColor="#1A1A1A")},children:t.jsx(On,{size:14})}),t.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"12px",fontSize:"10px",color:"#787878"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Nr,{size:12}),t.jsxs("span",{children:[h.drawings," drawings"]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(ka,{size:12}),t.jsxs("span",{children:[h.positions," positions"]})]})]}),r&&t.jsxs("div",{style:{padding:"4px 10px",backgroundColor:"#FF8800",color:"#000000",borderRadius:"3px",fontSize:"10px",fontWeight:600,display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("span",{children:"Active:"}),t.jsx("span",{children:r.replace(/_/g," ").toUpperCase()}),t.jsx("button",{onClick:()=>{s?.deactivateTool(),e?.(null)},style:{background:"none",border:"none",color:"#000000",cursor:"pointer",padding:0,marginLeft:"4px",fontSize:"14px",fontWeight:700},children:""})]})]})}function D2({data:s,symbol:e="CHART",height:r=600,showVolume:n=!0,showToolbar:i=!0,showHeader:o=!0,onToolChange:a}){const l=S.useRef(null),d=S.useRef(null),p=S.useRef(null),f=S.useRef(null),h=S.useRef(null),x=S.useRef(null),m=S.useRef(null),[b,w]=S.useState(null),[y,C]=S.useState(!1),[T,E]=S.useState(null),[j,k]=S.useState("default");S.useEffect(()=>{if(!l.current)return;const P=cA(l.current,{width:l.current.clientWidth,height:r,layout:{background:{type:YI.Solid,color:"#0a0a0a"},textColor:"#d1d5db",fontSize:11},handleScroll:{vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0}},grid:{vertLines:{color:"#1f1f1f"},horzLines:{color:"#1f1f1f"}},crosshair:{mode:0,vertLine:{width:1,color:"#758696",style:0},horzLine:{width:1,color:"#758696",style:0}},rightPriceScale:{borderColor:"#2a2a2a",scaleMargins:{top:.1,bottom:n?.25:.1}},timeScale:{borderColor:"#2a2a2a",timeVisible:!0,secondsVisible:!1}});d.current=P;const I=P.addSeries(KI,{upColor:"#10b981",downColor:"#ef4444",borderUpColor:"#10b981",borderDownColor:"#ef4444",wickUpColor:"#10b981",wickDownColor:"#ef4444"});if(p.current=I,n){const D=P.addSeries(VI,{color:"#6b7280",priceFormat:{type:"volume"},priceScaleId:""});D.priceScale().applyOptions({scaleMargins:{top:.8,bottom:0}}),f.current=D}const O=new IH(P,I);h.current=O;const G=new zH({showOHLC:!0,showVolume:n});O.register(G);const B=new FH;O.register(B),x.current=B,B.setOnToolDeactivated(()=>{w(null),m.current=null,a?.(null)}),P.subscribeClick(D=>{R(D)}),P.subscribeCrosshairMove(D=>{A(D)});const F=D=>{if((D.key==="Delete"||D.key==="Backspace")&&x.current&&!b){D.preventDefault();const oe=x.current.getSelectedDrawingId();oe?x.current.getDrawings().find(Q=>Q.id===oe)&&(x.current.removeDrawing(oe),x.current.selectDrawing(null)):x.current.deleteLastDrawing()}D.key==="Escape"&&(D.preventDefault(),b?M(null):x.current&&x.current.selectDrawing(null))},z=()=>{x.current&&x.current.handleMouseUp()};window.addEventListener("keydown",F),window.addEventListener("mouseup",z);const $=()=>{l.current&&d.current&&d.current.resize(l.current.clientWidth,r,!0)};window.addEventListener("resize",$);const W=new ResizeObserver($);return l.current&&W.observe(l.current),C(!0),()=>{window.removeEventListener("resize",$),window.removeEventListener("keydown",F),window.removeEventListener("mouseup",z),W.disconnect(),O.destroy(),P.remove()}},[r,n]),S.useEffect(()=>{if(!y||!p.current||s.length===0)return;const P=s.map(I=>{let O=I.time;return O>1e10&&(O=Math.floor(O/1e3)),{time:O,open:I.open,high:I.high,low:I.low,close:I.close}});if(p.current.setData(P),n&&f.current){const I=s.map(O=>{let G=O.time;return G>1e10&&(G=Math.floor(G/1e3)),{time:G,value:O.volume,color:O.close>=O.open?"#10b98144":"#ef444444"}});f.current.setData(I)}d.current?.timeScale().fitContent()},[s,y,n]);const A=S.useCallback(P=>{if(!(!p.current||!x.current))if(P.time&&P.point){const I=p.current.coordinateToPrice(P.point.y);if(I!=null){E({time:P.time,price:I});const O={time:P.time,price:I};if(x.current.handleMouseMove(O,P.point.x,P.point.y),m.current)k("crosshair");else{const G=x.current.getDrawings().find(B=>B.id===x.current._hoveredDrawingId);k(G?"move":"default")}}}else E(null)},[]),R=S.useCallback(P=>{if(!x.current)return;let I=null,O=null,G=0,B=0;if(P.time&&P.point?(I=P.time,O=p.current?.coordinateToPrice(P.point.y)??null,G=P.point.x,B=P.point.y):P.point&&d.current&&p.current&&(I=d.current.timeScale().coordinateToTime(P.point.x),O=p.current.coordinateToPrice(P.point.y),G=P.point.x,B=P.point.y),I===null||O===null||O===void 0)return;const F={time:I,price:O};m.current&&x.current.getCurrentTool()?(x.current.handleClick(F),d.current&&d.current.timeScale().scrollToPosition(0,!1)):x.current.handleMouseDown(F,G,B)||x.current.handleMouseUp()},[]),M=S.useCallback(P=>{w(P),m.current=P,P&&x.current?x.current.activateTool(P):!P&&x.current&&x.current.deactivateTool(),a?.(P)},[a,b]);return S.useCallback((P,I,O)=>x.current?x.current.addLongPosition(P,I,void 0,void 0,{label:O}):"",[]),S.useCallback((P,I,O)=>x.current?x.current.addShortPosition(P,I,void 0,void 0,{label:O}):"",[]),t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",backgroundColor:"#0a0a0a",position:"relative"},children:[o&&t.jsxs("div",{style:{padding:"4px 12px",backgroundColor:"#000000",borderBottom:"1px solid #2A2A2A",display:"flex",alignItems:"center",justifyContent:"space-between",height:"28px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"#FF8800",fontFamily:"monospace",letterSpacing:"0.5px"},children:e}),s.length>0&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",fontSize:"10px",fontFamily:"monospace"},children:[t.jsx("span",{style:{color:"#787878"},children:"O"}),t.jsx("span",{style:{color:"#FFFFFF"},children:s[s.length-1].open.toFixed(2)}),t.jsx("span",{style:{color:"#787878"},children:"H"}),t.jsx("span",{style:{color:"#FFFFFF"},children:s[s.length-1].high.toFixed(2)}),t.jsx("span",{style:{color:"#787878"},children:"L"}),t.jsx("span",{style:{color:"#FFFFFF"},children:s[s.length-1].low.toFixed(2)}),t.jsx("span",{style:{color:"#787878"},children:"C"}),t.jsx("span",{style:{color:s[s.length-1].close>=s[s.length-1].open?"#00D66F":"#FF3B3B",fontWeight:600},children:s[s.length-1].close.toFixed(2)})]})]}),t.jsxs("div",{style:{fontSize:"9px",color:"#787878",fontFamily:"monospace"},children:[s.length," BARS"]})]}),i&&t.jsx($H,{toolkit:x.current,onToolSelect:M,activeTool:b}),t.jsxs("div",{style:{flex:1,position:"relative",minHeight:0,overflow:"hidden"},children:[t.jsx("div",{ref:l,style:{width:"100%",height:"100%",position:"relative",cursor:j}}),b&&t.jsxs("div",{style:{position:"absolute",bottom:"10px",left:"50%",transform:"translateX(-50%)",backgroundColor:"rgba(0, 0, 0, 0.95)",border:"1px solid #2A2A2A",borderRadius:"4px",padding:"6px 14px",fontSize:"10px",color:"#FFFFFF",zIndex:100,pointerEvents:"none",fontFamily:"monospace"},children:["Click on the chart to draw ",b.replace(/_/g," ")]})]})]})}const pe={ORANGE:"#FFA500",WHITE:"#FFFFFF",RED:"#ef4444",GREEN:"#10b981",YELLOW:"#fbbf24",GRAY:"#787878",BLUE:"#3b82f6",CYAN:"#06b6d4",DARK_BG:"#0a0a0a",PANEL_BG:"#1a1a1a",BORDER:"#333333",MAGENTA:"#FF00FF"},up=({name:s,latestValue:e,min:r,max:n,avg:i,values:o,priceData:a,color:l,category:d,onRecompute:p})=>{const[f,h]=S.useState(!1),[x,m]=S.useState(null),[b,w]=S.useState(null),y=O=>Math.abs(O)<.01?O.toFixed(6):Math.abs(O)<1?O.toFixed(4):Math.abs(O)<100?O.toFixed(2):O.toFixed(0),C=o.map((O,G)=>({index:G,value:O||null})),T=()=>{const O=s.toUpperCase();return O.includes("SMA_5")?{period:5}:O.includes("SMA_10")?{period:10}:O.includes("SMA_20")?{period:20}:O.includes("SMA_50")?{period:50}:O.includes("SMA_200")?{period:200}:O.includes("EMA_9")?{period:9}:O.includes("EMA_12")?{period:12}:O.includes("EMA_21")?{period:21}:O.includes("EMA_26")?{period:26}:O.includes("EMA_50")?{period:50}:O.includes("WMA")?{period:9}:O.includes("RSI")?{period:14}:O.includes("MACD")?{fast:12,slow:26,signal:9}:O.includes("STOCH")?{k_period:14,d_period:3}:O.includes("BB_")?{period:20,std:2}:O.includes("ATR")?{period:14}:O.includes("ADX")?{period:14}:O.includes("CCI")?{period:20}:O.includes("WILLIAMS")?{period:14}:O.includes("ROC")?{period:12}:O==="MFI"?{period:14}:O.includes("AROON")?{period:25}:O.includes("AWESOME")||O==="AO"?{fast:5,slow:34}:O==="TSI"?{long:25,short:13}:O==="UO"||O.includes("ULTIMATE")?{period1:7,period2:14,period3:28}:null},j=(()=>{const O=s.toUpperCase();return O.includes("RSI")?{upper:70,lower:30,label:"Overbought/Oversold"}:O.includes("STOCH")?{upper:80,lower:20,label:"Overbought/Oversold"}:O.includes("WILLIAMS")?{upper:-20,lower:-80,label:"Overbought/Oversold"}:O.includes("CCI")?{upper:100,lower:-100,label:"Overbought/Oversold"}:O==="TSI"?{upper:25,lower:-25,label:"Overbought/Oversold"}:O==="UO"||O.includes("ULTIMATE")?{upper:70,lower:30,label:"Overbought/Oversold"}:O==="MFI"?{upper:80,lower:20,label:"Overbought/Oversold"}:O.includes("ROC")?{upper:5,lower:-5,label:"Strength %"}:O.includes("ADX")&&!O.includes("POS")&&!O.includes("NEG")?{upper:25,lower:20,label:"Trend Strength"}:O.includes("AROON")?{upper:70,lower:30,label:"Trend Strength"}:O.includes("BB_PBAND")||O.includes("KC_PBAND")||O.includes("DC_PBAND")?{upper:.8,lower:.2,label:"Band Position"}:O.includes("CMF")?{upper:.1,lower:-.1,label:"Money Flow"}:{upper:0,lower:0,label:"Custom"}})(),k=x||j,A=T(),R=()=>{const O=s.toUpperCase(),G=o[o.length-2]||0;return O.includes("RSI")?e<=k.lower?{signal:"BUY",reason:`Oversold <${k.lower}`}:e>=k.upper?{signal:"SELL",reason:`Overbought >${k.upper}`}:{signal:"NEUTRAL",reason:`${k.lower}-${k.upper} range`}:O.includes("STOCH")&&!O.includes("RSI")?e<=k.lower?{signal:"BUY",reason:`Oversold <${k.lower}`}:e>=k.upper?{signal:"SELL",reason:`Overbought >${k.upper}`}:{signal:"NEUTRAL",reason:`${k.lower}-${k.upper} range`}:O.includes("WILLIAMS")?e<=-80?{signal:"BUY",reason:"Oversold"}:e>=-20?{signal:"SELL",reason:"Overbought"}:{signal:"NEUTRAL",reason:"-20 to -80"}:O==="AO"||O.includes("AWESOME")?G<0&&e>0?{signal:"BUY",reason:"Zero cross up"}:G>0&&e<0?{signal:"SELL",reason:"Zero cross down"}:{signal:"NEUTRAL",reason:"No crossover"}:O.includes("ROC")?e>5?{signal:"BUY",reason:"Strong >5%"}:e<-5?{signal:"SELL",reason:"Weak <-5%"}:{signal:"NEUTRAL",reason:"-5% to 5%"}:O==="TSI"?e<-25?{signal:"BUY",reason:"Oversold"}:e>25?{signal:"SELL",reason:"Overbought"}:{signal:"NEUTRAL",reason:"-25 to 25"}:O==="UO"||O.includes("ULTIMATE")?e<30?{signal:"BUY",reason:"Oversold <30"}:e>70?{signal:"SELL",reason:"Overbought >70"}:{signal:"NEUTRAL",reason:"30-70 range"}:O.includes("PPO")&&!O.includes("SIGNAL")&&!O.includes("HIST")?G<0&&e>0?{signal:"BUY",reason:"Zero cross up"}:G>0&&e<0?{signal:"SELL",reason:"Zero cross down"}:{signal:"NEUTRAL",reason:"No crossover"}:O.includes("MACD")&&!O.includes("SIGNAL")&&!O.includes("DIFF")?G<0&&e>0?{signal:"BUY",reason:"Bullish crossover"}:G>0&&e<0?{signal:"SELL",reason:"Bearish crossover"}:{signal:"NEUTRAL",reason:"No crossover"}:O.includes("CCI")?e<=-100?{signal:"BUY",reason:"Oversold <-100"}:e>=100?{signal:"SELL",reason:"Overbought >100"}:{signal:"NEUTRAL",reason:"-100 to 100"}:O.includes("ADX")&&!O.includes("POS")&&!O.includes("NEG")?e>25?{signal:"BUY",reason:"Strong trend >25"}:e<20?{signal:"NEUTRAL",reason:"Weak trend <20"}:{signal:"NEUTRAL",reason:"Moderate 20-25"}:O.includes("AROON_UP")?e>70?{signal:"BUY",reason:"Strong uptrend"}:{signal:"NEUTRAL",reason:"Weak uptrend"}:O.includes("AROON_DOWN")?e>70?{signal:"SELL",reason:"Strong downtrend"}:{signal:"NEUTRAL",reason:"Weak downtrend"}:O.includes("AROON_INDICATOR")?e>50?{signal:"BUY",reason:"Bullish"}:e<-50?{signal:"SELL",reason:"Bearish"}:{signal:"NEUTRAL",reason:"-50 to 50"}:O.includes("PSAR_UP_INDICATOR")?e===1?{signal:"BUY",reason:"Uptrend active"}:{signal:"NEUTRAL",reason:"No uptrend"}:O.includes("PSAR_DOWN_INDICATOR")?e===1?{signal:"SELL",reason:"Downtrend active"}:{signal:"NEUTRAL",reason:"No downtrend"}:O.includes("TRIX")?G<0&&e>0?{signal:"BUY",reason:"Zero cross up"}:G>0&&e<0?{signal:"SELL",reason:"Zero cross down"}:{signal:"NEUTRAL",reason:"No crossover"}:O.includes("KST")&&!O.includes("SIGNAL")?G<0&&e>0?{signal:"BUY",reason:"Zero cross up"}:G>0&&e<0?{signal:"SELL",reason:"Zero cross down"}:{signal:"NEUTRAL",reason:"No crossover"}:O.includes("VORTEX_POS")?e>1?{signal:"BUY",reason:"Positive >1"}:{signal:"NEUTRAL",reason:"Weak"}:O.includes("VORTEX_NEG")?e>1?{signal:"SELL",reason:"Negative >1"}:{signal:"NEUTRAL",reason:"Weak"}:O.includes("BB_PBAND")||O.includes("KC_PBAND")||O.includes("DC_PBAND")?e<.2?{signal:"BUY",reason:"Near lower band"}:e>.8?{signal:"SELL",reason:"Near upper band"}:{signal:"NEUTRAL",reason:"Middle band"}:O.includes("BB_HBAND_INDICATOR")?e===1?{signal:"SELL",reason:"Above upper BB"}:{signal:"NEUTRAL",reason:"Below upper BB"}:O.includes("BB_LBAND_INDICATOR")?e===1?{signal:"BUY",reason:"Below lower BB"}:{signal:"NEUTRAL",reason:"Above lower BB"}:O.includes("ATR")?e>i*1.5?{signal:"NEUTRAL",reason:"High volatility"}:e<i*.5?{signal:"NEUTRAL",reason:"Low volatility"}:{signal:"NEUTRAL",reason:"Normal volatility"}:O.includes("UI")||O.includes("ULCER")?e>i*1.5?{signal:"SELL",reason:"High risk"}:{signal:"NEUTRAL",reason:"Normal risk"}:O==="MFI"?e<=20?{signal:"BUY",reason:"Oversold <20"}:e>=80?{signal:"SELL",reason:"Overbought >80"}:{signal:"NEUTRAL",reason:"20-80 range"}:O.includes("CMF")?e>.1?{signal:"BUY",reason:"Positive flow"}:e<-.1?{signal:"SELL",reason:"Negative flow"}:{signal:"NEUTRAL",reason:"Neutral flow"}:O==="OBV"||O.includes("ADI")||O.includes("VPT")?e>G?{signal:"BUY",reason:"Volume rising"}:e<G?{signal:"SELL",reason:"Volume falling"}:{signal:"NEUTRAL",reason:"Volume stable"}:O.includes("EOM")?e>0?{signal:"BUY",reason:"Ease of movement +"}:e<0?{signal:"SELL",reason:"Ease of movement -"}:{signal:"NEUTRAL",reason:"No movement"}:O.includes("FI")&&!O.includes("MFI")?e>0?{signal:"BUY",reason:"Force positive"}:e<0?{signal:"SELL",reason:"Force negative"}:{signal:"NEUTRAL",reason:"No force"}:O.includes("RETURN")?e>2?{signal:"BUY",reason:"Positive return"}:e<-2?{signal:"SELL",reason:"Negative return"}:{signal:"NEUTRAL",reason:"Flat return"}:O.includes("SMA")||O.includes("EMA")||O.includes("WMA")?{signal:"NEUTRAL",reason:"Compare to price"}:{signal:"NEUTRAL",reason:"Monitor indicator"}},{signal:M,reason:P}=R(),I=M==="BUY"?pe.GREEN:M==="SELL"?pe.RED:pe.GRAY;return t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,borderLeft:`3px solid ${l}`,borderRadius:"6px",padding:"12px",display:"flex",flexDirection:"column",gap:"8px",minHeight:f?"480px":"320px",height:"auto",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3)",transition:"all 0.2s ease"},onMouseEnter:O=>{O.currentTarget.style.borderColor=l,O.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.5)"},onMouseLeave:O=>{O.currentTarget.style.borderColor=pe.BORDER,O.currentTarget.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.3)"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:l,fontSize:"10px",fontWeight:"bold",marginBottom:"2px"},children:d}),t.jsx("div",{style:{color:pe.WHITE,fontSize:"11px",fontWeight:"bold"},children:s.toUpperCase().replace(/_/g," ")})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:pe.WHITE,fontSize:"16px",fontWeight:"bold"},children:y(e)}),t.jsx("div",{style:{color:pe.GRAY,fontSize:"9px"},children:"Current"})]})]}),t.jsx("div",{style:{width:"100%",height:"80px",flex:"0 0 auto"},children:t.jsx(ml,{width:"100%",height:"100%",children:t.jsxs(tg,{data:C,margin:{top:5,right:5,left:5,bottom:5},children:[t.jsx(vd,{strokeDasharray:"3 3",stroke:pe.BORDER,opacity:.3}),t.jsx(bl,{dataKey:"index",hide:!0}),t.jsx(vl,{domain:["auto","auto"],hide:!0}),t.jsx(Sl,{contentStyle:{backgroundColor:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,borderRadius:"4px",fontSize:"10px"},formatter:O=>y(O)}),t.jsx(rg,{type:"monotone",dataKey:"value",stroke:l,strokeWidth:2,dot:!1,connectNulls:!0,isAnimationActive:!1})]})})}),t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",padding:"4px",backgroundColor:`${I}15`,border:`1px solid ${I}`,borderRadius:"4px"},children:[t.jsx("span",{style:{color:I,fontSize:"11px",fontWeight:"bold"},children:M}),t.jsx("span",{style:{color:pe.GRAY,fontSize:"9px"},children:P})]}),t.jsxs("div",{style:{flex:"0 0 auto"},children:[t.jsxs("button",{onClick:()=>h(!f),style:{fontSize:"9px",fontWeight:"500",textAlign:"center",padding:"4px 8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",width:"100%",userSelect:"none",backgroundColor:f?pe.DARK_BG:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,borderRadius:"3px",color:pe.GRAY,transition:"all 0.15s ease"},onMouseEnter:O=>{O.currentTarget.style.borderColor=pe.ORANGE,O.currentTarget.style.color=pe.ORANGE},onMouseLeave:O=>{O.currentTarget.style.borderColor=pe.BORDER,O.currentTarget.style.color=pe.GRAY},children:[t.jsx("span",{style:{fontSize:"10px"},children:""}),t.jsx("span",{children:f?"Hide":"Adjust"})]}),f&&t.jsxs("div",{style:{backgroundColor:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,borderRadius:"4px",padding:"10px",marginTop:"8px",fontSize:"10px"},children:[A&&t.jsxs("div",{style:{marginBottom:j.upper!==0?"12px":"0"},children:[t.jsxs("div",{style:{color:pe.CYAN,fontWeight:"bold",marginBottom:"8px",fontSize:"10px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("span",{children:""}),t.jsx("span",{children:"Indicator Parameters"})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"8px",marginBottom:"8px"},children:Object.keys(A).map(O=>t.jsxs("div",{children:[t.jsx("label",{style:{color:pe.GRAY,display:"block",marginBottom:"3px",fontSize:"9px",textTransform:"capitalize"},children:O.replace(/_/g," ")}),t.jsx("input",{type:"number",step:"1",value:b?.[O]??A[O],onChange:G=>w({...A,...b,[O]:parseInt(G.target.value)||1}),style:{width:"100%",backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,borderRadius:"3px",color:pe.WHITE,padding:"4px 6px",fontSize:"10px"}})]},O))}),b&&t.jsx("button",{onClick:()=>{p&&p({indicator:s,params:b})},style:{width:"100%",backgroundColor:pe.CYAN,border:"none",borderRadius:"3px",color:pe.DARK_BG,padding:"6px",fontSize:"10px",cursor:"pointer",fontWeight:"bold",marginBottom:"6px"},children:" Recompute with New Parameters"})]}),j.upper!==0&&t.jsxs("div",{children:[t.jsxs("div",{style:{color:pe.ORANGE,fontWeight:"bold",marginBottom:"8px",fontSize:"10px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("span",{children:""}),t.jsx("span",{children:j.label})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"8px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:pe.GRAY,display:"block",marginBottom:"3px",fontSize:"9px"},children:"Upper Threshold"}),t.jsx("input",{type:"number",step:"0.1",value:x?.upper??j.upper,onChange:O=>m({upper:parseFloat(O.target.value),lower:x?.lower??j.lower}),style:{width:"100%",backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,borderRadius:"3px",color:pe.WHITE,padding:"4px 6px",fontSize:"10px"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:pe.GRAY,display:"block",marginBottom:"3px",fontSize:"9px"},children:"Lower Threshold"}),t.jsx("input",{type:"number",step:"0.1",value:x?.lower??j.lower,onChange:O=>m({upper:x?.upper??j.upper,lower:parseFloat(O.target.value)}),style:{width:"100%",backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,borderRadius:"3px",color:pe.WHITE,padding:"4px 6px",fontSize:"10px"}})]})]})]}),t.jsx("button",{onClick:()=>{m(null),w(null)},style:{width:"100%",backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,borderRadius:"3px",color:pe.GRAY,padding:"5px",fontSize:"9px",cursor:"pointer",fontWeight:"600"},children:"Reset All to Defaults"})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px",fontSize:"9px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY},children:"MIN"}),t.jsx("div",{style:{color:pe.RED,fontWeight:"bold"},children:y(r)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY},children:"AVG"}),t.jsx("div",{style:{color:pe.YELLOW,fontWeight:"bold"},children:y(i)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY},children:"MAX"}),t.jsx("div",{style:{color:pe.GREEN,fontWeight:"bold"},children:y(n)})]})]}),t.jsxs("div",{style:{color:pe.GRAY,fontSize:"9px",textAlign:"center",borderTop:`1px solid ${pe.BORDER}`,paddingTop:"4px"},children:[o.length," data points"]})]})},GH=()=>{const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState(""),[l,d]=S.useState("AAPL"),[p,f]=S.useState(null),[h,x]=S.useState(null),[m,b]=S.useState([]),[w,y]=S.useState(null),[C,T]=S.useState(!1),[E,j]=S.useState("6M"),[k,A]=S.useState(new Date),[R,M]=S.useState("overview"),[P,I]=S.useState(12),[O,G]=S.useState(["Total Revenue","Gross Profit","Operating Income","Net Income","EBITDA","Basic EPS","Diluted EPS"]),[B,F]=S.useState(4),[z,$]=S.useState(["Total Revenue","Gross Profit"]),[W,D]=S.useState(["Net Income","Operating Income"]),[oe,Z]=S.useState(["EBITDA"]),[fe,Q]=S.useState(null),[_,Y]=S.useState(!1),[he,me]=S.useState(null),[ge,le]=S.useState(!1);S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null);const X=S.useRef(null),V=S.useRef(null),de=S.useRef(null),je=S.useRef(null),_e=S.useRef(null),Re=S.useRef(null),Be=S.useRef({});S.useEffect(()=>{const J=setInterval(()=>A(new Date),1e3);return()=>clearInterval(J)},[]);const Se=async(J,se=!1)=>{T(!0),console.log("Fetching data for:",J,"| Force refresh:",se);try{const Te=Be.current[J],Me=Date.now(),Qe=300*1e3;if(Te&&!se&&Me-Te.timestamp<Qe&&(console.log("Using cached data for",J),f(Te.stockInfo),x(Te.quoteData),y(Te.financials),Te.historicalData[E])){b(Te.historicalData[E]),T(!1);return}console.log("Fetching fresh data for",J);const ye=await lt("get_market_quote",{symbol:J});let ue=null;ye.success&&ye.data&&(x(ye.data),ue=ye.data);const re=await lt("get_stock_info",{symbol:J});let ke=null;re.success&&re.data&&(f(re.data),ke=re.data);const Ne=new Date,U=new Date;switch(E){case"1M":U.setMonth(Ne.getMonth()-1);break;case"3M":U.setMonth(Ne.getMonth()-3);break;case"6M":U.setMonth(Ne.getMonth()-6);break;case"1Y":U.setFullYear(Ne.getFullYear()-1);break;case"5Y":U.setFullYear(Ne.getFullYear()-5);break}const ne=await lt("get_historical_data",{symbol:J,startDate:U.toISOString().split("T")[0],endDate:Ne.toISOString().split("T")[0]});let xe=[];ne.success&&ne.data&&(b(ne.data),xe=ne.data);const Le=await lt("get_financials",{symbol:J});let ze=null;Le.success&&Le.data&&(y(Le.data),ze=Le.data),ke&&ue&&ze&&(Be.current[J]={stockInfo:ke,quoteData:ue,historicalData:{...Te?.historicalData||{},[E]:xe},financials:ze,timestamp:Me})}catch(Te){console.error("Error fetching stock data:",Te)}finally{T(!1)}},ie=async()=>{if(!l){console.log("No symbol selected for news fetch");return}le(!0),console.log("Fetching news for:",l);try{const J=p?.company_name||l,se=await lt("fetch_company_news",{query:J,maxResults:20,period:"7d",language:"en",country:"US"});if(console.log("News response:",se),typeof se=="string"){const Te=JSON.parse(se);me(Te)}else me(se)}catch(J){console.error("Error fetching news:",J),me({success:!1,error:String(J),data:[]})}finally{le(!1)}},ve=(J,se,Te)=>{if(!J||!w)return null;const Me=cA(J,{layout:{background:{color:pe.DARK_BG},textColor:pe.WHITE},grid:{vertLines:{color:pe.BORDER},horzLines:{color:pe.BORDER}},width:J.clientWidth,height:250,timeScale:{borderColor:pe.GRAY,timeVisible:!0},rightPriceScale:{borderColor:pe.GRAY}}),Qe=Object.keys(w.income_statement);return se.forEach((ye,ue)=>{const re=Te[ue%Te.length],ke=Me.addSeries(XI,{color:re,lineWidth:2,title:ye}),Ne=[];Qe.forEach(U=>{const ne=new Date(U).getTime()/1e3,xe=w.income_statement[U];if(xe[ye]!==void 0&&xe[ye]!==null){const Le=ye.includes("EPS")?xe[ye]:xe[ye]/1e9;Ne.push({time:ne,value:Le})}}),Ne.length>0&&ke.setData(Ne.sort((U,ne)=>U.time-ne.time))}),Me.timeScale().fitContent(),Me};S.useEffect(()=>{if(R==="financials"&&w){je.current&&(je.current.remove(),je.current=null),_e.current&&(_e.current.remove(),_e.current=null),Re.current&&(Re.current.remove(),Re.current=null);const J=[pe.GREEN,pe.CYAN,pe.ORANGE,pe.YELLOW,pe.MAGENTA,pe.BLUE];X.current&&z.length>0&&(je.current=ve(X.current,z,J)),V.current&&W.length>0&&(_e.current=ve(V.current,W,J)),de.current&&oe.length>0&&(Re.current=ve(de.current,oe,J));const se=()=>{X.current&&je.current&&je.current.applyOptions({width:X.current.clientWidth}),V.current&&_e.current&&_e.current.applyOptions({width:V.current.clientWidth}),de.current&&Re.current&&Re.current.applyOptions({width:de.current.clientWidth})};return window.addEventListener("resize",se),()=>{window.removeEventListener("resize",se),je.current&&je.current.remove(),_e.current&&_e.current.remove(),Re.current&&Re.current.remove()}}},[w,R,z,W,oe]);const Ae=async J=>{Y(!0);try{if(!J||!Array.isArray(J)||J.length===0){console.error("Invalid historical data for technicals computation"),Q(null);return}const se=JSON.stringify(J.map(Me=>({timestamp:Me.timestamp,open:Me.open,high:Me.high,low:Me.low,close:Me.close,volume:Me.volume})));console.log("Sending historical data for technicals computation:",J.length,"data points");const Te=await lt("compute_all_technicals",{historicalData:se});if(console.log("Technicals response:",Te),console.log("Response type:",typeof Te),console.log("Response keys:",Te?Object.keys(Te):"null"),typeof Te=="string")try{const Me=JSON.parse(Te);Me.success&&Me.data&&Array.isArray(Me.data)&&Me.data.length>0?Q(Me):(console.error("Error computing technicals:",Me.error||"Invalid data structure"),Q(null))}catch(Me){console.error("Error parsing technicals response:",Me),Q(null)}else Te&&Te.success&&Te.data&&Array.isArray(Te.data)&&Te.data.length>0?Q(Te):(console.error("Invalid technicals response structure"),Q(null))}catch(se){console.error("Error computing technicals:",se),Q(null)}finally{Y(!1)}};S.useEffect(()=>{Se(l)},[l,E]),S.useEffect(()=>{m.length>0&&Ae(m)},[m]),S.useEffect(()=>{R==="news"&&l&&ie()},[R,l]);const $e=()=>{o.trim()&&(d(o.trim().toUpperCase()),a(""))},qe=(J,se=2)=>J==null?"N/A":J.toLocaleString(void 0,{minimumFractionDigits:se,maximumFractionDigits:se}),Ie=J=>J==null?"N/A":J>=1e12?`$${(J/1e12).toFixed(2)}T`:J>=1e9?`$${(J/1e9).toFixed(2)}B`:J>=1e6?`$${(J/1e6).toFixed(2)}M`:`$${J.toFixed(2)}`,K=J=>J==null?"N/A":`${(J*100).toFixed(2)}%`,Ee=h?.price||p?.current_price||0,Oe=h?.change||0,q=h?.change_percent||0,ee=J=>J?J==="buy"||J==="strong_buy"?pe.GREEN:J==="sell"||J==="strong_sell"?pe.RED:pe.YELLOW:pe.GRAY,ce=J=>J?J.toUpperCase().replace("_"," "):"N/A",Ce=J=>new Date(J).getFullYear(),be=()=>{if(!w||Object.keys(w.income_statement).length===0)return[];const J=Object.keys(w.income_statement)[0];return Object.keys(w.income_statement[J])},We=J=>{G(se=>se.includes(J)?se.filter(Te=>Te!==J):[...se,J])};return t.jsxs("div",{style:{height:"100%",width:"100%",backgroundColor:pe.DARK_BG,color:pe.WHITE,fontFamily:"Consolas, monospace",display:"flex",flexDirection:"column",fontSize:"11px",overflow:"hidden"},children:[t.jsx("div",{style:{backgroundColor:pe.PANEL_BG,borderBottom:`1px solid ${pe.BORDER}`,padding:"6px 12px",flexShrink:0},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:pe.ORANGE,fontWeight:"bold",fontSize:"13px"},children:"EQUITY RESEARCH TERMINAL"}),t.jsx("span",{style:{color:pe.GRAY},children:"|"}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("input",{type:"text",value:o,onChange:J=>a(J.target.value),onKeyPress:J=>J.key==="Enter"&&$e(),placeholder:"Enter symbol...",style:{backgroundColor:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,color:pe.WHITE,padding:"3px 8px",fontSize:"11px",width:"120px",fontFamily:"Consolas, monospace"}}),t.jsx("button",{onClick:$e,style:{backgroundColor:pe.ORANGE,border:"none",color:pe.DARK_BG,padding:"3px 10px",fontSize:"10px",cursor:"pointer",fontWeight:"bold"},children:"SEARCH"})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"10px"},children:[t.jsx("span",{style:{color:pe.GRAY},children:k.toLocaleTimeString()}),t.jsx("span",{style:{color:pe.GRAY},children:"|"}),t.jsx("span",{style:{color:pe.CYAN,fontWeight:"bold"},children:l}),C&&t.jsx("span",{style:{color:pe.YELLOW},children:" LOADING..."}),!C&&t.jsx("span",{style:{color:pe.GREEN},children:" LIVE"})]})]})}),t.jsxs("div",{style:{flex:1,overflow:"auto",scrollbarColor:"rgba(120, 120, 120, 0.3) transparent",scrollbarWidth:"thin",minHeight:0,backgroundColor:pe.DARK_BG},className:"custom-scrollbar",children:[t.jsx("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px",margin:"8px"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"4px"},children:[t.jsx("span",{style:{color:pe.ORANGE,fontSize:"20px",fontWeight:"bold"},children:l}),t.jsx("span",{style:{color:pe.WHITE,fontSize:"14px"},children:p?.company_name||"Loading..."}),p?.sector&&t.jsx("span",{style:{color:pe.BLUE,fontSize:"10px",padding:"2px 6px",backgroundColor:"rgba(100,150,250,0.2)",border:`1px solid ${pe.BLUE}`},children:p.sector}),p?.recommendation_key&&t.jsx("span",{style:{color:ee(p.recommendation_key),fontSize:"10px",padding:"2px 6px",backgroundColor:`${ee(p.recommendation_key)}20`,border:`1px solid ${ee(p.recommendation_key)}`,fontWeight:"bold"},children:ce(p.recommendation_key)})]}),t.jsxs("div",{style:{fontSize:"10px",color:pe.GRAY},children:[p?.exchange||"N/A"," | ",p?.industry||"N/A"," | ",p?.country||"N/A"]})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold",color:pe.WHITE,marginBottom:"2px"},children:["$",qe(Ee)]}),t.jsxs("div",{style:{fontSize:"12px",color:Oe>=0?pe.GREEN:pe.RED},children:[Oe>=0?"":""," $",Math.abs(Oe).toFixed(2)," (",q.toFixed(2),"%)"]})]})]})}),t.jsx("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,margin:"0 8px 8px 8px",display:"flex",gap:"1px"},children:["overview","financials","analysis","technicals","news"].map(J=>t.jsx("button",{onClick:()=>M(J),style:{flex:1,backgroundColor:R===J?pe.ORANGE:pe.DARK_BG,border:"none",color:R===J?pe.DARK_BG:pe.WHITE,padding:"8px 16px",fontSize:"11px",cursor:"pointer",fontWeight:R===J?"bold":"normal",textTransform:"uppercase"},children:J},J))}),R==="overview"&&t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",padding:"8px",height:"100%",boxSizing:"border-box"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"6px",flex:"0 0 auto",minHeight:"400px"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.ORANGE,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"TODAY'S TRADING"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"OPEN:"}),t.jsxs("span",{style:{color:pe.CYAN},children:["$",qe(h?.open)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"HIGH:"}),t.jsxs("span",{style:{color:pe.GREEN},children:["$",qe(h?.high)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"LOW:"}),t.jsxs("span",{style:{color:pe.RED},children:["$",qe(h?.low)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"PREV CLOSE:"}),t.jsxs("span",{style:{color:pe.WHITE},children:["$",qe(h?.previous_close)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"VOLUME:"}),t.jsx("span",{style:{color:pe.YELLOW},children:qe(h?.volume||0,0)})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"VALUATION"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"MARKET CAP:"}),t.jsx("span",{style:{color:pe.CYAN},children:Ie(p?.market_cap)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"P/E RATIO:"}),t.jsx("span",{style:{color:pe.YELLOW},children:qe(p?.pe_ratio)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"FWD P/E:"}),t.jsx("span",{style:{color:pe.YELLOW},children:qe(p?.forward_pe)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"PEG RATIO:"}),t.jsx("span",{style:{color:pe.YELLOW},children:qe(p?.peg_ratio)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"P/B RATIO:"}),t.jsx("span",{style:{color:pe.CYAN},children:qe(p?.price_to_book)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"DIV YIELD:"}),t.jsx("span",{style:{color:pe.GREEN},children:K(p?.dividend_yield)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"BETA:"}),t.jsx("span",{style:{color:pe.WHITE},children:qe(p?.beta)})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"SHARE STATS"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"SHARES OUT:"}),t.jsx("span",{style:{color:pe.CYAN},children:Ie(p?.shares_outstanding)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"FLOAT:"}),t.jsx("span",{style:{color:pe.CYAN},children:Ie(p?.float_shares)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"INSIDERS:"}),t.jsx("span",{style:{color:pe.YELLOW},children:K(p?.held_percent_insiders)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"INSTITUTIONS:"}),t.jsx("span",{style:{color:pe.YELLOW},children:K(p?.held_percent_institutions)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"SHORT %:"}),t.jsx("span",{style:{color:pe.RED},children:K(p?.short_percent_of_float)})]})]})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px",gridColumn:"span 2",overflow:"hidden",minHeight:0},children:[t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"4px 6px",display:"flex",alignItems:"center",gap:"6px",flexShrink:0},children:[t.jsx("span",{style:{color:pe.GRAY,fontSize:"9px"},children:"PERIOD:"}),["1M","3M","6M","1Y","5Y"].map(J=>t.jsx("button",{onClick:()=>j(J),style:{backgroundColor:E===J?pe.ORANGE:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,color:E===J?pe.DARK_BG:pe.WHITE,padding:"3px 8px",fontSize:"8px",cursor:"pointer",fontWeight:E===J?"bold":"normal"},children:J},J))]}),t.jsx("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,overflow:"hidden",flex:1,display:"flex",flexDirection:"column",minHeight:0},children:m&&m.length>0?t.jsx(D2,{data:m.map(J=>({time:J.timestamp,open:J.open,high:J.high,low:J.low,close:J.close,volume:J.volume})),symbol:`${l} - ${E}`,height:400,showVolume:!0,showToolbar:!0,onToolChange:J=>{console.log("[EquityResearch] Active tool:",J)}}):t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:pe.GRAY,fontSize:"11px"},children:C?"Loading chart data...":"No chart data available"})})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.MAGENTA,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"ANALYST TARGETS"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"HIGH:"}),t.jsxs("span",{style:{color:pe.GREEN},children:["$",qe(p?.target_high_price)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"MEAN:"}),t.jsxs("span",{style:{color:pe.YELLOW},children:["$",qe(p?.target_mean_price)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"LOW:"}),t.jsxs("span",{style:{color:pe.RED},children:["$",qe(p?.target_low_price)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"ANALYSTS:"}),t.jsx("span",{style:{color:pe.CYAN},children:p?.number_of_analyst_opinions||"N/A"})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.YELLOW,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"52 WEEK RANGE"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"HIGH:"}),t.jsxs("span",{style:{color:pe.GREEN},children:["$",qe(p?.fifty_two_week_high)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"LOW:"}),t.jsxs("span",{style:{color:pe.RED},children:["$",qe(p?.fifty_two_week_low)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"AVG VOL:"}),t.jsx("span",{style:{color:pe.CYAN},children:qe(p?.average_volume,0)})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.GREEN,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"PROFITABILITY"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"GROSS MARGIN:"}),t.jsx("span",{style:{color:pe.GREEN},children:K(p?.gross_margins)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"OPER. MARGIN:"}),t.jsx("span",{style:{color:pe.GREEN},children:K(p?.operating_margins)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"PROFIT MARGIN:"}),t.jsx("span",{style:{color:pe.GREEN},children:K(p?.profit_margins)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"ROA:"}),t.jsx("span",{style:{color:pe.CYAN},children:K(p?.return_on_assets)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"ROE:"}),t.jsx("span",{style:{color:pe.CYAN},children:K(p?.return_on_equity)})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.BLUE,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"GROWTH RATES"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"REVENUE:"}),t.jsx("span",{style:{color:pe.GREEN},children:K(p?.revenue_growth)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"EARNINGS:"}),t.jsx("span",{style:{color:pe.GREEN},children:K(p?.earnings_growth)})]})]})]})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"6px",flex:"0 0 auto",minHeight:"120px"},children:[p?.description&&p.description!=="N/A"&&t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px",display:"flex",flexDirection:"column",minHeight:0},children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px",flexShrink:0},children:"COMPANY OVERVIEW"}),t.jsx("div",{style:{color:pe.WHITE,fontSize:"9px",lineHeight:"1.5",overflow:"auto",flex:1,minHeight:0},className:"custom-scrollbar",children:p.description})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[p&&t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.WHITE,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"COMPANY INFO"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"3px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"EMPLOYEES:"}),t.jsx("span",{style:{color:pe.CYAN},children:qe(p.employees,0)})]}),p.website&&p.website!=="N/A"&&t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"WEBSITE:"}),t.jsx("span",{style:{color:pe.BLUE,fontSize:"8px"},children:p.website.substring(0,25)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"CURRENCY:"}),t.jsx("span",{style:{color:pe.CYAN},children:p.currency||"N/A"})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"6px"},children:[t.jsx("div",{style:{color:pe.ORANGE,fontSize:"10px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"3px"},children:"FINANCIAL HEALTH"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"3px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"CASH:"}),t.jsx("span",{style:{color:pe.GREEN},children:Ie(p?.total_cash)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"DEBT:"}),t.jsx("span",{style:{color:pe.RED},children:Ie(p?.total_debt)})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:pe.GRAY},children:"FREE CF:"}),t.jsx("span",{style:{color:pe.CYAN},children:Ie(p?.free_cashflow)})]})]})]})]})]})]}),R==="financials"&&t.jsx("div",{style:{padding:"8px"},children:w?t.jsxs("div",{style:{padding:"0"},children:[t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"10px 12px",marginBottom:"8px",display:"flex",gap:"20px",alignItems:"center",flexWrap:"wrap"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:pe.GRAY,fontSize:`${P}px`},children:"FONT SIZE:"}),t.jsx("button",{onClick:()=>I(Math.max(10,P-1)),style:{backgroundColor:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,color:pe.WHITE,padding:"4px 8px",fontSize:`${P}px`,cursor:"pointer"},children:"-"}),t.jsxs("span",{style:{color:pe.ORANGE,fontSize:`${P}px`,fontWeight:"bold",minWidth:"30px",textAlign:"center"},children:[P,"px"]}),t.jsx("button",{onClick:()=>I(Math.min(20,P+1)),style:{backgroundColor:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,color:pe.WHITE,padding:"4px 8px",fontSize:`${P}px`,cursor:"pointer"},children:"+"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:pe.GRAY,fontSize:`${P}px`},children:"SHOW YEARS:"}),[2,3,4,5].map(J=>t.jsx("button",{onClick:()=>F(J),style:{backgroundColor:B===J?pe.ORANGE:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,color:B===J?pe.DARK_BG:pe.WHITE,padding:"4px 10px",fontSize:`${P-1}px`,cursor:"pointer",fontWeight:B===J?"bold":"normal"},children:J},J))]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:pe.GRAY,fontSize:`${P}px`},children:"SELECT METRICS:"}),t.jsx("button",{onClick:()=>{const J=be();G(O.length===J.length?[]:J)},style:{backgroundColor:pe.BLUE,border:"none",color:pe.WHITE,padding:"4px 10px",fontSize:`${P-1}px`,cursor:"pointer",fontWeight:"bold"},children:O.length===be().length?"DESELECT ALL":"SELECT ALL"})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:`${P+2}px`,fontWeight:"bold",marginBottom:"10px"},children:"SELECT METRICS TO COMPARE"}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:be().map(J=>t.jsx("button",{onClick:()=>We(J),style:{backgroundColor:O.includes(J)?pe.GREEN:pe.DARK_BG,border:`1px solid ${O.includes(J)?pe.GREEN:pe.BORDER}`,color:O.includes(J)?pe.DARK_BG:pe.WHITE,padding:"6px 12px",fontSize:`${P-1}px`,cursor:"pointer",fontWeight:O.includes(J)?"bold":"normal",borderRadius:"3px"},children:J},J))})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:pe.ORANGE,fontSize:`${P+3}px`,fontWeight:"bold",marginBottom:"12px"},children:"FINANCIAL TRENDS COMPARISON (in Billions $)"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px",marginBottom:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:`${P}px`,fontWeight:"bold",marginBottom:"6px"},children:"CHART 1 METRICS:"}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:be().slice(0,8).map(J=>t.jsx("button",{onClick:()=>{$(se=>se.includes(J)?se.filter(Te=>Te!==J):[...se,J])},style:{backgroundColor:z.includes(J)?pe.GREEN:pe.DARK_BG,border:`1px solid ${z.includes(J)?pe.GREEN:pe.BORDER}`,color:z.includes(J)?pe.DARK_BG:pe.WHITE,padding:"3px 6px",fontSize:`${P-3}px`,cursor:"pointer",fontWeight:z.includes(J)?"bold":"normal"},children:J.substring(0,15)},J))})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:`${P}px`,fontWeight:"bold",marginBottom:"6px"},children:"CHART 2 METRICS:"}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:be().slice(0,8).map(J=>t.jsx("button",{onClick:()=>{D(se=>se.includes(J)?se.filter(Te=>Te!==J):[...se,J])},style:{backgroundColor:W.includes(J)?pe.ORANGE:pe.DARK_BG,border:`1px solid ${W.includes(J)?pe.ORANGE:pe.BORDER}`,color:W.includes(J)?pe.DARK_BG:pe.WHITE,padding:"3px 6px",fontSize:`${P-3}px`,cursor:"pointer",fontWeight:W.includes(J)?"bold":"normal"},children:J.substring(0,15)},J))})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:`${P}px`,fontWeight:"bold",marginBottom:"6px"},children:"CHART 3 METRICS:"}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:be().slice(0,8).map(J=>t.jsx("button",{onClick:()=>{Z(se=>se.includes(J)?se.filter(Te=>Te!==J):[...se,J])},style:{backgroundColor:oe.includes(J)?pe.MAGENTA:pe.DARK_BG,border:`1px solid ${oe.includes(J)?pe.MAGENTA:pe.BORDER}`,color:oe.includes(J)?pe.DARK_BG:pe.WHITE,padding:"3px 6px",fontSize:`${P-3}px`,cursor:"pointer",fontWeight:oe.includes(J)?"bold":"normal"},children:J.substring(0,15)},J))})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GREEN,fontSize:`${P}px`,fontWeight:"bold",marginBottom:"6px",textAlign:"center"},children:z.join(", ")||"Select metrics"}),t.jsx("div",{ref:X,style:{backgroundColor:pe.DARK_BG}})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.ORANGE,fontSize:`${P}px`,fontWeight:"bold",marginBottom:"6px",textAlign:"center"},children:W.join(", ")||"Select metrics"}),t.jsx("div",{ref:V,style:{backgroundColor:pe.DARK_BG}})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.MAGENTA,fontSize:`${P}px`,fontWeight:"bold",marginBottom:"6px",textAlign:"center"},children:oe.join(", ")||"Select metrics"}),t.jsx("div",{ref:de,style:{backgroundColor:pe.DARK_BG}})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:pe.CYAN,fontSize:`${P+3}px`,fontWeight:"bold",marginBottom:"12px"},children:["YEAR-OVER-YEAR COMPARISON (",O.length," Metrics)"]}),O.length===0?t.jsx("div",{style:{color:pe.YELLOW,fontSize:`${P+1}px`,textAlign:"center",padding:"20px"},children:"Please select at least one metric to compare"}):t.jsx("div",{style:{overflowX:"auto"},className:"custom-scrollbar",children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:`${P}px`},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{borderBottom:`2px solid ${pe.BORDER}`},children:[t.jsx("th",{style:{textAlign:"left",padding:"10px",color:pe.GRAY,fontSize:`${P+1}px`},children:"METRIC"}),Object.keys(w.income_statement).slice(0,B).map(J=>t.jsx("th",{style:{textAlign:"right",padding:"10px",color:pe.ORANGE,fontSize:`${P+1}px`},children:Ce(J)},J))]})}),t.jsx("tbody",{children:O.map((J,se)=>{const Te=Object.keys(w.income_statement).slice(0,B);return t.jsxs("tr",{style:{borderBottom:`1px solid ${pe.BORDER}20`},children:[t.jsx("td",{style:{padding:"10px",color:pe.WHITE,fontWeight:"bold",fontSize:`${P}px`},children:J}),Te.map(Me=>{const Qe=w.income_statement[Me][J];return t.jsx("td",{style:{textAlign:"right",padding:"10px",color:pe.CYAN,fontSize:`${P}px`},children:Qe?J.includes("EPS")?`$${qe(Qe)}`:Ie(Qe):"N/A"},Me)})]},J)})})]})})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"},children:[t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"8px"},children:[t.jsx("div",{style:{color:pe.GREEN,fontSize:`${P+2}px`,fontWeight:"bold",marginBottom:"8px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"4px"},children:"INCOME STATEMENT (Latest)"}),t.jsx("div",{style:{fontSize:`${P}px`,maxHeight:"500px",overflow:"auto"},className:"custom-scrollbar",children:Object.keys(w.income_statement).length>0?t.jsx(t.Fragment,{children:Object.entries(Object.values(w.income_statement)[0]||{}).map(([J,se],Te)=>{const Me=Object.keys(w.income_statement)[0],Qe=w.income_statement[Me][J];return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px",paddingBottom:"6px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[t.jsxs("span",{style:{color:pe.GRAY,fontSize:`${P-1}px`,maxWidth:"60%"},children:[J,":"]}),t.jsx("span",{style:{color:pe.CYAN,fontSize:`${P}px`},children:Ie(Qe)})]},Te)})}):t.jsx("div",{style:{color:pe.GRAY,textAlign:"center",padding:"20px",fontSize:`${P}px`},children:"No data available"})})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"8px"},children:[t.jsx("div",{style:{color:pe.YELLOW,fontSize:`${P+2}px`,fontWeight:"bold",marginBottom:"8px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"4px"},children:"BALANCE SHEET (Latest)"}),t.jsx("div",{style:{fontSize:`${P}px`,maxHeight:"500px",overflow:"auto"},className:"custom-scrollbar",children:Object.keys(w.balance_sheet).length>0?t.jsx(t.Fragment,{children:Object.entries(Object.values(w.balance_sheet)[0]||{}).map(([J,se],Te)=>{const Me=Object.keys(w.balance_sheet)[0],Qe=w.balance_sheet[Me][J];return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px",paddingBottom:"6px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[t.jsxs("span",{style:{color:pe.GRAY,fontSize:`${P-1}px`,maxWidth:"60%"},children:[J,":"]}),t.jsx("span",{style:{color:pe.CYAN,fontSize:`${P}px`},children:Ie(Qe)})]},Te)})}):t.jsx("div",{style:{color:pe.GRAY,textAlign:"center",padding:"20px",fontSize:`${P}px`},children:"No data available"})})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"8px"},children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:`${P+2}px`,fontWeight:"bold",marginBottom:"8px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"4px"},children:"CASH FLOW STATEMENT (Latest)"}),t.jsx("div",{style:{fontSize:`${P}px`,maxHeight:"500px",overflow:"auto"},className:"custom-scrollbar",children:Object.keys(w.cash_flow).length>0?t.jsx(t.Fragment,{children:Object.entries(Object.values(w.cash_flow)[0]||{}).map(([J,se],Te)=>{const Me=Object.keys(w.cash_flow)[0],Qe=w.cash_flow[Me][J];return t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px",paddingBottom:"6px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:[t.jsxs("span",{style:{color:pe.GRAY,fontSize:`${P-1}px`,maxWidth:"60%"},children:[J,":"]}),t.jsx("span",{style:{color:pe.CYAN,fontSize:`${P}px`},children:Ie(Qe)})]},Te)})}):t.jsx("div",{style:{color:pe.GRAY,textAlign:"center",padding:"20px",fontSize:`${P}px`},children:"No data available"})})]})]})]}):t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"400px",gap:"16px"},children:[t.jsx("div",{style:{color:pe.YELLOW,fontSize:"14px",fontWeight:"bold"},children:C?" LOADING FINANCIAL DATA...":" NO FINANCIAL DATA AVAILABLE"}),t.jsx("div",{style:{color:pe.GRAY,fontSize:"11px"},children:C?"Please wait while we fetch the data":"Financial statements are not available for this symbol"})]})}),R==="analysis"&&t.jsx("div",{style:{padding:"0 8px 8px 8px"},children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px"},children:[t.jsx("div",{style:{color:pe.ORANGE,fontSize:"13px",fontWeight:"bold",marginBottom:"12px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"6px"},children:"FINANCIAL HEALTH"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",fontSize:"11px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"TOTAL CASH"}),t.jsx("div",{style:{color:pe.GREEN,fontSize:"16px",fontWeight:"bold"},children:Ie(p?.total_cash)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"TOTAL DEBT"}),t.jsx("div",{style:{color:pe.RED,fontSize:"16px",fontWeight:"bold"},children:Ie(p?.total_debt)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"FREE CASHFLOW"}),t.jsx("div",{style:{color:pe.CYAN,fontSize:"16px",fontWeight:"bold"},children:Ie(p?.free_cashflow)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"OPERATING CASHFLOW"}),t.jsx("div",{style:{color:pe.BLUE,fontSize:"16px",fontWeight:"bold"},children:Ie(p?.operating_cashflow)})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px"},children:[t.jsx("div",{style:{color:pe.CYAN,fontSize:"13px",fontWeight:"bold",marginBottom:"12px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"6px"},children:"ENTERPRISE VALUE METRICS"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",fontSize:"11px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"ENTERPRISE VALUE"}),t.jsx("div",{style:{color:pe.YELLOW,fontSize:"16px",fontWeight:"bold"},children:Ie(p?.enterprise_value)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"EV/REVENUE"}),t.jsx("div",{style:{color:pe.CYAN,fontSize:"16px",fontWeight:"bold"},children:qe(p?.enterprise_to_revenue)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"EV/EBITDA"}),t.jsx("div",{style:{color:pe.CYAN,fontSize:"16px",fontWeight:"bold"},children:qe(p?.enterprise_to_ebitda)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"BOOK VALUE"}),t.jsxs("div",{style:{color:pe.WHITE,fontSize:"16px",fontWeight:"bold"},children:["$",qe(p?.book_value)]})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px"},children:[t.jsx("div",{style:{color:pe.GREEN,fontSize:"13px",fontWeight:"bold",marginBottom:"12px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"6px"},children:"REVENUE & PROFITS"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",fontSize:"11px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"TOTAL REVENUE"}),t.jsx("div",{style:{color:pe.GREEN,fontSize:"16px",fontWeight:"bold"},children:Ie(p?.total_revenue)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"REVENUE PER SHARE"}),t.jsxs("div",{style:{color:pe.CYAN,fontSize:"16px",fontWeight:"bold"},children:["$",qe(p?.revenue_per_share)]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"GROSS PROFITS"}),t.jsx("div",{style:{color:pe.GREEN,fontSize:"16px",fontWeight:"bold"},children:Ie(p?.gross_profits)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",marginBottom:"4px"},children:"EBITDA MARGINS"}),t.jsx("div",{style:{color:pe.YELLOW,fontSize:"16px",fontWeight:"bold"},children:K(p?.ebitda_margins)})]})]})]}),t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px"},children:[t.jsx("div",{style:{color:pe.YELLOW,fontSize:"13px",fontWeight:"bold",marginBottom:"12px",borderBottom:`1px solid ${pe.BORDER}`,paddingBottom:"6px"},children:"KEY RATIOS SUMMARY"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"10px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"9px",marginBottom:"3px"},children:"P/E RATIO"}),t.jsx("div",{style:{color:pe.WHITE,fontSize:"14px",fontWeight:"bold"},children:qe(p?.pe_ratio)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"9px",marginBottom:"3px"},children:"PEG RATIO"}),t.jsx("div",{style:{color:pe.WHITE,fontSize:"14px",fontWeight:"bold"},children:qe(p?.peg_ratio)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"9px",marginBottom:"3px"},children:"ROE"}),t.jsx("div",{style:{color:pe.GREEN,fontSize:"14px",fontWeight:"bold"},children:K(p?.return_on_equity)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"9px",marginBottom:"3px"},children:"ROA"}),t.jsx("div",{style:{color:pe.GREEN,fontSize:"14px",fontWeight:"bold"},children:K(p?.return_on_assets)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"9px",marginBottom:"3px"},children:"BETA"}),t.jsx("div",{style:{color:pe.CYAN,fontSize:"14px",fontWeight:"bold"},children:qe(p?.beta)})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pe.GRAY,fontSize:"9px",marginBottom:"3px"},children:"SHORT RATIO"}),t.jsx("div",{style:{color:pe.RED,fontSize:"14px",fontWeight:"bold"},children:qe(p?.short_ratio)})]})]})]})]})}),R==="news"&&t.jsx("div",{style:{padding:"8px",height:"calc(100vh - 280px)",overflow:"hidden",display:"flex",flexDirection:"column"},children:ge?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"400px",gap:"16px"},children:[t.jsx("div",{style:{color:pe.YELLOW,fontSize:"14px",fontWeight:"bold"},children:" FETCHING LATEST NEWS..."}),t.jsxs("div",{style:{color:pe.GRAY,fontSize:"11px"},children:["Loading news for ",l]})]}):!he||!he.success?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"400px",gap:"16px"},children:[t.jsx("div",{style:{color:pe.RED,fontSize:"14px",fontWeight:"bold"},children:" NO NEWS AVAILABLE"}),t.jsx("div",{style:{color:pe.GRAY,fontSize:"11px"},children:he?.error||"Unable to fetch news at this time"}),t.jsx("button",{onClick:ie,style:{backgroundColor:pe.ORANGE,border:"none",color:pe.DARK_BG,padding:"8px 16px",fontSize:"10px",cursor:"pointer",fontWeight:"bold",marginTop:"8px"},children:"RETRY"})]}):he.data&&he.data.length===0?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"400px",gap:"16px"},children:[t.jsx("div",{style:{color:pe.YELLOW,fontSize:"14px",fontWeight:"bold"},children:" NO NEWS FOUND"}),t.jsxs("div",{style:{color:pe.GRAY,fontSize:"11px"},children:["No recent news articles found for ",p?.company_name||l]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"8px 12px",marginBottom:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:pe.ORANGE,fontSize:"11px",fontWeight:"bold"},children:" LATEST NEWS"}),t.jsxs("span",{style:{color:pe.GRAY,fontSize:"9px"},children:[he.count||0," articles found"]}),t.jsx("span",{style:{color:pe.CYAN,fontSize:"9px"},children:p?.company_name||l})]}),t.jsx("button",{onClick:ie,style:{backgroundColor:pe.DARK_BG,border:`1px solid ${pe.BORDER}`,color:pe.WHITE,padding:"4px 12px",fontSize:"9px",cursor:"pointer",fontWeight:"bold"},children:" REFRESH"})]}),t.jsx("div",{style:{flex:1,overflow:"auto",display:"flex",flexDirection:"column",gap:"8px"},className:"custom-scrollbar",children:he.data.map((J,se)=>t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"12px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:Te=>{Te.currentTarget.style.backgroundColor="#252525",Te.currentTarget.style.borderColor=pe.ORANGE},onMouseLeave:Te=>{Te.currentTarget.style.backgroundColor=pe.PANEL_BG,Te.currentTarget.style.borderColor=pe.BORDER},onClick:()=>{J.url&&J.url!=="#"&&window.open(J.url,"_blank")},children:[t.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:t.jsxs("div",{style:{flex:1,marginRight:"12px"},children:[t.jsx("h3",{style:{color:pe.WHITE,fontSize:"12px",fontWeight:"bold",margin:0,marginBottom:"6px",lineHeight:"1.4"},children:J.title}),t.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[t.jsx("span",{style:{color:pe.CYAN,fontSize:"9px",fontWeight:"bold"},children:J.publisher||"Unknown Source"}),t.jsx("span",{style:{color:pe.GRAY,fontSize:"9px"},children:J.published_date||"Unknown Date"})]})]})}),J.description&&J.description!=="N/A"&&t.jsx("div",{style:{color:pe.GRAY,fontSize:"10px",lineHeight:"1.5",marginBottom:"8px"},children:J.description}),J.url&&J.url!=="#"&&t.jsx("div",{style:{color:pe.ORANGE,fontSize:"9px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:"READ FULL ARTICLE "})]},se))})]})}),R==="technicals"&&t.jsx("div",{style:{padding:"8px"},children:_?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"400px",gap:"16px"},children:[t.jsx("div",{style:{color:pe.YELLOW,fontSize:"14px",fontWeight:"bold"},children:" COMPUTING TECHNICAL INDICATORS..."}),t.jsxs("div",{style:{color:pe.GRAY,fontSize:"11px"},children:["Analyzing ",m.length," data points"]})]}):fe?t.jsx("div",{style:{padding:"8px",overflow:"auto",height:"calc(100vh - 280px)"},className:"custom-scrollbar",children:!fe.indicator_columns||!fe.data||!Array.isArray(fe.data)||fe.data.length===0?t.jsxs("div",{style:{backgroundColor:pe.PANEL_BG,border:`1px solid ${pe.BORDER}`,padding:"16px",textAlign:"center",color:pe.YELLOW},children:[t.jsx("div",{style:{fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:" NO INDICATOR DATA"}),t.jsx("div",{style:{fontSize:"11px",color:pe.GRAY},children:"Technical indicators could not be computed. Please try again or select a different symbol."})]}):t.jsx(t.Fragment,{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(420px, 1fr))",gap:"16px"},children:[fe.indicator_columns?.trend&&Array.isArray(fe.indicator_columns.trend)&&fe.indicator_columns.trend.map(J=>{const se=fe.data.map(ue=>ue[J]).filter(ue=>ue!=null);if(se.length===0)return null;const Te=se[se.length-1],Me=Math.min(...se),Qe=Math.max(...se),ye=se.reduce((ue,re)=>ue+re,0)/se.length;return t.jsx(up,{name:J,latestValue:Te,min:Me,max:Qe,avg:ye,values:se,priceData:m,color:pe.CYAN,category:"TREND"},J)}),fe.indicator_columns?.momentum&&Array.isArray(fe.indicator_columns.momentum)&&fe.indicator_columns.momentum.map(J=>{const se=fe.data.map(ue=>ue[J]).filter(ue=>ue!=null);if(se.length===0)return null;const Te=se[se.length-1],Me=Math.min(...se),Qe=Math.max(...se),ye=se.reduce((ue,re)=>ue+re,0)/se.length;return t.jsx(up,{name:J,latestValue:Te,min:Me,max:Qe,avg:ye,values:se,priceData:m,color:pe.GREEN,category:"MOMENTUM"},J)}),fe.indicator_columns?.volatility&&Array.isArray(fe.indicator_columns.volatility)&&fe.indicator_columns.volatility.map(J=>{const se=fe.data.map(ue=>ue[J]).filter(ue=>ue!=null);if(se.length===0)return null;const Te=se[se.length-1],Me=Math.min(...se),Qe=Math.max(...se),ye=se.reduce((ue,re)=>ue+re,0)/se.length;return t.jsx(up,{name:J,latestValue:Te,min:Me,max:Qe,avg:ye,values:se,priceData:m,color:pe.YELLOW,category:"VOLATILITY"},J)}),fe.indicator_columns?.volume&&Array.isArray(fe.indicator_columns.volume)&&fe.indicator_columns.volume.map(J=>{const se=fe.data.map(ue=>ue[J]).filter(ue=>ue!=null);if(se.length===0)return null;const Te=se[se.length-1],Me=Math.min(...se),Qe=Math.max(...se),ye=se.reduce((ue,re)=>ue+re,0)/se.length;return t.jsx(up,{name:J,latestValue:Te,min:Me,max:Qe,avg:ye,values:se,priceData:m,color:pe.BLUE,category:"VOLUME"},J)}),fe.indicator_columns?.others&&Array.isArray(fe.indicator_columns.others)&&fe.indicator_columns.others.map(J=>{const se=fe.data.map(ue=>ue[J]).filter(ue=>ue!=null);if(se.length===0)return null;const Te=se[se.length-1],Me=Math.min(...se),Qe=Math.max(...se),ye=se.reduce((ue,re)=>ue+re,0)/se.length;return t.jsx(up,{name:J,latestValue:Te,min:Me,max:Qe,avg:ye,values:se,priceData:m,color:pe.MAGENTA,category:"RETURN"},J)})]})})}):t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"400px",gap:"16px"},children:[t.jsx("div",{style:{color:pe.RED,fontSize:"14px",fontWeight:"bold"},children:" NO TECHNICAL DATA AVAILABLE"}),t.jsx("div",{style:{color:pe.GRAY,fontSize:"11px"},children:"Please wait for historical data to load"})]})})]}),t.jsx("div",{style:{borderTop:`1px solid ${pe.BORDER}`,backgroundColor:pe.PANEL_BG,padding:"4px 12px",fontSize:"10px",color:pe.GRAY,flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsx("span",{children:"Equity Research Terminal v1.0 | Real-time data analysis and company fundamentals"}),t.jsx("span",{children:"Data Source: YFinance"})]}),t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsx("span",{style:{color:pe.CYAN,fontWeight:"bold"},children:l}),p?.exchange&&t.jsx("span",{children:p.exchange}),Ee>0&&t.jsxs(t.Fragment,{children:[t.jsxs("span",{children:["Price: $",Ee.toFixed(2)]}),Oe!==0&&t.jsxs("span",{style:{color:Oe>=0?pe.GREEN:pe.RED},children:[Oe>=0?"":""," ",Math.abs(q).toFixed(2),"%"]})]}),t.jsx("span",{style:{color:C?pe.YELLOW:pe.GREEN},children:C?"LOADING...":"READY"})]})]})}),t.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 4px;
          height: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: rgba(120, 120, 120, 0.3);
          border-radius: 2px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: rgba(120, 120, 120, 0.6);
        }
        .custom-scrollbar::-webkit-scrollbar-corner {
          background: transparent;
        }
      `})]})},UH=[{id:"GDP",name:"Gross Domestic Product",cat:"Economic"},{id:"UNRATE",name:"Unemployment Rate",cat:"Labor"},{id:"CPIAUCSL",name:"Consumer Price Index",cat:"Inflation"},{id:"FEDFUNDS",name:"Federal Funds Rate",cat:"Interest Rates"},{id:"DGS10",name:"10-Year Treasury Rate",cat:"Bonds"},{id:"DEXUSEU",name:"USD/EUR Exchange Rate",cat:"Forex"},{id:"DCOILWTICO",name:"WTI Crude Oil Price",cat:"Commodities"},{id:"GOLDAMGBD228NLBM",name:"Gold Price",cat:"Commodities"}],WH=[{id:32991,name:" Money, Banking, & Finance",desc:"Money supply, interest rates, banking data"},{id:10,name:" Population, Employment, Labor",desc:"Employment, unemployment, labor statistics"},{id:32455,name:" Prices",desc:"Inflation, CPI, PPI, commodity prices"},{id:1,name:" Production & Business",desc:"Industrial production, capacity utilization"},{id:32263,name:" International Data",desc:"Trade, exchange rates, foreign markets"},{id:33060,name:" U.S. Regional Data",desc:"State and metro area statistics"}];function qH(){const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState("GDP"),[l,d]=S.useState("2000-01-01"),[p,f]=S.useState(new Date().toISOString().split("T")[0]),[h,x]=S.useState([]),[m,b]=S.useState(!1),[w,y]=S.useState(""),[C,T]=S.useState(null),[E,j]=S.useState("line"),[k,A]=S.useState(!1),[R,M]=S.useState(!1),[P,I]=S.useState(""),[O,G]=S.useState([]),[B,F]=S.useState(!1),[z,$]=S.useState([]),[W,D]=S.useState(0),[oe,Z]=S.useState([{id:0,name:"All Categories"}]),[fe,Q]=S.useState(!1),[_,Y]=S.useState([]),[he,me]=S.useState(!1),[ge,le]=S.useState(!1);S.useEffect(()=>{X(),(async()=>await Je.getApiKey("FRED")&&ie())()},[]);const X=async()=>{try{const K=await Je.getApiKey("FRED");console.log("[ScreenerTab] FRED API key check:",K?`Found (length: ${K.length})`:"Not found"),A(!!K);const Ee=await Je.getAllApiKeys();console.log("[ScreenerTab] All configured API keys:",Object.keys(Ee))}catch(K){console.error("[ScreenerTab] Failed to check FRED API key:",K),A(!1)}},V=async K=>{if(!K.trim()){G([]);return}F(!0);try{const Ee=await Je.getApiKey("FRED");if(!Ee)return;const Oe=await lt("execute_python_script",{scriptName:"fred_data.py",args:["search",K,"50"],env:{FRED_API_KEY:Ee}}),q=JSON.parse(Oe);!q.error&&q.series?G(q.series):G([])}catch{G([])}finally{F(!1)}},de=async(K=0)=>{Q(!0);try{const Ee=await Je.getApiKey("FRED");if(!Ee)return;const Oe=await lt("execute_python_script",{scriptName:"fred_data.py",args:["categories",K.toString()],env:{FRED_API_KEY:Ee}}),q=JSON.parse(Oe);!q.error&&q.categories?$(q.categories):$([])}catch{$([])}finally{Q(!1)}},je=async K=>{me(!0);try{const Ee=await Je.getApiKey("FRED");if(!Ee){me(!1);return}const Oe=await lt("execute_python_script",{scriptName:"fred_data.py",args:["category_series",K.toString(),"50"],env:{FRED_API_KEY:Ee}}),q=JSON.parse(Oe);!q.error&&q.series?Y(q.series):Y([])}catch{Y([])}finally{me(!1)}},_e=async K=>{D(K.id),Z([...oe,K]),I(""),G([]),Y([]),await Promise.all([de(K.id),je(K.id)])},Re=()=>{if(oe.length>1){const K=oe.slice(0,-1);Z(K);const Ee=K[K.length-1].id;D(Ee),de(Ee)}},Be=()=>{M(!0),z.length===0&&de(0)},Se=async K=>{if(!ve().includes(K)){const Ee=o?`${o},${K}`:K;a(Ee),setTimeout(async()=>{try{b(!0),T(null),y("Initializing...");const Oe=await Je.getApiKey("FRED");if(!Oe){T("FRED API key not configured. Please add it in Settings."),b(!1),y("");return}const q=[...new Set(Ee.split(",").map(be=>be.trim()).filter(Boolean))];if(q.length===0){T("Please enter at least one series ID"),b(!1),y("");return}y(`Fetching ${q.length} series from FRED API...`);const ee=["multiple",...q,l,p],ce=await lt("execute_python_script",{scriptName:"fred_data.py",args:ee,env:{FRED_API_KEY:Oe}});y("Processing data...");const Ce=JSON.parse(ce);if(Ce.error)T(`API Error: ${Ce.error}`);else if(Array.isArray(Ce)){const be=Ce.find(We=>We.error);be?T(`Failed to fetch ${be.series_id}: ${be.error}`):(x(Ce),T(null),y(`Successfully loaded ${Ce.length} series!`),setTimeout(()=>y(""),2e3))}else x(Ce)}catch(Oe){T(Oe.message||"Failed to fetch data")}finally{b(!1)}},100)}},ie=async()=>{b(!0),T(null),y("Initializing...");try{const K=await Je.getApiKey("FRED");if(!K){T("FRED API key not configured. Please add it in Settings > Credentials."),A(!1),b(!1),y("");return}const Ee=[...new Set(o.split(",").map(ce=>ce.trim()).filter(Boolean))];if(Ee.length===0){T("Please enter at least one series ID"),b(!1),y("");return}y(`Fetching ${Ee.length} series from FRED API...`);const Oe=["multiple",...Ee,l,p],q=await lt("execute_python_script",{scriptName:"fred_data.py",args:Oe,env:{FRED_API_KEY:K}});y("Processing data...");const ee=JSON.parse(q);if(ee.error)T(`API Error: ${ee.error}`);else if(Array.isArray(ee)){const ce=ee.find(Ce=>Ce.error);ce?T(`Failed to fetch ${ce.series_id}: ${ce.error}`):(x(ee),T(null),y(`Successfully loaded ${ee.length} series!`),setTimeout(()=>y(""),2e3))}else x(ee)}catch(K){T(K.message||"Failed to fetch data")}finally{b(!1)}},ve=()=>o.split(",").map(K=>K.trim()).filter(Boolean),Ae=K=>{const Ee=ve();if(Ee.includes(K)){const Oe=Ee.filter(q=>q!==K);a(Oe.join(","))}else a(Oe=>Oe?`${Oe},${K}`:K)},$e=()=>{if(h.length===0)return[];const K=new Set;h.forEach(q=>{q.observations.forEach(ee=>K.add(ee.date))});const Oe=Array.from(K).sort().map(q=>{const ee={date:q};return h.forEach(ce=>{const Ce=ce.observations.find(be=>be.date===q);ee[ce.series_id]=Ce?.value||null}),ee});if(ge&&h.length>1){const q={};return h.forEach(ee=>{const ce=ee.observations.map(Ce=>parseFloat(Ce.value.toString())).filter(Ce=>!isNaN(Ce)&&Ce!==null);ce.length>0&&(q[ee.series_id]={min:Math.min(...ce),max:Math.max(...ce)})}),Oe.map(ee=>{const ce={date:ee.date};return h.forEach(Ce=>{const be=ee[Ce.series_id];if(be!=null&&q[Ce.series_id]){const{min:We,max:J}=q[Ce.series_id],se=J-We;ce[Ce.series_id]=se>0?(be-We)/se*100:50}else ce[Ce.series_id]=null}),ce})}return Oe},qe=()=>{const K=$e(),Ee=["Date",...h.map(be=>be.series_id)].join(","),Oe=K.map(be=>[be.date,...h.map(We=>be[We.series_id]||"")].join(",")),q=[Ee,...Oe].join(`
`),ee=new Blob([q],{type:"text/csv"}),ce=URL.createObjectURL(ee),Ce=document.createElement("a");Ce.href=ce,Ce.download=`fred_data_${new Date().toISOString()}.csv`,Ce.click()},Ie=S.useMemo(()=>new Set(ve()),[o]);return S.useEffect(()=>{const K=setTimeout(()=>{P&&R&&V(P)},500);return()=>clearTimeout(K)},[P,R]),t.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:s.background,color:s.text,fontFamily:r,fontWeight:n,fontStyle:i,overflow:"hidden",fontSize:e.body},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar { width: 6px; height: 6px; }
        *::-webkit-scrollbar-track { background: ${s.background}; }
        *::-webkit-scrollbar-thumb { background: ${s.panel}; border-radius: 3px; }
        *::-webkit-scrollbar-thumb:hover { background: ${s.textMuted}; }
      `}),R&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.95)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",backdropFilter:"blur(4px)"},children:t.jsxs("div",{style:{background:s.background,border:`1px solid ${s.primary}`,borderRadius:"4px",width:"90%",maxWidth:"1200px",height:"85vh",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:`0 8px 32px ${s.primary}33`},children:[t.jsxs("div",{style:{borderBottom:`1px solid ${s.primary}`,padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",background:s.panel},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t.jsx(XE,{size:16,color:s.primary}),t.jsx("span",{style:{color:s.primary,fontSize:e.heading,fontWeight:"bold",letterSpacing:"0.5px"},children:"FRED SERIES BROWSER"})]}),t.jsx("button",{onClick:()=>M(!1),style:{background:"transparent",border:"none",color:s.textMuted,cursor:"pointer",padding:"4px",display:"flex",alignItems:"center"},children:t.jsx(ln,{size:18})})]}),t.jsx("div",{style:{padding:"12px 20px",borderBottom:`1px solid ${s.panel}`},children:t.jsxs("div",{style:{position:"relative"},children:[t.jsx(Ho,{size:14,color:s.textMuted,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)"}}),t.jsx("input",{type:"text",placeholder:"Search FRED series by keyword (e.g., 'unemployment', 'inflation', 'GDP')...",value:P,onChange:K=>I(K.target.value),style:{width:"100%",background:s.panel,border:`1px solid ${s.textMuted}33`,color:s.text,padding:"10px 40px 10px 40px",fontSize:e.small,borderRadius:"3px",outline:"none",transition:"border-color 0.2s"},onFocus:K=>K.target.style.borderColor=s.primary,onBlur:K=>K.target.style.borderColor=`${s.textMuted}33`}),B&&t.jsx(Hs,{size:14,className:"animate-spin",style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",color:s.primary}})]})}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[!P&&t.jsxs("div",{style:{width:"350px",borderRight:"1px solid #1a1a1a",display:"flex",flexDirection:"column",background:"#050505"},children:[t.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #1a1a1a",display:"flex",alignItems:"center",gap:"8px"},children:[oe.length>1&&t.jsxs("button",{onClick:Re,style:{background:"colors.panel",border:"1px solid #2a2a2a",color:"#ea580c",padding:"4px 8px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(ks,{size:12}),"BACK"]}),t.jsx("span",{style:{color:"#888",fontSize:"10px",flex:1},children:oe.map((K,Ee)=>t.jsxs("span",{children:[Ee>0&&" > ",K.name]},`${K.id}-${Ee}`))})]}),W===0&&t.jsxs("div",{style:{padding:"12px",borderBottom:"1px solid #1a1a1a",maxHeight:"200px",overflowY:"auto"},children:[t.jsx("h4",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px",fontWeight:"bold"},children:"POPULAR CATEGORIES"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:WH.map((K,Ee)=>t.jsxs("button",{onClick:()=>_e({id:K.id,name:K.name.replace(/[^\w\s]/gi,"").trim()}),style:{background:"colors.panel",border:"1px solid #2a2a2a",color:"colors.text",padding:"6px 8px",fontSize:"9px",cursor:"pointer",borderRadius:"3px",textAlign:"left",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsx("div",{style:{flex:1,minWidth:0},children:t.jsx("div",{style:{fontWeight:"bold",marginBottom:"2px",fontSize:"9px"},children:K.name})}),t.jsx(Rd,{size:12,color:"#666"})]},`pop-${K.id}-${Ee}`))})]}),t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:[t.jsx("h4",{style:{color:"#888",fontSize:"9px",marginBottom:"8px",fontWeight:"bold"},children:fe?"LOADING...":`SUBCATEGORIES (${z.length})`}),z.length===0&&!fe&&W!==0&&t.jsx("p",{style:{color:"#666",fontSize:"10px"},children:"No subcategories found"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:z.map((K,Ee)=>t.jsxs("button",{onClick:()=>_e(K),style:{background:"colors.panel",border:"1px solid #2a2a2a",color:"colors.text",padding:"8px 10px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",textAlign:"left",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsx("span",{children:K.name}),t.jsx(Rd,{size:12,color:"#666"})]},`cat-${K.id}-${Ee}`))})]})]}),t.jsx("div",{style:{flex:1,overflowY:"auto",padding:"16px 20px"},children:he&&!P?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"16px"},children:[t.jsx(Hs,{size:32,color:s.primary,className:"animate-spin"}),t.jsx("p",{style:{color:s.textMuted,fontSize:e.small},children:"Loading series in category..."})]}):P?t.jsxs(t.Fragment,{children:[t.jsxs("h3",{style:{color:"#ea580c",fontSize:"11px",marginBottom:"12px",fontWeight:"bold"},children:["SEARCH RESULTS (",O.length,")"]}),O.length===0&&!B&&t.jsx("p",{style:{color:"#666",fontSize:"10px"},children:"No results found"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:O.map(K=>t.jsxs("div",{style:{background:"colors.panel",border:"1px solid #1a1a1a",borderRadius:"4px",padding:"12px",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"12px"},children:[t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[t.jsx("span",{style:{color:"#ea580c",fontSize:"11px",fontWeight:"bold",fontFamily:"monospace"},children:K.id}),t.jsxs("span",{style:{color:"#666",fontSize:"9px"},children:["Pop: ",K.popularity]})]}),t.jsx("p",{style:{color:"colors.text",fontSize:"10px",marginBottom:"4px"},children:K.title}),t.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"9px",color:"#666"},children:[t.jsxs("span",{children:["Freq: ",K.frequency]}),t.jsxs("span",{children:["Units: ",K.units]}),t.jsxs("span",{children:["Updated: ",K.last_updated.split("T")[0]]})]})]}),t.jsxs("button",{onClick:()=>Se(K.id),disabled:Ie.has(K.id),style:{background:Ie.has(K.id)?"#1a3a1a":"#ea580c",border:"none",color:"colors.text",padding:"6px 12px",fontSize:"10px",cursor:Ie.has(K.id)?"not-allowed":"pointer",borderRadius:"3px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",opacity:Ie.has(K.id)?.5:1},children:[t.jsx(wn,{size:12}),Ie.has(K.id)?"ADDED":"ADD"]})]},K.id))})]}):_.length>0?t.jsxs(t.Fragment,{children:[t.jsxs("h3",{style:{color:"#ea580c",fontSize:"11px",marginBottom:"12px",fontWeight:"bold"},children:["SERIES IN THIS CATEGORY (",_.length,")"]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:_.map(K=>t.jsxs("div",{style:{background:"colors.panel",border:"1px solid #1a1a1a",borderRadius:"4px",padding:"12px",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:"12px"},children:[t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[t.jsx("span",{style:{color:"#ea580c",fontSize:"11px",fontWeight:"bold",fontFamily:"monospace"},children:K.id}),t.jsxs("span",{style:{color:"#666",fontSize:"9px"},children:["Pop: ",K.popularity]})]}),t.jsx("p",{style:{color:"colors.text",fontSize:"10px",marginBottom:"4px"},children:K.title}),t.jsxs("div",{style:{display:"flex",gap:"12px",fontSize:"9px",color:"#666"},children:[t.jsxs("span",{children:["Freq: ",K.frequency]}),t.jsxs("span",{children:["Units: ",K.units]}),t.jsxs("span",{children:["Updated: ",K.last_updated.split("T")[0]]})]})]}),t.jsxs("button",{onClick:()=>Se(K.id),disabled:Ie.has(K.id),style:{background:Ie.has(K.id)?"#1a3a1a":"#ea580c",border:"none",color:"colors.text",padding:"6px 12px",fontSize:"10px",cursor:Ie.has(K.id)?"not-allowed":"pointer",borderRadius:"3px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px",whiteSpace:"nowrap",opacity:Ie.has(K.id)?.5:1},children:[t.jsx(wn,{size:12}),Ie.has(K.id)?"ADDED":"ADD"]})]},K.id))})]}):t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"16px"},children:[t.jsx(Nr,{size:48,color:"#333"}),t.jsxs("div",{style:{textAlign:"center",maxWidth:"500px"},children:[t.jsx("p",{style:{color:"#888",fontSize:"12px",marginBottom:"8px"},children:t.jsx("strong",{children:"Search for any economic data series"})}),t.jsx("p",{style:{color:"#666",fontSize:"10px",lineHeight:"1.5"},children:'Try searching for terms like "unemployment", "inflation", "GDP", "interest rates", "housing", etc. Or browse through categories on the left to discover available data series.'})]})]})})]}),t.jsxs("div",{style:{borderTop:"1px solid #1a1a1a",padding:"12px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"colors.panel"},children:[t.jsx("span",{style:{color:"#666",fontSize:"9px"},children:"Federal Reserve Economic Data (FRED) | 800,000+ series available"}),t.jsx("button",{onClick:()=>M(!1),style:{background:"#ea580c",border:"none",color:"colors.text",padding:"8px 16px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:"DONE"})]})]})}),t.jsxs("div",{style:{borderBottom:`1px solid ${s.primary}`,padding:"10px 16px",background:s.panel,display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t.jsx(ja,{size:16,color:s.primary}),t.jsx("span",{style:{color:s.primary,fontSize:e.heading,fontWeight:"bold",letterSpacing:"0.5px"},children:"FRED DATA EXPLORER"})]}),t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsx("button",{onClick:()=>j(E==="line"?"area":"line"),style:{background:s.background,border:`1px solid ${s.primary}33`,color:s.primary,padding:"6px 12px",fontSize:e.small,cursor:"pointer",borderRadius:"3px",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:K=>{K.currentTarget.style.background=s.primary,K.currentTarget.style.color=s.background},onMouseLeave:K=>{K.currentTarget.style.background=s.background,K.currentTarget.style.color=s.primary},children:E==="line"?"AREA":"LINE"}),t.jsx("button",{onClick:()=>le(!ge),disabled:h.length<=1,style:{background:ge?s.primary:s.background,border:`1px solid ${s.primary}33`,color:ge?s.background:s.primary,padding:"6px 12px",fontSize:e.small,cursor:h.length>1?"pointer":"not-allowed",borderRadius:"3px",fontWeight:"bold",opacity:h.length>1?1:.5,transition:"all 0.2s"},onMouseEnter:K=>{h.length>1&&!ge&&(K.currentTarget.style.background=s.primary,K.currentTarget.style.color=s.background)},onMouseLeave:K=>{h.length>1&&!ge&&(K.currentTarget.style.background=s.background,K.currentTarget.style.color=s.primary)},children:"NORMALIZE"}),t.jsxs("button",{onClick:qe,disabled:h.length===0,style:{background:h.length>0?s.background:s.panel,border:`1px solid ${h.length>0?s.success:s.textMuted}33`,color:h.length>0?s.success:s.textMuted,padding:"6px 12px",fontSize:e.small,cursor:h.length>0?"pointer":"not-allowed",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"bold",opacity:h.length>0?1:.5,transition:"opacity 0.2s"},onMouseEnter:K=>{h.length>0&&(K.currentTarget.style.opacity="0.7")},onMouseLeave:K=>{h.length>0&&(K.currentTarget.style.opacity="1")},children:[t.jsx(Mi,{size:12}),"CSV"]})]})]}),!k&&t.jsxs("div",{style:{background:`${s.warning}11`,border:`1px solid ${s.warning}`,padding:"12px 16px",display:"flex",alignItems:"flex-start",gap:"12px",flexShrink:0},children:[t.jsx(Rr,{size:20,color:s.warning,style:{flexShrink:0,marginTop:"2px"}}),t.jsxs("div",{style:{flex:1},children:[t.jsx("p",{style:{color:s.warning,fontSize:e.body,fontWeight:"bold",marginBottom:"6px"},children:"API KEY REQUIRED"}),t.jsxs("p",{style:{color:s.text,fontSize:e.small,lineHeight:"1.5",marginBottom:"8px"},children:["Configure your FRED API key in ",t.jsx("strong",{children:"Settings  Credentials"})," to access economic data."]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[t.jsxs("p",{style:{color:s.textMuted,fontSize:e.tiny},children:[t.jsx("strong",{style:{color:s.warning},children:"1."})," Get free API key at"," ",t.jsx("a",{href:"https://research.stlouisfed.org/useraccount/apikey",target:"_blank",rel:"noopener noreferrer",style:{color:s.info,textDecoration:"underline"},children:"research.stlouisfed.org"})]}),t.jsxs("p",{style:{color:s.textMuted,fontSize:e.tiny},children:[t.jsx("strong",{style:{color:s.warning},children:"2."})," Add to ",t.jsx("strong",{children:"Settings  Credentials  FRED_API_KEY"})]}),t.jsxs("p",{style:{color:s.textMuted,fontSize:e.tiny},children:[t.jsx("strong",{style:{color:s.warning},children:"3."})," Save and reload this tab"]})]})]})]}),t.jsxs("div",{style:{borderBottom:`1px solid ${s.panel}`,padding:"12px 16px",background:s.panel,flexShrink:0},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr auto",gap:"10px",marginBottom:"10px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:s.textMuted,fontSize:e.tiny,display:"block",marginBottom:"4px",fontWeight:"bold"},children:"SERIES IDs"}),t.jsx("input",{type:"text",value:o,onChange:K=>a(K.target.value),placeholder:"GDP,UNRATE,CPIAUCSL",style:{width:"100%",background:s.background,border:`1px solid ${s.textMuted}33`,color:s.text,padding:"8px 10px",fontSize:e.small,borderRadius:"3px",outline:"none"},onFocus:K=>K.target.style.borderColor=s.primary,onBlur:K=>K.target.style.borderColor=`${s.textMuted}33`})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.textMuted,fontSize:e.tiny,display:"block",marginBottom:"4px",fontWeight:"bold"},children:"START DATE"}),t.jsx("input",{type:"date",value:l,onChange:K=>d(K.target.value),style:{width:"100%",background:s.background,border:`1px solid ${s.textMuted}33`,color:s.text,padding:"8px 10px",fontSize:e.small,borderRadius:"3px",outline:"none"},onFocus:K=>K.target.style.borderColor=s.primary,onBlur:K=>K.target.style.borderColor=`${s.textMuted}33`})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.textMuted,fontSize:e.tiny,display:"block",marginBottom:"4px",fontWeight:"bold"},children:"END DATE"}),t.jsx("input",{type:"date",value:p,onChange:K=>f(K.target.value),style:{width:"100%",background:s.background,border:`1px solid ${s.textMuted}33`,color:s.text,padding:"8px 10px",fontSize:e.small,borderRadius:"3px",outline:"none"},onFocus:K=>K.target.style.borderColor=s.primary,onBlur:K=>K.target.style.borderColor=`${s.textMuted}33`})]}),t.jsxs("button",{onClick:ie,disabled:m,style:{background:m?s.panel:s.primary,border:"none",color:s.background,padding:"0 18px",fontSize:e.small,cursor:m?"not-allowed":"pointer",borderRadius:"3px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px",alignSelf:"end",opacity:m?.6:1,transition:"all 0.2s"},onMouseEnter:K=>!m&&(K.currentTarget.style.opacity="0.8"),onMouseLeave:K=>!m&&(K.currentTarget.style.opacity="1"),children:[m?t.jsx(Hs,{size:12,className:"animate-spin"}):t.jsx(Ho,{size:12}),m?"LOADING":"FETCH"]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"10px"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{color:s.textMuted,fontSize:e.tiny,marginBottom:"6px",display:"block",fontWeight:"bold"},children:"QUICK ADD"}),t.jsx("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:UH.map(K=>t.jsx("button",{onClick:()=>Ae(K.id),style:{background:Ie.has(K.id)?`${s.success}22`:s.background,border:`1px solid ${Ie.has(K.id)?s.success:s.textMuted}44`,color:Ie.has(K.id)?s.success:s.textMuted,padding:"4px 10px",fontSize:e.tiny,cursor:"pointer",borderRadius:"3px",fontWeight:Ie.has(K.id)?"bold":"normal",transition:"all 0.2s"},onMouseEnter:Ee=>{Ie.has(K.id)||(Ee.currentTarget.style.borderColor=s.primary,Ee.currentTarget.style.color=s.primary)},onMouseLeave:Ee=>{Ie.has(K.id)||(Ee.currentTarget.style.borderColor=`${s.textMuted}44`,Ee.currentTarget.style.color=s.textMuted)},children:K.id},K.id))})]}),t.jsxs("button",{onClick:Be,disabled:!k,style:{background:k?s.primary:s.panel,border:`1px solid ${k?s.primary:s.textMuted}44`,color:k?s.background:s.textMuted,padding:"8px 14px",fontSize:e.small,cursor:k?"pointer":"not-allowed",borderRadius:"3px",fontWeight:"bold",display:"flex",alignItems:"center",gap:"6px",whiteSpace:"nowrap",opacity:k?1:.5,transition:"opacity 0.2s"},onMouseEnter:K=>k&&(K.currentTarget.style.opacity="0.8"),onMouseLeave:K=>k&&(K.currentTarget.style.opacity="1"),children:[t.jsx(XE,{size:12}),"BROWSE SERIES"]})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",gap:"12px",padding:"12px 16px",overflow:"hidden",minHeight:0},children:[t.jsx("div",{style:{flex:2,display:"flex",flexDirection:"column",minWidth:0},children:t.jsxs("div",{style:{background:s.panel,border:`1px solid ${s.primary}33`,borderRadius:"4px",padding:"14px",height:"100%",display:"flex",flexDirection:"column"},children:[t.jsx("h3",{style:{color:s.primary,fontSize:e.body,fontWeight:"bold",marginBottom:"10px",letterSpacing:"0.5px"},children:"TIME SERIES CHART"}),m&&t.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"16px"},children:[t.jsx(Hs,{size:48,color:s.primary,className:"animate-spin"}),t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("p",{style:{color:s.primary,fontSize:e.body,fontWeight:"bold",marginBottom:"6px"},children:w}),t.jsx("p",{style:{color:s.textMuted,fontSize:e.small},children:"Please wait while we fetch data from FRED..."})]})]}),!m&&C&&t.jsxs("div",{style:{background:"#3a0a0a",border:"2px solid #ff0000",color:"#ff0000",padding:"16px",borderRadius:"4px",fontSize:"11px",marginBottom:"12px",display:"flex",alignItems:"flex-start",gap:"12px",boxShadow:"0 2px 8px rgba(255, 0, 0, 0.2)"},children:[t.jsx(Rr,{size:20,style:{flexShrink:0,marginTop:"2px"}}),t.jsxs("div",{style:{flex:1},children:[t.jsx("p",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Error Fetching Data"}),t.jsx("p",{style:{color:"#ffaaaa",fontSize:"10px"},children:C}),!k&&t.jsx("p",{style:{color:"#ffaaaa",fontSize:"10px",marginTop:"8px"},children:" Tip: Make sure you've configured your FRED API key in Settings  Credentials"})]})]}),h.length===0&&!m&&!C&&t.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:s.textMuted,fontSize:e.body,flexDirection:"column",gap:"10px"},children:[t.jsx(Nr,{size:48,color:s.textMuted,opacity:.3}),t.jsx("p",{style:{color:s.text},children:"Enter series IDs and click FETCH to visualize data"}),t.jsx("p",{style:{fontSize:e.small,color:s.textMuted},children:"Try searching for GDP, UNRATE, or CPIAUCSL"})]}),h.length>0&&t.jsx("div",{style:{flex:1,minHeight:0},children:t.jsx(ml,{width:"100%",height:"100%",children:E==="line"?t.jsxs(tg,{data:$e(),margin:{top:5,right:20,left:10,bottom:5},children:[t.jsx(vd,{strokeDasharray:"3 3",stroke:`${s.textMuted}22`}),t.jsx(bl,{dataKey:"date",stroke:s.textMuted,style:{fontSize:e.tiny,fill:s.textMuted}}),t.jsx(vl,{stroke:s.textMuted,style:{fontSize:e.tiny,fill:s.textMuted},label:ge?{value:"Normalized (0-100)",angle:-90,position:"insideLeft",style:{fontSize:e.tiny,fill:s.textMuted}}:void 0}),t.jsx(Sl,{contentStyle:{background:s.background,border:`1px solid ${s.primary}`,borderRadius:"3px",fontSize:e.small},labelStyle:{color:s.primary,fontSize:e.tiny},itemStyle:{color:s.text,fontSize:e.tiny}}),t.jsx(gE,{wrapperStyle:{fontSize:e.tiny}}),h.map((K,Ee)=>t.jsx(rg,{type:"monotone",dataKey:K.series_id,stroke:[s.primary,s.success,s.info,s.warning,s.alert][Ee%5],strokeWidth:2,dot:!1},K.series_id))]}):t.jsxs(dA,{data:$e(),margin:{top:5,right:20,left:10,bottom:5},children:[t.jsx(vd,{strokeDasharray:"3 3",stroke:`${s.textMuted}22`}),t.jsx(bl,{dataKey:"date",stroke:s.textMuted,style:{fontSize:e.tiny,fill:s.textMuted}}),t.jsx(vl,{stroke:s.textMuted,style:{fontSize:e.tiny,fill:s.textMuted},label:ge?{value:"Normalized (0-100)",angle:-90,position:"insideLeft",style:{fontSize:e.tiny,fill:s.textMuted}}:void 0}),t.jsx(Sl,{contentStyle:{background:s.background,border:`1px solid ${s.primary}`,borderRadius:"3px",fontSize:e.small},labelStyle:{color:s.primary,fontSize:e.tiny},itemStyle:{color:s.text,fontSize:e.tiny}}),t.jsx(gE,{wrapperStyle:{fontSize:e.tiny}}),h.map((K,Ee)=>t.jsx(L0,{type:"monotone",dataKey:K.series_id,stroke:[s.primary,s.success,s.info,s.warning,s.alert][Ee%5],fill:`${[s.primary,s.success,s.info,s.warning,s.alert][Ee%5]}33`},K.series_id))]})})})]})}),t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0,overflowY:"auto",gap:"10px"},children:h.map(K=>t.jsxs("div",{style:{background:s.panel,border:`1px solid ${s.primary}33`,borderRadius:"4px",padding:"12px",flexShrink:0},children:[t.jsxs("div",{style:{borderBottom:`1px solid ${s.textMuted}33`,paddingBottom:"8px",marginBottom:"8px"},children:[t.jsx("h4",{style:{color:s.primary,fontSize:e.body,fontWeight:"bold",marginBottom:"4px"},children:K.series_id}),t.jsx("p",{style:{color:s.text,fontSize:e.tiny,marginBottom:"6px"},children:K.title}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px",fontSize:e.tiny,color:s.textMuted},children:[t.jsxs("span",{children:["Units: ",K.units]}),t.jsxs("span",{children:["Freq: ",K.frequency]}),t.jsxs("span",{children:["Obs: ",K.observation_count]}),t.jsxs("span",{children:["Updated: ",K.last_updated.split("T")[0]]})]})]}),t.jsx("div",{style:{maxHeight:"200px",overflowY:"auto"},children:t.jsxs("table",{style:{width:"100%",fontSize:e.tiny,borderCollapse:"collapse"},children:[t.jsx("thead",{style:{position:"sticky",top:0,background:s.panel},children:t.jsxs("tr",{style:{borderBottom:`1px solid ${s.textMuted}33`},children:[t.jsx("th",{style:{color:s.textMuted,textAlign:"left",padding:"6px 4px",fontWeight:"bold"},children:"Date"}),t.jsx("th",{style:{color:s.textMuted,textAlign:"right",padding:"6px 4px",fontWeight:"bold"},children:"Value"})]})}),t.jsx("tbody",{children:K.observations.slice(-20).reverse().map((Ee,Oe)=>t.jsxs("tr",{style:{borderBottom:`1px solid ${s.background}`},children:[t.jsx("td",{style:{color:s.textMuted,padding:"4px"},children:Ee.date}),t.jsx("td",{style:{color:s.text,textAlign:"right",padding:"4px",fontFamily:"monospace",fontSize:e.tiny},children:Ee.value.toFixed(2)})]},Oe))})]})})]},K.series_id))})]}),t.jsxs("div",{style:{borderTop:`1px solid ${s.primary}`,padding:"8px 16px",background:s.panel,fontSize:e.tiny,color:s.textMuted,display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsx("span",{children:"FRED Economic Data | Federal Reserve Bank of St. Louis"}),h.length>0&&t.jsxs("span",{style:{color:s.primary,fontWeight:"bold"},children:[h.length," series | ",h.reduce((K,Ee)=>K+Ee.observation_count,0)," observations"]})]})]})}function HH(){const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),o="https://api.db.nomics.world/v22",a=[s.primary,s.info,s.secondary,s.warning,s.purple,s.purple,s.accent,s.primary],[l,d]=S.useState([]),[p,f]=S.useState([]),[h,x]=S.useState([]),[m,b]=S.useState(null),[w,y]=S.useState(null),[C,T]=S.useState(null),[E,j]=S.useState(null),[k,A]=S.useState("Loading providers..."),[R,M]=S.useState(!1),[P,I]=S.useState([[]]),[O,G]=S.useState(["line"]),[B,F]=S.useState("single"),[z,$]=S.useState([]),[W,D]=S.useState("line");S.useEffect(()=>{fe(),Z()},[]),S.useEffect(()=>{oe()},[z,P,O,W,B]);const oe=()=>{try{const ie={singleViewSeries:z,slots:P,slotChartTypes:O,singleChartType:W,activeView:B,timestamp:Date.now()};localStorage.setItem("dbnomics_state",JSON.stringify(ie))}catch(ie){console.error("Failed to save DBnomics state:",ie)}},Z=()=>{try{const ie=localStorage.getItem("dbnomics_state");if(ie){const ve=JSON.parse(ie);ve.timestamp&&Date.now()-ve.timestamp<1440*60*1e3&&(ve.singleViewSeries&&$(ve.singleViewSeries),ve.slots&&I(ve.slots),ve.slotChartTypes&&G(ve.slotChartTypes),ve.singleChartType&&D(ve.singleChartType),ve.activeView&&F(ve.activeView),A("Restored previous session"))}}catch(ie){console.error("Failed to restore DBnomics state:",ie)}},fe=async()=>{try{M(!0),A("Loading providers...");const ie=await fetch(`${o}/providers`);if(ie.ok){const Ae=((await ie.json())?.providers?.docs||[]).map($e=>({code:$e.code||"",name:$e.name||$e.code||""}));d(Ae),A(`Loaded ${Ae.length} providers`)}else A(`Error: ${ie.status}`)}catch(ie){A(`Error: ${ie}`)}finally{M(!1)}},Q=async ie=>{try{M(!0),A("Loading datasets...");const ve=await fetch(`${o}/datasets/${ie}`);if(ve.ok){const $e=((await ve.json())?.datasets?.docs||[]).map(qe=>({code:qe.code||"",name:qe.name||qe.code||""}));f($e),x([]),A(`Loaded ${$e.length} datasets`)}else A(`Error: ${ve.status}`)}catch(ve){A(`Error: ${ve}`)}finally{M(!1)}},_=async(ie,ve)=>{try{M(!0),A("Loading series...");const Ae=await fetch(`${o}/series/${ie}/${ve}?limit=50&observations=false`);if(Ae.ok){const qe=((await Ae.json())?.series?.docs||[]).map(Ie=>({code:Ie.series_code||"",name:Ie.series_name||Ie.series_code||"",full_id:`${ie}/${ve}/${Ie.series_code}`}));x(qe),A(`Loaded ${qe.length} series`)}else A(`Error: ${Ae.status}`)}catch(Ae){A(`Error: ${Ae}`)}finally{M(!1)}},Y=async(ie,ve)=>{try{M(!0),A("Loading data...");const[Ae,$e,qe]=ie.split("/"),Ie=await fetch(`${o}/series/${Ae}/${$e}/${qe}?observations=1&format=json`);if(Ie.ok){const Ee=(await Ie.json())?.series?.docs||[];if(Ee.length>0){const Oe=Ee[0];let q=[];if(Oe.period&&Oe.value)for(let ee=0;ee<Math.min(Oe.period.length,Oe.value.length);ee++)Oe.value[ee]!==null&&q.push({period:Oe.period[ee],value:Oe.value[ee]});if(q.length>0){const ee=(z.length+P.flat().length)%a.length;b({series_id:ie,series_name:ve,observations:q,color:a[ee]}),A(`Loaded ${q.length} points`)}else A("No data found")}else A("No data found")}else A(`Error: ${Ie.status}`)}catch(Ae){A(`Error: ${Ae}`)}finally{M(!1)}},he=ie=>{y(ie),T(null),j(null),f([]),x([]),Q(ie)},me=ie=>{T(ie),j(null),x([]),w&&_(w,ie)},ge=ie=>{j(ie.full_id),Y(ie.full_id,ie.name)},le=()=>{I([...P,[]]),G([...O,"line"]),A(`Added slot ${P.length+1}`)},X=ie=>{P.length>1&&(I(P.filter((ve,Ae)=>Ae!==ie)),G(O.filter((ve,Ae)=>Ae!==ie)),A(`Removed slot ${ie+1}`))},V=ie=>{if(m&&ie>=0&&ie<P.length){const ve=[...P];ve[ie]=[...ve[ie],m],I(ve),A(`Added to slot ${ie+1}`)}},de=(ie,ve)=>{const Ae=[...P];Ae[ie]=Ae[ie].filter(($e,qe)=>qe!==ve),I(Ae),A(`Removed from slot ${ie+1}`)},je=()=>{m&&($([...z,m]),F("single"),A("Added to single view"))},_e=ie=>{$(z.filter((ve,Ae)=>Ae!==ie))},Re=()=>{I([[]]),G(["line"]),$([]),localStorage.removeItem("dbnomics_state"),A("Cleared all")},Be=()=>{if(!m)return;const ie=["Period,Value",...m.observations.map(qe=>`${qe.period},${qe.value}`)].join(`
`),ve=new Blob([ie],{type:"text/csv"}),Ae=URL.createObjectURL(ve),$e=document.createElement("a");$e.href=Ae,$e.download=`dbnomics_${Date.now()}.csv`,$e.click(),URL.revokeObjectURL(Ae),A("Exported")},Se=(ie,ve,Ae=!1)=>{if(ie.length===0)return null;const $e=Ae?"100%":800,qe=Ae?240:400,Ie=60,K=20,Ee=20,Oe=50,q=Ae?380:800,ee=q-Ie-K,ce=qe-Ee-Oe,Ce=ie.flatMap(se=>se.observations.map(Te=>Te.value)),be=Math.min(...Ce)*.9,J=Math.max(...Ce)*1.1-be;return t.jsxs("svg",{width:$e,height:qe,viewBox:`0 0 ${q} ${qe}`,preserveAspectRatio:"xMidYMid meet",style:{backgroundColor:s.panel,width:"100%",height:"auto",maxHeight:Ae?"240px":"400px"},children:[t.jsx("line",{x1:Ie,y1:Ee,x2:Ie,y2:qe-Oe,stroke:s.textMuted,strokeWidth:"1"}),t.jsx("line",{x1:Ie,y1:qe-Oe,x2:q-K,y2:qe-Oe,stroke:s.textMuted,strokeWidth:"1"}),[0,1,2,3,4].map(se=>{const Te=be+J*se/4,Me=qe-Oe-ce*se/4;return t.jsxs("g",{children:[t.jsx("line",{x1:Ie,y1:Me,x2:q-K,y2:Me,stroke:"#1a1a1a",strokeDasharray:"2,2"}),t.jsx("text",{x:Ie-8,y:Me+3,textAnchor:"end",fill:s.textMuted,fontSize:"9",fontFamily:"monospace",children:Te.toFixed(1)})]},se)}),ie.map((se,Te)=>{const Me=[...se.observations].sort((Qe,ye)=>new Date(Qe.period).getTime()-new Date(ye.period).getTime());return t.jsx("g",{children:Me.map((Qe,ye)=>{const ue=Ie+ee*ye/(Me.length-1||1),re=qe-Oe-ce*((Number(Qe.value)-be)/J),ke=ee/Me.length*.8;if(ve==="line"||ve==="area")return t.jsxs("g",{children:[ve==="area"&&ye===0&&t.jsx("polygon",{points:`${Me.map((U,ne)=>{const xe=Ie+ee*ne/(Me.length-1||1),Le=typeof U.value=="number"?U.value:Number(U.value),ze=qe-Oe-ce*((Le-be)/J);return`${xe},${ze}`}).join(" ")} ${q-K},${qe-Oe} ${Ie},${qe-Oe}`,fill:se.color,opacity:"0.2"}),t.jsx("circle",{cx:ue,cy:re,r:"2",fill:se.color}),ye<Me.length-1&&t.jsx("line",{x1:ue,y1:re,x2:Ie+ee*(ye+1)/(Me.length-1||1),y2:qe-Oe-ce*((Number(Me[ye+1].value)-be)/J),stroke:se.color,strokeWidth:"1.5"})]},ye);if(ve==="bar")return t.jsx("rect",{x:ue-ke/2+Te*ke/ie.length,y:re,width:ke/ie.length,height:qe-Oe-re,fill:se.color,opacity:"0.8"},ye);if(ve==="scatter")return t.jsx("circle",{cx:ue,cy:re,r:"3",fill:se.color,opacity:"0.7"},ye);if(ve==="candlestick"){const Ne=Me[ye+1],U=Qe.value,ne=Ne?Ne.value:Qe.value,xe=Math.max(U,ne),Le=Math.min(U,ne),ze=qe-Oe-ce*((xe-be)/J),Ge=qe-Oe-ce*((Le-be)/J),Ze=qe-Oe-ce*((U-be)/J),xt=qe-Oe-ce*((ne-be)/J);return t.jsxs("g",{children:[t.jsx("line",{x1:ue,y1:ze,x2:ue,y2:Ge,stroke:se.color,strokeWidth:"1"}),t.jsx("rect",{x:ue-3,y:Math.min(Ze,xt),width:6,height:Math.abs(xt-Ze)||1,fill:ne>=U?s.secondary:s.alert})]},ye)}return null})},Te)}),ie[0]&&ie[0].observations.slice().sort((se,Te)=>new Date(se.period).getTime()-new Date(Te.period).getTime()).map((se,Te,Me)=>{if(Te%Math.max(1,Math.floor(Me.length/6))!==0&&Te!==Me.length-1)return null;const Qe=Ie+ee*Te/(Me.length-1||1);return t.jsx("text",{x:Qe,y:qe-Oe+15,textAnchor:"middle",fill:s.textMuted,fontSize:"8",fontFamily:"monospace",children:se.period.substring(0,7)},Te)}),ie.map((se,Te)=>t.jsxs("g",{children:[t.jsx("rect",{x:Ie+Te*120,y:5,width:10,height:10,fill:se.color}),t.jsx("text",{x:Ie+Te*120+15,y:13,fill:s.text,fontSize:"9",fontFamily:"monospace",children:se.series_name.substring(0,12)})]},Te))]})};return t.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:s.background,color:s.text,fontFamily:"Consolas, monospace",fontSize:"11px",overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        /* Custom scrollbar styles */
        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        *::-webkit-scrollbar-track {
          background: #1a1a1a;
        }
        *::-webkit-scrollbar-thumb {
          background: colors.textMuted;
          border-radius: 4px;
        }
        *::-webkit-scrollbar-thumb:hover {
          background: #525252;
        }
      `}),t.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid colors.textMuted",display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap"},children:[t.jsx("span",{style:{color:s.primary,fontWeight:"bold"},children:"DBNOMICS TERMINAL"}),t.jsxs("span",{style:{color:s.secondary,fontSize:"10px"},children:[" ",k]}),t.jsxs("span",{style:{color:s.warning,fontSize:"10px"},children:["Providers: ",l.length]}),t.jsx("div",{style:{flex:1}}),t.jsx("button",{onClick:fe,disabled:R,style:{padding:"3px 10px",backgroundColor:"#2a2a2a",color:s.text,border:"1px solid colors.textMuted",cursor:R?"not-allowed":"pointer",fontSize:"9px"},children:"LOAD"}),t.jsxs("button",{onClick:()=>m&&Y(m.series_id,m.series_name),disabled:!m,style:{padding:"3px 10px",backgroundColor:"#2a2a2a",color:s.text,border:"1px solid colors.textMuted",cursor:m?"pointer":"not-allowed",fontSize:"9px"},children:[t.jsx(xn,{size:10,style:{display:"inline",marginRight:"4px"}}),"REFRESH"]}),t.jsxs("button",{onClick:Be,disabled:!m,style:{padding:"3px 10px",backgroundColor:"#2a2a2a",color:s.text,border:"1px solid colors.textMuted",cursor:m?"pointer":"not-allowed",fontSize:"9px"},children:[t.jsx(Mi,{size:10,style:{display:"inline",marginRight:"4px"}}),"EXPORT"]})]}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsx("div",{style:{width:"320px",borderRight:"1px solid colors.textMuted",display:"flex",flexDirection:"column",backgroundColor:s.panel},children:t.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",padding:"8px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"10px",marginBottom:"4px"},children:"1. PROVIDER"}),t.jsx("div",{style:{width:"100%",height:"140px",backgroundColor:"#1a1a1a",border:"1px solid colors.textMuted",marginBottom:"12px",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"colors.textMuted #1a1a1a"},children:l.map(ie=>t.jsxs("div",{onClick:()=>he(ie.code),style:{padding:"6px 8px",fontSize:"10px",color:w===ie.code?"#fff":s.text,backgroundColor:w===ie.code?s.primary:"transparent",cursor:"pointer",fontFamily:"Consolas, monospace",lineHeight:"1.4",wordWrap:"break-word",whiteSpace:"normal",borderBottom:"1px solid colors.panel"},onMouseEnter:ve=>{w!==ie.code&&(ve.currentTarget.style.backgroundColor="#2a2a2a")},onMouseLeave:ve=>{w!==ie.code&&(ve.currentTarget.style.backgroundColor="transparent")},children:[ie.code," - ",ie.name]},ie.code))}),t.jsx("div",{style:{color:s.primary,fontSize:"10px",marginBottom:"4px"},children:"2. DATASET"}),t.jsx("div",{style:{width:"100%",height:"140px",backgroundColor:"#1a1a1a",border:"1px solid colors.textMuted",marginBottom:"12px",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"colors.textMuted #1a1a1a"},children:p.map(ie=>t.jsxs("div",{onClick:()=>me(ie.code),style:{padding:"6px 8px",fontSize:"10px",color:C===ie.code?"#fff":s.text,backgroundColor:C===ie.code?s.primary:"transparent",cursor:"pointer",fontFamily:"Consolas, monospace",lineHeight:"1.4",wordWrap:"break-word",whiteSpace:"normal",borderBottom:"1px solid colors.panel"},onMouseEnter:ve=>{C!==ie.code&&(ve.currentTarget.style.backgroundColor="#2a2a2a")},onMouseLeave:ve=>{C!==ie.code&&(ve.currentTarget.style.backgroundColor="transparent")},children:[ie.code," - ",ie.name]},ie.code))}),t.jsx("div",{style:{color:s.primary,fontSize:"10px",marginBottom:"4px"},children:"3. SERIES"}),t.jsx("div",{style:{width:"100%",height:"140px",backgroundColor:"#1a1a1a",border:"1px solid colors.textMuted",marginBottom:"12px",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"colors.textMuted #1a1a1a"},children:h.map(ie=>t.jsxs("div",{onClick:()=>ge(ie),style:{padding:"6px 8px",fontSize:"10px",color:E===ie.full_id?"#fff":s.text,backgroundColor:E===ie.full_id?s.primary:"transparent",cursor:"pointer",fontFamily:"Consolas, monospace",lineHeight:"1.4",wordWrap:"break-word",whiteSpace:"normal",borderBottom:"1px solid colors.panel"},onMouseEnter:ve=>{E!==ie.full_id&&(ve.currentTarget.style.backgroundColor="#2a2a2a")},onMouseLeave:ve=>{E!==ie.full_id&&(ve.currentTarget.style.backgroundColor="transparent")},children:[ie.code," - ",ie.name]},ie.full_id))}),t.jsx("div",{style:{height:"1px",backgroundColor:s.textMuted,margin:"8px 0"}}),t.jsxs("div",{style:{display:"flex",gap:"4px",marginBottom:"8px"},children:[t.jsx("button",{onClick:je,disabled:!m,style:{flex:1,padding:"4px",backgroundColor:"#1a1a1a",color:s.text,border:"1px solid colors.textMuted",cursor:m?"pointer":"not-allowed",fontSize:"9px"},children:"ADD TO SINGLE"}),t.jsx("button",{onClick:Re,style:{padding:"4px 8px",backgroundColor:"#1a1a1a",color:s.alert,border:"1px solid colors.textMuted",cursor:"pointer",fontSize:"9px"},children:t.jsx(On,{size:10})})]}),t.jsxs("div",{style:{color:s.primary,fontSize:"10px",marginBottom:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{children:"COMPARISON SLOTS"}),t.jsx("button",{onClick:le,style:{padding:"2px 6px",backgroundColor:"#1a1a1a",color:s.secondary,border:"1px solid colors.textMuted",cursor:"pointer",fontSize:"9px"},children:t.jsx(wn,{size:10})})]}),t.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:P.map((ie,ve)=>t.jsxs("div",{style:{marginBottom:"6px",padding:"6px",backgroundColor:"#1a1a1a",border:"1px solid colors.textMuted",borderRadius:"2px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsxs("span",{style:{color:s.warning,fontSize:"9px"},children:["SLOT ",ve+1," (",ie.length,")"]}),t.jsxs("div",{style:{display:"flex",gap:"2px"},children:[t.jsx("button",{onClick:()=>V(ve),disabled:!m,style:{padding:"2px 4px",backgroundColor:s.panel,color:s.secondary,border:"1px solid colors.textMuted",cursor:m?"pointer":"not-allowed",fontSize:"8px"},children:t.jsx(wn,{size:8})}),P.length>1&&t.jsx("button",{onClick:()=>X(ve),style:{padding:"2px 4px",backgroundColor:s.panel,color:s.alert,border:"1px solid colors.textMuted",cursor:"pointer",fontSize:"8px"},children:t.jsx(Op,{size:8})})]})]}),ie.map((Ae,$e)=>t.jsxs("div",{style:{fontSize:"8px",color:s.textMuted,display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2px"},children:[t.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:Ae.series_name,children:Ae.series_name}),t.jsx("button",{onClick:()=>de(ve,$e),style:{padding:"1px 3px",backgroundColor:"transparent",color:s.alert,border:"none",cursor:"pointer",fontSize:"8px"},children:""})]},$e)),ie.length===0&&t.jsx("div",{style:{fontSize:"8px",color:s.textMuted,textAlign:"center"},children:"Empty"})]},ve))})]})}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid colors.textMuted",display:"flex",gap:"8px",alignItems:"center"},children:[t.jsx("button",{onClick:()=>F("single"),style:{padding:"4px 12px",backgroundColor:B==="single"?s.primary:"#2a2a2a",color:"#fff",border:"1px solid colors.textMuted",cursor:"pointer",fontSize:"10px"},children:"SINGLE"}),t.jsx("button",{onClick:()=>F("comparison"),style:{padding:"4px 12px",backgroundColor:B==="comparison"?s.primary:"#2a2a2a",color:"#fff",border:"1px solid colors.textMuted",cursor:"pointer",fontSize:"10px"},children:"COMPARE"}),B==="single"?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{color:s.textMuted,fontSize:"9px",marginLeft:"8px"},children:"Chart Type:"}),["line","bar","area","scatter","candlestick"].map(ie=>t.jsx("button",{onClick:()=>D(ie),style:{padding:"3px 8px",backgroundColor:W===ie?s.info:"#2a2a2a",color:"#fff",border:"1px solid colors.textMuted",cursor:"pointer",fontSize:"9px",textTransform:"uppercase"},children:ie},ie))]}):null]}),t.jsx("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:B==="single"?t.jsxs("div",{children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{color:s.primary,fontSize:"11px",marginBottom:"6px"},children:["SINGLE VIEW (",z.length," series)"]}),z.map((ie,ve)=>t.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"3px 6px",backgroundColor:"#1a1a1a",border:"1px solid colors.textMuted",borderRadius:"2px",marginRight:"4px",marginBottom:"4px",fontSize:"9px"},children:[t.jsx("div",{style:{width:"8px",height:"8px",backgroundColor:ie.color,borderRadius:"50%"}}),t.jsx("span",{children:ie.series_name.substring(0,20)}),t.jsx("button",{onClick:()=>_e(ve),style:{padding:"0 4px",backgroundColor:"transparent",color:s.alert,border:"none",cursor:"pointer",fontSize:"10px"},children:""})]},ve))]}),z.length>0?t.jsxs(t.Fragment,{children:[Se(z,W),t.jsxs("div",{style:{marginTop:"24px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"11px",marginBottom:"8px"},children:"DATA TABLE"}),t.jsx("div",{style:{overflowX:"auto",overflowY:"auto",maxHeight:"300px",border:"1px solid colors.textMuted",backgroundColor:s.panel},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[t.jsx("thead",{style:{position:"sticky",top:0,backgroundColor:"#1a1a1a",zIndex:1},children:t.jsxs("tr",{style:{borderBottom:"2px solid colors.textMuted"},children:[t.jsx("th",{style:{padding:"8px 12px",textAlign:"left",color:s.primary,fontWeight:"bold",whiteSpace:"nowrap"},children:"Period"}),z.map((ie,ve)=>t.jsx("th",{style:{padding:"8px 12px",textAlign:"right",fontWeight:"bold",whiteSpace:"nowrap"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"6px"},children:[t.jsx("div",{style:{width:"8px",height:"8px",backgroundColor:ie.color,borderRadius:"50%"}}),t.jsx("span",{style:{color:ie.color},children:ie.series_name.substring(0,25)})]})},ve))]})}),t.jsx("tbody",{children:Array.from(new Set(z.flatMap(ve=>ve.observations.map(Ae=>Ae.period)))).sort((ve,Ae)=>new Date(Ae).getTime()-new Date(ve).getTime()).slice(0,50).map((ve,Ae)=>t.jsxs("tr",{style:{borderBottom:"1px solid #1a1a1a"},children:[t.jsx("td",{style:{padding:"6px 12px",color:s.text,whiteSpace:"nowrap",fontWeight:"bold"},children:ve}),z.map(($e,qe)=>{const Ie=$e.observations.find(Ee=>Ee.period===ve),K=Ie?typeof Ie.value=="number"?Ie.value:Number(Ie.value):null;return t.jsx("td",{style:{padding:"6px 12px",textAlign:"right",color:K!==null?"#a3a3a3":s.textMuted,whiteSpace:"nowrap"},children:K!==null&&!isNaN(K)?K.toFixed(4):""},qe)})]},Ae))})]})}),t.jsx("div",{style:{color:s.textMuted,fontSize:"9px",marginTop:"6px",textAlign:"right"},children:"Showing latest 50 periods"})]})]}):t.jsx("div",{style:{color:s.textMuted,textAlign:"center",paddingTop:"40px"},children:"Add series to view"})]}):t.jsxs("div",{children:[t.jsx("div",{style:{color:s.primary,marginBottom:"12px",fontSize:"11px"},children:"COMPARISON DASHBOARD"}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(380px, 1fr))",gap:"16px"},children:P.map((ie,ve)=>t.jsxs("div",{style:{border:"1px solid colors.textMuted",padding:"12px",backgroundColor:s.panel,minHeight:"280px",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:s.warning,fontSize:"10px"},children:["SLOT ",ve+1]}),t.jsxs("select",{value:O[ve],onChange:Ae=>{const $e=[...O];$e[ve]=Ae.target.value,G($e)},style:{padding:"2px 4px",backgroundColor:"#1a1a1a",color:s.text,border:"1px solid colors.textMuted",fontSize:"8px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"line",children:"LINE"}),t.jsx("option",{value:"bar",children:"BAR"}),t.jsx("option",{value:"area",children:"AREA"}),t.jsx("option",{value:"scatter",children:"SCATTER"}),t.jsx("option",{value:"candlestick",children:"CANDLE"})]})]}),t.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",minHeight:"240px"},children:ie.length>0?Se(ie,O[ve],!0):t.jsx("div",{style:{color:s.textMuted,textAlign:"center",fontSize:"10px"},children:"Empty Slot"})})]},ve))})]})})]})]})]})}class YH{async getEconomicOverview(e,r,n){try{const i=await lt("get_bis_economic_overview",{countries:e||null,startPeriod:r||null,endPeriod:n||null});return JSON.parse(i)}catch(i){return console.error("Error fetching BIS economic overview:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async getCentralBankPolicyRates(e,r,n){try{const i=await lt("get_bis_central_bank_policy_rates",{countries:e||null,startPeriod:r||null,endPeriod:n||null});return JSON.parse(i)}catch(i){return console.error("Error fetching central bank policy rates:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async getEffectiveExchangeRates(e,r,n){try{const i=await lt("get_bis_effective_exchange_rates",{countries:e||null,startPeriod:r||null,endPeriod:n||null});return JSON.parse(i)}catch(i){return console.error("Error fetching effective exchange rates:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async getInterestRates(e,r,n,i){try{const a=await lt(e==="long_term"?"get_bis_long_term_interest_rates":"get_bis_short_term_interest_rates",{countries:r||null,startPeriod:n||null,endPeriod:i||null});return JSON.parse(a)}catch(o){return console.error(`Error fetching ${e} interest rates:`,o),{success:!1,error:o instanceof Error?o.message:String(o)}}}async getExchangeRates(e,r,n){try{const i=await lt("get_bis_exchange_rates",{currencyPairs:e||null,startPeriod:r||null,endPeriod:n||null});return JSON.parse(i)}catch(i){return console.error("Error fetching exchange rates:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async getCreditToNonFinancialSector(e,r,n,i){try{const o=await lt("get_bis_credit_to_non_financial_sector",{countries:e||null,sectors:r||null,startPeriod:n||null,endPeriod:i||null});return JSON.parse(o)}catch(o){return console.error("Error fetching credit data:",o),{success:!1,error:o instanceof Error?o.message:String(o)}}}async getHousePrices(e,r,n){try{const i=await lt("get_bis_house_prices",{countries:e||null,startPeriod:r||null,endPeriod:n||null});return JSON.parse(i)}catch(i){return console.error("Error fetching house prices:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async getAvailableDatasets(){try{const e=await lt("get_bis_available_datasets");return JSON.parse(e)}catch(e){return console.error("Error fetching available datasets:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}async searchDatasets(e){try{const r=await lt("search_bis_datasets",{query:e});return JSON.parse(r)}catch(r){return console.error("Error searching datasets:",r),{success:!1,error:r instanceof Error?r.message:String(r)}}}async getData(e,r,n,i){try{const o=await lt("get_bis_data",{flow:e,key:r||"all",startPeriod:n||null,endPeriod:i||null});return JSON.parse(o)}catch(o){return console.error("Error fetching BIS data:",o),{success:!1,error:o instanceof Error?o.message:String(o)}}}async getDatasetMetadata(e){try{const r=await lt("get_bis_dataset_metadata",{flow:e});return JSON.parse(r)}catch(r){return console.error("Error fetching dataset metadata:",r),{success:!1,error:r instanceof Error?r.message:String(r)}}}async getMonetaryPolicyOverview(e,r,n){try{const i=await lt("get_bis_monetary_policy_overview",{countries:e||null,startPeriod:r||null,endPeriod:n||null});return JSON.parse(i)}catch(i){return console.error("Error fetching monetary policy overview:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async executeCommand(e,r){try{const n=await lt("execute_bis_command",{command:e,args:r});return JSON.parse(n)}catch(n){return console.error("Error executing BIS command:",n),{success:!1,error:n instanceof Error?n.message:String(n)}}}}const f0=new YH;function KH(){const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState("econdb"),[l,d]=S.useState("indicator"),[p,f]=S.useState(!1),[h,x]=S.useState("Ready"),[m,b]=S.useState("GDP"),[w,y]=S.useState("US"),[C,T]=S.useState("level"),[E,j]=S.useState(null),[k,A]=S.useState("policy_rates"),[R,M]=S.useState(()=>{const _=new Date;return _.setFullYear(_.getFullYear()-1),_.toISOString().split("T")[0]}),[P,I]=S.useState(()=>new Date().toISOString().split("T")[0]),O=[{code:"US",name:"United States"},{code:"CN",name:"China"},{code:"JP",name:"Japan"},{code:"GB",name:"United Kingdom"},{code:"IN",name:"India"},{code:"BR",name:"Brazil"},{code:"CA",name:"Canada"},{code:"KR",name:"South Korea"},{code:"RU",name:"Russia"},{code:"AU",name:"Australia"},{code:"MX",name:"Mexico"},{code:"ID",name:"Indonesia"},{code:"SA",name:"Saudi Arabia"},{code:"TR",name:"Turkey"},{code:"CH",name:"Switzerland"},{code:"ZA",name:"South Africa"},{code:"AR",name:"Argentina"},{code:"SE",name:"Sweden"},{code:"NO",name:"Norway"},{code:"PL",name:"Poland"},{code:"TH",name:"Thailand"},{code:"MY",name:"Malaysia"},{code:"SG",name:"Singapore"},{code:"HK",name:"Hong Kong"},{code:"NZ",name:"New Zealand"}],[G,B]=S.useState("US"),[F,z]=S.useState(null),$=[{code:"GDP",name:"GDP (Nominal)",description:"Gross Domestic Product"},{code:"RGDP",name:"GDP (Real)",description:"Real GDP"},{code:"CPI",name:"CPI",description:"Consumer Price Index"},{code:"PPI",name:"PPI",description:"Producer Price Index"},{code:"CORE",name:"Core CPI",description:"Core Inflation"},{code:"URATE",name:"Unemployment",description:"Unemployment Rate"},{code:"EMP",name:"Employment",description:"Employment Level"},{code:"IP",name:"Industrial Production",description:"Industrial Production Index"},{code:"RETA",name:"Retail Sales",description:"Retail Sales"},{code:"CONF",name:"Consumer Confidence",description:"Consumer Confidence Index"},{code:"POLIR",name:"Policy Rate",description:"Policy Interest Rate"},{code:"Y10YD",name:"10Y Yield",description:"10-Year Government Bond Yield"},{code:"M3YD",name:"3M Yield",description:"3-Month Treasury Yield"},{code:"GDEBT",name:"Government Debt",description:"Government Debt"},{code:"CA",name:"Current Account",description:"Current Account Balance"},{code:"TB",name:"Trade Balance",description:"Trade Balance"},{code:"POP",name:"Population",description:"Total Population"}],W=[{code:"US",name:"United States"},{code:"CN",name:"China"},{code:"JP",name:"Japan"},{code:"DE",name:"Germany"},{code:"UK",name:"United Kingdom"},{code:"FR",name:"France"},{code:"IN",name:"India"},{code:"IT",name:"Italy"},{code:"BR",name:"Brazil"},{code:"CA",name:"Canada"},{code:"KR",name:"South Korea"},{code:"RU",name:"Russia"},{code:"AU",name:"Australia"},{code:"ES",name:"Spain"},{code:"MX",name:"Mexico"},{code:"ID",name:"Indonesia"},{code:"NL",name:"Netherlands"},{code:"SA",name:"Saudi Arabia"},{code:"TR",name:"Turkey"},{code:"CH",name:"Switzerland"}],D=[{code:"level",name:"Level",description:"No transformation"},{code:"toya",name:"YoY %",description:"Year-over-year change"},{code:"tpop",name:"QoQ %",description:"Quarter-over-quarter change"},{code:"tusd",name:"USD",description:"Convert to USD"},{code:"tpgp",name:"% of GDP",description:"As percent of GDP"}],oe=async()=>{f(!0),x(`Fetching data for ${w}...`);try{if(o==="bis"){let _;const he={policy_rates:{flow:"WS_CBPOL",freq:"D"},effective_exchange:{flow:"WS_EER",freq:"M"},property_prices:{flow:"WS_SPP",freq:"Q"},total_credit:{flow:"WS_TC",freq:"Q"},consumer_prices:{flow:"WS_LONG_CPI",freq:"M"},credit_gap:{flow:"WS_CREDIT_GAP",freq:"Q"},debt_service:{flow:"WS_DSR",freq:"Q"},cb_assets:{flow:"WS_CBTA",freq:"M"}}[k];if(k==="policy_rates"?_=await f0.getCentralBankPolicyRates([w],R,P):k==="effective_exchange"?_=await f0.getEffectiveExchangeRates([w],R,P):_=await f0.getData(he.flow,`${he.freq}.${w}`,R,P),_.success&&_.data){let me=[];try{const ge=_.data.data?.dataSets||[];if(ge.length>0){const le=ge[0],X=le.series,V=Object.keys(X||{})[0];if(V&&X[V]){const de=X[V].observations,_e=_.data.structure?.dimensions?.observation?.find(Re=>Re.id==="TIME_PERIOD")?.values||[];me=Object.entries(de||{}).map(([Re,Be])=>{const Se=parseInt(Re);let ie;if(_e.length>Se)ie=_e[Se].id||_e[Se].name;else{const Ae=le.reportingBegin||"2020-01-01",$e=new Date(Ae.split("T")[0]),qe=new Date($e);qe.setDate(qe.getDate()+Se),ie=qe.toISOString().split("T")[0]}const ve=Array.isArray(Be)?parseFloat(Be[0]):parseFloat(Be);return{date:ie,value:isNaN(ve)?0:ve}})}}}catch(ge){console.error("Error parsing BIS data:",ge),x(`Error parsing BIS data: ${ge}`);return}if(me.length===0){x("No observations found in BIS data");return}j({indicator:k,country:w,transform:"level",observations:me,observation_count:me.length,metadata:_.data}),x(`Loaded ${me.length} observations from BIS`)}else x(`Error: ${_.error||"Failed to fetch BIS data"}`)}else{const _=await lt("execute_python_script",{scriptName:"econdb_data.py",args:["indicator",m,w,"","",C]}),Y=JSON.parse(_);Y.error?x(`Error: ${Y.error}`):(j(Y),x(`Loaded ${Y.observation_count} observations from EconDB`))}}catch(_){x(`Error: ${_}`)}finally{f(!1)}},Z=async()=>{f(!0),x(`Fetching profile for ${G}...`);try{const _=await lt("execute_python_script",{scriptName:"econdb_data.py",args:["profile",G,"true"]}),Y=JSON.parse(_);Y.error?x(`Error: ${Y.error}`):(z(Y),x(`Profile loaded for ${G}`))}catch(_){x(`Error: ${_}`)}finally{f(!1)}},fe=()=>{if(!E)return;const _=["Date,Value",...E.observations.map(ge=>`${ge.date},${ge.value}`)].join(`
`),Y=new Blob([_],{type:"text/csv"}),he=URL.createObjectURL(Y),me=document.createElement("a");me.href=he,me.download=`econdb_${m}_${w}_${Date.now()}.csv`,me.click(),URL.revokeObjectURL(he),x("Data exported")},Q=_=>{if(_.length===0)return null;const Y=800,he=300,me=70,ge=20,le=20,X=50,V=Y-me-ge,de=he-le-X,je=_.map(Se=>Se.value),_e=Math.min(...je)*.95,Be=Math.max(...je)*1.05-_e;return t.jsxs("svg",{width:Y,height:he,style:{backgroundColor:"colors.panel",width:"100%",height:"auto"},children:[t.jsx("line",{x1:me,y1:le,x2:me,y2:he-X,stroke:"#404040",strokeWidth:"1"}),t.jsx("line",{x1:me,y1:he-X,x2:Y-ge,y2:he-X,stroke:"#404040",strokeWidth:"1"}),[0,1,2,3,4].map(Se=>{const ie=_e+Be*Se/4,ve=he-X-de*Se/4;return t.jsxs("g",{children:[t.jsx("line",{x1:me,y1:ve,x2:Y-ge,y2:ve,stroke:"#1a1a1a",strokeDasharray:"2,2"}),t.jsx("text",{x:me-10,y:ve+4,textAnchor:"end",fill:"#737373",fontSize:"10",fontFamily:"monospace",children:ie.toFixed(2)})]},Se)}),_.map((Se,ie)=>{const ve=me+V*ie/(_.length-1||1),Ae=he-X-de*((Se.value-_e)/Be);return t.jsxs("g",{children:[t.jsx("circle",{cx:ve,cy:Ae,r:"3",fill:"#ea580c"}),ie<_.length-1&&t.jsx("line",{x1:ve,y1:Ae,x2:me+V*(ie+1)/(_.length-1||1),y2:he-X-de*((_[ie+1].value-_e)/Be),stroke:"#ea580c",strokeWidth:"2"})]},ie)}),_.map((Se,ie)=>{if(ie%Math.max(1,Math.floor(_.length/8))!==0&&ie!==_.length-1)return null;const ve=me+V*ie/(_.length-1||1);return t.jsx("text",{x:ve,y:he-X+20,textAnchor:"middle",fill:"#737373",fontSize:"9",fontFamily:"monospace",children:Se.date.substring(0,10)},ie)})]})};return t.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"colors.background",color:"#d4d4d4",fontFamily:"Consolas, monospace",fontSize:"11px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #404040",display:"flex",alignItems:"center",gap:"12px",flexShrink:0},children:[t.jsxs("span",{style:{color:"#ea580c",fontWeight:"bold"},children:["ECONOMICS - ",o.toUpperCase()]}),t.jsxs("span",{style:{color:"#10b981",fontSize:"10px"},children:[" ",h]}),t.jsx("div",{style:{flex:1}}),t.jsxs("div",{style:{display:"flex",gap:"4px",marginRight:"12px"},children:[t.jsx("button",{onClick:()=>a("econdb"),style:{padding:"4px 8px",backgroundColor:o==="econdb"?"#3b82f6":"#2d2d2d",color:s.text,border:"none",cursor:"pointer",fontSize:"9px",borderRadius:"2px"},children:"EconDB"}),t.jsx("button",{onClick:()=>a("bis"),style:{padding:"4px 8px",backgroundColor:o==="bis"?"#3b82f6":"#2d2d2d",color:s.text,border:"none",cursor:"pointer",fontSize:"9px",borderRadius:"2px"},children:"BIS"})]}),t.jsxs("button",{onClick:()=>d("indicator"),style:{padding:"4px 10px",backgroundColor:l==="indicator"?"#ea580c":"#2d2d2d",color:"colors.text",border:"none",cursor:"pointer",fontSize:"9px"},children:[t.jsx(ja,{size:10,style:{display:"inline",marginRight:"4px"}}),"INDICATOR"]}),t.jsxs("button",{onClick:()=>d("profile"),style:{padding:"4px 10px",backgroundColor:l==="profile"?"#ea580c":"#2d2d2d",color:"colors.text",border:"none",cursor:"pointer",fontSize:"9px"},children:[t.jsx(Jg,{size:10,style:{display:"inline",marginRight:"4px"}}),"PROFILE"]}),t.jsxs("button",{onClick:()=>d("countries"),style:{padding:"4px 10px",backgroundColor:l==="countries"?"#ea580c":"#2d2d2d",color:"colors.text",border:"none",cursor:"pointer",fontSize:"9px"},children:[t.jsx(fc,{size:10,style:{display:"inline",marginRight:"4px"}}),"COUNTRIES"]})]}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsxs("div",{style:{width:"300px",borderRight:"1px solid #404040",display:"flex",flexDirection:"column",backgroundColor:"colors.panel",overflowY:"auto"},children:[l==="indicator"&&t.jsxs("div",{style:{padding:"12px"},children:[o==="bis"?t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"BIS DATA TYPE"}),t.jsxs("select",{value:k,onChange:_=>A(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"12px",fontSize:"10px"},children:[t.jsxs("optgroup",{label:"Interest Rates & FX",children:[t.jsx("option",{value:"policy_rates",children:"Central Bank Policy Rates (Daily)"}),t.jsx("option",{value:"effective_exchange",children:"Effective Exchange Rates (Monthly)"})]}),t.jsxs("optgroup",{label:"Property & Credit",children:[t.jsx("option",{value:"property_prices",children:"Property Prices (Quarterly)"}),t.jsx("option",{value:"total_credit",children:"Total Credit (Quarterly)"}),t.jsx("option",{value:"credit_gap",children:"Credit-to-GDP Gaps (Quarterly)"}),t.jsx("option",{value:"debt_service",children:"Debt Service Ratios (Quarterly)"})]}),t.jsxs("optgroup",{label:"Other Indicators",children:[t.jsx("option",{value:"consumer_prices",children:"Consumer Prices (Monthly)"}),t.jsx("option",{value:"cb_assets",children:"Central Bank Assets (Monthly)"})]})]}),t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"COUNTRY (G20 + Major Economies)"}),t.jsx("select",{value:w,onChange:_=>y(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"12px",fontSize:"10px"},children:O.map(_=>t.jsx("option",{value:_.code,children:_.name},_.code))}),t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"START DATE"}),t.jsx("input",{type:"date",value:R,onChange:_=>M(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"12px",fontSize:"10px"}}),t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"END DATE"}),t.jsx("input",{type:"date",value:P,onChange:_=>I(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"12px",fontSize:"10px"}}),t.jsxs("div",{style:{padding:"8px",backgroundColor:"#1a1a1a",border:"1px solid #404040",fontSize:"9px",marginBottom:"12px"},children:[t.jsx("div",{style:{color:"#3b82f6",marginBottom:"4px"},children:" BIS Data Info"}),t.jsx("div",{style:{color:"#737373",lineHeight:"1.4"},children:"Limit date range to avoid slow loading. Recommended: 1-2 years max."})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"INDICATOR"}),t.jsx("select",{value:m,onChange:_=>b(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"12px",fontSize:"10px"},children:$.map(_=>t.jsx("option",{value:_.code,children:_.name},_.code))}),t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"COUNTRY"}),t.jsx("select",{value:w,onChange:_=>y(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"12px",fontSize:"10px"},children:W.map(_=>t.jsx("option",{value:_.code,children:_.name},_.code))}),t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"TRANSFORM"}),t.jsx("select",{value:C,onChange:_=>T(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"16px",fontSize:"10px"},children:D.map(_=>t.jsx("option",{value:_.code,children:_.name},_.code))})]}),t.jsx("button",{onClick:oe,disabled:p,style:{width:"100%",padding:"8px",backgroundColor:"#ea580c",color:"colors.text",border:"none",cursor:p?"not-allowed":"pointer",fontSize:"10px",marginBottom:"8px"},children:p?"Loading...":"FETCH DATA"}),t.jsxs("button",{onClick:fe,disabled:!E,style:{width:"100%",padding:"8px",backgroundColor:"#2d2d2d",color:"#d4d4d4",border:"1px solid #404040",cursor:E?"pointer":"not-allowed",fontSize:"10px"},children:[t.jsx(Mi,{size:10,style:{display:"inline",marginRight:"4px"}}),"EXPORT CSV"]}),E&&t.jsxs("div",{style:{marginTop:"16px",padding:"8px",backgroundColor:"#1a1a1a",border:"1px solid #404040",fontSize:"9px"},children:[t.jsx("div",{style:{color:"#fbbf24",marginBottom:"4px"},children:"METADATA"}),t.jsxs("div",{style:{color:"#737373"},children:["Country: ",E.country]}),t.jsxs("div",{style:{color:"#737373"},children:["Indicator: ",E.indicator]}),t.jsxs("div",{style:{color:"#737373"},children:["Transform: ",E.transform]}),t.jsxs("div",{style:{color:"#737373"},children:["Points: ",E.observation_count]})]})]}),l==="profile"&&t.jsxs("div",{style:{padding:"12px"},children:[t.jsx("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:"SELECT COUNTRY"}),t.jsx("select",{value:G,onChange:_=>B(_.target.value),style:{width:"100%",padding:"6px",backgroundColor:"#1a1a1a",color:"#d4d4d4",border:"1px solid #404040",marginBottom:"16px",fontSize:"10px"},children:W.map(_=>t.jsx("option",{value:_.code,children:_.name},_.code))}),t.jsx("button",{onClick:Z,disabled:p,style:{width:"100%",padding:"8px",backgroundColor:"#ea580c",color:"colors.text",border:"none",cursor:p?"not-allowed":"pointer",fontSize:"10px"},children:p?"Loading...":"LOAD PROFILE"})]}),l==="countries"&&t.jsxs("div",{style:{padding:"12px"},children:[t.jsxs("div",{style:{color:"#ea580c",fontSize:"10px",marginBottom:"8px"},children:["AVAILABLE COUNTRIES (",W.length,")"]}),W.map(_=>t.jsxs("div",{style:{padding:"6px 8px",backgroundColor:"#1a1a1a",border:"1px solid #404040",marginBottom:"4px",fontSize:"10px"},children:[t.jsx("span",{style:{color:"#fbbf24"},children:_.code})," - ",_.name]},_.code))]})]}),t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"16px"},children:[l==="indicator"&&E&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("div",{style:{color:"#ea580c",fontSize:"12px",marginBottom:"8px"},children:E.metadata.description||E.indicator}),t.jsxs("div",{style:{color:"#737373",fontSize:"10px"},children:[E.country,"  ",E.observation_count," observations"]})]}),Q(E.observations),t.jsxs("div",{style:{marginTop:"24px"},children:[t.jsx("div",{style:{color:"#ea580c",fontSize:"11px",marginBottom:"8px"},children:"DATA TABLE"}),t.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #404040",backgroundColor:"colors.panel"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[t.jsx("thead",{style:{position:"sticky",top:0,backgroundColor:"#1a1a1a"},children:t.jsxs("tr",{children:[t.jsx("th",{style:{padding:"8px",textAlign:"left",color:"#ea580c",borderBottom:"2px solid #404040"},children:"Date"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:"#ea580c",borderBottom:"2px solid #404040"},children:"Value"})]})}),t.jsx("tbody",{children:E.observations.slice().reverse().map((_,Y)=>t.jsxs("tr",{style:{borderBottom:"1px solid #1a1a1a"},children:[t.jsx("td",{style:{padding:"6px 8px",color:"#d4d4d4"},children:_.date}),t.jsx("td",{style:{padding:"6px 8px",textAlign:"right",color:"#a3a3a3"},children:_.value.toFixed(4)})]},Y))})]})})]})]}),l==="profile"&&F&&t.jsxs("div",{children:[t.jsxs("div",{style:{color:"#ea580c",fontSize:"12px",marginBottom:"16px"},children:["ECONOMIC PROFILE - ",F.country]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"12px"},children:Object.entries(F.indicators).map(([_,Y])=>t.jsxs("div",{style:{padding:"12px",backgroundColor:"colors.panel",border:"1px solid #404040"},children:[t.jsx("div",{style:{color:"#fbbf24",fontSize:"10px",marginBottom:"8px"},children:_}),t.jsx("div",{style:{color:"colors.text",fontSize:"20px",fontWeight:"bold",marginBottom:"4px"},children:typeof Y.value=="number"?Y.value.toFixed(4):Y.value}),t.jsx("div",{style:{color:"#737373",fontSize:"9px"},children:Y.date})]},_))})]}),!E&&!F&&l!=="countries"&&t.jsxs("div",{style:{textAlign:"center",color:"#737373",paddingTop:"80px"},children:[t.jsx(Nr,{size:48,style:{margin:"0 auto 16px",opacity:.3}}),t.jsx("div",{children:"Select parameters and fetch data to begin"})]})]})})]})]})}class VH{constructor(){Pe(this,"db",null);Pe(this,"isInitialized",!1)}async initialize(){if(!this.isInitialized)try{this.db=await Gg.load("sqlite:notebooks.db"),await this.db.execute(`
        CREATE TABLE IF NOT EXISTS notebook_history (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          name TEXT NOT NULL,
          content TEXT NOT NULL,
          path TEXT,
          created_at TEXT NOT NULL,
          updated_at TEXT NOT NULL,
          cell_count INTEGER DEFAULT 0,
          execution_count INTEGER DEFAULT 0
        )
      `),await this.db.execute(`
        CREATE INDEX IF NOT EXISTS idx_notebook_updated
        ON notebook_history(updated_at DESC)
      `),this.isInitialized=!0,fa.info("Notebook service initialized successfully")}catch(e){throw fa.error("Failed to initialize notebook service:",e),e}}async saveToHistory(e){await this.initialize();try{return(await this.db.execute(`INSERT INTO notebook_history
         (name, content, path, created_at, updated_at, cell_count, execution_count)
         VALUES (?, ?, ?, ?, ?, ?, ?)`,[e.name,e.content,e.path,e.created_at,e.updated_at,e.cell_count,e.execution_count])).lastInsertId||0}catch(r){throw fa.error("Failed to save notebook to history:",r),r}}async updateHistory(e,r){await this.initialize();try{const n=[],i=[];r.name!==void 0&&(n.push("name = ?"),i.push(r.name)),r.content!==void 0&&(n.push("content = ?"),i.push(r.content)),r.path!==void 0&&(n.push("path = ?"),i.push(r.path)),r.cell_count!==void 0&&(n.push("cell_count = ?"),i.push(r.cell_count)),r.execution_count!==void 0&&(n.push("execution_count = ?"),i.push(r.execution_count)),n.push("updated_at = ?"),i.push(new Date().toISOString()),i.push(e),await this.db.execute(`UPDATE notebook_history SET ${n.join(", ")} WHERE id = ?`,i)}catch(n){throw fa.error("Failed to update notebook history:",n),n}}async getHistory(e=50){await this.initialize();try{return await this.db.select(`SELECT * FROM notebook_history
         ORDER BY updated_at DESC
         LIMIT ?`,[e])}catch(r){return fa.error("Failed to get notebook history:",r),[]}}async getNotebookById(e){await this.initialize();try{const r=await this.db.select("SELECT * FROM notebook_history WHERE id = ?",[e]);return r.length>0?r[0]:null}catch(r){return fa.error("Failed to get notebook by ID:",r),null}}async deleteFromHistory(e){await this.initialize();try{await this.db.execute("DELETE FROM notebook_history WHERE id = ?",[e])}catch(r){throw fa.error("Failed to delete notebook from history:",r),r}}async searchHistory(e){await this.initialize();try{return await this.db.select(`SELECT * FROM notebook_history
         WHERE name LIKE ? OR path LIKE ?
         ORDER BY updated_at DESC
         LIMIT 50`,[`%${e}%`,`%${e}%`])}catch(r){return fa.error("Failed to search notebook history:",r),[]}}async clearHistory(){await this.initialize();try{await this.db.execute("DELETE FROM notebook_history")}catch(e){throw fa.error("Failed to clear notebook history:",e),e}}}const ad=new VH;function XH(){const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState("code"),[l,d]=S.useState([{id:"1",name:"strategy.fincept",content:`// FinScript - Financial Analysis Language
// Example: EMA/WMA Crossover Strategy

// Calculate technical indicators
ema_fast = ema(AAPL, 21)
wma_slow = wma(AAPL, 50)
rsi_value = rsi(AAPL, 14)

// Get last values for comparison
ema_current = last(ema_fast)
wma_current = last(wma_slow)
rsi_current = last(rsi_value)

// EMA/WMA Crossover Strategy
if ema_current > wma_current {
    buy "EMA 21 crosses above WMA 50 - Bullish Signal"
}

if ema_current < wma_current {
    sell "EMA 21 crosses below WMA 50 - Bearish Signal"
}

// RSI Overbought/Oversold Strategy
if rsi_current > 70 {
    sell "RSI Overbought - Consider Selling"
}

if rsi_current < 30 {
    buy "RSI Oversold - Consider Buying"
}

// Plot indicators
plot ema(AAPL, 7), "EMA (7)"
plot ema_fast, "EMA (21)"
plot wma_slow, "WMA (50)"
plot rsi_value, "RSI (14)"
plot_candlestick AAPL, "Apple Stock Chart"`,language:"finscript",unsaved:!1}]),[p,f]=S.useState("1"),[h,x]=S.useState([]),[m,b]=S.useState(!1),[w,y]=S.useState([]),[C,T]=S.useState(null),[E,j]=S.useState(null),[k,A]=S.useState(1),[R,M]=S.useState("Loading..."),[P,I]=S.useState([]),[O,G]=S.useState(!1),[B,F]=S.useState(""),[z,$]=S.useState(!1),[W,D]=S.useState([]),[oe,Z]=S.useState(""),[fe,Q]=S.useState(!1),_=S.useRef(null),Y={ORANGE:s.primary,WHITE:s.text,GREEN:s.secondary,RED:s.alert,YELLOW:s.warning,BLUE:s.info,CYAN:s.accent,GRAY:s.textMuted,DARK_BG:s.background,PANEL_BG:s.panel,EDITOR_BG:s.panel},he=l.find(ye=>ye.id===p)||l[0];S.useEffect(()=>{o==="notebook"&&(de(),me())},[o]);const me=async()=>{Q(!0);try{const ye=await ad.getHistory(50);D(ye)}catch(ye){console.error("Failed to load history:",ye)}finally{Q(!1)}},ge=async ye=>{if(!ye.trim()){me();return}Q(!0);try{const ue=await ad.searchHistory(ye);D(ue)}catch(ue){console.error("Failed to search history:",ue)}finally{Q(!1)}},le=async()=>{try{const ye=JSON.stringify({cells:w,metadata:{kernelspec:{displayName:"Python 3",language:"python",name:"python3"},languageInfo:{name:"python",version:"3.12.0",mimetype:"text/x-python",fileExtension:".py"}},nbformat:4,nbformatMinor:5}),ue={name:C&&C.split(/[/\\]/).pop()||"Untitled",content:ye,path:C,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),cell_count:w.length,execution_count:k-1};if(E)await ad.updateHistory(E,ue);else{const re=await ad.saveToHistory(ue);j(re)}await me()}catch(ye){console.error("Failed to save to history:",ye)}},X=async ye=>{try{const ue=await ad.getNotebookById(ye);if(!ue)return;const re=JSON.parse(ue.content);y(re.cells),T(ue.path),j(ye);const ke=Math.max(...re.cells.map(Ne=>Ne.executionCount||0).filter(Ne=>Ne>0),0);A(ke+1),x([...h,{output:`Loaded from history: ${ue.name}`,timestamp:new Date}])}catch(ue){x([...h,{output:`Failed to load from history: ${ue}`,error:String(ue),timestamp:new Date}])}},V=async ye=>{try{await ad.deleteFromHistory(ye),await me(),E===ye&&j(null)}catch(ue){console.error("Failed to delete from history:",ue)}},de=async()=>{try{const ye=await lt("get_python_version");M(ye)}catch(ye){M("Error loading Python version"),console.error("Failed to get Python version:",ye)}},je=async()=>{try{const ye=await lt("list_python_packages");I(ye)}catch(ye){console.error("Failed to load packages:",ye)}},_e=async()=>{if(B.trim())try{x([...h,{output:`Installing package: ${B}...`,timestamp:new Date}]);const ye=await lt("install_python_package",{packageName:B.trim()});x([...h,{output:ye,timestamp:new Date}]),F(""),je()}catch(ye){x([...h,{output:`Failed to install package: ${ye}`,error:String(ye),timestamp:new Date}])}},Re=ye=>{d(l.map(ue=>ue.id===p?{...ue,content:ye,unsaved:!0}:ue))},Be=()=>{d(l.map(ye=>ye.id===p?{...ye,unsaved:!1}:ye)),x([...h,{output:`File '${he.name}' saved successfully`,timestamp:new Date}])},Se=()=>{const ye=Date.now().toString(),ue={id:ye,name:`untitled-${l.length+1}.fincept`,content:`// New FinScript file
`,language:"finscript",unsaved:!1};d([...l,ue]),f(ye)},ie=ye=>{if(l.length===1)return;const ue=l.filter(re=>re.id!==ye);d(ue),p===ye&&f(ue[0].id)},ve=async()=>{b(!0),x([...h,{output:`Executing FinScript: ${he.name}...`,timestamp:new Date}]);try{const ye=await lt("execute_finscript",{code:he.content});let ue=`
=== FinScript Execution Results ===
File: ${he.name}
Status: ${ye.success?"Completed Successfully":"Failed"}
Execution Time: ${ye.execution_time_ms}ms

${ye.output}

`;ye.signals.length>0&&(ue+=`
Signals Generated:
`,ye.signals.forEach(re=>{const ke=re.signal_type==="Buy"?" BUY":" SELL";ue+=`  ${ke}: ${re.message}
`})),ye.plots.length>0&&(ue+=`
Plots Generated:
`,ye.plots.forEach(re=>{ue+=`   ${re.plot_type}: ${re.label} (${re.data.length} data points)
`})),ye.errors.length>0&&(ue+=`
Errors:
`,ye.errors.forEach(re=>{ue+=`   ${re}
`})),x([...h,{output:ue,error:ye.errors.length>0?ye.errors.join(`
`):void 0,timestamp:new Date}]),b(!1)}catch(ye){x([...h,{output:`Execution failed: ${ye}`,error:String(ye),timestamp:new Date}]),b(!1)}},Ae=()=>{he.language==="finscript"?ve():he.language==="python"&&$e(he.content)},$e=async ye=>{b(!0),x([...h,{output:"Executing Python code...",timestamp:new Date}]);try{const ue=await lt("execute_python_code",{code:ye,executionCount:k}),re=ue.outputs.map(ke=>ke.text?ke.text.join(`
`):ke.traceback?ke.traceback.join(`
`):"").join(`
`);x([...h,{output:re||"Code executed successfully (no output)",error:ue.error,timestamp:new Date}]),b(!1)}catch(ue){x([...h,{output:`Execution failed: ${ue}`,error:String(ue),timestamp:new Date}]),b(!1)}},qe=()=>x([]),Ie=ye=>{switch(ye){case"finscript":return Y.ORANGE;case"python":return Y.BLUE;case"javascript":return Y.YELLOW;default:return Y.GRAY}},K=async()=>{try{w.length>0&&await le();const ye=await lt("create_new_notebook");y(ye.cells),T(null),j(null),A(1),x([...h,{output:"Created new notebook",timestamp:new Date}])}catch(ye){console.error("Failed to create notebook:",ye)}},Ee=async()=>{try{w.length>0&&await le();const ye=await I0({multiple:!1,filters:[{name:"Jupyter Notebook",extensions:["ipynb"]}]});if(!ye)return;const ue=ye,re=await lt("open_notebook",{filePath:ue});y(re.cells),T(ue),j(null);const ke=Math.max(...re.cells.map(Ne=>Ne.executionCount||0).filter(Ne=>Ne>0),0);A(ke+1),await le(),x([...h,{output:`Notebook opened: ${ue}`,timestamp:new Date}])}catch(ye){x([...h,{output:`Failed to open notebook: ${ye}`,error:String(ye),timestamp:new Date}])}},Oe=async()=>{try{let ye=C;if(!ye){const re=await P0({filters:[{name:"Jupyter Notebook",extensions:["ipynb"]}]});if(!re)return;ye=re}await lt("save_notebook",{filePath:ye,notebook:{cells:w,metadata:{kernelspec:{displayName:"Python 3",language:"python",name:"python3"},languageInfo:{name:"python",version:"3.12.0",mimetype:"text/x-python",fileExtension:".py"}},nbformat:4,nbformatMinor:5}}),T(ye),await le(),x([...h,{output:`Notebook saved: ${ye}`,timestamp:new Date}])}catch(ye){x([...h,{output:`Failed to save notebook: ${ye}`,error:String(ye),timestamp:new Date}])}},q=ye=>{const ue={id:`cell-${Date.now()}`,cellType:"code",source:[],outputs:[],executionCount:null,metadata:{}};if(ye!==void 0){const re=[...w];re.splice(ye+1,0,ue),y(re)}else y([...w,ue])},ee=ye=>{w.length!==1&&y(w.filter((ue,re)=>re!==ye))},ce=ye=>{if(ye===0)return;const ue=[...w];[ue[ye-1],ue[ye]]=[ue[ye],ue[ye-1]],y(ue)},Ce=ye=>{if(ye===w.length-1)return;const ue=[...w];[ue[ye],ue[ye+1]]=[ue[ye+1],ue[ye]],y(ue)},be=(ye,ue)=>{const re=[...w];re[ye].source=ue.split(`
`),y(re)},We=ye=>{const ue=[...w];ue[ye].cellType=ue[ye].cellType==="code"?"markdown":"code",y(ue)},J=async ye=>{const ue=w[ye];if(ue.cellType!=="code")return;const re=ue.source.join(`
`);if(re.trim())try{const ke=await lt("execute_python_code",{code:re,executionCount:k}),Ne=[...w];Ne[ye].outputs=ke.outputs,Ne[ye].executionCount=ke.executionCount,y(Ne),A(k+1)}catch(ke){const Ne={outputType:"error",ename:"ExecutionError",evalue:String(ke),traceback:[String(ke)]},U=[...w];U[ye].outputs=[Ne],U[ye].executionCount=k,y(U),A(k+1)}},se=async()=>{for(let ye=0;ye<w.length;ye++)w[ye].cellType==="code"&&await J(ye)},Te=ye=>{const ue=[...w];ue[ye].outputs=[],ue[ye].executionCount=null,y(ue)},Me=ye=>!ye||ye.length===0?t.jsx("div",{style:{color:Y.GRAY,fontSize:"11px",fontStyle:"italic"},children:"Execute cell to see output"}):ye.map((ue,re)=>{if(ue.outputType==="stream")return t.jsx("div",{style:{color:Y.GREEN,fontSize:"12px",whiteSpace:"pre-wrap"},children:ue.text?.join(`
`)},re);if(ue.outputType==="error")return t.jsxs("div",{style:{color:Y.RED,fontSize:"12px",whiteSpace:"pre-wrap"},children:[t.jsxs("div",{style:{fontWeight:"bold"},children:[ue.ename,": ",ue.evalue]}),ue.traceback&&t.jsx("div",{children:ue.traceback.join(`
`)})]},re);if((ue.outputType==="execute_result"||ue.outputType==="display_data")&&ue.data){if(ue.data["text/plain"])return t.jsx("div",{style:{color:Y.CYAN,fontSize:"12px",whiteSpace:"pre-wrap"},children:ue.data["text/plain"].join(`
`)},re);if(ue.data["text/html"])return t.jsx("div",{dangerouslySetInnerHTML:{__html:ue.data["text/html"].join("")}},re);if(ue.data["image/png"])return t.jsx("img",{src:`data:image/png;base64,${ue.data["image/png"][0]}`,alt:"Output",style:{maxWidth:"100%"}},re)}return null});S.useEffect(()=>{o==="notebook"&&w.length===0&&K()},[o]);const Qe=ye=>{const ue=new Date(ye),ke=new Date().getTime()-ue.getTime(),Ne=Math.floor(ke/(1e3*60*60));return Ne<1?`${Math.floor(ke/6e4)}m ago`:Ne<24?`${Ne}h ago`:`${Math.floor(Ne/24)}d ago`};return t.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:Y.DARK_BG,color:Y.WHITE,fontFamily:"Consolas, monospace",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        .code-scroll::-webkit-scrollbar { width: 8px; height: 8px; }
        .code-scroll::-webkit-scrollbar-track { background: #1a1a1a; }
        .code-scroll::-webkit-scrollbar-thumb { background: #404040; border-radius: 4px; }
        .code-scroll::-webkit-scrollbar-thumb:hover { background: #525252; }

        .code-editor {
          font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
          font-size: 14px;
          line-height: 1.6;
          tab-size: 4;
        }

        .line-numbers {
          background: #0a0a0a;
          color: #787878;
          padding: 12px 8px;
          text-align: right;
          font-size: 13px;
          user-select: none;
          border-right: 1px solid #404040;
        }

        .cell-actions {
          opacity: 0;
          transition: opacity 0.2s;
        }

        .notebook-cell:hover .cell-actions {
          opacity: 1;
        }

        .history-item:hover {
          background-color: #2a2a2a;
        }
      `}),t.jsx("div",{style:{backgroundColor:Y.PANEL_BG,borderBottom:`2px solid ${Y.GRAY}`,padding:"8px 16px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:Y.ORANGE,fontWeight:"bold",fontSize:"16px"},children:"CODE EDITOR"}),t.jsx("span",{style:{color:Y.GRAY},children:"|"}),t.jsx("button",{onClick:()=>a("code"),style:{padding:"4px 12px",backgroundColor:o==="code"?Y.ORANGE:Y.DARK_BG,border:`2px solid ${Y.GRAY}`,color:o==="code"?Y.DARK_BG:Y.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"FINSCRIPT EDITOR"}),t.jsx("button",{onClick:()=>a("notebook"),style:{padding:"4px 12px",backgroundColor:o==="notebook"?Y.ORANGE:Y.DARK_BG,border:`2px solid ${Y.GRAY}`,color:o==="notebook"?Y.DARK_BG:Y.WHITE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"JUPYTER NOTEBOOK"}),o==="notebook"&&t.jsxs(t.Fragment,{children:[t.jsx("span",{style:{color:Y.GRAY},children:"|"}),t.jsx("span",{style:{color:Y.CYAN,fontSize:"10px"},children:R})]})]}),t.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:o==="code"?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:Se,style:{padding:"6px 12px",backgroundColor:Y.DARK_BG,border:`2px solid ${Y.GREEN}`,color:Y.GREEN,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(wn,{size:14,style:{display:"inline",marginRight:"4px"}}),"NEW FILE"]}),t.jsxs("button",{onClick:Be,disabled:!he.unsaved,style:{padding:"6px 12px",backgroundColor:Y.DARK_BG,border:`2px solid ${he.unsaved?Y.YELLOW:Y.GRAY}`,color:he.unsaved?Y.YELLOW:Y.GRAY,fontSize:"11px",fontWeight:"bold",cursor:he.unsaved?"pointer":"not-allowed",fontFamily:"Consolas, monospace"},children:[t.jsx(ao,{size:14,style:{display:"inline",marginRight:"4px"}}),"SAVE"]}),t.jsxs("button",{onClick:Ae,disabled:m,style:{padding:"6px 12px",backgroundColor:m?Y.GRAY:Y.GREEN,border:"none",color:Y.DARK_BG,fontSize:"11px",fontWeight:"bold",cursor:m?"not-allowed":"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(Ms,{size:14,style:{display:"inline",marginRight:"4px"}}),m?"RUNNING...":"RUN CODE"]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:K,style:{padding:"6px 12px",backgroundColor:Y.DARK_BG,border:`2px solid ${Y.GREEN}`,color:Y.GREEN,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(wn,{size:14,style:{display:"inline",marginRight:"4px"}}),"NEW"]}),t.jsxs("button",{onClick:Ee,style:{padding:"6px 12px",backgroundColor:Y.DARK_BG,border:`2px solid ${Y.BLUE}`,color:Y.BLUE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(qT,{size:14,style:{display:"inline",marginRight:"4px"}}),"OPEN"]}),t.jsxs("button",{onClick:Oe,style:{padding:"6px 12px",backgroundColor:Y.DARK_BG,border:`2px solid ${Y.YELLOW}`,color:Y.YELLOW,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(ao,{size:14,style:{display:"inline",marginRight:"4px"}}),"SAVE"]}),t.jsxs("button",{onClick:se,style:{padding:"6px 12px",backgroundColor:Y.GREEN,border:"none",color:Y.DARK_BG,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(Ms,{size:14,style:{display:"inline",marginRight:"4px"}}),"RUN ALL"]}),t.jsxs("button",{onClick:()=>G(!O),style:{padding:"6px 12px",backgroundColor:Y.DARK_BG,border:`2px solid ${Y.CYAN}`,color:Y.CYAN,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(qb,{size:14,style:{display:"inline",marginRight:"4px"}}),"PACKAGES"]}),t.jsxs("button",{onClick:()=>$(!z),style:{padding:"6px 12px",backgroundColor:z?Y.ORANGE:Y.DARK_BG,border:`2px solid ${Y.ORANGE}`,color:z?Y.DARK_BG:Y.ORANGE,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx(JE,{size:14,style:{display:"inline",marginRight:"4px"}}),"HISTORY"]})]})})]})}),o==="code"&&t.jsx("div",{style:{backgroundColor:Y.PANEL_BG,borderBottom:`1px solid ${Y.GRAY}`,display:"flex",alignItems:"center",padding:"4px 8px",gap:"4px",overflowX:"auto"},children:l.map(ye=>t.jsxs("div",{onClick:()=>f(ye.id),style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",backgroundColor:p===ye.id?Y.EDITOR_BG:Y.DARK_BG,border:`1px solid ${p===ye.id?Ie(ye.language):Y.GRAY}`,cursor:"pointer",fontSize:"11px"},children:[t.jsx(ri,{size:12,style:{color:Ie(ye.language)}}),t.jsxs("span",{style:{color:ye.unsaved?Y.YELLOW:Y.WHITE},children:[ye.name,ye.unsaved&&"*"]}),l.length>1&&t.jsx(ln,{size:12,onClick:ue=>{ue.stopPropagation(),ie(ye.id)},style:{color:Y.GRAY,cursor:"pointer"}})]},ye.id))}),O&&o==="notebook"&&t.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:Y.PANEL_BG,border:`2px solid ${Y.ORANGE}`,padding:"20px",zIndex:1e3,width:"500px",maxHeight:"400px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[t.jsx("span",{style:{color:Y.ORANGE,fontWeight:"bold",fontSize:"14px"},children:"PACKAGE MANAGER"}),t.jsx(ln,{size:16,onClick:()=>G(!1),style:{cursor:"pointer",color:Y.GRAY}})]}),t.jsx("div",{style:{marginBottom:"16px"},children:t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("input",{type:"text",value:B,onChange:ye=>F(ye.target.value),onKeyPress:ye=>ye.key==="Enter"&&_e(),placeholder:"Package name (e.g., numpy, pandas, matplotlib)",style:{flex:1,backgroundColor:Y.EDITOR_BG,border:`1px solid ${Y.GRAY}`,color:Y.WHITE,padding:"6px 8px",fontSize:"12px",fontFamily:"Consolas, monospace"}}),t.jsx("button",{onClick:_e,style:{padding:"6px 12px",backgroundColor:Y.GREEN,border:"none",color:Y.DARK_BG,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"INSTALL"})]})}),t.jsx("div",{style:{fontSize:"11px",color:Y.CYAN,marginBottom:"8px"},children:"Installed Packages:"}),t.jsx("div",{className:"code-scroll",style:{maxHeight:"250px",overflowY:"auto",backgroundColor:Y.EDITOR_BG,padding:"8px",fontSize:"10px"},children:P.length===0?t.jsx("div",{style:{color:Y.GRAY},children:"Click to load packages..."}):P.map((ye,ue)=>t.jsx("div",{style:{color:Y.WHITE,marginBottom:"2px"},children:ye},ue))}),P.length===0&&t.jsx("button",{onClick:je,style:{marginTop:"8px",padding:"4px 8px",backgroundColor:Y.BLUE,border:"none",color:Y.WHITE,fontSize:"10px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"LOAD PACKAGES"})]}),t.jsxs("div",{style:{flex:1,display:"flex",minHeight:0},children:[z&&o==="notebook"&&t.jsxs("div",{style:{width:"300px",backgroundColor:Y.PANEL_BG,borderRight:`1px solid ${Y.GRAY}`,display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:Y.DARK_BG,padding:"8px 12px",borderBottom:`1px solid ${Y.GRAY}`},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[t.jsx(JE,{size:14,style:{color:Y.ORANGE}}),t.jsx("span",{style:{color:Y.ORANGE,fontSize:"12px",fontWeight:"bold"},children:"NOTEBOOK HISTORY"})]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("input",{type:"text",value:oe,onChange:ye=>{Z(ye.target.value),ge(ye.target.value)},placeholder:"Search...",style:{flex:1,backgroundColor:Y.EDITOR_BG,border:`1px solid ${Y.GRAY}`,color:Y.WHITE,padding:"4px 8px",fontSize:"11px",fontFamily:"Consolas, monospace"}}),t.jsx("button",{onClick:me,style:{padding:"4px 8px",backgroundColor:Y.DARK_BG,border:`1px solid ${Y.BLUE}`,color:Y.BLUE,fontSize:"10px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:t.jsx(xn,{size:12})})]})]}),t.jsx("div",{className:"code-scroll",style:{flex:1,overflowY:"auto",padding:"8px"},children:fe?t.jsx("div",{style:{color:Y.GRAY,textAlign:"center",padding:"20px",fontSize:"11px"},children:"Loading history..."}):W.length===0?t.jsx("div",{style:{color:Y.GRAY,textAlign:"center",padding:"20px",fontSize:"11px"},children:"No notebook history yet"}):W.map(ye=>t.jsxs("div",{className:"history-item",style:{backgroundColor:E===ye.id?Y.EDITOR_BG:Y.DARK_BG,border:`1px solid ${E===ye.id?Y.ORANGE:Y.GRAY}`,padding:"8px",marginBottom:"8px",cursor:"pointer",fontSize:"11px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"4px"},children:[t.jsxs("div",{onClick:()=>X(ye.id),style:{flex:1},children:[t.jsxs("div",{style:{color:Y.CYAN,fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(M4,{size:10}),ye.name]}),t.jsxs("div",{style:{color:Y.GRAY,fontSize:"10px",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(uo,{size:10}),Qe(ye.updated_at)]}),t.jsxs("div",{style:{color:Y.GRAY,fontSize:"9px",display:"flex",gap:"12px"},children:[t.jsxs("span",{children:[ye.cell_count," cells"]}),t.jsxs("span",{children:["Ex: ",ye.execution_count]})]})]}),t.jsx("button",{onClick:ue=>{ue.stopPropagation(),V(ye.id)},style:{padding:"2px 4px",backgroundColor:"transparent",border:`1px solid ${Y.RED}`,color:Y.RED,fontSize:"9px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:t.jsx(On,{size:10})})]}),ye.path&&t.jsx("div",{style:{color:Y.GRAY,fontSize:"9px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ye.path})]},ye.id))})]}),o==="code"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",borderRight:`1px solid ${Y.GRAY}`},children:[t.jsxs("div",{style:{backgroundColor:Y.PANEL_BG,padding:"8px 12px",borderBottom:`1px solid ${Y.GRAY}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:Y.ORANGE,fontSize:"12px",fontWeight:"bold"},children:"EDITOR"}),t.jsx("span",{style:{color:Y.GRAY},children:"|"}),t.jsx("span",{style:{color:Ie(he.language),fontSize:"11px"},children:he.language.toUpperCase()})]}),t.jsxs("div",{style:{fontSize:"10px",color:Y.GRAY},children:["Lines: ",he.content.split(`
`).length," | Chars: ",he.content.length]})]}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsx("div",{className:"line-numbers",children:he.content.split(`
`).map((ye,ue)=>t.jsx("div",{children:ue+1},ue))}),t.jsx("textarea",{ref:_,className:"code-editor code-scroll",value:he.content,onChange:ye=>Re(ye.target.value),spellCheck:!1,style:{flex:1,backgroundColor:Y.EDITOR_BG,color:Y.WHITE,border:"none",outline:"none",resize:"none",padding:"12px",whiteSpace:"pre",overflowWrap:"normal",overflowX:"auto"}})]})]}),t.jsxs("div",{style:{width:"450px",display:"flex",flexDirection:"column",backgroundColor:Y.PANEL_BG},children:[t.jsxs("div",{style:{backgroundColor:Y.DARK_BG,padding:"8px 12px",borderBottom:`1px solid ${Y.GRAY}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(dc,{size:14,style:{color:Y.GREEN}}),t.jsx("span",{style:{color:Y.ORANGE,fontSize:"12px",fontWeight:"bold"},children:"OUTPUT CONSOLE"})]}),t.jsx("button",{onClick:qe,style:{padding:"3px 8px",backgroundColor:"transparent",border:`1px solid ${Y.RED}`,color:Y.RED,fontSize:"9px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"CLEAR"})]}),t.jsx("div",{className:"code-scroll",style:{flex:1,overflowY:"auto",padding:"12px",backgroundColor:Y.DARK_BG,fontSize:"12px",lineHeight:"1.6"},children:h.length===0?t.jsxs("div",{style:{color:Y.GRAY,textAlign:"center",paddingTop:"40px"},children:[t.jsx(dc,{size:32,style:{marginBottom:"8px",opacity:.5}}),t.jsx("div",{children:"No output yet"}),t.jsx("div",{style:{fontSize:"10px",marginTop:"4px"},children:"Run your code to see results"})]}):h.map((ye,ue)=>t.jsxs("div",{style:{marginBottom:"16px",paddingBottom:"16px",borderBottom:`1px solid ${Y.GRAY}`},children:[t.jsxs("div",{style:{color:Y.CYAN,fontSize:"10px",marginBottom:"6px"},children:["[",ye.timestamp.toLocaleTimeString(),"]"]}),t.jsx("pre",{style:{color:ye.error?Y.RED:Y.GREEN,margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:ye.error||ye.output})]},ue))})]})]}):t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:t.jsx("div",{className:"code-scroll",style:{flex:1,overflowY:"auto",padding:"16px",backgroundColor:"#050505"},children:t.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[w.map((ye,ue)=>t.jsxs("div",{className:"notebook-cell",style:{backgroundColor:Y.PANEL_BG,border:`1px solid ${Y.GRAY}`,marginBottom:"16px",position:"relative"},children:[t.jsxs("div",{style:{backgroundColor:Y.DARK_BG,padding:"6px 12px",borderBottom:`1px solid ${Y.GRAY}`,fontSize:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{color:ye.cellType==="code"?Y.BLUE:Y.ORANGE},children:ye.cellType==="code"?`In [${ye.executionCount||" "}]:`:"Markdown"}),t.jsxs("div",{className:"cell-actions",style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:()=>We(ue),style:{padding:"2px 6px",backgroundColor:"transparent",border:`1px solid ${Y.CYAN}`,color:Y.CYAN,fontSize:"9px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:ye.cellType==="code"?"MD":"CODE"}),t.jsx(Hp,{size:12,onClick:()=>ce(ue),style:{color:ue===0?Y.GRAY:Y.WHITE,cursor:ue===0?"not-allowed":"pointer"}}),t.jsx(bi,{size:12,onClick:()=>Ce(ue),style:{color:ue===w.length-1?Y.GRAY:Y.WHITE,cursor:ue===w.length-1?"not-allowed":"pointer"}}),ye.cellType==="code"&&t.jsx(Ms,{size:12,onClick:()=>J(ue),style:{color:Y.GREEN,cursor:"pointer"}}),t.jsx(On,{size:12,onClick:()=>ee(ue),style:{color:w.length===1?Y.GRAY:Y.RED,cursor:w.length===1?"not-allowed":"pointer"}})]})]}),t.jsx("textarea",{value:ye.source.join(`
`),onChange:re=>be(ue,re.target.value),placeholder:ye.cellType==="code"?"# Enter Python code here...":"Enter markdown text here...",style:{width:"100%",minHeight:"100px",backgroundColor:Y.EDITOR_BG,color:Y.WHITE,border:"none",outline:"none",resize:"vertical",padding:"12px",fontSize:"13px",fontFamily:"Consolas, monospace"}}),ye.cellType==="code"&&t.jsxs("div",{style:{backgroundColor:Y.DARK_BG,padding:"12px",borderTop:`1px solid ${Y.GRAY}`},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsxs("div",{style:{color:Y.GREEN,fontSize:"10px"},children:["Output ",ye.executionCount?`[${ye.executionCount}]`:"",":"]}),ye.outputs.length>0&&t.jsx("button",{onClick:()=>Te(ue),style:{padding:"2px 6px",backgroundColor:"transparent",border:`1px solid ${Y.RED}`,color:Y.RED,fontSize:"8px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"CLEAR"})]}),Me(ye.outputs)]}),t.jsx("div",{style:{textAlign:"center",padding:"4px",backgroundColor:Y.DARK_BG,borderTop:`1px solid ${Y.GRAY}`,opacity:.7},children:t.jsx("button",{onClick:()=>q(ue),style:{padding:"4px 8px",backgroundColor:"transparent",border:`1px dashed ${Y.GRAY}`,color:Y.GRAY,fontSize:"9px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"+ ADD CELL BELOW"})})]},ye.id)),t.jsx("div",{style:{textAlign:"center",padding:"20px"},children:t.jsx("button",{onClick:()=>q(),style:{padding:"8px 16px",backgroundColor:Y.DARK_BG,border:`2px dashed ${Y.GREEN}`,color:Y.GREEN,fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"+ ADD CELL"})})]})})})]}),t.jsx("div",{style:{borderTop:`2px solid ${Y.ORANGE}`,backgroundColor:Y.PANEL_BG,padding:"8px 16px",fontSize:"11px"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("span",{style:{color:Y.ORANGE,fontWeight:"bold"},children:"FINCEPT CODE EDITOR v1.0"}),t.jsx("span",{style:{color:Y.GRAY},children:"|"}),t.jsx("span",{style:{color:Y.CYAN},children:"FinScript Language Support"}),t.jsx("span",{style:{color:Y.GRAY},children:"|"}),t.jsx("span",{style:{color:Y.BLUE},children:"Jupyter Integration"}),o==="notebook"&&C&&t.jsxs(t.Fragment,{children:[t.jsx("span",{style:{color:Y.GRAY},children:"|"}),t.jsx("span",{style:{color:Y.YELLOW,fontSize:"10px"},children:C.split(/[/\\]/).pop()})]})]}),t.jsxs("div",{style:{color:Y.GRAY},children:["Mode: ",t.jsx("span",{style:{color:Y.ORANGE,fontWeight:"bold"},children:o.toUpperCase()}),o==="code"?` | Files: ${l.length}`:` | Cells: ${w.length} | Exec: ${k-1}`]})]})})]})}const JH={id:"finscript",title:"FinScript Language",icon:Yp,subsections:[{id:"getting-started",title:"Getting Started",content:`FinScript is a domain-specific language (DSL) designed for financial analysis and algorithmic trading. It provides a simple, intuitive syntax for defining trading strategies, calculating technical indicators, and generating trading signals.

**Key Features:**
 Simple syntax inspired by Pine Script
 Built-in technical indicators (EMA, SMA, WMA, RSI, MACD, etc.)
 Real-time data integration with Yahoo Finance
 Automatic chart generation
 Buy/Sell signal generation
 Backtesting capabilities
 Paper trading support
 Live execution integration

**Use Cases:**
 Developing trading strategies
 Technical analysis automation
 Signal generation
 Backtesting strategies
 Portfolio optimization`,codeExample:`// Your first FinScript program
if ema(AAPL, 21) > wma(AAPL, 50) {
    buy "Bullish crossover signal"
}

plot ema(AAPL, 21), "EMA 21"
plot wma(AAPL, 50), "WMA 50"`},{id:"syntax",title:"Basic Syntax",content:`FinScript uses a clean, declarative syntax. Here are the core language constructs:

**Comments:**
Use // for single-line comments

**Variables:**
Variables are automatically typed based on indicator functions

**Conditionals:**
Use if statements to define trading logic

**Functions:**
Built-in functions for technical analysis

**Operators:**
 Comparison: >, <, >=, <=, ==, !=
 Logical: and, or, not
 Arithmetic: +, -, *, /, %`,codeExample:`// Comments explain your strategy
// Variables are created by indicators
fast_ema = ema(TSLA, 12)
slow_ema = ema(TSLA, 26)

// Conditionals for signals
if fast_ema > slow_ema {
    buy "Fast EMA crossed above Slow EMA"
}

if fast_ema < slow_ema {
    sell "Fast EMA crossed below Slow EMA"
}`},{id:"indicators",title:"Technical Indicators",content:`FinScript provides a comprehensive suite of technical indicators for market analysis:

**Moving Averages:**
 ema(symbol, period) - Exponential Moving Average
 sma(symbol, period) - Simple Moving Average
 wma(symbol, period) - Weighted Moving Average

**Momentum Indicators:**
 rsi(symbol, period) - Relative Strength Index
 macd(symbol, fast, slow, signal) - MACD
 stochastic(symbol, period) - Stochastic Oscillator

**Volatility:**
 atr(symbol, period) - Average True Range
 bollinger(symbol, period, std) - Bollinger Bands

**Volume:**
 volume(symbol) - Trading Volume
 obv(symbol) - On-Balance Volume

**Price Functions:**
 close(symbol) - Closing price
 open(symbol) - Opening price
 high(symbol) - High price
 low(symbol) - Low price`,codeExample:`// Using multiple indicators
price = close(AAPL)
ema_fast = ema(AAPL, 12)
ema_slow = ema(AAPL, 26)
rsi_value = rsi(AAPL, 14)

// Combine indicators for strategy
if ema_fast > ema_slow and rsi_value < 30 {
    buy "Oversold with bullish trend"
}

plot ema_fast, "EMA 12"
plot ema_slow, "EMA 26"
plot rsi_value, "RSI 14"`},{id:"plotting",title:"Visualization & Plotting",content:`FinScript provides powerful charting capabilities to visualize your strategies:

**plot** - Plot indicator values
Syntax: plot indicator, "label"

**plot_candlestick** - Generate OHLC candlestick charts
Syntax: plot_candlestick symbol, "chart_title"

**plot_line** - Draw custom lines
Syntax: plot_line value, "label", color

**Chart Options:**
 Candlestick charts
 Line charts
 Bar charts
 Indicator overlays
 Support/resistance lines

Charts are automatically generated and can be viewed in the terminal's chart panel.`,codeExample:`// Visualize your strategy
symbol = MSFT

// Plot multiple indicators
plot ema(symbol, 7), "EMA 7"
plot ema(symbol, 21), "EMA 21"
plot sma(symbol, 50), "SMA 50"

// Generate candlestick chart
plot_candlestick symbol, "Microsoft Stock Chart"

// Add support/resistance lines
plot_line 300.0, "Resistance", "red"
plot_line 250.0, "Support", "green"`},{id:"signals",title:"Trading Signals",content:`Generate buy and sell signals based on your trading logic:

**buy** - Generate a buy signal
Syntax: buy "reason for buying"

**sell** - Generate a sell signal
Syntax: sell "reason for selling"

Signals are logged with timestamps and can trigger automated trading when integrated with brokers.

**Best Practices:**
 Always include descriptive messages
 Use multiple confirmation indicators
 Implement risk management
 Test thoroughly with historical data
 Use stop-loss and take-profit levels
 Monitor signal performance`,codeExample:`// Crossover strategy with signals
fast = ema(GOOGL, 12)
slow = ema(GOOGL, 26)
momentum = rsi(GOOGL, 14)

// Buy signal with multiple confirmations
if fast > slow and momentum > 50 {
    buy "EMA crossover with positive momentum"
}

// Sell signal with risk management
if fast < slow or momentum > 70 {
    sell "EMA crossover or overbought condition"
}

// Plot for visual confirmation
plot fast, "Fast EMA"
plot slow, "Slow EMA"`}]},QH={id:"terminal",title:"Terminal Features",icon:dc,subsections:[{id:"overview",title:"Terminal Overview",content:`Fincept Terminal is a Bloomberg-style professional financial terminal designed for traders, analysts, and investors.

**Key Features:**
 Real-time market data and quotes
 Advanced charting and technical analysis
 News aggregation and sentiment analysis
 Portfolio management and tracking
 Custom alerts and notifications
 Multi-tab workspace for efficient workflow
 Bloomberg-inspired dark theme interface
 Customizable layouts and settings

**Target Users:**
 Professional traders
 Financial analysts
 Portfolio managers
 Retail investors
 Quant developers`,codeExample:`// Access terminal via desktop app
// Available on Windows, macOS, and Linux

// Key capabilities:
- Real-time streaming data
- Historical data analysis
- Custom indicator development
- Automated strategy execution
- Risk management tools
- Performance analytics`},{id:"shortcuts",title:"Keyboard Shortcuts",content:`Master the terminal with these keyboard shortcuts:

**Global Shortcuts:**
 F1 - Help
 F2 - Markets
 F3 - News
 F4 - Portfolio
 F5 - Analytics
 F6 - Watchlist
 F7 - Screener
 F8 - Alerts
 F9 - Chat/AI Assistant
 F10 - Settings
 F11 - Fullscreen toggle
 Ctrl+S - Save current file
 Ctrl+N - New file
 Ctrl+O - Open file
 Ctrl+W - Close tab
 Ctrl+Tab - Next tab
 Ctrl+Shift+Tab - Previous tab

**Editor Shortcuts:**
 Ctrl+/ - Comment/Uncomment
 Ctrl+F - Find
 Ctrl+R - Run code
 Ctrl+Shift+K - Clear output

**Navigation:**
 Ctrl+Tab - Next tab
 Ctrl+Shift+Tab - Previous tab
 Ctrl+W - Close tab`,codeExample:`// Quick actions in editor
// Press Ctrl+/ to toggle comments
// if ema(AAPL, 21) > sma(AAPL, 50) {
//     buy "EMA crosses SMA"
// }

// Press Ctrl+R to execute code
plot ema(AAPL, 21), "EMA 21"

// Press Ctrl+S to save file`},{id:"customization",title:"Customization",content:`Customize the terminal to match your workflow:

**Themes:**
 Bloomberg Classic (default)
 Dark Mode
 Light Mode
 Custom themes via CSS

**Layouts:**
 Single panel
 Dual panel (editor + output)
 Triple panel (editor + output + charts)
 Customizable panel sizes
 Draggable and resizable windows

**Settings:**
 Font size and family
 Tab size (spaces)
 Auto-save interval
 Data refresh rate
 Chart colors and styles
 Alert notification preferences

**Workspace:**
 Save custom layouts
 Multiple workspace profiles
 Quick switching between setups`,codeExample:`// Example settings.json
{
  "theme": "bloomberg-classic",
  "editor": {
    "fontSize": 14,
    "fontFamily": "Consolas",
    "tabSize": 4,
    "autoSave": true,
    "autoSaveInterval": 5000
  },
  "terminal": {
    "refreshRate": 1000,
    "enableNotifications": true,
    "defaultLayout": "triple-panel"
  },
  "charts": {
    "defaultTheme": "dark",
    "gridLines": true,
    "crosshair": true
  }
}`}]},ZH={id:"tabs",title:"Tabs Reference",icon:Q4,subsections:[{id:"dashboard",title:"Dashboard Tab",content:`The Dashboard provides an overview of key market information and indices.

**Features:**
 Real-time market indices (S&P 500, NASDAQ, Dow Jones, etc.)
 Global indices tracking (Asia, Europe, US)
 Economic indicators display
 Sector performance overview
 Market breadth indicators
 Key statistics at a glance

**Data Updates:**
Real-time updates during market hours with 1-second refresh rate.

**Keyboard Shortcut:** F1`,codeExample:`// Dashboard shows:
- S&P 500: 4,850.23 (+1.2%)
- NASDAQ: 15,234.56 (+1.8%)
- DOW: 38,456.78 (+0.9%)
- Russell 2000: 2,050.34 (+2.1%)

// Global Markets:
- Nikkei 225: 38,234.56 (+0.5%)
- FTSE 100: 7,654.32 (-0.3%)
- DAX: 17,123.45 (+0.8%)

// Economic Indicators:
- US 10Y Treasury: 4.25%
- VIX: 13.45
- USD Index: 103.25`},{id:"markets",title:"Markets Tab",content:`Real-time market data organized by asset classes and regions.

**Asset Categories:**
 Stocks - Global equity markets
 Forex - Currency pairs
 Commodities - Gold, Oil, Agricultural products
 Bonds - Government and corporate bonds
 ETFs - Exchange-traded funds
 Cryptocurrency - Digital assets

**Regional Coverage:**
 United States markets
 European markets
 Asian markets (China, Japan, India, etc.)
 Emerging markets

**Features:**
 Live price quotes
 Intraday charts
 Volume analysis
 Market depth (Level 2 data)
 Pre-market and after-hours data

**Keyboard Shortcut:** F2`,codeExample:`// Market data access:
// Stocks: AAPL, MSFT, GOOGL, TSLA, NVDA
// Forex: EUR/USD, GBP/USD, USD/JPY
// Commodities: GC (Gold), CL (Oil)
// Crypto: BTC/USD, ETH/USD

// Data includes:
- Last price
- Bid/Ask spread
- Volume
- Day high/low
- 52-week high/low
- Market cap
- P/E ratio`},{id:"news",title:"News Tab",content:`Real-time financial news aggregation and analysis.

**News Sources:**
 Bloomberg
 Reuters
 CNBC
 Wall Street Journal
 Financial Times
 Market-specific news feeds

**News Categories:**
 Markets - General market news
 Earnings - Company earnings reports
 M&A - Mergers and acquisitions
 Economic - Economic data releases
 Geopolitics - Global political events
 Regulatory - Regulatory changes
 Technical - Technical analysis insights

**Features:**
 Real-time news feed
 Sentiment analysis (Bullish/Bearish/Neutral)
 Impact rating (High/Medium/Low)
 Ticker association
 News filtering by priority and category
 Search and keyword alerts

**News Priority Levels:**
 FLASH - Breaking market-moving news
 URGENT - High-priority updates
 BREAKING - Important developments
 ROUTINE - Regular news flow

**Keyboard Shortcut:** F3`,codeExample:`// Example news items:
{
  time: "16:47:23",
  priority: "FLASH",
  headline: "Fed Signals Rate Cut",
  summary: "Fed indicates 75bps cut...",
  sentiment: "BULLISH",
  impact: "HIGH",
  tickers: ["SPY", "QQQ", "TLT"]
}

// News filtering:
- By category (Markets, Earnings, etc.)
- By priority level
- By affected tickers
- By sentiment
- By time range`},{id:"forum",title:"Forum Tab",content:`Community discussion platform for traders and investors.

**Forum Features:**
 Discussion threads on stocks, crypto, and strategies
 User reputation system
 Post voting and ranking
 Category organization
 Real-time online user count
 Verified user badges

**Post Categories:**
 Markets - General market discussion
 Stocks - Individual stock analysis
 Crypto - Cryptocurrency discussion
 Options - Options trading strategies
 Forex - Currency trading
 Technical Analysis - Chart analysis
 Fundamental Analysis - Company analysis
 Strategy - Trading strategies

**Post Types:**
 Analysis posts with detailed research
 Questions and answers
 Trade ideas and setups
 News discussion
 Educational content

**User Features:**
 Create and reply to posts
 Like and bookmark posts
 Follow other users
 Track post analytics (views, replies, likes)

**Keyboard Shortcut:** Ctrl+F`,codeExample:`// Forum post structure:
{
  author: "QuantTrader_Pro",
  title: "Fed Rate Analysis",
  category: "MARKETS",
  tags: ["FED", "RATES", "ANALYSIS"],
  views: 8924,
  replies: 156,
  likes: 342,
  sentiment: "BULLISH",
  verified: true
}

// Sorting options:
- Latest posts
- Most popular
- Most discussed
- Trending topics
- Hot topics`},{id:"portfolio",title:"Portfolio Tab",content:`Track and manage your investment portfolio.

**Portfolio Features:**
 Real-time position tracking
 P&L calculation (realized and unrealized)
 Cost basis tracking
 Performance metrics
 Sector allocation
 Asset allocation
 Risk metrics

**Position Information:**
 Ticker symbol
 Quantity held
 Average purchase price
 Current market price
 Market value
 Unrealized P&L ($ and %)
 Day change ($ and %)
 Portfolio weight
 Sector classification

**Portfolio Analytics:**
 Total portfolio value
 Total gain/loss
 Today's change
 Sector diversification
 Position concentration
 Risk-adjusted returns

**Performance Metrics:**
 Total return (%)
 Sharpe ratio
 Maximum drawdown
 Beta
 Alpha

**Keyboard Shortcut:** F4`,codeExample:`// Portfolio position example:
{
  ticker: "AAPL",
  name: "Apple Inc.",
  quantity: 250,
  avgPrice: 165.50,
  currentPrice: 184.92,
  marketValue: 46230.00,
  unrealizedPnL: 4855.00,
  unrealizedPnLPercent: 11.73,
  dayChange: 462.30,
  weight: 28.5,
  sector: "Technology"
}

// Portfolio summary:
Total Value: $162,345.67
Total Cost: $148,000.00
Unrealized P&L: +$14,345.67 (+9.69%)
Today's Change: +$1,234.56 (+0.76%)`},{id:"watchlist",title:"Watchlist Tab",content:`Monitor and track securities of interest.

**Watchlist Features:**
 Multiple watchlist support
 Real-time quote updates
 Quick add/remove securities
 Custom sorting and filtering
 Price alerts
 Technical indicators display

**Data Displayed:**
 Last price
 Change ($ and %)
 Volume
 Day high/low
 Open price
 Previous close
 Market cap
 P/E ratio
 Dividend yield
 52-week high/low
 Average volume

**Watchlist Types:**
 Primary - Main watchlist
 Earnings - Stocks with upcoming earnings
 Breakouts - Technical breakout candidates
 Dividends - Dividend-paying stocks
 Custom lists

**Actions:**
 Add to watchlist from any tab
 Remove from watchlist
 View detailed quote
 Open chart
 Set price alert
 Trade directly

**Keyboard Shortcut:** F6`,codeExample:`// Watchlist entry:
{
  ticker: "NVDA",
  name: "NVIDIA Corporation",
  price: 501.23,
  change: 5.12,
  changePercent: 1.03,
  volume: 35678901,
  marketCap: "1.24T",
  pe: 67.2,
  week52High: 502.66,
  week52Low: 108.13
}

// Watchlist operations:
- Add symbol: watchlist.add("TSLA")
- Remove symbol: watchlist.remove("AAPL")
- Sort by: change%, volume, price
- Filter by: sector, market cap, performance`},{id:"screener",title:"Screener Tab",content:`Discover stocks based on custom criteria and filters.

**Screening Criteria:**

**Fundamental Filters:**
 Market Cap (min/max)
 P/E Ratio (min/max)
 P/S Ratio (min/max)
 P/B Ratio (min/max)
 EPS (min/max)
 Dividend Yield (min/max)
 Revenue Growth (min/max)
 Profit Margin (min/max)
 ROE (min/max)
 ROA (min/max)
 Debt-to-Equity (min/max)

**Technical Filters:**
 Price (min/max)
 Volume (min/max)
 Price Change % (min/max)
 RSI (overbought/oversold)
 Moving average crossovers
 52-week high/low proximity
 Beta (volatility)

**Sector Filters:**
 Technology
 Healthcare
 Financials
 Consumer
 Energy
 Industrials
 Materials
 Utilities

**Pre-built Screens:**
 Value stocks (low P/E, high dividend)
 Growth stocks (high revenue growth)
 Momentum stocks (strong price action)
 Dividend aristocrats
 Small cap opportunities

**Keyboard Shortcut:** F7`,codeExample:`// Screener example:
filters = {
  marketCapMin: "1B",
  peMax: 20,
  dividendMin: 2.0,
  volumeMin: "1M",
  sector: "Technology"
}

// Results show stocks matching:
- Market cap > $1 billion
- P/E ratio < 20
- Dividend yield > 2%
- Volume > 1 million shares
- Technology sector

// Export results:
- CSV export
- Save custom screen
- Set alerts on criteria`},{id:"alerts",title:"Alerts Tab",content:`Create and manage price alerts and notifications.

**Alert Types:**
 Price Alerts - Trigger when price crosses a level
 Volume Alerts - Trigger on volume spikes
 Indicator Alerts - Based on technical indicators
 News Alerts - Keyword-based news alerts
 Earnings Alerts - Upcoming earnings notifications

**Alert Conditions:**
 Price above/below threshold
 Price crosses moving average
 RSI overbought/oversold
 Volume exceeds average
 News contains keywords
 Percentage change exceeds threshold

**Alert Management:**
 Create new alerts
 Edit existing alerts
 Enable/disable alerts
 Delete alerts
 View alert history
 Alert statistics

**Notification Options:**
 Desktop notifications
 Email notifications
 In-app notifications
 Sound alerts
 SMS (premium feature)

**Alert Status:**
 ACTIVE - Alert is monitoring
 TRIGGERED - Alert condition met
 EXPIRED - Time-based alert expired
 DISABLED - Alert temporarily disabled

**Keyboard Shortcut:** F8`,codeExample:`// Price alert example:
{
  type: "PRICE",
  symbol: "AAPL",
  condition: "Price Above",
  trigger: "$180.00",
  status: "ACTIVE",
  priority: "HIGH",
  notification: ["desktop", "email"]
}

// Indicator alert:
{
  type: "INDICATOR",
  symbol: "TSLA",
  condition: "RSI Below",
  trigger: "30",
  status: "ACTIVE"
}

// Volume alert:
{
  type: "VOLUME",
  symbol: "NVDA",
  condition: "Volume Above",
  trigger: "50M shares",
  status: "ACTIVE"
}`},{id:"chat",title:"AI Chat Tab",content:`Interact with AI assistant for market analysis and strategy development.

**AI Capabilities:**
 Market analysis and insights
 Trading strategy suggestions
 Technical analysis interpretation
 Fundamental analysis assistance
 Code generation (FinScript)
 Backtesting advice
 Risk management guidance
 Portfolio optimization suggestions

**Chat Features:**
 Multi-session support
 Conversation history
 Code highlighting
 Chart generation
 Real-time market data access
 Strategy backtesting
 Educational content

**AI Commands:**
 /analyze [symbol] - Analyze a stock
 /strategy [description] - Generate strategy
 /backtest [strategy] - Backtest a strategy
 /indicators [symbol] - Show technical indicators
 /news [symbol] - Latest news summary
 /compare [symbols] - Compare multiple stocks

**Use Cases:**
 "Analyze AAPL's technical setup"
 "Create a momentum strategy for tech stocks"
 "Explain this earnings report"
 "What's driving the market today?"
 "Help me optimize my portfolio"

**Keyboard Shortcut:** F9`,codeExample:`// Example chat interactions:

User: "Analyze NVDA's technical setup"
AI: "NVDA is showing strong momentum:
- Price above all key moving averages
- RSI at 68 (approaching overbought)
- Volume 20% above average
- Breaking out of ascending triangle
- Next resistance: $510"

User: "Generate a momentum strategy"
AI: "Here's a momentum strategy:

fast = ema(symbol, 12)
slow = ema(symbol, 26)
volume_avg = sma(volume(symbol), 20)

if fast > slow and volume > volume_avg * 1.5 {
    buy 'Momentum breakout with volume'
}

plot fast, 'Fast EMA'
plot slow, 'Slow EMA'"

User: "What's the risk-reward on this trade?"
AI: "Based on support/resistance:
- Entry: $495
- Stop loss: $485 (-2%)
- Target: $520 (+5%)
- Risk-Reward: 1:2.5"`},{id:"code-editor",title:"Code Editor Tab",content:`Write, test, and execute FinScript trading strategies.

**Editor Features:**
 Syntax highlighting for FinScript
 Auto-completion
 Error checking
 Multiple file support
 Code snippets
 Find and replace
 Comment/uncomment
 Auto-save

**Execution:**
 Run strategy on historical data
 View execution output
 Chart generation
 Signal visualization
 Performance metrics
 Error reporting

**File Operations:**
 Create new file
 Open existing file
 Save file
 Export strategy
 Import strategy
 Version control integration

**Output Panel:**
 Execution logs
 Buy/sell signals generated
 Performance statistics
 Error messages
 Chart previews

**Keyboard Shortcuts:**
 Ctrl+R - Run code
 Ctrl+S - Save file
 Ctrl+/ - Comment line
 Ctrl+F - Find
 Ctrl+N - New file

**Shortcut:** Shift+F5`,codeExample:`// FinScript editor example:
// File: momentum_strategy.fincept

// Define parameters
symbol = AAPL
fast_period = 12
slow_period = 26

// Calculate indicators
fast_ema = ema(symbol, fast_period)
slow_ema = ema(symbol, slow_period)
rsi_value = rsi(symbol, 14)

// Trading logic
if fast_ema > slow_ema and rsi_value > 50 {
    buy "Bullish momentum detected"
}

if fast_ema < slow_ema or rsi_value < 40 {
    sell "Momentum weakening"
}

// Visualization
plot fast_ema, "Fast EMA"
plot slow_ema, "Slow EMA"
plot_candlestick symbol, "Price Chart"

// Output:
// Signals generated: 15 buy, 12 sell
// Win rate: 67%
// Total return: +23.5%`},{id:"node-editor",title:"Node Editor / Workflow Tab",content:`Visual programming for building complex data pipelines and workflows.

**Node Types:**
 Data Source Nodes - Import data
 Transformation Nodes - Process data
 Analysis Nodes - Perform analysis
 Visualization Nodes - Create charts
 Agent Nodes - AI-powered analysis
 Output Nodes - Export results

**Node Editor Features:**
 Drag-and-drop interface
 Visual connection system
 Real-time data flow
 Node configuration panels
 Save/load workflows
 Template workflows

**Use Cases:**
 Build data pipelines
 Create custom indicators
 Automate analysis workflows
 Combine multiple data sources
 Deploy automated strategies

**Workflow Operations:**
 Add nodes from palette
 Connect nodes with edges
 Configure node parameters
 Execute workflow
 Debug data flow
 Save workflow template

**Available Nodes:**
 Yahoo Finance - Market data
 Alpha Vantage - Historical data
 News API - News data
 Moving Average - Technical indicator
 RSI Calculator - Momentum indicator
 Signal Generator - Buy/sell signals
 Chart Generator - Visualization
 Alert Sender - Notifications

**Shortcut:** Ctrl+Shift+N`,codeExample:`// Workflow example:
[Yahoo Finance Node]
     (AAPL data)
[EMA Calculator]  [Chart Node]
     (EMA values)
[Signal Generator]
     (buy/sell signals)
[Alert Sender]

// Node configuration:
Yahoo Finance Node:
- Symbol: AAPL
- Timeframe: 1D
- Period: 90 days

EMA Calculator:
- Period: 21
- Source: Close price

Signal Generator:
- Buy condition: EMA > SMA
- Sell condition: EMA < SMA`},{id:"data-sources",title:"Data Sources Tab",content:`Connect to external data sources and APIs.

**Data Source Categories:**
 Databases - PostgreSQL, MySQL, MongoDB
 APIs - REST, GraphQL, WebSocket
 Files - CSV, JSON, Excel
 Streaming - Real-time data feeds
 Cloud Storage - S3, Google Cloud
 Time-series - InfluxDB, TimescaleDB
 Market Data - Bloomberg, Reuters, IEX

**Supported Data Sources:**
 Yahoo Finance - Free market data
 Alpha Vantage - Stock data API
 IEX Cloud - Real-time market data
 Polygon.io - Market data
 Twelve Data - Financial API
 PostgreSQL - Database
 MongoDB - NoSQL database
 Redis - In-memory database
 Kafka - Streaming platform
 CSV Files - Local files

**Connection Management:**
 Add new data source
 Configure connection parameters
 Test connection
 Edit existing connections
 Delete connections
 Connection status monitoring

**Data Source Operations:**
 Query data
 Test queries
 Schedule data fetches
 Cache management
 Error handling
 Rate limiting

**Keyboard Shortcut:** Ctrl+D`,codeExample:`// Data source configuration:

// Yahoo Finance:
{
  name: "Yahoo Finance",
  type: "yahoo-finance",
  config: {
    symbols: ["AAPL", "MSFT", "GOOGL"],
    interval: "1d",
    period: "90d"
  }
}

// PostgreSQL:
{
  name: "Market Database",
  type: "postgresql",
  config: {
    host: "localhost",
    port: 5432,
    database: "market_data",
    user: "trader",
    password: "***"
  }
}

// REST API:
{
  name: "Alpha Vantage",
  type: "rest-api",
  config: {
    baseUrl: "https://alphavantage.co",
    apiKey: "YOUR_API_KEY",
    rateLimit: 5
  }
}`},{id:"agents",title:"Agents Tab",content:`Deploy AI agents for automated trading and monitoring.

**Agent Categories:**

**Hedge Fund Managers:**
 Renaissance Technologies Style - Quantitative strategies
 Bridgewater Associates Style - Macro strategies
 Citadel Style - Multi-strategy approach
 Two Sigma Style - Data-driven analysis

**Trader Styles:**
 Warren Buffett - Value investing
 Ray Dalio - All Weather Portfolio
 Peter Lynch - Growth at reasonable price
 George Soros - Macro trading
 Jim Simons - Quantitative trading

**Analysis Agents:**
 Technical Analysis - Chart patterns and indicators
 Fundamental Analysis - Company financials
 Sentiment Analysis - News and social media
 Risk Analysis - Portfolio risk metrics
 Market Analysis - Macro trends

**Data Agents:**
 Market Data Fetcher - Real-time quotes
 News Aggregator - News collection
 Social Media Monitor - Social sentiment
 Economic Data - Economic indicators

**Execution Agents:**
 Signal Generator - Trading signals
 Order Manager - Order execution
 Risk Manager - Risk control
 Portfolio Rebalancer - Portfolio optimization

**Features:**
 Drag-and-drop agent creation
 Connect agents to data sources
 Configure agent parameters
 Monitor agent status
 View agent output
 24/7 automated execution

**Dynamic Connections:**
 Unlimited input connections
 Unlimited output connections
 Visual connection badges
 Hover to expand handles
 Real-time connection tracking

**Keyboard Shortcut:** Ctrl+Shift+A`,codeExample:`// Agent workflow example:

[Market Data]  [Warren Buffett Agent]  [Portfolio 1]
[News Data]                            [Portfolio 2]
                                         [Portfolio 3]

// Agent configuration:
Warren Buffett Agent:
  Parameters:
    - moat_focus: true
    - min_roe: 15%
    - max_pe: 25
    - min_margin: 20%
    - holding_period: "long-term"

  Inputs: 2 data sources
  Outputs: 3 portfolios
  Status: Running

// Agent can monitor 24/7:
- Scan for undervalued stocks
- Analyze company fundamentals
- Generate buy recommendations
- Rebalance portfolio allocations
- Send alerts on opportunities`},{id:"settings",title:"Settings Tab",content:`Configure terminal preferences and account settings.

**General Settings:**
 Theme selection (Dark/Light/Bloomberg)
 Language preferences
 Time zone settings
 Date format
 Number format
 Currency display

**Editor Settings:**
 Font family and size
 Tab size (spaces)
 Auto-save interval
 Syntax highlighting
 Code completion
 Line numbers

**Data Settings:**
 Data refresh rate
 Auto-update quotes
 Historical data period
 Cache settings
 API rate limits
 Data provider selection

**Notification Settings:**
 Desktop notifications
 Sound alerts
 Email notifications
 SMS alerts (premium)
 Alert frequency
 Notification priority

**Account Settings:**
 User profile
 Subscription plan
 API keys management
 Connected brokers
 Data permissions
 Privacy settings

**Display Settings:**
 Chart color schemes
 Grid line preferences
 Crosshair settings
 Font scaling
 Panel layouts
 Workspace arrangements

**Keyboard Shortcut:** F10`,codeExample:`// Settings configuration:
{
  general: {
    theme: "bloomberg-dark",
    language: "en",
    timezone: "America/New_York",
    dateFormat: "MM/DD/YYYY"
  },
  editor: {
    fontSize: 14,
    fontFamily: "Consolas",
    tabSize: 4,
    autoSave: true
  },
  data: {
    refreshRate: 1000,
    autoUpdate: true,
    cacheEnabled: true,
    provider: "yahoo-finance"
  },
  notifications: {
    desktop: true,
    sound: true,
    email: false,
    priority: "high"
  }
}`}]},e7={id:"api",title:"API Reference",icon:js,subsections:[{id:"data-api",title:"Data API",content:`Access real-time and historical market data through our unified API:

**Endpoints:**
 GET /api/v1/quote/{symbol} - Get latest quote
 GET /api/v1/historical/{symbol} - Historical OHLCV data
 GET /api/v1/indicators/{symbol} - Calculated indicators
 POST /api/v1/backtest - Run strategy backtest
 GET /api/v1/news/{symbol} - Latest news for symbol
 GET /api/v1/fundamentals/{symbol} - Company fundamentals

**Authentication:**
Use API keys in the X-API-Key header

**Rate Limits:**
 Free tier: 100 requests/hour
 Starter: 500 requests/hour
 Professional: 2,000 requests/hour
 Enterprise: 10,000 requests/hour
 Unlimited: No limits

**Response Format:**
All responses are in JSON format with standard structure:
{
  "success": true,
  "data": {...},
  "timestamp": "2025-01-15T10:30:00Z"
}

**Error Handling:**
Errors return appropriate HTTP status codes and error messages.`,codeExample:`// Example API calls
// Get real-time quote
fetch('https://api.fincept.com/v1/quote/AAPL', {
  headers: {
    'X-API-Key': 'your_api_key_here'
  }
})
.then(res => res.json())
.then(data => console.log(data));

// Get historical data
fetch('https://api.fincept.com/v1/historical/AAPL?period=1y', {
  headers: {
    'X-API-Key': 'your_api_key_here'
  }
})
.then(res => res.json())
.then(data => console.log(data));

// Response example:
{
  "success": true,
  "data": {
    "symbol": "AAPL",
    "price": 184.92,
    "change": 1.87,
    "changePercent": 1.02,
    "volume": 48234567,
    "high": 186.45,
    "low": 182.30
  }
}`},{id:"websocket",title:"WebSocket Streaming",content:`Real-time data streaming via WebSocket for live market data:

**Connection:**
wss://stream.fincept.com/v1/quotes

**Subscribe to symbols:**
Send JSON: {"action": "subscribe", "symbols": ["AAPL", "TSLA"]}

**Unsubscribe:**
Send JSON: {"action": "unsubscribe", "symbols": ["AAPL"]}

**Message Format:**
Receive real-time tick data as JSON

**Features:**
 Sub-millisecond latency
 Level 2 order book data
 Trade execution updates
 Market depth information
 Automatic reconnection
 Heartbeat messages

**Data Types:**
 Quotes - Real-time bid/ask
 Trades - Executed trades
 Bars - OHLCV aggregated bars
 Book - Order book depth

**Authentication:**
Include API key in connection URL or initial message`,codeExample:`// WebSocket connection example
const ws = new WebSocket('wss://stream.fincept.com/v1/quotes');

ws.onopen = () => {
  // Subscribe to symbols
  ws.send(JSON.stringify({
    action: 'subscribe',
    symbols: ['AAPL', 'TSLA', 'GOOGL'],
    apiKey: 'your_api_key_here'
  }));
};

ws.onmessage = (event) => {
  const data = JSON.parse(event.data);
  console.log('Live quote:', data);

  // Data format:
  // {
  //   symbol: "AAPL",
  //   price: 184.92,
  //   volume: 1000,
  //   timestamp: "2025-01-15T10:30:00.123Z"
  // }
};

ws.onerror = (error) => {
  console.error('WebSocket error:', error);
};

ws.onclose = () => {
  console.log('Connection closed');
};`},{id:"indicators-api",title:"Indicators API",content:`Calculate technical indicators via API:

**Available Indicators:**
 Moving Averages: SMA, EMA, WMA, VWAP
 Momentum: RSI, MACD, Stochastic, CCI
 Volatility: ATR, Bollinger Bands, Standard Deviation
 Volume: OBV, MFI, A/D Line
 Trend: ADX, Aroon, Parabolic SAR

**Endpoint:**
GET /api/v1/indicators/{symbol}

**Parameters:**
 symbol - Stock ticker (required)
 indicator - Indicator name (required)
 period - Time period (required)
 interval - Data interval (optional, default: 1d)

**Example Requests:**
 /api/v1/indicators/AAPL?indicator=ema&period=21
 /api/v1/indicators/TSLA?indicator=rsi&period=14
 /api/v1/indicators/NVDA?indicator=macd&fast=12&slow=26&signal=9`,codeExample:`// Calculate EMA
fetch('https://api.fincept.com/v1/indicators/AAPL?indicator=ema&period=21', {
  headers: { 'X-API-Key': 'your_api_key' }
})
.then(res => res.json())
.then(data => {
  console.log('EMA values:', data.values);
});

// Calculate RSI
fetch('https://api.fincept.com/v1/indicators/TSLA?indicator=rsi&period=14', {
  headers: { 'X-API-Key': 'your_api_key' }
})
.then(res => res.json())
.then(data => {
  console.log('RSI:', data.current);
  console.log('Overbought:', data.current > 70);
  console.log('Oversold:', data.current < 30);
});

// Response format:
{
  "success": true,
  "data": {
    "symbol": "AAPL",
    "indicator": "ema",
    "period": 21,
    "current": 184.56,
    "values": [180.23, 181.45, ..., 184.56]
  }
}`},{id:"backtesting-api",title:"Backtesting API",content:`Test trading strategies on historical data:

**Endpoint:**
POST /api/v1/backtest

**Request Body:**
{
  "symbol": "AAPL",
  "strategy": "ema_crossover",
  "start_date": "2024-01-01",
  "end_date": "2024-12-31",
  "initial_capital": 10000,
  "parameters": {
    "fast_period": 12,
    "slow_period": 26
  }
}

**Response Metrics:**
 Total return (%)
 Sharpe ratio
 Maximum drawdown
 Win rate
 Total trades
 Profit factor
 Average trade duration

**Strategy Submission:**
You can submit FinScript code for backtesting

**Execution:**
Backtests run asynchronously. Poll /api/v1/backtest/{job_id} for results`,codeExample:`// Submit backtest
fetch('https://api.fincept.com/v1/backtest', {
  method: 'POST',
  headers: {
    'X-API-Key': 'your_api_key',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    symbol: 'AAPL',
    strategy: 'ema_crossover',
    start_date: '2024-01-01',
    end_date: '2024-12-31',
    initial_capital: 10000,
    parameters: {
      fast_period: 12,
      slow_period: 26
    }
  })
})
.then(res => res.json())
.then(result => {
  console.log('Backtest results:');
  console.log('Total return:', result.total_return);
  console.log('Sharpe ratio:', result.sharpe_ratio);
  console.log('Max drawdown:', result.max_drawdown);
  console.log('Win rate:', result.win_rate);
  console.log('Total trades:', result.total_trades);
});

// Example response:
{
  "success": true,
  "data": {
    "total_return": 23.5,
    "sharpe_ratio": 1.8,
    "max_drawdown": -8.2,
    "win_rate": 67.3,
    "total_trades": 45,
    "profit_factor": 2.1
  }
}`}]},t7={id:"tutorials",title:"Tutorials",icon:LT,subsections:[{id:"first-strategy",title:"Build Your First Strategy",content:`Let's build a simple moving average crossover strategy from scratch:

**Step 1:** Define your indicators
Calculate fast and slow moving averages

**Step 2:** Create trading logic
Buy when fast MA crosses above slow MA
Sell when fast MA crosses below slow MA

**Step 3:** Add visualization
Plot your indicators on a chart

**Step 4:** Run and test
Execute your strategy and analyze results

**Step 5:** Optimize
Adjust parameters to improve performance

This is one of the most popular strategies used by traders worldwide!`,codeExample:`// Complete MA Crossover Strategy
symbol = AAPL

// Step 1: Define indicators
fast_ma = ema(symbol, 12)
slow_ma = ema(symbol, 26)

// Step 2: Trading logic
if fast_ma > slow_ma {
    buy "Bullish crossover - Fast MA above Slow MA"
}

if fast_ma < slow_ma {
    sell "Bearish crossover - Fast MA below Slow MA"
}

// Step 3: Visualization
plot fast_ma, "Fast EMA (12)"
plot slow_ma, "Slow EMA (26)"
plot_candlestick symbol, "Apple Stock"

// Done! Press Ctrl+R to run`},{id:"advanced-strategy",title:"Advanced: Multi-Indicator Strategy",content:`Build a sophisticated strategy combining multiple indicators:

**Indicators Used:**
 EMA (12, 26) for trend
 RSI (14) for momentum
 Bollinger Bands for volatility
 Volume for confirmation

**Strategy Rules:**
 Buy: Bullish trend + oversold + high volume
 Sell: Bearish trend + overbought OR stop loss

**Risk Management:**
 Position sizing based on volatility
 Stop loss at 2% below entry
 Take profit at 5% above entry
 Maximum 3 concurrent positions

This demonstrates how to combine multiple signals for robust trading decisions.`,codeExample:`// Advanced Multi-Indicator Strategy
symbol = TSLA

// Indicators
ema_fast = ema(symbol, 12)
ema_slow = ema(symbol, 26)
rsi_val = rsi(symbol, 14)
vol = volume(symbol)
avg_vol = sma(vol, 20)
bb_upper, bb_middle, bb_lower = bollinger(symbol, 20, 2)

// Buy conditions (all must be true)
trend_bullish = ema_fast > ema_slow
oversold = rsi_val < 30
volume_spike = vol > avg_vol * 1.5
price_near_lower_bb = close(symbol) < bb_middle

if trend_bullish and oversold and volume_spike {
    buy "Strong buy: Bullish trend + oversold + volume"
}

// Sell conditions (any can trigger)
trend_bearish = ema_fast < ema_slow
overbought = rsi_val > 70
price_at_upper_bb = close(symbol) > bb_upper

if trend_bearish or overbought or price_at_upper_bb {
    sell "Exit: Reversal signal detected"
}

// Visualize everything
plot ema_fast, "EMA 12"
plot ema_slow, "EMA 26"
plot rsi_val, "RSI"
plot bb_upper, "BB Upper"
plot bb_lower, "BB Lower"`},{id:"portfolio-tutorial",title:"Managing Your Portfolio",content:`Learn to track and manage your investment portfolio:

**Step 1: Add Positions**
Enter your current holdings with purchase details

**Step 2: Monitor Performance**
Track real-time P&L and portfolio value

**Step 3: Analyze Allocation**
Review sector and asset allocation

**Step 4: Set Alerts**
Create alerts for portfolio events

**Step 5: Rebalance**
Adjust positions based on target allocation

**Best Practices:**
 Diversify across sectors (aim for 5-10 sectors)
 Limit individual position size (max 10-15% each)
 Review portfolio weekly
 Rebalance quarterly
 Monitor correlation between holdings
 Track risk-adjusted returns (Sharpe ratio)`,codeExample:`// Portfolio management workflow:

// 1. Add positions
portfolio.add({
  ticker: "AAPL",
  quantity: 100,
  avgPrice: 150.00
});

// 2. View portfolio summary
portfolio.summary();
// Output:
// Total Value: $162,345.67
// Total P&L: +$14,345.67 (+9.69%)
// Number of positions: 8
// Top performer: NVDA (+23.5%)

// 3. Check allocation
portfolio.allocation();
// Technology: 45%
// Healthcare: 20%
// Financials: 15%
// Consumer: 12%
// Energy: 8%

// 4. Identify rebalancing needs
portfolio.rebalance_suggestions();
// Overweight: Technology (target: 35%)
// Underweight: Healthcare (target: 25%)

// 5. Set portfolio alerts
alert.create({
  type: "portfolio_value",
  condition: "below",
  threshold: 150000
});`},{id:"watchlist-tutorial",title:"Using Watchlists Effectively",content:`Master watchlist management for efficient market monitoring:

**Creating Effective Watchlists:**

**By Strategy:**
 Momentum - Stocks with strong price action
 Value - Undervalued stocks
 Dividend - High-yielding stocks
 Earnings - Upcoming earnings plays

**By Sector:**
 Technology watchlist
 Healthcare watchlist
 Financial watchlist

**By Event:**
 Earnings this week
 Ex-dividend dates
 Technical breakouts

**Watchlist Workflow:**
1. Scan for candidates using Screener
2. Add to appropriate watchlist
3. Monitor for entry signals
4. Set price alerts
5. Execute trades when conditions met
6. Move to Portfolio or remove

**Tips:**
 Keep watchlists focused (10-20 stocks each)
 Review and update weekly
 Use multiple watchlists for organization
 Set alerts on all watchlist stocks`,codeExample:`// Watchlist management:

// Create specialized watchlists
watchlist.create("Tech Momentum");
watchlist.create("Value Plays");
watchlist.create("Earnings This Week");

// Add stocks with criteria
watchlist.add("Tech Momentum", "NVDA", {
  alert: {
    type: "price",
    trigger: 510,
    condition: "above"
  },
  notes: "Breaking out of triangle"
});

// Bulk add from screener results
screener_results = screen({
  marketCap: "1B+",
  peRatio: "< 20",
  dividendYield: "> 3%"
});

watchlist.add_multiple("Value Plays", screener_results);

// Review watchlist
watchlist.show("Tech Momentum");
// NVDA: $501.23 (+1.03%)
// AAPL: $184.92 (+1.02%)
// MSFT: $378.45 (+1.02%)
// GOOGL: $134.56 (+0.76%)

// Set alerts on entire watchlist
watchlist.set_alerts("Tech Momentum", {
  type: "price_change",
  threshold: 3,
  period: "day"
});`},{id:"alerts-tutorial",title:"Setting Up Smart Alerts",content:`Create effective alerts to never miss trading opportunities:

**Alert Types & Use Cases:**

**Price Alerts:**
 Breakout levels
 Support/resistance
 Round numbers
 All-time highs

**Technical Alerts:**
 RSI overbought/oversold
 MA crossovers
 MACD signals
 Volume spikes

**News Alerts:**
 Earnings announcements
 FDA approvals (healthcare)
 Merger rumors
 Analyst upgrades/downgrades

**Volume Alerts:**
 Unusual volume (3x average)
 End-of-day volume surge
 Dark pool activity

**Best Practices:**
 Use multiple confirmation alerts
 Set both entry and exit alerts
 Include stop-loss alerts
 Adjust alerts as market changes
 Review triggered alerts regularly`,codeExample:`// Smart alert examples:

// Breakout alert
alert.create({
  symbol: "AAPL",
  type: "price",
  condition: "above",
  level: 185.00,
  message: "AAPL breaking out above $185",
  notifications: ["desktop", "email"]
});

// RSI oversold alert
alert.create({
  symbol: "TSLA",
  type: "indicator",
  indicator: "rsi",
  period: 14,
  condition: "below",
  level: 30,
  message: "TSLA RSI oversold"
});

// Volume spike alert
alert.create({
  symbol: "NVDA",
  type: "volume",
  condition: "above",
  multiplier: 2.0, // 2x average volume
  message: "NVDA unusual volume"
});

// Earnings alert
alert.create({
  symbol: "GOOGL",
  type: "event",
  event: "earnings",
  advance_notice: "1 day",
  message: "GOOGL earnings tomorrow"
});

// Combined multi-condition alert
alert.create({
  symbol: "MSFT",
  type: "multi",
  conditions: [
    { type: "price", above: 380 },
    { type: "rsi", above: 50 },
    { type: "volume", multiplier: 1.5 }
  ],
  logic: "all", // all conditions must be met
  message: "MSFT strong buy signal"
});`},{id:"agent-workflow",title:"Building Agent Workflows",content:`Create automated agent workflows for 24/7 market monitoring:

**Workflow Components:**
 Data Sources - Market data feeds
 Agents - Analysis and decision making
 Connections - Data flow between nodes
 Outputs - Alerts, trades, reports

**Example Workflows:**

**Workflow 1: Multi-Source Analysis**
Yahoo Finance  Warren Buffett Agent  Portfolio Alerts
Alpha Vantage            
News Feed                

**Workflow 2: Diversified Strategies**
Market Data  Momentum Agent  Aggressive Portfolio
            Value Agent     Conservative Portfolio
            Risk Agent      Balanced Portfolio

**Workflow 3: News-Driven Trading**
News Feed  Sentiment Agent  Signal Generator  Trade Executor
                              Alert Manager

**Best Practices:**
 Start with simple workflows
 Test with paper trading first
 Monitor agent performance
 Use risk management agents
 Log all agent decisions
 Review and optimize regularly`,codeExample:`// Agent workflow configuration:

// 1. Create data source node
data_source = create_node({
  type: "data_source",
  source: "yahoo_finance",
  symbols: ["AAPL", "MSFT", "GOOGL"],
  interval: "1m"
});

// 2. Create analysis agent
agent = create_node({
  type: "agent",
  style: "warren_buffett",
  parameters: {
    min_roe: 15,
    max_pe: 25,
    moat_focus: true
  }
});

// 3. Create output nodes
portfolio = create_node({
  type: "output",
  action: "rebalance_portfolio",
  target_allocation: {
    "AAPL": 0.35,
    "MSFT": 0.35,
    "GOOGL": 0.30
  }
});

alerts = create_node({
  type: "output",
  action: "send_alerts",
  channels: ["email", "desktop"]
});

// 4. Connect nodes
connect(data_source, agent, "input-0");
connect(agent, portfolio, "output-0");
connect(agent, alerts, "output-1");

// 5. Start workflow
workflow.start();

// Monitor workflow
workflow.status();
// Running: 
// Nodes: 4
// Connections: 3
// Last execution: 10s ago
// Signals generated: 2 buy, 0 sell`}]},ec=[JH,ZH,QH,e7,t7],I2=()=>{const s=zi.getTheme();return{ORANGE:s.colors.primary,WHITE:s.colors.text,GREEN:s.colors.secondary,BLUE:s.colors.info,CYAN:s.colors.accent,YELLOW:s.colors.warning,GRAY:s.colors.textMuted,DARK_BG:s.colors.background,PANEL_BG:s.colors.panel,CODE_BG:"#1a1a1a"}};I2();function r7(){const{colors:s}=Er(),e=I2(),[r,n]=S.useState(new Date),[i,o]=S.useState("getting-started"),[a,l]=S.useState(""),[d,p]=S.useState(["getting-started","finscript"]);S.useEffect(()=>{const w=setInterval(()=>n(new Date),1e3);return()=>clearInterval(w)},[]);const f=w=>{p(y=>y.includes(w)?y.filter(C=>C!==w):[...y,w])},h=ec.map(w=>({...w,subsections:w.subsections.filter(y=>a===""||y.title.toLowerCase().includes(a.toLowerCase())||y.content.toLowerCase().includes(a.toLowerCase()))})).filter(w=>w.subsections.length>0),x=ec.flatMap(w=>w.subsections).find(w=>w.id===i),m=ec.length,b=ec.reduce((w,y)=>w+y.subsections.length,0);return t.jsxs("div",{style:{height:"100%",backgroundColor:e.DARK_BG,color:e.WHITE,fontFamily:"Consolas, monospace",overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        *::-webkit-scrollbar-track {
          background: #1a1a1a;
        }
        *::-webkit-scrollbar-thumb {
          background: #404040;
          border-radius: 4px;
        }
        *::-webkit-scrollbar-thumb:hover {
          background: #525252;
        }

        .docs-content h1 {
          color: ${e.ORANGE};
          font-size: 18px;
          font-weight: bold;
          margin: 0 0 16px 0;
          font-family: 'Consolas', monospace;
          letter-spacing: 0.5px;
          text-transform: uppercase;
        }
        .docs-content h2 {
          color: ${e.CYAN};
          font-size: 14px;
          font-weight: bold;
          margin: 16px 0 8px 0;
          font-family: 'Consolas', monospace;
          text-transform: uppercase;
        }
        .docs-content h3 {
          color: ${e.WHITE};
          font-size: 12px;
          font-weight: bold;
          margin: 12px 0 6px 0;
          font-family: 'Consolas', monospace;
        }
        .docs-content p {
          line-height: 1.6;
          margin: 0 0 12px 0;
          font-size: 11px;
          font-family: 'Consolas', monospace;
          color: ${e.WHITE};
        }
        .docs-content ul {
          margin: 12px 0;
          padding-left: 0;
          list-style: none;
        }
        .docs-content li {
          margin: 6px 0;
          padding-left: 20px;
          line-height: 1.5;
          font-size: 11px;
          font-family: 'Consolas', monospace;
          position: relative;
          color: ${e.WHITE};
        }
        .docs-content li::before {
          content: '';
          position: absolute;
          left: 8px;
          color: ${e.ORANGE};
          font-size: 8px;
        }
        .docs-content strong {
          color: ${e.CYAN};
          font-weight: bold;
        }
        .docs-content code {
          background: rgba(255, 165, 0, 0.1);
          padding: 2px 4px;
          border-radius: 2px;
          font-family: 'Consolas', monospace;
          font-size: 11px;
          color: ${e.ORANGE};
        }
      `}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:e.PANEL_BG,borderBottom:`1px solid ${e.GRAY}`,fontSize:"13px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:e.ORANGE,fontWeight:"bold"},children:"FINCEPT"}),t.jsx("span",{style:{color:e.WHITE},children:"DOCUMENTATION TERMINAL"}),t.jsx("span",{style:{color:e.GRAY},children:"|"}),t.jsx("span",{style:{color:e.WHITE,fontSize:"11px"},children:r.toISOString().replace("T"," ").substring(0,19)})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:e.GRAY,fontSize:"11px"},children:"SECTIONS:"}),t.jsx("span",{style:{color:e.CYAN,fontSize:"11px",fontWeight:"bold"},children:m}),t.jsx("span",{style:{color:e.GRAY},children:"|"}),t.jsx("span",{style:{color:e.GREEN,fontSize:"11px"},children:"TOPICS:"}),t.jsx("span",{style:{color:e.GREEN,fontSize:"11px",fontWeight:"bold"},children:b})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:e.PANEL_BG,borderBottom:`1px solid ${e.GRAY}`,fontSize:"12px",gap:"8px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[t.jsx(Ho,{size:14,style:{color:e.ORANGE,flexShrink:0}}),t.jsx("input",{type:"text",placeholder:"Search documentation...",value:a,onChange:w=>l(w.target.value),style:{flex:1,backgroundColor:e.DARK_BG,border:`1px solid ${e.GRAY}`,color:e.WHITE,fontSize:"11px",fontFamily:"Consolas, monospace",padding:"4px 8px",outline:"none",maxWidth:"400px"}}),a&&t.jsx("button",{onClick:()=>l(""),style:{backgroundColor:e.GRAY,color:"black",border:"none",padding:"4px 8px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"CLEAR"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:e.GREEN,fontSize:"14px"},children:""}),t.jsx("span",{style:{color:e.GREEN,fontSize:"11px",fontWeight:"bold"},children:"READY"})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",minHeight:0,overflow:"hidden"},children:[t.jsxs("div",{style:{width:"280px",borderRight:`1px solid ${e.GRAY}`,backgroundColor:e.PANEL_BG,overflowY:"auto",flexShrink:0},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"12px",fontWeight:"bold",padding:"12px",borderBottom:`1px solid ${e.GRAY}`,letterSpacing:"0.5px"},children:"NAVIGATION"}),h.map(w=>t.jsxs("div",{style:{borderBottom:`1px solid ${e.GRAY}`},children:[t.jsxs("div",{onClick:()=>f(w.id),style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",backgroundColor:d.includes(w.id)?e.DARK_BG:"transparent",cursor:"pointer",borderLeft:`4px solid ${d.includes(w.id)?e.ORANGE:"transparent"}`,transition:"all 0.2s"},onMouseEnter:y=>{d.includes(w.id)||(y.currentTarget.style.backgroundColor="#1a1a1a")},onMouseLeave:y=>{d.includes(w.id)||(y.currentTarget.style.backgroundColor="transparent")},children:[t.jsx(Rd,{size:12,style:{color:e.ORANGE,transform:d.includes(w.id)?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"}}),t.jsx(w.icon,{size:14,style:{color:e.ORANGE}}),t.jsx("span",{style:{flex:1,fontSize:"11px",fontWeight:"bold",color:e.WHITE},children:w.title.toUpperCase()}),t.jsxs("span",{style:{fontSize:"9px",color:e.GRAY},children:["(",w.subsections.length,")"]})]}),d.includes(w.id)&&t.jsx("div",{style:{backgroundColor:e.DARK_BG},children:w.subsections.map(y=>t.jsx("div",{onClick:()=>o(y.id),style:{padding:"6px 12px 6px 40px",fontSize:"10px",color:i===y.id?e.ORANGE:e.GRAY,backgroundColor:i===y.id?"rgba(255, 165, 0, 0.1)":"transparent",cursor:"pointer",borderLeft:`4px solid ${i===y.id?e.ORANGE:"transparent"}`,transition:"all 0.15s"},onMouseEnter:C=>{i!==y.id&&(C.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.05)",C.currentTarget.style.color=e.WHITE)},onMouseLeave:C=>{i!==y.id&&(C.currentTarget.style.backgroundColor="transparent",C.currentTarget.style.color=e.GRAY)},children:y.title},y.id))})]},w.id))]}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[x&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{backgroundColor:e.PANEL_BG,borderBottom:`1px solid ${e.GRAY}`,padding:"8px 12px",flexShrink:0},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(ri,{size:14,style:{color:e.CYAN}}),t.jsx("span",{style:{color:e.CYAN,fontSize:"12px",fontWeight:"bold"},children:x.title.toUpperCase()}),t.jsx("span",{style:{color:e.GRAY},children:"|"}),t.jsx("span",{style:{color:e.GRAY,fontSize:"10px"},children:ec.find(w=>w.subsections.some(y=>y.id===x.id))?.title||"Documentation"})]})}),t.jsx("div",{style:{flex:1,overflowY:"auto",padding:"20px",backgroundColor:"#0a0a0a"},children:t.jsxs("div",{style:{maxWidth:"900px"},children:[t.jsx("div",{style:{display:"inline-block",padding:"4px 8px",backgroundColor:"rgba(255, 165, 0, 0.15)",border:`1px solid ${e.ORANGE}`,fontSize:"9px",fontWeight:"bold",color:e.ORANGE,marginBottom:"12px",letterSpacing:"0.5px"},children:ec.find(w=>w.subsections.some(y=>y.id===x.id))?.title.toUpperCase()||"DOCUMENTATION"}),t.jsx("h1",{className:"docs-content",children:x.title}),t.jsx("div",{className:"docs-content",style:{fontSize:"11px",lineHeight:"1.6",color:e.WHITE},children:x.content.split(`

`).map((w,y)=>{const C=w.split(`
`);if(C.some(E=>E.startsWith(""))){const E=C.find(k=>k.startsWith("**")&&k.endsWith("**")),j=C.filter(k=>k.startsWith(""));return t.jsxs("div",{style:{marginBottom:"16px"},children:[E&&t.jsx("h3",{style:{color:e.CYAN,fontWeight:"bold",marginBottom:"8px",fontSize:"12px",fontFamily:"Consolas, monospace"},children:E.replace(/\*\*/g,"")}),t.jsx("ul",{style:{margin:"0",paddingLeft:"0",listStyle:"none"},children:j.map((k,A)=>t.jsx("li",{children:k.substring(1).trim()},A))})]},y)}else return t.jsx("p",{style:{marginBottom:"12px",fontFamily:"Consolas, monospace",fontSize:"11px",lineHeight:"1.6"},children:w},y)})}),x.codeExample&&t.jsxs("div",{style:{marginTop:"24px",backgroundColor:e.PANEL_BG,border:`1px solid ${e.GRAY}`,borderLeft:`4px solid ${e.GREEN}`,padding:"16px"},children:[t.jsxs("div",{style:{color:e.ORANGE,fontSize:"11px",fontWeight:"bold",marginBottom:"8px",display:"flex",alignItems:"center",gap:"8px",fontFamily:"Consolas, monospace"},children:[t.jsx(Yp,{size:14}),"CODE EXAMPLE"]}),t.jsx("pre",{style:{backgroundColor:"#0d0d0d",border:`1px solid ${e.GRAY}`,padding:"12px",overflowX:"auto",fontSize:"11px",lineHeight:"1.5",color:e.GREEN,fontFamily:"Consolas, monospace",margin:0},children:t.jsx("code",{children:x.codeExample})})]})]})})]}),!x&&t.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#0a0a0a",padding:"40px"},children:t.jsxs("div",{style:{textAlign:"center",maxWidth:"600px"},children:[t.jsx(d4,{size:64,style:{marginBottom:"24px",opacity:.3,color:e.ORANGE}}),t.jsx("div",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"12px",color:e.ORANGE,fontFamily:"Consolas, monospace",letterSpacing:"0.5px"},children:"FINCEPT TERMINAL DOCUMENTATION"}),t.jsx("div",{style:{fontSize:"11px",lineHeight:"1.6",marginBottom:"24px",color:e.GRAY,fontFamily:"Consolas, monospace"},children:"Select a topic from the navigation panel to view comprehensive guides and API reference."}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px",textAlign:"left",marginTop:"32px"},children:ec.slice(0,4).map(w=>t.jsxs("div",{onClick:()=>{f(w.id),o(w.subsections[0]?.id)},style:{padding:"16px",backgroundColor:e.PANEL_BG,border:`1px solid ${e.GRAY}`,borderLeft:`4px solid ${e.ORANGE}`,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:y=>{y.currentTarget.style.borderColor=e.ORANGE,y.currentTarget.style.backgroundColor=e.DARK_BG},onMouseLeave:y=>{y.currentTarget.style.borderColor=e.GRAY,y.currentTarget.style.borderLeftColor=e.ORANGE,y.currentTarget.style.backgroundColor=e.PANEL_BG},children:[t.jsx(w.icon,{size:20,style:{color:e.ORANGE,marginBottom:"8px"}}),t.jsx("div",{style:{fontSize:"11px",fontWeight:"bold",color:e.WHITE,marginBottom:"4px",fontFamily:"Consolas, monospace"},children:w.title.toUpperCase()}),t.jsxs("div",{style:{fontSize:"10px",color:e.GRAY,fontFamily:"Consolas, monospace"},children:[w.subsections.length," topics available"]})]},w.id))})]})})]})]}),t.jsxs("div",{style:{borderTop:`1px solid ${e.GRAY}`,backgroundColor:e.PANEL_BG,padding:"6px 12px",fontSize:"10px",color:e.GRAY,flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("span",{children:"Fincept Terminal Documentation v3.0 | Complete API Reference & Guides"}),t.jsxs("span",{children:["Sections: ",m," | Topics: ",b]})]}),t.jsx("span",{children:x?`Current: ${x.title}`:"Select a topic to begin"})]})]})}function n7(){const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState([]),[l,d]=S.useState(null),[p,f]=S.useState("Ship"),[h,x]=S.useState(!0),[m,b]=S.useState(!0),[w,y]=S.useState(!0),[C,T]=S.useState(!0),[E,j]=S.useState(!0),[k,A]=S.useState({timestamp:new Date().toISOString(),threat_level:"low",active_vessels:1247,monitored_routes:48,trade_volume:"$847.3B"}),R=S.useRef(null),M=[{name:"Mumbai  Rotterdam",value:"$45B",status:"active",vessels:23,coordinates:[[18.9388,72.8354],[51.9553,4.1392]]},{name:"Mumbai  Shanghai",value:"$156B",status:"active",vessels:89,coordinates:[[18.9388,72.8354],[31.3548,121.6431]]},{name:"Mumbai  Singapore",value:"$89B",status:"active",vessels:45,coordinates:[[18.9388,72.8354],[1.2644,103.8224]]},{name:"Chennai  Tokyo",value:"$67B",status:"delayed",vessels:34,coordinates:[[13.0827,80.2707],[35.4437,139.638]]},{name:"Kolkata  Hong Kong",value:"$45B",status:"active",vessels:28,coordinates:[[22.5726,88.3639],[22.2855,114.1577]]},{name:"Mumbai  Dubai",value:"$78B",status:"critical",vessels:12,coordinates:[[18.9388,72.8354],[24.9857,55.0272]]},{name:"Mumbai  New York",value:"$123B",status:"active",vessels:56,coordinates:[[18.9388,72.8354],[40.6655,-74.0781]]},{name:"Chennai  Sydney",value:"$54B",status:"active",vessels:31,coordinates:[[13.0827,80.2707],[-33.9544,151.2093]]},{name:"Cochin  Klang",value:"$34B",status:"active",vessels:19,coordinates:[[9.9667,76.2667],[3.0048,101.3975]]},{name:"Mumbai  Cape Town",value:"$28B",status:"delayed",vessels:8,coordinates:[[18.9388,72.8354],[-33.9055,18.4232]]}],P=()=>{a([])},I=[{name:"Mumbai Port",lat:18.9388,lng:72.8354,type:"Port"},{name:"Shanghai Port",lat:31.3548,lng:121.6431,type:"Port"},{name:"Singapore Port",lat:1.2644,lng:103.8224,type:"Port"},{name:"Hong Kong Port",lat:22.2855,lng:114.1577,type:"Port"},{name:"Rotterdam Port",lat:51.9553,lng:4.1392,type:"Port"},{name:"Dubai Port",lat:24.9857,lng:55.0272,type:"Port"}],O=B=>{a([...o,{...B,title:B.name}])};return S.useEffect(()=>{const B=setInterval(()=>{A(F=>({...F,timestamp:new Date().toISOString(),active_vessels:F.active_vessels+Math.floor(Math.random()*10-5)}))},5e3);return()=>clearInterval(B)},[]),t.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#000"},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar { width: 6px; height: 6px; }
        *::-webkit-scrollbar-track { background: #0a0a0a; }
        *::-webkit-scrollbar-thumb { background: #1a1a1a; border-radius: 3px; }
        *::-webkit-scrollbar-thumb:hover { background: #2a2a2a; }
      `}),t.jsxs("div",{style:{borderBottom:"2px solid #00ff00",padding:"8px 16px",background:"linear-gradient(180deg, #0a0a0a 0%, #000 100%)",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("span",{style:{color:"#00ff00",fontSize:"14px",fontWeight:"bold",letterSpacing:"2px"},children:" FINCEPT MARITIME INTELLIGENCE"}),t.jsx("div",{style:{width:"1px",height:"16px",background:"#00ff00"}}),t.jsx("span",{style:{color:"#0ff",fontSize:"10px"},children:"CLASSIFIED // TRADE ROUTE ANALYSIS"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("button",{onClick:()=>{const B=!E;j(B),R.current?.contentWindow&&R.current.contentWindow.toggleRotation?.(B)},style:{background:E?"#0a0a0a":"#1a1a1a",color:E?"#00ff00":"#888",border:`1px solid ${E?"#00ff00":"#444"}`,padding:"4px 10px",fontSize:"9px",cursor:"pointer",fontWeight:"bold",fontFamily:"Consolas, monospace",transition:"all 0.2s"},children:E?" ROTATING":" PAUSED"}),t.jsxs("span",{style:{color:k.threat_level==="critical"?"#ff0000":k.threat_level==="high"?"#ff8c00":k.threat_level==="medium"?"#ffd700":"#00ff00",fontSize:"10px",fontWeight:"bold"},children:["THREAT: ",k.threat_level.toUpperCase()]}),t.jsx("span",{style:{color:"#888",fontSize:"9px"},children:new Date(k.timestamp).toLocaleString()})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",minHeight:0,overflow:"hidden"},children:[t.jsxs("div",{style:{width:"280px",borderRight:"1px solid #1a1a1a",display:"flex",flexDirection:"column",background:"#000",flexShrink:0},children:[t.jsxs("div",{style:{padding:"12px",borderBottom:"1px solid #1a1a1a"},children:[t.jsx("div",{style:{color:"#00ff00",fontSize:"10px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"1px"},children:"GLOBAL INTEL"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px"},children:"ACTIVE VESSELS"}),t.jsx("div",{style:{color:"#0ff",fontSize:"16px",fontWeight:"bold"},children:k.active_vessels})]}),t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px"},children:"ROUTES"}),t.jsx("div",{style:{color:"#0ff",fontSize:"16px",fontWeight:"bold"},children:k.monitored_routes})]}),t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px"},children:"AIRCRAFT"}),t.jsx("div",{style:{color:"rgba(255, 200, 100, 0.95)",fontSize:"16px",fontWeight:"bold"},children:"342"})]}),t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px"},children:"SATELLITES"}),t.jsx("div",{style:{color:"rgba(138, 43, 226, 0.9)",fontSize:"16px",fontWeight:"bold"},children:"13"})]}),t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px",gridColumn:"span 2"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px"},children:"TRADE VOLUME (24H)"}),t.jsx("div",{style:{color:"#00ff00",fontSize:"16px",fontWeight:"bold"},children:k.trade_volume})]}),t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px"},children:"MAJOR PORTS"}),t.jsx("div",{style:{color:"#ffa500",fontSize:"14px",fontWeight:"bold"},children:"6"})]}),t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px"},children:"AIRPORTS"}),t.jsx("div",{style:{color:"#9d4edd",fontSize:"14px",fontWeight:"bold"},children:"8"})]})]})]}),t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px",minHeight:0},children:[t.jsx("div",{style:{color:"#00ff00",fontSize:"10px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"1px"},children:"TRADE CORRIDORS"}),M.map((B,F)=>t.jsxs("div",{onClick:()=>d(B),style:{background:l?.name===B.name?"#1a1a1a":"#0a0a0a",border:`1px solid ${B.status==="critical"?"#ff0000":B.status==="delayed"?"#ffd700":"#1a1a1a"}`,padding:"8px",marginBottom:"6px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:z=>z.currentTarget.style.background="#1a1a1a",onMouseLeave:z=>z.currentTarget.style.background=l?.name===B.name?"#1a1a1a":"#0a0a0a",children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsx("span",{style:{color:"#0ff",fontSize:"9px",fontWeight:"bold"},children:B.name}),t.jsx("span",{style:{color:B.status==="critical"?"#ff0000":B.status==="delayed"?"#ffd700":"#00ff00",fontSize:"7px",padding:"2px 4px",background:"#000",border:`1px solid ${B.status==="critical"?"#ff0000":B.status==="delayed"?"#ffd700":"#00ff00"}`},children:B.status.toUpperCase()})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs("span",{style:{color:"#888",fontSize:"8px"},children:["Value: ",B.value]}),t.jsxs("span",{style:{color:"#888",fontSize:"8px"},children:["Ships: ",B.vessels]})]})]},F))]}),t.jsxs("div",{style:{padding:"12px",borderTop:"1px solid #1a1a1a"},children:[t.jsx("div",{style:{color:"#00ff00",fontSize:"10px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"1px"},children:"MAP CONTROLS"}),t.jsxs("div",{style:{display:"flex",gap:"6px",marginBottom:"6px"},children:[t.jsx("button",{onClick:()=>{x(!h),R.current?.contentWindow&&R.current.contentWindow.toggleRoutes?.()},style:{flex:1,background:h?"#0ff":"#0a0a0a",color:h?"#000":"#0ff",border:"1px solid #0ff",padding:"6px",fontSize:"9px",cursor:"pointer",fontWeight:"bold"},children:"ROUTES"}),t.jsx("button",{onClick:()=>{b(!m),R.current?.contentWindow&&R.current.contentWindow.toggleShips?.()},style:{flex:1,background:m?"#0ff":"#0a0a0a",color:m?"#000":"#0ff",border:"1px solid #0ff",padding:"6px",fontSize:"9px",cursor:"pointer",fontWeight:"bold"},children:"VESSELS"})]}),t.jsxs("div",{style:{display:"flex",gap:"6px",marginBottom:"6px"},children:[t.jsx("button",{onClick:()=>{y(!w),R.current?.contentWindow&&R.current.contentWindow.togglePlanes?.()},style:{flex:1,background:w?"rgba(255, 200, 100, 0.9)":"#0a0a0a",color:w?"#000":"rgba(255, 200, 100, 0.9)",border:"1px solid rgba(255, 200, 100, 0.9)",padding:"6px",fontSize:"9px",cursor:"pointer",fontWeight:"bold"},children:"AIRCRAFT"}),t.jsx("button",{onClick:()=>{T(!C),R.current?.contentWindow&&R.current.contentWindow.toggleSatellites?.()},style:{flex:1,background:C?"rgba(138, 43, 226, 0.9)":"#0a0a0a",color:C?"#fff":"rgba(138, 43, 226, 0.9)",border:"1px solid rgba(138, 43, 226, 0.9)",padding:"6px",fontSize:"9px",cursor:"pointer",fontWeight:"bold"},children:"SATELLITES"})]}),t.jsx("button",{onClick:()=>{P(),R.current?.contentWindow&&R.current.contentWindow.clearMarkers?.()},style:{width:"100%",background:"#0a0a0a",color:"#ff0000",border:"1px solid #ff0000",padding:"6px",fontSize:"9px",cursor:"pointer",fontWeight:"bold"},children:"CLEAR ALL MARKERS"})]})]}),t.jsxs("div",{style:{flex:1,position:"relative",minWidth:0,overflow:"hidden"},children:[t.jsx("iframe",{ref:R,srcDoc:`
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body { margin: 0; padding: 0; background: #000; overflow: hidden; }
    #globeViz { height: 100vh; width: 100vw; background: #000; position: absolute; top: 0; left: 0; }
    #mapViz { height: 100vh; width: 100vw; position: absolute; top: 0; left: 0; display: none; }
    #modeIndicator {
      position: absolute;
      top: 16px;
      right: 16px;
      background: rgba(0, 255, 255, 0.9);
      color: #000;
      padding: 8px 16px;
      border-radius: 4px;
      font-family: 'Consolas', monospace;
      font-size: 12px;
      font-weight: bold;
      z-index: 1000;
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }
  </style>
</head>
<body>
  <div id="modeIndicator">3D GLOBE MODE</div>
  <div id="globeViz"></div>
  <div id="mapViz"></div>
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"><\/script>
  <script src="https://unpkg.com/globe.gl@2.27.2/dist/globe.gl.min.js"><\/script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"><\/script>
  <script>
    console.log('Initializing Hybrid Globe/Map System...');

    // Wait for libraries to load
    setTimeout(() => {
      try {
        console.log('Creating globe...');

        // Create professional globe with natural appearance
        const world = Globe()
          (document.getElementById('globeViz'))
          .globeImageUrl('https://unpkg.com/three-globe@2.31.1/example/img/earth-blue-marble.jpg')
          .bumpImageUrl('https://unpkg.com/three-globe@2.31.1/example/img/earth-topology.png')
          .backgroundColor('#0a0a0a')
          .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png')
          .showAtmosphere(true)
          .atmosphereColor('#4a90e2')
          .atmosphereAltitude(0.12)
          .width(window.innerWidth)
          .height(window.innerHeight);

        console.log('Globe created successfully');

        // Initialize 2D Leaflet map for close zoom (lazy - will initialize when needed)
        let map2D = null;

        function initMap2D() {
          if (!map2D) {
            map2D = L.map('mapViz', {
              zoomControl: true,
              attributionControl: false,
              preferCanvas: false
            }).setView([20, 75], 12);

            // Add satellite imagery layer (Google Satellite)
            L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
              attribution: 'FINCEPT MARITIME INTELLIGENCE | Satellite Imagery',
              maxZoom: 20,
              minZoom: 3,
              subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
            }).addTo(map2D);

            // Monitor 2D map zoom to switch back to 3D
            map2D.on('zoomend', function() {
              const zoom = map2D.getZoom();
              console.log('2D map zoom:', zoom);
              if (zoom < 8 && currentMode === '2D') {
                const center = map2D.getCenter();
                switchTo3D(center.lat, center.lng, 2.0);
              }
            });

            // Force map to resize and load tiles
            setTimeout(() => {
              map2D.invalidateSize();
              console.log('2D map resized and tiles loading');
            }, 100);

            console.log('2D map initialized');
          }
        }

        console.log('2D map setup ready');

        // Professional balanced lighting
        const scene = world.scene();
        const ambientLight = new THREE.AmbientLight(0x808080, 0.7);  // Balanced ambient light
        const directionalLight = new THREE.DirectionalLight(0xaaaaaa, 0.6);  // Natural directional light
        directionalLight.position.set(5, 3, 5);
        scene.add(ambientLight);
        scene.add(directionalLight);

        console.log('Professional lighting added');

        // Set initial point of view
        world.pointOfView({ lat: 20, lng: 75, altitude: 2.0 }, 1000);

        console.log('Camera positioned');

        // Hybrid mode state
        let currentMode = '3D'; // '3D' or '2D'
        let lastGlobeView = { lat: 20, lng: 75, altitude: 2.0 };
        let targetCoords = { lat: 20, lng: 75 }; // Track where user is actually looking
        const ZOOM_THRESHOLD = 0.3; // Switch to 2D when altitude < 0.3 (very close)

      var markers = [];
      var allArcs = [];
      var allLabels = [];
      var planeLabels = [];
      var showRoutesFlag = true;
      var showShipsFlag = true;
      var showPlanesFlag = true;

      var oceanRoutes = [
        // Mumbai Port (18.9388 N, 72.8354 E) - actual port coordinates
        { name: "Mumbai  Rotterdam", start: {lat: 18.9388, lng: 72.8354}, end: {lat: 51.9553, lng: 4.1392}, value: "$45B", vessels: 23, color: 'rgba(100, 180, 255, 0.6)', width: 0.8 },
        { name: "Mumbai  Shanghai", start: {lat: 18.9388, lng: 72.8354}, end: {lat: 31.3548, lng: 121.6431}, value: "$156B", vessels: 89, color: 'rgba(120, 200, 255, 0.7)', width: 1.2 },
        { name: "Mumbai  Singapore", start: {lat: 18.9388, lng: 72.8354}, end: {lat: 1.2644, lng: 103.8224}, value: "$89B", vessels: 45, color: 'rgba(100, 180, 255, 0.65)', width: 1.0 },
        // Chennai Port (13.0827 N, 80.2707 E)
        { name: "Chennai  Tokyo", start: {lat: 13.0827, lng: 80.2707}, end: {lat: 35.4437, lng: 139.6380}, value: "$67B", vessels: 34, color: 'rgba(150, 220, 255, 0.6)', width: 0.9 },
        // Kolkata Port (22.5726 N, 88.3639 E)
        { name: "Kolkata  Hong Kong", start: {lat: 22.5726, lng: 88.3639}, end: {lat: 22.2855, lng: 114.1577}, value: "$45B", vessels: 28, color: 'rgba(100, 180, 255, 0.55)', width: 0.8 },
        // Mumbai  Dubai (Port Jebel Ali: 24.9857 N, 55.0272 E)
        { name: "Mumbai  Dubai", start: {lat: 18.9388, lng: 72.8354}, end: {lat: 24.9857, lng: 55.0272}, value: "$78B", vessels: 12, color: 'rgba(255, 160, 100, 0.6)', width: 0.9 },
        // Mumbai  New York (Port of NY/NJ: 40.6655 N, 74.0781 W)
        { name: "Mumbai  New York", start: {lat: 18.9388, lng: 72.8354}, end: {lat: 40.6655, lng: -74.0781}, value: "$123B", vessels: 56, color: 'rgba(120, 200, 255, 0.75)', width: 1.2 },
        // Chennai  Sydney (Port Botany: 33.9544 S, 151.2093 E)
        { name: "Chennai  Sydney", start: {lat: 13.0827, lng: 80.2707}, end: {lat: -33.9544, lng: 151.2093}, value: "$54B", vessels: 31, color: 'rgba(130, 190, 255, 0.6)', width: 0.9 },
        // Cochin Port (9.9667 N, 76.2667 E)  Port Klang, Malaysia (3.0048 N, 101.3975 E)
        { name: "Cochin  Klang", start: {lat: 9.9667, lng: 76.2667}, end: {lat: 3.0048, lng: 101.3975}, value: "$34B", vessels: 19, color: 'rgba(180, 200, 255, 0.5)', width: 0.7 },
        // Mumbai  Cape Town (33.9055 S, 18.4232 E)
        { name: "Mumbai  Cape Town", start: {lat: 18.9388, lng: 72.8354}, end: {lat: -33.9055, lng: 18.4232}, value: "$28B", vessels: 8, color: 'rgba(160, 180, 255, 0.5)', width: 0.7 }
      ];

      var airRoutes = [
        // Major international air cargo routes
        { name: "Mumbai  London", start: {lat: 19.0896, lng: 72.8656}, end: {lat: 51.4700, lng: -0.4543}, value: "$12B", flights: 45, color: 'rgba(255, 200, 100, 0.7)', width: 0.6 },
        { name: "Delhi  New York", start: {lat: 28.5562, lng: 77.1000}, end: {lat: 40.6413, lng: -73.7781}, value: "$18B", flights: 67, color: 'rgba(255, 200, 100, 0.75)', width: 0.8 },
        { name: "Mumbai  Dubai", start: {lat: 19.0896, lng: 72.8656}, end: {lat: 25.2532, lng: 55.3657}, value: "$22B", flights: 123, color: 'rgba(255, 200, 100, 0.8)', width: 0.9 },
        { name: "Bangalore  Singapore", start: {lat: 13.1979, lng: 77.7063}, end: {lat: 1.3644, lng: 103.9915}, value: "$8B", flights: 89, color: 'rgba(255, 200, 100, 0.65)', width: 0.6 },
        { name: "Delhi  Frankfurt", start: {lat: 28.5562, lng: 77.1000}, end: {lat: 50.0379, lng: 8.5622}, value: "$15B", flights: 56, color: 'rgba(255, 200, 100, 0.7)', width: 0.7 },
        { name: "Mumbai  Hong Kong", start: {lat: 19.0896, lng: 72.8656}, end: {lat: 22.3080, lng: 113.9185}, value: "$11B", flights: 78, color: 'rgba(255, 200, 100, 0.65)', width: 0.6 },
        { name: "Chennai  Tokyo", start: {lat: 12.9941, lng: 80.1709}, end: {lat: 35.7720, lng: 140.3929}, value: "$9B", flights: 34, color: 'rgba(255, 200, 100, 0.6)', width: 0.6 },
        { name: "Delhi  Sydney", start: {lat: 28.5562, lng: 77.1000}, end: {lat: -33.9399, lng: 151.1753}, value: "$7B", flights: 28, color: 'rgba(255, 200, 100, 0.6)', width: 0.5 }
      ];

      function createRoutes() {
        // Combine ocean and air routes
        const oceanArcsData = oceanRoutes.map(route => ({
          startLat: route.start.lat,
          startLng: route.start.lng,
          endLat: route.end.lat,
          endLng: route.end.lng,
          color: route.color,
          name: route.name,
          value: route.value,
          width: route.width || 0.5,
          type: 'ocean'
        }));

        const airArcsData = airRoutes.map(route => ({
          startLat: route.start.lat,
          startLng: route.start.lng,
          endLat: route.end.lat,
          endLng: route.end.lng,
          color: route.color,
          name: route.name,
          value: route.value,
          width: route.width || 0.5,
          type: 'air'
        }));

        const allArcsData = [...oceanArcsData, ...airArcsData];
        allArcs = allArcsData;
        world.arcsData(allArcsData)
          .arcColor('color')
          .arcStroke((d) => d.width)         // Thin, professional lines
          .arcDashLength(1.0)                // Full solid lines
          .arcDashGap(0)                     // No gaps - complete lines
          .arcDashInitialGap(0)              // Start from beginning
          .arcDashAnimateTime(0)             // No animation to avoid cutting
          .arcAltitude((d) => d.type === 'air' ? 0.15 : 0.1)  // Higher for air, moderate for ocean
          .arcAltitudeAutoScale(0.5)         // More curve for visibility
          .arcLabel((d) => \`
            <div style="background: rgba(10,10,10,0.92); padding: 6px 10px; border-left: 2px solid \${d.type === 'air' ? 'rgba(255, 200, 100, 0.8)' : 'rgba(100, 180, 255, 0.8)'}; font-family: 'Segoe UI', sans-serif; font-size: 11px; box-shadow: 0 2px 8px rgba(0,0,0,0.4);">
              <div style="color: #e0e0e0; font-weight: 500; margin-bottom: 2px;">\${d.type === 'air' ? '' : ''} \${d.name}</div>
              <div style="color: #999; font-size: 9px;">\${d.value}</div>
            </div>
          \`);

        // Extract unique ports and airports
        const uniquePorts = new Map();
        oceanRoutes.forEach(route => {
          const startName = route.name.split('  ')[0];
          const endName = route.name.split('  ')[1];

          if (!uniquePorts.has(startName)) {
            uniquePorts.set(startName, { lat: route.start.lat, lng: route.start.lng, type: 'port' });
          }
          if (!uniquePorts.has(endName)) {
            uniquePorts.set(endName, { lat: route.end.lat, lng: route.end.lng, type: 'port' });
          }
        });

        const uniqueAirports = new Map();
        airRoutes.forEach(route => {
          const startName = route.name.split('  ')[0];
          const endName = route.name.split('  ')[1];

          if (!uniqueAirports.has(startName)) {
            uniqueAirports.set(startName, { lat: route.start.lat, lng: route.start.lng, type: 'airport' });
          }
          if (!uniqueAirports.has(endName)) {
            uniqueAirports.set(endName, { lat: route.end.lat, lng: route.end.lng, type: 'airport' });
          }
        });

        const portPoints = Array.from(uniquePorts.entries()).map(([name, data]) => ({
          lat: data.lat,
          lng: data.lng,
          size: 0.6,
          color: 'rgba(255, 180, 100, 0.85)',  // Orange for ports
          label: name,
          type: 'port'
        }));

        const airportPoints = Array.from(uniqueAirports.entries()).map(([name, data]) => ({
          lat: data.lat,
          lng: data.lng,
          size: 0.5,
          color: 'rgba(180, 100, 255, 0.85)',  // Purple for airports
          label: name,
          type: 'airport'
        }));

        const allPoints = [...portPoints, ...airportPoints];

        // Professional markers - ports (orange) and airports (purple)
        world.pointsData(allPoints)
          .pointAltitude(0.002)
          .pointRadius('size')
          .pointColor('color')
          .pointLabel((d) => \`
            <div style="background: rgba(10,10,10,0.92); padding: 5px 9px; border-left: 2px solid \${d.color}; font-family: 'Segoe UI', sans-serif; font-size: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.4);">
              <span style="color: #e0e0e0; font-weight: 500;">\${d.type === 'port' ? '' : ''} \${d.label}</span>
            </div>
          \`);
      }

      function createShips() {
        // Professional ship visualization using proper globe coordinates
        const shipData = oceanRoutes.map((route, routeIdx) => ({
          routeIdx: routeIdx,
          progress: Math.random(),
          startLat: route.start.lat,
          startLng: route.start.lng,
          endLat: route.end.lat,
          endLng: route.end.lng,
          label: route.name,
          value: route.value,
          vessels: route.vessels
        }));

        // Calculate interpolated positions along great circle arc
        function interpolateArc(startLat, startLng, endLat, endLng, progress) {
          // Simple linear interpolation for latitude and longitude
          const lat = startLat + (endLat - startLat) * progress;
          const lng = startLng + (endLng - startLng) * progress;
          return { lat, lng };
        }

        // Generate ship positions
        function generateShipPoints(shipsData) {
          return shipsData.map(ship => {
            const pos = interpolateArc(
              ship.startLat,
              ship.startLng,
              ship.endLat,
              ship.endLng,
              ship.progress
            );
            return {
              lat: pos.lat,
              lng: pos.lng,
              size: 0.15,
              color: 'rgba(100, 180, 255, 0.95)',
              altitude: 0.003,
              label: ship.label,
              value: ship.value,
              vessels: ship.vessels
            };
          });
        }

        allLabels = shipData;

        // Use htmlElementsData for ships with ship icons (similar to planes)
        const initialShipPoints = generateShipPoints(shipData);
        world.customLayerData(initialShipPoints)
          .customThreeObject(d => {
            // Create HTML element for ship icon
            const el = document.createElement('div');
            el.innerHTML = '';
            el.style.color = 'rgba(100, 180, 255, 0.95)';
            el.style.fontSize = '16px';
            el.style.cursor = 'pointer';
            el.style.filter = 'drop-shadow(0 0 4px rgba(100, 180, 255, 0.8))';
            el.title = \`\${d.label} - \${d.value} (\${d.vessels} vessels)\`;

            // Convert HTML to texture for THREE.js
            const canvas = document.createElement('canvas');
            canvas.width = 64;
            canvas.height = 64;
            const ctx = canvas.getContext('2d');
            ctx.font = '48px Arial';
            ctx.fillText('', 8, 48);

            const texture = new THREE.CanvasTexture(canvas);
            const material = new THREE.SpriteMaterial({
              map: texture,
              transparent: true,
              opacity: 0.95
            });
            const sprite = new THREE.Sprite(material);
            sprite.scale.set(2, 2, 1);

            return sprite;
          })
          .customThreeObjectUpdate((obj, d) => {
            Object.assign(obj.position, world.getCoords(d.lat, d.lng, d.altitude));
          });

        // Animate ships along routes
        setInterval(() => {
          // Update progress for each ship
          shipData.forEach(ship => {
            ship.progress = (ship.progress + 0.0002) % 1.0;
          });

          // Regenerate ship positions
          const updatedShipPoints = generateShipPoints(shipData);
          world.customLayerData(updatedShipPoints);
        }, 200);
      }

      function createPlanes() {
        // Professional plane visualization using proper globe coordinates
        const planeData = airRoutes.map((route, routeIdx) => ({
          routeIdx: routeIdx,
          progress: Math.random(),
          startLat: route.start.lat,
          startLng: route.start.lng,
          endLat: route.end.lat,
          endLng: route.end.lng,
          label: route.name,
          value: route.value,
          flights: route.flights
        }));

        // Calculate interpolated positions along arc
        function interpolateArc(startLat, startLng, endLat, endLng, progress) {
          const lat = startLat + (endLat - startLat) * progress;
          const lng = startLng + (endLng - startLng) * progress;
          return { lat, lng };
        }

        // Generate plane positions
        function generatePlanePoints(planesData) {
          return planesData.map(plane => {
            const pos = interpolateArc(
              plane.startLat,
              plane.startLng,
              plane.endLat,
              plane.endLng,
              plane.progress
            );
            return {
              lat: pos.lat,
              lng: pos.lng,
              size: 0.15,
              color: 'rgba(255, 200, 100, 0.95)',
              altitude: 0.01,  // Higher altitude for planes
              label: plane.label,
              value: plane.value,
              flights: plane.flights
            };
          });
        }

        planeLabels = planeData;

        // Use separate layer for planes
        const initialPlanePoints = generatePlanePoints(planeData);
        world.htmlElementsData(initialPlanePoints)
          .htmlElement(d => {
            const el = document.createElement('div');
            el.innerHTML = '';
            el.style.color = 'rgba(255, 200, 100, 0.95)';
            el.style.fontSize = '16px';
            el.style.cursor = 'pointer';
            el.style.filter = 'drop-shadow(0 0 4px rgba(255, 200, 100, 0.8))';
            el.style.transform = 'rotate(-45deg)';
            el.title = \`\${d.label} - \${d.value} (\${d.flights} flights/week)\`;
            return el;
          })
          .htmlAltitude(d => d.altitude);

        // Animate planes along routes (faster than ships)
        setInterval(() => {
          // Update progress for each plane
          planeData.forEach(plane => {
            plane.progress = (plane.progress + 0.0004) % 1.0;  // Faster than ships
          });

          // Regenerate plane positions
          const updatedPlanePoints = generatePlanePoints(planeData);
          world.htmlElementsData(updatedPlanePoints);
        }, 200);
      }

      function createSatellites() {
        // Create satellite data in different orbits with unique orbital paths
        // Speeds reduced significantly for more realistic and pleasant viewing
        const satelliteOrbits = [
          // Low Earth Orbit satellites (LEO) - closer to Earth, faster orbits
          { name: 'GPS-1', inclination: 55, altitude: 0.35, speed: 0.0008, color: '#00ff00', orbitId: 'gps' },
          { name: 'GPS-2', inclination: 55, altitude: 0.35, speed: 0.0008, color: '#00ff00', phaseOffset: Math.PI, orbitId: 'gps' },
          { name: 'IRNSS-1', inclination: 29, altitude: 0.37, speed: 0.0007, color: '#ffd700', orbitId: 'irnss' },
          { name: 'IRNSS-2', inclination: 29, altitude: 0.37, speed: 0.0007, color: '#ffd700', phaseOffset: Math.PI / 2, orbitId: 'irnss' },
          { name: 'Starlink-1', inclination: 53, altitude: 0.32, speed: 0.0009, color: '#00ccff', orbitId: 'starlink' },
          { name: 'Starlink-2', inclination: 53, altitude: 0.32, speed: 0.0009, color: '#00ccff', phaseOffset: 2 * Math.PI / 3, orbitId: 'starlink' },
          { name: 'Starlink-3', inclination: 53, altitude: 0.32, speed: 0.0009, color: '#00ccff', phaseOffset: 4 * Math.PI / 3, orbitId: 'starlink' },
          // Medium Earth Orbit (MEO) - higher altitude, medium speed
          { name: 'GLONASS-1', inclination: 64.8, altitude: 0.42, speed: 0.0006, color: '#ff6b6b', orbitId: 'glonass' },
          { name: 'GLONASS-2', inclination: 64.8, altitude: 0.42, speed: 0.0006, color: '#ff6b6b', phaseOffset: Math.PI / 3, orbitId: 'glonass' },
          { name: 'Galileo-1', inclination: 56, altitude: 0.40, speed: 0.0007, color: '#9d4edd', orbitId: 'galileo' },
          { name: 'Galileo-2', inclination: 56, altitude: 0.40, speed: 0.0007, color: '#9d4edd', phaseOffset: Math.PI / 2, orbitId: 'galileo' },
          // Geostationary orbit representation (higher altitude, slowest)
          { name: 'INSAT-1', inclination: 0, altitude: 0.50, speed: 0.0004, color: '#ff9500', orbitId: 'insat' },
          { name: 'INSAT-2', inclination: 0, altitude: 0.50, speed: 0.0004, color: '#ff9500', phaseOffset: Math.PI, orbitId: 'insat' },
        ];

        const satellites = satelliteOrbits.map((orbit, idx) => ({
          id: idx,
          name: orbit.name,
          inclination: orbit.inclination,
          altitude: orbit.altitude,
          speed: orbit.speed,
          color: orbit.color,
          orbitId: orbit.orbitId,
          phase: orbit.phaseOffset || 0
        }));

        // Create orbital ring paths - draw complete circles for each unique orbit
        function createOrbitalPaths() {
          const uniqueOrbits = new Map();

          satelliteOrbits.forEach(orbit => {
            if (!uniqueOrbits.has(orbit.orbitId)) {
              uniqueOrbits.set(orbit.orbitId, {
                inclination: orbit.inclination,
                altitude: orbit.altitude,
                color: orbit.color,
                name: orbit.orbitId
              });
            }
          });

          const orbitalPaths = [];
          uniqueOrbits.forEach((orbit, orbitId) => {
            const numPoints = 100; // Number of points to draw the orbital ring
            const pathPoints = [];

            for (let i = 0; i <= numPoints; i++) {
              const angle = (i / numPoints) * 2 * Math.PI;
              const inclinationRad = (orbit.inclination * Math.PI) / 180;

              // Calculate position on orbit
              const x = Math.cos(angle);
              const y = Math.sin(angle) * Math.cos(inclinationRad);
              const z = Math.sin(angle) * Math.sin(inclinationRad);

              // Convert to lat/lng
              const lat = Math.asin(y) * (180 / Math.PI);
              const lng = Math.atan2(z, x) * (180 / Math.PI);

              pathPoints.push([lat, lng]);
            }

            orbitalPaths.push({
              id: orbitId,
              color: orbit.color,
              altitude: orbit.altitude,
              points: pathPoints
            });
          });

          return orbitalPaths;
        }

        const orbitalPaths = createOrbitalPaths();

        // Store orbital paths for toggling
        orbitalPathsData = orbitalPaths;

        // Draw orbital rings using pathsData
        world.pathsData(orbitalPaths)
          .pathPoints('points')
          .pathPointLat(p => p[0])
          .pathPointLng(p => p[1])
          .pathColor('color')
          .pathStroke(0.8)
          .pathDashLength(0.5)
          .pathDashGap(0.1)
          .pathDashAnimateTime(20000)
          .pathTransitionDuration(0)
          .pathPointAlt('altitude');

        // Function to calculate satellite position in orbit
        function calculateSatellitePosition(sat, time) {
          const angle = sat.phase + time * sat.speed;

          // Convert orbital elements to 3D position
          const inclinationRad = (sat.inclination * Math.PI) / 180;

          // Orbital position
          const x = Math.cos(angle);
          const y = Math.sin(angle) * Math.cos(inclinationRad);
          const z = Math.sin(angle) * Math.sin(inclinationRad);

          // Convert to lat/lng (approximate)
          const lat = Math.asin(y) * (180 / Math.PI);
          const lng = Math.atan2(z, x) * (180 / Math.PI);

          return { lat, lng, altitude: sat.altitude };
        }

        // Create satellite objects with animation
        const satelliteData = satellites.map((sat, idx) => ({
          ...sat,
          progress: (idx / satellites.length) // Distribute satellites evenly around orbit initially
        }));

        // Function to generate satellite HTML elements
        function generateSatellitePoints(satsData) {
          return satsData.map(sat => {
            const angle = sat.progress * 2 * Math.PI;
            const inclinationRad = (sat.inclination * Math.PI) / 180;

            // Calculate position on orbit
            const x = Math.cos(angle);
            const y = Math.sin(angle) * Math.cos(inclinationRad);
            const z = Math.sin(angle) * Math.sin(inclinationRad);

            // Convert to lat/lng
            const lat = Math.asin(y) * (180 / Math.PI);
            const lng = Math.atan2(z, x) * (180 / Math.PI);

            return {
              lat: lat,
              lng: lng,
              altitude: sat.altitude,
              name: sat.name,
              color: sat.color
            };
          });
        }

        // Initial satellite positions - use objectsData for satellites (separate from planes)
        const initialSatellitePoints = generateSatellitePoints(satelliteData);

        world.objectsData(initialSatellitePoints)
          .objectLat('lat')
          .objectLng('lng')
          .objectAltitude('altitude')
          .objectLabel(d => \`
            <div style="background: rgba(10,10,10,0.92); padding: 5px 9px; border-left: 2px solid \${d.color}; font-family: 'Segoe UI', sans-serif; font-size: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.4);">
              <span style="color: #e0e0e0; font-weight: 500;"> \${d.name}</span>
            </div>
          \`)
          .objectThreeObject(d => {
            // Create satellite icon using canvas texture with better visibility
            const canvas = document.createElement('canvas');
            canvas.width = 128;
            canvas.height = 128;
            const ctx = canvas.getContext('2d');

            // Add colored background circle for visibility
            ctx.beginPath();
            ctx.arc(64, 64, 50, 0, 2 * Math.PI);
            ctx.fillStyle = d.color;
            ctx.globalAlpha = 0.4;
            ctx.fill();
            ctx.globalAlpha = 1.0;

            // Add bright border
            ctx.strokeStyle = d.color;
            ctx.lineWidth = 3;
            ctx.stroke();

            // Draw satellite emoji larger and centered
            ctx.font = 'bold 70px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = '#ffffff';
            ctx.fillText('', 64, 64);

            const texture = new THREE.CanvasTexture(canvas);
            const material = new THREE.SpriteMaterial({
              map: texture,
              transparent: true,
              opacity: 1.0,
              sizeAttenuation: true
            });
            const sprite = new THREE.Sprite(material);
            sprite.scale.set(4, 4, 1);

            // Add pulsing glow ring around satellite
            const ringGeometry = new THREE.RingGeometry(1.5, 2.0, 16);
            const ringMaterial = new THREE.MeshBasicMaterial({
              color: d.color,
              transparent: true,
              opacity: 0.6,
              side: THREE.DoubleSide
            });
            const ring = new THREE.Mesh(ringGeometry, ringMaterial);

            const group = new THREE.Group();
            group.add(sprite);
            group.add(ring);

            return group;
          });

        // Animate satellites along their orbits at a gentle, realistic pace
        setInterval(() => {
          if (showSatellitesFlag) {
            // Update progress for each satellite with reduced multiplier
            satelliteData.forEach(sat => {
              sat.progress = (sat.progress + sat.speed * 0.15) % 1.0;
            });

            // Regenerate satellite positions
            const updatedSatellitePoints = generateSatellitePoints(satelliteData);
            world.objectsData(updatedSatellitePoints);
          }
        }, 100);
      }

      window.addMarker = function(lat, lng, title, type) {
        const icons = {
          'Ship': '',
          'Port': '',
          'Industry': '',
          'Bank': '',
          'Exchange': ''
        };

        markers.push({ lat, lng, title, type, icon: icons[type] || icons['Ship'] });

        world.htmlElementsData([...allLabels, ...markers])
          .htmlElement(d => {
            const el = document.createElement('div');
            el.innerHTML = d.icon || d.label;
            el.style.color = d.color || '#ff8c00';
            el.style.fontSize = '20px';
            el.style.cursor = 'pointer';
            el.style.textShadow = '0 0 5px ' + (d.color || '#ff8c00');
            el.title = d.title || d.label || '';
            return el;
          });
      };

      window.clearMarkers = function() {
        markers = [];
        world.htmlElementsData(allLabels);
      };

      window.toggleRoutes = function() {
        if (showRoutesFlag) {
          world.arcsData([]);
        } else {
          createRoutes();
        }
        showRoutesFlag = !showRoutesFlag;
      };

      window.toggleShips = function() {
        if (showShipsFlag) {
          world.customLayerData([]);
        } else {
          // Regenerate ship positions
          function interpolateArc(startLat, startLng, endLat, endLng, progress) {
            const lat = startLat + (endLat - startLat) * progress;
            const lng = startLng + (endLng - startLng) * progress;
            return { lat, lng };
          }

          const shipPoints = allLabels.map(ship => {
            const pos = interpolateArc(ship.startLat, ship.startLng, ship.endLat, ship.endLng, ship.progress);
            return {
              lat: pos.lat,
              lng: pos.lng,
              size: 0.15,
              color: 'rgba(255, 255, 255, 0.95)',
              altitude: 0.003,
              label: ship.label,
              value: ship.value,
              vessels: ship.vessels
            };
          });
          world.customLayerData(shipPoints);
        }
        showShipsFlag = !showShipsFlag;
      };

      window.togglePlanes = function() {
        if (showPlanesFlag) {
          world.htmlElementsData([]);
        } else {
          // Regenerate plane positions
          function interpolateArc(startLat, startLng, endLat, endLng, progress) {
            const lat = startLat + (endLat - startLat) * progress;
            const lng = startLng + (endLng - startLng) * progress;
            return { lat, lng };
          }

          const planePoints = planeLabels.map(plane => {
            const pos = interpolateArc(plane.startLat, plane.startLng, plane.endLat, plane.endLng, plane.progress);
            return {
              lat: pos.lat,
              lng: pos.lng,
              size: 0.15,
              color: 'rgba(255, 200, 100, 0.95)',
              altitude: 0.01,
              label: plane.label,
              value: plane.value,
              flights: plane.flights
            };
          });
          world.htmlElementsData(planePoints);
        }
        showPlanesFlag = !showPlanesFlag;
      };

      window.toggleRotation = function(shouldRotate) {
        userPausedRotation = !shouldRotate;
        world.controls().autoRotate = shouldRotate;
        console.log('Globe rotation:', shouldRotate ? 'enabled' : 'disabled');
      };

      var showSatellitesFlag = true;
      var orbitalPathsData = [];

      window.toggleSatellites = function() {
        showSatellitesFlag = !showSatellitesFlag;

        if (!showSatellitesFlag) {
          // Hide satellites and orbital paths
          world.objectsData([]);
          world.pathsData([]);
        } else {
          // Show orbital paths again
          world.pathsData(orbitalPathsData);
          // Satellites will be updated by the interval
        }
      };

        // Enable auto-rotation with enhanced zoom
        world.controls().autoRotate = true;
        world.controls().autoRotateSpeed = 0.2;  // Slower, more professional rotation
        world.controls().enableDamping = true;
        world.controls().dampingFactor = 0.05;

        // Allow deep zoom but not too extreme on 3D globe
        world.controls().minDistance = 50;     // Don't go too close on 3D (will switch to 2D)
        world.controls().maxDistance = 800;    // Very far zoom (space view)
        world.controls().zoomSpeed = 1.5;      // Faster zoom for better control
        world.controls().enableZoom = true;

        console.log('Controls configured');

      // Keep rotation state controlled by user toggle
      let userPausedRotation = false;
      let interactionTimeout;
      const resumeRotation = () => {
        clearTimeout(interactionTimeout);
        world.controls().autoRotate = false;
        interactionTimeout = setTimeout(() => {
          // Only resume if user hasn't manually paused
          if (!userPausedRotation) {
            world.controls().autoRotate = true;
          }
        }, 3000); // Resume after 3 seconds of inactivity (only if not manually paused)
      };

        // Function to switch between 3D and 2D modes
        function switchTo2D(lat, lng) {
          if (currentMode === '2D') return; // Prevent multiple switches

          // Use the most recent target coordinates (where user was actually looking)
          const finalLat = targetCoords.lat;
          const finalLng = targetCoords.lng;

          initMap2D(); // Initialize if needed

          document.getElementById('globeViz').style.display = 'none';
          document.getElementById('mapViz').style.display = 'block';
          document.getElementById('modeIndicator').textContent = '2D MAP MODE - Street Level';
          document.getElementById('modeIndicator').style.background = 'rgba(255, 215, 0, 0.9)';

          // Calculate zoom based on altitude (lower altitude = higher zoom)
          // More aggressive zoom calculation for better street detail
          const altitudeFactor = Math.max(0, 0.3 - lastGlobeView.altitude);
          const zoom2D = Math.max(14, Math.min(18, Math.floor(16 + altitudeFactor * 20)));

          console.log('Switching to 2D - Final coords:', finalLat.toFixed(6), finalLng.toFixed(6), 'zoom:', zoom2D);

          // Set view and force map refresh
          setTimeout(() => {
            map2D.setView([finalLat, finalLng], zoom2D);
            map2D.invalidateSize();

            // Force tile refresh
            setTimeout(() => {
              map2D.eachLayer(function(layer) {
                if (layer instanceof L.TileLayer) {
                  layer.redraw();
                }
              });
              console.log('2D map centered at:', finalLat.toFixed(6), finalLng.toFixed(6));
            }, 100);
          }, 50);

          currentMode = '2D';
        }

        function switchTo3D(lat, lng, altitude) {
          document.getElementById('globeViz').style.display = 'block';
          document.getElementById('mapViz').style.display = 'none';
          document.getElementById('modeIndicator').textContent = '3D GLOBE MODE';
          document.getElementById('modeIndicator').style.background = 'rgba(0, 255, 255, 0.9)';

          world.pointOfView({ lat, lng, altitude }, 500);
          currentMode = '3D';
          console.log('Switched to 3D mode at altitude:', altitude);
        }

        // Monitor zoom level and switch modes
        world.onZoom((view) => {
          lastGlobeView = view;
          targetCoords = { lat: view.lat, lng: view.lng };
          console.log('Globe zoom - altitude:', view.altitude, 'lat:', view.lat.toFixed(4), 'lng:', view.lng.toFixed(4));

          if (view.altitude < ZOOM_THRESHOLD && currentMode === '3D') {
            console.log('Triggering switch to 2D at exact position:', view.lat, view.lng);
            switchTo2D(view.lat, view.lng);
          }
        });

        // Listen for user interactions
        const container = document.getElementById('globeViz');

        // Track mouse position for accurate zoom targeting
        let mousePos = null;
        container.addEventListener('mousemove', (e) => {
          mousePos = { x: e.clientX, y: e.clientY };
        });

        // Get lat/lng from screen coordinates
        function getLatLngFromScreen(x, y) {
          try {
            const scene = world.scene();
            const camera = world.camera();
            const raycaster = new THREE.Raycaster();
            const mouse = new THREE.Vector2(
              (x / window.innerWidth) * 2 - 1,
              -(y / window.innerHeight) * 2 + 1
            );

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObject(scene.children.find(c => c.type === 'Mesh'), true);

            if (intersects.length > 0) {
              const point = intersects[0].point;
              const lat = Math.asin(point.y / Math.sqrt(point.x * point.x + point.y * point.y + point.z * point.z)) * 180 / Math.PI;
              const lng = Math.atan2(point.x, point.z) * 180 / Math.PI;
              return { lat, lng };
            }
          } catch (e) {
            console.log('Could not get exact coordinates, using view center');
          }
          return null;
        }
        container.addEventListener('mousedown', resumeRotation);
        container.addEventListener('wheel', (e) => {
          resumeRotation();

          // Update target coords based on mouse position
          if (mousePos) {
            const coords = getLatLngFromScreen(mousePos.x, mousePos.y);
            if (coords) {
              targetCoords = coords;
              console.log('Updated target from mouse:', targetCoords.lat.toFixed(4), targetCoords.lng.toFixed(4));
            }
          }
        });
        container.addEventListener('touchstart', resumeRotation);

        // Start with auto-rotation enabled
        world.controls().autoRotate = true;

        console.log('Event listeners added');

        createRoutes();
        createShips();
        createPlanes();
        createSatellites();

        // Handle window resize
        window.addEventListener('resize', () => {
          world.width(window.innerWidth).height(window.innerHeight);
        });

        console.log('3D Globe fully initialized');
      } catch (error) {
        console.error('Error initializing Globe:', error);
        document.body.innerHTML = '<div style="color: red; padding: 20px; font-family: monospace;">ERROR: Failed to load 3D Globe<br>Check console for details<br><br>' + error.message + '</div>';
      }
    }, 500); // Wait 500ms for libraries to load
  <\/script>
</body>
</html>
  `,style:{width:"100%",height:"100%",border:"none",background:"#000"}}),t.jsxs("div",{style:{position:"absolute",bottom:"16px",left:"16px",background:"rgba(0, 0, 0, 0.9)",border:"1px solid #0ff",padding:"8px 12px",color:"#0ff",fontSize:"9px",fontFamily:"Consolas, monospace"},children:[t.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"HYBRID 3D/2D SYSTEM ACTIVE"}),t.jsx("div",{children:"CENTER: 20.0000 N, 75.0000 E"}),t.jsx("div",{children:"MODE: Globe.GL 3D  Auto-switches  Leaflet 2D"}),t.jsx("div",{style:{marginTop:"4px",color:"#ffd700"},children:" ZOOM: Deep zoom auto-switches to street-level map!"})]})]}),t.jsxs("div",{style:{width:"280px",borderLeft:"1px solid #1a1a1a",display:"flex",flexDirection:"column",background:"#000",flexShrink:0},children:[l&&t.jsxs("div",{style:{padding:"12px",borderBottom:"1px solid #1a1a1a"},children:[t.jsx("div",{style:{color:"#00ff00",fontSize:"10px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"1px"},children:"ROUTE DETAILS"}),t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"10px"},children:[t.jsx("div",{style:{color:"#0ff",fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:l.name}),t.jsxs("div",{style:{display:"grid",gap:"6px",fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#888"},children:"Value:"}),t.jsx("span",{style:{color:"#fff"},children:l.value})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#888"},children:"Status:"}),t.jsx("span",{style:{color:l.status==="critical"?"#ff0000":l.status==="delayed"?"#ffd700":"#00ff00"},children:l.status.toUpperCase()})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#888"},children:"Active Vessels:"}),t.jsx("span",{style:{color:"#fff"},children:l.vessels})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:"#888"},children:"Waypoints:"}),t.jsx("span",{style:{color:"#fff"},children:l.coordinates.length})]})]})]})]}),t.jsxs("div",{style:{padding:"12px",borderBottom:"1px solid #1a1a1a"},children:[t.jsx("div",{style:{color:"#00ff00",fontSize:"10px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"1px"},children:"ADD TARGET"}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("div",{style:{color:"#888",fontSize:"8px",marginBottom:"4px"},children:"MARKER TYPE"}),t.jsxs("select",{value:p,onChange:B=>f(B.target.value),style:{width:"100%",background:"#0a0a0a",color:"#0ff",border:"1px solid #1a1a1a",padding:"6px",fontSize:"9px"},children:[t.jsx("option",{value:"Ship",children:" Ship"}),t.jsx("option",{value:"Port",children:" Port"}),t.jsx("option",{value:"Industry",children:" Industry"}),t.jsx("option",{value:"Bank",children:" Bank"}),t.jsx("option",{value:"Exchange",children:" Exchange"})]})]}),t.jsx("div",{style:{color:"#888",fontSize:"8px",marginBottom:"8px"},children:"QUICK ADD PRESETS"}),t.jsx("div",{style:{display:"grid",gap:"4px"},children:I.map((B,F)=>t.jsx("button",{onClick:()=>{O(B),R.current?.contentWindow&&R.current.contentWindow.addMarker?.(B.lat,B.lng,B.name,B.type)},style:{background:"#0a0a0a",color:"#fff",border:"1px solid #1a1a1a",padding:"6px",fontSize:"9px",cursor:"pointer",textAlign:"left"},onMouseEnter:z=>z.currentTarget.style.borderColor="#0ff",onMouseLeave:z=>z.currentTarget.style.borderColor="#1a1a1a",children:B.name},F))})]}),t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"12px",minHeight:0},children:[t.jsxs("div",{style:{color:"#00ff00",fontSize:"10px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"1px"},children:["TRACKED TARGETS (",o.length,")"]}),o.length===0?t.jsx("div",{style:{color:"#444",fontSize:"9px",fontStyle:"italic",padding:"8px"},children:"No targets marked"}):o.map((B,F)=>t.jsxs("div",{style:{background:"#0a0a0a",border:"1px solid #1a1a1a",padding:"8px",marginBottom:"6px",fontSize:"9px"},children:[t.jsx("div",{style:{color:"#0ff",fontWeight:"bold",marginBottom:"4px"},children:B.title}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsxs("span",{style:{color:"#888"},children:["Type: ",B.type]}),t.jsxs("span",{style:{color:"#666",fontSize:"8px"},children:[B.lat.toFixed(2),", ",B.lng.toFixed(2),""]})]})]},F))]}),t.jsxs("div",{style:{padding:"12px",borderTop:"1px solid #1a1a1a",background:"#0a0a0a"},children:[t.jsx("div",{style:{color:"#00ff00",fontSize:"9px",fontWeight:"bold",marginBottom:"6px"},children:"SYSTEM STATUS"}),t.jsxs("div",{style:{fontSize:"8px",color:"#888",lineHeight:"1.4"},children:[t.jsxs("div",{style:{marginBottom:"4px"},children:[t.jsx("span",{style:{color:"#0ff"},children:""})," 3D Globe: ACTIVE"]}),t.jsxs("div",{style:{marginBottom:"4px"},children:[t.jsx("span",{style:{color:"#0ff"},children:""})," Satellite imagery: ONLINE"]}),t.jsxs("div",{style:{marginBottom:"4px"},children:[t.jsx("span",{style:{color:"#0ff"},children:""})," AIS transponders: STREAMING"]}),t.jsxs("div",{style:{marginBottom:"4px"},children:[t.jsx("span",{style:{color:"rgba(138, 43, 226, 0.9)"},children:""})," Orbital tracking: 13 SATs"]}),t.jsxs("div",{style:{marginBottom:"4px"},children:[t.jsx("span",{style:{color:"rgba(255, 200, 100, 0.95)"},children:""})," Air traffic: MONITORED"]}),t.jsxs("div",{style:{marginBottom:"4px"},children:[t.jsx("span",{style:{color:"#0ff"},children:""})," Maritime routes: ",M.length," corridors"]}),t.jsx("div",{style:{marginTop:"8px",padding:"6px",background:"#000",border:"1px solid #1a1a1a",color:"#ffd700"},children:" CLASSIFIED: For authorized personnel only"})]})]})]})]}),t.jsxs("div",{style:{borderTop:"2px solid #00ff00",padding:"8px 16px",background:"linear-gradient(180deg, #000 0%, #0a0a0a 100%)",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0,flexWrap:"wrap",gap:"12px",minHeight:"40px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"9px",flexWrap:"wrap"},children:[t.jsx("span",{style:{color:"#00ff00",fontWeight:"bold",whiteSpace:"nowrap"},children:"MARITIME INTEL v2.4.1"}),t.jsx("span",{style:{color:"#888"},children:"|"}),t.jsx("span",{style:{color:"#0ff",whiteSpace:"nowrap"},children:"AIS Feed: ACTIVE"}),t.jsx("span",{style:{color:"#888"},children:"|"}),t.jsx("span",{style:{color:"#0ff",whiteSpace:"nowrap"},children:"Satellite Link: NOMINAL"}),t.jsx("span",{style:{color:"#888"},children:"|"}),t.jsx("span",{style:{color:"#0ff",whiteSpace:"nowrap"},children:"Data Latency: 2.3ms"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"9px",flexWrap:"wrap"},children:[t.jsx("span",{style:{color:"#888",whiteSpace:"nowrap"},children:"Powered by Globe.GL 3D Visualization"}),t.jsx("span",{style:{color:"#888"},children:"|"}),t.jsx("span",{style:{color:"#ffd700",whiteSpace:"nowrap"},children:"CLEARANCE: TOP SECRET // SCI"})]})]})]})}class s7{constructor(){Pe(this,"defaultBaseUrl","http://localhost:11434")}async listModels(e){const r=e||this.defaultBaseUrl;try{const n=await tn(`${r}/api/tags`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return{success:!0,models:(await n.json()).models.map(a=>a.name)}}catch(n){return console.error("Failed to fetch Ollama models:",n),{success:!1,error:n instanceof Error?n.message:"Failed to connect to Ollama"}}}async listModelsDetailed(e){const r=e||this.defaultBaseUrl;try{const n=await tn(`${r}/api/tags`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return{success:!0,models:(await n.json()).models}}catch(n){return console.error("Failed to fetch Ollama models:",n),{success:!1,error:n instanceof Error?n.message:"Failed to connect to Ollama"}}}async checkConnection(e){const r=e||this.defaultBaseUrl;try{const n=await tn(`${r}/api/version`,{method:"GET"});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return{success:!0,version:(await n.json()).version}}catch(n){return console.error("Failed to connect to Ollama:",n),{success:!1,error:n instanceof Error?n.message:"Failed to connect to Ollama"}}}formatModelSize(e){const r=e/1073741824;return r>=1?`${r.toFixed(2)} GB`:`${(e/(1024*1024)).toFixed(2)} MB`}formatModelDisplay(e){const r=this.formatModelSize(e.size),n=e.details.parameter_size;return`${e.name} (${n}, ${r})`}}const i7=new s7;function o7({colors:s}){const[e,r]=S.useState([]),[n,i]=S.useState([]),[o,a]=S.useState(!0),[l,d]=S.useState({total:0,websocket:0,restApi:0,enabled:0,disabled:0}),[p,f]=S.useState(""),[h,x]=S.useState("all"),[m,b]=S.useState(!1),[w,y]=S.useState(!1),[C,T]=S.useState(null),[E,j]=S.useState({alias:"",displayName:"",description:"",provider:"kraken",channel:"ticker",symbol:""}),[k,A]=S.useState({alias:"",displayName:"",description:"",provider:"kraken",channel:"ticker",symbol:""}),R=$A();S.useEffect(()=>{M()},[]),S.useEffect(()=>{P()},[e,p,h]);async function M(){try{a(!0);const W=await vv(),D=await Dq();r(W),d(D)}catch(W){console.error("Failed to load data sources:",W)}finally{a(!1)}}function P(){let W=[...e];if(h!=="all"&&(W=W.filter(D=>D.type===h)),p){const D=p.toLowerCase();W=W.filter(oe=>oe.alias.toLowerCase().includes(D)||oe.display_name.toLowerCase().includes(D)||oe.description?.toLowerCase().includes(D)||oe.provider.toLowerCase().includes(D))}i(W)}async function I(W){try{await Nq(W),await M()}catch(D){console.error("Failed to toggle data source:",D),alert("Failed to toggle data source")}}async function O(W){if(confirm("Delete this data source? This cannot be undone."))try{await Oq(W),await M()}catch(D){console.error("Failed to delete data source:",D),alert("Failed to delete data source")}}async function G(){if(!E.alias||!E.displayName||!E.provider||!E.channel){alert("Please fill in all required fields");return}try{const W=await Tq({alias:E.alias,displayName:E.displayName,description:E.description,provider:E.provider,channel:E.channel,symbol:E.symbol||void 0,enabled:!0});W.success?(b(!1),j({alias:"",displayName:"",description:"",provider:"kraken",channel:"ticker",symbol:""}),await M()):alert(W.message)}catch(W){console.error("Failed to create data source:",W),alert("Failed to create data source")}}function B(W){if(T(W),W.type==="websocket"){const D=fb(W);D&&A({alias:W.alias,displayName:W.display_name,description:W.description||"",provider:D.provider||"kraken",channel:D.channel||"ticker",symbol:D.symbol||""})}y(!0)}async function F(){if(!C||!k.alias||!k.displayName||!k.provider||!k.channel){alert("Please fill in all required fields");return}try{const W={...C,alias:k.alias,display_name:k.displayName,description:k.description,provider:k.provider,config:JSON.stringify({provider:k.provider,channel:k.channel,symbol:k.symbol||void 0})},D=await _q(W);D.success?(y(!1),T(null),A({alias:"",displayName:"",description:"",provider:"kraken",channel:"ticker",symbol:""}),await M()):alert(D.message)}catch(W){console.error("Failed to update data source:",W),alert("Failed to update data source")}}function z(W){return W==="websocket"?Yb:js}function $(W){return W.enabled?W.type==="websocket"?{color:"text-green-500",text:"Live"}:{color:"text-blue-500",text:"Ready"}:{color:"text-gray-500",text:"Disabled"}}return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h2",{style:{color:s.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"8px"},children:"DATA SOURCES"}),t.jsx("p",{style:{color:s.text,fontSize:"10px"},children:"Manage WebSocket connections and REST API integrations. Create aliases to easily reference data sources across the terminal."})]}),t.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`},className:"p-3 rounded",children:[t.jsx("div",{style:{color:s.text,fontSize:"10px",fontWeight:"bold"},children:"TOTAL"}),t.jsx("div",{style:{color:s.primary,fontSize:"20px",fontWeight:"bold"},children:l.total})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`},className:"p-3 rounded",children:[t.jsx("div",{style:{color:s.text,fontSize:"10px",fontWeight:"bold"},children:"WEBSOCKET"}),t.jsx("div",{style:{color:"#10b981",fontSize:"20px",fontWeight:"bold"},children:l.websocket})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`},className:"p-3 rounded",children:[t.jsx("div",{style:{color:s.text,fontSize:"10px",fontWeight:"bold"},children:"REST API"}),t.jsx("div",{style:{color:"#3b82f6",fontSize:"20px",fontWeight:"bold"},children:l.restApi})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`},className:"p-3 rounded",children:[t.jsx("div",{style:{color:s.text,fontSize:"10px",fontWeight:"bold"},children:"ENABLED"}),t.jsx("div",{style:{color:"#10b981",fontSize:"20px",fontWeight:"bold"},children:l.enabled})]}),t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`},className:"p-3 rounded",children:[t.jsx("div",{style:{color:s.text,fontSize:"10px",fontWeight:"bold"},children:"DISABLED"}),t.jsx("div",{style:{color:s.text,fontSize:"20px",fontWeight:"bold"},children:l.disabled})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(Ho,{size:14,className:"absolute left-3 top-1/2 transform -translate-y-1/2",style:{color:s.primary}}),t.jsx("input",{type:"text",placeholder:"Search data sources...",value:p,onChange:W=>f(W.target.value),style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 8px 8px 36px",borderRadius:"4px",width:"100%"}})]}),t.jsxs("select",{value:h,onChange:W=>x(W.target.value),style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"},children:[t.jsx("option",{style:{backgroundColor:s.panel,color:s.text},value:"all",children:"All Types"}),t.jsx("option",{style:{backgroundColor:s.panel,color:s.text},value:"websocket",children:"WebSocket"}),t.jsx("option",{style:{backgroundColor:s.panel,color:s.text},value:"rest_api",children:"REST API"})]}),t.jsxs("button",{onClick:M,style:{backgroundColor:s.panel,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",fontWeight:"bold",padding:"8px 12px",borderRadius:"4px",display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[t.jsx(xn,{size:14}),"REFRESH"]}),t.jsxs("button",{onClick:()=>b(!0),style:{backgroundColor:s.primary,color:s.background,fontSize:"11px",fontWeight:"bold",padding:"8px 12px",borderRadius:"4px",display:"flex",alignItems:"center",gap:"6px",cursor:"pointer"},children:[t.jsx(wn,{size:14}),"ADD SOURCE"]})]}),o?t.jsx("div",{style:{textAlign:"center",padding:"40px",color:s.text},children:"Loading data sources..."}):n.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"40px"},children:[t.jsx("p",{style:{color:s.text,marginBottom:"16px"},children:p||h!=="all"?"No data sources match your filters":"No data sources yet"}),!p&&h==="all"&&t.jsx("button",{onClick:()=>b(!0),style:{backgroundColor:s.primary,color:s.background,fontSize:"11px",fontWeight:"bold",padding:"10px 16px",borderRadius:"4px",cursor:"pointer"},children:"Create First Data Source"})]}):t.jsx("div",{className:"space-y-3",children:n.map(W=>{const D=z(W.type),oe=$(W),Z=W.type==="websocket"?k2(W):null;return t.jsx("div",{style:{backgroundColor:s.panel,border:`1px solid ${W.enabled?s.primary:"#444"}`,borderRadius:"6px",padding:"16px"},children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[t.jsx(D,{size:18,style:{color:W.enabled?s.primary:s.text,marginTop:"2px"}}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h3",{style:{color:s.text,fontSize:"13px",fontWeight:"bold"},children:W.display_name}),t.jsx("code",{style:{backgroundColor:s.background,color:s.primary,fontSize:"10px",padding:"2px 6px",borderRadius:"3px"},children:W.alias}),t.jsxs("span",{style:{fontSize:"10px",color:oe.color,fontWeight:"bold"},children:[" ",oe.text]})]}),W.description&&t.jsx("p",{style:{color:s.text,fontSize:"11px",marginBottom:"8px"},children:W.description}),t.jsxs("div",{className:"flex items-center gap-4",style:{fontSize:"10px"},children:[t.jsxs("span",{style:{color:s.text},children:[t.jsx("strong",{style:{color:s.primary},children:"Type:"})," ",W.type==="websocket"?"WebSocket":"REST API"]}),t.jsxs("span",{style:{color:s.text},children:[t.jsx("strong",{style:{color:s.primary},children:"Provider:"})," ",W.provider]}),Z&&t.jsxs("span",{style:{color:s.text},children:[t.jsx("strong",{style:{color:s.primary},children:"Topic:"})," ",t.jsx("code",{style:{color:s.primary},children:Z})]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>B(W),style:{padding:"6px",borderRadius:"4px",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.primary,cursor:"pointer"},title:"Edit",children:t.jsx(Od,{size:14})}),t.jsx("button",{onClick:()=>I(W.id),style:{padding:"6px",borderRadius:"4px",backgroundColor:W.enabled?s.background:s.primary,border:`1px solid ${s.primary}`,color:W.enabled?s.text:s.background,cursor:"pointer"},title:W.enabled?"Disable":"Enable",children:W.enabled?t.jsx($T,{size:14}):t.jsx(PB,{size:14})}),t.jsx("button",{onClick:()=>O(W.id),style:{padding:"6px",borderRadius:"4px",backgroundColor:s.background,border:"1px solid #ef4444",color:"#ef4444",cursor:"pointer"},title:"Delete",children:t.jsx(On,{size:14})})]})]})},W.id)})}),m&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:s.panel,border:`2px solid ${s.primary}`,borderRadius:"8px",padding:"24px",maxWidth:"500px",width:"100%"},children:[t.jsx("h3",{style:{color:s.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"16px"},children:"Add WebSocket Data Source"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"ALIAS (short name)"}),t.jsx("input",{type:"text",placeholder:"btc_live",value:E.alias,onChange:W=>j({...E,alias:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"DISPLAY NAME"}),t.jsx("input",{type:"text",placeholder:"Bitcoin Price",value:E.displayName,onChange:W=>j({...E,displayName:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"DESCRIPTION"}),t.jsx("input",{type:"text",placeholder:"Real-time Bitcoin price from Kraken",value:E.description,onChange:W=>j({...E,description:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"PROVIDER"}),t.jsx("select",{value:E.provider,onChange:W=>j({...E,provider:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"},children:R.map(W=>t.jsx("option",{value:W,style:{backgroundColor:s.background,color:s.text},children:W},W))})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"CHANNEL"}),t.jsx("input",{type:"text",placeholder:"ticker",value:E.channel,onChange:W=>j({...E,channel:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"SYMBOL (optional)"}),t.jsx("input",{type:"text",placeholder:"BTC/USD",value:E.symbol,onChange:W=>j({...E,symbol:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:G,style:{flex:1,backgroundColor:s.primary,color:s.background,fontSize:"11px",fontWeight:"bold",padding:"10px",borderRadius:"4px",border:"none",cursor:"pointer"},children:"CREATE DATA SOURCE"}),t.jsx("button",{onClick:()=>b(!1),style:{flex:1,backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",fontWeight:"bold",padding:"10px",borderRadius:"4px",cursor:"pointer"},children:"CANCEL"})]})]})}),w&&C&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:s.panel,border:`2px solid ${s.primary}`,borderRadius:"8px",padding:"24px",maxWidth:"500px",width:"100%"},children:[t.jsx("h3",{style:{color:s.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"16px"},children:"Edit WebSocket Data Source"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"ALIAS (short name)"}),t.jsx("input",{type:"text",placeholder:"btc_live",value:k.alias,onChange:W=>A({...k,alias:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"DISPLAY NAME"}),t.jsx("input",{type:"text",placeholder:"Bitcoin Price",value:k.displayName,onChange:W=>A({...k,displayName:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"DESCRIPTION"}),t.jsx("input",{type:"text",placeholder:"Real-time Bitcoin price from Kraken",value:k.description,onChange:W=>A({...k,description:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"PROVIDER"}),t.jsx("select",{value:k.provider,onChange:W=>A({...k,provider:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"},children:R.map(W=>t.jsx("option",{value:W,style:{backgroundColor:s.background,color:s.text},children:W},W))})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"CHANNEL"}),t.jsx("input",{type:"text",placeholder:"ticker",value:k.channel,onChange:W=>A({...k,channel:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:s.text,fontSize:"10px",fontWeight:"bold",display:"block",marginBottom:"6px"},children:"SYMBOL (optional)"}),t.jsx("input",{type:"text",placeholder:"BTC/USD",value:k.symbol,onChange:W=>A({...k,symbol:W.target.value}),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",padding:"8px 12px",borderRadius:"4px"}})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:F,style:{flex:1,backgroundColor:s.primary,color:s.background,fontSize:"11px",fontWeight:"bold",padding:"10px",borderRadius:"4px",border:"none",cursor:"pointer"},children:"UPDATE DATA SOURCE"}),t.jsx("button",{onClick:()=>{y(!1),T(null)},style:{flex:1,backgroundColor:s.background,border:`1px solid ${s.primary}`,color:s.text,fontSize:"11px",fontWeight:"bold",padding:"10px",borderRadius:"4px",cursor:"pointer"},children:"CANCEL"})]})]})})]})}class a7{constructor(){Pe(this,"providers",new Map);Pe(this,"activeProviderId",null);Pe(this,"configs",new Map);Pe(this,"listeners",new Set)}registerProvider(e){if(this.providers.has(e.name))throw new Error(`Provider "${e.name}" is already registered`);this.providers.set(e.name,e),this.notifyListeners("provider:registered",{provider:e.name}),ir.info(`Registered backtesting provider: ${e.name}`)}unregisterProvider(e){const r=this.providers.get(e);return r?(r.disconnect().catch(n=>ir.error("Disconnect error:",n)),this.providers.delete(e),this.configs.delete(e),this.activeProviderId===e&&(this.activeProviderId=null),this.notifyListeners("provider:unregistered",{provider:e}),ir.info(`Unregistered backtesting provider: ${e}`),!0):!1}async setActiveProvider(e){const r=this.providers.get(e);if(!r)throw new Error(`Provider "${e}" not found`);const n=await r.testConnection();if(!n.success)throw new Error(`Cannot activate provider "${e}": ${n.error||"Connection test failed"}`);const i=this.activeProviderId;this.activeProviderId=e,this.notifyListeners("provider:activated",{provider:e,previous:i}),ir.info(`Activated backtesting provider: ${e}`)}getActiveProvider(){return this.activeProviderId&&this.providers.get(this.activeProviderId)||null}getActiveProviderName(){return this.activeProviderId}isActive(e){return this.activeProviderId===e}getProvider(e){return this.providers.get(e)||null}listProviders(){return Array.from(this.providers.values()).map(e=>({name:e.name,version:e.version,capabilities:e.capabilities,description:e.description||"",isActive:this.activeProviderId===e.name,isEnabled:!0,config:this.configs.get(e.name)}))}getProvidersByCapability(e){return this.listProviders().filter(r=>r.capabilities[e])}getProvidersByAssetClass(e){return this.listProviders().filter(r=>r.capabilities.multiAsset.includes(e))}hasProviders(){return this.providers.size>0}getProviderCount(){return this.providers.size}saveProviderConfig(e,r){this.configs.set(e,r),this.notifyListeners("config:saved",{provider:e})}loadProviderConfig(e){return this.configs.get(e)||null}deleteProviderConfig(e){const r=this.configs.delete(e);return r&&this.notifyListeners("config:deleted",{provider:e}),r}async switchProvider(e,r){if(!this.providers.has(r))throw new Error(`Target provider "${r}" not found`);e&&this.activeProviderId!==e&&ir.warn(`fromProvider "${e}" is not active. Current: ${this.activeProviderId}`),await this.setActiveProvider(r),ir.info(`Switched provider: ${e}  ${r}`)}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}notifyListeners(e,r){this.listeners.forEach(n=>{try{n(e,r)}catch(i){ir.error("Error in registry listener:",i)}})}async clearAll(){await Promise.all(Array.from(this.providers.values()).map(e=>e.disconnect().catch(r=>ir.error("Disconnect error:",r)))),this.providers.clear(),this.configs.clear(),this.activeProviderId=null,this.listeners.clear(),ir.info("Cleared all backtesting providers")}getStats(){return{totalProviders:this.providers.size,activeProvider:this.activeProviderId,providersWithOptimization:this.getProvidersByCapability("optimization").length,providersWithLiveTrading:this.getProvidersByCapability("liveTrading").length,providersWithResearch:this.getProvidersByCapability("research").length}}}const Ss=new a7;class ux{constructor(){Pe(this,"config",null);Pe(this,"initialized",!1);Pe(this,"connected",!1)}async disconnect(){this.connected=!1,this.initialized=!1,console.log(`Disconnected from ${this.name}`)}async getBacktestStatus(e){return{id:e,status:"running",progress:0}}async cancelBacktest(e){console.warn(`Cancel backtest not implemented for ${this.name}`)}async optimize(e){throw new Error(`Optimization not supported by ${this.name}`)}async getOptimizationStatus(e){throw new Error(`Optimization not supported by ${this.name}`)}async cancelOptimization(e){throw new Error(`Optimization not supported by ${this.name}`)}async deployLive(e){throw new Error(`Live trading not supported by ${this.name}`)}async getLiveStatus(e){throw new Error(`Live trading not supported by ${this.name}`)}async stopLive(e){throw new Error(`Live trading not supported by ${this.name}`)}async pauseLive(e){throw new Error(`Live trading pause not supported by ${this.name}`)}async resumeLive(e){throw new Error(`Live trading resume not supported by ${this.name}`)}async createNotebook(e,r){throw new Error(`Notebooks not supported by ${this.name}`)}async getNotebookTemplates(){throw new Error(`Notebooks not supported by ${this.name}`)}async validateStrategy(e){const r=[],n=[];return e.name||r.push("Strategy name is required"),e.type||r.push("Strategy type is required"),e.type==="code"&&!e.code&&r.push("Code strategy requires code definition"),e.type==="visual"&&!e.visual&&r.push("Visual strategy requires visual definition"),e.type==="template"&&!e.template&&r.push("Template strategy requires template definition"),{valid:r.length===0,errors:r,warnings:n.length>0?n:void 0}}async getExampleStrategies(){return[]}async getHealth(){try{if(!this.initialized)return{status:"unhealthy",message:"Provider not initialized"};const e=await this.testConnection();return{status:e.success?"healthy":"unhealthy",message:e.message,details:{connected:this.connected,initialized:this.initialized}}}catch(e){return{status:"unhealthy",message:e instanceof Error?e.message:"Unknown error"}}}async getUsageStats(){return{totalBacktests:0,totalOptimizations:0}}validateConfig(e,r){const n=[];for(const i of r)(!(i in e)||!e[i])&&n.push(`Missing required configuration field: ${i}`);return{valid:n.length===0,errors:n}}createSuccessResult(e){return{success:!0,message:e}}createErrorResult(e){return{success:!1,message:"Initialization failed",error:e instanceof Error?e.message:e}}createTestSuccessResult(e,r){return{success:!0,message:e,metadata:r}}createTestErrorResult(e){return{success:!1,message:"Connection test failed",error:e instanceof Error?e.message:e}}generateId(){return`${this.name.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}log(e){console.log(`[${this.name}] ${e}`)}warn(e){console.warn(`[${this.name}] ${e}`)}error(e,r){console.error(`[${this.name}] ${e}`,r||"")}ensureInitialized(){if(!this.initialized)throw new Error(`${this.name} is not initialized. Call initialize() first.`)}ensureConnected(){if(this.ensureInitialized(),!this.connected)throw new Error(`${this.name} is not connected. Call testConnection() first.`)}async safeAsync(e,r){try{return await e()}catch(n){throw this.error(r,n),n}}parseDate(e){const r=new Date(e);if(isNaN(r.getTime()))throw new Error(`Invalid date: ${e}`);return r}formatDate(e){return e.toISOString().split("T")[0]}calculateDateRange(e,r){const n=this.parseDate(e),i=this.parseDate(r);return Math.floor((i.getTime()-n.getTime())/(1e3*60*60*24))}validateDateRange(e,r){try{const n=this.parseDate(e),i=this.parseDate(r);return n>=i?{valid:!1,error:"Start date must be before end date"}:i>new Date?{valid:!1,error:"End date cannot be in the future"}:{valid:!0}}catch(n){return{valid:!1,error:n instanceof Error?n.message:"Invalid date range"}}}}const l7={backtesting:!0,optimization:!0,liveTrading:!0,research:!0,multiAsset:["equity","forex","crypto","option","future","cfd"],indicators:!0,customStrategies:!0,maxConcurrentBacktests:5,supportedTimeframes:["tick","second","minute","hour","daily"],supportedMarkets:["us-equity","us-options","forex","crypto","futures","cfd"]};class c7{translate(e){switch(e.type){case"code":return this.translateCodeStrategy(e);case"visual":return this.translateVisualStrategy(e);case"template":return this.translateTemplateStrategy(e);default:throw new Error(`Unknown strategy type: ${e.type}`)}}translateCodeStrategy(e){if(!e.code||e.code.language!=="python")throw new Error("Code strategy must have Python code");const r=e.code.source;return r.includes("class")&&r.includes("QCAlgorithm")?this.addStrategyMetadata(r,e):this.wrapInQCAlgorithm(r,e)}translateVisualStrategy(e){if(!e.visual)throw new Error("Visual strategy must have visual definition");if(e.visual.generatedPython)return this.wrapInQCAlgorithm(e.visual.generatedPython,e);const r=this.generateFromNodes(e.visual.nodes,e.visual.edges);return this.wrapInQCAlgorithm(r,e)}translateTemplateStrategy(e){if(!e.template)throw new Error("Template strategy must have template definition");const r=this.loadTemplate(e.template.templateId),n=this.fillTemplate(r.pythonCode,e.template.parameters);return this.addStrategyMetadata(n,e)}wrapInQCAlgorithm(e,r){const n=this.sanitizeClassName(r.name);return`
# ==============================================================================
# Lean Algorithm: ${r.name}
# Version: ${r.version}
# Author: ${r.author}
# Description: ${r.description}
# Generated by Fincept Terminal
# ==============================================================================

from AlgorithmImports import *

class ${n}(QCAlgorithm):
    """
    ${r.description}
    """

    def Initialize(self):
        """Initialize algorithm settings and data subscriptions"""

        # Set date range (will be overridden by CLI args)
        self.SetStartDate(${this.formatDateForLean(r.requires.startDate||"2020-01-01")})
        self.SetEndDate(${this.formatDateForLean(r.requires.endDate||new Date().toISOString())})

        # Set initial capital
        self.SetCash(${r.requires.capital})

        # Set brokerage model
        ${this.getBrokerageModel(r)}

        # Subscribe to data
        ${this.generateDataSubscriptions(r)}

        # User initialization code
        ${this.indentCode(e,2)}

    def OnData(self, data):
        """Event handler for data updates"""
        # User OnData logic would be extracted from userCode
        # For now, pass to user-defined methods
        pass

    def OnEndOfAlgorithm(self):
        """Called at the end of the algorithm"""
        self.Debug(f"Algorithm completed: {self.Portfolio.TotalPortfolioValue}")

# ==============================================================================
# End of Algorithm
# ==============================================================================
`.trim()}generateFromNodes(e,r){const n=[],i=this.topologicalSort(e,r);for(const o of i)switch(o.type){case"dataSource":n.push(this.generateDataSourceCode(o));break;case"indicator":n.push(this.generateIndicatorCode(o));break;case"condition":n.push(this.generateConditionCode(o));break;case"signal":n.push(this.generateSignalCode(o));break;case"order":n.push(this.generateOrderCode(o));break;default:n.push(`# Unknown node type: ${o.type}`)}return n.join(`

`)}generateDataSubscriptions(e){const r=[];if(e.requires.assets)for(const n of e.requires.assets){const i=n.symbol,o=this.getLeanResolution("daily");r.push(`self.AddEquity("${i}", ${o})`)}return r.join(`
        `)}getBrokerageModel(e){return"self.SetBrokerageModel(BrokerageName.Default)"}getLeanResolution(e){return{tick:"Resolution.Tick",second:"Resolution.Second",minute:"Resolution.Minute",hour:"Resolution.Hour",daily:"Resolution.Daily"}[e]||"Resolution.Daily"}formatDateForLean(e){const r=new Date(e);return`${r.getFullYear()}, ${r.getMonth()+1}, ${r.getDate()}`}sanitizeClassName(e){return e.replace(/[^a-zA-Z0-9]/g,"_").replace(/^[0-9]/,"_$&").replace(/_+/g,"_")}addStrategyMetadata(e,r){return`
# ==============================================================================
# Strategy: ${r.name}
# Version: ${r.version}
# Author: ${r.author}
# Description: ${r.description}
# Generated by Fincept Terminal
# ==============================================================================

`.trim()+`

`+e}indentCode(e,r){const n="  ".repeat(r);return e.split(`
`).map(i=>i.trim()?n+i:i).join(`
`)}topologicalSort(e,r){return[...e]}generateDataSourceCode(e){const r=e.data.symbol,n=this.getLeanResolution(e.data.timeframe||"daily");return`self.${e.id} = self.AddEquity("${r}", ${n})`}generateIndicatorCode(e){const r=e.data.indicator,n=e.data.period,i=e.data.symbol;return`self.${e.id} = self.${r}("${i}", ${n})`}generateConditionCode(e){return`# Condition: ${e.data.condition}`}generateSignalCode(e){return`# Signal: ${e.data.signal}`}generateOrderCode(e){const r=e.data.action,n=e.data.symbol,i=e.data.quantity;return`self.${r}("${n}", ${i})`}loadTemplate(e){throw new Error(`Template ${e} not found`)}fillTemplate(e,r){let n=e;for(const[i,o]of Object.entries(r)){const a=new RegExp(`\\{\\{${i}\\}\\}`,"g");n=n.replace(a,String(o))}return n}validate(e){const r=[];return e.includes("QCAlgorithm")||r.push("Code must define or import QCAlgorithm"),e.includes("def Initialize")||r.push("Algorithm must have Initialize method"),{valid:r.length===0,errors:r}}}class d7{constructor(e){Pe(this,"config");Pe(this,"runningProcesses",new Map);this.config=e}async runBacktest(e,r){const n=this.generateId(),i=this.buildCliCommand("backtest",e,r);this.runningProcesses.set(n,{status:"running",progress:0,logs:[]});try{console.log("[LeanCliExecutor] Executing command:",i),console.log("[LeanCliExecutor] Working directory:",e);const o=await lt("execute_command",{command:i});if(console.log("[LeanCliExecutor] Command completed:",o),!o.success)throw this.runningProcesses.get(n).status="failed",this.runningProcesses.get(n).error=o.stderr||"Command failed",this.runningProcesses.get(n).logs.push(o.stdout),this.runningProcesses.get(n).logs.push(o.stderr),new Error(o.stderr||"Lean CLI execution failed");return this.runningProcesses.get(n).status="completed",this.runningProcesses.get(n).progress=100,this.runningProcesses.get(n).logs.push(o.stdout),{id:n,processId:0}}catch(o){throw this.runningProcesses.get(n).status="failed",this.runningProcesses.get(n).error=String(o),o}}async runOptimization(e,r,n){const i=this.generateId(),o=this.buildCliCommand("optimize",e,{...r,optimizationConfig:n});this.runningProcesses.set(i,{status:"running",progress:0,logs:[]});try{const a=await lt("execute_lean_cli",{command:o,workingDir:e,backtestId:i});return this.runningProcesses.get(i).pid=a.process_id,{id:i,processId:a.process_id}}catch(a){throw this.runningProcesses.get(i).status="failed",this.runningProcesses.get(i).error=String(a),a}}async downloadData(e,r,n,i,o="usa"){const a=[this.config.leanCliPath,"data","download","--tickers",e.join(","),"--resolution",r,"--start",n,"--end",i,"--market",o,"--data-folder",this.config.dataPath].join(" ");return this.executeCommand(a)}async createProject(e,r="python"){const n=[this.config.leanCliPath,"project","create","--name",e,"--language",r,"--path",this.config.projectsPath].join(" ");return this.executeCommand(n)}getProcessStatus(e){return this.runningProcesses.get(e)||null}async cancelBacktest(e){const r=this.runningProcesses.get(e);if(!r||!r.pid)throw new Error(`Process ${e} not found or not running`);try{await lt("kill_lean_process",{processId:r.pid}),r.status="completed",this.runningProcesses.delete(e)}catch(n){throw new Error(`Failed to cancel backtest: ${n}`)}}updateProcessStatus(e,r){const n=this.runningProcesses.get(e);n&&this.runningProcesses.set(e,{...n,...r})}appendLog(e,r){const n=this.runningProcesses.get(e);n&&n.logs.push(r)}buildCliCommand(e,r,n){const i=[this.config.leanCliPath];return i.push(e),i.push(r),(n.resultsFolder||this.config.resultsPath)&&i.push("--output",n.resultsFolder||this.config.resultsPath),i.push("--data-provider-historical","Local"),i.push("--no-update"),n.release&&i.push("--release"),n.update&&i.push("--update"),i.join(" ")}async executeCommand(e){try{const r=await lt("execute_command",{command:e});return{success:r.success,stdout:r.stdout,stderr:r.stderr,exitCode:r.exit_code}}catch(r){return{success:!1,error:String(r)}}}generateId(){return`lean_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}cleanupCompletedProcesses(){for(const[e,r]of this.runningProcesses.entries())(r.status==="completed"||r.status==="failed")&&this.runningProcesses.delete(e)}getRunningProcesses(){return new Map(this.runningProcesses)}}class u7{parseBacktestResult(e,r,n){try{return{id:e,status:"completed",performance:this.parsePerformanceMetrics(r),trades:this.parseTrades(r),equity:this.parseEquityCurve(r),statistics:this.parseStatistics(r),charts:this.parseCharts(r),logs:n,startTime:this.extractStatistic(r,"Start"),endTime:this.extractStatistic(r,"End"),duration:this.calculateDuration(r)}}catch(i){return this.createErrorResult(e,String(i),n)}}parsePerformanceMetrics(e){const r=e.TotalPerformance?.PortfolioStatistics||{},n=e.TotalPerformance?.TradeStatistics||{};return{totalReturn:this.parsePercent(r.TotalReturn)||0,annualizedReturn:this.parsePercent(r.AnnualReturn)||0,sharpeRatio:this.parseFloat(r.SharpeRatio)||0,sortinoRatio:this.parseFloat(r.SortinoRatio)||0,maxDrawdown:this.parsePercent(r.MaxDrawdown)||0,volatility:this.parsePercent(r.AnnualStandardDeviation)||0,winRate:this.parsePercent(n.WinRate)||0,lossRate:this.parsePercent(n.LossRate)||0,totalTrades:Number(n.TotalNumberOfTrades)||0,winningTrades:this.calculateWinningTrades(n),losingTrades:this.calculateLosingTrades(n),averageWin:this.parseFloat(n.AverageWin)||0,averageLoss:Math.abs(this.parseFloat(n.AverageLoss)||0),largestWin:this.parseFloat(n.LargestWin)||0,largestLoss:Math.abs(this.parseFloat(n.LargestLoss)||0),profitFactor:this.parseFloat(n.ProfitLossRatio)||0,averageTradeReturn:this.parseFloat(n.AverageProfit)||0,expectancy:this.calculateExpectancy(n),calmarRatio:this.calculateCalmarRatio(r),alpha:this.parseFloat(r.Alpha),beta:this.parseFloat(r.Beta),informationRatio:this.parseFloat(r.InformationRatio),treynorRatio:this.parseFloat(r.TreynorRatio)}}parseTrades(e){if(!e.Orders)return[];const r=Object.values(e.Orders),n=[];for(const i of r)i.Status==="Filled"&&n.push({id:`trade_${i.Id}`,symbol:i.Symbol,entryDate:i.Time,side:i.Quantity>0?"long":"short",quantity:Math.abs(i.Quantity),entryPrice:i.Price,commission:0,slippage:0,exitDate:void 0,exitPrice:void 0,pnl:void 0,pnlPercent:void 0,holdingPeriod:void 0,exitReason:void 0});return n}parseEquityCurve(e){if(!e.Charts||!e.Charts["Strategy Equity"])return[];const n=e.Charts["Strategy Equity"].Series.Equity;if(!n||!n.Values)return[];const i=[];let o=0;for(const a of n.Values){const l=a.y,d=o>0?(l-o)/o:0;i.push({date:new Date(a.x*1e3).toISOString(),equity:l,returns:d,drawdown:this.calculateDrawdown(l,i),benchmark:this.extractBenchmark(e,a.x)}),o=l}return i}parseStatistics(e){return e.Statistics,e.RuntimeStatistics,{startDate:this.extractStatistic(e,"Start")||"",endDate:this.extractStatistic(e,"End")||"",initialCapital:this.parseFloat(this.extractStatistic(e,"Equity"))||1e5,finalCapital:this.parseFloat(this.extractStatistic(e,"Net Profit"))||1e5,totalFees:this.parseFloat(this.extractStatistic(e,"Fees"))||0,totalSlippage:0,totalTrades:this.parseFloat(this.extractStatistic(e,"Total Trades"))||0,winningDays:0,losingDays:0,averageDailyReturn:0,bestDay:0,worstDay:0,consecutiveWins:0,consecutiveLosses:0,maxDrawdownDate:void 0,recoveryTime:void 0}}parseCharts(e){if(!e.Charts)return;const r=[];for(const[n,i]of Object.entries(e.Charts))for(const[o,a]of Object.entries(i.Series))r.push({type:this.mapChartType(i.ChartType),title:`${n} - ${o}`,data:a.Values.map(l=>({x:new Date(l.x*1e3).toISOString(),y:l.y}))});return r}parseOptimizationResult(e,r,n){if(!r||r.length===0)throw new Error("No optimization results found");const i=this.findBestOptimizationResult(r);return{id:e,status:"completed",best_parameters:i.ParameterSet,best_result:i,all_results:r.map(o=>({parameters:o.ParameterSet,statistics:this.parseStatisticsArray(o.Statistics)})),iterations:r.length,duration:0,error:void 0}}createErrorResult(e,r,n){return{id:e,status:"failed",error:r,logs:n,performance:this.getEmptyMetrics(),trades:[],equity:[],statistics:this.getEmptyStatistics()}}parseFloat(e){if(e==null)return;const r=typeof e=="string"?parseFloat(e):Number(e);return isNaN(r)?void 0:r}parsePercent(e){if(!e)return 0;const r=String(e).replace("%","");return parseFloat(r)/100}extractStatistic(e,r){return e.Statistics?.find(i=>i.Key===r)?.Value}parseStatisticsArray(e){const r={};for(const n of e)r[n.Key]=n.Value;return r}calculateWinningTrades(e){const r=Number(e.TotalNumberOfTrades)||0,n=this.parsePercent(e.WinRate)||0;return Math.round(r*n)}calculateLosingTrades(e){const r=Number(e.TotalNumberOfTrades)||0,n=this.parsePercent(e.LossRate)||0;return Math.round(r*n)}calculateExpectancy(e){const r=this.parseFloat(e.AverageWin)||0,n=Math.abs(this.parseFloat(e.AverageLoss)||0),i=this.parsePercent(e.WinRate)||0,o=this.parsePercent(e.LossRate)||0;return i*r-o*n}calculateCalmarRatio(e){const r=this.parsePercent(e.AnnualReturn)||0,n=Math.abs(this.parsePercent(e.MaxDrawdown)||1);return n!==0?r/n:0}calculateDrawdown(e,r){if(r.length===0)return 0;const n=Math.max(...r.map(i=>i.equity),e);return n>0?(e-n)/n:0}extractBenchmark(e,r){e.Charts?.Benchmark}calculateDuration(e){const r=this.extractStatistic(e,"Start"),n=this.extractStatistic(e,"End");if(!r||!n)return;const i=new Date(r).getTime();return new Date(n).getTime()-i}findBestOptimizationResult(e){let r=e[0],n=-1/0;for(const i of e){const o=this.parseFloat(i.Statistics.find(a=>a.Key==="Sharpe Ratio")?.Value)||0;o>n&&(n=o,r=i)}return r}mapChartType(e){return{Line:"line",Stock:"candlestick",Scatter:"line",Pie:"bar"}[e]||"line"}getEmptyMetrics(){return{totalReturn:0,annualizedReturn:0,sharpeRatio:0,sortinoRatio:0,maxDrawdown:0,winRate:0,lossRate:0,profitFactor:0,volatility:0,calmarRatio:0,totalTrades:0,winningTrades:0,losingTrades:0,averageWin:0,averageLoss:0,largestWin:0,largestLoss:0,averageTradeReturn:0,expectancy:0}}getEmptyStatistics(){return{startDate:"",endDate:"",initialCapital:0,finalCapital:0,totalFees:0,totalSlippage:0,totalTrades:0,winningDays:0,losingDays:0,averageDailyReturn:0,bestDay:0,worstDay:0,consecutiveWins:0,consecutiveLosses:0}}}class P2 extends ux{constructor(){super(...arguments);Pe(this,"name","QuantConnect Lean");Pe(this,"version","2.5.0");Pe(this,"capabilities",l7);Pe(this,"description","Institutional-grade algorithmic trading engine with 400TB+ of data");Pe(this,"leanConfig",null);Pe(this,"cliExecutor",null);Pe(this,"strategyTranslator",new c7);Pe(this,"resultsParser",new u7);Pe(this,"activeBacktests",new Map)}joinPath(...r){return r.join("/").replace(/\/+/g,"/")}async initialize(r){try{const n=r.settings;return n.leanCliPath?await this.checkLeanCliExists(n.leanCliPath)?(await this.ensureDirectories(n),this.leanConfig=n,this.cliExecutor=new d7(n),this.config=r,this.initialized=!0,this.createSuccessResult(`Lean initialized successfully. CLI: ${n.leanCliPath}`)):this.createErrorResult(`Lean CLI not found at: ${n.leanCliPath}. Please install Lean or update the path.`):this.createErrorResult("leanCliPath is required in config")}catch(n){return this.createErrorResult(n instanceof Error?n:String(n))}}async testConnection(){this.ensureInitialized();try{const r=await lt("execute_command",{command:`${this.leanConfig.leanCliPath} --version`});return r.success?(this.connected=!0,{success:!0,message:`Lean CLI is operational. Version: ${r.stdout.trim()}`,latency:0}):{success:!1,message:"Lean CLI test failed",error:r.stderr}}catch(r){return{success:!1,message:"Failed to connect to Lean CLI",error:String(r)}}}async disconnect(){for(const r of this.activeBacktests.keys())try{await this.cancelBacktest(r)}catch(n){ir.error(`Failed to cancel backtest ${r}:`,n)}this.activeBacktests.clear(),this.connected=!1,this.initialized=!1}async runBacktest(r){this.ensureConnected();const n=this.generateId();try{ir.debug("Starting backtest:",n),ir.debug("Translating strategy...");const i=this.strategyTranslator.translate(r.strategy);ir.debug("Strategy code length:",i.length),ir.debug("Creating Lean project...");const o=await this.createLeanProject(n,i,r);ir.debug("Project created at:",o);const a={algorithm:"main.py",startDate:this.formatDateForLean(r.startDate),endDate:this.formatDateForLean(r.endDate),cash:r.initialCapital,parameters:r.parameters,dataFolder:this.leanConfig.dataPath,resultsFolder:this.joinPath(this.leanConfig.resultsPath,n)};ir.debug("CLI args:",a),ir.debug("Executing Lean CLI...");const l=await this.cliExecutor.runBacktest(o,a);ir.debug("Execution started, process ID:",l.processId),this.activeBacktests.set(n,{id:n,status:"running",progress:0,message:"Backtest started"}),ir.debug("Waiting for completion...");const d=await this.waitForBacktestCompletion(n,l.processId);ir.info("Backtest completed");const p=this.cliExecutor.getProcessStatus(n)?.logs||[],f=this.resultsParser.parseBacktestResult(n,d,p);return ir.debug("Results parsed successfully"),this.activeBacktests.delete(n),f}catch(i){return ir.error("Backtest error:",i),this.activeBacktests.delete(n),{id:n,status:"failed",error:i instanceof Error?i.message:String(i),performance:{totalReturn:0,annualizedReturn:0,sharpeRatio:0,sortinoRatio:0,maxDrawdown:0,winRate:0,lossRate:0,profitFactor:0,volatility:0,calmarRatio:0,totalTrades:0,winningTrades:0,losingTrades:0,averageWin:0,averageLoss:0,largestWin:0,largestLoss:0,averageTradeReturn:0,expectancy:0},statistics:{startDate:r.startDate,endDate:r.endDate,initialCapital:r.initialCapital,finalCapital:r.initialCapital,totalFees:0,totalSlippage:0,totalTrades:0,winningDays:0,losingDays:0,averageDailyReturn:0,bestDay:0,worstDay:0,consecutiveWins:0,consecutiveLosses:0},trades:[],equity:[],logs:[`Error: ${i instanceof Error?i.message:String(i)}`]}}}async getBacktestStatus(r){const n=this.activeBacktests.get(r);if(!n)return{id:r,status:"completed",progress:100,message:"Backtest not found or already completed"};const i=this.cliExecutor.getProcessStatus(r);return i&&(n.progress=i.progress||0,n.message=i.logs[i.logs.length-1]||n.message),n}async cancelBacktest(r){this.ensureConnected(),await this.cliExecutor.cancelBacktest(r),this.activeBacktests.delete(r)}async getHistoricalData(r){this.ensureConnected();try{return await this.cliExecutor.downloadData(r.symbols,r.timeframe,this.formatDateForLean(r.startDate),this.formatDateForLean(r.endDate),"usa"),await this.readDownloadedData(r.symbols,r.timeframe)}catch(n){throw new Error(`Failed to fetch historical data: ${n}`)}}async getAvailableData(){return{markets:[{id:"us-equity",name:"US Equities",assetClasses:["equity"]},{id:"us-options",name:"US Options",assetClasses:["option"]},{id:"forex",name:"Forex",assetClasses:["forex"]},{id:"crypto",name:"Cryptocurrency",assetClasses:["crypto"]},{id:"futures",name:"Futures",assetClasses:["future"]}],timeframes:["tick","second","minute","hour","daily"],dateRange:{start:"1998-01-01",end:new Date().toISOString().split("T")[0]},dataSize:"400TB+",description:"QuantConnect data library with institutional-grade quality"}}async calculateIndicator(r,n){throw new Error("Standalone indicator calculation not supported by Lean. Use indicators within backtests.")}async getAvailableIndicators(){return{categories:[{name:"Trend",indicators:[{id:"sma",name:"Simple Moving Average",params:["period"]},{id:"ema",name:"Exponential Moving Average",params:["period"]},{id:"macd",name:"MACD",params:["fast","slow","signal"]}]},{name:"Momentum",indicators:[{id:"rsi",name:"Relative Strength Index",params:["period"]},{id:"stoch",name:"Stochastic Oscillator",params:["period"]}]},{name:"Volatility",indicators:[{id:"bb",name:"Bollinger Bands",params:["period","stdDev"]},{id:"atr",name:"Average True Range",params:["period"]}]}],total:100,description:"Full suite of technical indicators built into Lean"}}async optimize(r){this.ensureConnected();const n=this.generateId();try{const i=this.strategyTranslator.translate(r.strategy),o=await this.createLeanProject(n,i,r),a={target:r.optimizationTarget,constraints:r.constraints,parameters:r.parameterRanges},l=await this.cliExecutor.runOptimization(o,{algorithm:"main.py",dataFolder:this.leanConfig.dataPath,resultsFolder:this.joinPath(this.leanConfig.resultsPath,n)},a),d=await this.waitForOptimizationCompletion(n,l.processId),p=this.cliExecutor.getProcessStatus(n)?.logs||[];return this.resultsParser.parseOptimizationResult(n,d,p)}catch(i){throw new Error(`Optimization failed: ${i}`)}}async validateStrategy(r){try{const n=this.strategyTranslator.translate(r),i=this.strategyTranslator.validate(n);if(!i.valid)return{valid:!1,errors:i.errors,warnings:[]};const o=[],a=[];if(r.requires.assets)for(const l of r.requires.assets)this.capabilities.multiAsset.includes(l.assetClass)||o.push(`Asset class "${l.assetClass}" not supported by Lean`);return{valid:o.length===0,errors:o,warnings:a}}catch(n){return{valid:!1,errors:[String(n)],warnings:[]}}}async deployLive(r){throw new Error("Live trading deployment requires QuantConnect cloud subscription")}async createNotebook(r,n){throw new Error("Research notebooks require QuantConnect cloud subscription")}async getHealth(){return this.initialized?this.connected?{status:"healthy",message:"All systems operational"}:{status:"degraded",message:"Not connected"}:{status:"unhealthy",message:"Not initialized"}}async checkLeanCliExists(r){try{const n=await lt("execute_command",{command:`${r} --version`});return ir.debug("CLI check result:",n),n.success}catch(n){return ir.error("CLI check failed:",n),!1}}async ensureDirectories(r){const n=[r.projectsPath,r.dataPath,r.resultsPath];for(const i of n)try{await lt("create_directory",{path:i})}catch(o){ir.error(`Failed to create directory ${i}:`,o)}}async createLeanProject(r,n,i){const o=this.joinPath(this.leanConfig.projectsPath,r);await lt("create_directory",{path:o});const a=this.joinPath(o,"main.py");await lt("write_file",{path:a,content:n});const l=this.joinPath(o,"lean.json");return await lt("write_file",{path:l,content:JSON.stringify({"algorithm-language":"Python",parameters:{},description:r,"cloud-id":0,"local-id":0},null,2)}),ir.debug("Created lean.json config file"),o}async waitForBacktestCompletion(r,n){return new Promise((i,o)=>{const a=setInterval(async()=>{const l=this.cliExecutor.getProcessStatus(r);if(l?.status==="completed"){clearInterval(a);const d=this.joinPath(this.leanConfig.resultsPath,r,"results.json");try{const p=await lt("read_file",{path:d});i(JSON.parse(p))}catch(p){o(new Error(`Failed to read results: ${p}`))}}else l?.status==="failed"&&(clearInterval(a),o(new Error(l.error||"Backtest failed")))},1e3);setTimeout(()=>{clearInterval(a),o(new Error("Backtest timeout"))},36e5)})}async waitForOptimizationCompletion(r,n){return[]}async readDownloadedData(r,n){return[]}formatDateForLean(r){const n=new Date(r),i=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0");return`${i}${o}${a}`}}class Ag{static async getAppDataDir(){return this.appDataPath||(this.appDataPath=await FI()),this.appDataPath}static async getLeanBaseDir(){const e=await this.getAppDataDir();return await uf(e,"Fincept","Lean")}static async getLeanProjectsDir(){const e=await this.getLeanBaseDir();return await uf(e,"projects")}static async getLeanDataDir(){const e=await this.getLeanBaseDir();return await uf(e,"data")}static async getLeanResultsDir(){const e=await this.getLeanBaseDir();return await uf(e,"results")}static async getDefaultLeanConfig(){const[e,r,n]=await Promise.all([this.getLeanProjectsDir(),this.getLeanDataDir(),this.getLeanResultsDir()]);let i="lean";return navigator.platform.toLowerCase().includes("win")?i=`C:/Users/${await this.getUsername()}/AppData/Roaming/Python/Python313/Scripts/lean.exe`:(navigator.platform.toLowerCase().includes("mac"),i="/usr/local/bin/lean"),{leanCliPath:i,projectsPath:e,dataPath:r,resultsPath:n,environment:"backtesting"}}static async getUsername(){try{const r=(await this.getAppDataDir()).split(/[\\/]/);if(navigator.platform.toLowerCase().includes("win")){const n=r.indexOf("Users");if(n>=0&&n+1<r.length)return r[n+1]}else{const n=r.indexOf("Users")>=0?r.indexOf("Users"):r.indexOf("home");if(n>=0&&n+1<r.length)return r[n+1]}}catch(e){console.error("[PathService] Failed to extract username:",e)}return"User"}static async getPathsInfo(){const[e,r,n,i]=await Promise.all([this.getLeanBaseDir(),this.getLeanProjectsDir(),this.getLeanDataDir(),this.getLeanResultsDir()]);return{platform:navigator.platform,baseDir:e,projectsDir:r,dataDir:n,resultsDir:i}}}Pe(Ag,"appDataPath",null);const pt={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",BORDER:"#2A2A2A",HOVER:"#1F1F1F",MUTED:"#4A4A4A"};function p7(){const[s,e]=S.useState(null),[r,n]=S.useState(!1);S.useEffect(()=>{i()},[]);const i=async()=>{try{const o=await Ag.getPathsInfo();e(o)}catch(o){console.error("[PathInfo] Failed to load paths:",o)}};return s?t.jsxs("div",{style:{marginBottom:"20px",padding:"12px",backgroundColor:pt.PANEL_BG,border:`1px solid ${pt.BORDER}`,borderLeft:`3px solid ${pt.YELLOW}`,borderRadius:"3px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>n(!r),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(Mn,{size:14,color:pt.YELLOW}),t.jsx("span",{style:{color:pt.WHITE,fontSize:"11px",fontWeight:600,letterSpacing:"0.5px"},children:"DATA STORAGE LOCATION"})]}),t.jsxs("span",{style:{color:pt.GRAY,fontSize:"10px"},children:[r?"":""," ",r?"Hide":"Show"," Paths"]})]}),r&&t.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:`1px solid ${pt.BORDER}`},children:[t.jsxs("div",{style:{fontSize:"9px",color:pt.GRAY,marginBottom:"8px"},children:["Platform: ",t.jsx("span",{style:{color:pt.CYAN},children:s.platform})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[t.jsx(_f,{label:"Base Directory",path:s.baseDir}),t.jsx(_f,{label:"Projects",path:s.projectsDir}),t.jsx(_f,{label:"Data",path:s.dataDir}),t.jsx(_f,{label:"Results",path:s.resultsDir})]}),t.jsx("div",{style:{marginTop:"10px",padding:"8px",backgroundColor:pt.HEADER_BG,borderRadius:"2px",fontSize:"9px",color:pt.GRAY,lineHeight:"1.5"},children:" Backtesting data is stored in your application data folder, separate from the project directory. This ensures clean project management and follows OS best practices."})]})]}):null}function _f({label:s,path:e}){return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px",fontSize:"9px"},children:[t.jsxs("span",{style:{color:pt.GRAY},children:[s,":"]}),t.jsx("code",{style:{color:pt.CYAN,backgroundColor:pt.HEADER_BG,padding:"4px 6px",borderRadius:"2px",fontFamily:"monospace",wordBreak:"break-all"},children:e})]})}function h7({colors:s}){const[e,r]=S.useState([]),[n,i]=S.useState(!0),[o,a]=S.useState({}),[l,d]=S.useState(null),[p,f]=S.useState(!1),[h,x]=S.useState(null),[m,b]=S.useState({name:"QuantConnect Lean",adapter_type:"LeanAdapter",config:JSON.stringify({leanCliPath:"lean",projectsPath:"",dataPath:"",resultsPath:"",environment:"backtesting"},null,2)});S.useEffect(()=>{w(),T(),C(),y()},[]);const w=async()=>{try{const P=await Ag.getDefaultLeanConfig();b({name:"QuantConnect Lean",adapter_type:"LeanAdapter",config:JSON.stringify(P,null,2)}),console.log("[Backtesting] Initialized OS-specific paths:",P)}catch(P){console.error("[Backtesting] Failed to initialize default paths:",P)}},y=async()=>{try{const P=await Je.getBacktestingProviders(),I=await Ag.getDefaultLeanConfig();for(const O of P)try{const G=JSON.parse(O.config);if(G.projectsPath?.includes("fincept-terminal-desktop")||G.dataPath?.includes("fincept-terminal-desktop")||G.resultsPath?.includes("fincept-terminal-desktop")){console.log(`[Backtesting] Migrating provider "${O.name}" to new paths`);const F={...G,projectsPath:I.projectsPath,dataPath:I.dataPath,resultsPath:I.resultsPath};await Je.saveBacktestingProvider({...O,config:JSON.stringify(F,null,2)}),console.log(`[Backtesting] Migrated provider "${O.name}" successfully`)}}catch(G){console.error(`[Backtesting] Failed to migrate provider "${O.name}":`,G)}await T()}catch(P){console.error("[Backtesting] Failed to migrate provider paths:",P)}},C=()=>{try{if(!Ss.getProvider("QuantConnect Lean")){const P=new P2;Ss.registerProvider(P),console.log("[Backtesting] Registered providers:",Ss.listProviders())}}catch(P){console.error("[Backtesting] Failed to register providers:",P)}},T=async()=>{try{i(!0);const P=await Je.getBacktestingProviders();r(P);const I={};for(const O of P)I[O.name]={connected:!1,testing:!1};a(I)}catch(P){console.error("[Backtesting] Failed to load providers:",P),R("error","Failed to load providers")}finally{i(!1)}},E=async P=>{a(I=>({...I,[P.name]:{...I[P.name],testing:!0,error:void 0}}));try{const I=Ss.getProvider(P.name);if(!I)throw new Error(`Provider "${P.name}" not registered`);const O=JSON.parse(P.config),G=await I.initialize({name:P.name,adapterType:P.adapter_type,settings:O});if(!G.success)throw new Error(G.error||"Initialization failed");const B=await I.testConnection();a(F=>({...F,[P.name]:{connected:B.success,testing:!1,error:B.error,message:B.message}})),B.success?R("success",`${P.name}: ${B.message}`):R("error",`${P.name}: ${B.error}`)}catch(I){a(O=>({...O,[P.name]:{connected:!1,testing:!1,error:String(I)}})),R("error",`Connection test failed: ${I}`)}},j=async P=>{try{const I=Ss.getProvider(P);if(!I)throw new Error(`Provider "${P}" not registered`);const O=e.find(F=>F.name===P);if(!O)throw new Error(`Provider "${P}" not found in database`);const G=JSON.parse(O.config),B=await I.initialize({name:O.name,adapterType:O.adapter_type,settings:G});if(!B.success)throw new Error(B.error||"Initialization failed");await Je.setActiveBacktestingProvider(P),await Ss.setActiveProvider(P),await T(),R("success",`Activated provider: ${P}`)}catch(I){R("error",`Failed to activate provider: ${I}`)}},k=async()=>{try{JSON.parse(m.config);const P={id:crypto.randomUUID(),name:m.name,adapter_type:m.adapter_type,config:m.config,enabled:!0,is_active:!1};await Je.saveBacktestingProvider(P),await T(),f(!1),R("success","Provider added successfully"),await w()}catch(P){R("error",`Failed to save provider: ${P}`)}},A=async P=>{if(confirm("Are you sure you want to delete this provider?"))try{await Je.deleteBacktestingProvider(P),await T(),R("success","Provider deleted")}catch(I){R("error",`Failed to delete provider: ${I}`)}},R=(P,I)=>{x({type:P,text:I}),setTimeout(()=>x(null),5e3)},M=P=>Ss.getProvider(P)?.capabilities;return n?t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"60px",color:pt.GRAY},children:[t.jsx(ni,{size:24,className:"animate-spin",style:{marginRight:"12px"}}),t.jsx("span",{style:{fontSize:"12px",fontWeight:600,letterSpacing:"0.5px"},children:"LOADING PROVIDERS..."})]}):t.jsxs("div",{style:{fontFamily:'"IBM Plex Mono", "Consolas", monospace'},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"24px",paddingBottom:"12px",borderBottom:`2px solid ${pt.ORANGE}`},children:[t.jsx(Cs,{size:20,color:pt.ORANGE,style:{filter:`drop-shadow(0 0 4px ${pt.ORANGE})`}}),t.jsx("h2",{style:{color:pt.ORANGE,fontSize:"16px",fontWeight:700,letterSpacing:"1px",margin:0,textShadow:`0 0 10px ${pt.ORANGE}40`},children:"BACKTESTING PROVIDERS"})]}),t.jsx("div",{style:{marginBottom:"20px",padding:"12px",backgroundColor:pt.HEADER_BG,border:`1px solid ${pt.BORDER}`,borderLeft:`3px solid ${pt.CYAN}`},children:t.jsx("p",{style:{color:pt.GRAY,fontSize:"10px",margin:0,lineHeight:"1.6"},children:"Manage backtesting engines. Switch between Lean, Backtrader, and other providers seamlessly."})}),t.jsx(p7,{}),h&&t.jsxs("div",{style:{padding:"12px 16px",marginBottom:"20px",backgroundColor:h.type==="success"?`${pt.GREEN}15`:`${pt.RED}15`,border:`1px solid ${h.type==="success"?pt.GREEN:pt.RED}`,borderLeft:`3px solid ${h.type==="success"?pt.GREEN:pt.RED}`,borderRadius:"3px",display:"flex",alignItems:"center",gap:"10px"},children:[h.type==="success"?t.jsx(Bn,{size:16,color:pt.GREEN}):t.jsx(Rr,{size:16,color:pt.RED}),t.jsx("span",{style:{color:h.type==="success"?pt.GREEN:pt.RED,fontSize:"10px",fontWeight:600},children:h.text})]}),t.jsxs("button",{onClick:()=>f(!p),style:{padding:"10px 20px",marginBottom:"20px",backgroundColor:pt.GREEN,color:"#000000",border:"none",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontWeight:700,fontSize:"11px",letterSpacing:"0.5px",boxShadow:`0 0 12px ${pt.GREEN}40`,transition:"all 0.2s"},onMouseEnter:P=>{P.currentTarget.style.boxShadow=`0 0 20px ${pt.GREEN}60`,P.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:P=>{P.currentTarget.style.boxShadow=`0 0 12px ${pt.GREEN}40`,P.currentTarget.style.transform="translateY(0)"},children:[t.jsx(wn,{size:16}),"ADD PROVIDER"]}),p&&t.jsxs("div",{style:{marginBottom:"20px",padding:"20px",backgroundColor:pt.PANEL_BG,border:`1px solid ${pt.BORDER}`,borderLeft:`3px solid ${pt.ORANGE}`,borderRadius:"4px"},children:[t.jsx("h3",{style:{color:pt.ORANGE,marginBottom:"16px",fontSize:"13px",fontWeight:700,letterSpacing:"0.5px"},children:"ADD NEW PROVIDER"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:pt.WHITE,display:"block",marginBottom:"6px",fontSize:"10px",fontWeight:600,letterSpacing:"0.5px"},children:"PROVIDER TYPE"}),t.jsxs("select",{value:m.name,onChange:P=>{const I=P.target.value;let O={};I==="QuantConnect Lean"?O={leanCliPath:"C:/Users/Tilak/AppData/Roaming/Python/Python313/Scripts/lean.exe",projectsPath:"C:/windowsdisk/finceptTerminal/fincept-terminal-desktop/lean_projects",dataPath:"C:/windowsdisk/finceptTerminal/fincept-terminal-desktop/lean_data",resultsPath:"C:/windowsdisk/finceptTerminal/fincept-terminal-desktop/lean_results",environment:"backtesting"}:I==="Backtesting.py"?O={}:I==="VectorBT"&&(O={}),b({...m,name:I,config:JSON.stringify(O,null,2)})},style:{width:"100%",padding:"10px",backgroundColor:pt.DARK_BG,color:pt.WHITE,border:`1px solid ${pt.BORDER}`,borderRadius:"3px",fontSize:"11px",fontWeight:500,cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23FF8800' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 10px center",paddingRight:"32px"},children:[t.jsx("option",{value:"QuantConnect Lean",children:"QuantConnect Lean"}),t.jsx("option",{value:"Backtrader",children:"Backtrader"}),t.jsx("option",{value:"VectorBT",children:"VectorBT"}),t.jsx("option",{value:"Backtesting.py",children:"Backtesting.py"}),t.jsx("option",{value:"QuantLib",children:"QuantLib"}),t.jsx("option",{value:"Custom",children:"Custom"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:pt.WHITE,display:"block",marginBottom:"6px",fontSize:"10px",fontWeight:600,letterSpacing:"0.5px"},children:"CONFIGURATION (JSON)"}),t.jsx("textarea",{value:m.config,onChange:P=>b({...m,config:P.target.value}),rows:10,style:{width:"100%",padding:"10px",backgroundColor:pt.DARK_BG,color:pt.WHITE,border:`1px solid ${pt.BORDER}`,borderRadius:"3px",fontFamily:"monospace",fontSize:"10px",lineHeight:"1.5",resize:"vertical"}})]}),t.jsxs("div",{style:{display:"flex",gap:"12px"},children:[t.jsx("button",{onClick:k,style:{padding:"10px 20px",backgroundColor:pt.GREEN,color:"#000000",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:700,fontSize:"10px",letterSpacing:"0.5px",transition:"all 0.2s"},onMouseEnter:P=>P.currentTarget.style.opacity="0.8",onMouseLeave:P=>P.currentTarget.style.opacity="1",children:"SAVE"}),t.jsx("button",{onClick:()=>f(!1),style:{padding:"10px 20px",backgroundColor:"transparent",color:pt.GRAY,border:`1px solid ${pt.BORDER}`,borderRadius:"4px",cursor:"pointer",fontWeight:700,fontSize:"10px",letterSpacing:"0.5px",transition:"all 0.2s"},onMouseEnter:P=>{P.currentTarget.style.borderColor=pt.RED,P.currentTarget.style.color=pt.RED},onMouseLeave:P=>{P.currentTarget.style.borderColor=pt.BORDER,P.currentTarget.style.color=pt.GRAY},children:"CANCEL"})]})]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(400px, 1fr))",gap:"16px",marginBottom:"20px"},children:e.length===0?t.jsxs("div",{style:{gridColumn:"1 / -1",padding:"60px 40px",textAlign:"center",backgroundColor:pt.PANEL_BG,border:`1px dashed ${pt.BORDER}`,borderRadius:"4px"},children:[t.jsx(Cs,{size:48,style:{margin:"0 auto 16px",opacity:.3,color:pt.ORANGE}}),t.jsx("p",{style:{color:pt.WHITE,fontSize:"13px",fontWeight:600,marginBottom:"8px"},children:"NO PROVIDERS CONFIGURED"}),t.jsx("p",{style:{color:pt.GRAY,fontSize:"10px"},children:'Click "ADD PROVIDER" to configure your first backtesting engine'})]}):e.map(P=>{const I=o[P.name]||{connected:!1,testing:!1},O=M(P.name),G=P.is_active;return t.jsxs("div",{style:{padding:"16px",backgroundColor:pt.PANEL_BG,border:`1px solid ${G?pt.ORANGE:pt.BORDER}`,borderLeft:`3px solid ${G?pt.ORANGE:pt.BORDER}`,borderRadius:"4px",transition:"all 0.2s",position:"relative",overflow:"hidden"},onMouseEnter:B=>{G||(B.currentTarget.style.backgroundColor=pt.HOVER,B.currentTarget.style.borderColor=pt.MUTED)},onMouseLeave:B=>{G||(B.currentTarget.style.backgroundColor=pt.PANEL_BG,B.currentTarget.style.borderColor=pt.BORDER)},children:[G&&t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:`linear-gradient(90deg, transparent, ${pt.ORANGE}, transparent)`,opacity:.5}}),t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",flex:1},children:[t.jsx(Cs,{size:20,style:{color:G?pt.ORANGE:pt.GRAY}}),t.jsxs("div",{children:[t.jsx("h3",{style:{color:G?pt.ORANGE:pt.WHITE,margin:0,fontSize:"12px",fontWeight:700,letterSpacing:"0.5px"},children:P.name}),t.jsx("p",{style:{color:pt.GRAY,fontSize:"9px",margin:0,fontWeight:500},children:P.adapter_type})]})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"},children:[G&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"3px 8px",backgroundColor:`${pt.GREEN}20`,borderRadius:"3px"},children:[t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:pt.GREEN,boxShadow:`0 0 6px ${pt.GREEN}`}}),t.jsx("span",{style:{color:pt.GREEN,fontSize:"9px",fontWeight:700},children:"ACTIVE"})]}),I.connected&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"3px 8px",backgroundColor:`${pt.CYAN}20`,borderRadius:"3px"},children:[t.jsx(Bn,{size:10,color:pt.CYAN}),t.jsx("span",{style:{color:pt.CYAN,fontSize:"9px",fontWeight:700},children:"CONNECTED"})]})]})]}),O&&t.jsx("div",{style:{marginBottom:"12px"},children:t.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px"},children:[O.backtesting&&t.jsx("span",{style:{padding:"3px 8px",backgroundColor:`${pt.ORANGE}15`,border:`1px solid ${pt.ORANGE}40`,borderRadius:"3px",color:pt.ORANGE,fontSize:"8px",fontWeight:700,letterSpacing:"0.5px"},children:"BACKTESTING"}),O.optimization&&t.jsx("span",{style:{padding:"3px 8px",backgroundColor:`${pt.CYAN}15`,border:`1px solid ${pt.CYAN}40`,borderRadius:"3px",color:pt.CYAN,fontSize:"8px",fontWeight:700,letterSpacing:"0.5px"},children:"OPTIMIZATION"}),O.liveTrading&&t.jsx("span",{style:{padding:"3px 8px",backgroundColor:`${pt.GREEN}15`,border:`1px solid ${pt.GREEN}40`,borderRadius:"3px",color:pt.GREEN,fontSize:"8px",fontWeight:700,letterSpacing:"0.5px"},children:"LIVE"}),O.research&&t.jsx("span",{style:{padding:"3px 8px",backgroundColor:`${pt.YELLOW}15`,border:`1px solid ${pt.YELLOW}40`,borderRadius:"3px",color:pt.YELLOW,fontSize:"8px",fontWeight:700,letterSpacing:"0.5px"},children:"RESEARCH"})]})}),I.message&&t.jsx("div",{style:{padding:"8px 10px",marginBottom:"12px",backgroundColor:I.connected?`${pt.GREEN}10`:`${pt.RED}10`,border:`1px solid ${I.connected?pt.GREEN:pt.RED}40`,borderRadius:"3px",fontSize:"9px",color:I.connected?pt.GREEN:pt.RED},children:I.message}),I.error&&t.jsxs("div",{style:{padding:"8px 10px",marginBottom:"12px",backgroundColor:`${pt.RED}10`,border:`1px solid ${pt.RED}40`,borderRadius:"3px",fontSize:"9px",color:pt.RED,display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(Rr,{size:12}),I.error]}),t.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>E(P),disabled:I.testing,style:{flex:1,padding:"8px 12px",backgroundColor:I.testing?pt.MUTED:pt.ORANGE,color:"#000000",border:"none",borderRadius:"3px",cursor:I.testing?"not-allowed":"pointer",opacity:I.testing?.6:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",fontSize:"9px",fontWeight:700,letterSpacing:"0.5px",transition:"all 0.2s"},onMouseEnter:B=>{I.testing||(B.currentTarget.style.opacity="0.8")},onMouseLeave:B=>{I.testing||(B.currentTarget.style.opacity="1")},children:I.testing?t.jsxs(t.Fragment,{children:[t.jsx(ni,{size:12,className:"animate-spin"}),"TESTING..."]}):t.jsxs(t.Fragment,{children:[t.jsx(l4,{size:12}),"TEST"]})}),!G&&t.jsxs("button",{onClick:()=>j(P.name),style:{padding:"8px 12px",backgroundColor:pt.GREEN,color:"#000000",border:"none",borderRadius:"3px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"9px",fontWeight:700,letterSpacing:"0.5px",transition:"all 0.2s"},onMouseEnter:B=>B.currentTarget.style.opacity="0.8",onMouseLeave:B=>B.currentTarget.style.opacity="1",children:[t.jsx(si,{size:12}),"ACTIVATE"]}),t.jsxs("button",{onClick:()=>A(P.name),style:{padding:"8px 12px",backgroundColor:"transparent",color:pt.GRAY,border:`1px solid ${pt.BORDER}`,borderRadius:"3px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"9px",fontWeight:700,letterSpacing:"0.5px",transition:"all 0.2s"},onMouseEnter:B=>{B.currentTarget.style.borderColor=pt.RED,B.currentTarget.style.color=pt.RED},onMouseLeave:B=>{B.currentTarget.style.borderColor=pt.BORDER,B.currentTarget.style.color=pt.GRAY},children:[t.jsx(On,{size:12}),"DELETE"]})]})]},P.id)})}),t.jsxs("div",{style:{padding:"16px",backgroundColor:pt.HEADER_BG,border:`1px solid ${pt.BORDER}`,borderTop:`2px solid ${pt.CYAN}`,borderRadius:"4px",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:pt.GRAY,fontSize:"9px",fontWeight:600,letterSpacing:"0.5px",marginBottom:"6px"},children:"REGISTERED PROVIDERS"}),t.jsx("div",{style:{color:pt.CYAN,fontSize:"20px",fontWeight:700},children:Ss.listProviders().length})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:pt.GRAY,fontSize:"9px",fontWeight:600,letterSpacing:"0.5px",marginBottom:"6px"},children:"ACTIVE PROVIDER"}),t.jsx("div",{style:{color:pt.GREEN,fontSize:"12px",fontWeight:700,letterSpacing:"0.5px"},children:Ss.getActiveProvider()?.name||"NONE"})]})]})]})}const g0=[{code:"en",name:"English",nativeName:"English",flag:""},{code:"es",name:"Spanish",nativeName:"Espaol",flag:""},{code:"fr",name:"French",nativeName:"Franais",flag:""},{code:"de",name:"German",nativeName:"Deutsch",flag:""},{code:"zh",name:"Chinese",nativeName:"",flag:""},{code:"ja",name:"Japanese",nativeName:"",flag:""},{code:"hi",name:"Hindi",nativeName:"",flag:""},{code:"ar",name:"Arabic",nativeName:"",flag:"",rtl:!0},{code:"pt",name:"Portuguese",nativeName:"Portugus",flag:""},{code:"ru",name:"Russian",nativeName:"",flag:""},{code:"bn",name:"Bengali",nativeName:"",flag:""},{code:"ko",name:"Korean",nativeName:"",flag:""},{code:"tr",name:"Turkish",nativeName:"Trke",flag:""},{code:"it",name:"Italian",nativeName:"Italiano",flag:""},{code:"id",name:"Indonesian",nativeName:"Bahasa Indonesia",flag:""},{code:"vi",name:"Vietnamese",nativeName:"Ting Vit",flag:""},{code:"th",name:"Thai",nativeName:"",flag:""},{code:"pl",name:"Polish",nativeName:"Polski",flag:""},{code:"uk",name:"Ukrainian",nativeName:"",flag:""},{code:"ro",name:"Romanian",nativeName:"Romn",flag:""}],L2=S.createContext(void 0),f7=({children:s})=>{const{i18n:e}=tx(),[r,n]=S.useState(e.language||"en"),[i,o]=S.useState(!1);S.useEffect(()=>{const d=localStorage.getItem("i18nextLng");d&&g0.find(p=>p.code===d)&&a(d)},[]),S.useEffect(()=>{const d=g0.find(p=>p.code===r);o(d?.rtl||!1),document.documentElement.dir=d?.rtl?"rtl":"ltr"},[r]);const a=async d=>{try{await e.changeLanguage(d),n(d),localStorage.setItem("i18nextLng",d),console.log(`Language changed to: ${d}`)}catch(p){console.error("Failed to change language:",p)}},l={currentLanguage:r,changeLanguage:a,availableLanguages:g0,isRTL:i};return t.jsx(L2.Provider,{value:l,children:s})},g7=()=>{const s=S.useContext(L2);if(!s)throw new Error("useLanguage must be used within a LanguageProvider");return s},Vt={ORANGE:"#FF8800",WHITE:"#FFFFFF",GREEN:"#00D66F",GRAY:"#787878",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",BORDER:"#2A2A2A",HOVER:"#1F1F1F",MUTED:"#4A4A4A"},x7=()=>{const{currentLanguage:s,changeLanguage:e,availableLanguages:r}=g7(),{t:n}=tx("settings");return t.jsxs("div",{style:{fontFamily:'"IBM Plex Mono", "Consolas", monospace'},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"24px",paddingBottom:"12px",borderBottom:`2px solid ${Vt.ORANGE}`},children:[t.jsx(fc,{size:20,color:Vt.ORANGE,style:{filter:`drop-shadow(0 0 4px ${Vt.ORANGE})`}}),t.jsx("h2",{style:{color:Vt.ORANGE,fontSize:"16px",fontWeight:700,letterSpacing:"1px",margin:0,textShadow:`0 0 10px ${Vt.ORANGE}40`},children:n("language.title","LANGUAGE SETTINGS")})]}),t.jsx("div",{style:{marginBottom:"20px",padding:"12px",backgroundColor:Vt.HEADER_BG,border:`1px solid ${Vt.BORDER}`,borderLeft:`3px solid ${Vt.CYAN}`},children:t.jsx("p",{style:{color:Vt.GRAY,fontSize:"10px",margin:0,lineHeight:"1.6"},children:n("language.selectLanguage","Select your preferred language for the terminal interface")})}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"12px",marginBottom:"24px"},children:r.map(i=>{const o=s===i.code;return t.jsxs("button",{onClick:()=>e(i.code),style:{display:"flex",alignItems:"center",gap:"12px",padding:"14px",backgroundColor:o?Vt.PANEL_BG:Vt.HEADER_BG,border:`1px solid ${o?Vt.ORANGE:Vt.BORDER}`,borderLeft:`3px solid ${o?Vt.ORANGE:Vt.BORDER}`,cursor:"pointer",transition:"all 0.2s",position:"relative",overflow:"hidden"},onMouseEnter:a=>{o||(a.currentTarget.style.backgroundColor=Vt.HOVER,a.currentTarget.style.borderColor=Vt.MUTED)},onMouseLeave:a=>{o||(a.currentTarget.style.backgroundColor=Vt.HEADER_BG,a.currentTarget.style.borderColor=Vt.BORDER)},children:[t.jsx("span",{style:{fontSize:"32px",lineHeight:1,filter:o?"brightness(1.2)":"brightness(0.8)"},children:i.flag}),t.jsxs("div",{style:{flex:1,textAlign:"left"},children:[t.jsx("div",{style:{color:o?Vt.ORANGE:Vt.WHITE,fontSize:"12px",fontWeight:700,marginBottom:"2px",letterSpacing:"0.5px"},children:i.nativeName}),t.jsx("div",{style:{color:Vt.GRAY,fontSize:"9px",fontWeight:500},children:i.name})]}),o&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Es,{size:14,color:Vt.GREEN}),t.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:Vt.GREEN,boxShadow:`0 0 8px ${Vt.GREEN}`}})]}),o&&t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:`linear-gradient(90deg, transparent, ${Vt.ORANGE}, transparent)`,opacity:.5}})]},i.code)})}),t.jsxs("div",{style:{padding:"16px",backgroundColor:Vt.HEADER_BG,border:`1px solid ${Vt.BORDER}`,borderTop:`2px solid ${Vt.GREEN}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:Vt.GREEN,boxShadow:`0 0 8px ${Vt.GREEN}`}}),t.jsxs("span",{style:{color:Vt.GRAY,fontSize:"10px",fontWeight:600,letterSpacing:"0.5px"},children:[n("language.currentLanguage","CURRENT LANGUAGE"),":"]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{fontSize:"18px"},children:r.find(i=>i.code===s)?.flag||""}),t.jsx("span",{style:{color:Vt.CYAN,fontSize:"12px",fontWeight:700,letterSpacing:"0.5px"},children:r.find(i=>i.code===s)?.nativeName||"English"})]})]}),t.jsx("div",{style:{marginTop:"20px",padding:"12px 16px",backgroundColor:`${Vt.CYAN}10`,border:`1px solid ${Vt.CYAN}40`,borderLeft:`3px solid ${Vt.CYAN}`},children:t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"},children:[t.jsx(fc,{size:14,color:Vt.CYAN,style:{marginTop:"1px",flexShrink:0}}),t.jsx("div",{style:{color:Vt.GRAY,fontSize:"9px",lineHeight:"1.5"},children:"Language changes will apply immediately across the entire terminal interface. All menus, labels, and system messages will be displayed in the selected language."})]})}),t.jsxs("div",{style:{marginTop:"20px",display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[t.jsxs("div",{style:{padding:"12px",backgroundColor:Vt.HEADER_BG,border:`1px solid ${Vt.BORDER}`,textAlign:"center"},children:[t.jsx("div",{style:{color:Vt.YELLOW,fontSize:"20px",fontWeight:700,marginBottom:"4px"},children:r.length}),t.jsx("div",{style:{color:Vt.GRAY,fontSize:"9px",fontWeight:600,letterSpacing:"0.5px"},children:"LANGUAGES"})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:Vt.HEADER_BG,border:`1px solid ${Vt.BORDER}`,textAlign:"center"},children:[t.jsx("div",{style:{color:Vt.GREEN,fontSize:"20px",fontWeight:700,marginBottom:"4px"},children:"100%"}),t.jsx("div",{style:{color:Vt.GRAY,fontSize:"9px",fontWeight:600,letterSpacing:"0.5px"},children:"COVERAGE"})]}),t.jsxs("div",{style:{padding:"12px",backgroundColor:Vt.HEADER_BG,border:`1px solid ${Vt.BORDER}`,textAlign:"center"},children:[t.jsx("div",{style:{color:Vt.CYAN,fontSize:"20px",fontWeight:700,marginBottom:"4px"},children:"RTL"}),t.jsx("div",{style:{color:Vt.GRAY,fontSize:"9px",fontWeight:600,letterSpacing:"0.5px"},children:"SUPPORTED"})]})]})]})};function m7(){for(var s=arguments.length,e=new Array(s),r=0;r<s;r++)e[r]=arguments[r];return S.useMemo(()=>n=>{e.forEach(i=>i(n))},e)}const px=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Vd(s){const e=Object.prototype.toString.call(s);return e==="[object Window]"||e==="[object global]"}function Ev(s){return"nodeType"in s}function wi(s){var e,r;return s?Vd(s)?s:Ev(s)&&(e=(r=s.ownerDocument)==null?void 0:r.defaultView)!=null?e:window:window}function Cv(s){const{Document:e}=wi(s);return s instanceof e}function Qp(s){return Vd(s)?!1:s instanceof wi(s).HTMLElement}function z2(s){return s instanceof wi(s).SVGElement}function Xd(s){return s?Vd(s)?s.document:Ev(s)?Cv(s)?s:Qp(s)||z2(s)?s.ownerDocument:document:document:document}const Yo=px?S.useLayoutEffect:S.useEffect;function jv(s){const e=S.useRef(s);return Yo(()=>{e.current=s}),S.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function y7(){const s=S.useRef(null),e=S.useCallback((n,i)=>{s.current=setInterval(n,i)},[]),r=S.useCallback(()=>{s.current!==null&&(clearInterval(s.current),s.current=null)},[]);return[e,r]}function zp(s,e){e===void 0&&(e=[s]);const r=S.useRef(s);return Yo(()=>{r.current!==s&&(r.current=s)},e),r}function Zp(s,e){const r=S.useRef();return S.useMemo(()=>{const n=s(r.current);return r.current=n,n},[...e])}function Tg(s){const e=jv(s),r=S.useRef(null),n=S.useCallback(i=>{i!==r.current&&e?.(i,r.current),r.current=i},[]);return[r,n]}function mb(s){const e=S.useRef();return S.useEffect(()=>{e.current=s},[s]),e.current}let x0={};function eh(s,e){return S.useMemo(()=>{if(e)return e;const r=x0[s]==null?0:x0[s]+1;return x0[s]=r,s+"-"+r},[s,e])}function M2(s){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((o,a)=>{const l=Object.entries(a);for(const[d,p]of l){const f=o[d];f!=null&&(o[d]=f+s*p)}return o},{...e})}}const Ed=M2(1),Mp=M2(-1);function b7(s){return"clientX"in s&&"clientY"in s}function kv(s){if(!s)return!1;const{KeyboardEvent:e}=wi(s.target);return e&&s instanceof e}function v7(s){if(!s)return!1;const{TouchEvent:e}=wi(s.target);return e&&s instanceof e}function yb(s){if(v7(s)){if(s.touches&&s.touches.length){const{clientX:e,clientY:r}=s.touches[0];return{x:e,y:r}}else if(s.changedTouches&&s.changedTouches.length){const{clientX:e,clientY:r}=s.changedTouches[0];return{x:e,y:r}}}return b7(s)?{x:s.clientX,y:s.clientY}:null}const Ld=Object.freeze({Translate:{toString(s){if(!s)return;const{x:e,y:r}=s;return"translate3d("+(e?Math.round(e):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(s){if(!s)return;const{scaleX:e,scaleY:r}=s;return"scaleX("+e+") scaleY("+r+")"}},Transform:{toString(s){if(s)return[Ld.Translate.toString(s),Ld.Scale.toString(s)].join(" ")}},Transition:{toString(s){let{property:e,duration:r,easing:n}=s;return e+" "+r+"ms "+n}}}),ik="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function S7(s){return s.matches(ik)?s:s.querySelector(ik)}const w7={display:"none"};function E7(s){let{id:e,value:r}=s;return S.createElement("div",{id:e,style:w7},r)}function C7(s){let{id:e,announcement:r,ariaLiveType:n="assertive"}=s;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return S.createElement("div",{id:e,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function j7(){const[s,e]=S.useState("");return{announce:S.useCallback(n=>{n!=null&&e(n)},[]),announcement:s}}const B2=S.createContext(null);function k7(s){const e=S.useContext(B2);S.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(s)},[s,e])}function A7(){const[s]=S.useState(()=>new Set),e=S.useCallback(n=>(s.add(n),()=>s.delete(n)),[s]);return[S.useCallback(n=>{let{type:i,event:o}=n;s.forEach(a=>{var l;return(l=a[i])==null?void 0:l.call(a,o)})},[s]),e]}const T7={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},R7={onDragStart(s){let{active:e}=s;return"Picked up draggable item "+e.id+"."},onDragOver(s){let{active:e,over:r}=s;return r?"Draggable item "+e.id+" was moved over droppable area "+r.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(s){let{active:e,over:r}=s;return r?"Draggable item "+e.id+" was dropped over droppable area "+r.id:"Draggable item "+e.id+" was dropped."},onDragCancel(s){let{active:e}=s;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function N7(s){let{announcements:e=R7,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=T7}=s;const{announce:o,announcement:a}=j7(),l=eh("DndLiveRegion"),[d,p]=S.useState(!1);if(S.useEffect(()=>{p(!0)},[]),k7(S.useMemo(()=>({onDragStart(h){let{active:x}=h;o(e.onDragStart({active:x}))},onDragMove(h){let{active:x,over:m}=h;e.onDragMove&&o(e.onDragMove({active:x,over:m}))},onDragOver(h){let{active:x,over:m}=h;o(e.onDragOver({active:x,over:m}))},onDragEnd(h){let{active:x,over:m}=h;o(e.onDragEnd({active:x,over:m}))},onDragCancel(h){let{active:x,over:m}=h;o(e.onDragCancel({active:x,over:m}))}}),[o,e])),!d)return null;const f=S.createElement(S.Fragment,null,S.createElement(E7,{id:n,value:i.draggable}),S.createElement(C7,{id:l,announcement:a}));return r?wa.createPortal(f,r):f}var gs;(function(s){s.DragStart="dragStart",s.DragMove="dragMove",s.DragEnd="dragEnd",s.DragCancel="dragCancel",s.DragOver="dragOver",s.RegisterDroppable="registerDroppable",s.SetDroppableDisabled="setDroppableDisabled",s.UnregisterDroppable="unregisterDroppable"})(gs||(gs={}));function Rg(){}function Ng(s,e){return S.useMemo(()=>({sensor:s,options:e??{}}),[s,e])}function F2(){for(var s=arguments.length,e=new Array(s),r=0;r<s;r++)e[r]=arguments[r];return S.useMemo(()=>[...e].filter(n=>n!=null),[...e])}const ko=Object.freeze({x:0,y:0});function $2(s,e){return Math.sqrt(Math.pow(s.x-e.x,2)+Math.pow(s.y-e.y,2))}function G2(s,e){let{data:{value:r}}=s,{data:{value:n}}=e;return r-n}function O7(s,e){let{data:{value:r}}=s,{data:{value:n}}=e;return n-r}function ok(s){let{left:e,top:r,height:n,width:i}=s;return[{x:e,y:r},{x:e+i,y:r},{x:e,y:r+n},{x:e+i,y:r+n}]}function U2(s,e){if(!s||s.length===0)return null;const[r]=s;return r[e]}function ak(s,e,r){return e===void 0&&(e=s.left),r===void 0&&(r=s.top),{x:e+s.width*.5,y:r+s.height*.5}}const bb=s=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=s;const i=ak(e,e.left,e.top),o=[];for(const a of n){const{id:l}=a,d=r.get(l);if(d){const p=$2(ak(d),i);o.push({id:l,data:{droppableContainer:a,value:p}})}}return o.sort(G2)},_7=s=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=s;const i=ok(e),o=[];for(const a of n){const{id:l}=a,d=r.get(l);if(d){const p=ok(d),f=i.reduce((x,m,b)=>x+$2(p[b],m),0),h=Number((f/4).toFixed(4));o.push({id:l,data:{droppableContainer:a,value:h}})}}return o.sort(G2)};function D7(s,e){const r=Math.max(e.top,s.top),n=Math.max(e.left,s.left),i=Math.min(e.left+e.width,s.left+s.width),o=Math.min(e.top+e.height,s.top+s.height),a=i-n,l=o-r;if(n<i&&r<o){const d=e.width*e.height,p=s.width*s.height,f=a*l,h=f/(d+p-f);return Number(h.toFixed(4))}return 0}const I7=s=>{let{collisionRect:e,droppableRects:r,droppableContainers:n}=s;const i=[];for(const o of n){const{id:a}=o,l=r.get(a);if(l){const d=D7(l,e);d>0&&i.push({id:a,data:{droppableContainer:o,value:d}})}}return i.sort(O7)};function P7(s,e,r){return{...s,scaleX:e&&r?e.width/r.width:1,scaleY:e&&r?e.height/r.height:1}}function W2(s,e){return s&&e?{x:s.left-e.left,y:s.top-e.top}:ko}function L7(s){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.reduce((a,l)=>({...a,top:a.top+s*l.y,bottom:a.bottom+s*l.y,left:a.left+s*l.x,right:a.right+s*l.x}),{...r})}}const z7=L7(1);function M7(s){if(s.startsWith("matrix3d(")){const e=s.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(s.startsWith("matrix(")){const e=s.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function B7(s,e,r){const n=M7(e);if(!n)return s;const{scaleX:i,scaleY:o,x:a,y:l}=n,d=s.left-a-(1-i)*parseFloat(r),p=s.top-l-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),f=i?s.width/i:s.width,h=o?s.height/o:s.height;return{width:f,height:h,top:p,right:d+f,bottom:p+h,left:d}}const F7={ignoreTransform:!1};function Jd(s,e){e===void 0&&(e=F7);let r=s.getBoundingClientRect();if(e.ignoreTransform){const{transform:p,transformOrigin:f}=wi(s).getComputedStyle(s);p&&(r=B7(r,p,f))}const{top:n,left:i,width:o,height:a,bottom:l,right:d}=r;return{top:n,left:i,width:o,height:a,bottom:l,right:d}}function lk(s){return Jd(s,{ignoreTransform:!0})}function $7(s){const e=s.innerWidth,r=s.innerHeight;return{top:0,left:0,right:e,bottom:r,width:e,height:r}}function G7(s,e){return e===void 0&&(e=wi(s).getComputedStyle(s)),e.position==="fixed"}function U7(s,e){e===void 0&&(e=wi(s).getComputedStyle(s));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=e[i];return typeof o=="string"?r.test(o):!1})}function hx(s,e){const r=[];function n(i){if(e!=null&&r.length>=e||!i)return r;if(Cv(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!Qp(i)||z2(i)||r.includes(i))return r;const o=wi(s).getComputedStyle(i);return i!==s&&U7(i,o)&&r.push(i),G7(i,o)?r:n(i.parentNode)}return s?n(s):r}function q2(s){const[e]=hx(s,1);return e??null}function m0(s){return!px||!s?null:Vd(s)?s:Ev(s)?Cv(s)||s===Xd(s).scrollingElement?window:Qp(s)?s:null:null}function H2(s){return Vd(s)?s.scrollX:s.scrollLeft}function Y2(s){return Vd(s)?s.scrollY:s.scrollTop}function vb(s){return{x:H2(s),y:Y2(s)}}var ws;(function(s){s[s.Forward=1]="Forward",s[s.Backward=-1]="Backward"})(ws||(ws={}));function K2(s){return!px||!s?!1:s===document.scrollingElement}function V2(s){const e={x:0,y:0},r=K2(s)?{height:window.innerHeight,width:window.innerWidth}:{height:s.clientHeight,width:s.clientWidth},n={x:s.scrollWidth-r.width,y:s.scrollHeight-r.height},i=s.scrollTop<=e.y,o=s.scrollLeft<=e.x,a=s.scrollTop>=n.y,l=s.scrollLeft>=n.x;return{isTop:i,isLeft:o,isBottom:a,isRight:l,maxScroll:n,minScroll:e}}const W7={x:.2,y:.2};function q7(s,e,r,n,i){let{top:o,left:a,right:l,bottom:d}=r;n===void 0&&(n=10),i===void 0&&(i=W7);const{isTop:p,isBottom:f,isLeft:h,isRight:x}=V2(s),m={x:0,y:0},b={x:0,y:0},w={height:e.height*i.y,width:e.width*i.x};return!p&&o<=e.top+w.height?(m.y=ws.Backward,b.y=n*Math.abs((e.top+w.height-o)/w.height)):!f&&d>=e.bottom-w.height&&(m.y=ws.Forward,b.y=n*Math.abs((e.bottom-w.height-d)/w.height)),!x&&l>=e.right-w.width?(m.x=ws.Forward,b.x=n*Math.abs((e.right-w.width-l)/w.width)):!h&&a<=e.left+w.width&&(m.x=ws.Backward,b.x=n*Math.abs((e.left+w.width-a)/w.width)),{direction:m,speed:b}}function H7(s){if(s===document.scrollingElement){const{innerWidth:o,innerHeight:a}=window;return{top:0,left:0,right:o,bottom:a,width:o,height:a}}const{top:e,left:r,right:n,bottom:i}=s.getBoundingClientRect();return{top:e,left:r,right:n,bottom:i,width:s.clientWidth,height:s.clientHeight}}function X2(s){return s.reduce((e,r)=>Ed(e,vb(r)),ko)}function Y7(s){return s.reduce((e,r)=>e+H2(r),0)}function K7(s){return s.reduce((e,r)=>e+Y2(r),0)}function V7(s,e){if(e===void 0&&(e=Jd),!s)return;const{top:r,left:n,bottom:i,right:o}=e(s);q2(s)&&(i<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&s.scrollIntoView({block:"center",inline:"center"})}const X7=[["x",["left","right"],Y7],["y",["top","bottom"],K7]];class Av{constructor(e,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=hx(r),i=X2(n);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,a,l]of X7)for(const d of a)Object.defineProperty(this,d,{get:()=>{const p=l(n),f=i[o]-p;return this.rect[d]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Cp{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=e}add(e,r,n){var i;(i=this.target)==null||i.addEventListener(e,r,n),this.listeners.push([e,r,n])}}function J7(s){const{EventTarget:e}=wi(s);return s instanceof e?s:Xd(s)}function y0(s,e){const r=Math.abs(s.x),n=Math.abs(s.y);return typeof e=="number"?Math.sqrt(r**2+n**2)>e:"x"in e&&"y"in e?r>e.x&&n>e.y:"x"in e?r>e.x:"y"in e?n>e.y:!1}var io;(function(s){s.Click="click",s.DragStart="dragstart",s.Keydown="keydown",s.ContextMenu="contextmenu",s.Resize="resize",s.SelectionChange="selectionchange",s.VisibilityChange="visibilitychange"})(io||(io={}));function ck(s){s.preventDefault()}function Q7(s){s.stopPropagation()}var Dr;(function(s){s.Space="Space",s.Down="ArrowDown",s.Right="ArrowRight",s.Left="ArrowLeft",s.Up="ArrowUp",s.Esc="Escape",s.Enter="Enter",s.Tab="Tab"})(Dr||(Dr={}));const J2={start:[Dr.Space,Dr.Enter],cancel:[Dr.Esc],end:[Dr.Space,Dr.Enter,Dr.Tab]},Z7=(s,e)=>{let{currentCoordinates:r}=e;switch(s.code){case Dr.Right:return{...r,x:r.x+25};case Dr.Left:return{...r,x:r.x-25};case Dr.Down:return{...r,y:r.y+25};case Dr.Up:return{...r,y:r.y-25}}};class fx{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:r}}=e;this.props=e,this.listeners=new Cp(Xd(r)),this.windowListeners=new Cp(wi(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(io.Resize,this.handleCancel),this.windowListeners.add(io.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(io.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:r}=this.props,n=e.node.current;n&&V7(n),r(ko)}handleKeyDown(e){if(kv(e)){const{active:r,context:n,options:i}=this.props,{keyboardCodes:o=J2,coordinateGetter:a=Z7,scrollBehavior:l="smooth"}=i,{code:d}=e;if(o.end.includes(d)){this.handleEnd(e);return}if(o.cancel.includes(d)){this.handleCancel(e);return}const{collisionRect:p}=n.current,f=p?{x:p.left,y:p.top}:ko;this.referenceCoordinates||(this.referenceCoordinates=f);const h=a(e,{active:r,context:n.current,currentCoordinates:f});if(h){const x=Mp(h,f),m={x:0,y:0},{scrollableAncestors:b}=n.current;for(const w of b){const y=e.code,{isTop:C,isRight:T,isLeft:E,isBottom:j,maxScroll:k,minScroll:A}=V2(w),R=H7(w),M={x:Math.min(y===Dr.Right?R.right-R.width/2:R.right,Math.max(y===Dr.Right?R.left:R.left+R.width/2,h.x)),y:Math.min(y===Dr.Down?R.bottom-R.height/2:R.bottom,Math.max(y===Dr.Down?R.top:R.top+R.height/2,h.y))},P=y===Dr.Right&&!T||y===Dr.Left&&!E,I=y===Dr.Down&&!j||y===Dr.Up&&!C;if(P&&M.x!==h.x){const O=w.scrollLeft+x.x,G=y===Dr.Right&&O<=k.x||y===Dr.Left&&O>=A.x;if(G&&!x.y){w.scrollTo({left:O,behavior:l});return}G?m.x=w.scrollLeft-O:m.x=y===Dr.Right?w.scrollLeft-k.x:w.scrollLeft-A.x,m.x&&w.scrollBy({left:-m.x,behavior:l});break}else if(I&&M.y!==h.y){const O=w.scrollTop+x.y,G=y===Dr.Down&&O<=k.y||y===Dr.Up&&O>=A.y;if(G&&!x.x){w.scrollTo({top:O,behavior:l});return}G?m.y=w.scrollTop-O:m.y=y===Dr.Down?w.scrollTop-k.y:w.scrollTop-A.y,m.y&&w.scrollBy({top:-m.y,behavior:l});break}}this.handleMove(e,Ed(Mp(h,this.referenceCoordinates),m))}}}handleMove(e,r){const{onMove:n}=this.props;e.preventDefault(),n(r)}handleEnd(e){const{onEnd:r}=this.props;e.preventDefault(),this.detach(),r()}handleCancel(e){const{onCancel:r}=this.props;e.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}fx.activators=[{eventName:"onKeyDown",handler:(s,e,r)=>{let{keyboardCodes:n=J2,onActivation:i}=e,{active:o}=r;const{code:a}=s.nativeEvent;if(n.start.includes(a)){const l=o.activatorNode.current;return l&&s.target!==l?!1:(s.preventDefault(),i?.({event:s.nativeEvent}),!0)}return!1}}];function dk(s){return!!(s&&"distance"in s)}function uk(s){return!!(s&&"delay"in s)}class Tv{constructor(e,r,n){var i;n===void 0&&(n=J7(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=r;const{event:o}=e,{target:a}=o;this.props=e,this.events=r,this.document=Xd(a),this.documentListeners=new Cp(this.document),this.listeners=new Cp(n),this.windowListeners=new Cp(wi(a)),this.initialCoordinates=(i=yb(o))!=null?i:ko,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(io.Resize,this.handleCancel),this.windowListeners.add(io.DragStart,ck),this.windowListeners.add(io.VisibilityChange,this.handleCancel),this.windowListeners.add(io.ContextMenu,ck),this.documentListeners.add(io.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(uk(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(dk(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,r){const{active:n,onPending:i}=this.props;i(n,e,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:e}=this,{onStart:r}=this.props;e&&(this.activated=!0,this.documentListeners.add(io.Click,Q7,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(io.SelectionChange,this.removeTextSelection),r(e))}handleMove(e){var r;const{activated:n,initialCoordinates:i,props:o}=this,{onMove:a,options:{activationConstraint:l}}=o;if(!i)return;const d=(r=yb(e))!=null?r:ko,p=Mp(i,d);if(!n&&l){if(dk(l)){if(l.tolerance!=null&&y0(p,l.tolerance))return this.handleCancel();if(y0(p,l.distance))return this.handleStart()}if(uk(l)&&y0(p,l.tolerance))return this.handleCancel();this.handlePending(l,p);return}e.cancelable&&e.preventDefault(),a(d)}handleEnd(){const{onAbort:e,onEnd:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleCancel(){const{onAbort:e,onCancel:r}=this.props;this.detach(),this.activated||e(this.props.active),r()}handleKeydown(e){e.code===Dr.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const eY={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class gx extends Tv{constructor(e){const{event:r}=e,n=Xd(r.target);super(e,eY,n)}}gx.activators=[{eventName:"onPointerDown",handler:(s,e)=>{let{nativeEvent:r}=s,{onActivation:n}=e;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const tY={move:{name:"mousemove"},end:{name:"mouseup"}};var Sb;(function(s){s[s.RightClick=2]="RightClick"})(Sb||(Sb={}));class rY extends Tv{constructor(e){super(e,tY,Xd(e.event.target))}}rY.activators=[{eventName:"onMouseDown",handler:(s,e)=>{let{nativeEvent:r}=s,{onActivation:n}=e;return r.button===Sb.RightClick?!1:(n?.({event:r}),!0)}}];const b0={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class nY extends Tv{constructor(e){super(e,b0)}static setup(){return window.addEventListener(b0.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(b0.move.name,e)};function e(){}}}nY.activators=[{eventName:"onTouchStart",handler:(s,e)=>{let{nativeEvent:r}=s,{onActivation:n}=e;const{touches:i}=r;return i.length>1?!1:(n?.({event:r}),!0)}}];var jp;(function(s){s[s.Pointer=0]="Pointer",s[s.DraggableRect=1]="DraggableRect"})(jp||(jp={}));var Og;(function(s){s[s.TreeOrder=0]="TreeOrder",s[s.ReversedTreeOrder=1]="ReversedTreeOrder"})(Og||(Og={}));function sY(s){let{acceleration:e,activator:r=jp.Pointer,canScroll:n,draggingRect:i,enabled:o,interval:a=5,order:l=Og.TreeOrder,pointerCoordinates:d,scrollableAncestors:p,scrollableAncestorRects:f,delta:h,threshold:x}=s;const m=oY({delta:h,disabled:!o}),[b,w]=y7(),y=S.useRef({x:0,y:0}),C=S.useRef({x:0,y:0}),T=S.useMemo(()=>{switch(r){case jp.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case jp.DraggableRect:return i}},[r,i,d]),E=S.useRef(null),j=S.useCallback(()=>{const A=E.current;if(!A)return;const R=y.current.x*C.current.x,M=y.current.y*C.current.y;A.scrollBy(R,M)},[]),k=S.useMemo(()=>l===Og.TreeOrder?[...p].reverse():p,[l,p]);S.useEffect(()=>{if(!o||!p.length||!T){w();return}for(const A of k){if(n?.(A)===!1)continue;const R=p.indexOf(A),M=f[R];if(!M)continue;const{direction:P,speed:I}=q7(A,M,T,e,x);for(const O of["x","y"])m[O][P[O]]||(I[O]=0,P[O]=0);if(I.x>0||I.y>0){w(),E.current=A,b(j,a),y.current=I,C.current=P;return}}y.current={x:0,y:0},C.current={x:0,y:0},w()},[e,j,n,w,o,a,JSON.stringify(T),JSON.stringify(m),b,p,k,f,JSON.stringify(x)])}const iY={x:{[ws.Backward]:!1,[ws.Forward]:!1},y:{[ws.Backward]:!1,[ws.Forward]:!1}};function oY(s){let{delta:e,disabled:r}=s;const n=mb(e);return Zp(i=>{if(r||!n||!i)return iY;const o={x:Math.sign(e.x-n.x),y:Math.sign(e.y-n.y)};return{x:{[ws.Backward]:i.x[ws.Backward]||o.x===-1,[ws.Forward]:i.x[ws.Forward]||o.x===1},y:{[ws.Backward]:i.y[ws.Backward]||o.y===-1,[ws.Forward]:i.y[ws.Forward]||o.y===1}}},[r,e,n])}function aY(s,e){const r=e!=null?s.get(e):void 0,n=r?r.node.current:null;return Zp(i=>{var o;return e==null?null:(o=n??i)!=null?o:null},[n,e])}function lY(s,e){return S.useMemo(()=>s.reduce((r,n)=>{const{sensor:i}=n,o=i.activators.map(a=>({eventName:a.eventName,handler:e(a.handler,n)}));return[...r,...o]},[]),[s,e])}var Bp;(function(s){s[s.Always=0]="Always",s[s.BeforeDragging=1]="BeforeDragging",s[s.WhileDragging=2]="WhileDragging"})(Bp||(Bp={}));var wb;(function(s){s.Optimized="optimized"})(wb||(wb={}));const pk=new Map;function cY(s,e){let{dragging:r,dependencies:n,config:i}=e;const[o,a]=S.useState(null),{frequency:l,measure:d,strategy:p}=i,f=S.useRef(s),h=y(),x=zp(h),m=S.useCallback(function(C){C===void 0&&(C=[]),!x.current&&a(T=>T===null?C:T.concat(C.filter(E=>!T.includes(E))))},[x]),b=S.useRef(null),w=Zp(C=>{if(h&&!r)return pk;if(!C||C===pk||f.current!==s||o!=null){const T=new Map;for(let E of s){if(!E)continue;if(o&&o.length>0&&!o.includes(E.id)&&E.rect.current){T.set(E.id,E.rect.current);continue}const j=E.node.current,k=j?new Av(d(j),j):null;E.rect.current=k,k&&T.set(E.id,k)}return T}return C},[s,o,r,h,d]);return S.useEffect(()=>{f.current=s},[s]),S.useEffect(()=>{h||m()},[r,h]),S.useEffect(()=>{o&&o.length>0&&a(null)},[JSON.stringify(o)]),S.useEffect(()=>{h||typeof l!="number"||b.current!==null||(b.current=setTimeout(()=>{m(),b.current=null},l))},[l,h,m,...n]),{droppableRects:w,measureDroppableContainers:m,measuringScheduled:o!=null};function y(){switch(p){case Bp.Always:return!1;case Bp.BeforeDragging:return r;default:return!r}}}function Q2(s,e){return Zp(r=>s?r||(typeof e=="function"?e(s):s):null,[e,s])}function dY(s,e){return Q2(s,e)}function uY(s){let{callback:e,disabled:r}=s;const n=jv(e),i=S.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,r]);return S.useEffect(()=>()=>i?.disconnect(),[i]),i}function xx(s){let{callback:e,disabled:r}=s;const n=jv(e),i=S.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[r]);return S.useEffect(()=>()=>i?.disconnect(),[i]),i}function pY(s){return new Av(Jd(s),s)}function hk(s,e,r){e===void 0&&(e=pY);const[n,i]=S.useState(null);function o(){i(d=>{if(!s)return null;if(s.isConnected===!1){var p;return(p=d??r)!=null?p:null}const f=e(s);return JSON.stringify(d)===JSON.stringify(f)?d:f})}const a=uY({callback(d){if(s)for(const p of d){const{type:f,target:h}=p;if(f==="childList"&&h instanceof HTMLElement&&h.contains(s)){o();break}}}}),l=xx({callback:o});return Yo(()=>{o(),s?(l?.observe(s),a?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),a?.disconnect())},[s]),n}function hY(s){const e=Q2(s);return W2(s,e)}const fk=[];function fY(s){const e=S.useRef(s),r=Zp(n=>s?n&&n!==fk&&s&&e.current&&s.parentNode===e.current.parentNode?n:hx(s):fk,[s]);return S.useEffect(()=>{e.current=s},[s]),r}function gY(s){const[e,r]=S.useState(null),n=S.useRef(s),i=S.useCallback(o=>{const a=m0(o.target);a&&r(l=>l?(l.set(a,vb(a)),new Map(l)):null)},[]);return S.useEffect(()=>{const o=n.current;if(s!==o){a(o);const l=s.map(d=>{const p=m0(d);return p?(p.addEventListener("scroll",i,{passive:!0}),[p,vb(p)]):null}).filter(d=>d!=null);r(l.length?new Map(l):null),n.current=s}return()=>{a(s),a(o)};function a(l){l.forEach(d=>{const p=m0(d);p?.removeEventListener("scroll",i)})}},[i,s]),S.useMemo(()=>s.length?e?Array.from(e.values()).reduce((o,a)=>Ed(o,a),ko):X2(s):ko,[s,e])}function gk(s,e){e===void 0&&(e=[]);const r=S.useRef(null);return S.useEffect(()=>{r.current=null},e),S.useEffect(()=>{const n=s!==ko;n&&!r.current&&(r.current=s),!n&&r.current&&(r.current=null)},[s]),r.current?Mp(s,r.current):ko}function xY(s){S.useEffect(()=>{if(!px)return;const e=s.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of e)r?.()}},s.map(e=>{let{sensor:r}=e;return r}))}function mY(s,e){return S.useMemo(()=>s.reduce((r,n)=>{let{eventName:i,handler:o}=n;return r[i]=a=>{o(a,e)},r},{}),[s,e])}function Z2(s){return S.useMemo(()=>s?$7(s):null,[s])}const xk=[];function yY(s,e){e===void 0&&(e=Jd);const[r]=s,n=Z2(r?wi(r):null),[i,o]=S.useState(xk);function a(){o(()=>s.length?s.map(d=>K2(d)?n:new Av(e(d),d)):xk)}const l=xx({callback:a});return Yo(()=>{l?.disconnect(),a(),s.forEach(d=>l?.observe(d))},[s]),i}function bY(s){if(!s)return null;if(s.children.length>1)return s;const e=s.children[0];return Qp(e)?e:s}function vY(s){let{measure:e}=s;const[r,n]=S.useState(null),i=S.useCallback(p=>{for(const{target:f}of p)if(Qp(f)){n(h=>{const x=e(f);return h?{...h,width:x.width,height:x.height}:x});break}},[e]),o=xx({callback:i}),a=S.useCallback(p=>{const f=bY(p);o?.disconnect(),f&&o?.observe(f),n(f?e(f):null)},[e,o]),[l,d]=Tg(a);return S.useMemo(()=>({nodeRef:l,rect:r,setRef:d}),[r,l,d])}const SY=[{sensor:gx,options:{}},{sensor:fx,options:{}}],wY={current:{}},Zf={draggable:{measure:lk},droppable:{measure:lk,strategy:Bp.WhileDragging,frequency:wb.Optimized},dragOverlay:{measure:Jd}};class kp extends Map{get(e){var r;return e!=null&&(r=super.get(e))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:r}=e;return!r})}getNodeFor(e){var r,n;return(r=(n=this.get(e))==null?void 0:n.node.current)!=null?r:void 0}}const EY={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new kp,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Rg},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Zf,measureDroppableContainers:Rg,windowRect:null,measuringScheduled:!1},CY={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Rg,draggableNodes:new Map,over:null,measureDroppableContainers:Rg},mx=S.createContext(CY),eN=S.createContext(EY);function jY(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new kp}}}function kY(s,e){switch(e.type){case gs.DragStart:return{...s,draggable:{...s.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case gs.DragMove:return s.draggable.active==null?s:{...s,draggable:{...s.draggable,translate:{x:e.coordinates.x-s.draggable.initialCoordinates.x,y:e.coordinates.y-s.draggable.initialCoordinates.y}}};case gs.DragEnd:case gs.DragCancel:return{...s,draggable:{...s.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case gs.RegisterDroppable:{const{element:r}=e,{id:n}=r,i=new kp(s.droppable.containers);return i.set(n,r),{...s,droppable:{...s.droppable,containers:i}}}case gs.SetDroppableDisabled:{const{id:r,key:n,disabled:i}=e,o=s.droppable.containers.get(r);if(!o||n!==o.key)return s;const a=new kp(s.droppable.containers);return a.set(r,{...o,disabled:i}),{...s,droppable:{...s.droppable,containers:a}}}case gs.UnregisterDroppable:{const{id:r,key:n}=e,i=s.droppable.containers.get(r);if(!i||n!==i.key)return s;const o=new kp(s.droppable.containers);return o.delete(r),{...s,droppable:{...s.droppable,containers:o}}}default:return s}}function AY(s){let{disabled:e}=s;const{active:r,activatorEvent:n,draggableNodes:i}=S.useContext(mx),o=mb(n),a=mb(r?.id);return S.useEffect(()=>{if(!e&&!n&&o&&a!=null){if(!kv(o)||document.activeElement===o.target)return;const l=i.get(a);if(!l)return;const{activatorNode:d,node:p}=l;if(!d.current&&!p.current)return;requestAnimationFrame(()=>{for(const f of[d.current,p.current]){if(!f)continue;const h=S7(f);if(h){h.focus();break}}})}},[n,e,i,a,o]),null}function TY(s,e){let{transform:r,...n}=e;return s!=null&&s.length?s.reduce((i,o)=>o({transform:i,...n}),r):r}function RY(s){return S.useMemo(()=>({draggable:{...Zf.draggable,...s?.draggable},droppable:{...Zf.droppable,...s?.droppable},dragOverlay:{...Zf.dragOverlay,...s?.dragOverlay}}),[s?.draggable,s?.droppable,s?.dragOverlay])}function NY(s){let{activeNode:e,measure:r,initialRect:n,config:i=!0}=s;const o=S.useRef(!1),{x:a,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Yo(()=>{if(!a&&!l||!e){o.current=!1;return}if(o.current||!n)return;const p=e?.node.current;if(!p||p.isConnected===!1)return;const f=r(p),h=W2(f,n);if(a||(h.x=0),l||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const x=q2(p);x&&x.scrollBy({top:h.y,left:h.x})}},[e,a,l,n,r])}const tN=S.createContext({...ko,scaleX:1,scaleY:1});var fl;(function(s){s[s.Uninitialized=0]="Uninitialized",s[s.Initializing=1]="Initializing",s[s.Initialized=2]="Initialized"})(fl||(fl={}));const Eb=S.memo(function(e){var r,n,i,o;let{id:a,accessibility:l,autoScroll:d=!0,children:p,sensors:f=SY,collisionDetection:h=I7,measuring:x,modifiers:m,...b}=e;const w=S.useReducer(kY,void 0,jY),[y,C]=w,[T,E]=A7(),[j,k]=S.useState(fl.Uninitialized),A=j===fl.Initialized,{draggable:{active:R,nodes:M,translate:P},droppable:{containers:I}}=y,O=R!=null?M.get(R):null,G=S.useRef({initial:null,translated:null}),B=S.useMemo(()=>{var U;return R!=null?{id:R,data:(U=O?.data)!=null?U:wY,rect:G}:null},[R,O]),F=S.useRef(null),[z,$]=S.useState(null),[W,D]=S.useState(null),oe=zp(b,Object.values(b)),Z=eh("DndDescribedBy",a),fe=S.useMemo(()=>I.getEnabled(),[I]),Q=RY(x),{droppableRects:_,measureDroppableContainers:Y,measuringScheduled:he}=cY(fe,{dragging:A,dependencies:[P.x,P.y],config:Q.droppable}),me=aY(M,R),ge=S.useMemo(()=>W?yb(W):null,[W]),le=Ne(),X=dY(me,Q.draggable.measure);NY({activeNode:R!=null?M.get(R):null,config:le.layoutShiftCompensation,initialRect:X,measure:Q.draggable.measure});const V=hk(me,Q.draggable.measure,X),de=hk(me?me.parentElement:null),je=S.useRef({activatorEvent:null,active:null,activeNode:me,collisionRect:null,collisions:null,droppableRects:_,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:I,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),_e=I.getNodeFor((r=je.current.over)==null?void 0:r.id),Re=vY({measure:Q.dragOverlay.measure}),Be=(n=Re.nodeRef.current)!=null?n:me,Se=A?(i=Re.rect)!=null?i:V:null,ie=!!(Re.nodeRef.current&&Re.rect),ve=hY(ie?null:V),Ae=Z2(Be?wi(Be):null),$e=fY(A?_e??me:null),qe=yY($e),Ie=TY(m,{transform:{x:P.x-ve.x,y:P.y-ve.y,scaleX:1,scaleY:1},activatorEvent:W,active:B,activeNodeRect:V,containerNodeRect:de,draggingNodeRect:Se,over:je.current.over,overlayNodeRect:Re.rect,scrollableAncestors:$e,scrollableAncestorRects:qe,windowRect:Ae}),K=ge?Ed(ge,P):null,Ee=gY($e),Oe=gk(Ee),q=gk(Ee,[V]),ee=Ed(Ie,Oe),ce=Se?z7(Se,Ie):null,Ce=B&&ce?h({active:B,collisionRect:ce,droppableRects:_,droppableContainers:fe,pointerCoordinates:K}):null,be=U2(Ce,"id"),[We,J]=S.useState(null),se=ie?Ie:Ed(Ie,q),Te=P7(se,(o=We?.rect)!=null?o:null,V),Me=S.useRef(null),Qe=S.useCallback((U,ne)=>{let{sensor:xe,options:Le}=ne;if(F.current==null)return;const ze=M.get(F.current);if(!ze)return;const Ge=U.nativeEvent,Ze=new xe({active:F.current,activeNode:ze,event:Ge,options:Le,context:je,onAbort(bt){if(!M.get(bt))return;const{onDragAbort:yt}=oe.current,Pt={id:bt};yt?.(Pt),T({type:"onDragAbort",event:Pt})},onPending(bt,Lt,yt,Pt){if(!M.get(bt))return;const{onDragPending:tt}=oe.current,it={id:bt,constraint:Lt,initialCoordinates:yt,offset:Pt};tt?.(it),T({type:"onDragPending",event:it})},onStart(bt){const Lt=F.current;if(Lt==null)return;const yt=M.get(Lt);if(!yt)return;const{onDragStart:Pt}=oe.current,Et={activatorEvent:Ge,active:{id:Lt,data:yt.data,rect:G}};wa.unstable_batchedUpdates(()=>{Pt?.(Et),k(fl.Initializing),C({type:gs.DragStart,initialCoordinates:bt,active:Lt}),T({type:"onDragStart",event:Et}),$(Me.current),D(Ge)})},onMove(bt){C({type:gs.DragMove,coordinates:bt})},onEnd:xt(gs.DragEnd),onCancel:xt(gs.DragCancel)});Me.current=Ze;function xt(bt){return async function(){const{active:yt,collisions:Pt,over:Et,scrollAdjustedTranslate:tt}=je.current;let it=null;if(yt&&tt){const{cancelDrop:vt}=oe.current;it={activatorEvent:Ge,active:yt,collisions:Pt,delta:tt,over:Et},bt===gs.DragEnd&&typeof vt=="function"&&await Promise.resolve(vt(it))&&(bt=gs.DragCancel)}F.current=null,wa.unstable_batchedUpdates(()=>{C({type:bt}),k(fl.Uninitialized),J(null),$(null),D(null),Me.current=null;const vt=bt===gs.DragEnd?"onDragEnd":"onDragCancel";if(it){const rr=oe.current[vt];rr?.(it),T({type:vt,event:it})}})}}},[M]),ye=S.useCallback((U,ne)=>(xe,Le)=>{const ze=xe.nativeEvent,Ge=M.get(Le);if(F.current!==null||!Ge||ze.dndKit||ze.defaultPrevented)return;const Ze={active:Ge};U(xe,ne.options,Ze)===!0&&(ze.dndKit={capturedBy:ne.sensor},F.current=Le,Qe(xe,ne))},[M,Qe]),ue=lY(f,ye);xY(f),Yo(()=>{V&&j===fl.Initializing&&k(fl.Initialized)},[V,j]),S.useEffect(()=>{const{onDragMove:U}=oe.current,{active:ne,activatorEvent:xe,collisions:Le,over:ze}=je.current;if(!ne||!xe)return;const Ge={active:ne,activatorEvent:xe,collisions:Le,delta:{x:ee.x,y:ee.y},over:ze};wa.unstable_batchedUpdates(()=>{U?.(Ge),T({type:"onDragMove",event:Ge})})},[ee.x,ee.y]),S.useEffect(()=>{const{active:U,activatorEvent:ne,collisions:xe,droppableContainers:Le,scrollAdjustedTranslate:ze}=je.current;if(!U||F.current==null||!ne||!ze)return;const{onDragOver:Ge}=oe.current,Ze=Le.get(be),xt=Ze&&Ze.rect.current?{id:Ze.id,rect:Ze.rect.current,data:Ze.data,disabled:Ze.disabled}:null,bt={active:U,activatorEvent:ne,collisions:xe,delta:{x:ze.x,y:ze.y},over:xt};wa.unstable_batchedUpdates(()=>{J(xt),Ge?.(bt),T({type:"onDragOver",event:bt})})},[be]),Yo(()=>{je.current={activatorEvent:W,active:B,activeNode:me,collisionRect:ce,collisions:Ce,droppableRects:_,draggableNodes:M,draggingNode:Be,draggingNodeRect:Se,droppableContainers:I,over:We,scrollableAncestors:$e,scrollAdjustedTranslate:ee},G.current={initial:Se,translated:ce}},[B,me,Ce,ce,M,Be,Se,_,I,We,$e,ee]),sY({...le,delta:P,draggingRect:ce,pointerCoordinates:K,scrollableAncestors:$e,scrollableAncestorRects:qe});const re=S.useMemo(()=>({active:B,activeNode:me,activeNodeRect:V,activatorEvent:W,collisions:Ce,containerNodeRect:de,dragOverlay:Re,draggableNodes:M,droppableContainers:I,droppableRects:_,over:We,measureDroppableContainers:Y,scrollableAncestors:$e,scrollableAncestorRects:qe,measuringConfiguration:Q,measuringScheduled:he,windowRect:Ae}),[B,me,V,W,Ce,de,Re,M,I,_,We,Y,$e,qe,Q,he,Ae]),ke=S.useMemo(()=>({activatorEvent:W,activators:ue,active:B,activeNodeRect:V,ariaDescribedById:{draggable:Z},dispatch:C,draggableNodes:M,over:We,measureDroppableContainers:Y}),[W,ue,B,V,C,Z,M,We,Y]);return S.createElement(B2.Provider,{value:E},S.createElement(mx.Provider,{value:ke},S.createElement(eN.Provider,{value:re},S.createElement(tN.Provider,{value:Te},p)),S.createElement(AY,{disabled:l?.restoreFocus===!1})),S.createElement(N7,{...l,hiddenTextDescribedById:Z}));function Ne(){const U=z?.autoScrollEnabled===!1,ne=typeof d=="object"?d.enabled===!1:d===!1,xe=A&&!U&&!ne;return typeof d=="object"?{...d,enabled:xe}:{enabled:xe}}}),OY=S.createContext(null),mk="button",_Y="Draggable";function DY(s){let{id:e,data:r,disabled:n=!1,attributes:i}=s;const o=eh(_Y),{activators:a,activatorEvent:l,active:d,activeNodeRect:p,ariaDescribedById:f,draggableNodes:h,over:x}=S.useContext(mx),{role:m=mk,roleDescription:b="draggable",tabIndex:w=0}=i??{},y=d?.id===e,C=S.useContext(y?tN:OY),[T,E]=Tg(),[j,k]=Tg(),A=mY(a,e),R=zp(r);Yo(()=>(h.set(e,{id:e,key:o,node:T,activatorNode:j,data:R}),()=>{const P=h.get(e);P&&P.key===o&&h.delete(e)}),[h,e]);const M=S.useMemo(()=>({role:m,tabIndex:w,"aria-disabled":n,"aria-pressed":y&&m===mk?!0:void 0,"aria-roledescription":b,"aria-describedby":f.draggable}),[n,m,w,y,b,f.draggable]);return{active:d,activatorEvent:l,activeNodeRect:p,attributes:M,isDragging:y,listeners:n?void 0:A,node:T,over:x,setNodeRef:E,setActivatorNodeRef:k,transform:C}}function IY(){return S.useContext(eN)}const PY="Droppable",LY={timeout:25};function zY(s){let{data:e,disabled:r=!1,id:n,resizeObserverConfig:i}=s;const o=eh(PY),{active:a,dispatch:l,over:d,measureDroppableContainers:p}=S.useContext(mx),f=S.useRef({disabled:r}),h=S.useRef(!1),x=S.useRef(null),m=S.useRef(null),{disabled:b,updateMeasurementsFor:w,timeout:y}={...LY,...i},C=zp(w??n),T=S.useCallback(()=>{if(!h.current){h.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{p(Array.isArray(C.current)?C.current:[C.current]),m.current=null},y)},[y]),E=xx({callback:T,disabled:b||!a}),j=S.useCallback((M,P)=>{E&&(P&&(E.unobserve(P),h.current=!1),M&&E.observe(M))},[E]),[k,A]=Tg(j),R=zp(e);return S.useEffect(()=>{!E||!k.current||(E.disconnect(),h.current=!1,E.observe(k.current))},[k,E]),S.useEffect(()=>(l({type:gs.RegisterDroppable,element:{id:n,key:o,disabled:r,node:k,rect:x,data:R}}),()=>l({type:gs.UnregisterDroppable,key:o,id:n})),[n]),S.useEffect(()=>{r!==f.current.disabled&&(l({type:gs.SetDroppableDisabled,id:n,key:o,disabled:r}),f.current.disabled=r)},[n,o,r,l]),{active:a,rect:x,isOver:d?.id===n,node:k,over:d,setNodeRef:A}}function Fp(s,e,r){const n=s.slice();return n.splice(r<0?n.length+r:r,0,n.splice(e,1)[0]),n}function MY(s,e){return s.reduce((r,n,i)=>{const o=e.get(n);return o&&(r[i]=o),r},Array(s.length))}function Df(s){return s!==null&&s>=0}function BY(s,e){if(s===e)return!0;if(s.length!==e.length)return!1;for(let r=0;r<s.length;r++)if(s[r]!==e[r])return!1;return!0}function FY(s){return typeof s=="boolean"?{draggable:s,droppable:s}:s}const rN=s=>{let{rects:e,activeIndex:r,overIndex:n,index:i}=s;const o=Fp(e,n,r),a=e[i],l=o[i];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},If={scaleX:1,scaleY:1},Cb=s=>{var e;let{activeIndex:r,activeNodeRect:n,index:i,rects:o,overIndex:a}=s;const l=(e=o[r])!=null?e:n;if(!l)return null;if(i===r){const p=o[a];return p?{x:0,y:r<a?p.top+p.height-(l.top+l.height):p.top-l.top,...If}:null}const d=$Y(o,i,r);return i>r&&i<=a?{x:0,y:-l.height-d,...If}:i<r&&i>=a?{x:0,y:l.height+d,...If}:{x:0,y:0,...If}};function $Y(s,e,r){const n=s[e],i=s[e-1],o=s[e+1];return n?r<e?i?n.top-(i.top+i.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}const nN="Sortable",sN=S.createContext({activeIndex:-1,containerId:nN,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:rN,disabled:{draggable:!1,droppable:!1}});function jb(s){let{children:e,id:r,items:n,strategy:i=rN,disabled:o=!1}=s;const{active:a,dragOverlay:l,droppableRects:d,over:p,measureDroppableContainers:f}=IY(),h=eh(nN,r),x=l.rect!==null,m=S.useMemo(()=>n.map(A=>typeof A=="object"&&"id"in A?A.id:A),[n]),b=a!=null,w=a?m.indexOf(a.id):-1,y=p?m.indexOf(p.id):-1,C=S.useRef(m),T=!BY(m,C.current),E=y!==-1&&w===-1||T,j=FY(o);Yo(()=>{T&&b&&f(m)},[T,m,b,f]),S.useEffect(()=>{C.current=m},[m]);const k=S.useMemo(()=>({activeIndex:w,containerId:h,disabled:j,disableTransforms:E,items:m,overIndex:y,useDragOverlay:x,sortedRects:MY(m,d),strategy:i}),[w,h,j.draggable,j.droppable,E,m,y,d,x,i]);return S.createElement(sN.Provider,{value:k},e)}const GY=s=>{let{id:e,items:r,activeIndex:n,overIndex:i}=s;return Fp(r,n,i).indexOf(e)},UY=s=>{let{containerId:e,isSorting:r,wasDragging:n,index:i,items:o,newIndex:a,previousItems:l,previousContainerId:d,transition:p}=s;return!p||!n||l!==o&&i===a?!1:r?!0:a!==i&&e===d},WY={duration:200,easing:"ease"},iN="transform",qY=Ld.Transition.toString({property:iN,duration:0,easing:"linear"}),HY={roleDescription:"sortable"};function YY(s){let{disabled:e,index:r,node:n,rect:i}=s;const[o,a]=S.useState(null),l=S.useRef(r);return Yo(()=>{if(!e&&r!==l.current&&n.current){const d=i.current;if(d){const p=Jd(n.current,{ignoreTransform:!0}),f={x:d.left-p.left,y:d.top-p.top,scaleX:d.width/p.width,scaleY:d.height/p.height};(f.x||f.y)&&a(f)}}r!==l.current&&(l.current=r)},[e,r,n,i]),S.useEffect(()=>{o&&a(null)},[o]),o}function oN(s){let{animateLayoutChanges:e=UY,attributes:r,disabled:n,data:i,getNewIndex:o=GY,id:a,strategy:l,resizeObserverConfig:d,transition:p=WY}=s;const{items:f,containerId:h,activeIndex:x,disabled:m,disableTransforms:b,sortedRects:w,overIndex:y,useDragOverlay:C,strategy:T}=S.useContext(sN),E=KY(n,m),j=f.indexOf(a),k=S.useMemo(()=>({sortable:{containerId:h,index:j,items:f},...i}),[h,i,j,f]),A=S.useMemo(()=>f.slice(f.indexOf(a)),[f,a]),{rect:R,node:M,isOver:P,setNodeRef:I}=zY({id:a,data:k,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...d}}),{active:O,activatorEvent:G,activeNodeRect:B,attributes:F,setNodeRef:z,listeners:$,isDragging:W,over:D,setActivatorNodeRef:oe,transform:Z}=DY({id:a,data:k,attributes:{...HY,...r},disabled:E.draggable}),fe=m7(I,z),Q=!!O,_=Q&&!b&&Df(x)&&Df(y),Y=!C&&W,he=Y&&_?Z:null,ge=_?he??(l??T)({rects:w,activeNodeRect:B,activeIndex:x,overIndex:y,index:j}):null,le=Df(x)&&Df(y)?o({id:a,items:f,activeIndex:x,overIndex:y}):j,X=O?.id,V=S.useRef({activeId:X,items:f,newIndex:le,containerId:h}),de=f!==V.current.items,je=e({active:O,containerId:h,isDragging:W,isSorting:Q,id:a,index:j,items:f,newIndex:V.current.newIndex,previousItems:V.current.items,previousContainerId:V.current.containerId,transition:p,wasDragging:V.current.activeId!=null}),_e=YY({disabled:!je,index:j,node:M,rect:R});return S.useEffect(()=>{Q&&V.current.newIndex!==le&&(V.current.newIndex=le),h!==V.current.containerId&&(V.current.containerId=h),f!==V.current.items&&(V.current.items=f)},[Q,le,h,f]),S.useEffect(()=>{if(X===V.current.activeId)return;if(X!=null&&V.current.activeId==null){V.current.activeId=X;return}const Be=setTimeout(()=>{V.current.activeId=X},50);return()=>clearTimeout(Be)},[X]),{active:O,activeIndex:x,attributes:F,data:k,rect:R,index:j,newIndex:le,items:f,isOver:P,isSorting:Q,isDragging:W,listeners:$,node:M,overIndex:y,over:D,setNodeRef:fe,setActivatorNodeRef:oe,setDroppableNodeRef:I,setDraggableNodeRef:z,transform:_e??ge,transition:Re()};function Re(){if(_e||de&&V.current.newIndex===j)return qY;if(!(Y&&!kv(G)||!p)&&(Q||je))return Ld.Transition.toString({...p,property:iN})}}function KY(s,e){var r,n;return typeof s=="boolean"?{draggable:s,droppable:!1}:{draggable:(r=s?.draggable)!=null?r:e.draggable,droppable:(n=s?.droppable)!=null?n:e.droppable}}function _g(s){if(!s)return!1;const e=s.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const VY=[Dr.Down,Dr.Right,Dr.Up,Dr.Left],aN=(s,e)=>{let{context:{active:r,collisionRect:n,droppableRects:i,droppableContainers:o,over:a,scrollableAncestors:l}}=e;if(VY.includes(s.code)){if(s.preventDefault(),!r||!n)return;const d=[];o.getEnabled().forEach(h=>{if(!h||h!=null&&h.disabled)return;const x=i.get(h.id);if(x)switch(s.code){case Dr.Down:n.top<x.top&&d.push(h);break;case Dr.Up:n.top>x.top&&d.push(h);break;case Dr.Left:n.left>x.left&&d.push(h);break;case Dr.Right:n.left<x.left&&d.push(h);break}});const p=_7({collisionRect:n,droppableRects:i,droppableContainers:d});let f=U2(p,"id");if(f===a?.id&&p.length>1&&(f=p[1].id),f!=null){const h=o.get(r.id),x=o.get(f),m=x?i.get(x.id):null,b=x?.node.current;if(b&&m&&h&&x){const y=hx(b).some((A,R)=>l[R]!==A),C=lN(h,x),T=XY(h,x),E=y||!C?{x:0,y:0}:{x:T?n.width-m.width:0,y:T?n.height-m.height:0},j={x:m.left,y:m.top};return E.x&&E.y?j:Mp(j,E)}}}};function lN(s,e){return!_g(s)||!_g(e)?!1:s.data.current.sortable.containerId===e.data.current.sortable.containerId}function XY(s,e){return!_g(s)||!_g(e)||!lN(s,e)?!1:s.data.current.sortable.index<e.data.current.sortable.index}const kb=[{id:"dashboard",label:"Dashboard",value:"dashboard",shortcut:"F1",component:"DashboardTab"},{id:"markets",label:"Markets",value:"markets",shortcut:"F2",component:"MarketsTab"},{id:"news",label:"News",value:"news",shortcut:"F3",component:"NewsTab"},{id:"portfolio",label:"Portfolio",value:"portfolio",shortcut:"F4",component:"PortfolioTab"},{id:"backtesting",label:"Backtesting",value:"backtesting",shortcut:"F5",component:"BacktestingTab"},{id:"watchlist",label:"Watchlist",value:"watchlist",shortcut:"F6",component:"WatchlistTab"},{id:"research",label:"Research",value:"research",shortcut:"F7",component:"EquityResearchTab"},{id:"screener",label:"Screener",value:"screener",shortcut:"F8",component:"ScreenerTab"},{id:"trading",label:"Trading",value:"trading",shortcut:"F9",component:"TradingTab"},{id:"chat",label:"AI Chat",value:"chat",shortcut:"F10",component:"ChatTab"},{id:"settings",label:"Settings",value:"settings",component:"SettingsTab"},{id:"profile",label:"Profile",value:"profile",shortcut:"F12",component:"ProfileTab"},{id:"polygon",label:"Polygon Data",value:"polygon",component:"PolygonEqTab"},{id:"economics",label:"Economics",value:"economics",component:"EconomicsTab"},{id:"dbnomics",label:"DBnomics",value:"dbnomics",component:"DBnomicsTab"},{id:"geopolitics",label:"Geopolitics",value:"geopolitics",component:"GeopoliticsTab"},{id:"maritime",label:"Maritime",value:"maritime",component:"MaritimeTab"},{id:"fyers",label:"Fyers",value:"fyers",component:"FyersTab"},{id:"mcp",label:"MCP Servers",value:"mcp",component:"MCPTab"},{id:"nodes",label:"Node Editor",value:"nodes",component:"NodeEditorTab"},{id:"code",label:"Code Editor",value:"code",component:"CodeEditorTab"},{id:"datasources",label:"Data Sources",value:"datasources",component:"DataSourcesTab"},{id:"datamapping",label:"Data Mapping",value:"datamapping",component:"DataMappingTab"},{id:"reportbuilder",label:"Report Builder",value:"reportbuilder",component:"ReportBuilderTab"},{id:"contexts",label:"Contexts",value:"contexts",component:"RecordedContextsManager"},{id:"forum",label:"Forum",value:"forum",component:"ForumTab"},{id:"marketplace",label:"Marketplace",value:"marketplace",component:"MarketplaceTab"},{id:"docs",label:"Documentation",value:"docs",component:"DocsTab"},{id:"support",label:"Support",value:"support",component:"SupportTicketTab"}],JY={headerTabs:["dashboard","markets","news","portfolio","backtesting","watchlist","research","screener","trading","chat","settings","profile"],menuSections:[{id:"markets-menu",label:"Markets",tabs:["polygon","economics","dbnomics"]},{id:"research-menu",label:"Research",tabs:["geopolitics","maritime"]},{id:"trading-menu",label:"Trading",tabs:["fyers"]},{id:"tools-menu",label:"Tools",tabs:["mcp","nodes","code","datasources","datamapping","reportbuilder","contexts"]},{id:"community-menu",label:"Community",tabs:["forum","marketplace","docs"]},{id:"help-menu",label:"Help",tabs:["support"]}]},v0="terminal-tab-configuration";class QY{getConfiguration(){try{const e=localStorage.getItem(v0);if(e)return JSON.parse(e)}catch(e){console.error("Failed to load tab configuration:",e)}return JY}saveConfiguration(e){try{localStorage.setItem(v0,JSON.stringify(e))}catch(r){console.error("Failed to save tab configuration:",r)}}resetToDefault(){localStorage.removeItem(v0)}getAllTabs(){return kb}getTabById(e){return kb.find(r=>r.id===e)}}const rl=new QY,yk=({id:s,label:e})=>{const{attributes:r,listeners:n,setNodeRef:i,transform:o,transition:a}=oN({id:s}),l={transform:Ld.Transform.toString(o),transition:a};return t.jsxs("div",{ref:i,style:l,...r,...n,className:"flex items-center gap-2 bg-zinc-800 border border-zinc-700 rounded px-3 py-2 cursor-move hover:bg-zinc-700",children:[t.jsx(W4,{size:16,className:"text-zinc-500"}),t.jsx("span",{className:"text-sm text-white",children:e})]})},ZY=()=>{const[s,e]=S.useState(rl.getConfiguration()),[r,n]=S.useState(""),[i,o]=S.useState(!1),a=F2(Ng(gx),Ng(fx,{coordinateGetter:aN})),l=b=>{const{active:w,over:y}=b;y&&w.id!==y.id&&e(C=>{const T=C.headerTabs.indexOf(w.id),E=C.headerTabs.indexOf(y.id),j=Fp(C.headerTabs,T,E),k={...C,headerTabs:j};return rl.saveConfiguration(k),k})},d=b=>w=>{const{active:y,over:C}=w;C&&y.id!==C.id&&e(T=>{const E=T.menuSections.find(M=>M.id===b);if(!E)return T;const j=E.tabs.indexOf(y.id),k=E.tabs.indexOf(C.id),A=Fp(E.tabs,j,k),R={...T,menuSections:T.menuSections.map(M=>M.id===b?{...M,tabs:A}:M)};return rl.saveConfiguration(R),R})},p=(b,w)=>{e(y=>{const C={...y,headerTabs:[...y.headerTabs,b],menuSections:y.menuSections.map(T=>T.id===w?{...T,tabs:T.tabs.filter(E=>E!==b)}:T)};return rl.saveConfiguration(C),C})},f=()=>{r.trim()&&(e(b=>{const w={...b,menuSections:[...b.menuSections,{id:`custom-${Date.now()}`,label:r,tabs:[]}]};return rl.saveConfiguration(w),w}),n(""),o(!1))},h=b=>{e(w=>{const y=w.menuSections.find(T=>T.id===b);if(!y)return w;const C={...w,headerTabs:[...w.headerTabs,...y.tabs],menuSections:w.menuSections.filter(T=>T.id!==b)};return rl.saveConfiguration(C),C})},x=()=>{confirm("Reset tab configuration to default? This cannot be undone.")&&(rl.resetToDefault(),e(rl.getConfiguration()))},m=b=>kb.find(w=>w.id===b)?.label||b;return t.jsxs("div",{className:"p-6 space-y-6 max-w-6xl",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Terminal Tab Configuration"}),t.jsxs("button",{onClick:x,className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded text-sm",children:[t.jsx(GT,{size:16}),"Reset to Default"]})]}),t.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Header Tabs (Main Tab Bar)"}),t.jsx("p",{className:"text-sm text-zinc-400 mb-4",children:"Drag to reorder. These tabs appear in the main header."}),t.jsx(Eb,{sensors:a,collisionDetection:bb,onDragEnd:l,children:t.jsx(jb,{items:s.headerTabs,strategy:Cb,children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:s.headerTabs.map(b=>t.jsx(yk,{id:b,label:m(b)},b))})})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Toolbar Menu Sections"}),t.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm",children:[t.jsx(wn,{size:16}),"New Section"]})]}),i&&t.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-lg p-4 flex gap-2",children:[t.jsx("input",{type:"text",value:r,onChange:b=>n(b.target.value),placeholder:"Section name...",className:"flex-1 bg-zinc-800 border border-zinc-700 rounded px-3 py-2 text-white text-sm",onKeyPress:b=>b.key==="Enter"&&f()}),t.jsx("button",{onClick:f,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm",children:"Add"}),t.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-zinc-700 hover:bg-zinc-600 text-white rounded text-sm",children:"Cancel"})]}),s.menuSections.map(b=>t.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h4",{className:"font-semibold text-white",children:b.label}),t.jsxs("button",{onClick:()=>h(b.id),className:"flex items-center gap-1 px-2 py-1 text-red-400 hover:text-red-300 text-sm",children:[t.jsx(On,{size:14}),"Delete"]})]}),t.jsx(Eb,{sensors:a,collisionDetection:bb,onDragEnd:d(b.id),children:t.jsx(jb,{items:b.tabs,strategy:Cb,children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:b.tabs.map(w=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(yk,{id:w,label:m(w)}),t.jsx("button",{onClick:()=>p(w,b.id),className:"p-2 bg-zinc-700 hover:bg-zinc-600 rounded",title:"Move to header",children:t.jsx(lg,{size:16,className:"text-white"})})]},w))})})}),b.tabs.length===0&&t.jsx("p",{className:"text-sm text-zinc-500 italic",children:"No tabs in this section"})]},b.id))]}),t.jsx("div",{className:"bg-blue-900/20 border border-blue-500/50 rounded-lg p-4",children:t.jsxs("p",{className:"text-sm text-blue-300",children:[t.jsx("strong",{children:"Tip:"})," Drag tabs to reorder them. Use arrow buttons to move tabs between header and menu sections. Changes are saved automatically."]})})]})};function eK(){const{theme:s,updateTheme:e,resetTheme:r,colors:n,fontSize:i,fontFamily:o,fontWeight:a,fontStyle:l}=Er(),{defaultTimezone:d,setDefaultTimezone:p,options:f}=Xg(),[h,x]=S.useState("credentials"),[m,b]=S.useState({}),[w,y]=S.useState(!1),[C,T]=S.useState(null),[E,j]=S.useState(!1),{statuses:k,manager:A}=Iq(),[R,M]=S.useState([]),[P,I]=S.useState(null),[O,G]=S.useState({provider_name:"",enabled:!0,api_key:"",api_secret:"",endpoint:"",config_data:""}),[B,F]=S.useState(null),[z,$]=S.useState(new Set),[W,D]=S.useState(s.font.family),[oe,Z]=S.useState(s.font.baseSize),[fe,Q]=S.useState(s.font.weight),[_,Y]=S.useState(s.font.italic),[he,me]=S.useState(zi.getCurrentThemeKey()),ge={F1:"dashboard",F2:"markets",F3:"news",F4:"portfolio",F5:"analytics",F6:"watchlist",F7:"equity-research",F8:"screener",F9:"trading",F10:"chat",F11:"fullscreen",F12:"profile"},[le,X]=S.useState(ge),[V,de]=S.useState([]),[je,_e]=S.useState({temperature:.7,max_tokens:2048,system_prompt:""}),[Re,Be]=S.useState("ollama"),[Se,ie]=S.useState([]),[ve,Ae]=S.useState(!1),[$e,qe]=S.useState(null),[Ie,K]=S.useState(!1),[Ee,Oe]=S.useState({});S.useEffect(()=>{q()},[]),S.useEffect(()=>{const ue=new Set([...Array.from(k.keys()),...A.getSubscriptions().map(re=>re.topic.split(".")[0])]);ue.forEach(re=>{R.find(ke=>ke.provider_name===re)&&ue.delete(re)}),ue.size>0&&$(re=>new Set([...re,...ue]))},[k,R]);const q=async()=>{try{y(!0),Je.isReady()||(console.log("[SettingsTab] Database not initialized, initializing now..."),await Je.initialize());const re=await Je.healthCheck();if(!re.healthy)throw new Error(re.message);j(!0),await ce(),await be(),await ee(),console.log("[SettingsTab] Data loaded successfully")}catch(ue){console.error("[SettingsTab] Failed to load data:",ue);const re=ue instanceof Error?ue.message:"Unknown error";Te("error",`Failed to load settings: ${re}`),j(!1)}finally{y(!1)}},ee=async()=>{try{const ue=await Je.getWSProviderConfigs();M(ue);const re=wo();for(const ke of ue)ke.enabled&&(re.setProviderConfig(ke.provider_name,{provider_name:ke.provider_name,enabled:ke.enabled,api_key:ke.api_key||void 0,api_secret:ke.api_secret||void 0,endpoint:ke.endpoint||void 0}),console.log(`[Settings] Auto-initialized provider: ${ke.provider_name}`))}catch(ue){console.error("Failed to load WS providers:",ue)}},ce=async()=>{try{const ue=await Je.getAllApiKeys();b(ue)}catch(ue){console.error("Failed to load API keys:",ue)}},Ce=async(ue,re)=>{y(!0);try{await Je.setApiKey(ue,re),b({...m,[ue]:re}),T({type:"success",text:`${ue} saved`})}catch{T({type:"error",text:"Failed to save"})}finally{y(!1),setTimeout(()=>T(null),3e3)}},be=async()=>{try{const ue=await Je.getLLMConfigs();de(ue);const re=await Je.getLLMGlobalSettings();_e(re);const ke=ue.find(Ne=>Ne.is_active);ke&&Be(ke.provider)}catch(ue){console.error("Failed to load LLM configs:",ue)}},We=async()=>{try{y(!0);for(const ue of V)await Je.saveLLMConfig(ue);await Je.setActiveLLMProvider(Re),await Je.saveLLMGlobalSettings(je),Te("success","LLM configuration saved successfully"),await be()}catch{Te("error","Failed to save LLM configuration")}finally{y(!1)}},J=(ue,re,ke)=>{de(Ne=>Ne.map(U=>U.provider===ue?{...U,[re]:ke}:U))},se=async()=>{Ae(!0),qe(null);const re=Me()?.base_url||"http://localhost:11434",ke=await i7.listModels(re);ke.success&&ke.models?(ie(ke.models),qe(null)):(ie([]),qe(ke.error||"Failed to fetch models")),Ae(!1)};S.useEffect(()=>{Re==="ollama"&&h==="llm"&&se()},[Re,h]);const Te=(ue,re)=>{T({type:ue,text:re}),setTimeout(()=>T(null),5e3)},Me=()=>V.find(ue=>ue.provider===Re),Qe=()=>{const ue={font:{family:W,baseSize:oe,weight:fe,italic:_},colors:ul[he]};e(ue),localStorage.setItem("fincept_key_mappings",JSON.stringify(le)),Te("success","Terminal appearance and key mappings saved successfully")},ye=()=>{r();const ue=zi.getTheme();D(ue.font.family),Z(ue.font.baseSize),Q(ue.font.weight),Y(ue.font.italic),me("bloomberg-classic"),X(ge),localStorage.removeItem("fincept_key_mappings"),Te("success","Reset to default appearance and key mappings")};return S.useEffect(()=>{const ue=localStorage.getItem("fincept_key_mappings");if(ue)try{X(JSON.parse(ue))}catch(re){console.error("Failed to load key mappings:",re)}},[]),t.jsxs("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:n.background},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar { width: 8px; height: 8px; }
        *::-webkit-scrollbar-track { background: ${n.panel}; }
        *::-webkit-scrollbar-thumb { background: #2a2a2a; border-radius: 4px; }
        *::-webkit-scrollbar-thumb:hover { background: #3a3a3a; }

        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        @keyframes slideIn {
          from { transform: translateX(-10px); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
      `}),t.jsxs("div",{style:{borderBottom:`2px solid ${n.primary}`,padding:"12px 16px",background:`linear-gradient(180deg, #1a1a1a 0%, ${n.panel} 100%)`,display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(Mn,{size:20,color:n.primary}),t.jsx("span",{style:{color:n.primary,fontSize:"16px",fontWeight:"bold",letterSpacing:"1px"},children:"TERMINAL SETTINGS"})]}),t.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:t.jsx("div",{style:{padding:"4px 8px",background:E?"#0a3a0a":"#3a0a0a",border:`1px solid ${E?"#00ff00":"#ff0000"}`,borderRadius:"3px"},children:t.jsxs("span",{style:{color:E?"#00ff00":"#ff0000",fontSize:"9px",fontWeight:"bold"},children:[t.jsx(js,{size:10,style:{display:"inline",marginRight:"4px"}}),"SQLite: ",E?"CONNECTED":"DISCONNECTED"]})})})]}),C&&t.jsx("div",{style:{padding:"8px 16px",background:C.type==="success"?"#0a3a0a":"#3a0a0a",borderBottom:`1px solid ${C.type==="success"?"#00ff00":"#ff0000"}`,color:C.type==="success"?"#00ff00":"#ff0000",fontSize:"10px",flexShrink:0},children:C.text}),t.jsxs("div",{style:{flex:1,display:"flex",minHeight:0,overflow:"hidden"},children:[t.jsx("div",{style:{width:"220px",borderRight:"1px solid #1a1a1a",background:n.panel,flexShrink:0},children:t.jsx("div",{style:{padding:"16px 0"},children:[{id:"credentials",icon:Np,label:"Credentials"},{id:"llm",icon:xi,label:"LLM Configuration"},{id:"dataConnections",icon:js,label:"Data Sources"},{id:"backtesting",icon:Cs,label:"Backtesting Providers"},{id:"terminalConfig",icon:Mn,label:"Tab Layout"},{id:"terminal",icon:dc,label:"Appearance"},{id:"language",icon:fc,label:"Language"}].map(ue=>t.jsxs("div",{onClick:()=>x(ue.id),style:{padding:"12px 16px",cursor:"pointer",background:h===ue.id?"#1a1a1a":"transparent",borderLeft:h===ue.id?`3px solid ${n.primary}`:"3px solid transparent",display:"flex",alignItems:"center",gap:"12px",transition:"all 0.2s"},onMouseEnter:re=>{h!==ue.id&&(re.currentTarget.style.background="#151515")},onMouseLeave:re=>{h!==ue.id&&(re.currentTarget.style.background="transparent")},children:[t.jsx(ue.icon,{size:16,color:h===ue.id?n.primary:n.text}),t.jsx("span",{style:{color:n.text,fontSize:"11px",fontWeight:h===ue.id?"bold":"normal"},children:ue.label})]},ue.id))})}),t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0,overflow:"hidden"},children:t.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px",minHeight:0},children:[h==="credentials"&&t.jsxs("div",{children:[t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx("h2",{style:{color:n.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"API KEY MANAGEMENT"}),t.jsx("p",{style:{color:n.text,fontSize:"10px"},children:"Configure API keys for data providers. All keys are stored locally and encrypted."})]}),t.jsx("div",{style:{display:"grid",gap:"16px"},children:TA.map(({key:ue,label:re,description:ke})=>t.jsxs("div",{style:{background:n.panel,border:"1px solid #1a1a1a",padding:"16px",borderRadius:"4px"},children:[t.jsx("h3",{style:{color:n.primary,fontSize:"12px",fontWeight:"bold",marginBottom:"4px"},children:re}),t.jsx("p",{style:{color:n.text,fontSize:"9px",marginBottom:"12px",opacity:.7},children:ke}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",alignItems:"end"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:n.text,fontSize:"9px",display:"block",marginBottom:"4px"},children:"API KEY"}),t.jsx("input",{type:"password",value:m[ue]||"",onChange:Ne=>b({...m,[ue]:Ne.target.value}),placeholder:"Enter API key",style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px",fontFamily:"monospace"}})]}),t.jsxs("button",{onClick:()=>Ce(ue,m[ue]||""),disabled:w||!m[ue],style:{background:m[ue]?n.primary:"#333",color:n.text,border:"none",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:w||!m[ue]?"not-allowed":"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",opacity:w||!m[ue]?.5:1,whiteSpace:"nowrap"},children:[t.jsx(ao,{size:14}),"SAVE"]})]})]},ue))})]}),h==="llm"&&t.jsxs("div",{children:[t.jsxs("div",{style:{marginBottom:"24px"},children:[t.jsx("h2",{style:{color:n.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:"LLM CONFIGURATION"}),t.jsx("p",{style:{color:n.text,fontSize:"10px"},children:"Configure AI providers for the Chat tab. Changes here are reflected in both Chat and Settings screens."})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("h3",{style:{color:n.text,fontSize:"12px",fontWeight:"bold",marginBottom:"8px"},children:"Select Active Provider"}),t.jsx("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:V.map(ue=>t.jsx("button",{onClick:()=>Be(ue.provider),style:{background:Re===ue.provider?n.primary:n.panel,color:Re===ue.provider?n.background:n.text,border:`1px solid ${Re===ue.provider?n.primary:"#2a2a2a"}`,padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",borderRadius:"3px",textTransform:"uppercase"},children:ue.provider},ue.provider))})]}),Me()&&t.jsxs("div",{style:{background:n.panel,border:"1px solid #1a1a1a",padding:"16px",marginBottom:"20px",borderRadius:"4px"},children:[t.jsxs("h3",{style:{color:n.text,fontSize:"12px",fontWeight:"bold",marginBottom:"12px"},children:[Me().provider.toUpperCase()," Configuration"]}),t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[Me().provider!=="ollama"&&t.jsxs("div",{children:[t.jsx("label",{style:{color:n.text,fontSize:"9px",display:"block",marginBottom:"4px"},children:"API KEY *"}),t.jsx("input",{type:"password",value:Me().api_key||"",onChange:ue=>J(Re,"api_key",ue.target.value),placeholder:`Enter ${Re} API key`,style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px"}})]}),(Me().provider==="ollama"||Me().provider==="deepseek"||Me().provider==="openrouter")&&t.jsxs("div",{children:[t.jsx("label",{style:{color:n.text,fontSize:"9px",display:"block",marginBottom:"4px"},children:"BASE URL"}),t.jsx("input",{type:"text",value:Me().base_url||"",onChange:ue=>J(Re,"base_url",ue.target.value),placeholder:Me().provider==="ollama"?"http://localhost:11434":"Base URL",style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px"}})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsx("label",{style:{color:n.text,fontSize:"9px"},children:"MODEL"}),Me().provider==="ollama"&&t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.jsxs("button",{onClick:se,disabled:ve,style:{background:"transparent",border:"1px solid #2a2a2a",color:n.primary,padding:"4px 8px",fontSize:"9px",cursor:ve?"not-allowed":"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px",opacity:ve?.5:1},children:[t.jsx(xn,{size:10}),ve?"LOADING...":"REFRESH"]}),t.jsxs("button",{onClick:()=>K(!Ie),style:{background:"transparent",border:"1px solid #2a2a2a",color:n.text,padding:"4px 8px",fontSize:"9px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Od,{size:10}),Ie?"DROPDOWN":"MANUAL"]})]})]}),Me().provider==="ollama"&&!Ie?t.jsxs(t.Fragment,{children:[t.jsxs("select",{value:Me().model,onChange:ue=>J(Re,"model",ue.target.value),disabled:ve||Se.length===0,style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px",cursor:ve||Se.length===0?"not-allowed":"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23ea580c' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",paddingRight:"32px"},children:[Se.length===0&&!ve&&t.jsx("option",{value:"",children:"No models found"}),ve&&t.jsx("option",{value:"",children:"Loading models..."}),Se.map(ue=>t.jsx("option",{value:ue,children:ue},ue))]}),$e&&t.jsx("div",{style:{marginTop:"4px",padding:"6px 8px",background:"#3a0a0a",border:"1px solid #ff0000",borderRadius:"3px",fontSize:"9px",color:"#ff0000"},children:$e}),Se.length>0&&t.jsxs("div",{style:{marginTop:"4px",fontSize:"9px",color:"#00ff00"},children:[" Found ",Se.length," model",Se.length!==1?"s":""]})]}):t.jsx("input",{type:"text",value:Me().model,onChange:ue=>J(Re,"model",ue.target.value),placeholder:"Model name",style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px"}})]})]})]}),t.jsxs("div",{style:{background:n.panel,border:"1px solid #1a1a1a",padding:"16px",marginBottom:"20px",borderRadius:"4px"},children:[t.jsx("h3",{style:{color:n.text,fontSize:"12px",fontWeight:"bold",marginBottom:"12px"},children:"Global AI Settings"}),t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:n.text,fontSize:"9px",display:"block",marginBottom:"4px"},children:"TEMPERATURE (0.0 - 2.0)"}),t.jsx("input",{type:"number",min:"0",max:"2",step:"0.1",value:je.temperature,onChange:ue=>_e({...je,temperature:parseFloat(ue.target.value)}),style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:n.text,fontSize:"9px",display:"block",marginBottom:"4px"},children:"MAX TOKENS"}),t.jsx("input",{type:"number",min:"1",max:"32000",value:je.max_tokens,onChange:ue=>_e({...je,max_tokens:parseInt(ue.target.value)}),style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:n.text,fontSize:"9px",display:"block",marginBottom:"4px"},children:"SYSTEM PROMPT"}),t.jsx("textarea",{value:je.system_prompt,onChange:ue=>_e({...je,system_prompt:ue.target.value}),rows:4,style:{width:"100%",background:n.background,border:"1px solid #2a2a2a",color:n.text,padding:"8px",fontSize:"10px",borderRadius:"3px",resize:"vertical"}})]})]})]}),t.jsxs("button",{onClick:We,disabled:w,style:{background:n.primary,color:n.text,border:"none",padding:"10px 20px",fontSize:"11px",fontWeight:"bold",cursor:w?"not-allowed":"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",opacity:w?.5:1},children:[t.jsx(ao,{size:16}),w?"SAVING...":"SAVE LLM CONFIGURATION"]})]}),h==="terminalConfig"&&t.jsx(ZY,{}),h==="terminal"&&t.jsxs("div",{style:{fontFamily:'"IBM Plex Mono", "Consolas", monospace'},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"24px",paddingBottom:"12px",borderBottom:`2px solid ${n.primary}`},children:[t.jsx(dc,{size:20,color:n.primary,style:{filter:`drop-shadow(0 0 4px ${n.primary})`}}),t.jsx("h2",{style:{color:n.primary,fontSize:"16px",fontWeight:700,letterSpacing:"1px",margin:0,textShadow:`0 0 10px ${n.primary}40`},children:"TERMINAL CONFIGURATION"})]}),t.jsx("div",{style:{marginBottom:"20px",padding:"12px",backgroundColor:"#1A1A1A",border:"1px solid #2A2A2A",borderLeft:`3px solid ${n.secondary}`},children:t.jsx("p",{style:{color:n.textMuted,fontSize:"10px",margin:0,lineHeight:"1.6"},children:"Customize terminal appearance including fonts, colors, and themes. Changes apply across the entire application."})}),t.jsxs("div",{style:{background:"#0F0F0F",border:"1px solid #2A2A2A",borderLeft:`3px solid ${n.primary}`,borderRadius:"4px",padding:"16px",marginBottom:"20px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[t.jsx(Sd,{size:18,color:n.primary,style:{filter:`drop-shadow(0 0 2px ${n.primary})`}}),t.jsx("span",{style:{color:n.primary,fontSize:"14px",fontWeight:"bold",letterSpacing:"0.5px"},children:"FONT SETTINGS"})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:n.text,fontSize:"10px",display:"block",marginBottom:"6px",fontWeight:600,letterSpacing:"0.5px"},children:"FONT FAMILY"}),t.jsx("select",{value:W,onChange:ue=>D(ue.target.value),style:{width:"100%",padding:"10px",background:n.background,border:"1px solid #2A2A2A",color:n.text,borderRadius:"3px",fontSize:"11px",fontWeight:500,cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23FFA500' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 10px center",paddingRight:"32px"},children:wP.map(ue=>t.jsx("option",{value:ue.value,children:ue.label},ue.value))})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("label",{style:{color:n.text,fontSize:"10px",fontWeight:600,letterSpacing:"0.5px"},children:"BASE FONT SIZE"}),t.jsxs("span",{style:{color:n.primary,fontSize:"12px",fontWeight:"bold",padding:"2px 8px",background:`${n.primary}20`,borderRadius:"3px",border:`1px solid ${n.primary}40`},children:[oe,"px"]})]}),t.jsx("input",{type:"range",min:"9",max:"18",value:oe,onChange:ue=>Z(Number(ue.target.value)),style:{width:"100%",height:"6px",background:`linear-gradient(to right, ${n.primary}40 0%, ${n.primary}40 ${(oe-9)/9*100}%, #2A2A2A ${(oe-9)/9*100}%, #2A2A2A 100%)`,borderRadius:"3px",outline:"none",cursor:"pointer"}}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"6px"},children:[t.jsx("span",{style:{color:n.textMuted,fontSize:"9px",fontWeight:500},children:"Small (9px)"}),t.jsx("span",{style:{color:n.textMuted,fontSize:"9px",fontWeight:500},children:"Large (18px)"})]})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:n.text,fontSize:"10px",display:"block",marginBottom:"6px",fontWeight:600,letterSpacing:"0.5px"},children:"FONT WEIGHT"}),t.jsxs("select",{value:fe,onChange:ue=>Q(ue.target.value),style:{width:"100%",padding:"10px",background:n.background,border:"1px solid #2A2A2A",color:n.text,borderRadius:"3px",fontSize:"11px",fontWeight:500,cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23FFA500' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 10px center",paddingRight:"32px"},children:[t.jsx("option",{value:"normal",children:"Normal (400)"}),t.jsx("option",{value:"semibold",children:"Semi-Bold (600)"}),t.jsx("option",{value:"bold",children:"Bold (700)"})]})]}),t.jsx("div",{children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",cursor:"pointer",padding:"10px",background:_?`${n.primary}10`:"transparent",border:`1px solid ${_?n.primary:"#2A2A2A"}`,borderRadius:"3px",transition:"all 0.2s"},children:[t.jsx("input",{type:"checkbox",checked:_,onChange:ue=>Y(ue.target.checked),style:{width:"16px",height:"16px",cursor:"pointer"}}),t.jsx("span",{style:{color:n.text,fontSize:"10px",fontWeight:600,letterSpacing:"0.5px"},children:"ENABLE ITALIC STYLE"})]})})]}),t.jsxs("div",{style:{background:"#0F0F0F",border:"1px solid #2A2A2A",borderLeft:`3px solid ${n.primary}`,borderRadius:"4px",padding:"16px",marginBottom:"20px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[t.jsx(CB,{size:18,color:n.primary,style:{filter:`drop-shadow(0 0 2px ${n.primary})`}}),t.jsx("span",{style:{color:n.primary,fontSize:"14px",fontWeight:"bold",letterSpacing:"0.5px"},children:"COLOR THEME"})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"12px"},children:Object.entries(ul).map(([ue,re])=>{const ke=he===ue;return t.jsxs("button",{onClick:()=>me(ue),style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:ke?"#1A1A1A":"transparent",border:`1px solid ${ke?n.primary:"#2A2A2A"}`,borderLeft:`3px solid ${ke?n.primary:"#2A2A2A"}`,borderRadius:"3px",cursor:"pointer",transition:"all 0.2s",position:"relative",overflow:"hidden"},onMouseEnter:Ne=>{ke||(Ne.currentTarget.style.background="#151515",Ne.currentTarget.style.borderColor="#3A3A3A")},onMouseLeave:Ne=>{ke||(Ne.currentTarget.style.background="transparent",Ne.currentTarget.style.borderColor="#2A2A2A")},children:[t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsx("div",{style:{width:"24px",height:"24px",background:re.primary,border:"1px solid #2A2A2A",borderRadius:"3px",boxShadow:ke?`0 0 8px ${re.primary}60`:"none"},title:"Primary"}),t.jsx("div",{style:{width:"24px",height:"24px",background:re.secondary,border:"1px solid #2A2A2A",borderRadius:"3px",boxShadow:ke?`0 0 8px ${re.secondary}60`:"none"},title:"Secondary"}),t.jsx("div",{style:{width:"24px",height:"24px",background:re.alert,border:"1px solid #2A2A2A",borderRadius:"3px",boxShadow:ke?`0 0 8px ${re.alert}60`:"none"},title:"Alert"})]}),t.jsx("span",{style:{color:ke?n.primary:n.text,fontSize:"11px",flex:1,fontWeight:ke?700:500,letterSpacing:"0.5px"},children:re.name}),ke&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Es,{size:14,color:n.success}),t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:n.success,boxShadow:`0 0 6px ${n.success}`}})]}),ke&&t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"1px",background:`linear-gradient(90deg, transparent, ${n.primary}, transparent)`,opacity:.5}})]},ue)})})]}),t.jsxs("div",{style:{background:"#0F0F0F",border:"1px solid #2A2A2A",borderLeft:`3px solid ${n.primary}`,borderRadius:"4px",padding:"16px",marginBottom:"20px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[t.jsx(uo,{size:18,color:n.primary,style:{filter:`drop-shadow(0 0 2px ${n.primary})`}}),t.jsx("span",{style:{color:n.text,fontWeight:"bold",fontSize:"12px"},children:"DEFAULT TIMEZONE"})]}),t.jsx("p",{style:{color:n.textMuted,fontSize:"10px",marginBottom:"12px"},children:"Set the default timezone displayed in the navigation bar. Dashboard widgets can use their own timezone settings."}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"8px",maxHeight:"280px",overflowY:"auto",paddingRight:"4px"},children:f.map(ue=>t.jsxs("button",{onClick:()=>p(ue.id),style:{background:d.id===ue.id?`${n.primary}20`:"#1A1A1A",border:`1px solid ${d.id===ue.id?n.primary:"#2A2A2A"}`,borderRadius:"4px",padding:"12px 8px",cursor:"pointer",textAlign:"center",transition:"all 0.2s"},onMouseEnter:re=>{d.id!==ue.id&&(re.currentTarget.style.borderColor=n.primary,re.currentTarget.style.background="#2A2A2A")},onMouseLeave:re=>{d.id!==ue.id&&(re.currentTarget.style.borderColor="#2A2A2A",re.currentTarget.style.background="#1A1A1A")},children:[t.jsx("div",{style:{color:d.id===ue.id?n.primary:n.text,fontWeight:"bold",fontSize:"11px",marginBottom:"4px"},children:ue.shortLabel}),t.jsx("div",{style:{color:n.textMuted,fontSize:"9px"},children:ue.label.split("(")[0].trim()})]},ue.id))})]}),t.jsxs("div",{style:{background:"#0F0F0F",border:"1px solid #2A2A2A",borderLeft:`3px solid ${n.primary}`,borderRadius:"4px",padding:"16px",marginBottom:"20px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"16px"},children:[t.jsx(dc,{size:18,color:n.primary,style:{filter:`drop-shadow(0 0 2px ${n.primary})`}}),t.jsx("span",{style:{color:n.primary,fontSize:"14px",fontWeight:"bold",letterSpacing:"0.5px"},children:"FUNCTION KEY MAPPINGS"})]}),t.jsx("div",{style:{marginBottom:"12px",padding:"10px",backgroundColor:"#1A1A1A",border:"1px solid #2A2A2A",borderRadius:"3px"},children:t.jsx("p",{style:{color:n.textMuted,fontSize:"9px",margin:0,lineHeight:"1.5"},children:"Configure which tab or action each function key (F1-F12) should trigger. Changes will be reflected in the status bar and keyboard shortcuts."})}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"12px"},children:Object.entries(le).map(([ue,re])=>t.jsxs("div",{style:{background:"#1A1A1A",border:"1px solid #2A2A2A",borderRadius:"3px",padding:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"8px"},children:[t.jsx("span",{style:{backgroundColor:n.primary,color:"#000",padding:"4px 8px",fontSize:"9px",fontWeight:"bold",borderRadius:"2px",minWidth:"40px",textAlign:"center"},children:ue}),t.jsx("span",{style:{color:n.textMuted,fontSize:"10px"},children:""})]}),t.jsxs("select",{value:re,onChange:ke=>X({...le,[ue]:ke.target.value}),style:{width:"100%",padding:"8px",background:n.background,border:"1px solid #2A2A2A",color:n.text,borderRadius:"3px",fontSize:"10px",fontWeight:500,cursor:"pointer",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23FFA500' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 8px center",paddingRight:"28px"},children:[t.jsx("option",{value:"dashboard",children:"Dashboard"}),t.jsx("option",{value:"markets",children:"Markets"}),t.jsx("option",{value:"news",children:"News"}),t.jsx("option",{value:"portfolio",children:"Portfolio"}),t.jsx("option",{value:"analytics",children:"Analytics"}),t.jsx("option",{value:"watchlist",children:"Watchlist"}),t.jsx("option",{value:"equity-research",children:"Equity Research"}),t.jsx("option",{value:"screener",children:"Screener"}),t.jsx("option",{value:"trading",children:"Trading"}),t.jsx("option",{value:"chat",children:"AI Chat"}),t.jsx("option",{value:"fullscreen",children:"Toggle Fullscreen"}),t.jsx("option",{value:"profile",children:"Profile"}),t.jsx("option",{value:"settings",children:"Settings"}),t.jsx("option",{value:"forum",children:"Forum"}),t.jsx("option",{value:"marketplace",children:"Marketplace"})]})]},ue))})]}),t.jsxs("div",{style:{background:s.colors.background,border:`2px solid ${s.colors.primary}`,borderRadius:"4px",padding:"20px",marginBottom:"20px",position:"relative",overflow:"hidden"},children:[t.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"2px",background:`linear-gradient(90deg, transparent, ${s.colors.primary}, transparent)`,opacity:.5}}),t.jsx("div",{style:{color:s.colors.textMuted,fontSize:"9px",fontWeight:600,letterSpacing:"1px",marginBottom:"12px",opacity:.7},children:"LIVE PREVIEW"}),t.jsx("div",{style:{color:s.colors.primary,fontSize:`${oe+2}px`,fontFamily:`${W}, monospace`,fontWeight:fe==="normal"?"400":fe==="semibold"?"600":"700",fontStyle:_?"italic":"normal",marginBottom:"12px",letterSpacing:"0.5px"},children:"FINCEPT TERMINAL PREVIEW"}),t.jsx("div",{style:{color:s.colors.text,fontSize:`${oe}px`,fontFamily:`${W}, monospace`,fontWeight:fe==="normal"?"400":fe==="semibold"?"600":"700",fontStyle:_?"italic":"normal",marginBottom:"8px",lineHeight:"1.5"},children:"Body Text: Real-time market analysis and portfolio tracking"}),t.jsx("div",{style:{color:s.colors.textMuted,fontSize:`${oe-1}px`,fontFamily:`${W}, monospace`,fontWeight:fe==="normal"?"400":fe==="semibold"?"600":"700",fontStyle:_?"italic":"normal",marginBottom:"12px",lineHeight:"1.5"},children:"Small Text: Market data, timestamps, and metadata"}),t.jsxs("div",{style:{display:"flex",gap:"16px",marginTop:"12px",flexWrap:"wrap"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:s.colors.success,boxShadow:`0 0 8px ${s.colors.success}`}}),t.jsx("span",{style:{color:s.colors.success,fontSize:"10px",fontWeight:600},children:"CONNECTED"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:s.colors.alert,boxShadow:`0 0 8px ${s.colors.alert}`}}),t.jsx("span",{style:{color:s.colors.alert,fontSize:"10px",fontWeight:600},children:"ALERT"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:s.colors.warning,boxShadow:`0 0 8px ${s.colors.warning}`}}),t.jsx("span",{style:{color:s.colors.warning,fontSize:"10px",fontWeight:600},children:"WARNING"})]})]})]}),t.jsxs("div",{style:{display:"flex",gap:"12px"},children:[t.jsxs("button",{onClick:Qe,style:{flex:1,background:n.primary,color:"#000000",border:"none",padding:"14px",fontSize:"11px",fontWeight:"bold",letterSpacing:"0.5px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",transition:"all 0.2s",boxShadow:`0 0 12px ${n.primary}40`},onMouseEnter:ue=>{ue.currentTarget.style.boxShadow=`0 0 20px ${n.primary}60`,ue.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:ue=>{ue.currentTarget.style.boxShadow=`0 0 12px ${n.primary}40`,ue.currentTarget.style.transform="translateY(0)"},children:[t.jsx(ao,{size:16})," SAVE CONFIGURATION"]}),t.jsxs("button",{onClick:ye,style:{background:"transparent",color:n.textMuted,border:"1px solid #2A2A2A",padding:"14px 20px",fontSize:"11px",fontWeight:"bold",letterSpacing:"0.5px",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s"},onMouseEnter:ue=>{ue.currentTarget.style.borderColor=n.alert,ue.currentTarget.style.color=n.alert},onMouseLeave:ue=>{ue.currentTarget.style.borderColor="#2A2A2A",ue.currentTarget.style.color=n.textMuted},children:[t.jsx(xn,{size:16})," RESET"]})]})]}),h==="dataConnections"&&t.jsx(o7,{colors:n}),h==="backtesting"&&t.jsx(h7,{colors:{background:n.background,surface:n.panel,text:n.text,textSecondary:n.textMuted,border:n.textMuted,accent:n.accent,success:n.success,error:n.alert}}),h==="language"&&t.jsx("div",{style:{padding:"20px"},children:t.jsx(x7,{})})]})})]}),t.jsxs("div",{style:{borderTop:`2px solid ${n.primary}`,padding:"8px 16px",background:`linear-gradient(180deg, ${n.panel} 0%, #1a1a1a 100%)`,display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0,flexWrap:"wrap",gap:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"9px"},children:[t.jsx("span",{style:{color:n.primary,fontWeight:"bold"},children:"SETTINGS v2.0.0"}),t.jsx("span",{style:{color:n.text},children:"|"}),t.jsx("span",{style:{color:n.text},children:"Database: SQLite"}),t.jsx("span",{style:{color:n.text},children:"|"}),t.jsx("span",{style:{color:n.text},children:"Storage: File-based"})]}),t.jsx("div",{style:{fontSize:"9px",color:n.text},children:"All data stored securely in fincept_terminal.db"})]})]})}class tK{constructor(e){Pe(this,"serverId");Pe(this,"processId",null);Pe(this,"messageId",0);Pe(this,"pendingRequests",new Map);Pe(this,"isInitialized",!1);Pe(this,"capabilities",{});this.serverId=e}async connect(e){try{Qt.info(`Connecting to server: ${e.serverId}`);const r=await lt("spawn_mcp_server",{serverId:e.serverId,command:e.command,args:e.args,env:e.env||{}});if(!r.success||r.error)throw new Error(r.error||"Failed to spawn MCP server");this.processId=r.pid,Qt.info(`Server spawned with PID: ${this.processId}`),await this.initialize(),Qt.info("Server initialized successfully")}catch(r){throw Qt.error("Connection error:",r),r}}async initialize(){const e=await this.sendRequest("initialize",{protocolVersion:"2024-11-05",capabilities:{roots:{listChanged:!1},sampling:{}},clientInfo:{name:"fincept-terminal",version:"1.0.0"}});this.capabilities=e.capabilities||{},this.isInitialized=!0,await this.sendNotification("notifications/initialized")}async listTools(){if(!this.isInitialized)throw new Error("MCP client not initialized");try{return(await this.sendRequest("tools/list",{})).tools||[]}catch(e){return Qt.error("Error listing tools:",e),[]}}async callTool(e,r={}){if(!this.isInitialized)throw new Error("MCP client not initialized");try{return await this.sendRequest("tools/call",{name:e,arguments:r})}catch(n){return Qt.error(`Error calling tool ${e}:`,n),{content:[{type:"text",text:`Error: ${n instanceof Error?n.message:"Unknown error"}`}],isError:!0}}}async listResources(){if(!this.isInitialized)throw new Error("MCP client not initialized");try{return(await this.sendRequest("resources/list",{})).resources||[]}catch(e){return Qt.error("Error listing resources:",e),[]}}async readResource(e){if(!this.isInitialized)throw new Error("MCP client not initialized");try{return(await this.sendRequest("resources/read",{uri:e})).contents||[]}catch(r){throw Qt.error(`Error reading resource ${e}:`,r),r}}async ping(){if(!this.processId)return!1;try{return await lt("ping_mcp_server",{serverId:this.serverId})}catch(e){return Qt.error("Ping error:",e),!1}}async disconnect(){if(this.processId){try{await lt("kill_mcp_server",{serverId:this.serverId}),Qt.info(`Server ${this.serverId} disconnected`)}catch(e){Qt.error("Disconnect error:",e)}this.processId=null,this.isInitialized=!1,this.pendingRequests.clear()}}async sendRequest(e,r){const n=this.messageId++,i={jsonrpc:"2.0",id:n,method:e,params:r};return new Promise(async(o,a)=>{this.pendingRequests.set(n,{resolve:o,reject:a});try{const l=await lt("send_mcp_request",{serverId:this.serverId,request:JSON.stringify(i)}),d=JSON.parse(l);d.error?(a(new Error(d.error.message||"MCP request failed")),this.pendingRequests.delete(n)):(o(d.result),this.pendingRequests.delete(n))}catch(l){a(l),this.pendingRequests.delete(n)}})}async sendNotification(e,r){const n={jsonrpc:"2.0",method:e,params:r};try{await lt("send_mcp_notification",{serverId:this.serverId,notification:JSON.stringify(n)})}catch(i){Qt.error("Notification error:",i)}}getCapabilities(){return this.capabilities}isConnected(){return this.isInitialized&&this.processId!==null}}class rK{constructor(){Pe(this,"clients",new Map);Pe(this,"healthCheckInterval",null);Pe(this,"serverErrors",new Map);this.startHealthCheck()}async installServer(e){try{if(Qt.info(`Installing server: ${e.name}`),await Je.getMCPServer(e.id)){Qt.info(`Server ${e.id} already installed, updating config...`),await Je.updateMCPServerConfig(e.id,{env:e.env?JSON.stringify(e.env):null}),this.clients.has(e.id)&&await this.stopServer(e.id);try{await this.startServer(e.id)}catch(n){Qt.warn(`Failed to start existing server: ${n}`)}Qt.info(`Server ${e.name} updated successfully`);return}await Je.addMCPServer({id:e.id,name:e.name,description:e.description,command:e.command,args:JSON.stringify(e.args),env:e.env?JSON.stringify(e.env):null,category:e.category,icon:e.icon,enabled:!0,auto_start:!1,status:"stopped"});try{await this.startServer(e.id)}catch(n){Qt.warn(`Server installed but failed to start: ${n}`)}Qt.info(`Server ${e.name} installed successfully`)}catch(r){throw Qt.error("Installation error:",r),r}}async startServer(e){try{const r=await Je.getMCPServer(e);if(!r)throw new Error(`Server ${e} not found`);if(!r.enabled)throw new Error(`Server ${e} is disabled`);Qt.info(`Starting server: ${r.name}`),this.clients.has(e)||this.clients.set(e,new tK(e));const n=this.clients.get(e);if(n.isConnected()){Qt.info(`Server ${e} already running`);return}const i=JSON.parse(r.args),o=r.env?JSON.parse(r.env):void 0;await n.connect({serverId:e,command:r.command,args:i,env:o}),await Je.updateMCPServerStatus(e,"running");const a=await n.listTools();await Je.cacheMCPTools(e,a),this.serverErrors.delete(e),Qt.info(`Server ${r.name} started with ${a.length} tools`)}catch(r){Qt.error(`Error starting server ${e}:`,r);const n=r instanceof Error?r.message:"Unknown error",i=this.serverErrors.get(e)||{count:0};throw this.serverErrors.set(e,{count:i.count+1,lastError:n,lastErrorTime:Date.now()}),await Je.updateMCPServerStatus(e,"error"),r}}async stopServer(e){try{const r=this.clients.get(e);r&&(await r.disconnect(),this.clients.delete(e)),await Je.updateMCPServerStatus(e,"stopped"),Qt.info(`Server ${e} stopped`)}catch(r){throw Qt.error(`Error stopping server ${e}:`,r),r}}async removeServer(e){try{await this.stopServer(e),await Je.deleteMCPServer(e),Qt.info(`Server ${e} removed`)}catch(r){throw Qt.error(`Error removing server ${e}:`,r),r}}async getServersWithStats(){const e=await Je.getMCPServers();return await Promise.all(e.map(async n=>{const i=await Je.getMCPServerStats(n.id),o=this.clients.get(n.id),a=o&&o.isConnected()?"running":"stopped";return{...n,args:JSON.parse(n.args),env:n.env?JSON.parse(n.env):void 0,status:a,toolCount:i.toolCount,callsToday:i.callsToday,lastUsed:i.lastUsed||void 0}}))}async getAllTools(){const e=[];for(const[r,n]of this.clients.entries())if(n.isConnected())try{const i=await n.listTools(),o=await Je.getMCPServer(r),a=i.map(l=>({...l,serverId:r,serverName:o?.name||r}));e.push(...a)}catch(i){Qt.error(`Error getting tools from ${r}:`,i)}return e}async callTool(e,r,n={}){const i=this.clients.get(e);if(!i||!i.isConnected())throw new Error(`Server ${e} is not connected`);const o=Date.now();try{const a=await i.callTool(r,n),l=Date.now()-o;return await Je.logMCPToolUsage({serverId:e,toolName:r,args:JSON.stringify(n),result:JSON.stringify(a),success:!a.isError,executionTime:l}),a}catch(a){const l=Date.now()-o;throw await Je.logMCPToolUsage({serverId:e,toolName:r,args:JSON.stringify(n),result:null,success:!1,executionTime:l,error:a instanceof Error?a.message:"Unknown error"}),a}}async updateServerConfig(e,r){const n={...r,env:r.env?JSON.stringify(r.env):void 0};await Je.updateMCPServerConfig(e,n),r.env&&this.clients.has(e)&&(await this.stopServer(e),r.enabled!==!1&&await this.startServer(e))}async startAllEnabledServers(){const r=(await Je.getMCPServers()).filter(n=>n.enabled);Qt.info(`Starting ${r.length} enabled servers`);for(const n of r)try{await this.startServer(n.id)}catch(i){Qt.error(`Failed to start ${n.name}:`,i)}}async startAutoStartServers(){try{const e=await Je.getAutoStartServers();Qt.info(`Auto-starting ${e.length} servers`);for(const r of e)try{await this.startServer(r.id),Qt.info(`Auto-started: ${r.name}`)}catch(n){Qt.error(`Failed to auto-start ${r.name}:`,n)}}catch(e){Qt.error("Error during auto-start:",e)}}async stopAllServers(){const e=Array.from(this.clients.keys());for(const r of e)try{await this.stopServer(r)}catch(n){Qt.error(`Error stopping ${r}:`,n)}}startHealthCheck(){this.healthCheckInterval&&clearInterval(this.healthCheckInterval),setTimeout(()=>{this.healthCheckInterval=setInterval(async()=>{for(const[e,r]of this.clients.entries())try{if(await r.ping())this.serverErrors.has(e)&&this.serverErrors.delete(e);else{Qt.warn(`Server ${e} is not responding`);const i=await Je.getMCPServer(e);if(i&&i.enabled){const o=this.serverErrors.get(e)||{count:0,lastError:"",lastErrorTime:0},a=Date.now()-o.lastErrorTime;if(o.count<3&&a>3e5){Qt.info(`Attempting automatic restart of ${e} (attempt ${o.count+1}/3)`);try{await this.stopServer(e),await this.startServer(e),Qt.info(`Successfully restarted ${e}`)}catch(d){Qt.error(`Failed to restart ${e}:`,d)}}else o.count>=3&&(Qt.error(`Server ${e} exceeded max restart attempts (3)`),await Je.updateMCPServerStatus(e,"error"))}else await Je.updateMCPServerStatus(e,"error")}}catch(n){Qt.debug(`Health check failed for ${e}:`,n)}},6e4)},1e4)}getServerHealthInfo(e){const r=this.serverErrors.get(e);return r?{errorCount:r.count,lastError:r.lastError,lastErrorTime:r.lastErrorTime}:null}clearServerErrors(e){this.serverErrors.delete(e)}async cleanup(){this.healthCheckInterval&&(clearInterval(this.healthCheckInterval),this.healthCheckInterval=null),await this.stopAllServers()}}const Go=new rK,eg=Object.freeze(Object.defineProperty({__proto__:null,mcpManager:Go},Symbol.toStringTag,{value:"Module"}));class nK{constructor(){Pe(this,"toolCache",[]);Pe(this,"cacheTimestamp",0);Pe(this,"cacheTTL",5e3)}async getAllTools(){try{const e=Date.now();if(this.toolCache.length>0&&e-this.cacheTimestamp<this.cacheTTL)return this.toolCache;const r=await Go.getAllTools();return this.toolCache=r,this.cacheTimestamp=e,r.length>0&&r.length!==this.toolCache.length&&Qt.debug("Tools updated:",r.length),r}catch(e){return Qt.error("Error fetching tools:",e),this.toolCache}}async executeToolDirect(e,r,n){const i=Date.now();try{const a=(await this.getAllTools()).find(f=>f.serverId===e&&f.name===r);if(!a)return{success:!1,error:`Tool not found: ${e}.${r}`,toolName:r,serverId:e};const l=this.validateToolParams(a,n);if(!l.valid)return{success:!1,error:`Invalid parameters: ${l.errors.join(", ")}`,toolName:r,serverId:e};const d=await Go.callTool(e,r,n),p=Date.now()-i;return{success:!0,data:d,toolName:r,serverId:e,executionTime:p}}catch(o){const a=Date.now()-i;return Qt.error("Tool execution failed:",o),{success:!1,error:o.message||"Unknown error during tool execution",toolName:r,serverId:e,executionTime:a}}}async getToolsByCategory(e){try{return(await this.getAllTools()).filter(n=>this.categorizeTool(n)===e)}catch(r){return Qt.error("Error filtering tools by category:",r),[]}}async getToolsByServer(e){try{return(await this.getAllTools()).filter(n=>n.serverId===e)}catch(r){return Qt.error("Error filtering tools by server:",r),[]}}validateToolParams(e,r){const n=[],i=[];if(!e.inputSchema||!e.inputSchema.properties)return{valid:!0,errors:[],missingRequired:[]};const o=e.inputSchema,a=o.required||[];for(const l of a)(!(l in r)||r[l]===void 0||r[l]==="")&&(i.push(l),n.push(`Missing required parameter: ${l}`));if(o.properties){for(const[l,d]of Object.entries(r))if(o.properties[l]){const p=o.properties[l].type,f=typeof d;p==="string"&&f!=="string"?n.push(`Parameter '${l}' should be string, got ${f}`):p==="number"&&f!=="number"?n.push(`Parameter '${l}' should be number, got ${f}`):p==="boolean"&&f!=="boolean"&&n.push(`Parameter '${l}' should be boolean, got ${f}`)}}return{valid:n.length===0,errors:n,missingRequired:i}}categorizeTool(e){const r=e.serverId.toLowerCase(),n=e.name.toLowerCase();return r.includes("postgres")||r.includes("questdb")||r.includes("sqlite")||r.includes("mysql")||n.includes("query")||n.includes("database")?"database":r.includes("wikipedia")||r.includes("search")||r.includes("fetch")||r.includes("brave")||n.includes("search")||n.includes("fetch")?"web":r.includes("filesystem")||r.includes("file")||n.includes("read")||n.includes("write")||n.includes("file")?"file":r.includes("api")||r.includes("http")||n.includes("api")||n.includes("request")?"api":n.includes("data")||n.includes("analyze")||n.includes("transform")?"data":r.includes("slack")||r.includes("email")||r.includes("calendar")||r.includes("notion")?"productivity":"other"}async getTool(e,r){try{return(await this.getAllTools()).find(i=>i.serverId===e&&i.name===r)||null}catch(n){return Qt.error("Error getting tool:",n),null}}async isToolAvailable(e,r){return await this.getTool(e,r)!==null}async getAvailableServers(){try{const e=await this.getAllTools(),r=new Set(e.map(n=>n.serverId));return Array.from(r)}catch(e){return Qt.error("Error getting available servers:",e),[]}}clearCache(){this.toolCache=[],this.cacheTimestamp=0}formatToolsForOpenAI(e){return e.map(r=>({type:"function",function:{name:`${r.serverId}__${r.name}`,description:r.description||`Tool: ${r.name} from ${r.serverId}`,parameters:r.inputSchema||{type:"object",properties:{},required:[]}}}))}parseOpenAIFunctionName(e){const r=e.split("__");return r.length!==2?(Qt.error("Invalid function name format:",e),null):{serverId:r[0],toolName:r[1]}}}const Cd=new nK,bk=Object.freeze(Object.defineProperty({__proto__:null,mcpToolService:Cd},Symbol.toStringTag,{value:"Module"})),sK=({data:s,selected:e})=>{const[r,n]=S.useState(s.parameters||{}),[i,o]=S.useState(null),[a,l]=S.useState(!1),[d,p]=S.useState(null),[f,h]=S.useState(null),x="#FFA500",m="#FFFFFF",b="#787878",w="#0a0a0a",y="#1a1a1a",C="#2d2d2d",T="#10b981",E="#ef4444",j="#FFFF00";S.useEffect(()=>{(async()=>{try{const G=await Cd.getTool(s.serverId,s.toolName);o(G)}catch(G){console.error("[MCPToolNode] Failed to load tool:",G),h("Failed to load tool schema")}})()},[s.serverId,s.toolName]);const k=()=>({...r,...s.inputs||{}}),A=async()=>{if(i){l(!0),h(null);try{const O=k(),G=await Cd.executeToolDirect(s.serverId,s.toolName,O);G.success?(p(G.data),s.onExecute?.(G.data)):h(G.error||"Unknown error")}catch(O){h(O.message||"Execution failed")}finally{l(!1)}}},R=(O,G)=>{const B={...r,[O]:G};n(B),s.onParameterChange?.(B)},M=()=>i?.inputSchema?.required?i.inputSchema.required:[],P=(O,G)=>{const B=M().includes(O),F=r[O]||"",z=G.type||"string",$=s.inputs&&O in s.inputs;return t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("label",{style:{color:B?j:b,fontSize:"9px",display:"block",marginBottom:"2px",fontWeight:B?"bold":"normal"},children:[O,B?" *":"",$&&t.jsx("span",{style:{color:T,marginLeft:"4px"},children:"[Connected]"})]}),z==="boolean"?t.jsx("input",{type:"checkbox",checked:F||!1,onChange:W=>R(O,W.target.checked),disabled:$,style:{cursor:$?"not-allowed":"pointer",opacity:$?.5:1}}):z==="number"?t.jsx("input",{type:"number",value:F,onChange:W=>R(O,parseFloat(W.target.value)),disabled:$,style:{width:"100%",backgroundColor:w,border:`1px solid ${C}`,color:m,padding:"4px",fontSize:"9px",fontFamily:"monospace",opacity:$?.5:1,cursor:$?"not-allowed":"text"}}):t.jsx("textarea",{value:F,onChange:W=>R(O,W.target.value),disabled:$,placeholder:G.description||"",style:{width:"100%",backgroundColor:w,border:`1px solid ${C}`,color:m,padding:"4px",fontSize:"9px",fontFamily:"monospace",resize:"vertical",minHeight:"40px",opacity:$?.5:1,cursor:$?"not-allowed":"text"}})]},O)},I=()=>{if(!i)return!1;const O=k();return Cd.validateToolParams(i,O).valid};return t.jsxs("div",{style:{backgroundColor:y,border:`2px solid ${e?x:C}`,borderRadius:"6px",padding:"12px",minWidth:"280px",maxWidth:"350px",fontFamily:"Consolas, monospace",boxShadow:e?`0 0 12px ${x}80`:"none"},children:[i?.inputSchema?.properties&&Object.keys(i.inputSchema.properties).map((O,G)=>t.jsx(lo,{type:"target",position:co.Left,id:O,style:{top:`${30+G*20}px`,background:x,width:"10px",height:"10px",border:`2px solid ${w}`}},`input-${O}`)),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",paddingBottom:"8px",borderBottom:`1px solid ${C}`},children:[t.jsx(si,{size:16,color:x}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:m,fontSize:"11px",fontWeight:"bold",marginBottom:"2px"},children:s.label}),t.jsxs("div",{style:{color:b,fontSize:"8px"},children:[s.serverId,"  ",s.toolName]})]})]}),i?.description&&t.jsx("div",{style:{color:b,fontSize:"9px",marginBottom:"12px",lineHeight:"1.4"},children:i.description}),i?.inputSchema?.properties&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:j,fontSize:"10px",fontWeight:"bold",marginBottom:"8px"},children:"PARAMETERS"}),Object.entries(i.inputSchema.properties).map(([O,G])=>P(O,G))]}),t.jsx("button",{onClick:A,disabled:!I()||a,style:{width:"100%",backgroundColor:I()&&!a?T:b,color:"black",border:"none",padding:"8px",fontSize:"10px",fontWeight:"bold",cursor:I()&&!a?"pointer":"not-allowed",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",marginBottom:"8px"},children:a?t.jsxs(t.Fragment,{children:[t.jsx(ni,{size:12,className:"animate-spin"}),"EXECUTING..."]}):t.jsxs(t.Fragment,{children:[t.jsx(si,{size:12}),"EXECUTE TOOL"]})}),f&&t.jsxs("div",{style:{backgroundColor:`${E}20`,border:`1px solid ${E}`,borderRadius:"4px",padding:"6px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(Rr,{size:12,color:E}),t.jsx("div",{style:{color:E,fontSize:"9px",flex:1},children:f})]}),d&&!f&&t.jsxs("div",{style:{backgroundColor:`${T}20`,border:`1px solid ${T}`,borderRadius:"4px",padding:"6px",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(Bn,{size:12,color:T}),t.jsx("div",{style:{color:T,fontSize:"9px",flex:1},children:"Executed successfully"})]}),t.jsx(lo,{type:"source",position:co.Right,id:"output",style:{background:T,width:"10px",height:"10px",border:`2px solid ${w}`}})]})};async function iK(){try{return(await Cd.getAllTools()).map(e=>{const r=e.inputSchema?.properties?Object.keys(e.inputSchema.properties):[];return{id:`mcp-${e.serverId}-${e.name}`,type:"mcp-tool",label:e.name.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),category:"MCP Tools",icon:oK(e),serverId:e.serverId,toolName:e.name,description:e.description||`${e.name} from ${e.serverId}`,inputs:r,outputs:["output"]}})}catch(s){return console.error("[MCPNodeConfigs] Failed to generate configs:",s),[]}}function oK(s){const e=s.serverId.toLowerCase(),r=s.name.toLowerCase();return e.includes("postgres")?"":e.includes("questdb")?"":e.includes("sqlite")?"":e.includes("mysql")?"":e.includes("wikipedia")?"":e.includes("search")||e.includes("brave")?"":e.includes("fetch")||r.includes("fetch")?"":e.includes("filesystem")||e.includes("file")?"":e.includes("api")||e.includes("http")?"":e.includes("slack")?"":e.includes("email")?"":e.includes("calendar")?"":""}const aK=({id:s,data:e,selected:r})=>{const[n,i]=S.useState(!1),[o,a]=S.useState([]),[l,d]=S.useState(e.selectedLLM||"active");S.useEffect(()=>{(async()=>{try{const j=await Je.getLLMConfigs();a(j)}catch(j){console.error("Failed to load LLM configs:",j)}})()},[]);const p="#FFA500",f="#FFFFFF",h="#787878",x="#0a0a0a",m="#1a1a1a",b="#2d2d2d",w="#10b981",y="#ef4444",C=()=>{switch(e.status){case"running":return p;case"completed":return w;case"error":return y;default:return h}},T=()=>{switch(e.status){case"running":return t.jsx(ni,{size:14,className:"animate-spin",color:p});case"completed":return t.jsx(Bn,{size:14,color:w});case"error":return t.jsx(Rr,{size:14,color:y});default:return t.jsx(Nr,{size:14,color:h})}};return t.jsxs("div",{style:{backgroundColor:m,border:`2px solid ${r?p:C()}`,borderRadius:"8px",padding:"12px",minWidth:"250px",maxWidth:"320px",fontFamily:"Consolas, monospace",boxShadow:r?`0 0 16px ${p}60`:"0 2px 8px rgba(0,0,0,0.3)"},children:[t.jsx(lo,{type:"target",position:co.Left,style:{background:e.color,width:"12px",height:"12px",border:`2px solid ${x}`,left:"-6px"}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"10px",paddingBottom:"8px",borderBottom:`1px solid ${b}`},children:[t.jsx("span",{style:{fontSize:"20px"},children:e.icon}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:f,fontSize:"12px",fontWeight:"bold",marginBottom:"2px"},children:e.label}),t.jsx("div",{style:{color:h,fontSize:"9px",textTransform:"uppercase"},children:e.agentCategory})]}),T()]}),Object.keys(e.parameters).length>0&&t.jsxs("div",{style:{backgroundColor:x,border:`1px solid ${b}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:p,fontSize:"9px",fontWeight:"bold",marginBottom:"4px"},children:"PARAMETERS"}),Object.entries(e.parameters).slice(0,2).map(([E,j])=>t.jsxs("div",{style:{color:h,fontSize:"8px",marginBottom:"2px",display:"flex",justifyContent:"space-between"},children:[t.jsxs("span",{children:[E,":"]}),t.jsx("span",{style:{color:f},children:Array.isArray(j)?j.join(", "):String(j).substring(0,20)})]},E)),Object.keys(e.parameters).length>2&&t.jsxs("div",{style:{color:h,fontSize:"8px",fontStyle:"italic"},children:["+",Object.keys(e.parameters).length-2," more..."]})]}),e.status==="completed"&&e.result&&t.jsxs("div",{style:{backgroundColor:`${w}15`,border:`1px solid ${w}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:w,fontSize:"9px",fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Bn,{size:10}),"RESULT"]}),t.jsxs("div",{style:{color:f,fontSize:"8px",fontFamily:"monospace",maxHeight:"60px",overflow:"auto"},children:[JSON.stringify(e.result,null,2).substring(0,100),"..."]})]}),e.status==="error"&&e.error&&t.jsxs("div",{style:{backgroundColor:`${y}15`,border:`1px solid ${y}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:y,fontSize:"9px",fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Rr,{size:10}),"ERROR"]}),t.jsx("div",{style:{color:y,fontSize:"8px",wordBreak:"break-word"},children:e.error})]}),t.jsxs("div",{onClick:()=>i(!n),style:{backgroundColor:x,border:`1px solid ${n?p:b}`,borderRadius:"4px",padding:"6px",marginBottom:"8px",cursor:"pointer",transition:"border-color 0.2s"},children:[t.jsxs("div",{style:{color:h,fontSize:"9px",fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"4px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(qo,{size:10}),"LLM"]}),t.jsx(Mn,{size:10,color:n?p:h})]}),t.jsx("div",{style:{color:f,fontSize:"8px"},children:l==="active"?"Active Provider":l.toUpperCase()})]}),n&&t.jsxs("div",{style:{backgroundColor:x,border:`1px solid ${p}`,borderRadius:"4px",padding:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:p,fontSize:"10px",fontWeight:"bold",marginBottom:"8px"},children:"LLM CONFIGURATION"}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:h,fontSize:"8px",display:"block",marginBottom:"4px"},children:"LLM Provider for Analysis"}),t.jsxs("select",{value:l,onChange:E=>{d(E.target.value),e.onLLMChange?.(E.target.value)},style:{width:"100%",backgroundColor:m,border:`1px solid ${b}`,color:f,padding:"4px",fontSize:"8px",borderRadius:"3px"},children:[t.jsx("option",{value:"active",children:"Use Active Provider (from Settings)"}),o.map(E=>t.jsxs("option",{value:E.provider,children:[E.provider.toUpperCase()," - ",E.model]},E.provider))]})]}),t.jsx("button",{onClick:E=>{E.stopPropagation(),i(!1)},style:{width:"100%",backgroundColor:p,color:"black",border:"none",padding:"6px",fontSize:"9px",fontWeight:"bold",cursor:"pointer",borderRadius:"3px"},children:"CLOSE"})]}),t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsx("button",{onClick:()=>e.onExecute?.(s),disabled:e.status==="running",style:{flex:1,backgroundColor:e.status==="running"?h:e.color,color:"black",border:"none",padding:"8px",fontSize:"10px",fontWeight:"bold",cursor:e.status==="running"?"not-allowed":"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",opacity:e.status==="running"?.6:1},children:e.status==="running"?t.jsxs(t.Fragment,{children:[t.jsx(ni,{size:12,className:"animate-spin"}),"RUNNING..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Ms,{size:12}),"EXECUTE"]})}),t.jsx("button",{onClick:()=>i(!n),style:{backgroundColor:n?p:x,border:`1px solid ${b}`,color:n?"black":h,padding:"8px",fontSize:"10px",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(Mn,{size:14})})]}),t.jsx(lo,{type:"source",position:co.Right,style:{background:e.status==="completed"?w:e.color,width:"12px",height:"12px",border:`2px solid ${x}`,right:"-6px"}})]})},lK=({data:s,selected:e})=>{const[r,n]=S.useState(!0),[i,o]=S.useState(!1),[a,l]=S.useState(500),[d,p]=S.useState(400);console.log("[ResultsDisplayNode] Rendering with data:",s),console.log("[ResultsDisplayNode] inputData present:",!!s.inputData),console.log("[ResultsDisplayNode] inputData value:",s.inputData);const f="#FFA500",h="#FFFFFF",x="#787878",m="#0a0a0a",b="#1a1a1a",w="#2d2d2d",y=()=>{s.inputData&&(navigator.clipboard.writeText(JSON.stringify(s.inputData,null,2)),o(!0),setTimeout(()=>o(!1),2e3))},C=j=>j==null?"null":typeof j=="object"?JSON.stringify(j,null,2):String(j),T=j=>{const k=j.split(`
`),A=[];return k.forEach((R,M)=>{let P={color:h,fontSize:"10px",lineHeight:"1.7",marginBottom:"3px",fontFamily:"Consolas, monospace"};if(R.trim()==="---"||R.trim()==="***"||/^-{3,}$/.test(R.trim())){A.push(t.jsx("div",{style:{borderTop:`1px solid ${w}`,margin:"12px 0",opacity:.5}},M));return}if(R.startsWith("###"))P={color:"#10b981",fontWeight:"bold",fontSize:"11px",marginTop:"12px",marginBottom:"6px",borderBottom:`1px solid ${w}`,paddingBottom:"4px"},R=R.replace(/^###\s*/,"");else if(R.startsWith("##"))P={color:f,fontWeight:"bold",fontSize:"13px",marginTop:"16px",marginBottom:"8px",borderBottom:`2px solid ${f}40`,paddingBottom:"6px"},R=R.replace(/^##\s*/,"");else if(R.startsWith("#"))P={color:f,fontWeight:"bold",fontSize:"14px",marginTop:"16px",marginBottom:"8px"},R=R.replace(/^#\s*/,"");else if(R.startsWith("|")){const I=R.split("|").map(O=>O.trim()).filter(O=>O);if(I.every(O=>/^[-:]+$/.test(O)))return;A.push(t.jsx("div",{style:{display:"flex",gap:"8px",padding:"4px 0",borderBottom:`1px solid ${w}30`,fontFamily:"Consolas, monospace",fontSize:"9px"},children:I.map((O,G)=>t.jsx("div",{style:{flex:G===0?"0 0 150px":"1",color:G===0?f:"#d4d4d4",fontWeight:G===0?"bold":"normal",padding:"2px 6px",overflow:"hidden",textOverflow:"ellipsis"},children:O.replace(/\*\*/g,"")},G))},M));return}else if(R.startsWith("- ")||R.startsWith(" ")){P={...P,marginLeft:"16px",color:"#d4d4d4",display:"flex",alignItems:"flex-start"};const I=R.replace(/^[-]\s*/,"");A.push(t.jsxs("div",{style:P,children:[t.jsx("span",{style:{color:"#10b981",marginRight:"8px"},children:""}),t.jsx("span",{children:I.replace(/\*\*/g,"")})]},M));return}else if(/^\d+\.\s/.test(R))P={...P,marginLeft:"16px",color:"#d4d4d4"},R=R.replace(/\*\*/g,"");else if(R.includes("**")){const I=R.split(/\*\*([^*]+)\*\*/g);A.push(t.jsx("div",{style:P,children:I.map((O,G)=>G%2===1?t.jsx("span",{style:{color:"#10b981",fontWeight:"bold"},children:O},G):t.jsx("span",{children:O},G))},M));return}else if(R.startsWith("*(")||R.startsWith("*"))P={...P,color:x,fontStyle:"italic",fontSize:"9px"},R=R.replace(/^\*\(/,"(").replace(/\)$/,")").replace(/^\*/,"").replace(/\*$/,"");else if(R.trim()===""){A.push(t.jsx("div",{style:{height:"8px"}},M));return}A.push(t.jsx("div",{style:P,children:R||""},M))}),t.jsx(t.Fragment,{children:A})},E=(j,k=0)=>{if(!j||typeof j!="object"){const A=C(j);return typeof j=="string"&&(j.includes("##")||j.includes("|")||j.length>200)?t.jsx("div",{style:{backgroundColor:m,border:`1px solid ${w}`,borderRadius:"4px",padding:"8px",marginTop:"4px"},children:T(j)}):t.jsx("div",{style:{color:h,fontSize:"10px",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:A})}return t.jsx("div",{style:{marginLeft:k>0?"12px":"0"},children:Object.entries(j).map(([A,R])=>t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsxs("div",{style:{color:f,fontSize:"10px",fontWeight:"bold",marginBottom:"4px",textTransform:"uppercase",letterSpacing:"0.5px"},children:[A.replace(/_/g," "),":"]}),typeof R=="object"&&R!==null?Array.isArray(R)?t.jsx("div",{style:{color:"#10b981",fontSize:"9px",marginLeft:"8px",fontFamily:"monospace"},children:R.map((M,P)=>t.jsxs("div",{style:{marginBottom:"2px"},children:[" ",M]},P))}):E(R,k+1):typeof R=="string"&&(R.includes("##")||R.includes("|")||R.length>200)?t.jsx("div",{style:{backgroundColor:"#0f0f0f",border:`1px solid ${w}`,borderRadius:"4px",padding:"8px",marginLeft:"8px",marginTop:"4px"},children:T(R)}):t.jsx("div",{style:{color:h,fontSize:"10px",fontFamily:"monospace",marginLeft:"8px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:C(R)})]},A))})};return t.jsxs("div",{style:{backgroundColor:b,border:`2px solid ${e?f:s.color}`,borderRadius:"8px",padding:"12px",width:`${a}px`,fontFamily:"Consolas, monospace",boxShadow:e?`0 0 16px ${f}60`:"0 2px 8px rgba(0,0,0,0.3)",position:"relative"},children:[t.jsx(lo,{type:"target",position:co.Left,style:{background:s.color,width:"12px",height:"12px",border:`2px solid ${m}`,left:"-6px"}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px",paddingBottom:"8px",borderBottom:`1px solid ${w}`},children:[t.jsxs("div",{style:{color:h,fontSize:"12px",fontWeight:"bold"},children:[" ",s.label]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{onClick:()=>n(!r),style:{backgroundColor:"transparent",border:`1px solid ${w}`,color:x,padding:"4px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center"},title:r?"Collapse":"Expand",children:r?t.jsx(cc,{size:12}):t.jsx(vi,{size:12})}),t.jsx("button",{onClick:y,disabled:!s.inputData,style:{backgroundColor:"transparent",border:`1px solid ${w}`,color:i?"#10b981":x,padding:"4px",cursor:s.inputData?"pointer":"not-allowed",borderRadius:"3px",display:"flex",alignItems:"center",opacity:s.inputData?1:.5},title:"Copy to clipboard",children:i?t.jsx(Es,{size:12}):t.jsx(hc,{size:12})})]})]}),r&&t.jsx("div",{onWheel:j=>j.stopPropagation(),onMouseDown:j=>j.stopPropagation(),style:{backgroundColor:m,border:`1px solid ${w}`,borderRadius:"4px",padding:"10px",maxHeight:`${d}px`,overflow:"auto"},children:s.inputData?E(s.inputData):t.jsxs("div",{style:{color:x,fontSize:"10px",fontStyle:"italic",textAlign:"center",padding:"20px"},children:["No data received yet.",t.jsx("br",{}),"Connect this node to an output to see results."]})}),t.jsx("div",{onMouseDown:j=>{j.preventDefault(),j.stopPropagation();const k=j.clientX,A=j.clientY,R=a,M=d,P=O=>{O.preventDefault();const G=O.clientX-k,B=O.clientY-A;l(Math.max(300,R+G)),p(Math.max(200,M+B))},I=()=>{document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",I)};document.addEventListener("mousemove",P),document.addEventListener("mouseup",I)},style:{position:"absolute",bottom:"4px",right:"4px",width:"24px",height:"24px",cursor:"nwse-resize",backgroundColor:m,border:`2px solid ${w}`,borderBottomRightRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",color:x,transition:"all 0.2s",zIndex:10},onMouseEnter:j=>{j.currentTarget.style.backgroundColor=f,j.currentTarget.style.color="white",j.currentTarget.style.borderColor=f},onMouseLeave:j=>{j.currentTarget.style.backgroundColor=m,j.currentTarget.style.color=x,j.currentTarget.style.borderColor=w},title:"Drag to resize",children:""})]})},cK=({id:s,data:e,selected:r})=>{const[n,i]=S.useState(!1),[o,a]=S.useState([]),[l,d]=S.useState(e.selectedProvider||"active"),[p,f]=S.useState(e.customPrompt||""),h="#FFA500",x="#FFFFFF",m="#787878",b="#0a0a0a",w="#1a1a1a",y="#2d2d2d",C="#10b981",T="#ef4444",E="#3b82f6";S.useEffect(()=>{(async()=>{try{const P=await Je.getLLMConfigs();a(P)}catch(P){console.error("Failed to load LLM providers:",P)}})()},[]);const j=()=>{switch(e.status){case"running":return E;case"completed":return C;case"error":return T;default:return h}},k=()=>{switch(e.status){case"running":return t.jsx(ni,{size:14,className:"animate-spin",color:E});case"completed":return t.jsx(Bn,{size:14,color:C});case"error":return t.jsx(Rr,{size:14,color:T});default:return t.jsx(qo,{size:14,color:h})}},A=()=>{e.onConfigChange?.({selectedProvider:l==="active"?void 0:l,customPrompt:p||void 0}),i(!1)},R=()=>{if(!e.selectedProvider||e.selectedProvider==="active")return"Active Provider";const M=o.find(P=>P.provider===e.selectedProvider);return M?`${M.provider.toUpperCase()} - ${M.model}`:e.selectedProvider};return t.jsxs("div",{style:{backgroundColor:w,border:`2px solid ${r?h:j()}`,borderRadius:"8px",padding:"12px",minWidth:"280px",maxWidth:"350px",fontFamily:"Consolas, monospace",boxShadow:r?`0 0 16px ${h}60`:"0 2px 8px rgba(0,0,0,0.3)"},children:[t.jsx(lo,{type:"target",position:co.Left,style:{background:E,width:"12px",height:"12px",border:`2px solid ${b}`,left:"-6px"}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"10px",paddingBottom:"8px",borderBottom:`1px solid ${y}`},children:[t.jsx(Qg,{size:20,color:E}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:x,fontSize:"12px",fontWeight:"bold",marginBottom:"2px"},children:e.label}),t.jsx("div",{style:{color:m,fontSize:"9px",textTransform:"uppercase"},children:"LLM MEDIATOR"})]}),k()]}),t.jsxs("div",{style:{backgroundColor:b,border:`1px solid ${y}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:E,fontSize:"9px",fontWeight:"bold",marginBottom:"4px"},children:"LLM PROVIDER"}),t.jsxs("div",{style:{color:x,fontSize:"8px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(qo,{size:10,color:E}),R()]})]}),e.inputData&&t.jsxs("div",{style:{backgroundColor:`${m}15`,border:`1px solid ${m}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:m,fontSize:"9px",fontWeight:"bold",marginBottom:"4px"},children:"INPUT DATA"}),t.jsxs("div",{style:{color:x,fontSize:"8px",fontFamily:"monospace",maxHeight:"50px",overflow:"auto"},children:[JSON.stringify(e.inputData,null,2).substring(0,80),"..."]})]}),e.status==="completed"&&e.result&&t.jsxs("div",{style:{backgroundColor:`${C}15`,border:`1px solid ${C}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:C,fontSize:"9px",fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Bn,{size:10}),"MEDIATED CONTEXT"]}),t.jsxs("div",{style:{color:x,fontSize:"8px",maxHeight:"80px",overflow:"auto",lineHeight:"1.4"},children:[typeof e.result=="string"?e.result.substring(0,150):JSON.stringify(e.result,null,2).substring(0,150),"..."]})]}),e.status==="error"&&e.error&&t.jsxs("div",{style:{backgroundColor:`${T}15`,border:`1px solid ${T}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:T,fontSize:"9px",fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Rr,{size:10}),"ERROR"]}),t.jsx("div",{style:{color:T,fontSize:"8px",wordBreak:"break-word"},children:e.error})]}),n&&t.jsxs("div",{style:{backgroundColor:b,border:`1px solid ${h}`,borderRadius:"4px",padding:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:h,fontSize:"10px",fontWeight:"bold",marginBottom:"8px"},children:"MEDIATOR SETTINGS"}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:m,fontSize:"8px",display:"block",marginBottom:"4px"},children:"LLM Provider"}),t.jsxs("select",{value:l,onChange:M=>d(M.target.value),style:{width:"100%",backgroundColor:w,border:`1px solid ${y}`,color:x,padding:"4px",fontSize:"8px",borderRadius:"3px"},children:[t.jsx("option",{value:"active",children:"Use Active Provider"}),o.map(M=>t.jsxs("option",{value:M.provider,children:[M.provider.toUpperCase()," - ",M.model]},M.provider))]})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:m,fontSize:"8px",display:"block",marginBottom:"4px"},children:"Custom Mediation Prompt (optional)"}),t.jsx("textarea",{value:p,onChange:M=>f(M.target.value),placeholder:"Leave empty for default prompt",rows:3,style:{width:"100%",backgroundColor:w,border:`1px solid ${y}`,color:x,padding:"4px",fontSize:"8px",borderRadius:"3px",resize:"vertical",fontFamily:"Consolas, monospace"}})]}),t.jsx("button",{onClick:A,style:{width:"100%",backgroundColor:E,color:"white",border:"none",padding:"6px",fontSize:"9px",fontWeight:"bold",cursor:"pointer",borderRadius:"3px"},children:"SAVE CONFIG"})]}),t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsx("button",{onClick:()=>e.onExecute?.(s),disabled:e.status==="running",style:{flex:1,backgroundColor:e.status==="running"?m:E,color:"white",border:"none",padding:"8px",fontSize:"10px",fontWeight:"bold",cursor:e.status==="running"?"not-allowed":"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",opacity:e.status==="running"?.6:1},children:e.status==="running"?t.jsxs(t.Fragment,{children:[t.jsx(ni,{size:12,className:"animate-spin"}),"MEDIATING..."]}):t.jsxs(t.Fragment,{children:[t.jsx(qo,{size:12}),"MEDIATE"]})}),t.jsx("button",{onClick:()=>i(!n),style:{backgroundColor:n?E:b,border:`1px solid ${y}`,color:n?x:m,padding:"8px",fontSize:"10px",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(Mn,{size:14})})]}),t.jsx(lo,{type:"source",position:co.Right,style:{background:e.status==="completed"?C:E,width:"12px",height:"12px",border:`2px solid ${b}`,right:"-6px"}})]})},vk=[{id:"postgres_1",name:"PostgreSQL - Production",type:"PostgreSQL"},{id:"mysql_1",name:"MySQL - Analytics",type:"MySQL"},{id:"mongodb_1",name:"MongoDB - Orders",type:"MongoDB"},{id:"sqlite_1",name:"SQLite - Local",type:"SQLite"}],dK=({data:s,selected:e})=>{const[r,n]=S.useState(!1),[i,o]=S.useState(s.query||""),[a,l]=S.useState(s.selectedConnectionId||""),d=()=>{a&&s.onConnectionChange(a),i&&s.onQueryChange(i),n(!1)},p=()=>{switch(s.status){case"running":return"#3b82f6";case"completed":return"#10b981";case"error":return"#ef4444";default:return"#6b7280"}},f=()=>{switch(s.status){case"running":return"";case"completed":return t.jsx(Es,{size:14,color:"#10b981"});case"error":return t.jsx(Rr,{size:14,color:"#ef4444"});default:return t.jsx(js,{size:14,color:"#6b7280"})}},h=vk.find(m=>m.id===(a||s.selectedConnectionId)),x=s.selectedConnectionId&&s.query;return t.jsxs("div",{style:{background:e?"#252525":"#1a1a1a",border:`2px solid ${e?"#3b82f6":p()}`,borderRadius:"8px",minWidth:"280px",maxWidth:"400px",fontFamily:"Consolas, monospace",boxShadow:e?"0 0 16px #3b82f660":"0 2px 8px rgba(0,0,0,0.3)",position:"relative"},children:[t.jsx(lo,{type:"source",position:co.Right,style:{background:"#3b82f6",width:"12px",height:"12px",border:"2px solid #0a0a0a",right:"-6px"}}),t.jsxs("div",{style:{backgroundColor:"#0f0f0f",padding:"10px 12px",borderTopLeftRadius:"6px",borderTopRightRadius:"6px",borderBottom:"1px solid #2d2d2d",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(js,{size:16,color:"#3b82f6"}),t.jsx("span",{style:{color:"#fff",fontSize:"12px",fontWeight:"bold"},children:s.label})]}),t.jsxs("div",{style:{display:"flex",gap:"4px",alignItems:"center"},children:[f(),t.jsx("button",{onClick:()=>n(!r),style:{backgroundColor:r?"#3b82f6":"transparent",border:`1px solid ${r?"#3b82f6":"#404040"}`,color:r?"#fff":"#6b7280",padding:"4px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",transition:"all 0.2s"},title:"Configure data source",children:t.jsx(Mn,{size:12})})]})]}),r?t.jsxs("div",{style:{padding:"12px",backgroundColor:"#0a0a0a"},children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:"#a3a3a3",fontSize:"10px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Database Connection"}),t.jsxs("select",{value:a,onChange:m=>l(m.target.value),style:{width:"100%",backgroundColor:"#1a1a1a",border:"1px solid #404040",color:"#fff",padding:"8px",fontSize:"11px",borderRadius:"4px",cursor:"pointer",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"",children:"-- Select Connection --"}),vk.map(m=>t.jsxs("option",{value:m.id,children:[m.name," (",m.type,")"]},m.id))]})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:"#a3a3a3",fontSize:"10px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"SQL Query"}),t.jsx("textarea",{value:i,onChange:m=>o(m.target.value),placeholder:"SELECT * FROM table WHERE condition",style:{width:"100%",height:"100px",backgroundColor:"#1a1a1a",border:"1px solid #404040",color:"#fff",padding:"8px",fontSize:"10px",borderRadius:"4px",resize:"vertical",fontFamily:"Consolas, monospace",lineHeight:"1.5"}})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:d,disabled:!a||!i.trim(),style:{flex:1,backgroundColor:!a||!i.trim()?"#404040":"#10b981",color:"#fff",border:"none",padding:"8px",fontSize:"11px",fontWeight:"bold",cursor:!a||!i.trim()?"not-allowed":"pointer",borderRadius:"4px",opacity:!a||!i.trim()?.5:1},children:"SAVE CONFIG"}),t.jsx("button",{onClick:()=>n(!1),style:{backgroundColor:"transparent",color:"#6b7280",border:"1px solid #404040",padding:"8px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px"},children:"CANCEL"})]})]}):t.jsxs("div",{style:{padding:"12px"},children:[h?t.jsxs("div",{style:{backgroundColor:"#0f0f0f",border:"1px solid #2d2d2d",borderRadius:"4px",padding:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:"#3b82f6",fontSize:"9px",fontWeight:"bold",marginBottom:"4px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Connection"}),t.jsx("div",{style:{color:"#fff",fontSize:"11px",marginBottom:"2px"},children:h.name}),t.jsx("div",{style:{color:"#6b7280",fontSize:"9px"},children:h.type})]}):t.jsx("div",{style:{backgroundColor:"#1a1a1a",border:"1px solid #404040",borderRadius:"4px",padding:"8px",marginBottom:"8px",textAlign:"center",color:"#6b7280",fontSize:"10px"},children:"No connection selected"}),s.query?t.jsxs("div",{style:{backgroundColor:"#0f0f0f",border:"1px solid #2d2d2d",borderRadius:"4px",padding:"8px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:"#3b82f6",fontSize:"9px",fontWeight:"bold",marginBottom:"4px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Query"}),t.jsx("div",{style:{color:"#d4d4d4",fontSize:"9px",fontFamily:"Consolas, monospace",lineHeight:"1.4",maxHeight:"60px",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:s.query})]}):t.jsx("div",{style:{backgroundColor:"#1a1a1a",border:"1px solid #404040",borderRadius:"4px",padding:"8px",marginBottom:"8px",textAlign:"center",color:"#6b7280",fontSize:"10px"},children:"No query defined"}),t.jsxs("button",{onClick:s.onExecute,disabled:!x||s.status==="running",style:{width:"100%",backgroundColor:!x||s.status==="running"?"#404040":"#3b82f6",color:"#fff",border:"none",padding:"8px",fontSize:"11px",fontWeight:"bold",cursor:!x||s.status==="running"?"not-allowed":"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",opacity:!x||s.status==="running"?.5:1},children:[t.jsx(Ms,{size:12}),s.status==="running"?"EXECUTING...":"EXECUTE QUERY"]}),s.status==="completed"&&s.result&&t.jsxs("div",{style:{marginTop:"8px",backgroundColor:"#0f0f0f",border:"1px solid #10b981",borderRadius:"4px",padding:"8px"},children:[t.jsx("div",{style:{color:"#10b981",fontSize:"9px",fontWeight:"bold",marginBottom:"4px"},children:" Query Successful"}),t.jsxs("div",{style:{color:"#6b7280",fontSize:"9px"},children:[s.result.rowCount||0," rows returned"]})]}),s.status==="error"&&s.error&&t.jsxs("div",{style:{marginTop:"8px",backgroundColor:"#1a0a0a",border:"1px solid #ef4444",borderRadius:"4px",padding:"8px"},children:[t.jsx("div",{style:{color:"#ef4444",fontSize:"9px",fontWeight:"bold",marginBottom:"4px"},children:" Error"}),t.jsx("div",{style:{color:"#d4d4d4",fontSize:"9px",lineHeight:"1.4",wordBreak:"break-word"},children:s.error})]})]})]})},uK=({id:s,data:e,selected:r})=>{const[n,i]=S.useState(!1),[o,a]=S.useState({dataSource:e.dataSource||"yfinance",symbol:e.symbol||"AAPL",period:e.period||"1y",csvPath:e.csvPath||"",jsonData:e.jsonData||"",categories:e.categories||["momentum","volume","volatility","trend","others"]}),l="#FFA500",d="#FFFFFF",p="#787878",f="#0a0a0a",h="#1a1a1a",x="#2d2d2d",m="#10b981",b="#ef4444",w=()=>{switch(e.status){case"running":return l;case"completed":return m;case"error":return b;default:return p}},y=()=>{switch(e.status){case"running":return t.jsx(ni,{size:14,className:"animate-spin",color:l});case"completed":return t.jsx(Bn,{size:14,color:m});case"error":return t.jsx(Rr,{size:14,color:b});default:return t.jsx(Nr,{size:14,color:p})}},C=(j,k)=>{const A={...o,[j]:k};a(A),e.onParameterChange?.(A)},T=j=>{const k=o.categories.includes(j)?o.categories.filter(A=>A!==j):[...o.categories,j];C("categories",k)},E=["momentum","volume","volatility","trend","others"];return t.jsxs("div",{style:{backgroundColor:h,border:`2px solid ${r?l:w()}`,borderRadius:"8px",padding:"12px",minWidth:"280px",maxWidth:"350px",fontFamily:"Consolas, monospace",boxShadow:r?`0 0 16px ${l}60`:"0 2px 8px rgba(0,0,0,0.3)"},children:[t.jsx(lo,{type:"target",position:co.Left,style:{background:l,width:"12px",height:"12px",border:`2px solid ${f}`,left:"-6px"}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"10px",paddingBottom:"8px",borderBottom:`1px solid ${x}`},children:[t.jsx("span",{style:{fontSize:"20px"},children:""}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:d,fontSize:"12px",fontWeight:"bold",marginBottom:"2px"},children:e.label}),t.jsx("div",{style:{color:p,fontSize:"9px",textTransform:"uppercase"},children:"TECHNICAL ANALYSIS"})]}),y()]}),t.jsxs("div",{style:{backgroundColor:f,border:`1px solid ${x}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsx("div",{style:{color:l,fontSize:"9px",fontWeight:"bold",marginBottom:"4px"},children:"DATA SOURCE"}),t.jsxs("div",{style:{color:p,fontSize:"8px",display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{children:"Type:"}),t.jsx("span",{style:{color:d},children:o.dataSource.toUpperCase()})]}),o.dataSource==="yfinance"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{color:p,fontSize:"8px",display:"flex",justifyContent:"space-between",marginBottom:"2px"},children:[t.jsx("span",{children:"Symbol:"}),t.jsx("span",{style:{color:d},children:o.symbol})]}),t.jsxs("div",{style:{color:p,fontSize:"8px",display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"Period:"}),t.jsx("span",{style:{color:d},children:o.period})]})]}),o.dataSource==="csv"&&t.jsxs("div",{style:{color:p,fontSize:"8px",display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{children:"File:"}),t.jsx("span",{style:{color:d,maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:o.csvPath||"Not set"})]}),o.dataSource==="input"&&t.jsx("div",{style:{color:p,fontSize:"8px"},children:"Waiting for upstream data..."})]}),t.jsxs("div",{style:{backgroundColor:f,border:`1px solid ${x}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:l,fontSize:"9px",fontWeight:"bold",marginBottom:"4px"},children:["INDICATORS (",o.categories.length,"/5)"]}),t.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:o.categories.map(j=>t.jsx("span",{style:{backgroundColor:`${l}30`,border:`1px solid ${l}`,color:l,fontSize:"7px",padding:"2px 6px",borderRadius:"3px",textTransform:"uppercase"},children:j},j))})]}),e.status==="completed"&&e.result&&t.jsxs("div",{style:{backgroundColor:`${m}15`,border:`1px solid ${m}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:m,fontSize:"9px",fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Bn,{size:10}),"RESULT"]}),t.jsx("div",{style:{color:d,fontSize:"8px",fontFamily:"monospace"},children:Array.isArray(e.result)?`${e.result.length} data points calculated`:"Analysis complete"})]}),e.status==="error"&&e.error&&t.jsxs("div",{style:{backgroundColor:`${b}15`,border:`1px solid ${b}`,borderRadius:"4px",padding:"6px",marginBottom:"8px"},children:[t.jsxs("div",{style:{color:b,fontSize:"9px",fontWeight:"bold",marginBottom:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Rr,{size:10}),"ERROR"]}),t.jsx("div",{style:{color:b,fontSize:"8px",wordBreak:"break-word"},children:e.error})]}),n&&t.jsxs("div",{style:{backgroundColor:f,border:`1px solid ${l}`,borderRadius:"4px",padding:"8px",marginBottom:"8px",maxHeight:"300px",overflowY:"auto"},children:[t.jsx("div",{style:{color:l,fontSize:"10px",fontWeight:"bold",marginBottom:"8px"},children:"CONFIGURATION"}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:p,fontSize:"8px",display:"block",marginBottom:"4px"},children:"Data Source"}),t.jsxs("select",{value:o.dataSource,onChange:j=>C("dataSource",j.target.value),style:{width:"100%",backgroundColor:h,border:`1px solid ${x}`,color:d,padding:"4px",fontSize:"8px",borderRadius:"3px"},children:[t.jsx("option",{value:"yfinance",children:"Yahoo Finance"}),t.jsx("option",{value:"csv",children:"CSV File"}),t.jsx("option",{value:"json",children:"JSON Data"}),t.jsx("option",{value:"input",children:"Upstream Input"})]})]}),o.dataSource==="yfinance"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:p,fontSize:"8px",display:"block",marginBottom:"4px"},children:"Symbol"}),t.jsx("input",{type:"text",value:o.symbol,onChange:j=>C("symbol",j.target.value),placeholder:"AAPL",style:{width:"100%",backgroundColor:h,border:`1px solid ${x}`,color:d,padding:"4px",fontSize:"8px",borderRadius:"3px"}})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:p,fontSize:"8px",display:"block",marginBottom:"4px"},children:"Period"}),t.jsxs("select",{value:o.period,onChange:j=>C("period",j.target.value),style:{width:"100%",backgroundColor:h,border:`1px solid ${x}`,color:d,padding:"4px",fontSize:"8px",borderRadius:"3px"},children:[t.jsx("option",{value:"1d",children:"1 Day"}),t.jsx("option",{value:"5d",children:"5 Days"}),t.jsx("option",{value:"1mo",children:"1 Month"}),t.jsx("option",{value:"3mo",children:"3 Months"}),t.jsx("option",{value:"6mo",children:"6 Months"}),t.jsx("option",{value:"1y",children:"1 Year"}),t.jsx("option",{value:"2y",children:"2 Years"}),t.jsx("option",{value:"5y",children:"5 Years"}),t.jsx("option",{value:"max",children:"Max"})]})]})]}),o.dataSource==="csv"&&t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:p,fontSize:"8px",display:"block",marginBottom:"4px"},children:"CSV File Path"}),t.jsx("input",{type:"text",value:o.csvPath,onChange:j=>C("csvPath",j.target.value),placeholder:"/path/to/data.csv",style:{width:"100%",backgroundColor:h,border:`1px solid ${x}`,color:d,padding:"4px",fontSize:"8px",borderRadius:"3px"}})]}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("label",{style:{color:p,fontSize:"8px",display:"block",marginBottom:"6px"},children:"Indicator Categories"}),E.map(j=>t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:o.categories.includes(j),onChange:()=>T(j),style:{accentColor:l}}),t.jsx("span",{style:{color:d,fontSize:"8px",textTransform:"capitalize"},children:j})]},j))]}),t.jsx("button",{onClick:j=>{j.stopPropagation(),i(!1)},style:{width:"100%",backgroundColor:l,color:"black",border:"none",padding:"6px",fontSize:"9px",fontWeight:"bold",cursor:"pointer",borderRadius:"3px"},children:"CLOSE"})]}),t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsx("button",{onClick:()=>e.onExecute?.(s),disabled:e.status==="running",style:{flex:1,backgroundColor:e.status==="running"?p:l,color:"black",border:"none",padding:"8px",fontSize:"10px",fontWeight:"bold",cursor:e.status==="running"?"not-allowed":"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",opacity:e.status==="running"?.6:1},children:e.status==="running"?t.jsxs(t.Fragment,{children:[t.jsx(ni,{size:12,className:"animate-spin"}),"RUNNING..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Ms,{size:12}),"CALCULATE"]})}),t.jsx("button",{onClick:()=>i(!n),style:{backgroundColor:n?l:f,border:`1px solid ${x}`,color:n?"black":p,padding:"8px",fontSize:"10px",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(Mn,{size:14})})]}),t.jsx(lo,{type:"source",position:co.Right,style:{background:e.status==="completed"?m:l,width:"12px",height:"12px",border:`2px solid ${f}`,right:"-6px"}})]})},pK=({onLoadWorkflow:s,onViewResults:e,onEditDraft:r})=>{const[n,i]=S.useState([]),[o,a]=S.useState(!0),[l,d]=S.useState("all");S.useEffect(()=>{p()},[]);const p=async()=>{a(!0);try{const C=await Td.listWorkflows();i(C)}catch(C){console.error("[WorkflowManager] Failed to load workflows:",C)}finally{a(!1)}},f=async C=>{if(confirm("Are you sure you want to delete this workflow?"))try{await Td.deleteWorkflow(C),i(T=>T.filter(E=>E.id!==C))}catch(T){console.error("[WorkflowManager] Failed to delete workflow:",T),alert("Failed to delete workflow")}},h=C=>{s(C.nodes,C.edges,C.id,C)},x=C=>{C.status==="draft"?r(C):s(C.nodes,C.edges,C.id,C)},m=C=>{e(C)},b=n.filter(C=>l==="all"?!0:l==="draft"?C.status==="draft":l==="completed"?C.status==="completed":!0),w=C=>{switch(C){case"completed":return t.jsx(Bn,{size:14,color:"#10b981"});case"draft":return t.jsx(ri,{size:14,color:"#f59e0b"});case"error":return t.jsx(Rr,{size:14,color:"#ef4444"});case"running":return t.jsx(uo,{size:14,color:"#3b82f6"});default:return t.jsx(ri,{size:14,color:"#6b7280"})}},y=C=>{switch(C){case"completed":return"#10b981";case"draft":return"#f59e0b";case"error":return"#ef4444";case"running":return"#3b82f6";default:return"#6b7280"}};return t.jsxs("div",{style:{padding:"20px",color:"#a3a3a3",height:"100%",overflow:"auto"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"12px",borderBottom:"2px solid #404040"},children:[t.jsx("h2",{style:{margin:0,fontSize:"20px",color:"#fff",fontWeight:"bold"},children:" Workflow Manager"}),t.jsx("button",{onClick:p,style:{backgroundColor:"#3b82f6",color:"#fff",border:"none",padding:"6px 12px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px"},children:" REFRESH"})]}),t.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"16px",borderBottom:"1px solid #404040",paddingBottom:"8px"},children:["all","draft","completed"].map(C=>t.jsxs("button",{onClick:()=>d(C),style:{backgroundColor:l===C?"#3b82f6":"transparent",color:l===C?"#fff":"#a3a3a3",border:`1px solid ${l===C?"#3b82f6":"#404040"}`,padding:"6px 16px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px",textTransform:"uppercase"},children:[C," (",n.filter(T=>C==="all"||T.status===C).length,")"]},C))}),o&&t.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#6b7280"},children:"Loading workflows..."}),!o&&b.length===0&&t.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#6b7280"},children:[t.jsx(ri,{size:48,style:{margin:"0 auto 16px",opacity:.5}}),t.jsxs("p",{style:{fontSize:"14px",marginBottom:"8px"},children:["No ",l!=="all"?l:""," workflows found"]}),t.jsx("p",{style:{fontSize:"12px",opacity:.7},children:"Create a new workflow in the Editor tab"})]}),!o&&b.length>0&&t.jsx("div",{style:{display:"grid",gap:"12px"},children:b.map(C=>t.jsxs("div",{style:{backgroundColor:"#1a1a1a",border:"1px solid #404040",borderRadius:"6px",padding:"16px",transition:"all 0.2s",cursor:"pointer"},onMouseEnter:T=>{T.currentTarget.style.borderColor="#3b82f6",T.currentTarget.style.backgroundColor="#252525"},onMouseLeave:T=>{T.currentTarget.style.borderColor="#404040",T.currentTarget.style.backgroundColor="#1a1a1a"},children:[t.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[w(C.status),t.jsx("h3",{style:{margin:0,fontSize:"14px",color:"#fff",fontWeight:"bold"},children:C.name}),t.jsx("span",{style:{backgroundColor:y(C.status),color:"#000",padding:"2px 8px",fontSize:"9px",fontWeight:"bold",borderRadius:"3px",textTransform:"uppercase"},children:C.status})]}),C.description&&t.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"11px",color:"#6b7280",lineHeight:"1.4"},children:C.description})]})}),t.jsxs("div",{style:{display:"flex",gap:"16px",marginBottom:"12px",fontSize:"11px",color:"#6b7280"},children:[t.jsxs("span",{children:[" ",C.nodes?.length||0," nodes"]}),t.jsxs("span",{children:[" ",C.edges?.length||0," connections"]}),t.jsxs("span",{style:{marginLeft:"auto",fontSize:"10px"},children:["ID: ",C.id.substring(0,12),"..."]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",paddingTop:"12px",borderTop:"1px solid #404040"},children:[t.jsxs("button",{onClick:T=>{T.stopPropagation(),h(C)},style:{flex:1,backgroundColor:"#10b981",color:"#fff",border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[t.jsx(Ms,{size:12}),"LOAD & RUN"]}),t.jsxs("button",{onClick:T=>{T.stopPropagation(),x(C)},style:{flex:1,backgroundColor:"#3b82f6",color:"#fff",border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[t.jsx(Od,{size:12}),"EDIT"]}),C.results&&t.jsxs("button",{onClick:T=>{T.stopPropagation(),m(C)},style:{backgroundColor:"#f59e0b",color:"#000",border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},children:[t.jsx(vi,{size:12}),"RESULTS"]}),t.jsx("button",{onClick:T=>{T.stopPropagation(),f(C.id)},style:{backgroundColor:"#ef4444",color:"#fff",border:"none",padding:"6px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(On,{size:12})})]})]},C.id))})]})},hK=({data:s,workflowName:e,onClose:r})=>t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:r,children:t.jsxs("div",{style:{background:"#1a1a1a",border:"1px solid #2d2d2d",borderRadius:"8px",padding:"20px",maxWidth:"600px",width:"90%"},onClick:n=>n.stopPropagation(),children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[t.jsxs("h3",{style:{color:"#ea580c"},children:[e," - Results"]}),t.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"#a3a3a3",cursor:"pointer"},children:t.jsx(ln,{size:20})})]}),t.jsx("pre",{style:{background:"#0a0a0a",padding:"12px",borderRadius:"4px",overflow:"auto",maxHeight:"400px",color:"#a3a3a3"},children:JSON.stringify(s,null,2)})]})});class fK{async getAvailableAgents(){try{const e=await lt("list_available_agents");return Zc.info("Loaded agents:",e.length),e}catch(e){return Zc.error("Failed to load agents:",e),[]}}async executeAgent(e,r,n){try{Zc.info(`Executing agent: ${e}`,{parameters:r,inputs:n});const i=await lt("execute_python_agent",{agentType:e,parameters:r,inputs:n});return Zc.info(`Agent ${e} completed:`,i),i}catch(i){return Zc.error(`Agent ${e} failed:`,i),{success:!1,error:i.message||"Unknown error",execution_time_ms:0,agent_type:e}}}async getAgentMetadata(e){try{return await lt("get_agent_metadata",{agentType:e})}catch(r){return Zc.error(`Failed to get metadata for ${e}:`,r),null}}async getAgentsByCategory(e){return(await this.getAvailableAgents()).filter(n=>n.category===e)}async getCategories(){const e=await this.getAvailableAgents(),r=new Set(e.map(n=>n.category));return Array.from(r)}}const Dg=new fK,gK=Object.freeze(Object.defineProperty({__proto__:null,pythonAgentService:Dg},Symbol.toStringTag,{value:"Module"}));class xK{async executeAndSave(e,r,n,i){console.log("[WorkflowExecutor] Executing workflow:",n.name);try{const o=new Map;for(const a of e){i(a.id,"running");try{let l;switch(a.type){case"technical-indicator":l=await this.executeTechnicalIndicatorNode(a,o);break;case"python-agent":l=await this.executePythonAgentNode(a,o);break;case"data-source":l=await this.executeDataSourceNode(a,o);break;default:await new Promise(d=>setTimeout(d,500)),l={message:"Node executed successfully"}}o.set(a.id,l),i(a.id,"completed",l)}catch(l){throw console.error(`[WorkflowExecutor] Error executing node ${a.id}:`,l),i(a.id,"error",{error:String(l)}),l}}return{success:!0,workflowId:`workflow_${Date.now()}`}}catch(o){return{success:!1,error:String(o)}}}async executeTechnicalIndicatorNode(e,r){console.log("[WorkflowExecutor] Executing technical indicator node:",e.id);const{dataSource:n,symbol:i,period:o,csvPath:a,jsonData:l,categories:d}=e.data;try{let p;const f=d&&d.length>0?d.join(","):void 0;switch(n){case"yfinance":p=await lt("calculate_indicators_yfinance",{symbol:i||"AAPL",period:o||"1y",categories:f});break;case"csv":if(!a)throw new Error("CSV file path is required");p=await lt("calculate_indicators_csv",{filepath:a,categories:f});break;case"json":if(!l)throw new Error("JSON data is required");p=await lt("calculate_indicators_json",{jsonData:l,categories:f});break;case"input":const x=e.data.inputEdges||[];if(x.length===0)throw new Error("No input connection found");const m=x[0].source,b=r.get(m);if(!b)throw new Error("No data available from input node");p=await lt("calculate_indicators_json",{jsonData:JSON.stringify(b),categories:f});break;default:throw new Error(`Unknown data source: ${n}`)}const h=JSON.parse(p);if(h.error)throw new Error(h.error);return console.log("[WorkflowExecutor] Technical indicator node completed:",h),h}catch(p){throw console.error("[WorkflowExecutor] Technical indicator node failed:",p),p}}async executePythonAgentNode(e,r){console.log("[WorkflowExecutor] Executing Python agent node:",e.id);try{const{pythonAgentService:n}=await Br(async()=>{const{pythonAgentService:d}=await Promise.resolve().then(()=>gK);return{pythonAgentService:d}},void 0),{agentId:i,parameters:o}=e.data;if(!i)throw new Error("No agent ID specified in node");const a=r.size>0?Object.fromEntries(r):o||{},l=await n.executeAgent(i,o||{},a);return console.log("[WorkflowExecutor] Python agent completed:",l),l}catch(n){throw console.error("[WorkflowExecutor] Python agent failed:",n),n}}async executeDataSourceNode(e,r){console.log("[WorkflowExecutor] Executing data source node:",e.id);try{const{createAdapter:n,hasAdapter:i}=await Br(async()=>{const{createAdapter:h,hasAdapter:x}=await Promise.resolve().then(()=>HO);return{createAdapter:h,hasAdapter:x}},void 0),{sourceType:o,connectionConfig:a,query:l}=e.data;if(!o)throw new Error("No source type specified");if(!i(o))throw new Error(`No adapter available for: ${o}`);const d={id:e.id,name:e.data.label||"Data Source",type:o,category:e.data.category||"database",config:a||{},status:"connected",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},p=n(d);if(!p)throw new Error(`Failed to create adapter for: ${o}`);const f=await p.query(l||{});return console.log("[WorkflowExecutor] Data source completed:",f),f}catch(n){throw console.error("[WorkflowExecutor] Data source failed:",n),n}}async saveDraft(e,r,n,i){console.log("[WorkflowExecutor] Saving draft:",e);const o=await Td.saveDraft(e,r,n,i);return console.log("[WorkflowExecutor] Draft saved with ID:",o),o}}const Sk=new xK;class mK{async mediateAgentOutput(e,r={}){try{Wu.debug("Mediating agent output:",e);const n=this.extractAgentData(e);if(!n)return{success:!1,mediatedContext:"",error:"No valid agent output to mediate"};let i=null;if(r.llmProvider?i=(await Je.getLLMConfigs()).find(p=>p.provider===r.llmProvider)||null:i=await Je.getActiveLLMConfig(),!i)return{success:!1,mediatedContext:"",error:"No LLM provider configured. Please configure LLM settings."};const a=`${r.mediationPrompt||this.getDefaultMediationPrompt()}

Previous Agent Analysis:
${JSON.stringify(n,null,2)}`,l=await Pp.chat(a,[],void 0);return l.error?{success:!1,mediatedContext:"",error:l.error}:(Wu.debug("Mediation successful:",l.content),{success:!0,mediatedContext:l.content,llmProvider:i.provider,llmModel:i.model})}catch(n){return Wu.error("Mediation error:",n),{success:!1,mediatedContext:"",error:n instanceof Error?n.message:"Unknown mediation error"}}}extractAgentData(e){if(!e)return null;if(e.success!==void 0&&e.data!==void 0)return this.extractAgentData(e.data);if(e.analysis)return e.analysis;if(typeof e=="object"){const r=Object.keys(e)[0];if(r&&e[r]?.signal&&e[r]?.reasoning)return e}return e}getDefaultMediationPrompt(){return`You are mediating between financial analysis agents.

Your task is to:
1. Summarize the key findings from the previous agent's analysis
2. Extract the most important signals, metrics, and reasoning
3. Format this information as clear, actionable context for the next agent to consider
4. Maintain objectivity - don't add your own investment opinions, just synthesize the data

Be concise but comprehensive. Focus on facts, signals, and metrics that would be valuable for subsequent analysis.`}async synthesizeMultipleAgents(e,r){try{if(Wu.debug("Synthesizing multiple agent outputs:",e.length),e.length===0)return{success:!1,mediatedContext:"",error:"No agent outputs to synthesize"};const n=e.map(({agentName:d,output:p})=>({agent:d,analysis:this.extractAgentData(p)})),i=await Je.getActiveLLMConfig();if(!i)return{success:!1,mediatedContext:"",error:"No LLM provider configured"};const a=`${r||`You are synthesizing insights from multiple financial analysis agents.

Your task is to:
1. Compare and contrast the findings from all agents
2. Identify areas of consensus and disagreement
3. Highlight the most significant insights from each perspective
4. Provide a balanced, comprehensive summary that incorporates all viewpoints

Be objective and data-driven. Present a holistic view that respects each agent's methodology.`}

Agent Analyses:
${JSON.stringify(n,null,2)}`,l=await Pp.chat(a,[],void 0);return l.error?{success:!1,mediatedContext:"",error:l.error}:{success:!0,mediatedContext:l.content,llmProvider:i.provider,llmModel:i.model}}catch(n){return Wu.error("Synthesis error:",n),{success:!1,mediatedContext:"",error:n instanceof Error?n.message:"Unknown synthesis error"}}}}const wk=new mK;class yK{topologicalSort(e,r){const n=new Map,i=new Map;e.forEach(l=>{n.set(l.id,[]),i.set(l.id,0)}),r.forEach(l=>{n.get(l.source)?.push(l.target),i.set(l.target,(i.get(l.target)||0)+1)});const o=[];e.forEach(l=>{i.get(l.id)===0&&o.push(l)});const a=[];for(;o.length>0;){const l=o.shift();a.push(l),(n.get(l.id)||[]).forEach(p=>{const f=(i.get(p)||0)-1;if(i.set(p,f),f===0){const h=e.find(x=>x.id===p);h&&o.push(h)}})}if(a.length!==e.length)throw new Error("Workflow contains cycles - cannot execute");return a}getNodeInputs(e,r,n){const i={},o=r.filter(a=>a.target===e.id);if(e.type==="agent-mediator"&&o.length>1){const a=[];for(const l of o){const d=n.get(l.source);n.get(`${l.source}_node`),d!==void 0&&a.push({agentName:d.agent||`Agent ${l.source}`,output:d})}return{multipleAgents:a}}for(const a of o){const l=n.get(a.source);l!==void 0&&(a.targetHandle?i[a.targetHandle]=l:typeof l=="object"&&!Array.isArray(l)?Object.assign(i,l):i.data=l)}return i}async executeNode(e,r){try{switch(e.type){case"python-agent":return await this.executePythonAgent(e,r);case"mcp-tool":return await this.executeMCPTool(e,r);case"agent-mediator":return await this.executeAgentMediator(e,r);case"data-source":return await this.executeDataSource(e);case"transformation":return await this.executeTransformation(e,r);case"results-display":return await this.executeResultsDisplay(e,r);case"custom":return{nodeId:e.id,success:!0,data:r};default:return Xn.warn(`Unknown node type: ${e.type}, skipping execution`),{nodeId:e.id,success:!0,data:r}}}catch(n){return{nodeId:e.id,success:!1,error:n.message||"Unknown error"}}}async executePythonAgent(e,r){const{agentType:n,parameters:i}=e.data,o=await Dg.executeAgent(n,i,r);return{nodeId:e.id,success:o.success,data:o.data,error:o.error,execution_time_ms:o.execution_time_ms}}async executeMCPTool(e,r){const{serverId:n,toolName:i,parameters:o}=e.data,a={...o,...r},l=await Cd.executeToolDirect(n,i,a);return{nodeId:e.id,success:l.success,data:l.data,error:l.error,execution_time_ms:l.executionTime}}async executeDataSource(e){const{sourceType:r,connectionConfig:n,query:i}=e.data,o=performance.now();try{const{createAdapter:a,hasAdapter:l}=await Br(async()=>{const{createAdapter:x,hasAdapter:m}=await Promise.resolve().then(()=>HO);return{createAdapter:x,hasAdapter:m}},void 0);if(!r||!l(r))return{nodeId:e.id,success:!1,error:`No adapter available for data source type: ${r||"unknown"}`};const d={id:e.id,name:e.data.label||"Data Source",type:r,category:e.data.category||"database",config:n||{},status:"connected",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},p=a(d);if(!p)return{nodeId:e.id,success:!1,error:`Failed to create adapter for type: ${r}`};const f=await p.query(i||{}),h=Math.round(performance.now()-o);return Xn.info(`Data source executed: ${r}`,{executionTime:h}),{nodeId:e.id,success:!0,data:f,execution_time_ms:h}}catch(a){const l=Math.round(performance.now()-o);return Xn.error("Data source execution failed:",a),{nodeId:e.id,success:!1,error:a instanceof Error?a.message:"Data source execution failed",execution_time_ms:l}}}async executeTransformation(e,r){const{transformType:n,transformConfig:i}=e.data,o=performance.now();try{let a=Object.values(r)[0];if(!a)return{nodeId:e.id,success:!1,error:"No input data for transformation"};let l;switch(n){case"filter":if(Array.isArray(a)){const{field:f,operator:h,value:x}=i||{};l=a.filter(m=>{const b=m[f];switch(h){case"eq":return b===x;case"ne":return b!==x;case"gt":return b>x;case"lt":return b<x;case"gte":return b>=x;case"lte":return b<=x;case"contains":return String(b).includes(x);default:return!0}})}else l=a;break;case"map":if(Array.isArray(a)){const{fields:f}=i||{};f&&Array.isArray(f)?l=a.map(h=>{const x={};return f.forEach(m=>{h[m]!==void 0&&(x[m]=h[m])}),x}):l=a}else l=a;break;case"aggregate":if(Array.isArray(a)){const{operation:f,field:h}=i||{},x=a.map(m=>Number(m[h])||0);switch(f){case"sum":l=x.reduce((m,b)=>m+b,0);break;case"avg":l=x.length?x.reduce((m,b)=>m+b,0)/x.length:0;break;case"min":l=Math.min(...x);break;case"max":l=Math.max(...x);break;case"count":l=x.length;break;default:l=a}}else l=a;break;case"select":const{selectFields:p}=i||{};p&&Array.isArray(p)?Array.isArray(a)?l=a.map(f=>{const h={};return p.forEach(x=>{h[x]=f[x]}),h}):typeof a=="object"?(l={},p.forEach(f=>{l[f]=a[f]})):l=a:l=a;break;default:l=a}const d=Math.round(performance.now()-o);return Xn.info(`Transformation executed: ${n||"passthrough"}`,{executionTime:d}),{nodeId:e.id,success:!0,data:l,execution_time_ms:d}}catch(a){const l=Math.round(performance.now()-o);return Xn.error("Transformation failed:",a),{nodeId:e.id,success:!1,error:a instanceof Error?a.message:"Transformation failed",execution_time_ms:l}}}async executeAgentMediator(e,r){const{selectedProvider:n,customPrompt:i}=e.data;if(Xn.info("Agent mediator executing with inputs:",r),r.multipleAgents&&Array.isArray(r.multipleAgents)){Xn.info("Synthesizing multiple agents: "+r.multipleAgents.length);const a=await wk.synthesizeMultipleAgents(r.multipleAgents,i);return a.success?{nodeId:e.id,success:!0,data:{mediated_analysis:a.mediatedContext,source_agents:r.multipleAgents.map(l=>l.agentName),llm_provider:a.llmProvider,llm_model:a.llmModel}}:{nodeId:e.id,success:!1,error:a.error||"Multi-agent synthesis failed"}}const o=await wk.mediateAgentOutput(r,{llmProvider:n,mediationPrompt:i});return o.success?{nodeId:e.id,success:!0,data:{mediated_analysis:o.mediatedContext,source_agent:r.agent||"unknown",llm_provider:o.llmProvider,llm_model:o.llmModel}}:{nodeId:e.id,success:!1,error:o.error||"Agent mediation failed"}}async executeResultsDisplay(e,r){Xn.debug("========================================"),Xn.debug("Results Display Node Execution"),Xn.debug("Node ID:",e.id),Xn.debug("Raw inputs:",r),Xn.debug("Input keys:",Object.keys(r)),Xn.debug("Input type:",typeof r),Xn.debug("========================================");let n=r;return r.success!==void 0&&r.data!==void 0&&(n=r.data,Xn.debug("Unwrapped data from success wrapper")),Xn.debug("Final display data:",n),{nodeId:e.id,success:!0,data:n}}async executeWorkflow(e,r,n){const i=this.topologicalSort(e,r),o=new Map;Xn.info("Executing workflow with nodes:",i.map(a=>a.id));for(const a of i){Xn.info(`Executing node: ${a.id} (${a.type})`),n(a.id,"running");const l=this.getNodeInputs(a,r,o);Xn.debug(`Node ${a.id} inputs:`,l);const d=await this.executeNode(a,l);if(Xn.debug(`Node ${a.id} result:`,d),o.set(a.id,d.data),d.success)n(a.id,"completed",d.data);else throw n(a.id,"error",d.error),new Error(`Node ${a.id} failed: ${d.error}`)}return Xn.info("Workflow completed successfully"),o}}const bK=new yK,vK=({data:s,id:e,selected:r})=>{const[n,i]=S.useState(!1),[o,a]=S.useState(s.label),l=()=>{s.onLabelChange(e,o),i(!1)},d=()=>{switch(s.nodeType){case"data-source":return t.jsx(js,{size:16});case"transformation":return t.jsx(si,{size:16});case"analysis":return t.jsx(Nr,{size:16});case"visualization":return t.jsx(ja,{size:16});case"agent":return t.jsx(qo,{size:16});case"output":return t.jsx(ri,{size:16});default:return t.jsx(js,{size:16})}};return t.jsxs("div",{style:{background:r?"#2d2d2d":"#1a1a1a",border:`2px solid ${r?s.color:`${s.color}80`}`,borderRadius:"6px",minWidth:"180px",boxShadow:r?`0 0 20px ${s.color}60, 0 4px 12px rgba(0,0,0,0.5)`:"0 2px 8px rgba(0,0,0,0.3)",transition:"all 0.2s"},children:[s.hasInput&&t.jsx(lo,{type:"target",position:co.Left,style:{background:s.color,width:12,height:12,border:"2px solid #1a1a1a",boxShadow:`0 0 8px ${s.color}`}}),t.jsxs("div",{style:{background:`${s.color}20`,borderBottom:`1px solid ${s.color}40`,padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",color:s.color,borderTopLeftRadius:"4px",borderTopRightRadius:"4px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[d(),n?t.jsx("input",{type:"text",value:o,onChange:p=>a(p.target.value),onBlur:l,onKeyDown:p=>{p.key==="Enter"&&l(),p.key==="Escape"&&(a(s.label),i(!1))},autoFocus:!0,style:{background:"colors.panel",border:`1px solid ${s.color}`,color:s.color,fontSize:"11px",padding:"2px 6px",borderRadius:"3px",outline:"none",fontWeight:"bold",width:"120px"}}):t.jsx("span",{style:{fontSize:"11px",fontWeight:"bold",letterSpacing:"0.3px"},children:s.label.toUpperCase()})]}),!n&&t.jsx("button",{onClick:()=>i(!0),style:{background:"transparent",border:"none",color:s.color,cursor:"pointer",padding:"2px",display:"flex",alignItems:"center"},title:"Edit label",children:t.jsx(Od,{size:12})})]}),t.jsxs("div",{style:{padding:"12px",display:"flex",flexDirection:"column",gap:"4px",color:"#a3a3a3",fontSize:"10px"},children:[t.jsxs("div",{children:["Type: ",s.nodeType]}),t.jsxs("div",{children:["Status: ",s.status||"Ready"]}),t.jsxs("div",{style:{color:"#737373"},children:["ID: ",e.substring(0,8)]})]}),s.hasOutput&&t.jsx(lo,{type:"source",position:co.Right,style:{background:s.color,width:12,height:12,border:"2px solid #1a1a1a",boxShadow:`0 0 8px ${s.color}`}})]})},SK=[{type:"data-source",label:"Data Source",color:"#3b82f6",category:"Input",hasInput:!1,hasOutput:!0},{type:"technical-indicator",label:"Technical Indicators",color:"#10b981",category:"Processing",hasInput:!0,hasOutput:!0},{type:"agent-mediator",label:"Agent Mediator",color:"#3b82f6",category:"Processing",hasInput:!0,hasOutput:!0},{type:"results-display",label:"Results Display",color:"#f59e0b",category:"Output",hasInput:!0,hasOutput:!1}];function wK(){const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),[o,a]=S.useState([]),[l,d]=S.useState([]),p=S.useCallback(()=>{try{const K=localStorage.getItem("nodeEditorWorkflow");if(K){const Ee=JSON.parse(K);return console.log("[NodeEditor] Loaded saved workflow:",Ee.nodes.length,"nodes"),Ee}}catch(K){console.error("[NodeEditor] Failed to load saved workflow:",K)}return{nodes:[],edges:[]}},[]),[f,h,x]=ZI(p().nodes),[m,b,w]=eP(p().edges);S.useEffect(()=>{const Ee=setTimeout(()=>{try{const Oe={nodes:f,edges:m};localStorage.setItem("nodeEditorWorkflow",JSON.stringify(Oe)),console.log("[NodeEditor] Auto-saved workflow:",f.length,"nodes,",m.length,"edges")}catch(Oe){console.error("[NodeEditor] Failed to save workflow:",Oe)}},500);return()=>clearTimeout(Ee)},[f,m]),S.useEffect(()=>{const K=async()=>{try{const Oe=await iK();a(Oe),console.log("[NodeEditor] Loaded MCP node configs:",Oe.length)}catch(Oe){console.error("[NodeEditor] Failed to load MCP configs:",Oe)}},Ee=async()=>{try{const Oe=await Dg.getAvailableAgents();d(Oe),console.log("[NodeEditor] Loaded Python agents:",Oe.length)}catch(Oe){console.error("[NodeEditor] Failed to load agents:",Oe)}};K(),Ee()},[]);const[y,C]=S.useState([]),[T,E]=S.useState(!1),[j,k]=S.useState("editor"),[A,R]=S.useState(!1),[M,P]=S.useState(""),[I,O]=S.useState(""),[G,B]=S.useState(null),[F,z]=S.useState(!1),[$,W]=S.useState("new"),[D,oe]=S.useState(null),[Z,fe]=S.useState(!1),[Q,_]=S.useState(null),[Y,he]=S.useState(""),me=S.useMemo(()=>({custom:vK,"mcp-tool":sK,"python-agent":aK,"results-display":lK,"agent-mediator":cK,"data-source":dK,"technical-indicator":uK}),[]);function ge(K,Ee){h(Oe=>Oe.map(q=>q.id===K?{...q,data:{...q.data,label:Ee}}:q))}const le=S.useCallback(K=>{const Ee={...K,animated:!0,style:{stroke:"#ea580c",strokeWidth:2},markerEnd:{type:tP.ArrowClosed,color:"#ea580c"}};b(Oe=>rP(Ee,Oe))},[b]),X=K=>{const Ee=K.type==="mcp-tool",Oe=K.type==="python-agent",q=K.type==="results-display",ee=K.type==="agent-mediator",ce=K.type==="data-source",Ce=K.type==="technical-indicator",be={id:`node_${Date.now()}`,type:Oe?"python-agent":Ee?"mcp-tool":q?"results-display":ee?"agent-mediator":ce?"data-source":Ce?"technical-indicator":"custom",position:{x:Math.random()*400+100,y:Math.random()*300+100},data:Oe?{agentType:K.id,agentCategory:K.category,label:K.name,icon:K.icon,color:K.color,parameters:K.parameters.reduce((We,J)=>(J.default_value!==null&&J.default_value!==void 0&&(We[J.name]=J.default_value),We),{}),selectedLLM:"active",status:"idle",onExecute:async We=>{console.log("[NodeEditor] Executing single Python agent node:",K.id);try{h(se=>se.map(Te=>Te.id===We?{...Te,data:{...Te.data,status:"running"}}:Te));const J=await Dg.executeAgent(K.id,K.parameters.reduce((se,Te)=>(Te.default_value!==null&&Te.default_value!==void 0&&(se[Te.name]=Te.default_value),se),{}),{});h(se=>se.map(Te=>Te.id===We?{...Te,data:{...Te.data,status:J.success?"completed":"error",result:J.success?J.data:void 0,error:J.success?void 0:J.error}}:Te))}catch(J){h(se=>se.map(Te=>Te.id===We?{...Te,data:{...Te.data,status:"error",error:J.message}}:Te))}},onParameterChange:We=>{console.log("[NodeEditor] Agent parameters changed:",We)},onLLMChange:We=>{h(J=>J.map(se=>se.id===be.id?{...se,data:{...se.data,selectedLLM:We}}:se))}}:Ee?{serverId:K.serverId,toolName:K.toolName,label:K.label,parameters:{},onParameterChange:We=>{console.log("[NodeEditor] MCP tool parameters changed:",We)},onExecute:We=>{console.log("[NodeEditor] MCP tool executed with result:",We)}}:q?{label:K.label,color:K.color,inputData:void 0}:ee?{label:K.label,selectedProvider:void 0,customPrompt:void 0,status:"idle",result:void 0,error:void 0,inputData:void 0,onExecute:We=>{console.log("[NodeEditor] Agent mediator execute clicked:",We)},onConfigChange:We=>{h(J=>J.map(se=>se.id===be.id?{...se,data:{...se.data,selectedProvider:We.selectedProvider,customPrompt:We.customPrompt}}:se))}}:ce?{label:K.label,selectedConnectionId:void 0,query:"",status:"idle",result:void 0,error:void 0,onConnectionChange:We=>{h(J=>J.map(se=>se.id===be.id?{...se,data:{...se.data,selectedConnectionId:We}}:se))},onQueryChange:We=>{h(J=>J.map(se=>se.id===be.id?{...se,data:{...se.data,query:We}}:se))},onExecute:async()=>{console.log("[NodeEditor] Data source node execute clicked")}}:Ce?{label:K.label,dataSource:"yfinance",symbol:"AAPL",period:"1y",csvPath:"",jsonData:"",categories:["momentum","volume","volatility","trend","others"],status:"idle",result:void 0,error:void 0,onExecute:We=>{console.log("[NodeEditor] Technical indicator node execute clicked:",We)},onParameterChange:We=>{h(J=>J.map(se=>se.id===be.id?{...se,data:{...se.data,...We}}:se))}}:{label:K.label,nodeType:K.type,color:K.color,hasInput:K.hasInput,hasOutput:K.hasOutput,onLabelChange:ge}};h(We=>[...We,be]),E(!1)},V=S.useCallback(()=>{y.length>0&&(h(K=>K.filter(Ee=>!y.includes(Ee.id))),b(K=>K.filter(Ee=>!y.includes(Ee.source)&&!y.includes(Ee.target))),C([]))},[y,h,b]),de=S.useCallback(K=>{C(K.nodes.map(Ee=>Ee.id))},[]),je=S.useCallback(()=>{b(K=>K.filter(Ee=>!Ee.selected))},[b]),_e=S.useCallback(K=>{(K.key==="Delete"||K.key==="Backspace")&&(V(),je())},[V,je]);S.useEffect(()=>(window.addEventListener("keydown",_e),()=>{window.removeEventListener("keydown",_e)}),[_e]);const Re=S.useCallback(()=>{try{const K={nodes:f,edges:m};localStorage.setItem("nodeEditorWorkflow",JSON.stringify(K)),console.log("[NodeEditor] Manually saved workflow:",f.length,"nodes,",m.length,"edges")}catch(K){console.error("[NodeEditor] Failed to save workflow:",K)}},[f,m]),Be=S.useCallback(()=>{const Ee=JSON.stringify({nodes:f,edges:m},null,2),Oe=`data:application/json;charset=utf-8,${encodeURIComponent(Ee)}`,q=`workflow_${Date.now()}.json`,ee=document.createElement("a");ee.setAttribute("href",Oe),ee.setAttribute("download",q),ee.click()},[f,m]),Se=S.useCallback(()=>{const K=document.createElement("input");K.type="file",K.accept=".json",K.onchange=Ee=>{const Oe=Ee.target.files[0];if(Oe){const q=new FileReader;q.onload=ee=>{try{const ce=JSON.parse(ee.target.result);h(ce.nodes||[]),b(ce.edges||[]),console.log("[NodeEditor] Imported workflow:",ce.nodes?.length||0,"nodes")}catch(ce){console.error("[NodeEditor] Failed to import workflow:",ce)}},q.readAsText(Oe)}},K.click()},[h,b]),ie=S.useCallback(()=>{h([]),b([]),localStorage.removeItem("nodeEditorWorkflow"),W("new"),oe(null),B(null),P(""),O(""),console.log("[NodeEditor] Cleared workflow and reset to new mode")},[h,b]),ve=S.useCallback(async()=>{if(!M.trim()){alert("Please enter a workflow name");return}if(F){alert("A workflow is already executing. Please wait for it to complete.");return}const K=M,Ee=I,Oe=f,q=m;R(!1),P(""),O(""),B(null),k("editor"),z(!0),setTimeout(async()=>{try{const ee=await Sk.executeAndSave(Oe,q,{name:K,description:Ee,saveAsDraft:!1},(ce,Ce,be)=>{h(We=>We.map(J=>J.id===ce?J.type==="results-display"?{...J,data:{...J.data,inputData:Ce==="completed"?be:void 0,status:Ce}}:{...J,data:{...J.data,status:Ce,result:Ce==="completed"?be:void 0,error:Ce==="error"?be:void 0}}:J))});ee.success?(console.log("[NodeEditor] Workflow deployed successfully:",ee.workflowId),h([]),b([]),localStorage.removeItem("nodeEditorWorkflow"),oe(null),W("new"),B(null),console.log("[NodeEditor] Canvas cleared, ready for new workflow")):(console.error("[NodeEditor] Deployment failed:",ee.error),alert(`Deployment failed: ${ee.error}`))}catch(ee){console.error("[NodeEditor] Deploy failed:",ee),alert(`Deployment failed: ${ee.message}`)}finally{z(!1)}},0)},[f,m,M,I,F,h]),Ae=S.useCallback(async()=>{if(!M.trim()){alert("Please enter a workflow name");return}try{let K;G?(await Td.updateDraft(G,M,I,f,m),console.log("[NodeEditor] Draft updated:",G),K=G,B(null)):(K=await Sk.saveDraft(M,I,f,m),console.log("[NodeEditor] Draft saved:",K)),oe(K),W("draft"),R(!1),P(""),O(""),k("workflows")}catch(K){console.error("[NodeEditor] Save draft failed:",K),alert(`Save failed: ${K.message}`)}},[f,m,M,I,G]),$e=S.useCallback((K,Ee,Oe,q)=>{h(K),b(Ee),oe(Oe),W(q.status==="draft"?"draft":"deployed"),k("editor"),console.log("[NodeEditor] Loaded workflow:",K.length,"nodes","Mode:",q.status)},[h,b]),qe=S.useCallback(K=>{console.log("[NodeEditor] Viewing results for workflow:",K.id),window.confirm(`View results for: ${K.name}

Click OK to view in modal window
Click Cancel to navigate to workflow editor with results`)?(_(K.results),he(K.name),fe(!0)):(h(K.nodes),b(K.edges),oe(K.id),W("deployed"),k("editor"))},[h,b]),Ie=S.useCallback(K=>{console.log("[NodeEditor] Editing draft:",K.id),h(K.nodes),b(K.edges),P(K.name),O(K.description||""),B(K.id),oe(K.id),W("draft"),R(!0),k("editor")},[h,b]);return t.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"colors.panel",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:"#1a1a1a",borderBottom:"1px solid #2d2d2d",padding:"8px 12px",display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:"#ea580c",fontSize:"12px",fontWeight:"bold",letterSpacing:"0.5px"},children:"NODE EDITOR"}),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsx("button",{onClick:()=>k("editor"),style:{backgroundColor:j==="editor"?"#ea580c":"transparent",color:j==="editor"?"white":"#a3a3a3",border:j==="editor"?"none":"1px solid #404040",padding:"4px 10px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:"EDITOR"}),t.jsx("button",{onClick:()=>k("workflows"),style:{backgroundColor:j==="workflows"?"#ea580c":"transparent",color:j==="workflows"?"white":"#a3a3a3",border:j==="workflows"?"none":"1px solid #404040",padding:"4px 10px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:"WORKFLOWS"})]}),j==="editor"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>E(!T),style:{backgroundColor:"#ea580c",color:"white",border:"none",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"bold"},onMouseEnter:K=>K.currentTarget.style.backgroundColor="#dc2626",onMouseLeave:K=>K.currentTarget.style.backgroundColor="#ea580c",children:[t.jsx(wn,{size:14}),"ADD NODE"]}),t.jsxs("button",{onClick:async()=>{if(F){alert("A workflow is already executing. Please wait for it to complete.");return}try{z(!0),console.log("[NodeEditor] Starting workflow execution..."),await bK.executeWorkflow(f,m,(K,Ee,Oe)=>{console.log(`[NodeEditor] Node ${K} status: ${Ee}`,Oe),h(q=>q.map(ee=>{if(ee.id===K){if(ee.type==="results-display"){console.log("[NodeEditor] Updating results-display node:",K,"with data:",Oe),console.log("[NodeEditor] Status:",Ee);const ce=ee.data;return{...ee,data:{...ee.data,inputData:Ee==="completed"?Oe:Ee==="error"?void 0:ce.inputData,status:Ee}}}return{...ee,data:{...ee.data,status:Ee,result:Ee==="completed"?Oe:void 0,error:Ee==="error"?Oe:void 0}}}return ee}))}),console.log("[NodeEditor] Workflow execution completed")}catch(K){console.error("[NodeEditor] Workflow execution failed:",K)}finally{z(!1)}},disabled:F,style:{backgroundColor:"transparent",color:F?"#737373":"#10b981",border:`1px solid ${F?"#737373":"#10b981"}`,padding:"6px 12px",fontSize:"11px",cursor:F?"not-allowed":"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",opacity:F?.5:1},onMouseEnter:K=>{F||(K.currentTarget.style.backgroundColor="#10b981",K.currentTarget.style.color="white")},onMouseLeave:K=>{F||(K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#10b981")},children:[t.jsx(Ms,{size:14}),F?"EXECUTING...":"EXECUTE"]}),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsxs("button",{onClick:()=>{window.confirm("Start a new workflow? Current work will be cleared unless saved.")&&ie()},style:{backgroundColor:"transparent",color:"#3b82f6",border:"1px solid #3b82f6",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"bold"},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#3b82f6",K.currentTarget.style.color="white"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#3b82f6"},title:"Start a new workflow",children:[t.jsx(wn,{size:14}),"NEW"]}),$==="draft"&&G&&t.jsxs("button",{onClick:async()=>{try{await Td.updateDraft(G,M||"Untitled Draft",I,f,m),alert("Draft saved successfully!")}catch(K){alert(`Save failed: ${K.message}`)}},style:{backgroundColor:"#f59e0b",color:"white",border:"none",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"bold"},title:"Quick save current draft",children:[t.jsx(ao,{size:14}),"SAVE DRAFT"]}),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsxs("button",{onClick:Re,style:{backgroundColor:"transparent",color:"#a3a3a3",border:"1px solid #404040",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#2d2d2d",K.currentTarget.style.color="white"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#a3a3a3"},title:"Save workflow to browser storage",children:[t.jsx(ao,{size:14}),"SAVE"]}),t.jsxs("button",{onClick:Se,style:{backgroundColor:"transparent",color:"#a3a3a3",border:"1px solid #404040",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#2d2d2d",K.currentTarget.style.color="white"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#a3a3a3"},title:"Import workflow from file",children:[t.jsx(qT,{size:14}),"IMPORT"]}),t.jsxs("button",{onClick:Be,style:{backgroundColor:"transparent",color:"#a3a3a3",border:"1px solid #404040",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#2d2d2d",K.currentTarget.style.color="white"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#a3a3a3"},children:[t.jsx(Mi,{size:14}),"EXPORT"]}),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsxs("button",{onClick:()=>{window.confirm("Are you sure you want to clear all nodes? This cannot be undone.")&&ie()},style:{backgroundColor:"transparent",color:"#ef4444",border:"1px solid #ef4444",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#ef4444",K.currentTarget.style.color="white"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#ef4444"},title:"Clear all nodes and connections",children:[t.jsx(On,{size:14}),"CLEAR ALL"]}),y.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsxs("button",{onClick:V,style:{backgroundColor:"transparent",color:"#ef4444",border:"1px solid #ef4444",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#ef4444",K.currentTarget.style.color="white"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#ef4444"},children:[t.jsx(On,{size:14}),"DELETE (",y.length,")"]})]}),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsxs("button",{onClick:()=>R(!0),style:{backgroundColor:"transparent",color:"#3b82f6",border:"1px solid #3b82f6",padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"bold"},onMouseEnter:K=>{K.currentTarget.style.backgroundColor="#3b82f6",K.currentTarget.style.color="white"},onMouseLeave:K=>{K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#3b82f6"},title:"Deploy workflow to database",children:[t.jsx(H0,{size:14}),"DEPLOY"]}),t.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"12px"},children:[t.jsxs("span",{style:{color:"#737373",fontSize:"10px"},children:["NODES: ",f.length]}),t.jsxs("span",{style:{color:"#737373",fontSize:"10px"},children:["CONNECTIONS: ",m.length]})]})]})]}),T&&t.jsxs("div",{style:{position:"absolute",top:"60px",left:"12px",backgroundColor:"#1a1a1a",border:"1px solid #2d2d2d",borderRadius:"4px",padding:"12px",zIndex:1e3,minWidth:"250px",maxHeight:"400px",overflow:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.5)"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[t.jsx("div",{style:{color:"#a3a3a3",fontSize:"11px",fontWeight:"bold",letterSpacing:"0.5px"},children:"SELECT NODE TYPE"}),t.jsx("button",{onClick:()=>E(!1),style:{background:"transparent",border:"none",color:"#a3a3a3",cursor:"pointer",padding:"2px"},children:t.jsx(ln,{size:16})})]}),["Input","Processing","Output"].map(K=>t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{color:"#737373",fontSize:"10px",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px"},children:K}),SK.filter(Ee=>Ee.category===K).map(Ee=>t.jsxs("button",{onClick:()=>X(Ee),style:{backgroundColor:"colors.panel",color:Ee.color,border:`1px solid ${Ee.color}40`,padding:"8px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"8px",width:"100%",marginBottom:"6px"},onMouseEnter:Oe=>{Oe.currentTarget.style.backgroundColor=`${Ee.color}20`,Oe.currentTarget.style.borderColor=Ee.color},onMouseLeave:Oe=>{Oe.currentTarget.style.backgroundColor="colors.panel",Oe.currentTarget.style.borderColor=`${Ee.color}40`},children:[Ee.type==="data-source"&&t.jsx(js,{size:16}),Ee.type==="transformation"&&t.jsx(si,{size:16}),Ee.type==="analysis"&&t.jsx(Nr,{size:16}),Ee.type==="results-display"&&t.jsx(mB,{size:16}),Ee.type==="visualization"&&t.jsx(ja,{size:16}),Ee.type==="agent"&&t.jsx(qo,{size:16}),Ee.type==="output"&&t.jsx(ri,{size:16}),Ee.label]},Ee.type))]},K)),o.length>0&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{color:"colors.primary",fontSize:"10px",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"bold"},children:[" MCP TOOLS (",o.length,")"]}),o.map(K=>t.jsxs("button",{onClick:()=>X(K),style:{backgroundColor:"colors.panel",color:"colors.primary",border:"1px solid colors.primary40",padding:"8px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"8px",width:"100%",marginBottom:"6px"},onMouseEnter:Ee=>{Ee.currentTarget.style.backgroundColor="colors.primary20",Ee.currentTarget.style.borderColor="colors.primary"},onMouseLeave:Ee=>{Ee.currentTarget.style.backgroundColor="colors.panel",Ee.currentTarget.style.borderColor="colors.primary40"},children:[t.jsx("span",{style:{fontSize:"14px"},children:K.icon}),t.jsxs("div",{style:{flex:1,textAlign:"left"},children:[t.jsx("div",{children:K.label}),t.jsx("div",{style:{fontSize:"9px",color:"colors.textMuted"},children:K.serverId})]})]},K.id))]}),l.length>0&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{color:"#22c55e",fontSize:"10px",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"bold"},children:[" PYTHON AGENTS (",l.length,")"]}),["trader","hedge-fund","economic","geopolitics"].map(K=>{const Ee=l.filter(Oe=>Oe.category===K);return Ee.length===0?null:t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("div",{style:{color:"#737373",fontSize:"9px",marginBottom:"4px",paddingLeft:"4px"},children:K.toUpperCase()}),Ee.map(Oe=>t.jsxs("button",{onClick:()=>X({...Oe,type:"python-agent"}),style:{backgroundColor:"colors.panel",color:Oe.color,border:`1px solid ${Oe.color}40`,padding:"8px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"8px",width:"100%",marginBottom:"6px"},onMouseEnter:q=>{q.currentTarget.style.backgroundColor=`${Oe.color}20`,q.currentTarget.style.borderColor=Oe.color},onMouseLeave:q=>{q.currentTarget.style.backgroundColor="colors.panel",q.currentTarget.style.borderColor=`${Oe.color}40`},children:[t.jsx("span",{style:{fontSize:"14px"},children:Oe.icon}),t.jsxs("div",{style:{flex:1,textAlign:"left"},children:[t.jsx("div",{children:Oe.name}),t.jsxs("div",{style:{fontSize:"9px",color:"#737373"},children:[Oe.description.substring(0,40),"..."]})]})]},Oe.id))]},K)})]})]}),j==="editor"?t.jsx(t.Fragment,{children:t.jsx("div",{style:{flex:1,position:"relative"},children:t.jsxs(nP,{nodes:f,edges:m,onNodesChange:x,onEdgesChange:w,onConnect:le,onSelectionChange:de,nodeTypes:me,fitView:!0,style:{background:"colors.panel"},defaultEdgeOptions:{animated:!0,style:{stroke:"#ea580c",strokeWidth:2}},children:[t.jsx(sP,{color:"#2d2d2d",gap:20,size:1,style:{backgroundColor:"colors.panel"}}),t.jsx(iP,{style:{backgroundColor:"#1a1a1a",border:"1px solid #2d2d2d",borderRadius:"4px"}}),t.jsx(oP,{style:{backgroundColor:"#1a1a1a",border:"1px solid #2d2d2d"},nodeColor:K=>K.data.color||"#3b82f6"})]})})}):t.jsx("div",{style:{flex:1,overflow:"hidden"},children:t.jsx(pK,{onLoadWorkflow:$e,onViewResults:qe,onEditDraft:Ie})}),j==="editor"&&t.jsxs("div",{style:{backgroundColor:"#1a1a1a",borderTop:"1px solid #2d2d2d",padding:"6px 12px",display:"flex",alignItems:"center",gap:"16px",fontSize:"10px",color:"#737373",flexShrink:0},children:[t.jsx("span",{children:" Drag nodes to move | Drag from handles to connect | Select & Delete to remove"}),y.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{width:"1px",height:"14px",backgroundColor:"#404040"}}),t.jsxs("span",{style:{color:"#ea580c"},children:["Selected: ",y.length," node(s)"]})]}),t.jsx("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"12px"},children:t.jsx("span",{children:"Scroll to zoom | Right-click drag to pan"})})]}),A&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},onClick:()=>R(!1),children:t.jsxs("div",{style:{backgroundColor:"#1a1a1a",border:"1px solid #2d2d2d",borderRadius:"6px",padding:"24px",minWidth:"400px",maxWidth:"500px"},onClick:K=>K.stopPropagation(),children:[t.jsxs("div",{style:{color:"#ea580c",fontSize:"14px",fontWeight:"bold",marginBottom:"20px",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(H0,{size:16}),"DEPLOY WORKFLOW"]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{display:"block",color:"#a3a3a3",fontSize:"11px",marginBottom:"6px",fontWeight:"bold"},children:"WORKFLOW NAME *"}),t.jsx("input",{type:"text",value:M,onChange:K=>P(K.target.value),placeholder:"Enter workflow name...",autoFocus:!0,style:{width:"100%",backgroundColor:"#0a0a0a",border:"1px solid #2d2d2d",color:"white",padding:"8px 12px",fontSize:"12px",borderRadius:"4px",outline:"none",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{marginBottom:"20px"},children:[t.jsx("label",{style:{display:"block",color:"#a3a3a3",fontSize:"11px",marginBottom:"6px",fontWeight:"bold"},children:"DESCRIPTION (OPTIONAL)"}),t.jsx("textarea",{value:I,onChange:K=>O(K.target.value),placeholder:"Enter workflow description...",rows:3,style:{width:"100%",backgroundColor:"#0a0a0a",border:"1px solid #2d2d2d",color:"white",padding:"8px 12px",fontSize:"12px",borderRadius:"4px",outline:"none",resize:"vertical",fontFamily:"Consolas, monospace",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:()=>{R(!1),P(""),O("")},style:{backgroundColor:"transparent",color:"#a3a3a3",border:"1px solid #404040",padding:"8px 16px",fontSize:"11px",cursor:"pointer",borderRadius:"4px",fontWeight:"bold"},children:"CANCEL"}),t.jsx("button",{onClick:Ae,style:{backgroundColor:"transparent",color:"#f59e0b",border:"1px solid #f59e0b",padding:"8px 16px",fontSize:"11px",cursor:"pointer",borderRadius:"4px",fontWeight:"bold"},children:"SAVE AS DRAFT"}),t.jsx("button",{onClick:ve,style:{backgroundColor:"#3b82f6",color:"white",border:"none",padding:"8px 16px",fontSize:"11px",cursor:"pointer",borderRadius:"4px",fontWeight:"bold"},children:"DEPLOY & EXECUTE"})]})]})}),Z&&t.jsx(hK,{data:Q,workflowName:Y,onClose:()=>{fe(!1),_(null),he("")}})]})}const Pf=[{id:"postgresql",name:"PostgreSQL",type:"postgresql",category:"database",icon:"",color:"#336791",description:"Open-source relational database with advanced features",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"5432",required:!0,defaultValue:5432},{name:"database",label:"Database",type:"text",placeholder:"mydb",required:!0},{name:"username",label:"Username",type:"text",placeholder:"postgres",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0},{name:"ssl",label:"Use SSL",type:"checkbox",required:!1,defaultValue:!1}]},{id:"mysql",name:"MySQL",type:"mysql",category:"database",icon:"",color:"#4479A1",description:"Popular open-source relational database",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"3306",required:!0,defaultValue:3306},{name:"database",label:"Database",type:"text",placeholder:"mydb",required:!0},{name:"username",label:"Username",type:"text",placeholder:"root",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"mariadb",name:"MariaDB",type:"mariadb",category:"database",icon:"",color:"#003545",description:"MySQL-compatible relational database fork",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"3306",required:!0,defaultValue:3306},{name:"database",label:"Database",type:"text",placeholder:"mydb",required:!0},{name:"username",label:"Username",type:"text",placeholder:"root",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"sqlite",name:"SQLite",type:"sqlite",category:"database",icon:"",color:"#003B57",description:"Lightweight embedded SQL database",testable:!0,requiresAuth:!1,fields:[{name:"filepath",label:"Database File Path",type:"text",placeholder:"/path/to/database.db",required:!0},{name:"readonly",label:"Read Only",type:"checkbox",required:!1,defaultValue:!1}]},{id:"oracle",name:"Oracle Database",type:"oracle",category:"database",icon:"",color:"#F80000",description:"Enterprise-grade relational database",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"1521",required:!0,defaultValue:1521},{name:"serviceName",label:"Service Name",type:"text",placeholder:"ORCL",required:!0},{name:"username",label:"Username",type:"text",placeholder:"system",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"mssql",name:"Microsoft SQL Server",type:"mssql",category:"database",icon:"",color:"#CC2927",description:"Microsoft enterprise database system",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"1433",required:!0,defaultValue:1433},{name:"database",label:"Database",type:"text",placeholder:"master",required:!0},{name:"username",label:"Username",type:"text",placeholder:"sa",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"cockroachdb",name:"CockroachDB",type:"cockroachdb",category:"database",icon:"",color:"#6933FF",description:"Distributed SQL database for cloud applications",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"26257",required:!0,defaultValue:26257},{name:"database",label:"Database",type:"text",placeholder:"defaultdb",required:!0},{name:"username",label:"Username",type:"text",placeholder:"root",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"snowflake",name:"Snowflake",type:"snowflake",category:"database",icon:"",color:"#29B5E8",description:"Cloud data warehouse platform",testable:!0,requiresAuth:!0,fields:[{name:"account",label:"Account Identifier",type:"text",placeholder:"xy12345.us-east-1",required:!0},{name:"username",label:"Username",type:"text",placeholder:"user@company.com",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0},{name:"database",label:"Database",type:"text",placeholder:"MYDB",required:!0},{name:"warehouse",label:"Warehouse",type:"text",placeholder:"COMPUTE_WH",required:!0},{name:"schema",label:"Schema",type:"text",placeholder:"PUBLIC",required:!1}]},{id:"vertica",name:"Vertica",type:"vertica",category:"database",icon:"",color:"#005A9C",description:"Columnar analytics database",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"5433",required:!0,defaultValue:5433},{name:"database",label:"Database",type:"text",placeholder:"vmart",required:!0},{name:"username",label:"Username",type:"text",placeholder:"dbadmin",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"mongodb",name:"MongoDB",type:"mongodb",category:"database",icon:"",color:"#47A248",description:"Document-oriented NoSQL database",testable:!0,requiresAuth:!0,fields:[{name:"connectionString",label:"Connection String",type:"text",placeholder:"mongodb://localhost:27017",required:!0},{name:"database",label:"Database",type:"text",placeholder:"mydb",required:!0},{name:"username",label:"Username",type:"text",placeholder:"admin",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"redis",name:"Redis",type:"redis",category:"database",icon:"",color:"#DC382D",description:"In-memory data structure store",testable:!0,requiresAuth:!1,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"6379",required:!0,defaultValue:6379},{name:"password",label:"Password",type:"password",placeholder:"",required:!1},{name:"database",label:"Database Index",type:"number",placeholder:"0",required:!1,defaultValue:0}]},{id:"cassandra",name:"Apache Cassandra",type:"cassandra",category:"database",icon:"",color:"#1287B1",description:"Distributed wide-column store",testable:!0,requiresAuth:!0,fields:[{name:"contactPoints",label:"Contact Points (comma-separated)",type:"text",placeholder:"localhost,node2",required:!0},{name:"port",label:"Port",type:"number",placeholder:"9042",required:!0,defaultValue:9042},{name:"keyspace",label:"Keyspace",type:"text",placeholder:"mykeyspace",required:!0},{name:"username",label:"Username",type:"text",placeholder:"cassandra",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"couchdb",name:"CouchDB",type:"couchdb",category:"database",icon:"",color:"#E42528",description:"Document-oriented database with HTTP API",testable:!0,requiresAuth:!0,fields:[{name:"url",label:"URL",type:"url",placeholder:"http://localhost:5984",required:!0},{name:"username",label:"Username",type:"text",placeholder:"admin",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0},{name:"database",label:"Database",type:"text",placeholder:"mydb",required:!1}]},{id:"dynamodb",name:"Amazon DynamoDB",type:"dynamodb",category:"database",icon:"",color:"#4053D6",description:"AWS managed NoSQL database",testable:!0,requiresAuth:!0,fields:[{name:"region",label:"Region",type:"text",placeholder:"us-east-1",required:!0},{name:"accessKeyId",label:"Access Key ID",type:"text",placeholder:"AKIAIOSFODNN7EXAMPLE",required:!0},{name:"secretAccessKey",label:"Secret Access Key",type:"password",placeholder:"",required:!0},{name:"endpoint",label:"Custom Endpoint (optional)",type:"url",placeholder:"http://localhost:8000",required:!1}]},{id:"neo4j",name:"Neo4j",type:"neo4j",category:"database",icon:"",color:"#008CC1",description:"Graph database management system",testable:!0,requiresAuth:!0,fields:[{name:"uri",label:"Connection URI",type:"url",placeholder:"bolt://localhost:7687",required:!0},{name:"username",label:"Username",type:"text",placeholder:"neo4j",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0},{name:"database",label:"Database",type:"text",placeholder:"neo4j",required:!1}]},{id:"arangodb",name:"ArangoDB",type:"arangodb",category:"database",icon:"",color:"#DDE016",description:"Multi-model database (documents, graphs, key-value)",testable:!0,requiresAuth:!0,fields:[{name:"url",label:"URL",type:"url",placeholder:"http://localhost:8529",required:!0},{name:"database",label:"Database",type:"text",placeholder:"_system",required:!0},{name:"username",label:"Username",type:"text",placeholder:"root",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"memcached",name:"Memcached",type:"memcached",category:"database",icon:"",color:"#00D9FF",description:"Distributed memory caching system",testable:!0,requiresAuth:!1,fields:[{name:"servers",label:"Servers (comma-separated)",type:"text",placeholder:"localhost:11211",required:!0}]},{id:"rethinkdb",name:"RethinkDB",type:"rethinkdb",category:"database",icon:"",color:"#2E3A4F",description:"Real-time database for modern apps",testable:!0,requiresAuth:!1,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"28015",required:!0,defaultValue:28015},{name:"database",label:"Database",type:"text",placeholder:"test",required:!1},{name:"username",label:"Username",type:"text",placeholder:"admin",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"firestore",name:"Google Firestore",type:"firestore",category:"database",icon:"",color:"#FFA000",description:"Cloud-hosted NoSQL database from Firebase",testable:!0,requiresAuth:!0,fields:[{name:"projectId",label:"Project ID",type:"text",placeholder:"my-project",required:!0},{name:"credentials",label:"Service Account JSON",type:"textarea",placeholder:"Paste JSON credentials",required:!0}]},{id:"hbase",name:"Apache HBase",type:"hbase",category:"database",icon:"",color:"#FF6600",description:"Distributed column-oriented database on Hadoop",testable:!0,requiresAuth:!1,fields:[{name:"zkQuorum",label:"ZooKeeper Quorum",type:"text",placeholder:"localhost:2181",required:!0},{name:"zkNode",label:"ZooKeeper ZNode",type:"text",placeholder:"/hbase",required:!1,defaultValue:"/hbase"}]},{id:"scylladb",name:"ScyllaDB",type:"scylladb",category:"database",icon:"",color:"#53CADD",description:"High-performance Cassandra-compatible database",testable:!0,requiresAuth:!0,fields:[{name:"contactPoints",label:"Contact Points",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"9042",required:!0,defaultValue:9042},{name:"keyspace",label:"Keyspace",type:"text",placeholder:"mykeyspace",required:!0},{name:"username",label:"Username",type:"text",placeholder:"cassandra",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"orientdb",name:"OrientDB",type:"orientdb",category:"database",icon:"",color:"#F58025",description:"Multi-model database (graph, document, key-value)",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"2424",required:!0,defaultValue:2424},{name:"database",label:"Database",type:"text",placeholder:"demodb",required:!0},{name:"username",label:"Username",type:"text",placeholder:"root",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"cosmosdb",name:"Azure Cosmos DB",type:"cosmosdb",category:"database",icon:"",color:"#0078D4",description:"Globally distributed multi-model database",testable:!0,requiresAuth:!0,fields:[{name:"endpoint",label:"Endpoint",type:"url",placeholder:"https://account.documents.azure.com:443/",required:!0},{name:"key",label:"Primary Key",type:"password",placeholder:"",required:!0},{name:"database",label:"Database ID",type:"text",placeholder:"ToDoList",required:!1}]},{id:"etcd",name:"etcd",type:"etcd",category:"database",icon:"",color:"#419EDA",description:"Distributed key-value store for configuration",testable:!0,requiresAuth:!1,fields:[{name:"hosts",label:"Hosts (comma-separated)",type:"text",placeholder:"localhost:2379",required:!0},{name:"username",label:"Username",type:"text",placeholder:"root",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"influxdb",name:"InfluxDB",type:"influxdb",category:"timeseries",icon:"",color:"#22ADF6",description:"Time series database for metrics and events",testable:!0,requiresAuth:!0,fields:[{name:"url",label:"URL",type:"url",placeholder:"http://localhost:8086",required:!0},{name:"token",label:"Token",type:"password",placeholder:"your-token",required:!0},{name:"organization",label:"Organization",type:"text",placeholder:"my-org",required:!0},{name:"bucket",label:"Bucket",type:"text",placeholder:"my-bucket",required:!0}]},{id:"questdb",name:"QuestDB",type:"questdb",category:"timeseries",icon:"",color:"#FF9D00",description:"High-performance time series database",testable:!0,requiresAuth:!1,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"HTTP Port",type:"number",placeholder:"9000",required:!0,defaultValue:9e3},{name:"username",label:"Username",type:"text",placeholder:"admin",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"timescaledb",name:"TimescaleDB",type:"timescaledb",category:"timeseries",icon:"",color:"#FDB515",description:"PostgreSQL extension for time series",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"5432",required:!0,defaultValue:5432},{name:"database",label:"Database",type:"text",placeholder:"tsdb",required:!0},{name:"username",label:"Username",type:"text",placeholder:"postgres",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"prometheus",name:"Prometheus",type:"prometheus",category:"timeseries",icon:"",color:"#E6522C",description:"Monitoring system and time series database",testable:!0,requiresAuth:!1,fields:[{name:"url",label:"URL",type:"url",placeholder:"http://localhost:9090",required:!0},{name:"username",label:"Username",type:"text",placeholder:"",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"victoriametrics",name:"VictoriaMetrics",type:"victoriametrics",category:"timeseries",icon:"",color:"#621CEA",description:"Fast and cost-effective time series database",testable:!0,requiresAuth:!1,fields:[{name:"url",label:"URL",type:"url",placeholder:"http://localhost:8428",required:!0}]},{id:"opentsdb",name:"OpenTSDB",type:"opentsdb",category:"timeseries",icon:"",color:"#44B4E5",description:"Distributed time series database on HBase",testable:!0,requiresAuth:!1,fields:[{name:"url",label:"URL",type:"url",placeholder:"http://localhost:4242",required:!0}]},{id:"kdb",name:"kdb+",type:"kdb",category:"timeseries",icon:"",color:"#0069B4",description:"High-performance time series database for financial data",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"5000",required:!0,defaultValue:5e3},{name:"username",label:"Username",type:"text",placeholder:"user",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"clickhouse",name:"ClickHouse",type:"clickhouse",category:"timeseries",icon:"",color:"#FFCC00",description:"Fast open-source columnar database",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"HTTP Port",type:"number",placeholder:"8123",required:!0,defaultValue:8123},{name:"database",label:"Database",type:"text",placeholder:"default",required:!0},{name:"username",label:"Username",type:"text",placeholder:"default",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"csv",name:"CSV File",type:"csv",category:"file",icon:"",color:"#217346",description:"Import data from CSV files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select CSV file",required:!0},{name:"delimiter",label:"Delimiter",type:"select",required:!1,defaultValue:",",options:[{label:"Comma (,)",value:","},{label:"Semicolon (;)",value:";"},{label:"Tab",value:"\\t"},{label:"Pipe (|)",value:"|"}]},{name:"hasHeader",label:"Has Header Row",type:"checkbox",required:!1,defaultValue:!0},{name:"encoding",label:"Encoding",type:"select",required:!1,defaultValue:"utf-8",options:[{label:"UTF-8",value:"utf-8"},{label:"ASCII",value:"ascii"},{label:"Latin-1",value:"latin1"}]}]},{id:"excel",name:"Excel (XLSX)",type:"excel",category:"file",icon:"",color:"#217346",description:"Import data from Excel files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select Excel file",required:!0},{name:"sheet",label:"Sheet Name or Index",type:"text",placeholder:"Sheet1 or 0",required:!1},{name:"hasHeader",label:"Has Header Row",type:"checkbox",required:!1,defaultValue:!0}]},{id:"json",name:"JSON File",type:"json",category:"file",icon:"",color:"#F7DF1E",description:"Import data from JSON files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select JSON file",required:!0},{name:"jsonPath",label:"JSON Path (optional)",type:"text",placeholder:"$.data",required:!1}]},{id:"parquet",name:"Parquet File",type:"parquet",category:"file",icon:"",color:"#FF6B00",description:"Import data from Apache Parquet files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select Parquet file",required:!0}]},{id:"xml",name:"XML File",type:"xml",category:"file",icon:"",color:"#FF6600",description:"Import data from XML files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select XML file",required:!0},{name:"xpath",label:"XPath Expression",type:"text",placeholder:"//record",required:!1}]},{id:"avro",name:"Avro File",type:"avro",category:"file",icon:"",color:"#0066CC",description:"Import data from Apache Avro files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select Avro file",required:!0}]},{id:"orc",name:"ORC File",type:"orc",category:"file",icon:"",color:"#5B9BD5",description:"Import data from Apache ORC files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select ORC file",required:!0}]},{id:"feather",name:"Feather File",type:"feather",category:"file",icon:"",color:"#FF4081",description:"Import data from Apache Arrow Feather files",testable:!1,requiresAuth:!1,fields:[{name:"filepath",label:"File Path",type:"text",placeholder:"Select Feather file",required:!0}]},{id:"rest-api",name:"REST API",type:"rest-api",category:"api",icon:"",color:"#61DAFB",description:"Connect to REST API endpoints",testable:!0,requiresAuth:!1,fields:[{name:"baseUrl",label:"Base URL",type:"url",placeholder:"https://api.example.com",required:!0},{name:"authType",label:"Authentication Type",type:"select",required:!1,defaultValue:"none",options:[{label:"None",value:"none"},{label:"API Key",value:"apikey"},{label:"Bearer Token",value:"bearer"},{label:"Basic Auth",value:"basic"}]},{name:"apiKey",label:"API Key / Token",type:"password",placeholder:"your-api-key",required:!1},{name:"headers",label:"Custom Headers (JSON)",type:"textarea",placeholder:'{"X-Custom": "value"}',required:!1}]},{id:"graphql",name:"GraphQL API",type:"graphql",category:"api",icon:"",color:"#E10098",description:"Connect to GraphQL endpoints",testable:!0,requiresAuth:!1,fields:[{name:"endpoint",label:"GraphQL Endpoint",type:"url",placeholder:"https://api.example.com/graphql",required:!0},{name:"authToken",label:"Auth Token",type:"password",placeholder:"Bearer token",required:!1},{name:"headers",label:"Custom Headers (JSON)",type:"textarea",placeholder:'{"Authorization": "Bearer token"}',required:!1}]},{id:"websocket",name:"WebSocket",type:"websocket",category:"streaming",icon:"",color:"#00A8E8",description:"Connect to WebSocket streams",testable:!0,requiresAuth:!1,fields:[{name:"url",label:"WebSocket URL",type:"url",placeholder:"wss://stream.example.com",required:!0},{name:"protocols",label:"Protocols (comma-separated)",type:"text",placeholder:"protocol1,protocol2",required:!1},{name:"reconnect",label:"Auto Reconnect",type:"checkbox",required:!1,defaultValue:!0}]},{id:"grpc",name:"gRPC",type:"grpc",category:"api",icon:"",color:"#00ADD8",description:"Connect to gRPC services",testable:!0,requiresAuth:!1,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"50051",required:!0,defaultValue:50051},{name:"tls",label:"Use TLS",type:"checkbox",required:!1,defaultValue:!1},{name:"protoFile",label:"Proto File Path",type:"text",placeholder:"/path/to/service.proto",required:!1}]},{id:"soap",name:"SOAP API",type:"soap",category:"api",icon:"",color:"#0080FF",description:"Connect to SOAP web services",testable:!0,requiresAuth:!1,fields:[{name:"wsdlUrl",label:"WSDL URL",type:"url",placeholder:"https://api.example.com/service?wsdl",required:!0},{name:"username",label:"Username",type:"text",placeholder:"user",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"odata",name:"OData API",type:"odata",category:"api",icon:"",color:"#0078D4",description:"Connect to OData services",testable:!0,requiresAuth:!1,fields:[{name:"serviceRoot",label:"Service Root URL",type:"url",placeholder:"https://api.example.com/odata",required:!0},{name:"authType",label:"Authentication",type:"select",required:!1,defaultValue:"none",options:[{label:"None",value:"none"},{label:"Basic",value:"basic"},{label:"OAuth2",value:"oauth2"}]},{name:"username",label:"Username",type:"text",placeholder:"user",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"mqtt",name:"MQTT",type:"mqtt",category:"streaming",icon:"",color:"#660066",description:"Connect to MQTT broker for IoT data",testable:!0,requiresAuth:!1,fields:[{name:"broker",label:"Broker URL",type:"url",placeholder:"mqtt://broker.example.com",required:!0},{name:"port",label:"Port",type:"number",placeholder:"1883",required:!0,defaultValue:1883},{name:"clientId",label:"Client ID",type:"text",placeholder:"mqtt_client_123",required:!1},{name:"username",label:"Username",type:"text",placeholder:"user",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1},{name:"topic",label:"Default Topic",type:"text",placeholder:"sensors/#",required:!1}]},{id:"kafka",name:"Apache Kafka",type:"kafka",category:"streaming",icon:"",color:"#231F20",description:"Connect to Kafka streaming platform",testable:!0,requiresAuth:!1,fields:[{name:"brokers",label:"Bootstrap Servers (comma-separated)",type:"text",placeholder:"localhost:9092,broker2:9092",required:!0},{name:"groupId",label:"Consumer Group ID",type:"text",placeholder:"my-group",required:!1},{name:"topic",label:"Default Topic",type:"text",placeholder:"my-topic",required:!1},{name:"sasl",label:"Use SASL Authentication",type:"checkbox",required:!1,defaultValue:!1},{name:"username",label:"SASL Username",type:"text",placeholder:"user",required:!1},{name:"password",label:"SASL Password",type:"password",placeholder:"",required:!1}]},{id:"rabbitmq",name:"RabbitMQ",type:"rabbitmq",category:"streaming",icon:"",color:"#FF6600",description:"Connect to RabbitMQ message broker",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"5672",required:!0,defaultValue:5672},{name:"username",label:"Username",type:"text",placeholder:"guest",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0},{name:"vhost",label:"Virtual Host",type:"text",placeholder:"/",required:!1,defaultValue:"/"}]},{id:"nats",name:"NATS",type:"nats",category:"streaming",icon:"",color:"#375C93",description:"Connect to NATS messaging system",testable:!0,requiresAuth:!1,fields:[{name:"servers",label:"Server URLs (comma-separated)",type:"text",placeholder:"nats://localhost:4222",required:!0},{name:"username",label:"Username",type:"text",placeholder:"user",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1},{name:"token",label:"Token",type:"password",placeholder:"auth-token",required:!1}]},{id:"aws-s3",name:"AWS S3",type:"aws-s3",category:"cloud",icon:"",color:"#FF9900",description:"Amazon S3 object storage",testable:!0,requiresAuth:!0,fields:[{name:"region",label:"Region",type:"text",placeholder:"us-east-1",required:!0},{name:"bucket",label:"Bucket Name",type:"text",placeholder:"my-bucket",required:!0},{name:"accessKeyId",label:"Access Key ID",type:"text",placeholder:"AKIAIOSFODNN7EXAMPLE",required:!0},{name:"secretAccessKey",label:"Secret Access Key",type:"password",placeholder:"",required:!0},{name:"prefix",label:"Prefix (optional)",type:"text",placeholder:"data/",required:!1}]},{id:"google-cloud-storage",name:"Google Cloud Storage",type:"google-cloud-storage",category:"cloud",icon:"",color:"#4285F4",description:"Google Cloud object storage",testable:!0,requiresAuth:!0,fields:[{name:"projectId",label:"Project ID",type:"text",placeholder:"my-project",required:!0},{name:"bucket",label:"Bucket Name",type:"text",placeholder:"my-bucket",required:!0},{name:"credentials",label:"Service Account JSON",type:"textarea",placeholder:"Paste JSON credentials",required:!0}]},{id:"azure-blob",name:"Azure Blob Storage",type:"azure-blob",category:"cloud",icon:"",color:"#0078D4",description:"Microsoft Azure blob storage",testable:!0,requiresAuth:!0,fields:[{name:"accountName",label:"Account Name",type:"text",placeholder:"mystorageaccount",required:!0},{name:"accountKey",label:"Account Key",type:"password",placeholder:"",required:!0},{name:"container",label:"Container Name",type:"text",placeholder:"my-container",required:!0}]},{id:"digitalocean-spaces",name:"DigitalOcean Spaces",type:"digitalocean-spaces",category:"cloud",icon:"",color:"#0080FF",description:"DigitalOcean object storage",testable:!0,requiresAuth:!0,fields:[{name:"region",label:"Region",type:"text",placeholder:"nyc3",required:!0},{name:"space",label:"Space Name",type:"text",placeholder:"my-space",required:!0},{name:"accessKey",label:"Access Key",type:"text",placeholder:"your-access-key",required:!0},{name:"secretKey",label:"Secret Key",type:"password",placeholder:"",required:!0}]},{id:"minio",name:"MinIO",type:"minio",category:"cloud",icon:"",color:"#C72E49",description:"Self-hosted S3-compatible object storage",testable:!0,requiresAuth:!0,fields:[{name:"endpoint",label:"Endpoint",type:"url",placeholder:"http://localhost:9000",required:!0},{name:"bucket",label:"Bucket Name",type:"text",placeholder:"my-bucket",required:!0},{name:"accessKey",label:"Access Key",type:"text",placeholder:"minioadmin",required:!0},{name:"secretKey",label:"Secret Key",type:"password",placeholder:"",required:!0}]},{id:"backblaze-b2",name:"Backblaze B2",type:"backblaze-b2",category:"cloud",icon:"",color:"#FF0000",description:"Backblaze B2 cloud storage",testable:!0,requiresAuth:!0,fields:[{name:"keyId",label:"Application Key ID",type:"text",placeholder:"your-key-id",required:!0},{name:"applicationKey",label:"Application Key",type:"password",placeholder:"",required:!0},{name:"bucketId",label:"Bucket ID",type:"text",placeholder:"bucket-id",required:!0}]},{id:"wasabi",name:"Wasabi",type:"wasabi",category:"cloud",icon:"",color:"#00B388",description:"Wasabi hot cloud storage",testable:!0,requiresAuth:!0,fields:[{name:"region",label:"Region",type:"text",placeholder:"us-east-1",required:!0},{name:"bucket",label:"Bucket Name",type:"text",placeholder:"my-bucket",required:!0},{name:"accessKey",label:"Access Key",type:"text",placeholder:"your-access-key",required:!0},{name:"secretKey",label:"Secret Key",type:"password",placeholder:"",required:!0}]},{id:"cloudflare-r2",name:"Cloudflare R2",type:"cloudflare-r2",category:"cloud",icon:"",color:"#F38020",description:"Cloudflare R2 storage",testable:!0,requiresAuth:!0,fields:[{name:"accountId",label:"Account ID",type:"text",placeholder:"your-account-id",required:!0},{name:"bucket",label:"Bucket Name",type:"text",placeholder:"my-bucket",required:!0},{name:"accessKeyId",label:"Access Key ID",type:"text",placeholder:"access-key",required:!0},{name:"secretAccessKey",label:"Secret Access Key",type:"password",placeholder:"",required:!0}]},{id:"oracle-cloud-storage",name:"Oracle Cloud Storage",type:"oracle-cloud-storage",category:"cloud",icon:"",color:"#F80000",description:"Oracle Cloud Infrastructure object storage",testable:!0,requiresAuth:!0,fields:[{name:"region",label:"Region",type:"text",placeholder:"us-phoenix-1",required:!0},{name:"namespace",label:"Namespace",type:"text",placeholder:"my-namespace",required:!0},{name:"bucket",label:"Bucket Name",type:"text",placeholder:"my-bucket",required:!0},{name:"accessKey",label:"Access Key",type:"text",placeholder:"access-key",required:!0},{name:"secretKey",label:"Secret Key",type:"password",placeholder:"",required:!0}]},{id:"ibm-cloud-storage",name:"IBM Cloud Object Storage",type:"ibm-cloud-storage",category:"cloud",icon:"",color:"#0F62FE",description:"IBM Cloud object storage",testable:!0,requiresAuth:!0,fields:[{name:"endpoint",label:"Endpoint",type:"url",placeholder:"https://s3.us.cloud-object-storage.appdomain.cloud",required:!0},{name:"bucket",label:"Bucket Name",type:"text",placeholder:"my-bucket",required:!0},{name:"apiKey",label:"API Key",type:"password",placeholder:"",required:!0},{name:"serviceInstanceId",label:"Service Instance ID",type:"text",placeholder:"crn:v1:...",required:!0}]},{id:"yahoo-finance",name:"Yahoo Finance",type:"yahoo-finance",category:"market-data",icon:"",color:"#7B0099",description:"Free stock market data from Yahoo Finance",testable:!0,requiresAuth:!1,fields:[{name:"symbols",label:"Default Symbols (comma-separated)",type:"text",placeholder:"AAPL,GOOGL,MSFT",required:!1},{name:"interval",label:"Default Interval",type:"select",required:!1,defaultValue:"1d",options:[{label:"1 minute",value:"1m"},{label:"5 minutes",value:"5m"},{label:"15 minutes",value:"15m"},{label:"1 hour",value:"1h"},{label:"1 day",value:"1d"},{label:"1 week",value:"1wk"}]}]},{id:"alpha-vantage",name:"Alpha Vantage",type:"alpha-vantage",category:"market-data",icon:"",color:"#2E7D32",description:"Stock, forex, and crypto market data API",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"polygon-io",name:"Polygon.io",type:"polygon-io",category:"market-data",icon:"",color:"#7C3AED",description:"Real-time and historical market data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"finnhub",name:"Finnhub",type:"finnhub",category:"market-data",icon:"",color:"#00D4AA",description:"Real-time stock, forex, and crypto data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"iex-cloud",name:"IEX Cloud",type:"iex-cloud",category:"market-data",icon:"",color:"#1D7DF0",description:"Financial data from IEX Exchange",testable:!0,requiresAuth:!0,fields:[{name:"token",label:"API Token",type:"password",placeholder:"pk_...",required:!0},{name:"sandbox",label:"Use Sandbox",type:"checkbox",required:!1,defaultValue:!1}]},{id:"twelve-data",name:"Twelve Data",type:"twelve-data",category:"market-data",icon:"",color:"#00B4D8",description:"Real-time and historical financial data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"quandl",name:"Quandl/Nasdaq Data Link",type:"quandl",category:"market-data",icon:"",color:"#FF6B6B",description:"Financial and alternative datasets",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"binance",name:"Binance",type:"binance",category:"market-data",icon:"",color:"#F3BA2F",description:"Cryptocurrency exchange data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0},{name:"apiSecret",label:"API Secret",type:"password",placeholder:"",required:!0},{name:"testnet",label:"Use Testnet",type:"checkbox",required:!1,defaultValue:!1}]},{id:"coinbase",name:"Coinbase",type:"coinbase",category:"market-data",icon:"",color:"#0052FF",description:"Cryptocurrency exchange data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0},{name:"apiSecret",label:"API Secret",type:"password",placeholder:"",required:!0}]},{id:"kraken",name:"Kraken",type:"kraken",category:"market-data",icon:"",color:"#5741D9",description:"Cryptocurrency exchange data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0},{name:"privateKey",label:"Private Key",type:"password",placeholder:"",required:!0}]},{id:"coinmarketcap",name:"CoinMarketCap",type:"coinmarketcap",category:"market-data",icon:"",color:"#17A2F5",description:"Cryptocurrency market data aggregator",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"coingecko",name:"CoinGecko",type:"coingecko",category:"market-data",icon:"",color:"#8DC63F",description:"Free cryptocurrency data API",testable:!0,requiresAuth:!1,fields:[{name:"apiKey",label:"API Key (Pro only)",type:"password",placeholder:"your-api-key",required:!1}]},{id:"eod-historical",name:"EOD Historical Data",type:"eod-historical",category:"market-data",icon:"",color:"#4A90E2",description:"Historical financial data API",testable:!0,requiresAuth:!0,fields:[{name:"apiToken",label:"API Token",type:"password",placeholder:"your-api-token",required:!0}]},{id:"tiingo",name:"Tiingo",type:"tiingo",category:"market-data",icon:"",color:"#FF4E50",description:"Stock, crypto, and news data",testable:!0,requiresAuth:!0,fields:[{name:"apiToken",label:"API Token",type:"password",placeholder:"your-api-token",required:!0}]},{id:"intrinio",name:"Intrinio",type:"intrinio",category:"market-data",icon:"",color:"#00B4D8",description:"Financial data for institutions",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"bloomberg",name:"Bloomberg API",type:"bloomberg",category:"market-data",icon:"",color:"#F58025",description:"Bloomberg Terminal API (requires license)",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"localhost",required:!0},{name:"port",label:"Port",type:"number",placeholder:"8194",required:!0,defaultValue:8194}]},{id:"reuters",name:"Refinitiv/Reuters",type:"reuters",category:"market-data",icon:"",color:"#FF6200",description:"Refinitiv financial data API",testable:!0,requiresAuth:!0,fields:[{name:"appKey",label:"App Key",type:"password",placeholder:"your-app-key",required:!0},{name:"username",label:"Username",type:"text",placeholder:"user@company.com",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"marketstack",name:"Marketstack",type:"marketstack",category:"market-data",icon:"",color:"#4CAF50",description:"Real-time and historical stock data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0},{name:"https",label:"Use HTTPS (paid plans)",type:"checkbox",required:!1,defaultValue:!1}]},{id:"finage",name:"Finage",type:"finage",category:"market-data",icon:"",color:"#00C853",description:"Real-time and historical market data",testable:!0,requiresAuth:!0,fields:[{name:"apiKey",label:"API Key",type:"password",placeholder:"your-api-key",required:!0}]},{id:"tradier",name:"Tradier",type:"tradier",category:"market-data",icon:"",color:"#00A8E8",description:"Brokerage and market data API",testable:!0,requiresAuth:!0,fields:[{name:"accessToken",label:"Access Token",type:"password",placeholder:"your-access-token",required:!0},{name:"sandbox",label:"Use Sandbox",type:"checkbox",required:!1,defaultValue:!1}]},{id:"elasticsearch",name:"Elasticsearch",type:"elasticsearch",category:"database",icon:"",color:"#005571",description:"Distributed search and analytics engine",testable:!0,requiresAuth:!1,fields:[{name:"node",label:"Node URL",type:"url",placeholder:"http://localhost:9200",required:!0},{name:"username",label:"Username",type:"text",placeholder:"elastic",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1},{name:"index",label:"Default Index",type:"text",placeholder:"my-index",required:!1}]},{id:"opensearch",name:"OpenSearch",type:"opensearch",category:"database",icon:"",color:"#003B5C",description:"Open-source fork of Elasticsearch",testable:!0,requiresAuth:!1,fields:[{name:"node",label:"Node URL",type:"url",placeholder:"https://localhost:9200",required:!0},{name:"username",label:"Username",type:"text",placeholder:"admin",required:!1},{name:"password",label:"Password",type:"password",placeholder:"",required:!1}]},{id:"solr",name:"Apache Solr",type:"solr",category:"database",icon:"",color:"#D9411E",description:"Enterprise search platform",testable:!0,requiresAuth:!1,fields:[{name:"host",label:"Host",type:"url",placeholder:"http://localhost:8983/solr",required:!0},{name:"collection",label:"Collection",type:"text",placeholder:"my-collection",required:!1}]},{id:"algolia",name:"Algolia",type:"algolia",category:"database",icon:"",color:"#5468FF",description:"Hosted search API",testable:!0,requiresAuth:!0,fields:[{name:"appId",label:"Application ID",type:"text",placeholder:"your-app-id",required:!0},{name:"apiKey",label:"API Key",type:"password",placeholder:"",required:!0},{name:"index",label:"Index Name",type:"text",placeholder:"my_index",required:!1}]},{id:"meilisearch",name:"MeiliSearch",type:"meilisearch",category:"database",icon:"",color:"#FF5CAA",description:"Lightning-fast search API",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"url",placeholder:"http://localhost:7700",required:!0},{name:"apiKey",label:"API Key",type:"password",placeholder:"",required:!1},{name:"index",label:"Index Name",type:"text",placeholder:"movies",required:!1}]},{id:"bigquery",name:"Google BigQuery",type:"bigquery",category:"database",icon:"",color:"#4285F4",description:"Serverless data warehouse",testable:!0,requiresAuth:!0,fields:[{name:"projectId",label:"Project ID",type:"text",placeholder:"my-project",required:!0},{name:"dataset",label:"Dataset",type:"text",placeholder:"my_dataset",required:!1},{name:"credentials",label:"Service Account JSON",type:"textarea",placeholder:"Paste JSON credentials",required:!0}]},{id:"redshift",name:"Amazon Redshift",type:"redshift",category:"database",icon:"",color:"#E25555",description:"AWS data warehouse",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"cluster.region.redshift.amazonaws.com",required:!0},{name:"port",label:"Port",type:"number",placeholder:"5439",required:!0,defaultValue:5439},{name:"database",label:"Database",type:"text",placeholder:"dev",required:!0},{name:"username",label:"Username",type:"text",placeholder:"awsuser",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"databricks",name:"Databricks",type:"databricks",category:"database",icon:"",color:"#FF3621",description:"Unified analytics platform",testable:!0,requiresAuth:!0,fields:[{name:"serverHostname",label:"Server Hostname",type:"text",placeholder:"your-workspace.cloud.databricks.com",required:!0},{name:"httpPath",label:"HTTP Path",type:"text",placeholder:"/sql/1.0/warehouses/...",required:!0},{name:"accessToken",label:"Personal Access Token",type:"password",placeholder:"dapi...",required:!0}]},{id:"synapse",name:"Azure Synapse",type:"synapse",category:"database",icon:"",color:"#0078D4",description:"Azure analytics service",testable:!0,requiresAuth:!0,fields:[{name:"server",label:"Server",type:"text",placeholder:"workspace.sql.azuresynapse.net",required:!0},{name:"database",label:"Database",type:"text",placeholder:"sqlpool",required:!0},{name:"username",label:"Username",type:"text",placeholder:"sqladmin",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"ftp",name:"FTP",type:"ftp",category:"file",icon:"",color:"#0066CC",description:"File Transfer Protocol",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"ftp.example.com",required:!0},{name:"port",label:"Port",type:"number",placeholder:"21",required:!0,defaultValue:21},{name:"username",label:"Username",type:"text",placeholder:"user",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!0}]},{id:"sftp",name:"SFTP",type:"sftp",category:"file",icon:"",color:"#00CC66",description:"Secure File Transfer Protocol",testable:!0,requiresAuth:!0,fields:[{name:"host",label:"Host",type:"text",placeholder:"sftp.example.com",required:!0},{name:"port",label:"Port",type:"number",placeholder:"22",required:!0,defaultValue:22},{name:"username",label:"Username",type:"text",placeholder:"user",required:!0},{name:"password",label:"Password",type:"password",placeholder:"",required:!1},{name:"privateKey",label:"Private Key Path",type:"text",placeholder:"/path/to/key",required:!1}]}];class St{constructor(e){Pe(this,"connection");this.connection=e}async connect(){console.log(`Connecting to ${this.connection.name}...`)}async disconnect(){console.log(`Disconnecting from ${this.connection.name}...`)}async query(e,r){throw new Error(`Query not implemented for ${this.connection.type}`)}async getMetadata(){return{type:this.connection.type,name:this.connection.name,category:this.connection.category}}validateConfig(){const e=[];return this.connection.config||e.push("Configuration is missing"),{valid:e.length===0,errors:e}}getConfig(e,r){return this.connection.config[e]??r}createErrorResult(e){return{success:!1,message:`Connection failed: ${e instanceof Error?e.message:String(e)}`}}createSuccessResult(e="Connection successful",r){return{success:!0,message:e,metadata:r}}}class cN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",5432),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password"),l=this.getConfig("ssl",!1);return!r||!i||!o||!a?this.createErrorResult("Missing required connection parameters"):(console.log("Validating PostgreSQL configuration (client-side only)"),this.createSuccessResult(`Configuration validated for PostgreSQL database "${i}"`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,username:o,ssl:l,note:"Client-side validation only. Full connection test requires backend integration."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"postgresql",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`PostgreSQL query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",5432),database:this.getConfig("database"),ssl:this.getConfig("ssl",!1)}}}class dN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",3306),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password"),l=this.getConfig("ssl",!1);return!r||!i||!o||!a?this.createErrorResult("Missing required connection parameters"):(console.log("Validating MySQL configuration (client-side only)"),this.createSuccessResult(`Configuration validated for MySQL database "${i}"`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,username:o,ssl:l,note:"Client-side validation only. Full connection test requires backend integration."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"mysql",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`MySQL query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",3306),database:this.getConfig("database"),ssl:this.getConfig("ssl",!1)}}}class uN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",3306),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password"),l=this.getConfig("ssl",!1);return!r||!i||!o||!a?this.createErrorResult("Missing required connection parameters"):(console.log("Validating MariaDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for MariaDB database "${i}"`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,username:o,ssl:l,note:"Client-side validation only. Full connection test requires backend integration."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"mariadb",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`MariaDB query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",3306),database:this.getConfig("database"),ssl:this.getConfig("ssl",!1)}}}class pN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("connectionString"),n=this.getConfig("database"),i=this.getConfig("username"),o=this.getConfig("password"),a=this.getConfig("authSource","admin");return!r&&!n?this.createErrorResult("Either connection string or database name is required"):(console.log("Validating MongoDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for MongoDB database "${n||"from connection string"}"`,{validatedAt:new Date().toISOString(),database:n,connectionString:r?"Provided":"Not provided",authSource:a,note:"Client-side validation only. Full connection test requires backend integration."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"mongodb",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`MongoDB query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),database:this.getConfig("database"),authSource:this.getConfig("authSource","admin"),hasConnectionString:!!this.getConfig("connectionString")}}}class hN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host","localhost"),n=this.getConfig("port",6379),i=this.getConfig("password"),o=this.getConfig("database",0),a=this.getConfig("ssl",!1);return r?(console.log("Validating Redis configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Redis at ${r}:${n} (DB ${o})`,{validatedAt:new Date().toISOString(),host:r,port:n,database:o,ssl:a,hasPassword:!!i,note:"Client-side validation only. Full connection test requires backend integration."})):this.createErrorResult("Host is required")}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"redis",command:e})});if(!r.ok)throw new Error(`Command failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`Redis command error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",6379),database:this.getConfig("database",0),ssl:this.getConfig("ssl",!1)}}}class fN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filePath"),n=this.getConfig("inMemory",!1);return!r&&!n?this.createErrorResult("Either file path or in-memory flag is required"):(console.log("Validating SQLite configuration (client-side only)"),this.createSuccessResult(`Configuration validated for SQLite database ${n?"(in-memory)":`"${r}"`}`,{validatedAt:new Date().toISOString(),filePath:r,inMemory:n,readOnly:this.getConfig("readOnly",!1),note:"Client-side validation only. Full connection test requires backend integration."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"sqlite",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`SQLite query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),filePath:this.getConfig("filePath"),inMemory:this.getConfig("inMemory",!1),readOnly:this.getConfig("readOnly",!1)}}}class gN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filePath"),n=this.getConfig("url"),i=this.getConfig("delimiter",","),o=this.getConfig("hasHeader",!0),a=this.getConfig("encoding","utf-8");if(!r&&!n)return this.createErrorResult("Either file path or URL is required");if(console.log("Validating CSV configuration (client-side only)"),n)try{const l=await fetch(n,{method:"HEAD"});if(!l.ok)throw new Error(`URL not accessible: ${l.status} ${l.statusText}`);const d=l.headers.get("content-type"),p=l.headers.get("content-length");return this.createSuccessResult("CSV file accessible at URL",{url:n,contentType:d,size:p?`${(parseInt(p)/1024).toFixed(2)} KB`:"Unknown",delimiter:i,hasHeader:o,encoding:a})}catch(l){return this.createErrorResult(`Failed to access CSV at URL: ${l instanceof Error?l.message:String(l)}`)}return this.createSuccessResult(`Configuration validated for CSV file "${r}"`,{validatedAt:new Date().toISOString(),filePath:r,delimiter:i,hasHeader:o,encoding:a,note:"Client-side validation only. Full file validation requires backend integration."})}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"csv",operation:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`CSV operation error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),filePath:this.getConfig("filePath"),url:this.getConfig("url"),delimiter:this.getConfig("delimiter",","),hasHeader:this.getConfig("hasHeader",!0),encoding:this.getConfig("encoding","utf-8")}}}class xN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey"),n=this.getConfig("useRapidAPI",!1),i=this.getConfig("testSymbol","AAPL"),o=n?"https://yahoo-finance15.p.rapidapi.com":"https://query1.finance.yahoo.com/v8/finance/chart";try{const a={"Content-Type":"application/json"};n&&r&&(a["X-RapidAPI-Key"]=r,a["X-RapidAPI-Host"]="yahoo-finance15.p.rapidapi.com");const l=n?`${o}/api/v1/markets/quote?ticker=${i}`:`${o}/${i}?interval=1d&range=1d`,d=await fetch(l,{method:"GET",headers:a});if(!d.ok)throw d.status===401||d.status===403?new Error("Authentication failed. Check your API key."):new Error(`HTTP ${d.status}: ${d.statusText}`);const p=await d.json();if(!(n?p&&p.body:p&&p.chart&&p.chart.result))throw new Error("Invalid response structure from Yahoo Finance API");return this.createSuccessResult("Successfully connected to Yahoo Finance API",{apiType:n?"RapidAPI":"Public API",testSymbol:i,authenticated:!!r,timestamp:new Date().toISOString(),rateLimit:d.headers.get("x-ratelimit-limit"),rateLimitRemaining:d.headers.get("x-ratelimit-remaining")})}catch(a){if(a instanceof Error)return this.createErrorResult(a.message);throw a}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=this.getConfig("useRapidAPI",!1),o=r?.interval||"1d",a=r?.range||"1mo",l={"Content-Type":"application/json"};i&&n&&(l["X-RapidAPI-Key"]=n,l["X-RapidAPI-Host"]="yahoo-finance15.p.rapidapi.com");const d=i?"https://yahoo-finance15.p.rapidapi.com":"https://query1.finance.yahoo.com/v8/finance/chart",p=i?`${d}/api/v1/markets/stock/history?symbol=${e}&interval=${o}&range=${a}`:`${d}/${e}?interval=${o}&range=${a}`,f=await fetch(p,{method:"GET",headers:l});if(!f.ok)throw new Error(`Query failed: ${f.status} ${f.statusText}`);return await f.json()}catch(n){throw new Error(`Yahoo Finance query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),useRapidAPI:this.getConfig("useRapidAPI",!1),hasApiKey:!!this.getConfig("apiKey"),testSymbol:this.getConfig("testSymbol","AAPL")}}async getQuote(e){const r=this.getConfig("useRapidAPI",!1),n=this.getConfig("apiKey"),i={};r&&n&&(i["X-RapidAPI-Key"]=n,i["X-RapidAPI-Host"]="yahoo-finance15.p.rapidapi.com");const o=r?`https://yahoo-finance15.p.rapidapi.com/api/v1/markets/quote?ticker=${e}`:`https://query1.finance.yahoo.com/v8/finance/chart/${e}?interval=1d&range=1d`,a=await fetch(o,{headers:i});if(!a.ok)throw new Error(`Failed to fetch quote for ${e}`);return await a.json()}}class mN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url","http://localhost:8086"),n=this.getConfig("token"),i=this.getConfig("org"),o=this.getConfig("bucket"),a=this.getConfig("version","2.x");if(!r)return this.createErrorResult("URL is required");if(a==="2.x"&&!n)return this.createErrorResult("Token is required for InfluxDB 2.x");console.log("Validating InfluxDB configuration (client-side only)");const l={validatedAt:new Date().toISOString(),version:a,url:r,note:"Client-side validation only. Full connection test requires backend integration."};return a==="2.x"&&i&&o&&(l.org=i,l.bucket=o,l.hasToken=!!n),this.createSuccessResult(`Configuration validated for InfluxDB ${a} at ${r}`,l)}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=this.getConfig("url"),n=this.getConfig("token"),i=this.getConfig("org");if(this.getConfig("version","2.x")==="2.x"){const a=`${r}/api/v2/query?org=${i}`,l=await fetch(a,{method:"POST",headers:{Authorization:`Token ${n}`,"Content-Type":"application/vnd.flux",Accept:"application/csv"},body:e});if(!l.ok)throw new Error(`Query failed: ${l.status} ${l.statusText}`);const d=await l.text();return this.parseCSVResponse(d)}else throw new Error("InfluxDB 1.x queries not yet implemented")}catch(r){throw new Error(`InfluxDB query error: ${r instanceof Error?r.message:String(r)}`)}}parseCSVResponse(e){const r=e.split(`
`).filter(a=>a.trim());if(r.length===0)return[];const n=r.filter(a=>!a.startsWith("#"));if(n.length===0)return[];const i=n[0].split(","),o=[];for(let a=1;a<n.length;a++){const l=n[a].split(","),d={};i.forEach((p,f)=>{d[p]=l[f]}),o.push(d)}return o}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),version:this.getConfig("version","2.x"),org:this.getConfig("org"),bucket:this.getConfig("bucket"),hasToken:!!this.getConfig("token")}}}class yN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host","localhost"),n=this.getConfig("httpPort",9e3),i=this.getConfig("pgPort",8812),o=this.getConfig("username","admin"),a=this.getConfig("password","quest"),l=this.getConfig("protocol","http");return r?(console.log("Validating QuestDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for QuestDB at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,httpPort:n,pgPort:i,protocol:l,authenticated:!!(o&&a),note:"Client-side validation only. Full connection test requires backend integration."})):this.createErrorResult("Host is required")}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=this.getConfig("host"),n=this.getConfig("httpPort",9e3),i=this.getConfig("username"),o=this.getConfig("password"),a=this.getConfig("protocol","http"),l=encodeURIComponent(e),d=`${a}://${r}:${n}/exec?query=${l}`,p={};if(i&&o){const x=btoa(`${i}:${o}`);p.Authorization=`Basic ${x}`}const f=await fetch(d,{method:"GET",headers:p});if(!f.ok)throw new Error(`Query failed: ${f.status} ${f.statusText}`);const h=await f.json();if(h.columns&&h.dataset){const x=h.columns.map(b=>b.name),m=h.dataset.map(b=>{const w={};return x.forEach((y,C)=>{w[y]=b[C]}),w});return{columns:x,rows:m,count:h.count,timings:h.timings}}return h}catch(r){throw new Error(`QuestDB query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),httpPort:this.getConfig("httpPort",9e3),pgPort:this.getConfig("pgPort",8812),protocol:this.getConfig("protocol","http"),hasAuth:!!(this.getConfig("username")&&this.getConfig("password"))}}async insertILP(e){throw this.getConfig("host"),this.getConfig("ilpPort",9009),new Error("ILP insertion requires backend support. Use SQL INSERT statements via query() method instead.")}}class bN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",5432),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password"),l=this.getConfig("ssl",!1);return!r||!i||!o||!a?this.createErrorResult("Missing required connection parameters"):(console.log("Validating TimescaleDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for TimescaleDB database "${i}"`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,username:o,ssl:l,note:"Client-side validation only. TimescaleDB is PostgreSQL-compatible. Full connection test requires backend integration."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"timescaledb",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`TimescaleDB query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",5432),database:this.getConfig("database"),ssl:this.getConfig("ssl",!1),isTimescaleDB:!0}}async createHypertable(e,r){const n=`SELECT create_hypertable('${e}', '${r}');`;return await this.query(n)}async getHypertables(){return await this.query("SELECT * FROM timescaledb_information.hypertables;")}}class vN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Alpha Vantage API connection...");try{const i=`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=IBM&apikey=${r}`,o=await fetch(i);if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const a=await o.json();if(a["Error Message"])throw new Error(a["Error Message"]);if(a.Note)return this.createErrorResult("API call frequency limit reached. Please wait a minute before testing again.");if(a.Information)return this.createErrorResult(a.Information);if(a["Global Quote"])return this.createSuccessResult("Successfully connected to Alpha Vantage API",{testSymbol:"IBM",price:a["Global Quote"]["05. price"],timestamp:a["Global Quote"]["07. latest trading day"],apiType:"Free/Premium",note:"API key validated successfully"});throw new Error("Unexpected response format from Alpha Vantage API")}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r="TIME_SERIES_DAILY"){try{const n=this.getConfig("apiKey"),i=`https://www.alphavantage.co/query?function=${r}&symbol=${e}&apikey=${n}`,o=await fetch(i);if(!o.ok)throw new Error(`Query failed: ${o.status} ${o.statusText}`);const a=await o.json();if(a["Error Message"])throw new Error(a["Error Message"]);if(a.Note)throw new Error("API call frequency limit reached");return a}catch(n){throw new Error(`Alpha Vantage query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Alpha Vantage",features:["Stocks","Forex","Crypto","Technical Indicators","Fundamentals"]}}async getQuote(e){const r=this.getConfig("apiKey"),n=`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${e}&apikey=${r}`,i=await fetch(n);if(!i.ok)throw new Error(`Failed to fetch quote for ${e}`);return await i.json()}async getIntraday(e,r="5min"){return await this.query(e,`TIME_SERIES_INTRADAY&interval=${r}`)}async getDaily(e,r="compact"){return await this.query(e,`TIME_SERIES_DAILY&outputsize=${r}`)}async getCompanyOverview(e){return await this.query(e,"OVERVIEW")}async searchSymbol(e){const r=this.getConfig("apiKey"),n=`https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=${e}&apikey=${r}`,i=await fetch(n);if(!i.ok)throw new Error("Symbol search failed");return await i.json()}}class SN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Polygon.io API connection...");try{const n=`https://api.polygon.io/v1/marketstatus/now?apiKey=${r}`,i=await fetch(n);if(!i.ok)throw i.status===401||i.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${i.status}: ${i.statusText}`);const o=await i.json();if(o.status==="ERROR")throw new Error(o.error||"API request failed");return o.market?this.createSuccessResult("Successfully connected to Polygon.io API",{market:o.market,serverTime:o.serverTime,exchanges:o.exchanges?Object.keys(o.exchanges).length:0,currencies:o.currencies?Object.keys(o.currencies).length:0,apiTier:"Detected from response",note:"API key validated successfully"}):this.createSuccessResult("Successfully connected to Polygon.io API",{timestamp:new Date().toISOString(),note:"API key validated successfully"})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=new URLSearchParams({...r,apiKey:n}),o=`https://api.polygon.io${e}?${i.toString()}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);const l=await a.json();if(l.status==="ERROR")throw new Error(l.error||"API request failed");return l}catch(n){throw new Error(`Polygon.io query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Polygon.io",features:["Stocks","Options","Forex","Crypto","Real-time","Historical"]}}async getAggregates(e,r,n,i,o){return await this.query(`/v2/aggs/ticker/${e}/range/${r}/${n}/${i}/${o}`,{adjusted:"true",sort:"asc"})}async getQuote(e){return await this.query(`/v2/last/trade/${e}`)}async getPreviousClose(e){return await this.query(`/v2/aggs/ticker/${e}/prev`,{adjusted:"true"})}async getSnapshot(){return await this.query("/v2/snapshot/locale/us/markets/stocks/tickers")}async getTickerDetails(e){return await this.query(`/v3/reference/tickers/${e}`)}async searchTickers(e,r,n){const i={search:e};return r&&(i.market=r),n&&(i.type=n),await this.query("/v3/reference/tickers",i)}async getMarketHolidays(){return await this.query("/v1/marketstatus/upcoming")}async getGroupedDaily(e,r=!0){return await this.query(`/v2/aggs/grouped/locale/us/market/stocks/${e}`,{adjusted:r.toString()})}}class wN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url","http://localhost:9200"),n=this.getConfig("username"),i=this.getConfig("password"),o=this.getConfig("apiKey"),a=this.getConfig("cloudId");if(!r&&!a)return this.createErrorResult("Either URL or Cloud ID is required");console.log("Testing Elasticsearch connection...");try{let l=r;if(a){const[,h]=a.split(":");if(h)try{l=`https://${atob(h).split("$")[0]}`}catch{return this.createErrorResult("Invalid Cloud ID format")}}const d={"Content-Type":"application/json"};if(o)d.Authorization=`ApiKey ${o}`;else if(n&&i){const h=btoa(`${n}:${i}`);d.Authorization=`Basic ${h}`}const p=await fetch(`${l}/_cluster/health`,{method:"GET",headers:d});if(!p.ok)throw p.status===401?new Error("Authentication failed. Check your credentials or API key."):new Error(`HTTP ${p.status}: ${p.statusText}`);const f=await p.json();return this.createSuccessResult("Successfully connected to Elasticsearch cluster",{clusterName:f.cluster_name,status:f.status,numberOfNodes:f.number_of_nodes,activeShards:f.active_shards,relocatingShards:f.relocating_shards,initializingShards:f.initializing_shards,unassignedShards:f.unassigned_shards,activePrimaryShards:f.active_primary_shards,timestamp:new Date().toISOString()})}catch(l){if(l instanceof Error)return l.message.includes("Failed to fetch")?this.createErrorResult(`Cannot reach Elasticsearch at ${r}. Is the server running?`):this.createErrorResult(l.message);throw l}}catch(e){return this.createErrorResult(e)}}async queryIndex(e,r){try{const n=this.getConfig("url"),i=this.getConfig("username"),o=this.getConfig("password"),a=this.getConfig("apiKey"),l={"Content-Type":"application/json"};if(a)l.Authorization=`ApiKey ${a}`;else if(i&&o){const p=btoa(`${i}:${o}`);l.Authorization=`Basic ${p}`}const d=await fetch(`${n}/${e}/_search`,{method:"POST",headers:l,body:JSON.stringify(r)});if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);return await d.json()}catch(n){throw new Error(`Elasticsearch query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),cloudId:this.getConfig("cloudId")?"Configured":"Not configured",hasAuth:!!(this.getConfig("username")||this.getConfig("apiKey"))}}async getClusterInfo(){const e=this.getConfig("url"),r=this.buildHeaders(),n=await fetch(`${e}/`,{headers:r});if(!n.ok)throw new Error("Failed to get cluster info");return await n.json()}async getIndices(){const e=this.getConfig("url"),r=this.buildHeaders(),n=await fetch(`${e}/_cat/indices?format=json`,{headers:r});if(!n.ok)throw new Error("Failed to get indices");return await n.json()}async createIndex(e,r){const n=this.getConfig("url"),i=this.buildHeaders(),o=await fetch(`${n}/${e}`,{method:"PUT",headers:i,body:r?JSON.stringify(r):void 0});if(!o.ok)throw new Error("Failed to create index");return await o.json()}async indexDocument(e,r,n){const i=this.getConfig("url"),o=this.buildHeaders(),a=n?`${i}/${e}/_doc/${n}`:`${i}/${e}/_doc`,l=await fetch(a,{method:"POST",headers:o,body:JSON.stringify(r)});if(!l.ok)throw new Error("Failed to index document");return await l.json()}buildHeaders(){const e={"Content-Type":"application/json"},r=this.getConfig("apiKey"),n=this.getConfig("username"),i=this.getConfig("password");if(r)e.Authorization=`ApiKey ${r}`;else if(n&&i){const o=btoa(`${n}:${i}`);e.Authorization=`Basic ${o}`}return e}}class EN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("contactPoints","localhost"),n=this.getConfig("port",9042),i=this.getConfig("keyspace"),o=this.getConfig("username"),a=this.getConfig("password"),l=this.getConfig("datacenter","datacenter1"),d=this.getConfig("consistencyLevel","LOCAL_ONE");if(!r)return this.createErrorResult("Contact points are required");console.log("Validating Cassandra configuration (client-side only)");const p=r.split(",").map(f=>f.trim());return this.createSuccessResult("Configuration validated for Cassandra cluster",{validatedAt:new Date().toISOString(),contactPoints:p,port:n,keyspace:i,datacenter:l,consistencyLevel:d,hasAuth:!!(o&&a),note:"Client-side validation only. Cassandra uses native protocol (CQL) which requires backend integration."})}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"cassandra",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`Cassandra query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),contactPoints:this.getConfig("contactPoints"),port:this.getConfig("port",9042),keyspace:this.getConfig("keyspace"),datacenter:this.getConfig("datacenter","datacenter1"),consistencyLevel:this.getConfig("consistencyLevel","LOCAL_ONE"),hasAuth:!!(this.getConfig("username")&&this.getConfig("password"))}}async executePrepared(e,r){try{const n=await fetch("/api/data-sources/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"cassandra",query:e,params:r,prepared:!0})});if(!n.ok)throw new Error(`Prepared statement execution failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Cassandra prepared statement error: ${n instanceof Error?n.message:String(n)}`)}}async getKeyspaces(){return await this.query("SELECT * FROM system_schema.keyspaces;")}async getTables(e){const r=e||this.getConfig("keyspace");if(!r)throw new Error("Keyspace is required");const n=`SELECT * FROM system_schema.tables WHERE keyspace_name = '${r}';`;return await this.query(n)}async getColumns(e,r){const n=`SELECT * FROM system_schema.columns WHERE keyspace_name = '${e}' AND table_name = '${r}';`;return await this.query(n)}async createKeyspace(e,r="SimpleStrategy",n=1){const i=r==="SimpleStrategy"?`CREATE KEYSPACE IF NOT EXISTS ${e} WITH replication = {'class': 'SimpleStrategy', 'replication_factor': ${n}};`:`CREATE KEYSPACE IF NOT EXISTS ${e} WITH replication = {'class': 'NetworkTopologyStrategy', 'datacenter1': ${n}};`;return await this.query(i)}async executeBatch(e){const r=`BEGIN BATCH
${e.join(`
`)}
APPLY BATCH;`;return await this.query(r)}async getClusterInfo(){return await this.query("SELECT * FROM system.peers;")}}class CN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("account"),n=this.getConfig("username"),i=this.getConfig("password"),o=this.getConfig("warehouse"),a=this.getConfig("database"),l=this.getConfig("schema","PUBLIC"),d=this.getConfig("role");return!r||!n||!i?this.createErrorResult("Account, username, and password are required"):(console.log("Validating Snowflake configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Snowflake account "${r}"`,{validatedAt:new Date().toISOString(),account:r,username:n,warehouse:o,database:a,schema:l,role:d,note:"Client-side validation only. Snowflake connections require backend integration with snowflake-sdk."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"snowflake",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`Snowflake query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),account:this.getConfig("account"),warehouse:this.getConfig("warehouse"),database:this.getConfig("database"),schema:this.getConfig("schema","PUBLIC"),role:this.getConfig("role")}}async getDatabases(){return await this.query("SHOW DATABASES;")}async getSchemas(e){const r=e||this.getConfig("database");return await this.query(r?`SHOW SCHEMAS IN DATABASE ${r};`:"SHOW SCHEMAS;")}async getTables(e,r){const n=e||this.getConfig("database"),i=r||this.getConfig("schema");return n&&i?await this.query(`SHOW TABLES IN ${n}.${i};`):n?await this.query(`SHOW TABLES IN DATABASE ${n};`):await this.query("SHOW TABLES;")}async getWarehouses(){return await this.query("SHOW WAREHOUSES;")}async useWarehouse(e){return await this.query(`USE WAREHOUSE ${e};`)}async useDatabase(e){return await this.query(`USE DATABASE ${e};`)}async getAccountUsage(e=7){return await this.query(`
      SELECT * FROM SNOWFLAKE.ACCOUNT_USAGE.QUERY_HISTORY
      WHERE START_TIME >= DATEADD(day, -${e}, CURRENT_TIMESTAMP())
      ORDER BY START_TIME DESC
      LIMIT 100;
    `)}}class jN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Finnhub API connection...");try{const n="AAPL",i=`https://finnhub.io/api/v1/quote?symbol=${n}&token=${r}`,o=await fetch(i);if(!o.ok)throw o.status===401||o.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${o.status}: ${o.statusText}`);const a=await o.json();if(a.error)throw new Error(a.error);return a.c!==void 0?this.createSuccessResult("Successfully connected to Finnhub API",{testSymbol:n,currentPrice:a.c,change:a.d,percentChange:a.dp,high:a.h,low:a.l,open:a.o,previousClose:a.pc,timestamp:a.t,note:"API key validated successfully"}):this.createSuccessResult("Successfully connected to Finnhub API",{timestamp:new Date().toISOString(),note:"API key validated successfully"})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=new URLSearchParams({...r,token:n}),o=`https://finnhub.io/api/v1${e}?${i.toString()}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);const l=await a.json();if(l.error)throw new Error(l.error);return l}catch(n){throw new Error(`Finnhub query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Finnhub",features:["Stocks","Forex","Crypto","News","Company Info","Financial Statements"]}}async getQuote(e){return await this.query("/quote",{symbol:e})}async getCandles(e,r,n,i){return await this.query("/stock/candle",{symbol:e,resolution:r,from:n,to:i})}async getCompanyProfile(e){return await this.query("/stock/profile2",{symbol:e})}async getCompanyNews(e,r,n){return await this.query("/company-news",{symbol:e,from:r,to:n})}async getMarketNews(e="general"){return await this.query("/news",{category:e})}async getPeers(e){return await this.query("/stock/peers",{symbol:e})}async getBasicFinancials(e,r="all"){return await this.query("/stock/metric",{symbol:e,metric:r})}async getRecommendations(e){return await this.query("/stock/recommendation",{symbol:e})}async getPriceTarget(e){return await this.query("/stock/price-target",{symbol:e})}async getEarningsCalendar(e,r,n){const i={};return e&&(i.from=e),r&&(i.to=r),n&&(i.symbol=n),await this.query("/calendar/earnings",i)}async getIPOCalendar(e,r){return await this.query("/calendar/ipo",{from:e,to:r})}async searchSymbol(e){return await this.query("/search",{q:e})}async getSymbols(e){return await this.query("/stock/symbol",{exchange:e})}async getForexRates(e="USD"){return await this.query("/forex/rates",{base:e})}async getCryptoExchanges(){return await this.query("/crypto/exchange",{})}async getCryptoSymbols(e){return await this.query("/crypto/symbol",{exchange:e})}}class kN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("projectId"),n=this.getConfig("credentials"),i=this.getConfig("dataset");if(!r)return this.createErrorResult("Project ID is required");if(!n)return this.createErrorResult("Service account credentials (JSON) are required");try{const o=JSON.parse(n);if(!o.type||!o.project_id||!o.private_key)return this.createErrorResult("Invalid credentials format. Expected service account JSON.")}catch{return this.createErrorResult("Credentials must be valid JSON")}return console.log("Validating BigQuery configuration (client-side only)"),this.createSuccessResult(`Configuration validated for BigQuery project "${r}"`,{validatedAt:new Date().toISOString(),projectId:r,dataset:i,hasCredentials:!0,note:"Client-side validation only. BigQuery connections require backend integration with @google-cloud/bigquery."})}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"bigquery",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`BigQuery query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),projectId:this.getConfig("projectId"),dataset:this.getConfig("dataset"),hasCredentials:!!this.getConfig("credentials")}}async getDatasets(){const e=this.getConfig("projectId");return await this.query(`
      SELECT schema_name as dataset_name
      FROM \`${e}.INFORMATION_SCHEMA.SCHEMATA\`
      ORDER BY schema_name;
    `)}async getTables(e){const r=this.getConfig("projectId"),n=e||this.getConfig("dataset");if(!n)throw new Error("Dataset is required");return await this.query(`
      SELECT table_name, table_type, creation_time
      FROM \`${r}.${n}.INFORMATION_SCHEMA.TABLES\`
      ORDER BY table_name;
    `)}async getTableSchema(e,r){const n=this.getConfig("projectId");return await this.query(`
      SELECT column_name, data_type, is_nullable, is_partitioning_column
      FROM \`${n}.${e}.INFORMATION_SCHEMA.COLUMNS\`
      WHERE table_name = '${r}'
      ORDER BY ordinal_position;
    `)}async getTableStats(e,r){const n=this.getConfig("projectId");return await this.query(`
      SELECT
        table_name,
        row_count,
        size_bytes,
        TIMESTAMP_MILLIS(creation_time) as creation_time,
        TIMESTAMP_MILLIS(last_modified_time) as last_modified_time
      FROM \`${n}.${e}.__TABLES__\`
      WHERE table_id = '${r}';
    `)}async queryWithParams(e,r){try{const n=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"bigquery",query:e,params:r})});if(!n.ok)throw new Error(`Parameterized query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`BigQuery parameterized query error: ${n instanceof Error?n.message:String(n)}`)}}async getJobStatus(e){try{const r=await fetch("/api/data-sources/job-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"bigquery",jobId:e})});if(!r.ok)throw new Error(`Failed to get job status: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`BigQuery job status error: ${r instanceof Error?r.message:String(r)}`)}}async estimateQueryCost(e){try{const r=await fetch("/api/data-sources/estimate-cost",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"bigquery",query:e})});if(!r.ok)throw new Error(`Failed to estimate cost: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`BigQuery cost estimation error: ${r instanceof Error?r.message:String(r)}`)}}}class AN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("brokers","localhost:9092"),n=this.getConfig("clientId","fincept-terminal"),i=this.getConfig("saslMechanism"),o=this.getConfig("saslUsername"),a=this.getConfig("saslPassword"),l=this.getConfig("ssl",!1);if(!r)return this.createErrorResult("Broker addresses are required");const d=r.split(",").map(p=>p.trim());return console.log("Validating Kafka configuration (client-side only)"),this.createSuccessResult("Configuration validated for Kafka cluster",{validatedAt:new Date().toISOString(),brokers:d,clientId:n,ssl:l,hasSasl:!!(i&&o&&a),saslMechanism:i,note:"Client-side validation only. Kafka connections require backend integration with kafkajs or similar library."})}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/kafka",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"kafka",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Kafka operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),brokers:this.getConfig("brokers"),clientId:this.getConfig("clientId","fincept-terminal"),ssl:this.getConfig("ssl",!1),hasSasl:!!(this.getConfig("saslUsername")&&this.getConfig("saslPassword")),saslMechanism:this.getConfig("saslMechanism")}}async listTopics(){return await this.query("listTopics")}async getTopicMetadata(e){return await this.query("getTopicMetadata",{topics:e})}async createTopic(e,r=1,n=1){return await this.query("createTopic",{topic:e,numPartitions:r,replicationFactor:n})}async deleteTopic(e){return await this.query("deleteTopic",{topic:e})}async produce(e,r){return await this.query("produce",{topic:e,messages:r})}async consume(e,r,n){return await this.query("consume",{topic:e,groupId:r,...n})}async getConsumerGroups(){return await this.query("getConsumerGroups")}async getConsumerGroupOffsets(e,r){return await this.query("getConsumerGroupOffsets",{groupId:e,topics:r})}async getTopicOffsets(e){return await this.query("getTopicOffsets",{topic:e})}async seekToOffset(e,r,n){return await this.query("seekToOffset",{topic:e,partition:r,offset:n})}async getClusterMetadata(){return await this.query("getClusterMetadata")}async getConsumerGroupMembers(e){return await this.query("getConsumerGroupMembers",{groupId:e})}async resetConsumerGroupOffsets(e,r,n=!1){return await this.query("resetConsumerGroupOffsets",{groupId:e,topic:r,toEarliest:n})}async getPartitionCount(e){return await this.query("getPartitionCount",{topic:e})}async topicExists(e){return(await this.query("topicExists",{topic:e})).exists}}class TN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host","localhost"),n=this.getConfig("port",8123),i=this.getConfig("database","default"),o=this.getConfig("username","default"),a=this.getConfig("password"),l=this.getConfig("protocol","http");if(!r)return this.createErrorResult("Host is required");console.log("Testing ClickHouse connection...");try{const d=`${l}://${r}:${n}`,p={};if(o&&a){const m=btoa(`${o}:${a}`);p.Authorization=`Basic ${m}`}const f=`${d}/?query=${encodeURIComponent("SELECT version()")}`,h=await fetch(f,{method:"GET",headers:p});if(!h.ok)throw h.status===401?new Error("Authentication failed. Check your credentials."):new Error(`HTTP ${h.status}: ${h.statusText}`);const x=await h.text();return this.createSuccessResult(`Successfully connected to ClickHouse at ${r}:${n}`,{version:x.trim(),host:r,port:n,database:i,protocol:l,authenticated:!!(o&&a),timestamp:new Date().toISOString()})}catch(d){if(d instanceof Error)return d.message.includes("Failed to fetch")?this.createErrorResult(`Cannot reach ClickHouse at ${r}:${n}. Is the server running?`):this.createErrorResult(d.message);throw d}}catch(e){return this.createErrorResult(e)}}async query(e,r="JSON"){try{const n=this.getConfig("host"),i=this.getConfig("port",8123),o=this.getConfig("database","default"),a=this.getConfig("username"),l=this.getConfig("password"),p=`${this.getConfig("protocol","http")}://${n}:${i}`,f={"Content-Type":"text/plain"};if(a&&l){const b=btoa(`${a}:${l}`);f.Authorization=`Basic ${b}`}const h=o!=="default"?`USE ${o}; ${e}`:e,x=`${p}/?query=${encodeURIComponent(h)}&default_format=${r}`,m=await fetch(x,{method:"GET",headers:f});if(!m.ok){const b=await m.text();throw new Error(`Query failed: ${m.status} - ${b}`)}if(r==="JSON"){const b=await m.text();return b.trim()?JSON.parse(b):{data:[],rows:0}}return await m.text()}catch(n){throw new Error(`ClickHouse query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",8123),database:this.getConfig("database","default"),protocol:this.getConfig("protocol","http"),hasAuth:!!(this.getConfig("username")&&this.getConfig("password"))}}async getDatabases(){return await this.query("SHOW DATABASES")}async getTables(e){const r=e||this.getConfig("database","default");return await this.query(`SHOW TABLES FROM ${r}`)}async getTableSchema(e,r){const n=r||this.getConfig("database","default");return await this.query(`DESCRIBE TABLE ${n}.${e}`)}async getTableStats(e,r){const n=r||this.getConfig("database","default");return await this.query(`
      SELECT
        table,
        sum(rows) as total_rows,
        formatReadableSize(sum(bytes)) as total_size,
        sum(bytes) as bytes,
        min(min_date) as min_date,
        max(max_date) as max_date
      FROM system.parts
      WHERE database = '${n}' AND table = '${e}' AND active
      GROUP BY table
    `)}async getClusterInfo(){return await this.query("SELECT * FROM system.clusters")}async getRunningQueries(){return await this.query("SELECT * FROM system.processes")}async killQuery(e){return await this.query(`KILL QUERY WHERE query_id = '${e}'`)}async optimizeTable(e,r){const n=r||this.getConfig("database","default");return await this.query(`OPTIMIZE TABLE ${n}.${e}`)}async getSystemMetrics(){return await this.query("SELECT * FROM system.metrics")}async getQueryLog(e=100){return await this.query(`
      SELECT
        type,
        query_start_time,
        query_duration_ms,
        query,
        read_rows,
        read_bytes,
        result_rows,
        result_bytes,
        memory_usage
      FROM system.query_log
      WHERE type = 'QueryFinish'
      ORDER BY query_start_time DESC
      LIMIT ${e}
    `)}async insert(e,r,n){try{const i=this.getConfig("host"),o=this.getConfig("port",8123),a=n||this.getConfig("database","default"),l=this.getConfig("username"),d=this.getConfig("password"),f=`${this.getConfig("protocol","http")}://${i}:${o}`,h={"Content-Type":"application/json"};if(l&&d){const w=btoa(`${l}:${d}`);h.Authorization=`Basic ${w}`}const x=`${f}/?query=${encodeURIComponent(`INSERT INTO ${a}.${e} FORMAT JSONEachRow`)}`,m=r.map(w=>JSON.stringify(w)).join(`
`),b=await fetch(x,{method:"POST",headers:h,body:m});if(!b.ok){const w=await b.text();throw new Error(`Insert failed: ${b.status} - ${w}`)}return{success:!0,rowsInserted:r.length}}catch(i){throw new Error(`ClickHouse insert error: ${i instanceof Error?i.message:String(i)}`)}}}class RN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",5439),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password"),l=this.getConfig("ssl",!0);return!r||!i||!o||!a?this.createErrorResult("Missing required connection parameters"):(console.log("Validating Amazon Redshift configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Redshift cluster "${r}"`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,username:o,ssl:l,note:"Client-side validation only. Redshift uses PostgreSQL wire protocol and requires backend integration."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"redshift",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`Redshift query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",5439),database:this.getConfig("database"),ssl:this.getConfig("ssl",!0)}}async getClusterInfo(){return await this.query("SELECT * FROM svv_node_info;")}async getRunningQueries(){return await this.query(`
      SELECT query, pid, user_name, starttime, duration
      FROM stv_recents
      WHERE status = 'Running'
      ORDER BY starttime DESC;
    `)}async getTableStats(e,r){return await this.query(`
      SELECT
        tbl,
        COUNT(*) as rows,
        SUM(size) * 1024 * 1024 as size_bytes
      FROM svv_table_info
      WHERE schema = '${e}' AND "table" = '${r}'
      GROUP BY tbl;
    `)}async analyzeTable(e,r){return await this.query(`ANALYZE ${e}.${r};`)}async vacuumTable(e,r){return await this.query(`VACUUM ${e}.${r};`)}}class NN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url","http://localhost:9090"),n=this.getConfig("username"),i=this.getConfig("password");if(!r)return this.createErrorResult("URL is required");console.log("Testing Prometheus connection...");try{const o={};if(n&&i){const p=btoa(`${n}:${i}`);o.Authorization=`Basic ${p}`}const a=await fetch(`${r}/-/healthy`,{method:"GET",headers:o});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const l=await fetch(`${r}/api/v1/status/buildinfo`,{headers:o});let d={};return l.ok&&(d=(await l.json()).data||{}),this.createSuccessResult("Successfully connected to Prometheus",{url:r,version:d.version||"Unknown",goVersion:d.goVersion,timestamp:new Date().toISOString()})}catch(o){if(o instanceof Error)return o.message.includes("Failed to fetch")?this.createErrorResult(`Cannot reach Prometheus at ${r}. Is the server running?`):this.createErrorResult(o.message);throw o}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("url"),i=this.getConfig("username"),o=this.getConfig("password"),a={};if(i&&o){const f=btoa(`${i}:${o}`);a.Authorization=`Basic ${f}`}const l=new URLSearchParams({query:e});r&&l.append("time",r.toString());const d=await fetch(`${n}/api/v1/query?${l.toString()}`,{method:"GET",headers:a});if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);const p=await d.json();if(p.status!=="success")throw new Error(p.error||"Query failed");return p.data}catch(n){throw new Error(`Prometheus query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),hasAuth:!!(this.getConfig("username")&&this.getConfig("password"))}}async queryRange(e,r,n,i){const o=this.getConfig("url"),a=this.getConfig("username"),l=this.getConfig("password"),d={};if(a&&l){const x=btoa(`${a}:${l}`);d.Authorization=`Basic ${x}`}const p=new URLSearchParams({query:e,start:r.toString(),end:n.toString(),step:i}),f=await fetch(`${o}/api/v1/query_range?${p.toString()}`,{method:"GET",headers:d});if(!f.ok)throw new Error(`Range query failed: ${f.status} ${f.statusText}`);return(await f.json()).data}async getMetricNames(){const e=this.getConfig("url"),r=this.getConfig("username"),n=this.getConfig("password"),i={};if(r&&n){const l=btoa(`${r}:${n}`);i.Authorization=`Basic ${l}`}const o=await fetch(`${e}/api/v1/label/__name__/values`,{headers:i});if(!o.ok)throw new Error("Failed to get metric names");return(await o.json()).data||[]}async getLabelValues(e){const r=this.getConfig("url"),n=this.getConfig("username"),i=this.getConfig("password"),o={};if(n&&i){const d=btoa(`${n}:${i}`);o.Authorization=`Basic ${d}`}const a=await fetch(`${r}/api/v1/label/${e}/values`,{headers:o});if(!a.ok)throw new Error(`Failed to get values for label ${e}`);return(await a.json()).data||[]}async getTargets(){const e=this.getConfig("url"),r=this.getConfig("username"),n=this.getConfig("password"),i={};if(r&&n){const l=btoa(`${r}:${n}`);i.Authorization=`Basic ${l}`}const o=await fetch(`${e}/api/v1/targets`,{headers:i});if(!o.ok)throw new Error("Failed to get targets");return(await o.json()).data}}class ON extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url","bolt://localhost:7687"),n=this.getConfig("username","neo4j"),i=this.getConfig("password"),o=this.getConfig("database","neo4j");return!r||!n||!i?this.createErrorResult("URL, username, and password are required"):(console.log("Validating Neo4j configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Neo4j at ${r}`,{validatedAt:new Date().toISOString(),url:r,username:n,database:o,note:"Client-side validation only. Neo4j uses Bolt protocol and requires backend integration with neo4j-driver."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"neo4j",query:e,params:r})});if(!n.ok)throw new Error(`Query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Neo4j query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),database:this.getConfig("database","neo4j"),username:this.getConfig("username","neo4j")}}async getDatabaseInfo(){return await this.query("CALL dbms.components() YIELD name, versions, edition RETURN name, versions, edition")}async getNodeLabels(){return await this.query("CALL db.labels()")}async getRelationshipTypes(){return await this.query("CALL db.relationshipTypes()")}async getPropertyKeys(){return await this.query("CALL db.propertyKeys()")}async getDatabaseStats(){return await this.query(`
      MATCH (n)
      WITH count(n) as nodeCount
      MATCH ()-[r]->()
      WITH nodeCount, count(r) as relationshipCount
      RETURN nodeCount, relationshipCount
    `)}async createNode(e,r){const n=Object.entries(r).map(([i,o])=>`${i}: $${i}`).join(", ");return await this.query(`CREATE (n:${e} {${n}}) RETURN n`,r)}async createRelationship(e,r,n,i){const o=i?`{${Object.entries(i).map(([l,d])=>`${l}: $${l}`).join(", ")}}`:"",a={fromId:e,toId:r,...i};return await this.query(`
      MATCH (a), (b)
      WHERE id(a) = $fromId AND id(b) = $toId
      CREATE (a)-[r:${n} ${o}]->(b)
      RETURN r
    `,a)}async findNodes(e,r,n=100){if(r&&Object.keys(r).length>0){const i=Object.entries(r).map(([o,a])=>`n.${o} = $${o}`).join(" AND ");return await this.query(`MATCH (n:${e}) WHERE ${i} RETURN n LIMIT ${n}`,r)}return await this.query(`MATCH (n:${e}) RETURN n LIMIT ${n}`)}async shortestPath(e,r,n=5){return await this.query(`
      MATCH (start), (end)
      WHERE id(start) = $fromId AND id(end) = $toId
      MATCH p = shortestPath((start)-[*..${n}]-(end))
      RETURN p
    `,{fromId:e,toId:r})}}class Ab extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("accessKeyId"),n=this.getConfig("secretAccessKey"),i=this.getConfig("region","us-east-1"),o=this.getConfig("bucket");return!r||!n?this.createErrorResult("Access Key ID and Secret Access Key are required"):(console.log("Validating AWS S3 configuration (client-side only)"),this.createSuccessResult(`Configuration validated for S3${o?` bucket "${o}"`:""}`,{validatedAt:new Date().toISOString(),region:i,bucket:o,hasCredentials:!0,note:"Client-side validation only. S3 operations require backend integration with AWS SDK."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/s3",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"s3",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`S3 operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),region:this.getConfig("region","us-east-1"),bucket:this.getConfig("bucket"),hasCredentials:!!(this.getConfig("accessKeyId")&&this.getConfig("secretAccessKey"))}}async listBuckets(){return await this.query("listBuckets")}async listObjects(e,r,n=1e3){const i=e||this.getConfig("bucket");return await this.query("listObjects",{bucket:i,prefix:r,maxKeys:n})}async getObjectMetadata(e,r){const n=r||this.getConfig("bucket");return await this.query("getObjectMetadata",{bucket:n,key:e})}async getObject(e,r){const n=r||this.getConfig("bucket");return await this.query("getObject",{bucket:n,key:e})}async putObject(e,r,n,i){const o=n||this.getConfig("bucket");return await this.query("putObject",{bucket:o,key:e,data:r,contentType:i})}async deleteObject(e,r){const n=r||this.getConfig("bucket");return await this.query("deleteObject",{bucket:n,key:e})}async deleteObjects(e,r){const n=r||this.getConfig("bucket");return await this.query("deleteObjects",{bucket:n,keys:e})}async copyObject(e,r,n){const i=n||this.getConfig("bucket");return await this.query("copyObject",{bucket:i,sourceKey:e,destinationKey:r})}async getPresignedUrl(e,r=3600,n){const i=n||this.getConfig("bucket");return(await this.query("getPresignedUrl",{bucket:i,key:e,expiresIn:r})).url}async createBucket(e,r){const n=r||this.getConfig("region","us-east-1");return await this.query("createBucket",{bucket:e,region:n})}async deleteBucket(e){return await this.query("deleteBucket",{bucket:e})}async getBucketVersioning(e){const r=e||this.getConfig("bucket");return await this.query("getBucketVersioning",{bucket:r})}async setBucketVersioning(e,r){const n=r||this.getConfig("bucket");return await this.query("setBucketVersioning",{bucket:n,enabled:e})}}class _N extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("endpoint"),n=this.getConfig("apiKey"),i=this.getConfig("authHeader","Authorization"),o=this.getConfig("authPrefix","Bearer");if(!r)return this.createErrorResult("Endpoint URL is required");console.log("Testing GraphQL endpoint...");try{const a={"Content-Type":"application/json"};n&&(a[i]=`${o} ${n}`);const d=await fetch(r,{method:"POST",headers:a,body:JSON.stringify({query:`
          {
            __schema {
              queryType { name }
              mutationType { name }
              subscriptionType { name }
            }
          }
        `})});if(!d.ok)throw d.status===401||d.status===403?new Error("Authentication failed. Check your API key or credentials."):new Error(`HTTP ${d.status}: ${d.statusText}`);const p=await d.json();if(p.errors){if(p.errors[0]?.message?.includes("introspection"))return this.createSuccessResult("Successfully connected to GraphQL endpoint",{endpoint:r,note:"Introspection is disabled on this endpoint, but connection is valid",timestamp:new Date().toISOString()});throw new Error(p.errors[0].message)}return this.createSuccessResult("Successfully connected to GraphQL endpoint",{endpoint:r,queryType:p.data?.__schema?.queryType?.name,mutationType:p.data?.__schema?.mutationType?.name,subscriptionType:p.data?.__schema?.subscriptionType?.name,timestamp:new Date().toISOString()})}catch(a){if(a instanceof Error)return a.message.includes("Failed to fetch")?this.createErrorResult(`Cannot reach GraphQL endpoint at ${r}.`):this.createErrorResult(a.message);throw a}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("endpoint"),i=this.getConfig("apiKey"),o=this.getConfig("authHeader","Authorization"),a=this.getConfig("authPrefix","Bearer"),l={"Content-Type":"application/json"};i&&(l[o]=`${a} ${i}`);const d=await fetch(n,{method:"POST",headers:l,body:JSON.stringify({query:e,variables:r})});if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);const p=await d.json();if(p.errors)throw new Error(p.errors.map(f=>f.message).join(", "));return p.data}catch(n){throw new Error(`GraphQL query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),endpoint:this.getConfig("endpoint"),hasApiKey:!!this.getConfig("apiKey"),authHeader:this.getConfig("authHeader","Authorization"),authPrefix:this.getConfig("authPrefix","Bearer")}}async getSchema(){return await this.query(`
      {
        __schema {
          types {
            name
            kind
            description
            fields {
              name
              type {
                name
                kind
              }
            }
          }
        }
      }
    `)}async getQueryType(){return await this.query(`
      {
        __schema {
          queryType {
            name
            fields {
              name
              description
              args {
                name
                type {
                  name
                  kind
                }
              }
              type {
                name
                kind
              }
            }
          }
        }
      }
    `)}async getMutationType(){return await this.query(`
      {
        __schema {
          mutationType {
            name
            fields {
              name
              description
              args {
                name
                type {
                  name
                  kind
                }
              }
              type {
                name
                kind
              }
            }
          }
        }
      }
    `)}async mutate(e,r){return await this.query(e,r)}}class DN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("baseUrl"),n=this.getConfig("apiKey"),i=this.getConfig("authHeader","Authorization"),o=this.getConfig("authPrefix","Bearer"),a=this.getConfig("testEndpoint","");if(!r)return this.createErrorResult("Base URL is required");console.log("Testing REST API connection...");try{const l={"Content-Type":"application/json"};n&&(l[i]=`${o} ${n}`);const d=a?`${r}${a}`:r,p=await fetch(d,{method:"GET",headers:l});if(!p.ok)throw p.status===401||p.status===403?new Error("Authentication failed. Check your API key or credentials."):p.status===404&&a?new Error(`Test endpoint not found: ${a}`):new Error(`HTTP ${p.status}: ${p.statusText}`);const f=p.headers.get("content-type"),h=f?.includes("application/json");return this.createSuccessResult("Successfully connected to REST API",{baseUrl:r,testEndpoint:a||"Base URL only",contentType:f,isJson:h,status:p.status,timestamp:new Date().toISOString()})}catch(l){if(l instanceof Error)return l.message.includes("Failed to fetch")?this.createErrorResult(`Cannot reach REST API at ${r}.`):this.createErrorResult(l.message);throw l}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("baseUrl"),i=this.getConfig("apiKey"),o=this.getConfig("authHeader","Authorization"),a=this.getConfig("authPrefix","Bearer"),l={"Content-Type":"application/json",...r?.headers};i&&(l[o]=`${a} ${i}`);const d=e.startsWith("http")?e:`${n}${e}`,p=await fetch(d,{...r,headers:l});if(!p.ok)throw new Error(`Request failed: ${p.status} ${p.statusText}`);return p.headers.get("content-type")?.includes("application/json")?await p.json():await p.text()}catch(n){throw new Error(`REST API error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),baseUrl:this.getConfig("baseUrl"),hasApiKey:!!this.getConfig("apiKey"),authHeader:this.getConfig("authHeader","Authorization"),authPrefix:this.getConfig("authPrefix","Bearer"),testEndpoint:this.getConfig("testEndpoint","")}}async get(e,r){const n=r?`?${new URLSearchParams(r).toString()}`:"";return await this.query(`${e}${n}`,{method:"GET"})}async post(e,r){return await this.query(e,{method:"POST",body:JSON.stringify(r)})}async put(e,r){return await this.query(e,{method:"PUT",body:JSON.stringify(r)})}async patch(e,r){return await this.query(e,{method:"PATCH",body:JSON.stringify(r)})}async delete(e){return await this.query(e,{method:"DELETE"})}async head(e){return await this.query(e,{method:"HEAD"})}async options(e){return await this.query(e,{method:"OPTIONS"})}}class IN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filePath"),n=this.getConfig("url");if(!r&&!n)return this.createErrorResult("Either file path or URL is required");if(console.log("Validating Excel file configuration (client-side only)"),n)try{const i=await fetch(n,{method:"HEAD"});if(!i.ok)throw new Error(`URL not accessible: ${i.status} ${i.statusText}`);const o=i.headers.get("content-type"),a=i.headers.get("content-length");return o?.includes("spreadsheet")||o?.includes("excel")||n.toLowerCase().endsWith(".xlsx")||n.toLowerCase().endsWith(".xls")?this.createSuccessResult("Excel file accessible at URL",{url:n,contentType:o,size:a?`${(parseInt(a)/1024).toFixed(2)} KB`:"Unknown",timestamp:new Date().toISOString()}):this.createErrorResult("URL does not appear to point to an Excel file. Expected .xlsx or .xls file.")}catch(i){return this.createErrorResult(`Failed to access Excel file at URL: ${i instanceof Error?i.message:String(i)}`)}return this.createSuccessResult(`Configuration validated for Excel file "${r}"`,{validatedAt:new Date().toISOString(),filePath:r,note:"Client-side validation only. Full file parsing requires backend integration with xlsx library."})}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/excel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"excel",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Excel operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),filePath:this.getConfig("filePath"),url:this.getConfig("url")}}async getSheets(){return(await this.query("getSheets")).sheets||[]}async readSheet(e,r){return await this.query("readSheet",{sheetName:e,...r})}async readAll(){return await this.query("readAll")}async getSheetInfo(e){return await this.query("getSheetInfo",{sheetName:e})}async readRange(e,r){return await this.query("readRange",{sheetName:e,range:r})}async search(e,r){return await this.query("search",{sheetName:e,searchValue:r})}async getCellValue(e,r){return await this.query("getCellValue",{sheetName:e,cell:r})}async sheetToJSON(e,r){return await this.query("sheetToJSON",{sheetName:e,...r})}}class PN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filePath"),n=this.getConfig("url");if(!r&&!n)return this.createErrorResult("Either file path or URL is required");if(console.log("Testing JSON source..."),n)try{const i=await fetch(n,{method:"GET"});if(!i.ok)throw new Error(`URL not accessible: ${i.status} ${i.statusText}`);const o=i.headers.get("content-type"),a=await i.text();let l;try{l=JSON.parse(a)}catch{throw new Error("Response is not valid JSON")}const d=Array.isArray(l),p=d?l.length:Object.keys(l).length,f=d?"array":typeof l;return this.createSuccessResult("Successfully loaded JSON from URL",{url:n,contentType:o,dataType:f,itemCount:p,size:a.length,timestamp:new Date().toISOString()})}catch(i){return this.createErrorResult(`Failed to load JSON from URL: ${i instanceof Error?i.message:String(i)}`)}return this.createSuccessResult(`Configuration validated for JSON file "${r}"`,{validatedAt:new Date().toISOString(),filePath:r,note:"Client-side validation only. Full file parsing requires backend integration."})}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=this.getConfig("filePath"),n=this.getConfig("url");if(n){const o=await fetch(n);if(!o.ok)throw new Error(`Failed to fetch JSON: ${o.status} ${o.statusText}`);let a=await o.json();return e&&(a=this.applyJSONPath(a,e)),a}const i=await fetch("/api/data-sources/json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"json",operation:"read",params:{filePath:r,jsonPath:e}})});if(!i.ok)throw new Error(`Query failed: ${i.statusText}`);return await i.json()}catch(r){throw new Error(`JSON query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),filePath:this.getConfig("filePath"),url:this.getConfig("url")}}applyJSONPath(e,r){if(!r||r==="$")return e;const i=r.replace(/^\$\.?/,"").split(".");let o=e;for(const a of i){const l=a.match(/^(.+)\[(\d+)\]$/);if(l){const[,d,p]=l;o=o[d]?.[parseInt(p)]}else o=o[a];if(o===void 0)return null}return o}async getAsArray(e){const r=await this.query(e);return Array.isArray(r)?r:typeof r=="object"&&r!==null?Object.values(r):[r]}async filter(e,r){return(await this.getAsArray(r)).filter(e)}async map(e,r){return(await this.getAsArray(r)).map(e)}async find(e,r){return(await this.getAsArray(r)).find(e)}async count(e){const r=await this.query(e);return Array.isArray(r)?r.length:typeof r=="object"&&r!==null?Object.keys(r).length:1}async getKeys(e){const r=await this.query(e);return typeof r=="object"&&r!==null?Object.keys(r):[]}async getValue(e){return await this.query(e)}}class LN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filePath"),n=this.getConfig("url");if(!r&&!n)return this.createErrorResult("Either file path or URL is required");if(console.log("Validating Parquet file configuration (client-side only)"),n)try{const i=await fetch(n,{method:"HEAD"});if(!i.ok)throw new Error(`URL not accessible: ${i.status} ${i.statusText}`);const o=i.headers.get("content-type"),a=i.headers.get("content-length");return this.createSuccessResult("Parquet file accessible at URL",{url:n,contentType:o,size:a?`${(parseInt(a)/1024/1024).toFixed(2)} MB`:"Unknown",timestamp:new Date().toISOString()})}catch(i){return this.createErrorResult(`Failed to access Parquet file at URL: ${i instanceof Error?i.message:String(i)}`)}return this.createSuccessResult(`Configuration validated for Parquet file "${r}"`,{validatedAt:new Date().toISOString(),filePath:r,note:"Client-side validation only. Parquet parsing requires backend integration with parquetjs or arrow."})}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/parquet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"parquet",operation:"query",params:{sql:e}})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`Parquet query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),filePath:this.getConfig("filePath"),url:this.getConfig("url")}}async getFileMetadata(){try{const e=await fetch("/api/data-sources/parquet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"parquet",operation:"getMetadata"})});if(!e.ok)throw new Error(`Failed to get metadata: ${e.statusText}`);return await e.json()}catch(e){throw new Error(`Parquet metadata error: ${e instanceof Error?e.message:String(e)}`)}}async getSchema(){try{const e=await fetch("/api/data-sources/parquet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"parquet",operation:"getSchema"})});if(!e.ok)throw new Error(`Failed to get schema: ${e.statusText}`);return await e.json()}catch(e){throw new Error(`Parquet schema error: ${e instanceof Error?e.message:String(e)}`)}}async readRows(e,r){try{const n=await fetch("/api/data-sources/parquet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"parquet",operation:"readRows",params:{limit:e,offset:r}})});if(!n.ok)throw new Error(`Failed to read rows: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Parquet read error: ${n instanceof Error?n.message:String(n)}`)}}async getRowCount(){try{const e=await fetch("/api/data-sources/parquet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"parquet",operation:"getRowCount"})});if(!e.ok)throw new Error(`Failed to get row count: ${e.statusText}`);return(await e.json()).count||0}catch(e){throw new Error(`Parquet count error: ${e instanceof Error?e.message:String(e)}`)}}async getColumnStats(e){try{const r=await fetch("/api/data-sources/parquet",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"parquet",operation:"getColumnStats",params:{columnName:e}})});if(!r.ok)throw new Error(`Failed to get column stats: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`Parquet stats error: ${r instanceof Error?r.message:String(r)}`)}}async toJSON(e){return await this.readRows(e)}}class zN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey"),n=this.getConfig("isPro",!1);console.log("Testing CoinGecko API connection...");try{const i=n?"https://pro-api.coingecko.com/api/v3":"https://api.coingecko.com/api/v3",o={};r&&n&&(o["x-cg-pro-api-key"]=r);const a=await fetch(`${i}/ping`,{method:"GET",headers:o});if(!a.ok)throw a.status===401||a.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${a.status}: ${a.statusText}`);const l=await a.json();return l.gecko_says?this.createSuccessResult("Successfully connected to CoinGecko API",{message:l.gecko_says,apiType:n?"Pro":"Free",hasApiKey:!!r,timestamp:new Date().toISOString()}):this.createSuccessResult("Successfully connected to CoinGecko API",{apiType:n?"Pro":"Free",hasApiKey:!!r,timestamp:new Date().toISOString()})}catch(i){if(i instanceof Error)return this.createErrorResult(i.message);throw i}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=this.getConfig("isPro",!1),o=i?"https://pro-api.coingecko.com/api/v3":"https://api.coingecko.com/api/v3",a={};n&&i&&(a["x-cg-pro-api-key"]=n);const l=r?`?${new URLSearchParams(r).toString()}`:"",d=`${o}${e}${l}`,p=await fetch(d,{method:"GET",headers:a});if(!p.ok)throw new Error(`Query failed: ${p.status} ${p.statusText}`);return await p.json()}catch(n){throw new Error(`CoinGecko query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),isPro:this.getConfig("isPro",!1),provider:"CoinGecko",features:["Crypto Prices","Market Data","NFTs","Exchanges","Trending"]}}async getCoinPrice(e,r="usd",n=!1){const i={ids:e,vs_currencies:r};return n&&(i.include_market_cap="true",i.include_24hr_vol="true",i.include_24hr_change="true"),await this.query("/simple/price",i)}async getCoinList(){return await this.query("/coins/list")}async getCoinMarkets(e="usd",r=1,n=100){return await this.query("/coins/markets",{vs_currency:e,page:r.toString(),per_page:n.toString()})}async getCoinDetails(e){return await this.query(`/coins/${e}`,{localization:"false",tickers:"false",market_data:"true",community_data:"true",developer_data:"true"})}async getCoinMarketChart(e,r="usd",n=7){return await this.query(`/coins/${e}/market_chart`,{vs_currency:r,days:n.toString()})}async getTrending(){return await this.query("/search/trending")}async getGlobal(){return await this.query("/global")}async getExchanges(e=1,r=100){return await this.query("/exchanges",{page:e.toString(),per_page:r.toString()})}async getExchangeDetails(e){return await this.query(`/exchanges/${e}`)}async search(e){return await this.query("/search",{query:e})}async getSupportedCurrencies(){return await this.query("/simple/supported_vs_currencies")}async getCoinOHLC(e,r="usd",n=7){return await this.query(`/coins/${e}/ohlc`,{vs_currency:r,days:n.toString()})}async getCategories(){return await this.query("/coins/categories")}async getNFTList(){return await this.query("/nfts/list")}}class MN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey"),n=this.getConfig("apiSecret"),i=this.getConfig("testnet",!1);console.log("Testing Binance API connection...");try{const o=i?"https://testnet.binance.vision":"https://api.binance.com",a=await fetch(`${o}/api/v3/ping`);if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const d=await(await fetch(`${o}/api/v3/time`)).json();let p="Not authenticated";return r&&n&&(p="Authenticated (key provided)"),this.createSuccessResult("Successfully connected to Binance API",{serverTime:new Date(d.serverTime).toISOString(),testnet:i,authenticated:!!(r&&n),accountStatus:p,timestamp:new Date().toISOString()})}catch(o){if(o instanceof Error)return this.createErrorResult(o.message);throw o}}catch(e){return this.createErrorResult(e)}}async query(e,r,n=!1){try{const i=this.getConfig("apiKey"),a=this.getConfig("testnet",!1)?"https://testnet.binance.vision":"https://api.binance.com",l={};i&&(l["X-MBX-APIKEY"]=i);const d=r?`?${new URLSearchParams(r).toString()}`:"",p=`${a}${e}${d}`,f=await fetch(p,{method:"GET",headers:l});if(!f.ok){const h=await f.json();throw new Error(h.msg||`Query failed: ${f.status}`)}return await f.json()}catch(i){throw new Error(`Binance query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),hasApiSecret:!!this.getConfig("apiSecret"),testnet:this.getConfig("testnet",!1),provider:"Binance"}}async getTickerPrice(e){return await this.query("/api/v3/ticker/price",{symbol:e})}async get24hrTicker(e){const r=e?{symbol:e}:{};return await this.query("/api/v3/ticker/24hr",r)}async getOrderBook(e,r=100){return await this.query("/api/v3/depth",{symbol:e,limit:r.toString()})}async getRecentTrades(e,r=500){return await this.query("/api/v3/trades",{symbol:e,limit:r.toString()})}async getKlines(e,r,n=500){return await this.query("/api/v3/klines",{symbol:e,interval:r,limit:n.toString()})}async getExchangeInfo(){return await this.query("/api/v3/exchangeInfo")}async getAvgPrice(e){return await this.query("/api/v3/avgPrice",{symbol:e})}async getAllPrices(){return await this.query("/api/v3/ticker/price")}async getBookTicker(e){const r=e?{symbol:e}:{};return await this.query("/api/v3/ticker/bookTicker",r)}}class BN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey"),n=this.getConfig("apiSecret");console.log("Testing Coinbase API connection...");try{const i=await fetch("https://api.coinbase.com/v2/time");if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const o=await i.json();return this.createSuccessResult("Successfully connected to Coinbase API",{serverTime:o.data.iso,epoch:o.data.epoch,authenticated:!!(r&&n),timestamp:new Date().toISOString()})}catch(i){if(i instanceof Error)return this.createErrorResult(i.message);throw i}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("apiKey"),o="https://api.coinbase.com",a={"Content-Type":"application/json"};i&&(a["CB-ACCESS-KEY"]=i);const l={method:r,headers:a};n&&r!=="GET"&&(l.body=JSON.stringify(n));const d=await fetch(`${o}${e}`,l);if(!d.ok){const p=await d.json();throw new Error(p.errors?.[0]?.message||`Query failed: ${d.status}`)}return await d.json()}catch(i){throw new Error(`Coinbase query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),hasApiSecret:!!this.getConfig("apiSecret"),provider:"Coinbase"}}async getExchangeRates(e="USD"){return(await this.query(`/v2/exchange-rates?currency=${e}`)).data}async getCurrencies(){return(await this.query("/v2/currencies")).data}async getSpotPrice(e="BTC-USD"){return(await this.query(`/v2/prices/${e}/spot`)).data}async getBuyPrice(e="BTC-USD"){return(await this.query(`/v2/prices/${e}/buy`)).data}async getSellPrice(e="BTC-USD"){return(await this.query(`/v2/prices/${e}/sell`)).data}async getTime(){return(await this.query("/v2/time")).data}}class FN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host","localhost"),n=this.getConfig("port",5672),i=this.getConfig("managementPort",15672),o=this.getConfig("username","guest"),a=this.getConfig("password","guest"),l=this.getConfig("vhost","/");if(!r||!o||!a)return this.createErrorResult("Host, username, and password are required");console.log("Testing RabbitMQ connection...");try{const d=btoa(`${o}:${a}`),p=`http://${r}:${i}/api/overview`,f=await fetch(p,{method:"GET",headers:{Authorization:`Basic ${d}`}});if(!f.ok)throw f.status===401?new Error("Authentication failed. Check username and password."):new Error(`HTTP ${f.status}: ${f.statusText}`);const h=await f.json();return this.createSuccessResult("Successfully connected to RabbitMQ",{host:r,port:n,managementPort:i,vhost:l,version:h.rabbitmq_version,erlangVersion:h.erlang_version,clusterName:h.cluster_name,timestamp:new Date().toISOString()})}catch(d){if(d instanceof Error)return d.message.includes("Failed to fetch")?this.createErrorResult(`Cannot reach RabbitMQ management API at ${r}:${i}. Is the server running?`):this.createErrorResult(d.message);throw d}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("host"),o=this.getConfig("managementPort",15672),a=this.getConfig("username","guest"),l=this.getConfig("password","guest"),d=btoa(`${a}:${l}`),p=`http://${i}:${o}/api${e}`,f={method:r,headers:{Authorization:`Basic ${d}`,"Content-Type":"application/json"}};n&&r!=="GET"&&(f.body=JSON.stringify(n));const h=await fetch(p,f);if(!h.ok)throw new Error(`Query failed: ${h.status} ${h.statusText}`);return await h.json()}catch(i){throw new Error(`RabbitMQ query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",5672),managementPort:this.getConfig("managementPort",15672),vhost:this.getConfig("vhost","/")}}async getOverview(){return await this.query("/overview")}async getQueues(e){const r=e||this.getConfig("vhost","/"),n=encodeURIComponent(r);return await this.query(`/queues/${n}`)}async getExchanges(e){const r=e||this.getConfig("vhost","/"),n=encodeURIComponent(r);return await this.query(`/exchanges/${n}`)}async getConnections(){return await this.query("/connections")}async getChannels(){return await this.query("/channels")}async getConsumers(){return await this.query("/consumers")}async createQueue(e,r){const n=this.getConfig("vhost","/"),i=encodeURIComponent(n);return await this.query(`/queues/${i}/${e}`,"PUT",r)}async deleteQueue(e){const r=this.getConfig("vhost","/"),n=encodeURIComponent(r);return await this.query(`/queues/${n}/${e}`,"DELETE")}async getNodes(){return await this.query("/nodes")}}class $N extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url");return r?!r.startsWith("ws://")&&!r.startsWith("wss://")?this.createErrorResult("URL must start with ws:// or wss://"):(console.log("Validating WebSocket configuration..."),this.createSuccessResult(`Configuration validated for WebSocket "${r}"`,{validatedAt:new Date().toISOString(),url:r,secure:r.startsWith("wss://"),note:"Client-side validation only. WebSocket connections are established on-demand."})):this.createErrorResult("WebSocket URL is required")}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=this.getConfig("url");return new Promise((n,i)=>{const o=new WebSocket(r);let a=!1;o.onopen=()=>{e&&o.send(e)},o.onmessage=l=>{a=!0;try{const d=JSON.parse(l.data);o.close(),n(d)}catch{o.close(),n(l.data)}},o.onerror=l=>{i(new Error("WebSocket connection error"))},o.onclose=()=>{a||n({connected:!0,closed:!0})},setTimeout(()=>{o.readyState!==WebSocket.CLOSED&&(o.close(),a||n({connected:!0,timeout:!0}))},5e3)})}catch(r){throw new Error(`WebSocket error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),secure:this.getConfig("url")?.startsWith("wss://")}}connectAndListen(e,r,n){const i=this.getConfig("url"),o=new WebSocket(i);return o.onmessage=a=>{try{const l=JSON.parse(a.data);e(l)}catch{e(a.data)}},o.onerror=a=>{r&&r(a)},o.onclose=()=>{n&&n()},o}send(e,r){if(e.readyState===WebSocket.OPEN){const n=typeof r=="string"?r:JSON.stringify(r);e.send(n)}else throw new Error("WebSocket is not open")}}class GN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",1521),i=this.getConfig("serviceName"),o=this.getConfig("sid"),a=this.getConfig("username"),l=this.getConfig("password");return!r||!a||!l?this.createErrorResult("Host, username, and password are required"):!i&&!o?this.createErrorResult("Either Service Name or SID is required"):(console.log("Validating Oracle Database configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Oracle Database at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,serviceName:i||"Not provided",sid:o||"Not provided",username:a,note:"Client-side validation only. Oracle connections require backend integration with oracledb."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"oracle",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`Oracle query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",1521),serviceName:this.getConfig("serviceName"),sid:this.getConfig("sid"),username:this.getConfig("username")}}async getTables(e){const r=e?`WHERE OWNER = '${e.toUpperCase()}'`:"";return await this.query(`SELECT TABLE_NAME, TABLESPACE_NAME, NUM_ROWS FROM ALL_TABLES ${r}`)}async getColumns(e,r){const n=r?`AND OWNER = '${r.toUpperCase()}'`:"";return await this.query(`
      SELECT COLUMN_NAME, DATA_TYPE, DATA_LENGTH, NULLABLE
      FROM ALL_TAB_COLUMNS
      WHERE TABLE_NAME = '${e.toUpperCase()}' ${n}
      ORDER BY COLUMN_ID
    `)}async getSchemas(){return await this.query("SELECT USERNAME FROM ALL_USERS ORDER BY USERNAME")}async getTablespaces(){return await this.query("SELECT TABLESPACE_NAME, STATUS FROM DBA_TABLESPACES")}}class Tb extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",1433),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password"),l=this.getConfig("encrypt",!0),d=this.getConfig("trustServerCertificate",!1);return!r||!i||!o||!a?this.createErrorResult("Missing required connection parameters"):(console.log("Validating SQL Server configuration (client-side only)"),this.createSuccessResult(`Configuration validated for SQL Server database "${i}"`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,username:o,encrypt:l,trustServerCertificate:d,note:"Client-side validation only. SQL Server connections require backend integration with mssql."}))}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"sqlserver",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`SQL Server query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",1433),database:this.getConfig("database"),encrypt:this.getConfig("encrypt",!0),trustServerCertificate:this.getConfig("trustServerCertificate",!1)}}async getTables(e="dbo"){return await this.query(`
      SELECT TABLE_SCHEMA, TABLE_NAME, TABLE_TYPE
      FROM INFORMATION_SCHEMA.TABLES
      WHERE TABLE_SCHEMA = '${e}'
      ORDER BY TABLE_NAME
    `)}async getColumns(e,r="dbo"){return await this.query(`
      SELECT COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH, IS_NULLABLE
      FROM INFORMATION_SCHEMA.COLUMNS
      WHERE TABLE_NAME = '${e}' AND TABLE_SCHEMA = '${r}'
      ORDER BY ORDINAL_POSITION
    `)}async getSchemas(){return await this.query("SELECT SCHEMA_NAME FROM INFORMATION_SCHEMA.SCHEMATA ORDER BY SCHEMA_NAME")}async getDatabases(){return await this.query("SELECT name FROM sys.databases ORDER BY name")}async getVersion(){return await this.query("SELECT @@VERSION AS Version")}}class UN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("token"),i=this.getConfig("httpPath");if(!r||!n)return this.createErrorResult("Host and token are required");console.log("Testing Databricks connection...");try{const o=`https://${r}/api/2.0/clusters/list`,a=await fetch(o,{method:"GET",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(!a.ok)throw a.status===401||a.status===403?new Error("Authentication failed. Check your token."):new Error(`HTTP ${a.status}: ${a.statusText}`);const l=await a.json();return this.createSuccessResult("Successfully connected to Databricks",{host:r,clusterCount:l.clusters?.length||0,httpPath:i||"Not provided",timestamp:new Date().toISOString()})}catch(o){if(o instanceof Error)return o.message.includes("Failed to fetch")?this.createErrorResult(`Cannot reach Databricks at ${r}.`):this.createErrorResult(o.message);throw o}}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=this.getConfig("host"),n=this.getConfig("token"),i=this.getConfig("clusterId");if(!i)throw new Error("Cluster ID is required for queries");const o=await fetch(`https://${r}/api/2.0/sql/statements`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({statement:e,warehouse_id:i})});if(!o.ok)throw new Error(`Query failed: ${o.status} ${o.statusText}`);return await o.json()}catch(r){throw new Error(`Databricks query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),httpPath:this.getConfig("httpPath"),hasToken:!!this.getConfig("token"),clusterId:this.getConfig("clusterId")}}async listClusters(){const e=this.getConfig("host"),r=this.getConfig("token"),n=await fetch(`https://${e}/api/2.0/clusters/list`,{method:"GET",headers:{Authorization:`Bearer ${r}`}});if(!n.ok)throw new Error("Failed to list clusters");return await n.json()}async getCluster(e){const r=this.getConfig("host"),n=this.getConfig("token"),i=await fetch(`https://${r}/api/2.0/clusters/get?cluster_id=${e}`,{method:"GET",headers:{Authorization:`Bearer ${n}`}});if(!i.ok)throw new Error("Failed to get cluster info");return await i.json()}async listDatabases(){return await this.query("SHOW DATABASES")}async listTables(e){const r=e?`IN ${e}`:"";return await this.query(`SHOW TABLES ${r}`)}}class WN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("projectId"),n=this.getConfig("credentials"),i=this.getConfig("bucket");if(!r||!n)return this.createErrorResult("Project ID and credentials are required");try{const o=JSON.parse(n);if(!o.type||!o.project_id||!o.private_key)return this.createErrorResult("Invalid credentials format. Expected service account JSON.")}catch{return this.createErrorResult("Credentials must be valid JSON")}return console.log("Validating Google Cloud Storage configuration (client-side only)"),this.createSuccessResult(`Configuration validated for GCS project "${r}"`,{validatedAt:new Date().toISOString(),projectId:r,bucket:i||"Not specified",hasCredentials:!0,note:"Client-side validation only. GCS operations require backend integration with @google-cloud/storage."})}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/gcs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"gcs",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`GCS operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),projectId:this.getConfig("projectId"),bucket:this.getConfig("bucket"),hasCredentials:!!this.getConfig("credentials")}}async listBuckets(){return await this.query("listBuckets")}async listFiles(e,r){const n=e||this.getConfig("bucket");return await this.query("listFiles",{bucket:n,prefix:r})}async getFile(e,r){const n=r||this.getConfig("bucket");return await this.query("getFile",{bucket:n,fileName:e})}async uploadFile(e,r,n){const i=n||this.getConfig("bucket");return await this.query("uploadFile",{bucket:i,fileName:e,data:r})}async deleteFile(e,r){const n=r||this.getConfig("bucket");return await this.query("deleteFile",{bucket:n,fileName:e})}async getSignedUrl(e,r=3600,n){const i=n||this.getConfig("bucket");return(await this.query("getSignedUrl",{bucket:i,fileName:e,expiresIn:r})).url}}class qN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("accountName"),n=this.getConfig("accountKey"),i=this.getConfig("connectionString"),o=this.getConfig("container");return!r&&!i?this.createErrorResult("Either account name or connection string is required"):r&&!n&&!i?this.createErrorResult("Account key is required when using account name"):(console.log("Validating Azure Blob Storage configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Azure Blob Storage account "${r||"from connection string"}"`,{validatedAt:new Date().toISOString(),accountName:r||"From connection string",container:o||"Not specified",hasCredentials:!0,note:"Client-side validation only. Azure Blob operations require backend integration with @azure/storage-blob."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/azure-blob",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"azure-blob",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Azure Blob operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),accountName:this.getConfig("accountName"),container:this.getConfig("container"),hasCredentials:!!(this.getConfig("accountKey")||this.getConfig("connectionString"))}}async listContainers(){return await this.query("listContainers")}async listBlobs(e,r){const n=e||this.getConfig("container");return await this.query("listBlobs",{container:n,prefix:r})}async getBlob(e,r){const n=r||this.getConfig("container");return await this.query("getBlob",{container:n,blobName:e})}async uploadBlob(e,r,n){const i=n||this.getConfig("container");return await this.query("uploadBlob",{container:i,blobName:e,data:r})}async deleteBlob(e,r){const n=r||this.getConfig("container");return await this.query("deleteBlob",{container:n,blobName:e})}async getBlobProperties(e,r){const n=r||this.getConfig("container");return await this.query("getBlobProperties",{container:n,blobName:e})}async copyBlob(e,r,n){const i=n||this.getConfig("container");return await this.query("copyBlob",{container:i,sourceBlobName:e,destBlobName:r})}}class HN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("token"),n=this.getConfig("sandbox",!1);if(!r)return this.createErrorResult("API token is required");console.log("Testing IEX Cloud API connection...");try{const o=await fetch(`${n?"https://sandbox.iexapis.com/stable":"https://cloud.iexapis.com/stable"}/status?token=${r}`);if(!o.ok)throw o.status===401||o.status===403?new Error("Invalid API token or unauthorized access"):new Error(`HTTP ${o.status}: ${o.statusText}`);const a=await o.json();return this.createSuccessResult("Successfully connected to IEX Cloud API",{status:a.status,callsTracking:a.currentMonthAPICalls?"API calls tracked":"Unknown",sandbox:n,apiCallsUsed:a.currentMonthAPICalls||0,timestamp:new Date().toISOString()})}catch(i){if(i instanceof Error)return this.createErrorResult(i.message);throw i}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("token"),o=this.getConfig("sandbox",!1)?"https://sandbox.iexapis.com/stable":"https://cloud.iexapis.com/stable",a=new URLSearchParams({...r,token:n}),l=`${o}${e}?${a.toString()}`,d=await fetch(l);if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);return await d.json()}catch(n){throw new Error(`IEX Cloud query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasToken:!!this.getConfig("token"),sandbox:this.getConfig("sandbox",!1),provider:"IEX Cloud"}}async getQuote(e){return await this.query(`/stock/${e}/quote`)}async getCompany(e){return await this.query(`/stock/${e}/company`)}async getHistoricalPrices(e,r="1m"){return await this.query(`/stock/${e}/chart/${r}`)}async getNews(e,r=10){return await this.query(`/stock/${e}/news/last/${r}`)}async getFinancials(e){return await this.query(`/stock/${e}/financials`)}async getEarnings(e){return await this.query(`/stock/${e}/earnings`)}async getDividends(e,r="1y"){return await this.query(`/stock/${e}/dividends/${r}`)}async getStats(e){return await this.query(`/stock/${e}/stats`)}async searchSymbols(e){return await this.query("/search",{fragment:e})}async getMarketVolume(){return await this.query("/market")}}class YN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing CoinMarketCap API connection...");try{const n=await fetch("https://pro-api.coinmarketcap.com/v1/key/info",{method:"GET",headers:{"X-CMC_PRO_API_KEY":r,Accept:"application/json"}});if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();if(i.status&&i.status.error_code!==0)throw new Error(i.status.error_message);return this.createSuccessResult("Successfully connected to CoinMarketCap API",{plan:i.data?.plan||"Unknown",credits:i.data?.usage?.current_day?.credits_used||0,creditsRemaining:i.data?.usage?.current_day?.credits_left||0,timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=r?`?${new URLSearchParams(r).toString()}`:"",o=`https://pro-api.coinmarketcap.com${e}${i}`,a=await fetch(o,{method:"GET",headers:{"X-CMC_PRO_API_KEY":n,Accept:"application/json"}});if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);const l=await a.json();if(l.status&&l.status.error_code!==0)throw new Error(l.status.error_message);return l.data}catch(n){throw new Error(`CoinMarketCap query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"CoinMarketCap"}}async getListings(e=1,r=100,n="USD"){return await this.query("/v1/cryptocurrency/listings/latest",{start:e.toString(),limit:r.toString(),convert:n})}async getQuotes(e,r="USD"){return await this.query("/v2/cryptocurrency/quotes/latest",{symbol:e.join(","),convert:r})}async getCryptoInfo(e){return await this.query("/v2/cryptocurrency/info",{symbol:e.join(",")})}async getGlobalMetrics(e="USD"){return await this.query("/v1/global-metrics/quotes/latest",{convert:e})}async getTrending(){return await this.query("/v1/cryptocurrency/trending/latest")}async getMostVisited(){return await this.query("/v1/cryptocurrency/trending/most-visited")}async getGainersLosers(e="USD",r=10){return await this.query("/v1/cryptocurrency/trending/gainers-losers",{convert:e,limit:r.toString()})}async getOHLCV(e,r="USD",n,i){const o={symbol:e,convert:r};return n&&(o.time_start=n),i&&(o.time_end=i),await this.query("/v2/cryptocurrency/ohlcv/historical",o)}async search(e){return await this.query("/v1/cryptocurrency/map",{symbol:e})}}class KN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Twelve Data API connection...");try{const n=await fetch(`https://api.twelvedata.com/time_series?symbol=AAPL&interval=1min&apikey=${r}&outputsize=1`);if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();if(i.status==="error")throw new Error(i.message||"API request failed");return this.createSuccessResult("Successfully connected to Twelve Data API",{symbol:i.meta?.symbol||"AAPL",interval:i.meta?.interval||"1min",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=new URLSearchParams({...r,apikey:n}),o=`https://api.twelvedata.com${e}?${i.toString()}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);const l=await a.json();if(l.status==="error")throw new Error(l.message||"Query failed");return l}catch(n){throw new Error(`Twelve Data query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Twelve Data"}}async getTimeSeries(e,r="1day",n=30){return await this.query("/time_series",{symbol:e,interval:r,outputsize:n.toString()})}async getQuote(e){return await this.query("/quote",{symbol:e})}async getPrice(e){return await this.query("/price",{symbol:e})}async getEOD(e){return await this.query("/eod",{symbol:e})}async getExchangeRate(e){return await this.query("/exchange_rate",{symbol:e})}async getMarketState(e){return await this.query("/market_state",{symbol:e})}async searchSymbol(e){return await this.query("/symbol_search",{symbol:e})}async getEarliestTimestamp(e,r="1day"){return await this.query("/earliest_timestamp",{symbol:e,interval:r})}}class VN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Quandl API connection...");try{const n=await fetch(`https://data.nasdaq.com/api/v3/databases.json?api_key=${r}&per_page=1`);if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();if(i.quandl_error)throw new Error(i.quandl_error.message||"API request failed");return this.createSuccessResult("Successfully connected to Quandl API",{databasesAvailable:i.meta?.total_count||"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=new URLSearchParams({...r,api_key:n}),o=`https://data.nasdaq.com/api/v3${e}?${i.toString()}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);const l=await a.json();if(l.quandl_error)throw new Error(l.quandl_error.message||"Query failed");return l}catch(n){throw new Error(`Quandl query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Quandl (Nasdaq Data Link)"}}async getDataset(e,r,n){return await this.query(`/datasets/${e}/${r}.json`,n)}async getDatasetMetadata(e,r){return await this.query(`/datasets/${e}/${r}/metadata.json`)}async searchDatasets(e,r=10){return await this.query("/datasets.json",{query:e,per_page:r.toString()})}async getDatabase(e){return await this.query(`/databases/${e}.json`)}async listDatabases(e=100){return await this.query("/databases.json",{per_page:e.toString()})}async getTimeSeries(e,r,n,i){const o={};return n&&(o.start_date=n),i&&(o.end_date=i),await this.query(`/datasets/${e}/${r}/data.json`,o)}}class XN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing EOD Historical Data API connection...");try{const n=await fetch(`https://eodhistoricaldata.com/api/exchanges-list/?api_token=${r}&fmt=json`);if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();if(i.error)throw new Error(i.error);return this.createSuccessResult("Successfully connected to EOD Historical Data API",{exchangesAvailable:Array.isArray(i)?i.length:"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=new URLSearchParams({...r,api_token:n,fmt:"json"}),o=`https://eodhistoricaldata.com/api${e}?${i.toString()}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);const l=await a.json();if(l.error)throw new Error(l.error);return l}catch(n){throw new Error(`EOD Historical Data query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"EOD Historical Data"}}async getEOD(e,r="US",n,i){const o={};return n&&(o.from=n),i&&(o.to=i),await this.query(`/eod/${e}.${r}`,o)}async getRealTimeQuote(e,r="US"){return await this.query(`/real-time/${e}.${r}`)}async getIntraday(e,r="US",n="5m",i,o){const a={interval:n};return i&&(a.from=i),o&&(a.to=o),await this.query(`/intraday/${e}.${r}`,a)}async getFundamentals(e,r="US"){return await this.query(`/fundamentals/${e}.${r}`)}async getDividends(e,r="US",n,i){const o={};return n&&(o.from=n),i&&(o.to=i),await this.query(`/div/${e}.${r}`,o)}async getSplits(e,r="US",n,i){const o={};return n&&(o.from=n),i&&(o.to=i),await this.query(`/splits/${e}.${r}`,o)}async listExchanges(){return await this.query("/exchanges-list/")}async getExchangeSymbols(e){return await this.query(`/exchange-symbol-list/${e}`)}async searchSymbols(e){return await this.query("/search/",{s:e})}async getCalendar(e,r){const n={};return r&&(n.symbols=r),await this.query(`/calendar/${e}`,n)}}class JN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Tiingo API connection...");try{const n=await fetch("https://api.tiingo.com/api/test",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Token ${r}`}});if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return this.createSuccessResult("Successfully connected to Tiingo API",{message:i.message||"API access verified",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=r?`?${new URLSearchParams(r).toString()}`:"",o=`https://api.tiingo.com${e}${i}`,a=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Token ${n}`}});if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);return await a.json()}catch(n){throw new Error(`Tiingo query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Tiingo"}}async getStockMeta(e){return await this.query(`/tiingo/daily/${e}`)}async getEODPrices(e,r,n){const i={};return r&&(i.startDate=r),n&&(i.endDate=n),await this.query(`/tiingo/daily/${e}/prices`,i)}async getIntradayPrices(e,r,n,i){const o={};return r&&(o.startDate=r),n&&(o.endDate=n),i&&(o.resampleFreq=i),await this.query(`/iex/${e}/prices`,o)}async getCryptoPrices(e,r,n,i){const o={};return r&&(o.startDate=r),n&&(o.endDate=n),i&&(o.resampleFreq=i),await this.query("/tiingo/crypto/prices",{...o,tickers:e})}async getCryptoMeta(){return await this.query("/tiingo/crypto")}async getForexPrices(e,r,n,i){const o={};return r&&(o.startDate=r),n&&(o.endDate=n),i&&(o.resampleFreq=i),await this.query(`/tiingo/fx/${e}/prices`,o)}async getNews(e,r,n,i,o=100){const a={limit:o.toString()};return e&&e.length>0&&(a.tickers=e.join(",")),r&&r.length>0&&(a.tags=r.join(",")),n&&(a.startDate=n),i&&(a.endDate=i),await this.query("/tiingo/news",a)}async getFundamentalsDefinitions(){return await this.query("/tiingo/fundamentals/definitions")}async getFundamentalsStatements(e,r,n){const i={};return r&&(i.startDate=r),n&&(i.endDate=n),await this.query(`/tiingo/fundamentals/${e}/statements`,i)}async getFundamentalsDaily(e,r,n){const i={};return r&&(i.startDate=r),n&&(i.endDate=n),await this.query(`/tiingo/fundamentals/${e}/daily`,i)}}class QN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Intrinio API connection...");try{const n=await fetch("https://api-v2.intrinio.com/companies?page_size=1",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return this.createSuccessResult("Successfully connected to Intrinio API",{companiesAvailable:i.total_results||"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=r?`?${new URLSearchParams(r).toString()}`:"",o=`https://api-v2.intrinio.com${e}${i}`,a=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);return await a.json()}catch(n){throw new Error(`Intrinio query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Intrinio"}}async getCompany(e){return await this.query(`/companies/${e}`)}async searchCompanies(e,r=100){return await this.query("/companies",{query:e,page_size:r.toString()})}async getCompanySecurities(e){return await this.query(`/companies/${e}/securities`)}async getSecurity(e){return await this.query(`/securities/${e}`)}async getSecurityRealtimePrice(e){return await this.query(`/securities/${e}/prices/realtime`)}async getSecurityHistoricalData(e,r,n,i,o){const a={tag:r};return n&&(a.frequency=n),i&&(a.start_date=i),o&&(a.end_date=o),await this.query(`/securities/${e}/historical_data/${r}`,a)}async getSecurityIntradayPrices(e,r,n,i,o){const a={};return r&&(a.start_date=r),n&&(a.start_time=n),i&&(a.end_date=i),o&&(a.end_time=o),await this.query(`/securities/${e}/prices/intraday`,a)}async getCompanyFundamentals(e,r,n){const i={};return r&&(i.statement_code=r),n&&(i.fiscal_year=n.toString()),await this.query(`/companies/${e}/fundamentals`,i)}async getCompanyNews(e,r=100){return await this.query(`/companies/${e}/news`,{page_size:r.toString()})}async getCompanyFilings(e,r=100){return await this.query(`/companies/${e}/filings`,{page_size:r.toString()})}async getIndices(e=100){return await this.query("/indices",{page_size:e.toString()})}async getIndex(e){return await this.query(`/indices/${e}`)}async getEconomicData(e,r,n){const i={};return r&&(i.start_date=r),n&&(i.end_date=n),await this.query(`/economic_data/${e}`,i)}async getOptionsChain(e,r){const n={};return r&&(n.expiration=r),await this.query(`/options/chain/${e}`,n)}}class ZN extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("accessKey");if(!r)return this.createErrorResult("Access key is required");console.log("Testing Marketstack API connection...");try{const n=await fetch(`http://api.marketstack.com/v1/exchanges?access_key=${r}&limit=1`);if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid access key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();if(i.error)throw new Error(i.error.message||"API request failed");return this.createSuccessResult("Successfully connected to Marketstack API",{exchangesAvailable:i.pagination?.total||"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("accessKey"),i=new URLSearchParams({...r,access_key:n}),o=`http://api.marketstack.com/v1${e}?${i.toString()}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);const l=await a.json();if(l.error)throw new Error(l.error.message||"Query failed");return l}catch(n){throw new Error(`Marketstack query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasAccessKey:!!this.getConfig("accessKey"),provider:"Marketstack"}}async getEOD(e,r,n,i=100){const a={symbols:Array.isArray(e)?e.join(","):e,limit:i.toString()};return r&&(a.date_from=r),n&&(a.date_to=n),await this.query("/eod",a)}async getEODLatest(e){const r=Array.isArray(e)?e.join(","):e;return await this.query("/eod/latest",{symbols:r})}async getIntraday(e,r,n,i,o=100){const l={symbols:Array.isArray(e)?e.join(","):e,limit:o.toString()};return r&&(l.interval=r),n&&(l.date_from=n),i&&(l.date_to=i),await this.query("/intraday",l)}async getTickers(e,r=100){const n={limit:r.toString()};return e&&(n.exchange=e),await this.query("/tickers",n)}async getExchanges(e=100){return await this.query("/exchanges",{limit:e.toString()})}async getCurrencies(e=100){return await this.query("/currencies",{limit:e.toString()})}async getTimezones(){return await this.query("/timezones")}async getSplits(e,r,n,i=100){const o={limit:i.toString()};if(e){const a=Array.isArray(e)?e.join(","):e;o.symbols=a}return r&&(o.date_from=r),n&&(o.date_to=n),await this.query("/splits",o)}async getDividends(e,r,n,i=100){const o={limit:i.toString()};if(e){const a=Array.isArray(e)?e.join(","):e;o.symbols=a}return r&&(o.date_from=r),n&&(o.date_to=n),await this.query("/dividends",o)}}class eO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",9200),i=this.getConfig("username"),o=this.getConfig("password"),a=this.getConfig("useSsl",!0);if(!r)return this.createErrorResult("Host is required");console.log("Testing OpenSearch connection...");try{const d=`${a?"https":"http"}://${r}:${n}/`,p={"Content-Type":"application/json"};if(i&&o){const x=btoa(`${i}:${o}`);p.Authorization=`Basic ${x}`}const f=await fetch(d,{method:"GET",headers:p});if(!f.ok)throw f.status===401?new Error("Authentication failed"):new Error(`HTTP ${f.status}: ${f.statusText}`);const h=await f.json();return this.createSuccessResult("Successfully connected to OpenSearch",{clusterName:h.cluster_name||"Unknown",version:h.version?.number||"Unknown",distribution:h.version?.distribution||"opensearch",timestamp:new Date().toISOString()})}catch(l){if(l instanceof Error)return this.createErrorResult(l.message);throw l}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("host"),o=this.getConfig("port",9200),a=this.getConfig("username"),l=this.getConfig("password"),f=`${this.getConfig("useSsl",!0)?"https":"http"}://${i}:${o}${e}`,h={"Content-Type":"application/json"};if(a&&l){const b=btoa(`${a}:${l}`);h.Authorization=`Basic ${b}`}const x={method:r,headers:h};n&&(r==="POST"||r==="PUT"||r==="PATCH")&&(x.body=JSON.stringify(n));const m=await fetch(f,x);if(!m.ok)throw new Error(`Query failed: ${m.status} ${m.statusText}`);return await m.json()}catch(i){throw new Error(`OpenSearch query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",9200),useSsl:this.getConfig("useSsl",!0),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async getClusterHealth(){return await this.query("/_cluster/health")}async getClusterStats(){return await this.query("/_cluster/stats")}async listIndices(){return await this.query("/_cat/indices?format=json")}async createIndex(e,r){return await this.query(`/${e}`,"PUT",r)}async deleteIndex(e){return await this.query(`/${e}`,"DELETE")}async search(e,r){return await this.query(`/${e}/_search`,"POST",r)}async indexDocument(e,r,n){const i=n?`/${e}/_doc/${n}`:`/${e}/_doc`;return await this.query(i,"POST",r)}async getDocument(e,r){return await this.query(`/${e}/_doc/${r}`)}async updateDocument(e,r,n){return await this.query(`/${e}/_update/${r}`,"POST",{doc:n})}async deleteDocument(e,r){return await this.query(`/${e}/_doc/${r}`,"DELETE")}async bulk(e){const r=e.map(n=>JSON.stringify(n)).join(`
`)+`
`;return await this.query("/_bulk","POST",r)}async getMapping(e){return await this.query(`/${e}/_mapping`)}async putMapping(e,r){return await this.query(`/${e}/_mapping`,"PUT",r)}}class tO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",8983),i=this.getConfig("core"),o=this.getConfig("useSsl",!1);if(!r)return this.createErrorResult("Host is required");console.log("Testing Solr connection...");try{const l=`${o?"https":"http"}://${r}:${n}/solr/admin/info/system?wt=json`,d=await fetch(l,{method:"GET",headers:{"Content-Type":"application/json"}});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);const p=await d.json();return this.createSuccessResult("Successfully connected to Solr",{solrVersion:p.lucene?.["solr-spec-version"]||"Unknown",luceneVersion:p.lucene?.["lucene-spec-version"]||"Unknown",core:i||"Not specified",timestamp:new Date().toISOString()})}catch(a){if(a instanceof Error)return this.createErrorResult(a.message);throw a}}catch(e){return this.createErrorResult(e)}}async query(e,r,n="GET"){try{const i=this.getConfig("host"),o=this.getConfig("port",8983),a=this.getConfig("core"),d=this.getConfig("useSsl",!1)?"https":"http",p=a?`/solr/${a}`:"/solr",f=r?`?${new URLSearchParams({...r,wt:"json"}).toString()}`:"?wt=json",h=`${d}://${i}:${o}${p}${e}${f}`,x=await fetch(h,{method:n,headers:{"Content-Type":"application/json"}});if(!x.ok)throw new Error(`Query failed: ${x.status} ${x.statusText}`);return await x.json()}catch(i){throw new Error(`Solr query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",8983),core:this.getConfig("core"),useSsl:this.getConfig("useSsl",!1)}}async search(e,r=10,n=0,i){return await this.query("/select",{q:e,rows:r.toString(),start:n.toString(),...i})}async getDocument(e){return await this.query("/get",{id:e})}async update(e){const r=this.getConfig("host"),n=this.getConfig("port",8983),i=this.getConfig("core"),a=this.getConfig("useSsl",!1)?"https":"http",l=i?`/solr/${i}`:"/solr",d=`${a}://${r}:${n}${l}/update?wt=json&commit=true`,p=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!p.ok)throw new Error(`Update failed: ${p.status} ${p.statusText}`);return await p.json()}async deleteByQuery(e){const r=this.getConfig("host"),n=this.getConfig("port",8983),i=this.getConfig("core"),a=this.getConfig("useSsl",!1)?"https":"http",l=i?`/solr/${i}`:"/solr",d=`${a}://${r}:${n}${l}/update?wt=json&commit=true`,p=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:{query:e}})});if(!p.ok)throw new Error(`Delete failed: ${p.status} ${p.statusText}`);return await p.json()}async deleteById(e){const r=this.getConfig("host"),n=this.getConfig("port",8983),i=this.getConfig("core"),a=this.getConfig("useSsl",!1)?"https":"http",l=i?`/solr/${i}`:"/solr",d=`${a}://${r}:${n}${l}/update?wt=json&commit=true`,p=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delete:{id:e}})});if(!p.ok)throw new Error(`Delete failed: ${p.status} ${p.statusText}`);return await p.json()}async commit(){return await this.query("/update",{commit:"true"})}async optimize(){return await this.query("/update",{optimize:"true"})}async getSchema(){return await this.query("/schema")}async getCoreStatus(){const e=this.getConfig("core");return await this.query("/admin/cores",{action:"STATUS",core:e})}async facetSearch(e,r,n){return await this.query("/select",{q:e,facet:"true","facet.field":r,...n})}async suggest(e,r="suggest"){return await this.query("/suggest",{"suggest.q":e,"suggest.dictionary":r})}}class rO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url");if(!r)return this.createErrorResult("URL is required");console.log("Testing VictoriaMetrics connection...");try{const n=await fetch(`${r}/health`);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.text();return this.createSuccessResult("Successfully connected to VictoriaMetrics",{status:i||"OK",endpoint:r,timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("url"),i=r?`?${new URLSearchParams(r).toString()}`:"",o=`${n}${e}${i}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);return await a.json()}catch(n){throw new Error(`VictoriaMetrics query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),provider:"VictoriaMetrics"}}async queryRange(e,r,n,i){return await this.query("/api/v1/query_range",{query:e,start:r,end:n,step:i})}async queryInstant(e,r){const n={query:e};return r&&(n.time=r),await this.query("/api/v1/query",n)}async getLabelValues(e){return await this.query(`/api/v1/label/${e}/values`)}async getSeries(e,r,n){const i={};return e.forEach((o,a)=>{i[`match[${a}]`]=o}),r&&(i.start=r),n&&(i.end=n),await this.query("/api/v1/series",i)}async getLabels(){return await this.query("/api/v1/labels")}async getTargets(){return await this.query("/api/v1/targets")}async getAlerts(){return await this.query("/api/v1/alerts")}}class nO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url");if(!r)return this.createErrorResult("URL is required");console.log("Testing OpenTSDB connection...");try{const n=await fetch(`${r}/api/version`);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return this.createSuccessResult("Successfully connected to OpenTSDB",{version:i.version||"Unknown",shortRevision:i.short_revision||"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("url"),o={method:r,headers:{"Content-Type":"application/json"}};n&&(r==="POST"||r==="PUT")&&(o.body=JSON.stringify(n));const a=`${i}${e}`,l=await fetch(a,o);if(!l.ok)throw new Error(`Query failed: ${l.status} ${l.statusText}`);return await l.json()}catch(i){throw new Error(`OpenTSDB query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),provider:"OpenTSDB"}}async queryTimeSeries(e){return await this.query("/api/query","POST",{queries:e})}async queryLast(e){return await this.query("/api/query/last","POST",{queries:e})}async putDataPoints(e){return await this.query("/api/put","POST",e)}async getAggregators(){return await this.query("/api/aggregators")}async getOpenTSDBConfig(){return await this.query("/api/config")}async searchLookup(e,r=25){return await this.query("/api/search/lookup","POST",{metric:e,limit:r})}async suggestMetrics(e="metrics",r,n=25){const i=new URLSearchParams({type:e,max:n.toString()});return r&&i.append("q",r),await this.query(`/api/suggest?${i.toString()}`)}async getStats(e){let r="/api/stats";return e&&e.length>0&&(r+=`?${e.map(n=>`filter=${n}`).join("&")}`),await this.query(r)}async getUID(e,r){return await this.query("/api/uid/uidmeta","POST",{type:e,name:r})}async assignUID(e,r){return await this.query("/api/uid/assign","POST",{[e]:[r]})}}class sO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",5e3);return r?(console.log("Validating kdb+ configuration (client-side only)"),this.createSuccessResult(`Configuration validated for kdb+ at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,note:"Client-side validation only. kdb+ connections require backend integration with node-q or similar IPC libraries."})):this.createErrorResult("Host is required")}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=await fetch("/api/data-sources/kdb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"kdb",query:e})});if(!r.ok)throw new Error(`Query failed: ${r.statusText}`);return await r.json()}catch(r){throw new Error(`kdb+ query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",5e3),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async executeQuery(e){return await this.query(e)}async getTables(){return await this.query("tables[]")}async getTableSchema(e){return await this.query(`meta ${e}`)}async getTableCount(e){return await this.query(`count ${e}`)}async selectFromTable(e,r="*",n,i){let o=`select ${r} from ${e}`;return n&&(o+=` where ${n}`),i&&(o+=` limit ${i}`),await this.query(o)}async getSystemInfo(){return await this.query(".z.K")}async getNamespaces(){return await this.query('system "d"')}async getFunctions(e="."){return await this.query(`${e}\\f`)}async getVariables(e="."){return await this.query(`${e}\\v`)}async timeSeriesAgg(e,r,n,i,o){const a=`select ${i} ${n} by ${o} xbar ${r} from ${e}`;return await this.query(a)}}class iO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filepath");if(!r)return this.createErrorResult("File path is required");console.log("Testing XML file accessibility...");try{const n=await fetch(r);if(!n.ok)throw new Error(`Cannot access XML file: ${n.status} ${n.statusText}`);const i=await n.text(),a=new DOMParser().parseFromString(i,"text/xml");if(a.querySelector("parsererror"))throw new Error("Invalid XML format");const d=a.documentElement;return this.createSuccessResult("Successfully loaded and parsed XML file",{filepath:r,rootElement:d.tagName,childNodes:d.childNodes.length,fileSize:i.length,timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e){try{const r=this.getConfig("filepath"),n=await fetch(r);if(!n.ok)throw new Error(`Cannot access XML file: ${n.statusText}`);const i=await n.text(),a=new DOMParser().parseFromString(i,"text/xml");if(a.querySelector("parsererror"))throw new Error("Invalid XML format");if(e){const d=a.evaluate(e,a,null,XPathResult.ANY_TYPE,null),p=[];let f=d.iterateNext();for(;f;)p.push(this.xmlNodeToObject(f)),f=d.iterateNext();return p}return this.xmlToJson(a.documentElement)}catch(r){throw new Error(`XML query error: ${r instanceof Error?r.message:String(r)}`)}}async getMetadata(){return{...await super.getMetadata(),filepath:this.getConfig("filepath"),xpath:this.getConfig("xpath"),provider:"XML File"}}xmlNodeToObject(e){if(e.nodeType===Node.TEXT_NODE)return e.nodeValue?.trim()||"";if(e.nodeType===Node.ELEMENT_NODE){const r=e,n={};if(r.attributes.length>0){n["@attributes"]={};for(let i=0;i<r.attributes.length;i++){const o=r.attributes[i];n["@attributes"][o.name]=o.value}}if(r.childNodes.length>0)for(let i=0;i<r.childNodes.length;i++){const o=r.childNodes[i];if(o.nodeType===Node.TEXT_NODE){const a=o.nodeValue?.trim();a&&(n["#text"]=a)}else if(o.nodeType===Node.ELEMENT_NODE){const a=o,l=this.xmlNodeToObject(a);n[a.tagName]?(Array.isArray(n[a.tagName])||(n[a.tagName]=[n[a.tagName]]),n[a.tagName].push(l)):n[a.tagName]=l}}return n}return null}xmlToJson(e){const r={};return r[e.tagName]=this.xmlNodeToObject(e),r}async getData(e){return await this.query(e)}async getRootElement(){const e=this.getConfig("filepath"),n=await(await fetch(e)).text(),o=new DOMParser().parseFromString(n,"text/xml");return{tagName:o.documentElement.tagName,attributes:Array.from(o.documentElement.attributes).map(a=>({name:a.name,value:a.value})),childCount:o.documentElement.childNodes.length}}async queryXPath(e){return await this.query(e)}}class oO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filepath");if(!r)return this.createErrorResult("File path is required");console.log("Testing Avro file accessibility...");try{const n=await fetch(r,{method:"HEAD"});if(!n.ok)throw new Error(`Cannot access Avro file: ${n.status} ${n.statusText}`);const i=n.headers.get("content-length"),o=n.headers.get("content-type");return this.createSuccessResult("Successfully accessed Avro file",{filepath:r,fileSize:i?`${i} bytes`:"Unknown",contentType:o||"Unknown",note:"Avro parsing requires backend integration with avro-js or Apache Avro libraries.",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/avro",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"avro",filepath:this.getConfig("filepath"),operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Avro operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),filepath:this.getConfig("filepath"),provider:"Apache Avro"}}async getSchema(){return await this.query("getSchema")}async readRecords(e,r){return await this.query("readRecords",{limit:e,offset:r})}async getRecordCount(){return await this.query("getRecordCount")}async getFileMetadata(){return await this.query("getFileMetadata")}async toJSON(e){return await this.query("toJSON",{limit:e})}async getCodec(){return await this.query("getCodec")}async getSyncMarker(){return await this.query("getSyncMarker")}}class aO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filepath");if(!r)return this.createErrorResult("File path is required");console.log("Testing ORC file accessibility...");try{const n=await fetch(r,{method:"HEAD"});if(!n.ok)throw new Error(`Cannot access ORC file: ${n.status} ${n.statusText}`);const i=n.headers.get("content-length"),o=n.headers.get("content-type");return this.createSuccessResult("Successfully accessed ORC file",{filepath:r,fileSize:i?`${i} bytes`:"Unknown",contentType:o||"Unknown",note:"ORC parsing requires backend integration with Apache ORC libraries or pyorc.",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/orc",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"orc",filepath:this.getConfig("filepath"),operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`ORC operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),filepath:this.getConfig("filepath"),provider:"Apache ORC"}}async getSchema(){return await this.query("getSchema")}async readRows(e,r){return await this.query("readRows",{limit:e,offset:r})}async getRowCount(){return await this.query("getRowCount")}async getFileStats(){return await this.query("getFileStats")}async getColumnStats(){return await this.query("getColumnStats")}async getStripeInfo(){return await this.query("getStripeInfo")}async getCompression(){return await this.query("getCompression")}async toJSON(e){return await this.query("toJSON",{limit:e})}async getUserMetadata(){return await this.query("getUserMetadata")}async readColumns(e,r){return await this.query("readColumns",{columns:e,limit:r})}}class lO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("filepath");if(!r)return this.createErrorResult("File path is required");console.log("Testing Feather file accessibility...");try{const n=await fetch(r,{method:"HEAD"});if(!n.ok)throw new Error(`Cannot access Feather file: ${n.status} ${n.statusText}`);const i=n.headers.get("content-length"),o=n.headers.get("content-type");return this.createSuccessResult("Successfully accessed Feather file",{filepath:r,fileSize:i?`${i} bytes`:"Unknown",contentType:o||"Unknown",note:"Feather parsing requires backend integration with Apache Arrow libraries.",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/feather",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"feather",filepath:this.getConfig("filepath"),operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Feather operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),filepath:this.getConfig("filepath"),provider:"Apache Arrow Feather"}}async getSchema(){return await this.query("getSchema")}async readTable(e,r){return await this.query("readTable",{limit:e,offset:r})}async getRowCount(){return await this.query("getRowCount")}async getColumnCount(){return await this.query("getColumnCount")}async getColumnNames(){return await this.query("getColumnNames")}async readColumns(e,r){return await this.query("readColumns",{columns:e,limit:r})}async toJSON(e){return await this.query("toJSON",{limit:e})}async getArrowMetadata(){return await this.query("getArrowMetadata")}async getFileVersion(){return await this.query("getFileVersion")}async getDataTypes(){return await this.query("getDataTypes")}async getChunkInfo(){return await this.query("getChunkInfo")}async readBatch(e){return await this.query("readBatch",{batchIndex:e})}}class cO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",50051),i=this.getConfig("tls",!1);return r?(console.log("Validating gRPC configuration (client-side only)"),this.createSuccessResult(`Configuration validated for gRPC at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,tls:i,note:"Client-side validation only. gRPC connections require backend integration with @grpc/grpc-js and proto definitions."})):this.createErrorResult("Host is required")}catch(e){return this.createErrorResult(e)}}async callMethod(e,r){try{const n=await fetch("/api/data-sources/grpc",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"grpc",method:e,request:r})});if(!n.ok)throw new Error(`gRPC call failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`gRPC query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",50051),tls:this.getConfig("tls",!1),protoFile:this.getConfig("protoFile")}}async callUnary(e,r,n){return await this.query(`${e}/${r}`,n)}async listServices(){return await this.query("reflection/listServices",{})}async getServiceDefinition(e){return await this.query("reflection/getServiceDefinition",{serviceName:e})}async getMethodSignature(e,r){return await this.query("reflection/getMethodSignature",{serviceName:e,methodName:r})}}class dO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("wsdlUrl");if(!r)return this.createErrorResult("WSDL URL is required");console.log("Testing SOAP service accessibility...");try{const n=await fetch(r);if(!n.ok)throw new Error(`Cannot access WSDL: ${n.status} ${n.statusText}`);const i=await n.text();if(!i.includes("wsdl:definitions")&&!i.includes("<definitions"))throw new Error("Invalid WSDL format");const a=new DOMParser().parseFromString(i,"text/xml"),l=a.querySelector("service")?.getAttribute("name")||"Unknown",d=a.querySelectorAll("port").length,p=a.querySelectorAll("operation").length;return this.createSuccessResult("Successfully accessed SOAP service WSDL",{wsdlUrl:r,serviceName:l,ports:d,operations:p,timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/soap",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"soap",wsdlUrl:this.getConfig("wsdlUrl"),operation:e,params:r,username:this.getConfig("username"),password:this.getConfig("password")})});if(!n.ok)throw new Error(`SOAP operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`SOAP query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),wsdlUrl:this.getConfig("wsdlUrl"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password")),provider:"SOAP"}}async callOperation(e,r){return await this.query(e,r)}async getWSDL(){const e=this.getConfig("wsdlUrl");return{wsdl:await(await fetch(e)).text()}}async listOperations(){const e=this.getConfig("wsdlUrl"),n=await(await fetch(e)).text(),o=new DOMParser().parseFromString(n,"text/xml");return{operations:Array.from(o.querySelectorAll("portType operation")).map(l=>({name:l.getAttribute("name"),input:l.querySelector("input")?.getAttribute("message"),output:l.querySelector("output")?.getAttribute("message")}))}}async getOperationParams(e){return await this.query("getOperationParams",{operationName:e})}async getEndpoints(){const e=this.getConfig("wsdlUrl"),n=await(await fetch(e)).text(),o=new DOMParser().parseFromString(n,"text/xml");return{endpoints:Array.from(o.querySelectorAll("service port")).map(l=>({name:l.getAttribute("name"),binding:l.getAttribute("binding"),address:l.querySelector("address")?.getAttribute("location")}))}}}class uO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("serviceRoot");if(!r)return this.createErrorResult("Service root URL is required");console.log("Testing OData service connection...");try{const n=`${r}/$metadata`,i=await fetch(n);if(!i.ok)throw new Error(`Cannot access OData service: ${i.status} ${i.statusText}`);const o=await i.text();if(!o.includes("edmx:Edmx")&&!o.includes("Edmx"))throw new Error("Invalid OData metadata format");const d=new DOMParser().parseFromString(o,"text/xml").querySelectorAll("EntitySet"),p=Array.from(d).map(f=>f.getAttribute("Name")).filter(Boolean);return this.createSuccessResult("Successfully connected to OData service",{serviceRoot:r,version:o.includes('Version="4.0"')?"OData v4":"OData v3 or lower",entitySets:p.length,timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("serviceRoot"),i=this.getConfig("version","4.0"),o=r?`?${new URLSearchParams(r).toString()}`:"",a=`${n}${e}${o}`,d=await fetch(a,{method:"GET",headers:{Accept:"application/json","OData-Version":i}});if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);return await d.json()}catch(n){throw new Error(`OData query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),serviceRoot:this.getConfig("serviceRoot"),version:this.getConfig("version","4.0"),provider:"OData"}}async getServiceMetadata(){const e=this.getConfig("serviceRoot");return{metadata:await(await fetch(`${e}/$metadata`)).text()}}async queryEntitySet(e,r){const n={};return r?.$select&&(n.$select=r.$select),r?.$filter&&(n.$filter=r.$filter),r?.$orderby&&(n.$orderby=r.$orderby),r?.$top&&(n.$top=r.$top.toString()),r?.$skip&&(n.$skip=r.$skip.toString()),r?.$expand&&(n.$expand=r.$expand),await this.query(`/${e}`,n)}async getEntity(e,r,n){const i={};return n&&(i.$expand=n),await this.query(`/${e}(${r})`,i)}async countEntities(e,r){const n={};return r&&(n.$filter=r),await this.query(`/${e}/$count`,n)}async createEntity(e,r){const n=this.getConfig("serviceRoot"),i=this.getConfig("version","4.0"),o=await fetch(`${n}/${e}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","OData-Version":i},body:JSON.stringify(r)});if(!o.ok)throw new Error(`Create failed: ${o.status} ${o.statusText}`);return await o.json()}async updateEntity(e,r,n){const i=this.getConfig("serviceRoot"),o=this.getConfig("version","4.0"),a=await fetch(`${i}/${e}(${r})`,{method:"PATCH",headers:{"Content-Type":"application/json",Accept:"application/json","OData-Version":o},body:JSON.stringify(n)});if(!a.ok)throw new Error(`Update failed: ${a.status} ${a.statusText}`);return a.status===204?{success:!0}:await a.json()}async deleteEntity(e,r){const n=this.getConfig("serviceRoot"),i=this.getConfig("version","4.0"),o=await fetch(`${n}/${e}(${r})`,{method:"DELETE",headers:{"OData-Version":i}});if(!o.ok)throw new Error(`Delete failed: ${o.status} ${o.statusText}`);return{success:!0}}async callFunction(e,r){return await this.query(`/${e}`,r)}async callAction(e,r){const n=this.getConfig("serviceRoot"),i=this.getConfig("version","4.0"),o=await fetch(`${n}/${e}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","OData-Version":i},body:r?JSON.stringify(r):void 0});if(!o.ok)throw new Error(`Action call failed: ${o.status} ${o.statusText}`);return o.status===204?{success:!0}:await o.json()}}class pO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("broker"),n=this.getConfig("port",1883);return r?(console.log("Validating MQTT configuration (client-side only)"),this.createSuccessResult(`Configuration validated for MQTT broker at ${r}:${n}`,{validatedAt:new Date().toISOString(),broker:r,port:n,clientId:this.getConfig("clientId")||"Auto-generated",note:"Client-side validation only. MQTT connections require backend integration with mqtt.js or similar libraries."})):this.createErrorResult("Broker URL is required")}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/mqtt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"mqtt",operation:e,params:r})});if(!n.ok)throw new Error(`MQTT operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`MQTT query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),broker:this.getConfig("broker"),port:this.getConfig("port",1883),clientId:this.getConfig("clientId"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async publish(e,r,n=0){return await this.query("publish",{topic:e,message:r,qos:n})}async subscribe(e,r=0){return await this.query("subscribe",{topic:e,qos:r})}async unsubscribe(e){return await this.query("unsubscribe",{topic:e})}async getStatus(){return await this.query("getStatus")}async disconnect(){return await this.query("disconnect")}}class hO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("servers");return r?(console.log("Validating NATS configuration (client-side only)"),this.createSuccessResult(`Configuration validated for NATS at ${r}`,{validatedAt:new Date().toISOString(),servers:r,hasCredentials:!!(this.getConfig("username")||this.getConfig("token")),note:"Client-side validation only. NATS connections require backend integration with nats.js or nats.ws."})):this.createErrorResult("Server URLs are required")}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/nats",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"nats",operation:e,params:r})});if(!n.ok)throw new Error(`NATS operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`NATS query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),servers:this.getConfig("servers"),hasCredentials:!!(this.getConfig("username")||this.getConfig("token"))}}async publish(e,r){return await this.query("publish",{subject:e,data:r})}async subscribe(e,r){return await this.query("subscribe",{subject:e,queue:r})}async request(e,r,n){return await this.query("request",{subject:e,data:r,timeout:n})}async unsubscribe(e){return await this.query("unsubscribe",{subject:e})}async getStatus(){return await this.query("getStatus")}async createJetStream(){return await this.query("createJetStream")}async jetStreamPublish(e,r){return await this.query("jetStreamPublish",{subject:e,data:r})}async getServerInfo(){return await this.query("getServerInfo")}}class fO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("region"),n=this.getConfig("space"),i=this.getConfig("accessKey"),o=this.getConfig("secretKey");return!r||!n||!i||!o?this.createErrorResult("Region, space name, access key, and secret key are required"):(console.log("Validating DigitalOcean Spaces configuration (client-side only)"),this.createSuccessResult(`Configuration validated for DigitalOcean Space "${n}" in ${r}`,{validatedAt:new Date().toISOString(),region:r,space:n,endpoint:`https://${r}.digitaloceanspaces.com`,hasCredentials:!0,note:"Client-side validation only. DigitalOcean Spaces requires backend integration with AWS SDK."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/digitalocean-spaces",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"digitalocean-spaces",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`DigitalOcean Spaces operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),region:this.getConfig("region"),space:this.getConfig("space"),endpoint:`https://${this.getConfig("region")}.digitaloceanspaces.com`,hasCredentials:!!(this.getConfig("accessKey")&&this.getConfig("secretKey"))}}async listObjects(e,r){return await this.query("listObjects",{prefix:e,maxKeys:r})}async getObject(e){return await this.query("getObject",{key:e})}async putObject(e,r,n){return await this.query("putObject",{key:e,body:r,contentType:n})}async deleteObject(e){return await this.query("deleteObject",{key:e})}async copyObject(e,r){return await this.query("copyObject",{sourceKey:e,destinationKey:r})}async getObjectMetadata(e){return await this.query("getObjectMetadata",{key:e})}async getPresignedUrl(e,r=3600){return await this.query("getPresignedUrl",{key:e,expiresIn:r})}async setObjectACL(e,r){return await this.query("setObjectACL",{key:e,acl:r})}}class gO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("endpoint"),n=this.getConfig("bucket"),i=this.getConfig("accessKey"),o=this.getConfig("secretKey");return!r||!n||!i||!o?this.createErrorResult("Endpoint, bucket, access key, and secret key are required"):(console.log("Validating MinIO configuration (client-side only)"),this.createSuccessResult(`Configuration validated for MinIO bucket "${n}"`,{validatedAt:new Date().toISOString(),endpoint:r,bucket:n,hasCredentials:!0,note:"Client-side validation only. MinIO requires backend integration with AWS SDK or MinIO client."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/minio",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"minio",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`MinIO operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),endpoint:this.getConfig("endpoint"),bucket:this.getConfig("bucket"),hasCredentials:!!(this.getConfig("accessKey")&&this.getConfig("secretKey"))}}async listBuckets(){return await this.query("listBuckets")}async listObjects(e,r){return await this.query("listObjects",{prefix:e,recursive:r})}async getObject(e){return await this.query("getObject",{objectName:e})}async putObject(e,r,n){return await this.query("putObject",{objectName:e,data:r,metadata:n})}async removeObject(e){return await this.query("removeObject",{objectName:e})}async copyObject(e,r){return await this.query("copyObject",{sourceObject:e,destObject:r})}async statObject(e){return await this.query("statObject",{objectName:e})}async presignedGetObject(e,r=604800){return await this.query("presignedGetObject",{objectName:e,expires:r})}async makeBucket(e,r){return await this.query("makeBucket",{bucketName:e,region:r})}async removeBucket(e){return await this.query("removeBucket",{bucketName:e})}async bucketExists(e){return await this.query("bucketExists",{bucketName:e})}}class xO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("keyId"),n=this.getConfig("applicationKey");if(!r||!n)return this.createErrorResult("Application key ID and application key are required");console.log("Testing Backblaze B2 API connection...");try{const i=btoa(`${r}:${n}`),o=await fetch("https://api.backblazeb2.com/b2api/v2/b2_authorize_account",{method:"GET",headers:{Authorization:`Basic ${i}`}});if(!o.ok)throw o.status===401?new Error("Invalid application key ID or key"):new Error(`HTTP ${o.status}: ${o.statusText}`);const a=await o.json();return this.createSuccessResult("Successfully connected to Backblaze B2",{accountId:a.accountId,apiUrl:a.apiUrl,downloadUrl:a.downloadUrl,timestamp:new Date().toISOString()})}catch(i){if(i instanceof Error)return this.createErrorResult(i.message);throw i}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/backblaze-b2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"backblaze-b2",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Backblaze B2 operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),bucketId:this.getConfig("bucketId"),hasCredentials:!!(this.getConfig("keyId")&&this.getConfig("applicationKey")),provider:"Backblaze B2"}}async listBuckets(){return await this.query("listBuckets")}async listFileNames(e,r,n){return await this.query("listFileNames",{bucketId:e||this.getConfig("bucketId"),prefix:r,maxFileCount:n})}async uploadFile(e,r,n){return await this.query("uploadFile",{fileName:e,data:r,contentType:n})}async downloadFileByName(e){return await this.query("downloadFileByName",{fileName:e})}async deleteFileVersion(e,r){return await this.query("deleteFileVersion",{fileName:e,fileId:r})}async getFileInfo(e){return await this.query("getFileInfo",{fileId:e})}async getDownloadAuthorization(e,r=3600){return await this.query("getDownloadAuthorization",{fileNamePrefix:e,validDurationInSeconds:r})}async copyFile(e,r){return await this.query("copyFile",{sourceFileId:e,destinationFileName:r})}}class mO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("region"),n=this.getConfig("bucket"),i=this.getConfig("accessKey"),o=this.getConfig("secretKey");return!r||!n||!i||!o?this.createErrorResult("Region, bucket, access key, and secret key are required"):(console.log("Validating Wasabi configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Wasabi bucket "${n}" in ${r}`,{validatedAt:new Date().toISOString(),region:r,bucket:n,endpoint:`https://s3.${r}.wasabisys.com`,hasCredentials:!0,note:"Client-side validation only. Wasabi requires backend integration with AWS SDK."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/wasabi",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"wasabi",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Wasabi operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),region:this.getConfig("region"),bucket:this.getConfig("bucket"),endpoint:`https://s3.${this.getConfig("region")}.wasabisys.com`,hasCredentials:!!(this.getConfig("accessKey")&&this.getConfig("secretKey"))}}async listObjects(e,r){return await this.query("listObjects",{prefix:e,maxKeys:r})}async getObject(e){return await this.query("getObject",{key:e})}async putObject(e,r,n){return await this.query("putObject",{key:e,body:r,contentType:n})}async deleteObject(e){return await this.query("deleteObject",{key:e})}async copyObject(e,r){return await this.query("copyObject",{sourceKey:e,destinationKey:r})}async headObject(e){return await this.query("headObject",{key:e})}async getPresignedUrl(e,r=3600){return await this.query("getPresignedUrl",{key:e,expiresIn:r})}async listBuckets(){return await this.query("listBuckets")}}class yO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("accountId"),n=this.getConfig("bucket"),i=this.getConfig("accessKeyId"),o=this.getConfig("secretAccessKey");return!r||!n||!i||!o?this.createErrorResult("Account ID, bucket, access key ID, and secret access key are required"):(console.log("Validating Cloudflare R2 configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Cloudflare R2 bucket "${n}"`,{validatedAt:new Date().toISOString(),accountId:r,bucket:n,endpoint:`https://${r}.r2.cloudflarestorage.com`,hasCredentials:!0,note:"Client-side validation only. Cloudflare R2 requires backend integration with AWS SDK."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/cloudflare-r2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"cloudflare-r2",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Cloudflare R2 operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),accountId:this.getConfig("accountId"),bucket:this.getConfig("bucket"),endpoint:`https://${this.getConfig("accountId")}.r2.cloudflarestorage.com`,hasCredentials:!!(this.getConfig("accessKeyId")&&this.getConfig("secretAccessKey"))}}async listObjects(e,r){return await this.query("listObjects",{prefix:e,maxKeys:r})}async getObject(e){return await this.query("getObject",{key:e})}async putObject(e,r,n){return await this.query("putObject",{key:e,body:r,metadata:n})}async deleteObject(e){return await this.query("deleteObject",{key:e})}async copyObject(e,r){return await this.query("copyObject",{sourceKey:e,destinationKey:r})}async headObject(e){return await this.query("headObject",{key:e})}async createMultipartUpload(e){return await this.query("createMultipartUpload",{key:e})}async getPresignedUrl(e,r=3600){return await this.query("getPresignedUrl",{key:e,expiresIn:r})}async listBuckets(){return await this.query("listBuckets")}async deleteObjects(e){return await this.query("deleteObjects",{keys:e})}}class bO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("region"),n=this.getConfig("namespace"),i=this.getConfig("bucket"),o=this.getConfig("accessKey"),a=this.getConfig("secretKey");return!r||!n||!i||!o||!a?this.createErrorResult("Region, namespace, bucket, access key, and secret key are required"):(console.log("Validating Oracle Cloud Storage configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Oracle Cloud bucket "${i}" in ${r}`,{validatedAt:new Date().toISOString(),region:r,namespace:n,bucket:i,endpoint:`https://${n}.compat.objectstorage.${r}.oraclecloud.com`,hasCredentials:!0,note:"Client-side validation only. Oracle Cloud Storage requires backend integration with AWS SDK."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/oracle-cloud-storage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"oracle-cloud-storage",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Oracle Cloud Storage operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),region:this.getConfig("region"),namespace:this.getConfig("namespace"),bucket:this.getConfig("bucket"),endpoint:`https://${this.getConfig("namespace")}.compat.objectstorage.${this.getConfig("region")}.oraclecloud.com`,hasCredentials:!!(this.getConfig("accessKey")&&this.getConfig("secretKey"))}}async listObjects(e,r){return await this.query("listObjects",{prefix:e,delimiter:r})}async getObject(e){return await this.query("getObject",{objectName:e})}async putObject(e,r,n){return await this.query("putObject",{objectName:e,data:r,metadata:n})}async deleteObject(e){return await this.query("deleteObject",{objectName:e})}async copyObject(e,r){return await this.query("copyObject",{sourceObject:e,destinationObject:r})}async headObject(e){return await this.query("headObject",{objectName:e})}async listBuckets(){return await this.query("listBuckets")}async createBucket(e){return await this.query("createBucket",{bucketName:e})}async deleteBucket(e){return await this.query("deleteBucket",{bucketName:e})}async createPreauthRequest(e,r=3600){return await this.query("createPreauthRequest",{objectName:e,expiresIn:r})}}class vO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("endpoint"),n=this.getConfig("bucket"),i=this.getConfig("apiKey"),o=this.getConfig("serviceInstanceId");return!r||!n||!i||!o?this.createErrorResult("Endpoint, bucket, API key, and service instance ID are required"):(console.log("Validating IBM Cloud Storage configuration (client-side only)"),this.createSuccessResult(`Configuration validated for IBM Cloud bucket "${n}"`,{validatedAt:new Date().toISOString(),endpoint:r,bucket:n,serviceInstanceId:o,hasCredentials:!0,note:"Client-side validation only. IBM Cloud Storage requires backend integration with IBM Cloud SDK or AWS SDK with IAM."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/ibm-cloud-storage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"ibm-cloud-storage",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`IBM Cloud Storage operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),endpoint:this.getConfig("endpoint"),bucket:this.getConfig("bucket"),hasCredentials:!!(this.getConfig("apiKey")&&this.getConfig("serviceInstanceId"))}}async listObjects(e,r){return await this.query("listObjects",{prefix:e,maxKeys:r})}async getObject(e){return await this.query("getObject",{key:e})}async putObject(e,r,n){return await this.query("putObject",{key:e,body:r,metadata:n})}async deleteObject(e){return await this.query("deleteObject",{key:e})}async copyObject(e,r){return await this.query("copyObject",{sourceKey:e,destinationKey:r})}async headObject(e){return await this.query("headObject",{key:e})}async listBuckets(){return await this.query("listBuckets")}async getPresignedUrl(e,r=3600){return await this.query("getPresignedUrl",{key:e,expiresIn:r})}async createMultipartUpload(e){return await this.query("createMultipartUpload",{key:e})}async getBucketCors(){return await this.query("getBucketCors")}}class SO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("accessToken");if(!r)return this.createErrorResult("Access token is required");console.log("Testing Microsoft Graph API connection...");try{const n=await fetch("https://graph.microsoft.com/v1.0/me",{method:"GET",headers:{Authorization:`Bearer ${r}`}});if(!n.ok)throw n.status===401?new Error("Invalid or expired access token"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return this.createSuccessResult("Successfully connected to Microsoft Graph API",{displayName:i.displayName||"Unknown",userPrincipalName:i.userPrincipalName||"Unknown",id:i.id||"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("accessToken"),o={method:r,headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}};n&&(r==="POST"||r==="PUT"||r==="PATCH")&&(o.body=JSON.stringify(n));const a=e.startsWith("http")?e:`https://graph.microsoft.com/v1.0${e}`,l=await fetch(a,o);if(!l.ok)throw new Error(`Query failed: ${l.status} ${l.statusText}`);return await l.json()}catch(i){throw new Error(`Microsoft Graph query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),hasAccessToken:!!this.getConfig("accessToken"),provider:"Microsoft Graph"}}async getMe(){return await this.query("/me")}async getMessages(e=10){return await this.query(`/me/messages?$top=${e}`)}async getCalendarEvents(e=10){return await this.query(`/me/events?$top=${e}`)}async getOneDriveFiles(){return await this.query("/me/drive/root/children")}async getUsers(e=10){return await this.query(`/users?$top=${e}`)}async getUser(e){return await this.query(`/users/${e}`)}async getGroups(e=10){return await this.query(`/groups?$top=${e}`)}async sendMail(e,r,n){const i={message:{subject:e,body:{contentType:"Text",content:r},toRecipients:n.map(o=>({emailAddress:{address:o}}))}};return await this.query("/me/sendMail","POST",i)}async createEvent(e,r,n,i){const o={subject:e,start:{dateTime:r,timeZone:"UTC"},end:{dateTime:n,timeZone:"UTC"},location:i?{displayName:i}:void 0};return await this.query("/me/events","POST",o)}async searchOneDrive(e){return await this.query(`/me/drive/root/search(q='${e}')`)}}class wO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",8194);return r?(console.log("Validating Bloomberg API configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Bloomberg API at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,note:"Client-side validation only. Bloomberg API requires backend integration with Bloomberg Terminal and blpapi SDK."})):this.createErrorResult("Host is required")}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/bloomberg",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"bloomberg",operation:e,params:r})});if(!n.ok)throw new Error(`Bloomberg operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Bloomberg query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",8194),provider:"Bloomberg"}}async getReferenceData(e,r){return await this.query("getReferenceData",{securities:e,fields:r})}async getHistoricalData(e,r,n,i){return await this.query("getHistoricalData",{securities:e,fields:r,startDate:n,endDate:i})}async getIntradayBarData(e,r,n,i){return await this.query("getIntradayBarData",{security:e,startDateTime:r,endDateTime:n,interval:i})}async subscribe(e,r){return await this.query("subscribe",{securities:e,fields:r})}}class EO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("appKey"),n=this.getConfig("username"),i=this.getConfig("password");return!r||!n||!i?this.createErrorResult("App key, username, and password are required"):(console.log("Validating Refinitiv API configuration (client-side only)"),this.createSuccessResult("Configuration validated for Refinitiv API",{validatedAt:new Date().toISOString(),username:n,note:"Client-side validation only. Refinitiv API requires backend integration with WebSocket and EMA/RFA protocols."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/refinitiv",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"refinitiv",operation:e,params:r})});if(!n.ok)throw new Error(`Refinitiv operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Refinitiv query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),username:this.getConfig("username"),hasCredentials:!!(this.getConfig("appKey")&&this.getConfig("password")),provider:"Refinitiv"}}async getMarketPrice(e){return await this.query("getMarketPrice",{rics:e})}async getHistoricalPricing(e,r,n,i){return await this.query("getHistoricalPricing",{ric:e,interval:r,start:n,end:i})}async getNewsHeadlines(e,r){return await this.query("getNewsHeadlines",{query:e,limit:r})}async searchInstruments(e){return await this.query("searchInstruments",{query:e})}async subscribe(e,r){return await this.query("subscribe",{rics:e,fields:r})}}class CO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("apiKey");if(!r)return this.createErrorResult("API key is required");console.log("Testing Finage API connection...");try{const n=await fetch(`https://api.finage.co.uk/agg/stock/list?apikey=${r}&limit=1`);if(!n.ok)throw n.status===401||n.status===403?new Error("Invalid API key or unauthorized access"):new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return this.createSuccessResult("Successfully connected to Finage API",{timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("apiKey"),i=new URLSearchParams({...r,apikey:n}),o=`https://api.finage.co.uk${e}?${i.toString()}`,a=await fetch(o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);return await a.json()}catch(n){throw new Error(`Finage query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasApiKey:!!this.getConfig("apiKey"),provider:"Finage"}}async getStockQuote(e){return await this.query(`/last/stock/${e}`)}async getStockHistory(e,r="1d"){return await this.query(`/agg/stock/${r}/${e}`)}async getForexRate(e){return await this.query(`/last/forex/${e}`)}async getCryptoPrice(e){return await this.query(`/last/crypto/${e}`)}async getNews(e=10){return await this.query("/news/market",{limit:e.toString()})}}class jO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("accessToken"),n=this.getConfig("sandbox",!1);if(!r)return this.createErrorResult("Access token is required");console.log("Testing Tradier API connection...");try{const o=await fetch(`${n?"https://sandbox.tradier.com":"https://api.tradier.com"}/v1/user/profile`,{method:"GET",headers:{Authorization:`Bearer ${r}`,Accept:"application/json"}});if(!o.ok)throw o.status===401?new Error("Invalid access token"):new Error(`HTTP ${o.status}: ${o.statusText}`);const a=await o.json();return this.createSuccessResult("Successfully connected to Tradier API",{accountId:a.profile?.account?.account_number||"Unknown",sandbox:n,timestamp:new Date().toISOString()})}catch(i){if(i instanceof Error)return this.createErrorResult(i.message);throw i}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("accessToken"),o=this.getConfig("sandbox",!1)?"https://sandbox.tradier.com":"https://api.tradier.com",a=r?`?${new URLSearchParams(r).toString()}`:"",l=`${o}${e}${a}`,d=await fetch(l,{method:"GET",headers:{Authorization:`Bearer ${n}`,Accept:"application/json"}});if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);return await d.json()}catch(n){throw new Error(`Tradier query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),hasAccessToken:!!this.getConfig("accessToken"),sandbox:this.getConfig("sandbox",!1),provider:"Tradier"}}async getUserProfile(){return await this.query("/v1/user/profile")}async getQuotes(e){return await this.query("/v1/markets/quotes",{symbols:e.join(",")})}async getOptionChains(e,r){const n={symbol:e};return r&&(n.expiration=r),await this.query("/v1/markets/options/chains",n)}async getHistoricalPrices(e,r,n,i){const o={symbol:e};return r&&(o.interval=r),n&&(o.start=n),i&&(o.end=i),await this.query("/v1/markets/history",o)}async getMarketCalendar(e,r){const n={};return e&&(n.month=e.toString()),r&&(n.year=r.toString()),await this.query("/v1/markets/calendar",n)}}class kO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("appId"),n=this.getConfig("apiKey");if(!r||!n)return this.createErrorResult("Application ID and API key are required");console.log("Testing Algolia API connection...");try{const i=await fetch(`https://${r}-dsn.algolia.net/1/indexes`,{method:"GET",headers:{"X-Algolia-Application-Id":r,"X-Algolia-API-Key":n}});if(!i.ok)throw i.status===401||i.status===403?new Error("Invalid application ID or API key"):new Error(`HTTP ${i.status}: ${i.statusText}`);const o=await i.json();return this.createSuccessResult("Successfully connected to Algolia",{appId:r,indicesCount:o.items?.length||0,timestamp:new Date().toISOString()})}catch(i){if(i instanceof Error)return this.createErrorResult(i.message);throw i}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("appId"),o=this.getConfig("apiKey"),a={method:r,headers:{"X-Algolia-Application-Id":i,"X-Algolia-API-Key":o,"Content-Type":"application/json"}};n&&(r==="POST"||r==="PUT")&&(a.body=JSON.stringify(n));const l=`https://${i}-dsn.algolia.net/1${e}`,d=await fetch(l,a);if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);return await d.json()}catch(i){throw new Error(`Algolia query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),appId:this.getConfig("appId"),index:this.getConfig("index"),hasCredentials:!!(this.getConfig("appId")&&this.getConfig("apiKey"))}}async search(e,r,n){return await this.query(`/indexes/${e}/query`,"POST",{query:r,...n})}async listIndices(){return await this.query("/indexes")}async getObject(e,r){return await this.query(`/indexes/${e}/${r}`)}async addObject(e,r){return await this.query(`/indexes/${e}`,"POST",r)}async updateObject(e,r,n){return await this.query(`/indexes/${e}/${r}`,"PUT",n)}async deleteObject(e,r){return await this.query(`/indexes/${e}/${r}`,"DELETE")}async clearIndex(e){return await this.query(`/indexes/${e}/clear`,"POST")}async getSettings(e){return await this.query(`/indexes/${e}/settings`)}}class AO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("apiKey");if(!r)return this.createErrorResult("Host is required");console.log("Testing MeiliSearch connection...");try{const i={};n&&(i.Authorization=`Bearer ${n}`);const o=await fetch(`${r}/health`,{method:"GET",headers:i});if(!o.ok)throw o.status===401||o.status===403?new Error("Invalid API key"):new Error(`HTTP ${o.status}: ${o.statusText}`);const a=await o.json();return this.createSuccessResult("Successfully connected to MeiliSearch",{status:a.status||"available",timestamp:new Date().toISOString()})}catch(i){if(i instanceof Error)return this.createErrorResult(i.message);throw i}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("host"),o=this.getConfig("apiKey"),a={"Content-Type":"application/json"};o&&(a.Authorization=`Bearer ${o}`);const l={method:r,headers:a};n&&(r==="POST"||r==="PUT"||r==="PATCH")&&(l.body=JSON.stringify(n));const d=`${i}${e}`,p=await fetch(d,l);if(!p.ok)throw new Error(`Query failed: ${p.status} ${p.statusText}`);return await p.json()}catch(i){throw new Error(`MeiliSearch query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),index:this.getConfig("index"),hasApiKey:!!this.getConfig("apiKey")}}async search(e,r,n){return await this.query(`/indexes/${e}/search`,"POST",{q:r,...n})}async listIndexes(){return await this.query("/indexes")}async createIndex(e,r){return await this.query("/indexes","POST",{uid:e,primaryKey:r})}async deleteIndex(e){return await this.query(`/indexes/${e}`,"DELETE")}async addDocuments(e,r,n){const i=n?`?primaryKey=${n}`:"";return await this.query(`/indexes/${e}/documents${i}`,"POST",r)}async getDocument(e,r){return await this.query(`/indexes/${e}/documents/${r}`)}async deleteDocument(e,r){return await this.query(`/indexes/${e}/documents/${r}`,"DELETE")}async getStats(e){return await this.query(`/indexes/${e}/stats`)}async getSettings(e){return await this.query(`/indexes/${e}/settings`)}async updateSettings(e,r){return await this.query(`/indexes/${e}/settings`,"PATCH",r)}}class TO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("server"),n=this.getConfig("database"),i=this.getConfig("username"),o=this.getConfig("password");return!r||!n||!i||!o?this.createErrorResult("Server, database, username, and password are required"):(console.log("Validating Azure Synapse configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Azure Synapse "${n}" at ${r}`,{validatedAt:new Date().toISOString(),server:r,database:n,note:"Client-side validation only. Azure Synapse requires backend integration with mssql or tedious driver."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/synapse",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"synapse",sql:e,params:r})});if(!n.ok)throw new Error(`Query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Azure Synapse query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),server:this.getConfig("server"),database:this.getConfig("database"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async executeQuery(e,r){return await this.query(e,r)}async getTables(e="dbo"){return await this.query("SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = @schema AND TABLE_TYPE = 'BASE TABLE'",[e])}async getTableSchema(e,r="dbo"){return await this.query("SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = @schema AND TABLE_NAME = @tableName",[r,e])}async getViews(e="dbo"){return await this.query("SELECT TABLE_NAME FROM INFORMATION_SCHEMA.VIEWS WHERE TABLE_SCHEMA = @schema",[e])}async getStoredProcedures(e="dbo"){return await this.query("SELECT ROUTINE_NAME FROM INFORMATION_SCHEMA.ROUTINES WHERE ROUTINE_SCHEMA = @schema AND ROUTINE_TYPE = 'PROCEDURE'",[e])}}class RO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",26257),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password");return!r||!i||!o||!a?this.createErrorResult("Host, database, username, and password are required"):(console.log("Validating CockroachDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for CockroachDB "${i}" at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,note:"Client-side validation only. CockroachDB requires backend integration with pg driver."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/cockroachdb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"cockroachdb",sql:e,params:r})});if(!n.ok)throw new Error(`Query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`CockroachDB query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",26257),database:this.getConfig("database"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async executeQuery(e,r){return await this.query(e,r)}async getTables(){return await this.query("SELECT table_name FROM information_schema.tables WHERE table_schema = current_schema()")}async getTableSchema(e){return await this.query("SELECT column_name, data_type, is_nullable FROM information_schema.columns WHERE table_name = $1",[e])}}class NO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",5433),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password");return!r||!i||!o||!a?this.createErrorResult("Host, database, username, and password are required"):(console.log("Validating Vertica configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Vertica "${i}" at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,database:i,note:"Client-side validation only. Vertica requires backend integration with vertica-nodejs driver."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/vertica",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"vertica",sql:e,params:r})});if(!n.ok)throw new Error(`Query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Vertica query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",5433),database:this.getConfig("database"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async executeQuery(e,r){return await this.query(e,r)}async getTables(e="public"){return await this.query("SELECT table_name FROM v_catalog.tables WHERE table_schema = $1",[e])}async getTableSchema(e,r="public"){return await this.query("SELECT column_name, data_type FROM v_catalog.columns WHERE table_schema = $1 AND table_name = $2",[r,e])}}class OO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url"),n=this.getConfig("username"),i=this.getConfig("password");if(!r)return this.createErrorResult("URL is required");console.log("Testing CouchDB connection...");try{const o={};n&&i&&(o.Authorization=`Basic ${btoa(`${n}:${i}`)}`);const a=await fetch(r,{headers:o});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const l=await a.json();return this.createSuccessResult("Successfully connected to CouchDB",{version:l.version||"Unknown",vendor:l.vendor?.name||"Unknown",timestamp:new Date().toISOString()})}catch(o){if(o instanceof Error)return this.createErrorResult(o.message);throw o}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("url"),o=this.getConfig("username"),a=this.getConfig("password"),l={"Content-Type":"application/json"};o&&a&&(l.Authorization=`Basic ${btoa(`${o}:${a}`)}`);const d={method:r,headers:l};n&&(r==="POST"||r==="PUT")&&(d.body=JSON.stringify(n));const p=await fetch(`${i}${e}`,d);if(!p.ok)throw new Error(`Query failed: ${p.status} ${p.statusText}`);return await p.json()}catch(i){throw new Error(`CouchDB query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async listDatabases(){return await this.query("/_all_dbs")}async getDocument(e,r){return await this.query(`/${e}/${r}`)}async createDocument(e,r){return await this.query(`/${e}`,"POST",r)}async updateDocument(e,r,n){return await this.query(`/${e}/${r}`,"PUT",n)}async deleteDocument(e,r,n){return await this.query(`/${e}/${r}?rev=${n}`,"DELETE")}async queryView(e,r,n,i){const o=i?`?${new URLSearchParams(i).toString()}`:"";return await this.query(`/${e}/_design/${r}/_view/${n}${o}`)}}class _O extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("region"),n=this.getConfig("accessKeyId"),i=this.getConfig("secretAccessKey");return!r||!n||!i?this.createErrorResult("Region, access key ID, and secret access key are required"):(console.log("Validating DynamoDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for DynamoDB in ${r}`,{validatedAt:new Date().toISOString(),region:r,note:"Client-side validation only. DynamoDB requires backend integration with AWS SDK."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/dynamodb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"dynamodb",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`DynamoDB query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),region:this.getConfig("region"),hasCredentials:!!(this.getConfig("accessKeyId")&&this.getConfig("secretAccessKey"))}}async listTables(){return await this.query("listTables")}async getItem(e,r){return await this.query("getItem",{tableName:e,key:r})}async putItem(e,r){return await this.query("putItem",{tableName:e,item:r})}async deleteItem(e,r){return await this.query("deleteItem",{tableName:e,key:r})}async scan(e,r){return await this.query("scan",{tableName:e,filter:r})}async queryTable(e,r){return await this.query("query",{tableName:e,keyCondition:r})}}class DO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("url"),n=this.getConfig("username"),i=this.getConfig("password");if(!r||!n||!i)return this.createErrorResult("URL, username, and password are required");console.log("Testing ArangoDB connection...");try{const o=btoa(`${n}:${i}`),a=await fetch(`${r}/_api/version`,{headers:{Authorization:`Basic ${o}`}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const l=await a.json();return this.createSuccessResult("Successfully connected to ArangoDB",{version:l.version||"Unknown",server:l.server||"arango",timestamp:new Date().toISOString()})}catch(o){if(o instanceof Error)return this.createErrorResult(o.message);throw o}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=this.getConfig("url"),i=this.getConfig("database","_system"),o=this.getConfig("username"),a=this.getConfig("password"),l=btoa(`${o}:${a}`),d=await fetch(`${n}/_db/${i}/_api/cursor`,{method:"POST",headers:{Authorization:`Basic ${l}`,"Content-Type":"application/json"},body:JSON.stringify({query:e,bindVars:r})});if(!d.ok)throw new Error(`Query failed: ${d.status} ${d.statusText}`);return await d.json()}catch(n){throw new Error(`ArangoDB query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),url:this.getConfig("url"),database:this.getConfig("database","_system"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}}class IO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("servers");return r?(console.log("Validating Memcached configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Memcached at ${r}`,{validatedAt:new Date().toISOString(),servers:r,note:"Client-side validation only. Memcached requires backend integration with memcached client library."})):this.createErrorResult("Servers are required")}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/memcached",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"memcached",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Memcached query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),servers:this.getConfig("servers")}}async get(e){return await this.query("get",{key:e})}async set(e,r,n){return await this.query("set",{key:e,value:r,ttl:n})}async delete(e){return await this.query("delete",{key:e})}async flush(){return await this.query("flush")}async stats(){return await this.query("stats")}}class PO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",28015);return r?(console.log("Validating RethinkDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for RethinkDB at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,note:"Client-side validation only. RethinkDB requires backend integration with rethinkdb driver."})):this.createErrorResult("Host is required")}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/rethinkdb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"rethinkdb",reql:e,params:r})});if(!n.ok)throw new Error(`Query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`RethinkDB query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",28015),database:this.getConfig("database")}}}class LO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("projectId"),n=this.getConfig("credentials");return!r||!n?this.createErrorResult("Project ID and service account credentials are required"):(console.log("Validating Firestore configuration (client-side only)"),this.createSuccessResult(`Configuration validated for Firestore project "${r}"`,{validatedAt:new Date().toISOString(),projectId:r,note:"Client-side validation only. Firestore requires backend integration with @google-cloud/firestore."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/firestore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"firestore",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Firestore query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),projectId:this.getConfig("projectId"),hasCredentials:!!this.getConfig("credentials")}}async getDocument(e,r){return await this.query("getDocument",{collection:e,docId:r})}async addDocument(e,r){return await this.query("addDocument",{collection:e,data:r})}async updateDocument(e,r,n){return await this.query("updateDocument",{collection:e,docId:r,data:n})}async deleteDocument(e,r){return await this.query("deleteDocument",{collection:e,docId:r})}async queryCollection(e,r){return await this.query("queryCollection",{collection:e,filters:r})}}class zO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("restUrl");if(!r)return this.createErrorResult("REST URL is required");console.log("Testing HBase connection...");try{const n=await fetch(`${r}/version/cluster`,{headers:{Accept:"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return this.createSuccessResult("Successfully connected to HBase",{version:i.Version||"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const i=this.getConfig("restUrl"),o={method:r,headers:{Accept:"application/json","Content-Type":"application/json"}};n&&(r==="POST"||r==="PUT")&&(o.body=JSON.stringify(n));const a=await fetch(`${i}${e}`,o);if(!a.ok)throw new Error(`Query failed: ${a.status} ${a.statusText}`);return await a.json()}catch(i){throw new Error(`HBase query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),restUrl:this.getConfig("restUrl")}}async listTables(){return await this.query("/")}async getRow(e,r){return await this.query(`/${e}/${r}`)}async putRow(e,r,n){return await this.query(`/${e}/${r}`,"PUT",n)}async deleteRow(e,r){return await this.query(`/${e}/${r}`,"DELETE")}async scanTable(e,r,n){let i=`/${e}/*`;return r&&(i+=`?startrow=${r}`),n&&(i+=`${r?"&":"?"}endrow=${n}`),await this.query(i)}}class MO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("contactPoints"),n=this.getConfig("keyspace");return r?(console.log("Validating ScyllaDB configuration (client-side only)"),this.createSuccessResult(`Configuration validated for ScyllaDB at ${r}`,{validatedAt:new Date().toISOString(),contactPoints:r,keyspace:n,note:"Client-side validation only. ScyllaDB requires backend integration with cassandra-driver."})):this.createErrorResult("Contact points are required")}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/scylladb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"scylladb",cql:e,params:r})});if(!n.ok)throw new Error(`Query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`ScyllaDB query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),contactPoints:this.getConfig("contactPoints"),keyspace:this.getConfig("keyspace"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}}class BO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",2480),i=this.getConfig("database"),o=this.getConfig("username"),a=this.getConfig("password");if(!r||!i||!o||!a)return this.createErrorResult("Host, database, username, and password are required");console.log("Testing OrientDB connection...");try{const l=btoa(`${o}:${a}`),d=await fetch(`http://${r}:${n}/connect/${i}`,{headers:{Authorization:`Basic ${l}`}});if(!d.ok)throw new Error(`HTTP ${d.status}: ${d.statusText}`);return this.createSuccessResult("Successfully connected to OrientDB",{host:r,port:n,database:i,timestamp:new Date().toISOString()})}catch(l){if(l instanceof Error)return this.createErrorResult(l.message);throw l}}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/orientdb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"orientdb",sql:e,params:r})});if(!n.ok)throw new Error(`Query failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`OrientDB query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",2480),database:this.getConfig("database"),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}}class FO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("endpoint"),n=this.getConfig("key");return!r||!n?this.createErrorResult("Endpoint and key are required"):(console.log("Validating Cosmos DB configuration (client-side only)"),this.createSuccessResult("Configuration validated for Azure Cosmos DB",{validatedAt:new Date().toISOString(),endpoint:r,note:"Client-side validation only. Cosmos DB requires backend integration with @azure/cosmos SDK."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/cosmosdb",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"cosmosdb",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`Cosmos DB query error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),endpoint:this.getConfig("endpoint"),database:this.getConfig("database"),hasCredentials:!!this.getConfig("key")}}async getItem(e,r,n){return await this.query("getItem",{container:e,itemId:r,partitionKey:n})}async createItem(e,r){return await this.query("createItem",{container:e,item:r})}async updateItem(e,r,n,i){return await this.query("updateItem",{container:e,itemId:r,item:n,partitionKey:i})}async deleteItem(e,r,n){return await this.query("deleteItem",{container:e,itemId:r,partitionKey:n})}async queryItems(e,r){return await this.query("queryItems",{container:e,sqlQuery:r})}}class $O extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("hosts");if(!r)return this.createErrorResult("Hosts are required");console.log("Testing etcd connection...");try{const n=r.split(","),i=await fetch(`${n[0]}/version`);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const o=await i.json();return this.createSuccessResult("Successfully connected to etcd",{etcdserver:o.etcdserver||"Unknown",etcdcluster:o.etcdcluster||"Unknown",timestamp:new Date().toISOString()})}catch(n){if(n instanceof Error)return this.createErrorResult(n.message);throw n}}catch(e){return this.createErrorResult(e)}}async query(e,r="GET",n){try{const o=this.getConfig("hosts").split(","),a={method:r,headers:{"Content-Type":"application/json"}};n&&(r==="POST"||r==="PUT")&&(a.body=JSON.stringify(n));const l=await fetch(`${o[0]}${e}`,a);if(!l.ok)throw new Error(`Query failed: ${l.status} ${l.statusText}`);return await l.json()}catch(i){throw new Error(`etcd query error: ${i instanceof Error?i.message:String(i)}`)}}async getMetadata(){return{...await super.getMetadata(),hosts:this.getConfig("hosts")}}async get(e){return await this.query("/v3/kv/range","POST",{key:btoa(e)})}async put(e,r){return await this.query("/v3/kv/put","POST",{key:btoa(e),value:btoa(r)})}async delete(e){return await this.query("/v3/kv/deleterange","POST",{key:btoa(e)})}}class GO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",21),i=this.getConfig("username"),o=this.getConfig("password");return!r||!i||!o?this.createErrorResult("Host, username, and password are required"):(console.log("Validating FTP configuration (client-side only)"),this.createSuccessResult(`Configuration validated for FTP at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,note:"Client-side validation only. FTP requires backend integration with basic-ftp or similar library."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/ftp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"ftp",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`FTP operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",21),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async list(e="/"){return await this.query("list",{path:e})}async get(e){return await this.query("get",{remotePath:e})}async put(e,r){return await this.query("put",{localPath:e,remotePath:r})}async delete(e){return await this.query("delete",{remotePath:e})}async mkdir(e){return await this.query("mkdir",{path:e})}async rmdir(e){return await this.query("rmdir",{path:e})}}class UO extends St{async testConnection(){try{const e=this.validateConfig();if(!e.valid)return this.createErrorResult(e.errors.join(", "));const r=this.getConfig("host"),n=this.getConfig("port",22),i=this.getConfig("username"),o=this.getConfig("password");return!r||!i||!o?this.createErrorResult("Host, username, and password are required"):(console.log("Validating SFTP configuration (client-side only)"),this.createSuccessResult(`Configuration validated for SFTP at ${r}:${n}`,{validatedAt:new Date().toISOString(),host:r,port:n,note:"Client-side validation only. SFTP requires backend integration with ssh2-sftp-client or similar library."}))}catch(e){return this.createErrorResult(e)}}async query(e,r){try{const n=await fetch("/api/data-sources/sftp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({connectionId:this.connection.id,type:"sftp",operation:e,params:r})});if(!n.ok)throw new Error(`Operation failed: ${n.statusText}`);return await n.json()}catch(n){throw new Error(`SFTP operation error: ${n instanceof Error?n.message:String(n)}`)}}async getMetadata(){return{...await super.getMetadata(),host:this.getConfig("host"),port:this.getConfig("port",22),hasCredentials:!!(this.getConfig("username")&&this.getConfig("password"))}}async list(e="/"){return await this.query("list",{path:e})}async get(e){return await this.query("get",{remotePath:e})}async put(e,r){return await this.query("put",{localPath:e,remotePath:r})}async delete(e){return await this.query("delete",{remotePath:e})}async mkdir(e){return await this.query("mkdir",{path:e})}async rmdir(e){return await this.query("rmdir",{path:e})}async stat(e){return await this.query("stat",{remotePath:e})}}const WO={postgresql:cN,mysql:dN,mariadb:uN,sqlite:fN,oracle:GN,sqlserver:Tb,mssql:Tb,cockroachdb:RO,vertica:NO,mongodb:pN,redis:hN,cassandra:EN,neo4j:ON,couchdb:OO,dynamodb:_O,arangodb:DO,memcached:IO,rethinkdb:PO,firestore:LO,hbase:zO,scylladb:MO,orientdb:BO,cosmosdb:FO,etcd:$O,clickhouse:TN,snowflake:CN,bigquery:kN,redshift:RN,databricks:UN,synapse:TO,influxdb:mN,questdb:yN,timescaledb:bN,prometheus:NN,victoriametrics:rO,opentsdb:nO,kdb:sO,kafka:AN,rabbitmq:FN,mqtt:pO,nats:hO,s3:Ab,"aws-s3":Ab,"google-cloud-storage":WN,"azure-blob":qN,"digitalocean-spaces":fO,minio:gO,"backblaze-b2":xO,wasabi:mO,"cloudflare-r2":yO,"oracle-cloud-storage":bO,"ibm-cloud-storage":vO,csv:gN,excel:IN,json:PN,parquet:LN,xml:iO,avro:oO,orc:aO,feather:lO,graphql:_N,"rest-api":DN,websocket:$N,grpc:cO,soap:dO,odata:uO,"microsoft-graph":SO,ftp:GO,sftp:UO,"yahoo-finance":xN,"alpha-vantage":vN,"polygon-io":SN,finnhub:jN,coingecko:zN,binance:MN,coinbase:BN,"iex-cloud":HN,coinmarketcap:YN,"twelve-data":KN,quandl:VN,"eod-historical":XN,tiingo:JN,intrinio:QN,marketstack:ZN,bloomberg:wO,reuters:EO,finage:CO,tradier:jO,elasticsearch:wN,opensearch:eO,solr:tO,algolia:kO,meilisearch:AO};function EK(s){const e=WO[s.type];return e?new e(s):(console.warn(`No adapter found for data source type: ${s.type}`),null)}function qO(s){return s in WO}const HO=Object.freeze(Object.defineProperty({__proto__:null,AlgoliaAdapter:kO,AlphaVantageAdapter:vN,ArangoDBAdapter:DO,AvroAdapter:oO,AzureBlobAdapter:qN,AzureSynapseAdapter:TO,BackblazeB2Adapter:xO,BaseAdapter:St,BigQueryAdapter:kN,BinanceAdapter:MN,BloombergAdapter:wO,CSVAdapter:gN,CassandraAdapter:EN,ClickHouseAdapter:TN,CloudflareR2Adapter:yO,CockroachDBAdapter:RO,CoinGeckoAdapter:zN,CoinMarketCapAdapter:YN,CoinbaseAdapter:BN,CosmosDBAdapter:FO,CouchDBAdapter:OO,DatabricksAdapter:UN,DigitalOceanSpacesAdapter:fO,DynamoDBAdapter:_O,EODHistoricalDataAdapter:XN,ElasticsearchAdapter:wN,EtcdAdapter:$O,ExcelAdapter:IN,FTPAdapter:GO,FeatherAdapter:lO,FinageAdapter:CO,FinnhubAdapter:jN,FirestoreAdapter:LO,GCPStorageAdapter:WN,GRPCAdapter:cO,GraphQLAdapter:_N,HBaseAdapter:zO,IBMCloudStorageAdapter:vO,IEXCloudAdapter:HN,InfluxDBAdapter:mN,IntrinioAdapter:QN,JSONAdapter:PN,KDBAdapter:sO,KafkaAdapter:AN,MQTTAdapter:pO,MSGraphAdapter:SO,MariaDBAdapter:uN,MarketstackAdapter:ZN,MeiliSearchAdapter:AO,MemcachedAdapter:IO,MinIOAdapter:gO,MongoDBAdapter:pN,MySQLAdapter:dN,NATSAdapter:hO,Neo4jAdapter:ON,ODataAdapter:uO,ORCAdapter:aO,OpenSearchAdapter:eO,OpenTSDBAdapter:nO,OracleAdapter:GN,OracleCloudStorageAdapter:bO,OrientDBAdapter:BO,ParquetAdapter:LN,PolygonAdapter:SN,PostgreSQLAdapter:cN,PrometheusAdapter:NN,QuandlAdapter:VN,QuestDBAdapter:yN,RESTAdapter:DN,RabbitMQAdapter:FN,RedisAdapter:hN,RedshiftAdapter:RN,RefinitivAdapter:EO,RethinkDBAdapter:PO,S3Adapter:Ab,SFTPAdapter:UO,SOAPAdapter:dO,SQLServerAdapter:Tb,SQLiteAdapter:fN,ScyllaDBAdapter:MO,SnowflakeAdapter:CN,SolrAdapter:tO,TiingoAdapter:JN,TimescaleDBAdapter:bN,TradierAdapter:jO,TwelveDataAdapter:KN,VerticaAdapter:NO,VictoriaMetricsAdapter:rO,WasabiAdapter:mO,WebSocketAdapter:$N,XMLAdapter:iO,YahooFinanceAdapter:xN,createAdapter:EK,hasAdapter:qO},Symbol.toStringTag,{value:"Module"}));function CK(){const{connections:s,addConnection:e,updateConnection:r,deleteConnection:n,testConnection:i}=TP(),[o,a]=S.useState("gallery"),[l,d]=S.useState(""),[p,f]=S.useState("all"),[h,x]=S.useState(!1),[m,b]=S.useState(null),[w,y]=S.useState({}),[C,T]=S.useState(null),E=I=>{switch(I){case"database":return t.jsx(js,{size:16});case"api":return t.jsx(fc,{size:16});case"file":return t.jsx(ri,{size:16});case"streaming":return t.jsx(Cs,{size:16});case"cloud":return t.jsx(x4,{size:16});case"timeseries":return t.jsx(Nr,{size:16});case"market-data":return t.jsx(Nr,{size:16});default:return t.jsx(js,{size:16})}},j=Pf.filter(I=>{const O=I.name.toLowerCase().includes(l.toLowerCase())||I.description.toLowerCase().includes(l.toLowerCase()),G=p==="all"||I.category===p;return O&&G}),k=I=>{b(I),T(null);const O={};I.fields.forEach(G=>{G.defaultValue!==void 0&&(O[G.name]=G.defaultValue)}),y(O),x(!0)},A=I=>{const O=Pf.find(G=>G.type===I.type);O&&(b(O),T(I),y({...I.config,name:I.name}),x(!0))},R=()=>{if(m){if(C)r(C.id,{name:w.name||C.name,config:{...w}}),console.log("Updated connection:",C.id);else{const I={id:`conn_${Date.now()}`,name:w.name||`${m.name} Connection`,type:m.type,category:m.category,config:{...w},status:"disconnected",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};e(I),console.log("Saved connection:",I)}x(!1),b(null),y({}),T(null),a("connections")}},M=I=>{n(I)},P=async I=>{console.log("Testing connection:",I),r(I.id,{status:"testing",lastTested:new Date().toISOString()}),await i(I)};return t.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:"#0a0a0a",display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{backgroundColor:"#1a1a1a",borderBottom:"1px solid #2d2d2d",padding:"12px 16px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:"#ea580c",fontSize:"14px",fontWeight:"bold",letterSpacing:"0.5px"},children:"DATA SOURCES"}),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsxs("span",{style:{color:"#737373",fontSize:"11px"},children:[Pf.length," Available | ",s.length," Connected"]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("button",{onClick:()=>a("gallery"),style:{backgroundColor:o==="gallery"?"#ea580c":"transparent",color:o==="gallery"?"white":"#a3a3a3",border:`1px solid ${o==="gallery"?"#ea580c":"#404040"}`,padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:"GALLERY"}),t.jsxs("button",{onClick:()=>a("connections"),style:{backgroundColor:o==="connections"?"#ea580c":"transparent",color:o==="connections"?"white":"#a3a3a3",border:`1px solid ${o==="connections"?"#ea580c":"#404040"}`,padding:"6px 12px",fontSize:"11px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:["MY CONNECTIONS (",s.length,")"]})]})]}),o==="gallery"&&t.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[t.jsxs("div",{style:{position:"relative",flex:1},children:[t.jsx(Ho,{size:16,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:"#737373"}}),t.jsx("input",{type:"text",placeholder:"Search data sources...",value:l,onChange:I=>d(I.target.value),style:{width:"100%",backgroundColor:"#0a0a0a",border:"1px solid #2d2d2d",color:"#a3a3a3",padding:"8px 12px 8px 36px",fontSize:"11px",borderRadius:"4px",outline:"none"}})]}),t.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:["all","database","api","file","streaming","cloud","timeseries","market-data"].map(I=>t.jsxs("button",{onClick:()=>f(I),style:{backgroundColor:p===I?"#2d2d2d":"transparent",color:p===I?"#ea580c":"#737373",border:`1px solid ${p===I?"#ea580c":"#2d2d2d"}`,padding:"6px 10px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",textTransform:"uppercase",display:"flex",alignItems:"center",gap:"4px"},children:[I!=="all"&&E(I),I.replace("-"," ")]},I))})]})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"16px",scrollbarWidth:"none",msOverflowStyle:"none"},className:"hide-scrollbar",children:[t.jsx("style",{children:`
          .hide-scrollbar::-webkit-scrollbar {
            display: none;
          }
        `}),o==="gallery"?t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"16px"},children:j.map(I=>t.jsxs("div",{style:{backgroundColor:"#1a1a1a",border:"1px solid #2d2d2d",borderRadius:"6px",padding:"16px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:O=>{O.currentTarget.style.borderColor=I.color,O.currentTarget.style.boxShadow=`0 0 12px ${I.color}40`},onMouseLeave:O=>{O.currentTarget.style.borderColor="#2d2d2d",O.currentTarget.style.boxShadow="none"},onClick:()=>k(I),children:[t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[t.jsx("span",{style:{fontSize:"32px"},children:I.icon}),t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[t.jsx("h3",{style:{color:I.color,fontSize:"13px",fontWeight:"bold"},children:I.name}),qO(I.type)&&t.jsx("span",{style:{backgroundColor:"#10b98120",color:"#10b981",padding:"2px 6px",fontSize:"8px",borderRadius:"3px",fontWeight:"bold"},children:" READY"})]}),t.jsx("div",{style:{display:"inline-block",backgroundColor:`${I.color}20`,color:I.color,padding:"2px 8px",fontSize:"9px",borderRadius:"3px",textTransform:"uppercase",fontWeight:"bold"},children:I.category})]})]}),t.jsx("p",{style:{color:"#a3a3a3",fontSize:"11px",lineHeight:"1.5",marginBottom:"12px"},children:I.description}),t.jsxs("div",{style:{display:"flex",gap:"8px",fontSize:"10px",color:"#737373"},children:[I.requiresAuth&&t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Mn,{size:12})," Auth Required"]}),I.testable&&t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Es,{size:12})," Testable"]})]})]},I.id))}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:s.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#737373"},children:[t.jsx(js,{size:48,style:{marginBottom:"16px",opacity:.3}}),t.jsx("h3",{style:{fontSize:"14px",marginBottom:"8px",color:"#a3a3a3"},children:"No connections configured"}),t.jsx("p",{style:{fontSize:"11px",marginBottom:"16px"},children:"Add your first data source connection to get started"}),t.jsx("button",{onClick:()=>a("gallery"),style:{backgroundColor:"#ea580c",color:"white",border:"none",padding:"8px 16px",fontSize:"11px",cursor:"pointer",borderRadius:"4px",fontWeight:"bold"},children:"BROWSE DATA SOURCES"})]}):s.map(I=>{const O=Pf.find(G=>G.type===I.type);return t.jsxs("div",{style:{backgroundColor:"#1a1a1a",border:"1px solid #2d2d2d",borderRadius:"6px",padding:"16px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{fontSize:"24px"},children:O?.icon}),t.jsxs("div",{children:[t.jsx("h3",{style:{color:"#a3a3a3",fontSize:"13px",fontWeight:"bold",marginBottom:"4px"},children:I.name}),t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.jsx("span",{style:{display:"inline-block",backgroundColor:`${O?.color}20`,color:O?.color,padding:"2px 8px",fontSize:"9px",borderRadius:"3px",textTransform:"uppercase",fontWeight:"bold"},children:I.type}),t.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"4px",fontSize:"10px",color:I.status==="connected"?"#10b981":I.status==="error"?"#ef4444":I.status==="testing"?"#f59e0b":"#737373"},children:[I.status==="connected"&&t.jsx(Es,{size:12}),I.status==="error"&&t.jsx(ln,{size:12}),I.status==="testing"&&t.jsx(xn,{size:12,className:"animate-spin"}),I.status==="disconnected"&&t.jsx(Rr,{size:12}),I.status.toUpperCase()]})]})]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[O?.testable&&t.jsxs("button",{onClick:()=>P(I),disabled:I.status==="testing",style:{backgroundColor:"transparent",color:"#10b981",border:"1px solid #10b981",padding:"6px 12px",fontSize:"10px",cursor:I.status==="testing"?"not-allowed":"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",opacity:I.status==="testing"?.5:1},children:[t.jsx(xn,{size:12}),"TEST"]}),t.jsxs("button",{onClick:()=>A(I),style:{backgroundColor:"transparent",color:"#a3a3a3",border:"1px solid #404040",padding:"6px 12px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(ug,{size:12}),"EDIT"]}),t.jsxs("button",{onClick:()=>M(I.id),style:{backgroundColor:"transparent",color:"#ef4444",border:"1px solid #ef4444",padding:"6px 12px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(On,{size:12}),"DELETE"]})]})]}),I.lastTested&&t.jsxs("div",{style:{marginTop:"12px",fontSize:"10px",color:"#737373"},children:["Last tested: ",new Date(I.lastTested).toLocaleString()]}),I.errorMessage&&t.jsxs("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:"#ef444420",border:"1px solid #ef4444",borderRadius:"4px",fontSize:"10px",color:"#ef4444"},children:["Error: ",I.errorMessage]})]},I.id)})})]}),h&&m&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:()=>x(!1),children:t.jsxs("div",{style:{backgroundColor:"#1a1a1a",border:"1px solid #2d2d2d",borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none"},className:"hide-scrollbar-modal",onClick:I=>I.stopPropagation(),children:[t.jsx("style",{children:`
              .hide-scrollbar-modal::-webkit-scrollbar {
                display: none;
              }
            `}),t.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid #2d2d2d",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{fontSize:"32px"},children:m.icon}),t.jsxs("div",{children:[t.jsxs("h2",{style:{color:m.color,fontSize:"16px",fontWeight:"bold"},children:[C?"Edit":"Configure"," ",m.name]}),t.jsx("p",{style:{color:"#737373",fontSize:"11px"},children:m.description})]})]}),t.jsx("button",{onClick:()=>x(!1),style:{background:"transparent",border:"none",color:"#a3a3a3",cursor:"pointer",padding:"4px"},children:t.jsx(ln,{size:20})})]}),t.jsxs("div",{style:{padding:"16px"},children:[t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:"#a3a3a3",fontSize:"11px",display:"block",marginBottom:"6px"},children:"Connection Name *"}),t.jsx("input",{type:"text",placeholder:`My ${m.name} Connection`,value:w.name||"",onChange:I=>y({...w,name:I.target.value}),style:{width:"100%",backgroundColor:"#0a0a0a",border:"1px solid #2d2d2d",color:"#a3a3a3",padding:"8px 12px",fontSize:"11px",borderRadius:"4px",outline:"none"}})]}),m.fields.map(I=>t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsxs("label",{style:{color:"#a3a3a3",fontSize:"11px",display:"block",marginBottom:"6px"},children:[I.label," ",I.required&&"*"]}),I.type==="select"?t.jsx("select",{value:w[I.name]||I.defaultValue||"",onChange:O=>y({...w,[I.name]:O.target.value}),style:{width:"100%",backgroundColor:"#0a0a0a",border:"1px solid #2d2d2d",color:"#a3a3a3",padding:"8px 12px",fontSize:"11px",borderRadius:"4px",outline:"none"},children:I.options?.map(O=>t.jsx("option",{value:O.value,children:O.label},O.value))}):I.type==="textarea"?t.jsx("textarea",{placeholder:I.placeholder,value:w[I.name]||"",onChange:O=>y({...w,[I.name]:O.target.value}),rows:4,style:{width:"100%",backgroundColor:"#0a0a0a",border:"1px solid #2d2d2d",color:"#a3a3a3",padding:"8px 12px",fontSize:"11px",borderRadius:"4px",outline:"none",fontFamily:"monospace"}}):I.type==="checkbox"?t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:w[I.name]||I.defaultValue||!1,onChange:O=>y({...w,[I.name]:O.target.checked}),style:{cursor:"pointer"}}),t.jsx("span",{style:{color:"#737373",fontSize:"11px"},children:I.placeholder})]}):t.jsx("input",{type:I.type,placeholder:I.placeholder,value:w[I.name]||"",onChange:O=>y({...w,[I.name]:I.type==="number"?Number(O.target.value):O.target.value}),style:{width:"100%",backgroundColor:"#0a0a0a",border:"1px solid #2d2d2d",color:"#a3a3a3",padding:"8px 12px",fontSize:"11px",borderRadius:"4px",outline:"none"}})]},I.name))]}),t.jsxs("div",{style:{padding:"16px",borderTop:"1px solid #2d2d2d",display:"flex",justifyContent:"flex-end",gap:"12px"},children:[t.jsx("button",{onClick:()=>x(!1),style:{backgroundColor:"transparent",color:"#a3a3a3",border:"1px solid #404040",padding:"8px 16px",fontSize:"11px",cursor:"pointer",borderRadius:"4px",fontWeight:"bold"},children:"CANCEL"}),t.jsx("button",{onClick:R,style:{backgroundColor:"#ea580c",color:"white",border:"none",padding:"8px 16px",fontSize:"11px",cursor:"pointer",borderRadius:"4px",fontWeight:"bold"},children:C?"UPDATE CONNECTION":"SAVE CONNECTION"})]})]})})]})}function Ek({items:s,onChange:e,placeholder:r={key:"Key",value:"Value"},allowPlaceholders:n=!1}){const[i,o]=S.useState(()=>Object.entries(s).map(([h,x])=>({key:h,value:x}))),a=()=>{o([...i,{key:"",value:""}])},l=h=>{const x=i.filter((m,b)=>b!==h);o(x),f(x)},d=(h,x)=>{const m=[...i];m[h].key=x,o(m),f(m)},p=(h,x)=>{const m=[...i];m[h].value=x,o(m),f(m)},f=h=>{const x={};h.forEach(m=>{m.key.trim()&&(x[m.key]=m.value)}),e(x)};return t.jsxs("div",{className:"space-y-2",children:[i.map((h,x)=>t.jsxs("div",{className:"flex gap-2 items-center",children:[t.jsx("input",{type:"text",value:h.key,onChange:m=>d(x,m.target.value),placeholder:r.key,className:"flex-1 bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500 font-mono"}),t.jsx("input",{type:"text",value:h.value,onChange:m=>p(x,m.target.value),placeholder:r.value,className:"flex-1 bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500 font-mono"}),t.jsx("button",{onClick:()=>l(x),className:"p-2 text-red-500 hover:text-red-400 hover:bg-zinc-800 rounded transition-colors",title:"Remove",children:t.jsx(On,{size:14})})]},x)),t.jsxs("button",{onClick:a,className:"w-full bg-zinc-800 hover:bg-zinc-700 text-gray-400 hover:text-white py-2 rounded text-xs font-bold flex items-center justify-center gap-2 transition-colors",children:[t.jsx(wn,{size:14}),"Add ",r.key||"Item"]}),n&&t.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[" Use ","{","placeholder","}"," syntax for dynamic values (e.g., ","{","symbol","}",", ","{","from","}",", ","{","to","}",")"]})]})}function jK({error:s,onRetry:e}){if(!s)return null;const r=()=>{switch(s.type){case"network":case"timeout":return t.jsx(Rr,{size:24,className:"text-red-500"});case"auth":return t.jsx(Cl,{size:24,className:"text-yellow-500"});case"client":case"server":case"parse":return t.jsx(dg,{size:24,className:"text-orange-500"});default:return t.jsx(Rr,{size:24,className:"text-red-500"})}},n=()=>{switch(s.type){case"auth":return"border-yellow-700 bg-yellow-900/20";case"client":return"border-orange-700 bg-orange-900/20";case"server":return"border-red-700 bg-red-900/20";case"network":case"timeout":return"border-red-700 bg-red-900/20";case"parse":return"border-purple-700 bg-purple-900/20";default:return"border-red-700 bg-red-900/20"}},i=()=>{const l=[];switch(s.type){case"network":l.push("Check your internet connection"),l.push("Verify the API URL is correct"),l.push("Check if CORS is blocking the request (see browser console)");break;case"timeout":l.push("The API might be slow or unresponsive"),l.push("Try increasing the timeout setting"),l.push("Check if the API endpoint is correct");break;case"auth":l.push("Verify your API key or credentials are correct"),l.push("Check if the authentication type is correct (API Key, Bearer, Basic)"),l.push("Ensure the API key has the necessary permissions");break;case"client":s.statusCode===400?(l.push("Check if all required parameters are provided"),l.push("Verify parameter formats and values")):s.statusCode===404?(l.push("Check if the endpoint URL is correct"),l.push("Verify the resource exists")):s.statusCode===429&&(l.push("You have exceeded the API rate limit"),l.push("Wait a moment and try again"));break;case"server":l.push("The API server is experiencing issues"),l.push("Try again in a few moments"),l.push("Contact the API provider if the issue persists");break;case"parse":l.push("The API returned data in an unexpected format"),l.push("Check if the endpoint is correct"),l.push("Verify the API documentation");break}return l},o=()=>{switch(s.type){case"network":return"Network Error";case"timeout":return"Request Timeout";case"auth":return"Authentication Failed";case"client":return`Client Error ${s.statusCode?`(${s.statusCode})`:""}`;case"server":return`Server Error ${s.statusCode?`(${s.statusCode})`:""}`;case"parse":return"Response Parse Error";default:return"Error"}},a=i();return t.jsxs("div",{className:`rounded-lg border ${n()} p-4`,children:[t.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[r(),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-sm font-bold text-white mb-1",children:o()}),t.jsx("p",{className:"text-xs text-gray-300",children:s.message})]})]}),s.statusCode&&t.jsxs("div",{className:"mb-3 text-xs",children:[t.jsx("span",{className:"text-gray-400",children:"Status Code:"})," ",t.jsx("span",{className:"font-mono text-white",children:s.statusCode})]}),a.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsx("h4",{className:"text-xs font-bold text-orange-500 uppercase mb-2",children:"Suggestions:"}),t.jsx("ul",{className:"space-y-1",children:a.map((l,d)=>t.jsxs("li",{className:"text-xs text-gray-300 flex items-start gap-2",children:[t.jsx("span",{className:"text-orange-500 mt-0.5",children:""}),t.jsx("span",{children:l})]},d))})]}),s.details&&t.jsxs("details",{className:"mb-3",children:[t.jsx("summary",{className:"text-xs font-bold text-gray-400 cursor-pointer hover:text-white",children:"Technical Details"}),t.jsx("pre",{className:"mt-2 text-xs text-gray-500 font-mono whitespace-pre-wrap overflow-auto max-h-32 bg-black/30 p-2 rounded",children:s.details})]}),e&&t.jsxs("button",{onClick:e,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-2 rounded text-xs font-bold flex items-center justify-center gap-2 transition-colors",children:[t.jsx(xn,{size:14}),"RETRY REQUEST"]})]})}function kK({config:s,onChange:e,onTestSuccess:r}){const[n,i]=S.useState({}),[o,a]=S.useState(!1),[l,d]=S.useState(null),[p,f]=S.useState(null),[h,x]=S.useState(!1),m=[...kg(s.endpoint),...Object.values(s.queryParams).flatMap(E=>kg(E))],b=[...new Set(m)];S.useEffect(()=>{const E={};b.forEach(j=>{E[j]=n[j]||""}),i(E)},[s.endpoint,JSON.stringify(s.queryParams)]);const w=E=>{e({...s,authentication:{type:E,config:E==="none"?void 0:{}}})},y=E=>{e({...s,authentication:{...s.authentication,config:{...s.authentication.config,...E}}})},C=async()=>{a(!0),d(null),f(null);try{const E=await A2.executeRequest(s,n);E.success?(f(E.data),r(E.data),d(null)):(d(E.error),f(null))}catch(E){d({type:"network",message:E instanceof Error?E.message:String(E)}),f(null)}finally{a(!1)}},T=v9(s,n);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"Mapping Details"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Mapping Name *"}),t.jsx("input",{type:"text",value:s.name,onChange:E=>e({...s,name:E.target.value}),placeholder:"My API Mapping",className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-sm rounded focus:outline-none focus:border-orange-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Description"}),t.jsx("textarea",{value:s.description,onChange:E=>e({...s,description:E.target.value}),placeholder:"Brief description of this mapping",rows:2,className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-sm rounded focus:outline-none focus:border-orange-500 resize-none"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"API Endpoint"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Base URL *"}),t.jsx("input",{type:"text",value:s.baseUrl,onChange:E=>e({...s,baseUrl:E.target.value}),placeholder:"https://api.example.com",className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-sm rounded focus:outline-none focus:border-orange-500 font-mono"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Endpoint Path *"}),t.jsx("input",{type:"text",value:s.endpoint,onChange:E=>e({...s,endpoint:E.target.value}),placeholder:"/v1/data/{symbol}",className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-sm rounded focus:outline-none focus:border-orange-500 font-mono"}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Use ","{","placeholder","}"," for dynamic values"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Method *"}),t.jsxs("select",{value:s.method,onChange:E=>e({...s,method:E.target.value}),className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-sm rounded focus:outline-none focus:border-orange-500",children:[t.jsx("option",{value:"GET",children:"GET"}),t.jsx("option",{value:"POST",children:"POST"}),t.jsx("option",{value:"PUT",children:"PUT"}),t.jsx("option",{value:"DELETE",children:"DELETE"}),t.jsx("option",{value:"PATCH",children:"PATCH"})]})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"Authentication"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("select",{value:s.authentication.type,onChange:E=>w(E.target.value),className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-sm rounded focus:outline-none focus:border-orange-500",children:[t.jsx("option",{value:"none",children:"No Authentication"}),t.jsx("option",{value:"apikey",children:"API Key"}),t.jsx("option",{value:"bearer",children:"Bearer Token"}),t.jsx("option",{value:"basic",children:"Basic Auth"}),t.jsx("option",{value:"oauth2",children:"OAuth 2.0"})]}),s.authentication.type==="apikey"&&t.jsxs("div",{className:"space-y-3 p-3 bg-zinc-900 rounded border border-zinc-700",children:[t.jsxs("select",{value:s.authentication.config?.apiKey?.location||"header",onChange:E=>y({apiKey:{...s.authentication.config?.apiKey,location:E.target.value,keyName:s.authentication.config?.apiKey?.keyName||"",value:s.authentication.config?.apiKey?.value||""}}),className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500",children:[t.jsx("option",{value:"header",children:"Header"}),t.jsx("option",{value:"query",children:"Query Parameter"})]}),t.jsx("input",{type:"text",value:s.authentication.config?.apiKey?.keyName||"",onChange:E=>y({apiKey:{...s.authentication.config?.apiKey,location:s.authentication.config?.apiKey?.location||"header",keyName:E.target.value,value:s.authentication.config?.apiKey?.value||""}}),placeholder:"Key name (e.g., X-API-Key, apiKey)",className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:h?"text":"password",value:s.authentication.config?.apiKey?.value||"",onChange:E=>y({apiKey:{...s.authentication.config?.apiKey,location:s.authentication.config?.apiKey?.location||"header",keyName:s.authentication.config?.apiKey?.keyName||"",value:E.target.value}}),placeholder:"API Key value",className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500 pr-10 font-mono"}),t.jsx("button",{type:"button",onClick:()=>x(!h),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:h?t.jsx(cc,{size:14}):t.jsx(vi,{size:14})})]})]}),s.authentication.type==="bearer"&&t.jsxs("div",{className:"relative p-3 bg-zinc-900 rounded border border-zinc-700",children:[t.jsx("input",{type:h?"text":"password",value:s.authentication.config?.bearer?.token||"",onChange:E=>y({bearer:{token:E.target.value}}),placeholder:"Bearer token",className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500 pr-10 font-mono"}),t.jsx("button",{type:"button",onClick:()=>x(!h),className:"absolute right-5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:h?t.jsx(cc,{size:14}):t.jsx(vi,{size:14})})]}),s.authentication.type==="basic"&&t.jsxs("div",{className:"space-y-3 p-3 bg-zinc-900 rounded border border-zinc-700",children:[t.jsx("input",{type:"text",value:s.authentication.config?.basic?.username||"",onChange:E=>y({basic:{username:E.target.value,password:s.authentication.config?.basic?.password||""}}),placeholder:"Username",className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:h?"text":"password",value:s.authentication.config?.basic?.password||"",onChange:E=>y({basic:{username:s.authentication.config?.basic?.username||"",password:E.target.value}}),placeholder:"Password",className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500 pr-10"}),t.jsx("button",{type:"button",onClick:()=>x(!h),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:h?t.jsx(cc,{size:14}):t.jsx(vi,{size:14})})]})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"Headers (Optional)"}),t.jsx(Ek,{items:s.headers,onChange:E=>e({...s,headers:E}),placeholder:{key:"Header Name",value:"Header Value"}})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"Query Parameters (Optional)"}),t.jsx(Ek,{items:s.queryParams,onChange:E=>e({...s,queryParams:E}),placeholder:{key:"Parameter Name",value:"Parameter Value"},allowPlaceholders:!0})]}),["POST","PUT","PATCH"].includes(s.method)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"Request Body (JSON)"}),t.jsx("textarea",{value:s.body||"",onChange:E=>e({...s,body:E.target.value}),placeholder:'{"key": "value"}',rows:6,className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 p-3 text-xs font-mono rounded focus:outline-none focus:border-orange-500 resize-none"})]}),t.jsxs("div",{className:"p-3 bg-blue-900/20 border border-blue-700 rounded",children:[t.jsx("div",{className:"text-xs font-bold text-blue-400 mb-1",children:"URL PREVIEW"}),t.jsx("div",{className:"text-xs text-blue-300 font-mono break-all",children:T})]}),b.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"Test Parameters"}),t.jsx("div",{className:"space-y-2",children:b.map(E=>t.jsxs("div",{children:[t.jsxs("label",{className:"text-xs text-gray-400 block mb-1",children:[E," *"]}),t.jsx("input",{type:"text",value:n[E]||"",onChange:j=>i({...n,[E]:j.target.value}),placeholder:`Enter ${E}`,className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500 font-mono"})]},E))})]}),t.jsxs("button",{onClick:C,disabled:o||!s.baseUrl||!s.endpoint,className:`w-full py-3 rounded font-bold text-sm flex items-center justify-center gap-2 transition-all ${o||!s.baseUrl||!s.endpoint?"bg-zinc-800 text-gray-600 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white shadow-lg"}`,children:[t.jsx(Ms,{size:16}),o?"TESTING...":"FETCH SAMPLE DATA"]}),p&&!l&&t.jsxs("div",{className:"bg-green-900/20 border border-green-700 rounded p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t.jsx("h4",{className:"text-xs font-bold text-green-500 uppercase",children:" Sample Data Fetched Successfully"})]}),t.jsx("div",{className:"bg-black/30 rounded p-3 max-h-96 overflow-auto",children:t.jsx("pre",{className:"text-xs text-green-300 font-mono",children:JSON.stringify(p,null,2)})}),t.jsx("div",{className:"mt-3 text-xs text-green-400",children:Array.isArray(p)?`${p.length} records received`:typeof p=="object"&&p.data&&Array.isArray(p.data)?`${p.data.length} records in data array`:"Response received"})]}),l&&t.jsx(jK,{error:l,onRetry:C})]})}function AK({selectedSchema:s,onSelect:e}){const r=["market-data","trading","portfolio","reference","custom"],n=i=>{switch(i){case"market-data":return t.jsx(Nr,{size:16});case"trading":return t.jsx(JB,{size:16});case"portfolio":return t.jsx(KM,{size:16});case"reference":return t.jsx(ri,{size:16});default:return t.jsx(js,{size:16})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 mb-2 uppercase",children:"Select Target Schema"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Choose the standardized format that your source data will be mapped to"})]}),r.map(i=>{const o=m9(i);return o.length===0?null:t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n(i),t.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase",children:i.replace("-"," ")})]}),t.jsx("div",{className:"grid grid-cols-1 gap-3",children:o.map(a=>{const l=Object.keys(oc).find(p=>oc[p]===a),d=s===l;return t.jsxs("button",{onClick:()=>e(l),className:`text-left p-4 rounded-lg border transition-all ${d?"border-orange-500 bg-orange-900/20 shadow-lg":"border-zinc-700 bg-zinc-900 hover:border-zinc-600"}`,children:[t.jsxs("div",{className:"flex items-start justify-between mb-2",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-bold text-white mb-1",children:a.name}),t.jsx("p",{className:"text-xs text-gray-400",children:a.description})]}),d&&t.jsx("span",{className:"text-xs bg-orange-600 text-white px-2 py-1 rounded font-bold",children:"SELECTED"})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t border-zinc-800",children:[t.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[Object.keys(a.fields).length," Fields:"]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[Object.entries(a.fields).slice(0,8).map(([p,f])=>t.jsxs("span",{className:`text-xs px-2 py-1 rounded font-mono ${f.required?"bg-orange-900/30 text-orange-400":"bg-zinc-800 text-gray-400"}`,children:[p,f.required&&"*"]},p)),Object.keys(a.fields).length>8&&t.jsxs("span",{className:"text-xs text-gray-600",children:["+",Object.keys(a.fields).length-8," more"]})]})]})]},l)})})]},i)}),s&&oc[s]&&t.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-orange-700 p-4",children:[t.jsx("h4",{className:"text-xs font-bold text-orange-500 mb-3 uppercase",children:"Schema Details"}),t.jsx("div",{className:"space-y-2",children:Object.entries(oc[s].fields).map(([i,o])=>t.jsxs("div",{className:"flex items-start justify-between p-2 bg-zinc-800 rounded",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs font-bold text-white font-mono",children:i}),o.required&&t.jsx("span",{className:"text-xs text-orange-500 font-bold",children:"*required"})]}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:o.description})]}),t.jsx("span",{className:"text-xs text-gray-500 font-mono ml-4",children:o.type})]},i))})]})]})}function YO({data:s,onFieldSelect:e,onGenerateExpression:r,selectedPath:n}){const[i,o]=S.useState(new Set(["/"])),[a,l]=S.useState(null),d=h=>{const x=new Set(i);i.has(h)?x.delete(h):x.add(h),o(x)},p=h=>{navigator.clipboard.writeText(h),l(h),setTimeout(()=>l(null),2e3)},f=(h,x,m)=>{const b=[...x,m],w=b.join("."),y=i.has(w),C=n&&n.join(".")===w;if(h==null)return t.jsxs("div",{className:`flex items-center gap-2 hover:bg-zinc-800 p-1 rounded cursor-pointer ${C?"bg-orange-900/30":""}`,onClick:()=>e?.(b,h),children:[t.jsxs("span",{className:"text-gray-400",children:[m,":"]}),t.jsx("span",{className:"text-gray-500 italic",children:"null"})]});if(typeof h=="object"){const E=Array.isArray(h),j=E?h.length:Object.keys(h).length;return t.jsxs("div",{children:[t.jsxs("div",{className:`flex items-center gap-2 hover:bg-zinc-800 p-1 rounded cursor-pointer ${C?"bg-orange-900/30":""}`,children:[t.jsx("button",{onClick:()=>d(w),className:"hover:text-orange-500 transition-colors",children:y?t.jsx(bi,{size:14}):t.jsx(Rd,{size:14})}),t.jsx("span",{className:"text-orange-500 font-bold",children:m}),t.jsx("span",{className:"text-gray-500 text-xs",children:E?`Array[${j}]`:`Object{${j}}`}),t.jsxs("div",{className:"ml-auto flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:k=>{k.stopPropagation(),p(w)},className:"p-1 hover:bg-zinc-700 rounded text-gray-400 hover:text-white",title:"Copy path",children:a===w?t.jsx(Es,{size:12,className:"text-green-500"}):t.jsx(hc,{size:12})}),r&&t.jsx("button",{onClick:k=>{k.stopPropagation(),r(b)},className:"p-1 hover:bg-zinc-700 rounded text-purple-400 hover:text-purple-300",title:"Generate expression",children:t.jsx(tC,{size:12})})]})]}),y&&t.jsx("div",{className:"ml-6 border-l border-zinc-700 pl-2 mt-1",children:E?t.jsxs(t.Fragment,{children:[h.slice(0,10).map((k,A)=>t.jsx("div",{className:"group",children:f(k,b,`[${A}]`)},A)),h.length>10&&t.jsxs("div",{className:"text-gray-500 text-xs py-1 px-2",children:["... and ",h.length-10," more items",t.jsx("button",{onClick:()=>{for(let k=10;k<h.length;k++){const A=[...b,`[${k}]`].join(".");o(new Set([...i,A]))}},className:"ml-2 text-orange-500 hover:text-orange-400",children:"[show all]"})]})]}):Object.entries(h).map(([k,A])=>t.jsx("div",{className:"group",children:f(A,b,k)},k))})]})}const T=typeof h=="number"?"text-blue-400":typeof h=="string"?"text-green-400":typeof h=="boolean"?"text-yellow-400":"text-gray-400";return t.jsxs("div",{className:`flex items-center gap-2 hover:bg-zinc-800 p-1 rounded cursor-pointer group ${C?"bg-orange-900/30":""}`,onClick:()=>e?.(b,h),children:[t.jsxs("span",{className:"text-gray-400 flex-shrink-0",children:[m,":"]}),t.jsx("span",{className:`${T} truncate`,children:typeof h=="string"?`"${h}"`:String(h)}),t.jsxs("span",{className:"text-gray-600 text-xs flex-shrink-0",children:["(",typeof h,")"]}),t.jsxs("div",{className:"ml-auto flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0",children:[t.jsx("button",{onClick:E=>{E.stopPropagation(),p(w)},className:"p-1 hover:bg-zinc-700 rounded text-gray-400 hover:text-white",title:"Copy path",children:a===w?t.jsx(Es,{size:12,className:"text-green-500"}):t.jsx(hc,{size:12})}),r&&t.jsx("button",{onClick:E=>{E.stopPropagation(),r(b)},className:"p-1 hover:bg-zinc-700 rounded text-purple-400 hover:text-purple-300",title:"Generate expression",children:t.jsx(tC,{size:12})})]})]})};return s?t.jsxs("div",{className:"bg-zinc-900 rounded-lg overflow-hidden border border-zinc-800",children:[t.jsxs("div",{className:"bg-zinc-800 px-4 py-2 border-b border-zinc-700",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs font-bold text-orange-500",children:"JSON STRUCTURE"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>o(new Set),className:"text-xs text-gray-400 hover:text-white",children:"Collapse All"}),t.jsx("button",{onClick:()=>{const h=(x,m="")=>{const b=[];if(typeof x=="object"&&x!==null)for(const w in x){const y=m?`${m}.${w}`:w;b.push(y)}return b};o(new Set(h(s)))},className:"text-xs text-gray-400 hover:text-white",children:"Expand Level 1"})]})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Click fields to select  Click wand icon to generate expression"})]}),t.jsx("div",{className:"p-4 font-mono text-xs overflow-auto max-h-[600px] scrollbar-thin scrollbar-thumb-zinc-700 scrollbar-track-zinc-900",children:t.jsx("div",{className:"group",children:f(s,[],"root")})})]}):t.jsx("div",{className:"bg-zinc-900 rounded p-4 text-center text-gray-500",children:"No data to display. Fetch sample data to begin."})}function TK({schemaType:s,selectedSchema:e,customFields:r,onSchemaTypeChange:n,onSchemaSelect:i,onCustomFieldsChange:o,sampleData:a,onFieldMappingsAutoCreate:l}){const[d,p]=S.useState(null),[f,h]=S.useState(),x=k=>k==null?"string":Array.isArray(k)?"array":typeof k=="object"?"object":typeof k=="boolean"?"boolean":typeof k=="number"?"number":typeof k=="string"&&!isNaN(Date.parse(k))&&k.match(/^\d{4}-\d{2}-\d{2}/)?"datetime":"string",m=k=>(k[0]==="root"?k.slice(1):k).map(M=>M.replace(/^\[|\]$/g,"").replace(/\[(\d+)\]/,"_$1")).join("_"),b=(k,A,R=!1)=>{let M;return A.length===0?M="$":A.length===1?M=`$.${A[0]}`:M="$."+A.join("."),{targetField:k,source:{type:"path",path:M},parser:"jsonpath",required:R}},w=(k,A)=>{const R=k.join("."),M=m(k),P=x(A),I=r.findIndex(B=>B.description?.includes(R)||B.name===M);if(I>=0){p(I);return}if(P==="object"||P==="array"){alert("Please expand this field and select a specific property inside it.");return}const O={name:M,type:P,description:`Path: ${R}`,required:!1,defaultValue:A??void 0},G=[...r,O];if(o(G),l){const B=b(M,k,O.required);l([B])}p(r.length),h(k)},y=()=>{const k={name:"",type:"string",description:"",required:!1};o([...r,k]),p(r.length)},C=()=>{if(!a)return;const k=[],A=G=>{if(Array.isArray(G))return{data:G,arrayKey:null};const B=["data","results","items","records","response"];for(const F of B)if(G[F]&&Array.isArray(G[F])&&G[F].length>0)return{data:G[F],arrayKey:F};return{data:G,arrayKey:null}},R=(G,B=[])=>{const F=[];if(typeof G!="object"||G===null)return F;if(Array.isArray(G))return G.length>0?R(G[0],B):F;for(const[z,$]of Object.entries(G)){const W=[...B,z],D=x($);if(D!=="object"&&D!=="array"){const oe=z,Z=W.join("_"),fe=W.length===1?oe:Z,Q=W.join("."),_={name:fe,type:D,description:`Path: ${Q}`,required:!1};F.push(_),k.push({field:_,path:W})}else if(D==="object"&&$!==null)F.push(...R($,W));else if(D==="array"&&Array.isArray($)&&$.length>0){const oe=$[0];typeof oe=="object"&&oe!==null&&F.push(...R(oe,W))}}return F},{data:M}=A(a),I=R(M).filter((G,B,F)=>B===F.findIndex(z=>z.name===G.name)),O=I.slice(0,50);if(I.length>50&&alert(`Found ${I.length} fields. Adding first 50 to prevent UI overload. You can add more manually.`),o(O),l){const G=k.filter(({field:B})=>O.some(F=>F.name===B.name)).map(({field:B,path:F})=>b(B.name,F,B.required));l(G)}},T=k=>{o(r.filter((A,R)=>R!==k)),d===k&&p(null)},E=(k,A,R)=>{const M=[...r];M[k]={...M[k],[A]:R},o(M)},j=["string","number","boolean","datetime","array","object"];return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3",children:"Choose Schema Type"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{onClick:()=>n("predefined"),className:`p-4 rounded-lg border transition-all ${s==="predefined"?"border-orange-500 bg-orange-900/20":"border-zinc-700 bg-zinc-900 hover:border-zinc-600"}`,children:[t.jsx(js,{size:24,className:"mx-auto mb-2 text-orange-500"}),t.jsx("div",{className:"text-sm font-bold text-white mb-1",children:"Predefined Schema"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Use built-in schemas (OHLCV, QUOTE, ORDER, etc.)"})]}),t.jsxs("button",{onClick:()=>n("custom"),className:`p-4 rounded-lg border transition-all ${s==="custom"?"border-orange-500 bg-orange-900/20":"border-zinc-700 bg-zinc-900 hover:border-zinc-600"}`,children:[t.jsx(Od,{size:24,className:"mx-auto mb-2 text-purple-500"}),t.jsx("div",{className:"text-sm font-bold text-white mb-1",children:"Custom Schema"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Define your own fields for any data type"})]})]})]}),s==="predefined"&&t.jsx("div",{children:t.jsx(AK,{selectedSchema:e,onSelect:i})}),s==="custom"&&t.jsxs("div",{children:[a?t.jsx("div",{className:"mb-4 p-4 bg-blue-900/20 border border-blue-700 rounded-lg",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(_d,{size:20,className:"text-blue-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-sm font-bold text-blue-400 mb-2",children:" Smart Field Extraction"}),t.jsxs("div",{className:"text-xs text-blue-300 space-y-1",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"1. Auto-Add All:"}),' Click the green "AUTO-ADD ALL" button to add all fields from your data array automatically']}),t.jsxs("p",{children:[t.jsx("strong",{children:"2. Manual Select:"})," Expand the tree (left), click any ",t.jsx("strong",{children:"leaf field"})," (not objects/arrays) to add it"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"3. Unique Names:"})," Nested fields get full path names (e.g., ",t.jsx("code",{className:"bg-blue-900/40 px-1 rounded",children:"country_name"}),")"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"4. Smart Detection:"}),' Automatically finds your data array (looks for "data", "results", "items")']})]})]})]})}):t.jsx("div",{className:"mb-4 p-4 bg-yellow-900/20 border border-yellow-700 rounded-lg",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Rr,{size:20,className:"text-yellow-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-bold text-yellow-400 mb-1",children:"No Sample Data Available"}),t.jsx("p",{className:"text-xs text-yellow-300",children:'Go back to Step 1 and click "Fetch Sample Data" to see your API response here. This will make it much easier to create your schema!'})]})]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"text-xs font-bold text-green-500 uppercase",children:"API Response"}),a&&t.jsxs("button",{onClick:C,className:"bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded text-xs font-bold flex items-center gap-1",title:"Auto-add all primitive fields",children:[t.jsx(_d,{size:12}),"AUTO-ADD ALL"]})]}),a?t.jsx(YO,{data:a,onFieldSelect:w,selectedPath:f}):t.jsxs("div",{className:"bg-zinc-900 rounded border border-zinc-700 p-8 text-center",children:[t.jsx(Rr,{size:32,className:"mx-auto mb-2 text-gray-600"}),t.jsx("p",{className:"text-sm text-gray-400",children:"No sample data"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Fetch sample data in Step 1 to see it here"})]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h3",{className:"text-xs font-bold text-orange-500 uppercase",children:["Schema Fields (",r.length,")"]}),t.jsxs("button",{onClick:y,className:"bg-orange-600 hover:bg-orange-700 text-white px-2 py-1 rounded text-xs font-bold flex items-center gap-1",children:[t.jsx(wn,{size:12}),"ADD MANUALLY"]})]}),t.jsx("div",{className:"bg-zinc-900 rounded border border-zinc-700 p-3 max-h-[600px] overflow-y-auto",children:r.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(Od,{size:32,className:"mx-auto mb-2 text-gray-600"}),t.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"No fields yet"}),t.jsx("p",{className:"text-xs text-gray-500",children:a?"Click fields in the API response to add them":"Add fields manually or fetch sample data first"})]}):t.jsx("div",{className:"space-y-2",children:r.map((k,A)=>t.jsxs("div",{className:`bg-zinc-800 border rounded p-2 transition-all ${d===A?"border-orange-500 shadow-lg shadow-orange-900/20":"border-zinc-700"}`,children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Field Name *"}),t.jsx("input",{type:"text",value:k.name,onChange:R=>E(A,"name",R.target.value),onFocus:()=>p(A),placeholder:"field_name",className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-2 py-1 text-xs rounded focus:outline-none focus:border-orange-500 font-mono"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Type"}),t.jsx("select",{value:k.type,onChange:R=>E(A,"type",R.target.value),className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-2 py-1 text-xs rounded focus:outline-none focus:border-orange-500",children:j.map(R=>t.jsx("option",{value:R,children:R},R))})]})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Description"}),t.jsx("input",{type:"text",value:k.description,onChange:R=>E(A,"description",R.target.value),placeholder:"Field description",className:"w-full bg-zinc-900 border border-zinc-700 text-gray-300 px-2 py-1 text-xs rounded focus:outline-none focus:border-orange-500"})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("label",{className:"flex items-center gap-2 text-xs text-gray-300 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:k.required,onChange:R=>E(A,"required",R.target.checked),className:"rounded border-zinc-700 bg-zinc-800 text-orange-600 focus:ring-orange-500"}),"Required"]}),t.jsx("button",{onClick:()=>T(A),className:"text-red-500 hover:text-red-400 p-1 hover:bg-zinc-900 rounded transition-colors",title:"Remove field",children:t.jsx(On,{size:14})})]})]},A))})})]})]}),r.length>0&&t.jsxs("div",{className:"mt-3 text-xs text-green-500 bg-green-900/20 border border-green-700 rounded p-3",children:[t.jsxs("strong",{children:[" ",r.length," field",r.length!==1?"s":""," added!"]})," ","Field mappings have been created automatically. You can review them in Step 3 (Field Mapping)."]})]})]})}function RK({schemaType:s,selectedSchema:e,customFields:r,sampleData:n,mappings:i,onMappingsChange:o}){const[a,l]=S.useState(null),[d,p]=S.useState(null),[f,h]=S.useState("jsonpath"),[x,m]=S.useState(null),[b,w]=S.useState(null),[y,C]=S.useState(new Set),T=s==="predefined"&&e?Object.entries(oc[e].fields).map(([B,F])=>({name:B,type:F.type,description:F.description,required:F.required,defaultValue:F.defaultValue,validation:F.validation})):r;S.useEffect(()=>{const B=T.map(F=>F.name);C(new Set(B))},[T]);const E=(B,F)=>{l(B)},j=B=>{if(d===B)p(null);else if(p(B),a){const F="$"+a.map(z=>`['${z}']`).join("");k(B,F,f),l(null)}},k=(B,F,z)=>{const $=i.findIndex(D=>D.targetField===B),W={targetField:B,source:{type:"path",path:F},parser:z,transform:[]};if($>=0){const D=[...i];D[$]=W,o(D)}else o([...i,W])},A=B=>{o(i.filter(F=>F.targetField!==B))},R=(B,F,z)=>{const $=i.findIndex(D=>D.targetField===B),W={targetField:B,source:{type:"path",path:F},parser:z,transform:[]};if($>=0){const D=[...i];D[$]=W,o(D)}else o([...i,W])},M=async B=>{const F=i.find(z=>z.targetField===B);if(!(!F||!F.source.path))try{let z;if(F.parser==="jsonpath"){const W=(await Br(()=>import("./index-browser-esm-DHOVu2Y5.js"),[])).JSONPath({path:F.source.path,json:n});z=Array.isArray(W)&&W.length>0?W[0]:null}else F.parser==="jmespath"?z=(await Br(()=>Promise.resolve().then(()=>$q),void 0)).search(n,F.source.path):F.parser==="direct"?z=F.source.path.split(".").reduce((W,D)=>W?.[D],n):F.parser==="javascript"&&(z=new Function("data",`return ${F.source.path}`)(n));m(B),w(z)}catch(z){m(B),w({error:z instanceof Error?z.message:String(z)})}},P=B=>{const F=i.find($=>$.targetField===B),z=T.find($=>$.name===B);return F?{status:"mapped",color:"text-green-500",icon:Bn}:z?.required?{status:"required",color:"text-red-500",icon:Rr}:{status:"optional",color:"text-gray-500",icon:Rr}},I=B=>{const F=new Set(y);F.has(B)?F.delete(B):F.add(B),C(F)},O=B=>{navigator.clipboard.writeText(B)},G=[{value:"jsonpath",label:"JSONPath",description:"$.data.price"},{value:"jmespath",label:"JMESPath",description:"data.price"},{value:"direct",label:"Direct",description:"data.price"},{value:"javascript",label:"JavaScript",description:"data.price * 2"}];return t.jsxs("div",{className:"grid grid-cols-2 gap-4 h-full",children:[t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-2",children:"Source Data (Sample Response)"}),t.jsx("p",{className:"text-xs text-gray-400",children:"Click on any path to select it for mapping"})]}),t.jsx("div",{className:"flex-1 bg-zinc-900 border border-zinc-700 rounded p-3 overflow-auto",children:t.jsx(YO,{data:n,onFieldSelect:E,selectedPath:a||void 0})}),a&&t.jsxs("div",{className:"mt-3 p-3 bg-blue-900/20 border border-blue-700 rounded",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-xs font-bold text-blue-400",children:"SELECTED PATH"}),t.jsx("button",{onClick:()=>O("$"+a.map(B=>`['${B}']`).join("")),className:"text-blue-400 hover:text-blue-300 p-1",title:"Copy path",children:t.jsx(hc,{size:12})})]}),t.jsx("div",{className:"text-xs text-blue-300 font-mono break-all",children:"$"+a.map(B=>`['${B}']`).join("")}),t.jsxs("div",{className:"mt-2",children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Parser Engine"}),t.jsx("select",{value:f,onChange:B=>h(B.target.value),className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-2 py-1 text-xs rounded focus:outline-none focus:border-orange-500",children:G.map(B=>t.jsxs("option",{value:B.value,children:[B.label," - ",B.description]},B.value))})]}),t.jsx("div",{className:"mt-2 text-xs text-gray-400",children:"Click a target field to create mapping "})]})]}),t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-2",children:"Target Schema Fields"}),t.jsx("p",{className:"text-xs text-gray-400",children:s==="predefined"?`${e?.toUpperCase()} Schema`:"Custom Schema"})]}),t.jsx("div",{className:"flex-1 bg-zinc-900 border border-zinc-700 rounded p-3 overflow-auto",children:T.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(Rr,{size:32,className:"mx-auto mb-2"}),t.jsx("p",{className:"text-sm",children:"No fields defined"})]}):t.jsx("div",{className:"space-y-2",children:T.map(B=>{const F=i.find(D=>D.targetField===B.name),z=P(B.name),$=y.has(B.name),W=z.icon;return t.jsxs("div",{className:`border rounded transition-all ${d===B.name?"border-orange-500 bg-orange-900/20":F?"border-green-700 bg-green-900/10":"border-zinc-700 bg-zinc-800"}`,children:[t.jsxs("div",{className:"flex items-center justify-between p-2 cursor-pointer hover:bg-zinc-700/50",onClick:()=>j(B.name),children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[t.jsx("button",{onClick:D=>{D.stopPropagation(),I(B.name)},className:"text-gray-400 hover:text-white",children:$?t.jsx(bi,{size:14}):t.jsx(Rd,{size:14})}),t.jsx(W,{size:14,className:z.color}),t.jsxs("div",{children:[t.jsxs("div",{className:"text-xs font-bold text-white font-mono",children:[B.name,B.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),t.jsx("div",{className:"text-xs text-gray-400",children:B.type})]})]}),F&&t.jsx("button",{onClick:D=>{D.stopPropagation(),M(B.name)},className:"text-blue-400 hover:text-blue-300 p-1 mr-2",title:"Preview value",children:t.jsx(Ms,{size:12})})]}),$&&t.jsxs("div",{className:"border-t border-zinc-700 p-2 space-y-2",children:[B.description&&t.jsx("div",{className:"text-xs text-gray-400",children:B.description}),F?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded p-2",children:[t.jsx("div",{className:"text-xs font-bold text-green-500 mb-1",children:"MAPPED"}),t.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["Parser: ",F.parser]}),t.jsx("div",{className:"text-xs text-gray-300 font-mono break-all",children:F.source.path})]}),x===B.name&&t.jsxs("div",{className:"bg-blue-900/20 border border-blue-700 rounded p-2",children:[t.jsx("div",{className:"text-xs font-bold text-blue-400 mb-1",children:"PREVIEW VALUE"}),t.jsx("pre",{className:"text-xs text-blue-300 font-mono whitespace-pre-wrap overflow-auto max-h-24",children:JSON.stringify(b,null,2)})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:F.source.path,onChange:D=>R(B.name,D.target.value,F.parser),placeholder:"Expression",className:"flex-1 bg-zinc-900 border border-zinc-700 text-gray-300 px-2 py-1 text-xs rounded focus:outline-none focus:border-orange-500 font-mono"}),t.jsx("button",{onClick:()=>A(B.name),className:"bg-red-900/30 hover:bg-red-900/50 text-red-400 px-2 py-1 rounded text-xs",children:"Remove"})]})]}):t.jsx(t.Fragment,{children:t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:"Or enter expression manually:"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("select",{value:f,onChange:D=>h(D.target.value),className:"bg-zinc-900 border border-zinc-700 text-gray-300 px-2 py-1 text-xs rounded focus:outline-none focus:border-orange-500",children:G.map(D=>t.jsx("option",{value:D.value,children:D.label},D.value))}),t.jsx("input",{type:"text",placeholder:G.find(D=>D.value===f)?.description,onKeyDown:D=>{D.key==="Enter"&&D.currentTarget.value.trim()&&(R(B.name,D.currentTarget.value.trim(),f),D.currentTarget.value="")},className:"flex-1 bg-zinc-900 border border-zinc-700 text-gray-300 px-2 py-1 text-xs rounded focus:outline-none focus:border-orange-500 font-mono"})]}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Press Enter to create mapping"})]})})]})]},B.name)})})}),t.jsxs("div",{className:"mt-3 p-3 bg-zinc-900 border border-zinc-700 rounded",children:[t.jsx("div",{className:"text-xs font-bold text-orange-500 uppercase mb-2",children:"Mapping Status"}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Mapped:"})," ",t.jsx("span",{className:"text-green-500 font-bold",children:i.length})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Required:"})," ",t.jsx("span",{className:"text-yellow-500 font-bold",children:T.filter(B=>B.required).length})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Total:"})," ",t.jsx("span",{className:"text-white font-bold",children:T.length})]})]})]})]})]})}function NK({cacheEnabled:s,cacheTTL:e,onCacheEnabledChange:r,onCacheTTLChange:n,mappingId:i}){const[o,a]=S.useState(!0),[l,d]=S.useState(!1);S.useEffect(()=>{p()},[]);const p=async()=>{const m=await fi.isEncryptionEnabled();a(m)},f=async m=>{try{await fi.setEncryptionEnabled(m),a(m),alert(m?"Encryption enabled. New mappings will encrypt credentials.":"Encryption disabled. Credentials will be stored in plain text.")}catch(b){console.error("Failed to toggle encryption:",b),alert("Failed to update encryption setting")}},h=async()=>{if(confirm("Clear cache for this mapping? This cannot be undone.")){d(!0);try{await Ea.clearCache(i),alert("Cache cleared successfully")}catch(m){console.error("Failed to clear cache:",m),alert("Failed to clear cache")}finally{d(!1)}}},x=async()=>{if(confirm("Clear ALL cached responses for all mappings? This cannot be undone.")){d(!0);try{await Ea.clearCache(),alert("All cache cleared successfully")}catch(m){console.error("Failed to clear all cache:",m),alert("Failed to clear all cache")}finally{d(!1)}}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3 flex items-center gap-2",children:[t.jsx(uo,{size:14}),"Response Caching"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-900 rounded border border-zinc-700",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-bold text-white",children:"Enable Caching"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Cache API responses to reduce requests"})]}),t.jsxs("label",{className:"relative inline-block w-12 h-6",children:[t.jsx("input",{type:"checkbox",checked:s,onChange:m=>r(m.target.checked),className:"sr-only peer"}),t.jsx("div",{className:"w-full h-full bg-zinc-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-6 peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-600"})]})]}),s&&t.jsxs("div",{className:"p-3 bg-zinc-900 rounded border border-zinc-700",children:[t.jsx("label",{className:"text-sm font-bold text-white block mb-2",children:"Cache Duration (seconds)"}),t.jsx("input",{type:"number",value:e,onChange:m=>n(Number(m.target.value)),min:"0",step:"60",className:"w-full bg-zinc-800 border border-zinc-700 text-gray-300 px-3 py-2 text-sm rounded focus:outline-none focus:border-orange-500"}),t.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Common values: 60 (1 min), 300 (5 min), 3600 (1 hour)"})]}),t.jsxs("div",{className:"flex gap-2",children:[i&&t.jsxs("button",{onClick:h,disabled:l,className:"flex-1 bg-zinc-800 hover:bg-zinc-700 disabled:bg-zinc-900 text-gray-300 py-2 px-3 rounded text-xs font-bold flex items-center justify-center gap-2 transition-colors",children:[t.jsx(On,{size:12}),l?"Clearing...":"Clear This Cache"]}),t.jsxs("button",{onClick:x,disabled:l,className:"flex-1 bg-red-900/30 hover:bg-red-900/50 disabled:bg-zinc-900 text-red-400 hover:text-red-300 py-2 px-3 rounded text-xs font-bold flex items-center justify-center gap-2 border border-red-700 transition-colors",children:[t.jsx(js,{size:12}),l?"Clearing...":"Clear All Cache"]})]})]})]}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-3 flex items-center gap-2",children:[t.jsx(jo,{size:14}),"Security"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-900 rounded border border-zinc-700",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-bold text-white",children:"Encrypt API Credentials"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Store API keys and tokens encrypted in local database"})]}),t.jsxs("label",{className:"relative inline-block w-12 h-6",children:[t.jsx("input",{type:"checkbox",checked:o,onChange:m=>f(m.target.checked),className:"sr-only peer"}),t.jsx("div",{className:"w-full h-full bg-zinc-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-6 peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})]})]}),t.jsx("div",{className:"p-3 bg-blue-900/20 border border-blue-700 rounded",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(jo,{size:14,className:"text-blue-400 mt-0.5"}),t.jsx("div",{className:"text-xs text-blue-300",children:o?t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Encryption is enabled."})," Your API keys and tokens are encrypted using AES-256-GCM before being stored. You can toggle this setting anytime."]}):t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:"Encryption is disabled."})," Your API keys and tokens will be stored in plain text. This is less secure but may be useful for debugging."]})})]})})]})]})]})}function OK({result:s,isLoading:e}){return e?t.jsx("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 p-8 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Transforming data..."})]})}):s?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:`rounded-lg border p-3 ${s.success?"bg-green-900/20 border-green-700":"bg-red-900/20 border-red-700"}`,children:[t.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.success?t.jsxs(t.Fragment,{children:[t.jsx(Bn,{size:16,className:"text-green-500"}),t.jsx("span",{className:"text-xs font-bold text-green-500",children:"TRANSFORMATION SUCCESSFUL"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Rr,{size:16,className:"text-red-500"}),t.jsx("span",{className:"text-xs font-bold text-red-500",children:"TRANSFORMATION FAILED"})]})}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Duration"}),t.jsxs("div",{className:"text-white font-bold",children:[s.metadata.duration,"ms"]})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Records Processed"}),t.jsx("div",{className:"text-white font-bold",children:s.metadata.recordsProcessed})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500",children:"Records Returned"}),t.jsx("div",{className:"text-white font-bold",children:s.metadata.recordsReturned})]})]})]}),s.rawData&&t.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 overflow-hidden",children:[t.jsx("div",{className:"bg-zinc-800 px-3 py-2 border-b border-zinc-700",children:t.jsx("span",{className:"text-xs font-bold text-gray-400",children:"RAW INPUT DATA"})}),t.jsx("div",{className:"p-3 max-h-64 overflow-auto",children:t.jsx("pre",{className:"text-xs text-gray-400 font-mono",children:JSON.stringify(s.rawData,null,2)})})]}),s.success&&s.data&&t.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-green-700 overflow-hidden",children:[t.jsx("div",{className:"bg-green-900/20 px-3 py-2 border-b border-green-700",children:t.jsx("span",{className:"text-xs font-bold text-green-500",children:"TRANSFORMED OUTPUT"})}),t.jsx("div",{className:"p-3 max-h-96 overflow-auto",children:t.jsx("pre",{className:"text-xs text-green-400 font-mono",children:JSON.stringify(s.data,null,2)})})]}),s.errors&&s.errors.length>0&&t.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-red-700 overflow-hidden",children:[t.jsx("div",{className:"bg-red-900/20 px-3 py-2 border-b border-red-700",children:t.jsx("span",{className:"text-xs font-bold text-red-500",children:"ERRORS"})}),t.jsx("div",{className:"p-3",children:s.errors.map((r,n)=>t.jsxs("div",{className:"text-xs text-red-400 mb-2 font-mono",children:[" ",r]},n))})]}),s.warnings&&s.warnings.length>0&&t.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-yellow-700 overflow-hidden",children:[t.jsx("div",{className:"bg-yellow-900/20 px-3 py-2 border-b border-yellow-700",children:t.jsx("span",{className:"text-xs font-bold text-yellow-500",children:"WARNINGS"})}),t.jsx("div",{className:"p-3",children:s.warnings.map((r,n)=>t.jsxs("div",{className:"text-xs text-yellow-400 mb-2 font-mono",children:[" ",r]},n))})]}),s.metadata.validationResults&&t.jsxs("div",{className:`bg-zinc-900 rounded-lg border overflow-hidden ${s.metadata.validationResults.valid?"border-green-700":"border-yellow-700"}`,children:[t.jsx("div",{className:`px-3 py-2 border-b ${s.metadata.validationResults.valid?"bg-green-900/20 border-green-700":"bg-yellow-900/20 border-yellow-700"}`,children:t.jsxs("span",{className:`text-xs font-bold ${s.metadata.validationResults.valid?"text-green-500":"text-yellow-500"}`,children:["VALIDATION ",s.metadata.validationResults.valid?"PASSED":"WARNINGS"]})}),!s.metadata.validationResults.valid&&t.jsx("div",{className:"p-3",children:s.metadata.validationResults.errors.map((r,n)=>t.jsxs("div",{className:"text-xs text-yellow-400 mb-2",children:[t.jsxs("span",{className:"font-bold",children:[r.field,":"]})," ",r.message]},n))})]})]}):t.jsx("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 p-8 flex items-center justify-center",children:t.jsxs("div",{className:"text-center text-gray-500",children:[t.jsx(dg,{size:48,className:"mx-auto mb-4 opacity-30"}),t.jsx("p",{className:"text-sm",children:"Configure mapping and test to see preview"})]})})}function ld(s){const e={0:"jsonpath",1:"jmespath",2:"direct",3:"javascript",4:"jsonata"};return{targetField:s.targetField,source:{type:"path",path:s.sourceExpression},parser:e[s.parserEngine]||"direct",transform:s.transform?[s.transform]:void 0,transformParams:s.transformParams,defaultValue:s.defaultValue,required:s.required,confidence:s.confidence}}const _K=[{id:"upstox_historical_ohlcv",name:"Upstox Historical Candles  OHLCV",description:"Map Upstox historical candle data to standard OHLCV format",category:"broker",tags:["upstox","historical","candles","ohlcv","india"],verified:!0,official:!0,mappingConfig:{name:"Upstox Historical  OHLCV",description:"Transform Upstox historical candle data",target:{schemaType:"predefined",schema:"OHLCV"},extraction:{engine:At.JSONATA,rootPath:"data.candles",isArray:!0,isArrayOfArrays:!0},fieldMappings:[{targetField:"symbol",sourceExpression:"symbol",required:!0,parserEngine:At.DIRECT,defaultValue:"UNKNOWN"},{targetField:"timestamp",sourceExpression:"$[0]",required:!0,parserEngine:At.JSONATA,transform:"toISODate"},{targetField:"open",sourceExpression:"$[1]",required:!0,parserEngine:At.JSONATA},{targetField:"high",sourceExpression:"$[2]",required:!0,parserEngine:At.JSONATA},{targetField:"low",sourceExpression:"$[3]",required:!0,parserEngine:At.JSONATA},{targetField:"close",sourceExpression:"$[4]",required:!0,parserEngine:At.JSONATA},{targetField:"volume",sourceExpression:"$[5]",required:!0,parserEngine:At.JSONATA}].map(ld),validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["upstox","ohlcv"],aiGenerated:!1}},instructions:`
1. Configure Upstox connection in Data Sources
2. Use endpoint: /historical-candle/{instrument_key}/{interval}/{to_date}/{from_date}
3. Parameters: instrument_key (e.g., NSE_EQ|INE062A01020), interval (1minute, day, etc.)
4. Sample response format: { "status": "success", "data": { "candles": [[timestamp, o, h, l, c, v, oi]] } }
    `},{id:"upstox_market_quote_full",name:"Upstox Market Quote  QUOTE",description:"Map Upstox market quote data to standard QUOTE format",category:"broker",tags:["upstox","quote","realtime","india"],verified:!0,official:!0,mappingConfig:{name:"Upstox Quote  QUOTE",description:"Transform Upstox market quote data",target:{schemaType:"predefined",schema:"QUOTE"},extraction:{engine:At.JSONATA,rootPath:"data",isArray:!1},fieldMappings:[{targetField:"symbol",sourceExpression:"symbol",required:!0,parserEngine:At.JSONATA},{targetField:"timestamp",sourceExpression:"last_trade_time",required:!0,parserEngine:At.JSONATA,transform:"toISODate"},{targetField:"price",sourceExpression:"last_price",required:!0,parserEngine:At.JSONATA},{targetField:"bid",sourceExpression:"depth.buy[0].price",required:!1,parserEngine:At.JSONATA},{targetField:"ask",sourceExpression:"depth.sell[0].price",required:!1,parserEngine:At.JSONATA},{targetField:"bidSize",sourceExpression:"depth.buy[0].quantity",required:!1,parserEngine:At.JSONATA},{targetField:"askSize",sourceExpression:"depth.sell[0].quantity",required:!1,parserEngine:At.JSONATA},{targetField:"volume",sourceExpression:"volume",required:!1,parserEngine:At.JSONATA},{targetField:"open",sourceExpression:"ohlc.open",required:!1,parserEngine:At.JSONATA},{targetField:"high",sourceExpression:"ohlc.high",required:!1,parserEngine:At.JSONATA},{targetField:"low",sourceExpression:"ohlc.low",required:!1,parserEngine:At.JSONATA},{targetField:"previousClose",sourceExpression:"ohlc.close",required:!1,parserEngine:At.JSONATA},{targetField:"change",sourceExpression:"net_change",required:!1,parserEngine:At.JSONATA}].map(ld),validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["upstox","quote"],aiGenerated:!1}}},{id:"fyers_quotes",name:"Fyers Quotes  QUOTE",description:"Map Fyers quote data to standard QUOTE format",category:"broker",tags:["fyers","quote","realtime","india"],verified:!0,official:!0,mappingConfig:{name:"Fyers Quote  QUOTE",description:"Transform Fyers quote data",target:{schemaType:"predefined",schema:"QUOTE"},extraction:{engine:At.JSONATA,rootPath:"d",isArray:!0},fieldMappings:[{targetField:"symbol",sourceExpression:"n",required:!0,parserEngine:At.JSONATA},{targetField:"timestamp",sourceExpression:"v.tt",required:!0,parserEngine:At.JSONATA,transform:"toISODate"},{targetField:"price",sourceExpression:"v.lp",required:!0,parserEngine:At.JSONATA},{targetField:"bid",sourceExpression:"v.bid",required:!1,parserEngine:At.JSONATA},{targetField:"ask",sourceExpression:"v.ask",required:!1,parserEngine:At.JSONATA},{targetField:"volume",sourceExpression:"v.volume",required:!1,parserEngine:At.JSONATA},{targetField:"open",sourceExpression:"v.open_price",required:!1,parserEngine:At.JSONATA},{targetField:"high",sourceExpression:"v.high_price",required:!1,parserEngine:At.JSONATA},{targetField:"low",sourceExpression:"v.low_price",required:!1,parserEngine:At.JSONATA},{targetField:"previousClose",sourceExpression:"v.prev_close_price",required:!1,parserEngine:At.JSONATA},{targetField:"change",sourceExpression:"v.ch",required:!1,parserEngine:At.JSONATA},{targetField:"changePercent",sourceExpression:"v.chp",required:!1,parserEngine:At.JSONATA}].map(ld),validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["fyers","quote"],aiGenerated:!1}},instructions:`
1. Configure Fyers connection in Data Sources
2. Use endpoint: /data/quotes
3. Method: POST with symbols array in body
4. Sample response: { "s": "ok", "d": [{ "n": "NSE:SBIN-EQ", "v": {...} }] }
    `},{id:"fyers_positions",name:"Fyers Positions  POSITION",description:"Map Fyers position data to standard POSITION format",category:"broker",tags:["fyers","position","portfolio","india"],verified:!0,official:!0,mappingConfig:{name:"Fyers Position  POSITION",description:"Transform Fyers position data",target:{schemaType:"predefined",schema:"POSITION"},extraction:{engine:At.JSONATA,rootPath:"netPositions",isArray:!0},fieldMappings:[{targetField:"symbol",sourceExpression:"symbol",required:!0,parserEngine:At.JSONATA},{targetField:"quantity",sourceExpression:"netQty",required:!0,parserEngine:At.JSONATA},{targetField:"averagePrice",sourceExpression:"avgPrice",required:!0,parserEngine:At.JSONATA},{targetField:"currentPrice",sourceExpression:"ltp",required:!0,parserEngine:At.JSONATA},{targetField:"pnl",sourceExpression:"pl",required:!0,parserEngine:At.JSONATA},{targetField:"pnlPercent",sourceExpression:"plPercent",required:!0,parserEngine:At.JSONATA},{targetField:"productType",sourceExpression:"productType",required:!1,parserEngine:At.JSONATA}].map(ld),validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["fyers","position"],aiGenerated:!1}}},{id:"dhan_positions",name:"Dhan Positions  POSITION",description:"Map Dhan position data to standard POSITION format",category:"broker",tags:["dhan","position","portfolio","india"],verified:!0,official:!0,mappingConfig:{name:"Dhan Position  POSITION",description:"Transform Dhan position data",target:{schemaType:"predefined",schema:"POSITION"},extraction:{engine:At.JSONPATH,rootPath:"$.data[*]",isArray:!0},fieldMappings:[{targetField:"symbol",sourceExpression:"tradingSymbol",required:!0,parserEngine:At.JSONPATH},{targetField:"quantity",sourceExpression:"netQty",required:!0,parserEngine:At.JSONPATH},{targetField:"averagePrice",sourceExpression:"costPrice",required:!0,parserEngine:At.JSONPATH},{targetField:"currentPrice",sourceExpression:"ltp",required:!0,parserEngine:At.JSONPATH},{targetField:"pnl",sourceExpression:"realizedProfit",required:!0,parserEngine:At.JSONPATH},{targetField:"exchange",sourceExpression:"exchangeSegment",required:!1,parserEngine:At.JSONPATH}].map(ld),validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["dhan","position"],aiGenerated:!1}}},{id:"dhan_orders",name:"Dhan Orders  ORDER",description:"Map Dhan order data to standard ORDER format",category:"broker",tags:["dhan","order","trading","india"],verified:!0,official:!0,mappingConfig:{name:"Dhan Order  ORDER",description:"Transform Dhan order data",target:{schemaType:"predefined",schema:"ORDER"},extraction:{engine:At.JSONPATH,rootPath:"$.data[*]",isArray:!0},fieldMappings:[{targetField:"orderId",sourceExpression:"orderId",required:!0,parserEngine:At.JSONPATH},{targetField:"symbol",sourceExpression:"tradingSymbol",required:!0,parserEngine:At.JSONPATH},{targetField:"side",sourceExpression:"transactionType",required:!0,parserEngine:At.JSONPATH,transform:"uppercase"},{targetField:"type",sourceExpression:"orderType",required:!0,parserEngine:At.JSONPATH,transform:"uppercase"},{targetField:"quantity",sourceExpression:"quantity",required:!0,parserEngine:At.JSONPATH},{targetField:"filledQuantity",sourceExpression:"tradedQuantity",required:!1,parserEngine:At.JSONPATH},{targetField:"price",sourceExpression:"price",required:!1,parserEngine:At.JSONPATH},{targetField:"averagePrice",sourceExpression:"tradedPrice",required:!1,parserEngine:At.JSONPATH},{targetField:"status",sourceExpression:"orderStatus",required:!0,parserEngine:At.JSONPATH,transform:"uppercase"},{targetField:"timestamp",sourceExpression:"createTime",required:!0,parserEngine:At.JSONPATH,transform:"toISODate"},{targetField:"exchange",sourceExpression:"exchangeSegment",required:!1,parserEngine:At.JSONPATH}].map(ld),validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["dhan","order"],aiGenerated:!1}}},{id:"zerodha_ohlc",name:"Zerodha OHLC  OHLCV",description:"Map Zerodha/Kite OHLC data to standard OHLCV format",category:"broker",tags:["zerodha","kite","ohlc","india"],verified:!0,official:!0,mappingConfig:{name:"Zerodha OHLC  OHLCV",description:"Transform Zerodha OHLC data",target:{schemaType:"predefined",schema:"OHLCV"},extraction:{engine:At.CUSTOM_JS,rootPath:"data",isArray:!1},fieldMappings:[{targetField:"all",source:{type:"expression",path:`
            return Object.entries(data).map(([symbol, ohlc]) => ({
              symbol: symbol,
              timestamp: new Date().toISOString(),
              open: ohlc.open,
              high: ohlc.high,
              low: ohlc.low,
              close: ohlc.close || ohlc.last_price,
              volume: ohlc.volume || 0
            }))
          `},parser:"javascript",required:!0}],validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["zerodha","ohlc"],aiGenerated:!1}},instructions:`
1. Configure Zerodha/Kite connection
2. Use endpoint: /quote/ohlc
3. Query params: i=NSE:SBIN&i=NSE:RELIANCE
4. Response: { "data": { "NSE:SBIN": { "open": 590, ... } } }
    `},{id:"shipnext_ports",name:"ShipNext Ports API",description:"Fetch global port data from ShipNext API",category:"custom",tags:["shipnext","ports","maritime","shipping","logistics"],verified:!0,official:!1,mappingConfig:{name:"ShipNext Ports",description:"Fetch global port information from ShipNext",source:{type:"api",apiConfig:{id:"shipnext_ports_api",name:"ShipNext Ports API",description:"Global maritime port data from ShipNext",baseUrl:"https://shipnext.com",endpoint:"/api/v1/ports/",method:"GET",headers:{Accept:"*/*","Content-Type":"application/json","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"},queryParams:{page:"1",query:"",country:""},authentication:{type:"none",config:{}},timeout:3e4,cacheEnabled:!0,cacheTTL:3600}},target:{schemaType:"custom",schema:"PORT",customFields:[{name:"id",type:"string",description:"Unique port identifier",required:!1},{name:"name",type:"string",description:"Port name",required:!1},{name:"country",type:"string",description:"Country code",required:!1},{name:"code",type:"string",description:"Port code (e.g., LOCODE)",required:!1},{name:"latitude",type:"number",description:"Geographic latitude",required:!1},{name:"longitude",type:"number",description:"Geographic longitude",required:!1},{name:"type",type:"string",description:"Port type",required:!1}]},extraction:{engine:At.JSONPATH,rootPath:"$.data[*]",isArray:!0},fieldMappings:[{targetField:"id",source:{type:"path",path:"$._id"},parser:"jsonpath",required:!1,defaultValue:""},{targetField:"name",source:{type:"path",path:"$.name"},parser:"jsonpath",required:!1,defaultValue:""},{targetField:"country",source:{type:"path",path:"$.country.name"},parser:"jsonpath",required:!1,defaultValue:""},{targetField:"code",source:{type:"path",path:"$.unLoCode"},parser:"jsonpath",required:!1,defaultValue:""},{targetField:"latitude",source:{type:"path",path:"$.coordinates[1]"},parser:"jsonpath",required:!1,defaultValue:0},{targetField:"longitude",source:{type:"path",path:"$.coordinates[0]"},parser:"jsonpath",required:!1,defaultValue:0},{targetField:"type",source:{type:"path",path:"$.sefName"},parser:"jsonpath",required:!1,defaultValue:""}],validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:["shipnext","ports","maritime"],aiGenerated:!1}},instructions:`
1. Open Data Mapping tab
2. Load this template from the template library
3. Optional: Modify query parameters:
   - page: Change pagination (default: 1)
   - query: Add search term for port name
   - country: Filter by country code (e.g., 'IN', 'US', 'CN')
4. Click "Test & Fetch Sample" to verify API response
5. Field mappings are pre-configured for common port data
6. Data is cached for 1 hour to reduce API calls
7. Save the mapping to use it in your workflows

Note: This API does not require authentication. If you encounter CORS issues,
you may need to configure your Tauri app permissions or use a proxy.
    `}];function DK({onSelectTemplate:s}){const[e,r]=S.useState(null),[n,i]=S.useState(""),[o,a]=S.useState("all"),l=[..._K],d=l.filter(x=>{const m=x.name.toLowerCase().includes(n.toLowerCase())||x.description.toLowerCase().includes(n.toLowerCase())||x.tags.some(w=>w.toLowerCase().includes(n.toLowerCase())),b=o==="all"||x.tags.includes(o);return m&&b}),f=Array.from(new Set(l.flatMap(x=>x.tags))).filter(x=>["upstox","fyers","dhan","zerodha","angelone","shipnext"].includes(x)),h=x=>{s(x)};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold text-orange-500 uppercase mb-2",children:"Template Library"}),t.jsx("p",{className:"text-xs text-gray-500",children:"Pre-built mappings for popular brokers and data sources"})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("input",{type:"text",placeholder:"Search templates...",value:n,onChange:x=>i(x.target.value),className:"flex-1 bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500"}),t.jsxs("select",{value:o,onChange:x=>a(x.target.value),className:"bg-zinc-900 border border-zinc-700 text-gray-300 px-3 py-2 text-xs rounded focus:outline-none focus:border-orange-500",children:[t.jsx("option",{value:"all",children:"All Brokers"}),f.map(x=>t.jsx("option",{value:x,children:x.toUpperCase()},x))]})]}),t.jsxs("div",{className:"grid grid-cols-1 gap-3 max-h-[600px] overflow-auto pr-2",children:[d.map(x=>t.jsxs("div",{className:`bg-zinc-900 border rounded-lg p-4 cursor-pointer transition-all ${e?.id===x.id?"border-orange-500 bg-orange-900/10":"border-zinc-700 hover:border-zinc-600"}`,onClick:()=>r(x),children:[t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("h4",{className:"text-sm font-bold text-white",children:x.name}),x.verified&&t.jsx(Bn,{size:14,className:"text-green-500","aria-label":"Verified"}),x.official&&t.jsx(Y0,{size:14,className:"text-yellow-500","aria-label":"Official"})]}),t.jsx("p",{className:"text-xs text-gray-400",children:x.description})]})}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:x.tags.map(m=>t.jsx("span",{className:"text-xs px-2 py-1 bg-zinc-800 text-gray-400 rounded font-mono uppercase",children:m},m))}),t.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 mb-3",children:[x.usageCount!==void 0&&t.jsxs("div",{children:[t.jsx(hc,{size:12,className:"inline mr-1"}),x.usageCount," uses"]}),x.rating!==void 0&&t.jsxs("div",{children:[t.jsx(Y0,{size:12,className:"inline mr-1 text-yellow-500"}),x.rating,"/5"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:m=>{m.stopPropagation(),r(x)},className:"flex-1 bg-zinc-800 hover:bg-zinc-700 text-gray-300 py-2 px-3 rounded text-xs font-bold flex items-center justify-center gap-2",children:[t.jsx(vi,{size:12}),"PREVIEW"]}),t.jsx("button",{onClick:m=>{m.stopPropagation(),h(x)},className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white py-2 px-3 rounded text-xs font-bold",children:"USE TEMPLATE"})]})]},x.id)),d.length===0&&t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx("p",{className:"text-sm",children:"No templates found"}),t.jsx("p",{className:"text-xs mt-2",children:"Try adjusting your search or filter"})]})]}),e&&t.jsxs("div",{className:"bg-zinc-900 border border-orange-700 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h4",{className:"text-xs font-bold text-orange-500 uppercase",children:"Template Details"}),t.jsx("button",{onClick:()=>r(null),className:"text-xs text-gray-400 hover:text-white",children:"Close"})]}),e.instructions&&t.jsxs("div",{className:"mb-4",children:[t.jsx("div",{className:"text-xs font-bold text-gray-400 mb-2",children:"USAGE INSTRUCTIONS"}),t.jsx("pre",{className:"text-xs text-gray-400 whitespace-pre-wrap bg-zinc-800 p-3 rounded",children:e.instructions})]}),e.mappingConfig.fieldMappings&&t.jsxs("div",{children:[t.jsx("div",{className:"text-xs font-bold text-gray-400 mb-2",children:"FIELD MAPPINGS"}),t.jsx("div",{className:"space-y-2",children:e.mappingConfig.fieldMappings.map((x,m)=>t.jsxs("div",{className:"bg-zinc-800 p-2 rounded text-xs",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-orange-400 font-mono",children:x.targetField}),t.jsx("span",{className:"text-gray-500",children:""}),t.jsx("span",{className:"text-green-400 font-mono flex-1 text-right truncate",children:x.sourceExpression})]}),x.transform&&t.jsxs("div",{className:"text-purple-400 mt-1",children:["Transform: ",x.transform]})]},m))})]}),t.jsx("button",{onClick:()=>h(e),className:"w-full mt-4 bg-orange-600 hover:bg-orange-700 text-white py-3 rounded font-bold text-xs",children:"USE THIS TEMPLATE"})]})]})}var _s=[];for(var S0=0;S0<256;++S0)_s.push((S0+256).toString(16).slice(1));function IK(s,e=0){return(_s[s[e+0]]+_s[s[e+1]]+_s[s[e+2]]+_s[s[e+3]]+"-"+_s[s[e+4]]+_s[s[e+5]]+"-"+_s[s[e+6]]+_s[s[e+7]]+"-"+_s[s[e+8]]+_s[s[e+9]]+"-"+_s[s[e+10]]+_s[s[e+11]]+_s[s[e+12]]+_s[s[e+13]]+_s[s[e+14]]+_s[s[e+15]]).toLowerCase()}var Lf,PK=new Uint8Array(16);function LK(){if(!Lf&&(Lf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Lf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Lf(PK)}var zK=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Ck={randomUUID:zK};function zf(s,e,r){if(Ck.randomUUID&&!s)return Ck.randomUUID();s=s||{};var n=s.random||(s.rng||LK)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,IK(n)}function MK(){const[s,e]=S.useState("list"),[r,n]=S.useState("api-config"),[i,o]=S.useState([]),[a,l]=S.useState(!1),[d,p]=S.useState(""),[f,h]=S.useState(""),[x,m]=S.useState(""),[b,w]=S.useState({id:zf(),name:"",description:"",baseUrl:"",endpoint:"",method:"GET",authentication:{type:"none"},headers:{},queryParams:{},timeout:3e4,cacheEnabled:!0,cacheTTL:300}),[y,C]=S.useState("predefined"),[T,E]=S.useState(),[j,k]=S.useState([]),[A,R]=S.useState(null),[M,P]=S.useState([]),[I,O]=S.useState(null),[G,B]=S.useState(!1),F=["api-config","schema-select","field-mapping","cache-settings","test-save"],z=F.indexOf(r);S.useEffect(()=>{W(),$()},[]);const $=async()=>{try{await Ea.initialize()}catch(X){console.error("Failed to initialize database:",X)}},W=async()=>{l(!0);try{const X=await Ea.getAllMappings();o(X)}catch(X){console.error("Failed to load mappings:",X)}finally{l(!1)}},D=()=>{p(zf()),h(""),m(""),w({id:zf(),name:"",description:"",baseUrl:"",endpoint:"",method:"GET",authentication:{type:"none"},headers:{},queryParams:{},timeout:3e4,cacheEnabled:!0,cacheTTL:300}),C("predefined"),E(void 0),k([]),R(null),P([]),O(null),n("api-config"),e("create")},oe=X=>{R(X),console.log("[DataMappingTab] Sample data fetched:",X)},Z=X=>{w(X),(!f||f===b.name)&&h(X.name),(!x||x===b.description)&&m(X.description)},fe=async()=>{if(!A){alert("Please fetch sample data first");return}if(M.length===0){alert("Please configure at least one field mapping");return}B(!0);try{const X=_e=>{if(Array.isArray(_e))return{rootPath:"",isArray:!0};const Re=["data","results","items","records","response"];for(const Be of Re)if(_e[Be]&&Array.isArray(_e[Be])&&_e[Be].length>0)return{rootPath:Be,isArray:!0};return{rootPath:"",isArray:!1}};let V;if(M.length>0&&M[0].source?.path?.startsWith("$")){const{rootPath:_e,isArray:Re}=X(A);V={engine:At.JSONPATH,rootPath:_e?`$.${_e}[*]`:"",isArray:Re}}else{const{rootPath:_e,isArray:Re}=X(A);V={engine:At.JSONPATH,rootPath:_e?`$.${_e}[*]`:"",isArray:Re}}const de={id:d,name:f||b.name,description:x||b.description,source:{type:"sample",sampleData:A},target:{schemaType:y,schema:y==="predefined"?T:void 0,customFields:y==="custom"?j:void 0},extraction:V,fieldMappings:M,postProcessing:void 0,validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:[],aiGenerated:!1}},je=await T2.test(de,A);O(je),je.success||alert(`Test failed: ${je.errors?.join(", ")}`)}catch(X){console.error("Test failed:",X),O({success:!1,errors:[X instanceof Error?X.message:String(X)],metadata:{executedAt:new Date().toISOString(),duration:0,recordsProcessed:0,recordsReturned:0}})}finally{B(!1)}},Q=async()=>{if(!I?.success){alert("Please test the mapping successfully before saving");return}if(!f){alert("Please provide a mapping name");return}try{const X=je=>{if(Array.isArray(je))return{rootPath:"",isArray:!0};const _e=["data","results","items","records","response"];for(const Re of _e)if(je[Re]&&Array.isArray(je[Re])&&je[Re].length>0)return{rootPath:Re,isArray:!0};return{rootPath:"",isArray:!1}};let V;if(M.length>0&&M[0].source?.path?.startsWith("$")){const{rootPath:je,isArray:_e}=X(A);V={engine:At.JSONPATH,rootPath:je?`$.${je}[*]`:"",isArray:_e}}else{const{rootPath:je,isArray:_e}=X(A);V={engine:At.JSONPATH,rootPath:je?`$.${je}[*]`:"",isArray:_e}}const de={id:d,name:f,description:x,source:{type:"api",apiConfig:b},target:{schemaType:y,schema:y==="predefined"?T:void 0,customFields:y==="custom"?j:void 0},extraction:V,fieldMappings:M,postProcessing:void 0,validation:{enabled:!0,strictMode:!1,rules:[]},metadata:{createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:1,tags:[],aiGenerated:!1}};await Ea.saveMapping(de),alert("Mapping saved successfully!"),await W(),e("list")}catch(X){console.error("Failed to save mapping:",X),alert(`Failed to save mapping: ${X instanceof Error?X.message:String(X)}`)}},_=async X=>{if(confirm("Delete this mapping? This cannot be undone."))try{await Ea.deleteMapping(X),await W()}catch(V){console.error("Failed to delete mapping:",V),alert("Failed to delete mapping")}},Y=async X=>{p(X.id),h(X.name),m(X.description),X.source.type==="api"&&X.source.apiConfig&&w(X.source.apiConfig),C(X.target.schemaType),X.target.schemaType==="predefined"?E(X.target.schema):k(X.target.customFields||[]),P(X.fieldMappings),n("api-config"),e("create")},he=X=>{p(zf()),h(X.mappingConfig.name||X.name),m(X.mappingConfig.description||X.description),X.mappingConfig.source?.apiConfig&&w(X.mappingConfig.source.apiConfig),X.mappingConfig.target&&(C(X.mappingConfig.target.schemaType),X.mappingConfig.target.schemaType==="predefined"?E(X.mappingConfig.target.schema):k(X.mappingConfig.target.customFields||[])),X.mappingConfig.fieldMappings&&P(X.mappingConfig.fieldMappings),n("api-config"),e("create")},me=()=>{switch(r){case"api-config":return b.baseUrl&&b.endpoint&&b.name&&A!==null;case"schema-select":return y==="predefined"&&T||y==="custom"&&j.length>0;case"field-mapping":return M.length>0;case"cache-settings":return!0;case"test-save":return I?.success===!0;default:return!1}},ge=X=>{const V=F.indexOf(X);return V<z?"complete":V===z?"current":"pending"},le=()=>{switch(r){case"api-config":return t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Configure API Connection"}),t.jsx(kK,{config:b,onChange:Z,onTestSuccess:oe})]});case"schema-select":return t.jsxs("div",{className:"p-6 max-w-full mx-auto",children:[t.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Choose Target Schema"}),t.jsx(TK,{schemaType:y,selectedSchema:T,customFields:j,onSchemaTypeChange:C,onSchemaSelect:X=>E(X),onCustomFieldsChange:k,sampleData:A,onFieldMappingsAutoCreate:X=>{const V=new Set(M.map(je=>je.targetField)),de=X.filter(je=>!V.has(je.targetField));de.length>0&&P([...M,...de])}})]});case"field-mapping":return A?t.jsxs("div",{className:"p-6 h-full",children:[t.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Map API Fields to Schema"}),t.jsx(RK,{schemaType:y,selectedSchema:T,customFields:j,sampleData:A,mappings:M,onMappingsChange:P})]}):t.jsx("div",{className:"p-6 text-center",children:t.jsx("p",{className:"text-red-400",children:"Please fetch sample data first"})});case"cache-settings":return t.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[t.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Cache & Security Settings"}),t.jsx(NK,{cacheEnabled:b.cacheEnabled,cacheTTL:b.cacheTTL,onCacheEnabledChange:X=>w({...b,cacheEnabled:X}),onCacheTTLChange:X=>w({...b,cacheTTL:X}),mappingId:d})]});case"test-save":return t.jsxs("div",{className:"p-6 max-w-4xl mx-auto space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-lg font-bold text-white",children:"Test & Save Mapping"}),t.jsxs("button",{onClick:fe,disabled:G,className:"bg-green-600 hover:bg-green-700 disabled:bg-zinc-700 text-white px-4 py-2 rounded font-bold flex items-center gap-2",children:[t.jsx(Ms,{size:16}),G?"TESTING...":"RUN TEST"]})]}),t.jsx(OK,{result:I||void 0,isLoading:G}),I?.success&&t.jsxs("button",{onClick:Q,className:"w-full bg-orange-600 hover:bg-orange-700 text-white py-3 rounded font-bold flex items-center justify-center gap-2",children:[t.jsx(ao,{size:18}),"SAVE MAPPING"]})]});default:return null}};return t.jsxs("div",{className:"w-full h-full bg-zinc-950 flex flex-col",children:[t.jsx("div",{className:"bg-zinc-900 border-b border-zinc-800 p-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-orange-500 text-sm font-bold tracking-wide",children:"DATA MAPPING"}),t.jsx("div",{className:"w-px h-5 bg-zinc-700"}),t.jsx("span",{className:"text-gray-500 text-xs",children:"Connect any API directly to Fincept Terminal"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>e("list"),className:`px-3 py-1.5 rounded text-xs font-bold flex items-center gap-1 ${s==="list"?"bg-orange-600 text-white":"bg-transparent text-gray-400 border border-zinc-700 hover:border-zinc-600"}`,children:[t.jsx(rB,{size:12}),"MY MAPPINGS"]}),t.jsxs("button",{onClick:()=>e("templates"),className:`px-3 py-1.5 rounded text-xs font-bold flex items-center gap-1 ${s==="templates"?"bg-orange-600 text-white":"bg-transparent text-gray-400 border border-zinc-700 hover:border-zinc-600"}`,children:[t.jsx(WM,{size:12}),"TEMPLATES"]}),t.jsxs("button",{onClick:D,className:`px-3 py-1.5 rounded text-xs font-bold flex items-center gap-1 ${s==="create"?"bg-orange-600 text-white":"bg-transparent text-gray-400 border border-zinc-700 hover:border-zinc-600"}`,children:[t.jsx(wn,{size:12}),"CREATE NEW"]})]})]})}),s==="create"&&t.jsx("div",{className:"bg-zinc-900 border-b border-zinc-800 p-3",children:t.jsx("div",{className:"flex items-center gap-2",children:F.map((X,V)=>{const de=ge(X),je=de==="complete"?Bn:cg;return t.jsxs(S.Fragment,{children:[t.jsxs("div",{className:`flex-1 flex flex-col items-center cursor-pointer ${V<=z?"opacity-100":"opacity-40"}`,onClick:()=>V<=z&&n(X),children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx(je,{size:14,className:de==="complete"?"text-green-500":de==="current"?"text-orange-500":"text-gray-600"}),t.jsx("span",{className:`text-xs font-bold uppercase ${de==="complete"?"text-green-500":de==="current"?"text-orange-500":"text-gray-600"}`,children:X.replace("-"," ")})]}),t.jsx("div",{className:`h-1 w-full rounded ${V<=z?"bg-orange-500":"bg-zinc-700"}`})]}),V<F.length-1&&t.jsx(lg,{size:12,className:"text-zinc-700 flex-shrink-0"})]},X)})})}),t.jsxs("div",{className:"flex-1 overflow-auto",children:[s==="list"&&t.jsx("div",{className:"p-6",children:a?t.jsx("div",{className:"text-center py-12 text-gray-400",children:"Loading mappings..."}):i.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("h3",{className:"text-gray-400 mb-3",children:"No mappings yet"}),t.jsx("p",{className:"text-gray-600 text-sm mb-6",children:"Create your first API mapping to get started"}),t.jsxs("button",{onClick:D,className:"bg-orange-600 hover:bg-orange-700 text-white px-6 py-3 rounded font-bold flex items-center gap-2 mx-auto",children:[t.jsx(wn,{size:16}),"CREATE FIRST MAPPING"]})]}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(X=>t.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded p-4 hover:border-zinc-600 transition-colors",children:[t.jsx("h3",{className:"text-white font-bold mb-1",children:X.name}),t.jsx("p",{className:"text-xs text-gray-400 mb-3",children:X.description}),t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:X.target.schemaType==="predefined"?X.target.schema?.toUpperCase():"CUSTOM"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>Y(X),className:"text-blue-400 hover:text-blue-300",children:"Edit"}),t.jsx("button",{onClick:()=>_(X.id),className:"text-red-400 hover:text-red-300",children:"Delete"})]})]})]},X.id))})}),s==="templates"&&t.jsx("div",{className:"p-6",children:t.jsx(DK,{onSelectTemplate:he})}),s==="create"&&t.jsx(t.Fragment,{children:le()})]}),s==="create"&&t.jsxs("div",{className:"bg-zinc-900 border-t border-zinc-800 p-3 flex justify-between",children:[t.jsxs("button",{onClick:()=>{const X=z-1;X>=0&&n(F[X])},disabled:z===0,className:"px-4 py-2 rounded text-xs font-bold flex items-center gap-2 bg-transparent text-gray-400 border border-zinc-700 hover:border-zinc-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(ks,{size:14}),"PREVIOUS"]}),t.jsxs("button",{onClick:()=>{if(!me()){alert("Please complete the current step before proceeding");return}const X=z+1;X<F.length&&n(F[X])},disabled:z===F.length-1,className:"px-4 py-2 rounded text-xs font-bold flex items-center gap-2 bg-orange-600 hover:bg-orange-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:["NEXT",t.jsx(lg,{size:14})]})]})]})}const BK=[{id:"postgres",name:"PostgreSQL",description:"Connect to PostgreSQL databases for SQL queries and analysis",category:"data",icon:"",command:"bunx",args:["-y","@modelcontextprotocol/server-postgres"],requiresArg:"DATABASE_URL",requiresConfig:!0,tools:["query","describe_table","list_tables","explain_query","get_indexes"],documentation:"https://github.com/modelcontextprotocol/servers/tree/main/src/postgres"},{id:"questdb",name:"QuestDB",description:"Connect to QuestDB time-series databases for fast analytics",category:"data",icon:"",command:"bunx",args:["-y","@questdb/mcp-server"],requiresArg:"DATABASE_URL",requiresConfig:!0,tools:["query","list_tables","describe_table","insert_data","get_metrics"],documentation:"https://questdb.io/docs/third-party-tools/mcp/"},{id:"wikipedia",name:"Wikipedia",description:"Search and retrieve Wikipedia articles with summaries and key facts",category:"web",icon:"",command:"bunx",args:["-y","wikipedia-mcp"],env:{},requiresConfig:!1,tools:["search_wikipedia","get_article","get_summary","get_sections","get_links","get_coordinates","get_related_topics","summarize_article_for_query","summarize_article_section","extract_key_facts"],documentation:"https://github.com/Rudra-ravi/wikipedia-mcp"},{id:"kite",name:"Zerodha Kite",description:"Indian stock trading, portfolio management, order execution, and real-time market data via Kite Connect API",category:"data",icon:"",command:"bunx",args:["-y","mcp-remote","https://mcp.kite.trade/mcp"],env:{KITE_API_KEY:"",KITE_API_SECRET:""},requiresConfig:!0,tools:["get_profile","get_holdings","get_positions","get_orders","place_order","modify_order","cancel_order","get_gtt_orders","place_gtt_order","modify_gtt_order","delete_gtt_order","get_quote","get_ohlc","get_ltp","get_instruments"],documentation:"https://github.com/zerodha/kite-mcp-server"}],FK=({onSubmit:s,onCancel:e})=>{const[r,n]=S.useState("localhost"),[i,o]=S.useState("5432"),[a,l]=S.useState("postgres"),[d,p]=S.useState(""),[f,h]=S.useState("postgres"),[x,m]=S.useState(!1),b="#FFA500",w="#FFFFFF",y="#787878",C="#000000",T="#FFFF00",E=()=>{const k=encodeURIComponent(d);return`postgresql://${a}:${k}@${r}:${i}/${f}${x?"?sslmode=require":""}`},j=()=>{const k=E();s({args:[],env:{DATABASE_URL:k}})};return t.jsxs("div",{children:[t.jsx("div",{style:{color:w,fontSize:"10px",marginBottom:"12px"},children:"Configure your PostgreSQL database connection. The connection string will be passed securely to the MCP server."}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"HOST"}),t.jsx("input",{type:"text",value:r,onChange:k=>n(k.target.value),placeholder:"localhost",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"PORT"}),t.jsx("input",{type:"text",value:i,onChange:k=>o(k.target.value),placeholder:"5432",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"DATABASE"}),t.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"postgres",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"USERNAME"}),t.jsx("input",{type:"text",value:a,onChange:k=>l(k.target.value),placeholder:"postgres",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"PASSWORD *"}),t.jsx("input",{type:"password",value:d,onChange:k=>p(k.target.value),placeholder:"Enter database password",style:{width:"100%",backgroundColor:C,border:`1px solid ${d?b:y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsx("div",{style:{marginBottom:"12px"},children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",color:w,fontSize:"10px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:x,onChange:k=>m(k.target.checked),style:{cursor:"pointer"}}),"Require SSL Connection"]})}),t.jsxs("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:C,border:`1px solid ${y}`,borderRadius:"2px"},children:[t.jsx("div",{style:{color:y,fontSize:"8px",marginBottom:"4px",fontWeight:"bold"},children:"CONNECTION STRING PREVIEW:"}),t.jsx("div",{style:{color:T,fontSize:"9px",fontFamily:"Consolas, monospace",wordBreak:"break-all"},children:E()})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px",paddingTop:"12px",borderTop:`1px solid ${y}`},children:[t.jsx("button",{onClick:e,style:{backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px 12px",fontSize:"10px",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:j,disabled:!d.trim(),style:{backgroundColor:d.trim()?b:y,border:"none",color:"black",padding:"6px 12px",fontSize:"10px",fontWeight:"bold",cursor:d.trim()?"pointer":"not-allowed"},children:"INSTALL"})]})]})},$K=({onSubmit:s,onCancel:e})=>{const[r,n]=S.useState("localhost"),[i,o]=S.useState("8812"),[a,l]=S.useState("admin"),[d,p]=S.useState(""),[f,h]=S.useState("qdb"),[x,m]=S.useState(!1),b="#FFA500",w="#FFFFFF",y="#787878",C="#000000",T="#FFFF00",E=()=>{const k=encodeURIComponent(d);return`postgresql://${a}:${k}@${r}:${i}/${f}${x?"?sslmode=require":""}`},j=()=>{const k=E();s({args:[k],env:{}})};return t.jsxs("div",{children:[t.jsx("div",{style:{color:w,fontSize:"10px",marginBottom:"12px"},children:"Configure your QuestDB connection. QuestDB uses PostgreSQL wire protocol (default port 8812)."}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"HOST"}),t.jsx("input",{type:"text",value:r,onChange:k=>n(k.target.value),placeholder:"localhost",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"PORT"}),t.jsx("input",{type:"text",value:i,onChange:k=>o(k.target.value),placeholder:"8812",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{flex:1},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"DATABASE"}),t.jsx("input",{type:"text",value:f,onChange:k=>h(k.target.value),placeholder:"qdb",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"USERNAME"}),t.jsx("input",{type:"text",value:a,onChange:k=>l(k.target.value),placeholder:"admin",style:{width:"100%",backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:b,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"PASSWORD *"}),t.jsx("input",{type:"password",value:d,onChange:k=>p(k.target.value),placeholder:"Enter database password",style:{width:"100%",backgroundColor:C,border:`1px solid ${d?b:y}`,color:w,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsx("div",{style:{marginBottom:"12px"},children:t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",color:w,fontSize:"10px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:x,onChange:k=>m(k.target.checked),style:{cursor:"pointer"}}),"Require SSL Connection"]})}),t.jsxs("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:C,border:`1px solid ${y}`,borderRadius:"2px"},children:[t.jsx("div",{style:{color:y,fontSize:"8px",marginBottom:"4px",fontWeight:"bold"},children:"CONNECTION STRING PREVIEW:"}),t.jsx("div",{style:{color:T,fontSize:"9px",fontFamily:"Consolas, monospace",wordBreak:"break-all"},children:E()})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px",paddingTop:"12px",borderTop:`1px solid ${y}`},children:[t.jsx("button",{onClick:e,style:{backgroundColor:C,border:`1px solid ${y}`,color:w,padding:"6px 12px",fontSize:"10px",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:j,disabled:!d.trim(),style:{backgroundColor:d.trim()?b:y,border:"none",color:"black",padding:"6px 12px",fontSize:"10px",fontWeight:"bold",cursor:d.trim()?"pointer":"not-allowed"},children:"INSTALL"})]})]})},GK=({onSubmit:s,onCancel:e})=>{const[r,n]=S.useState(""),[i,o]=S.useState(""),a="#FFA500",l="#FFFFFF",d="#787878",p="#000000",f="#FFFF00",h="#ef4444",x=()=>{if(!r.trim()||!i.trim()){alert("Please fill in all required fields");return}s({args:[],env:{KITE_API_KEY:r.trim(),KITE_API_SECRET:i.trim()}})},m=()=>{window.open("https://developers.kite.trade/","_blank")};return t.jsxs("div",{children:[t.jsxs("div",{style:{backgroundColor:`${f}20`,border:`1px solid ${f}`,borderRadius:"4px",padding:"10px",marginBottom:"16px",display:"flex",gap:"8px",alignItems:"flex-start"},children:[t.jsx(Rr,{size:16,color:f,style:{flexShrink:0,marginTop:"2px"}}),t.jsxs("div",{style:{fontSize:"10px",color:l,lineHeight:"1.5"},children:[t.jsx("strong",{children:"Trading API Integration"}),t.jsx("div",{style:{marginTop:"4px",color:d},children:"This MCP server connects to Zerodha Kite for live trading. Ensure you have a Kite Connect app registered. You'll need to authenticate through the browser on first use."})]})]}),t.jsx("div",{style:{color:l,fontSize:"10px",marginBottom:"12px",lineHeight:"1.5"},children:"Configure your Kite Connect API credentials. Get your API key and secret from the Kite Connect Developer Console."}),t.jsxs("button",{onClick:m,style:{backgroundColor:"transparent",border:`1px solid ${a}`,color:a,padding:"8px 12px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"bold"},children:[t.jsx(Nd,{size:12}),"OPEN KITE CONNECT CONSOLE"]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:a,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"API KEY *"}),t.jsx("input",{type:"text",value:r,onChange:b=>n(b.target.value),placeholder:"Enter your Kite Connect API Key",style:{width:"100%",backgroundColor:p,border:`1px solid ${r?a:d}`,color:l,padding:"8px",fontSize:"10px",fontFamily:"Consolas, monospace",borderRadius:"3px"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:a,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"API SECRET *"}),t.jsx("input",{type:"password",value:i,onChange:b=>o(b.target.value),placeholder:"Enter your Kite Connect API Secret",style:{width:"100%",backgroundColor:p,border:`1px solid ${i?a:d}`,color:l,padding:"8px",fontSize:"10px",fontFamily:"Consolas, monospace",borderRadius:"3px"}})]}),t.jsxs("div",{style:{marginTop:"16px",padding:"10px",backgroundColor:p,border:`1px solid ${d}`,borderRadius:"4px"},children:[t.jsx("div",{style:{color:a,fontSize:"9px",marginBottom:"6px",fontWeight:"bold"},children:"HOW TO GET CREDENTIALS:"}),t.jsxs("ol",{style:{color:d,fontSize:"9px",lineHeight:"1.6",margin:"0",paddingLeft:"16px"},children:[t.jsxs("li",{children:["Visit ",t.jsx("span",{style:{color:f},children:"developers.kite.trade"})]}),t.jsx("li",{children:"Create or login to your Kite Connect account"}),t.jsx("li",{children:"Create a new app or select existing app"}),t.jsxs("li",{children:["Copy your ",t.jsx("strong",{children:"API Key"})," and ",t.jsx("strong",{children:"API Secret"})]}),t.jsxs("li",{children:["Set redirect URL to ",t.jsx("span",{style:{color:f},children:"http://localhost:8080/callback"})]})]})]}),t.jsxs("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:`${h}15`,border:`1px solid ${h}`,borderRadius:"4px",fontSize:"9px",color:d,lineHeight:"1.5"},children:[t.jsx("strong",{style:{color:h},children:" Security:"})," Your API credentials are stored locally and encrypted. Never share your API Secret. You'll need to authenticate via browser on first use."]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px",paddingTop:"12px",borderTop:`1px solid ${d}`},children:[t.jsx("button",{onClick:e,style:{backgroundColor:p,border:`1px solid ${d}`,color:l,padding:"8px 16px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:"CANCEL"}),t.jsx("button",{onClick:x,disabled:!r.trim()||!i.trim(),style:{backgroundColor:r.trim()&&i.trim()?a:d,border:"none",color:"black",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:r.trim()&&i.trim()?"pointer":"not-allowed",borderRadius:"3px",opacity:r.trim()&&i.trim()?1:.5},children:"INSTALL & CONNECT"})]})]})},UK=({server:s,onSubmit:e,onCancel:r})=>{const[n,i]=S.useState(s.env||{}),o="#FFA500",a="#FFFFFF",l="#787878",d="#000000",p=()=>{if(!Object.values(n).every(h=>h.trim())){alert("Please fill in all required fields");return}e({args:s.requiresArg&&n[s.requiresArg]?[n[s.requiresArg]]:[],env:s.requiresArg?{}:n})};return t.jsxs("div",{children:[t.jsx("div",{style:{color:a,fontSize:"10px",marginBottom:"12px"},children:s.description}),s.env&&Object.keys(s.env).length>0&&t.jsx(t.Fragment,{children:Object.keys(s.env).map(f=>t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:o,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:f}),t.jsx("input",{type:"text",value:n[f]||"",onChange:h=>i({...n,[f]:h.target.value}),placeholder:`Enter ${f}`,style:{width:"100%",backgroundColor:d,border:`1px solid ${l}`,color:a,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]},f))}),s.requiresArg&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("label",{style:{display:"block",color:o,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:[s.requiresArg," *"]}),t.jsx("input",{type:"text",value:n[s.requiresArg]||"",onChange:f=>i({...n,[s.requiresArg]:f.target.value}),placeholder:`Enter ${s.requiresArg}`,style:{width:"100%",backgroundColor:d,border:`1px solid ${l}`,color:a,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px",paddingTop:"12px",borderTop:`1px solid ${l}`},children:[t.jsx("button",{onClick:r,style:{backgroundColor:d,border:`1px solid ${l}`,color:a,padding:"6px 12px",fontSize:"10px",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{onClick:p,disabled:!Object.values(n).every(f=>f.trim()),style:{backgroundColor:Object.values(n).every(f=>f.trim())?o:l,border:"none",color:"black",padding:"6px 12px",fontSize:"10px",fontWeight:"bold",cursor:Object.values(n).every(f=>f.trim())?"pointer":"not-allowed"},children:"INSTALL"})]})]})},WK=({onInstall:s,installedServers:e})=>{const[r,n]=S.useState(""),[i,o]=S.useState("all"),[a,l]=S.useState(null),d="#FFA500",p="#FFFFFF",f="#787878",h="#0a0a0a",x="#1a1a1a",m="#2d2d2d",b="#10b981",w="#FFFF00",y=A=>e.some(R=>R.id===A),C=BK.filter(A=>{const R=A.name.toLowerCase().includes(r.toLowerCase())||A.description.toLowerCase().includes(r.toLowerCase()),M=i==="all"||A.category===i;return R&&M}),T=["all","data","web","productivity","dev"],E={all:"ALL",data:"DATA",web:"WEB",productivity:"TOOLS",dev:"DEV"},j=A=>{A.requiresConfig?l(A):s(A)},k=A=>{if(a){const R={...a,args:[...a.args,...A.args],env:A.env};s(R),l(null)}};return t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsxs("div",{style:{position:"relative",marginBottom:"12px"},children:[t.jsx(Ho,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:f}}),t.jsx("input",{type:"text",placeholder:"Search marketplace...",value:r,onChange:A=>n(A.target.value),style:{width:"100%",backgroundColor:h,border:`1px solid ${m}`,color:p,padding:"8px 12px 8px 36px",fontSize:"11px",borderRadius:"4px",outline:"none"}})]}),t.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:T.map(A=>t.jsx("button",{onClick:()=>o(A),style:{backgroundColor:i===A?m:"transparent",color:i===A?d:f,border:`1px solid ${i===A?d:m}`,padding:"6px 12px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",textTransform:"uppercase",fontWeight:i===A?"bold":"normal"},children:E[A]},A))})]}),t.jsx("div",{style:{flex:1,overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none"},children:C.length===0?t.jsxs("div",{style:{textAlign:"center",color:f,padding:"60px 20px",fontSize:"11px"},children:[t.jsx(si,{size:48,style:{marginBottom:"16px",opacity:.3,color:d}}),t.jsx("div",{style:{marginBottom:"8px"},children:"No servers found matching your search."}),t.jsx("div",{children:"Try a different search term or category."})]}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:C.map(A=>{const R=y(A.id);return t.jsxs("div",{style:{backgroundColor:x,border:`1px solid ${m}`,borderRadius:"6px",padding:"16px",cursor:R?"default":"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column",minHeight:"280px"},onMouseEnter:M=>{R||(M.currentTarget.style.borderColor=d,M.currentTarget.style.boxShadow=`0 0 12px ${d}40`)},onMouseLeave:M=>{M.currentTarget.style.borderColor=m,M.currentTarget.style.boxShadow="none"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[t.jsx("span",{style:{fontSize:"32px"},children:A.icon}),t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[t.jsx("h3",{style:{color:p,fontSize:"13px",fontWeight:"bold"},children:A.name}),R&&t.jsx(Bn,{size:14,color:b})]}),t.jsx("div",{style:{display:"inline-block",backgroundColor:`${d}20`,color:d,padding:"2px 8px",fontSize:"9px",borderRadius:"3px",textTransform:"uppercase",fontWeight:"bold"},children:A.category})]})]}),t.jsx("p",{style:{color:f,fontSize:"11px",lineHeight:"1.5",marginBottom:"12px",flex:1},children:A.description}),t.jsxs("div",{style:{marginBottom:"12px",minHeight:"60px"},children:[A.requiresConfig&&t.jsx("div",{style:{backgroundColor:`${w}20`,color:w,padding:"4px 8px",fontSize:"9px",borderRadius:"3px",marginBottom:"8px",display:"inline-block"},children:" Requires Configuration"}),t.jsxs("div",{style:{color:f,fontSize:"10px",marginBottom:"8px"},children:[t.jsx("span",{style:{color:p,fontWeight:"bold"},children:A.tools.length})," tools available"]}),t.jsxs("div",{style:{backgroundColor:h,border:`1px solid ${m}`,padding:"6px 8px",fontSize:"9px",borderRadius:"3px",color:f,fontFamily:"monospace",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[A.command," ",A.args.join(" ")]})]}),R?t.jsxs("button",{disabled:!0,style:{width:"100%",backgroundColor:`${b}30`,color:b,border:`1px solid ${b}`,padding:"8px 12px",fontSize:"10px",fontWeight:"bold",cursor:"not-allowed",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[t.jsx(Bn,{size:12}),"INSTALLED"]}):t.jsxs("button",{onClick:()=>j(A),style:{width:"100%",backgroundColor:b,color:"black",border:"none",padding:"8px 12px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[t.jsx(Mi,{size:12}),A.requiresConfig?"CONFIGURE & INSTALL":"INSTALL NOW"]}),A.documentation&&t.jsx("div",{style:{marginTop:"8px",textAlign:"center"},children:t.jsx("a",{href:A.documentation,target:"_blank",rel:"noopener noreferrer",style:{color:f,fontSize:"9px",textDecoration:"none"},onClick:M=>M.stopPropagation(),children:"View Documentation "})})]},A.id)})})}),a&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:t.jsxs("div",{style:{backgroundColor:x,border:`2px solid ${d}`,borderRadius:"8px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none"},children:[t.jsxs("div",{style:{padding:"16px",borderBottom:`1px solid ${m}`,display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{fontSize:"32px"},children:a.icon}),t.jsxs("div",{children:[t.jsxs("h2",{style:{color:p,fontSize:"16px",fontWeight:"bold"},children:["Configure ",a.name]}),t.jsx("p",{style:{color:f,fontSize:"11px"},children:a.description})]})]}),t.jsx("div",{style:{padding:"16px"},children:a.id==="postgres"?t.jsx(FK,{onSubmit:k,onCancel:()=>l(null)}):a.id==="questdb"?t.jsx($K,{onSubmit:k,onCancel:()=>l(null)}):a.id==="kite"?t.jsx(GK,{onSubmit:k,onCancel:()=>l(null)}):t.jsx(UK,{server:a,onSubmit:k,onCancel:()=>l(null)})})]})})]})},qK=({onClose:s,onAdd:e})=>{const[r,n]=S.useState({name:"",description:"",command:"bunx",args:"",envVars:"",category:"custom",icon:""}),i="#FFA500",o="#FFFFFF",a="#787878",l="#000000",d="#0a0a0a",p=f=>{if(f.preventDefault(),!r.name||!r.command||!r.args){alert("Please fill in all required fields");return}const h=r.args.trim().split(/[\s,]+/).filter(w=>w.length>0),x={};r.envVars.trim()&&r.envVars.split(`
`).forEach(w=>{const[y,...C]=w.trim().split("=");y&&C.length>0&&(x[y.trim()]=C.join("=").trim())});const b={id:r.name.toLowerCase().replace(/[^a-z0-9]/g,"-"),name:r.name,description:r.description||`Custom MCP server: ${r.name}`,command:r.command,args:h,env:x,category:r.category,icon:r.icon};e(b)};return t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,fontFamily:"Consolas, monospace"},children:t.jsxs("div",{style:{backgroundColor:d,border:`2px solid ${i}`,width:"500px",maxHeight:"80vh",overflow:"auto"},children:[t.jsxs("div",{style:{backgroundColor:l,borderBottom:`1px solid ${i}`,padding:"10px 12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{color:i,fontSize:"12px",fontWeight:"bold"},children:"ADD CUSTOM MCP SERVER"}),t.jsx("button",{onClick:s,style:{backgroundColor:"transparent",border:"none",color:o,cursor:"pointer",padding:"4px"},children:t.jsx(ln,{size:16})})]}),t.jsxs("form",{onSubmit:p,style:{padding:"12px"},children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:i,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"SERVER NAME *"}),t.jsx("input",{type:"text",value:r.name,onChange:f=>n({...r,name:f.target.value}),placeholder:"e.g., My Custom Server",required:!0,style:{width:"100%",backgroundColor:l,border:`1px solid ${a}`,color:o,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:i,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"DESCRIPTION"}),t.jsx("input",{type:"text",value:r.description,onChange:f=>n({...r,description:f.target.value}),placeholder:"What does this server do?",style:{width:"100%",backgroundColor:l,border:`1px solid ${a}`,color:o,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:i,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"COMMAND *"}),t.jsx("input",{type:"text",value:r.command,onChange:f=>n({...r,command:f.target.value}),placeholder:"bunx, node, python, etc.",required:!0,style:{width:"100%",backgroundColor:l,border:`1px solid ${a}`,color:o,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:i,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"ARGUMENTS * (space or comma separated)"}),t.jsx("input",{type:"text",value:r.args,onChange:f=>n({...r,args:f.target.value}),placeholder:"e.g., -y @modelcontextprotocol/server-example",required:!0,style:{width:"100%",backgroundColor:l,border:`1px solid ${a}`,color:o,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace"}}),t.jsx("div",{style:{color:a,fontSize:"8px",marginTop:"2px"},children:"Example: -y @modelcontextprotocol/server-postgres"})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:i,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"ENVIRONMENT VARIABLES (one per line)"}),t.jsx("textarea",{value:r.envVars,onChange:f=>n({...r,envVars:f.target.value}),placeholder:`DATABASE_URL=postgresql://...
API_KEY=your-key-here`,rows:3,style:{width:"100%",backgroundColor:l,border:`1px solid ${a}`,color:o,padding:"6px",fontSize:"10px",fontFamily:"Consolas, monospace",resize:"vertical"}}),t.jsx("div",{style:{color:a,fontSize:"8px",marginTop:"2px"},children:"Format: KEY=VALUE (one per line)"})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:i,fontSize:"10px",marginBottom:"4px",fontWeight:"bold"},children:"ICON (emoji)"}),t.jsx("input",{type:"text",value:r.icon,onChange:f=>n({...r,icon:f.target.value}),placeholder:"",maxLength:2,style:{width:"60px",backgroundColor:l,border:`1px solid ${a}`,color:o,padding:"6px",fontSize:"16px",textAlign:"center"}})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"flex-end",marginTop:"16px",paddingTop:"12px",borderTop:`1px solid ${a}`},children:[t.jsx("button",{type:"button",onClick:s,style:{backgroundColor:l,border:`1px solid ${a}`,color:o,padding:"6px 12px",fontSize:"10px",cursor:"pointer"},children:"CANCEL"}),t.jsx("button",{type:"submit",style:{backgroundColor:i,border:"none",color:"black",padding:"6px 12px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"ADD SERVER"})]})]})]})})},HK=({onNavigateToTab:s})=>{const[e,r]=S.useState("marketplace"),[n,i]=S.useState([]),[o,a]=S.useState([]),[l,d]=S.useState(!1),[p,f]=S.useState(!1),[h,x]=S.useState("Initializing..."),[m,b]=S.useState(""),w="#FFA500",y="#FFFFFF",C="#787878",T="#0a0a0a",E="#1a1a1a",j="#2d2d2d",k="#10b981",A="#ef4444",R="#f59e0b";S.useEffect(()=>{(async()=>{try{await Je.initialize(),await M()}catch(fe){console.error("Failed to initialize MCP tab:",fe),x("Initialization failed")}})();const Z=setInterval(()=>{M(!0)},5e3);return()=>clearInterval(Z)},[]);const M=async(oe=!1)=>{try{oe||x("Loading servers...");const Z=await Go.getServersWithStats();i(Z);const fe=await Je.getMCPTools();a(fe);const Q=Z.filter(_=>_.status==="running").length;x(`${Q} running | ${fe.length} tools available`)}catch(Z){console.error("Failed to load MCP data:",Z),x("Error loading data")}},P=async()=>{f(!0),await M(),setTimeout(()=>f(!1),500)},I=async oe=>{try{x("Installing server..."),await Go.installServer(oe),await M(),x("Server installed successfully"),r("installed")}catch(Z){console.error("Failed to install server:",Z),x(`Installation failed: ${Z instanceof Error?Z.message:"Unknown error"}`)}},O=async oe=>{try{x("Starting server..."),await Go.startServer(oe),await M()}catch(Z){console.error("Failed to start server:",Z),x(`Start failed: ${Z instanceof Error?Z.message:"Unknown error"}`)}},G=async oe=>{try{x("Stopping server..."),await Go.stopServer(oe),await M()}catch(Z){console.error("Failed to stop server:",Z),x(`Stop failed: ${Z instanceof Error?Z.message:"Unknown error"}`)}},B=async oe=>{if(confirm("Remove this MCP server? This will delete all associated data."))try{x("Removing server..."),await Go.removeServer(oe),await M(),x("Server removed")}catch(Z){console.error("Failed to remove server:",Z),x(`Remove failed: ${Z instanceof Error?Z.message:"Unknown error"}`)}},F=async(oe,Z)=>{try{await Go.updateServerConfig(oe,{auto_start:Z}),await M(),x(Z?"Auto-start enabled":"Auto-start disabled")}catch(fe){console.error("Failed to toggle auto-start:",fe),x(`Auto-start toggle failed: ${fe instanceof Error?fe.message:"Unknown error"}`)}},z=oe=>{switch(oe){case"running":return t.jsx(Bn,{size:14,color:k});case"error":return t.jsx(Rp,{size:14,color:A});default:return t.jsx(Rr,{size:14,color:C})}},$=oe=>{switch(oe){case"running":return k;case"error":return A;default:return C}},W=n.filter(oe=>oe.status==="running").length,D=n.filter(oe=>oe.name.toLowerCase().includes(m.toLowerCase())||oe.description.toLowerCase().includes(m.toLowerCase()));return t.jsxs("div",{style:{width:"100%",height:"100%",backgroundColor:T,color:y,fontFamily:"Consolas, monospace",display:"flex",flexDirection:"column",fontSize:"11px",overflow:"hidden"},children:[t.jsxs("div",{style:{backgroundColor:E,borderBottom:`1px solid ${j}`,padding:"12px 16px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:w,fontSize:"14px",fontWeight:"bold",letterSpacing:"0.5px"},children:"MCP MARKETPLACE"}),t.jsx("div",{style:{width:"1px",height:"20px",backgroundColor:"#404040"}}),t.jsxs("span",{style:{color:C,fontSize:"11px"},children:[n.length," Installed | ",W," Running | ",o.length," Tools"]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.jsxs("button",{onClick:()=>s?.("chat"),style:{backgroundColor:"transparent",border:`1px solid ${w}`,color:w,padding:"6px 12px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",fontWeight:"bold"},title:"Go back to AI Chat",children:[t.jsx(Qg,{size:12}),"AI CHAT"]}),t.jsxs("button",{onClick:P,disabled:p,style:{backgroundColor:"transparent",border:`1px solid ${j}`,color:y,padding:"6px 12px",fontSize:"10px",cursor:p?"not-allowed":"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"6px",opacity:p?.5:1,fontWeight:"bold"},children:[t.jsx(xn,{size:12,style:{animation:p?"spin 1s linear infinite":"none"}}),"REFRESH"]}),t.jsx("button",{onClick:()=>r("marketplace"),style:{backgroundColor:e==="marketplace"?w:"transparent",color:e==="marketplace"?"black":y,border:`1px solid ${e==="marketplace"?w:j}`,padding:"6px 12px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:"MARKETPLACE"}),t.jsxs("button",{onClick:()=>r("installed"),style:{backgroundColor:e==="installed"?w:"transparent",color:e==="installed"?"black":y,border:`1px solid ${e==="installed"?w:j}`,padding:"6px 12px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",fontWeight:"bold"},children:["MY SERVERS (",n.length,")"]}),t.jsxs("button",{onClick:()=>d(!0),style:{backgroundColor:k,color:"black",border:"none",padding:"6px 12px",fontSize:"10px",fontWeight:"bold",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(wn,{size:12}),"CUSTOM"]})]})]}),e==="installed"&&n.length>0&&t.jsxs("div",{style:{position:"relative"},children:[t.jsx(Ho,{size:14,style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",color:C}}),t.jsx("input",{type:"text",placeholder:"Search installed servers...",value:m,onChange:oe=>b(oe.target.value),style:{width:"100%",backgroundColor:T,border:`1px solid ${j}`,color:y,padding:"8px 12px 8px 36px",fontSize:"11px",borderRadius:"4px",outline:"none"}})]})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"16px",scrollbarWidth:"none",msOverflowStyle:"none"},children:[t.jsx("style",{children:`
          div::-webkit-scrollbar {
            display: none;
          }
          @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
          }
        `}),e==="marketplace"?t.jsx(WK,{onInstall:I,installedServers:n}):t.jsx("div",{children:D.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:C},children:[t.jsx(si,{size:48,style:{marginBottom:"16px",opacity:.3,color:w}}),t.jsx("h3",{style:{fontSize:"14px",marginBottom:"8px",color:y},children:m?"No servers found":"No MCP servers installed"}),t.jsx("p",{style:{fontSize:"11px",marginBottom:"16px"},children:m?"Try a different search term":"Install your first MCP server from the marketplace"}),!m&&t.jsx("button",{onClick:()=>r("marketplace"),style:{backgroundColor:w,color:"black",border:"none",padding:"8px 16px",fontSize:"11px",cursor:"pointer",borderRadius:"4px",fontWeight:"bold"},children:"BROWSE MARKETPLACE"})]}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:"16px"},children:D.map(oe=>{const Z=Go.getServerHealthInfo(oe.id);return t.jsxs("div",{style:{backgroundColor:E,border:`1px solid ${j}`,borderRadius:"6px",padding:"16px",transition:"all 0.2s"},onMouseEnter:fe=>{fe.currentTarget.style.borderColor=w,fe.currentTarget.style.boxShadow=`0 0 12px ${w}40`},onMouseLeave:fe=>{fe.currentTarget.style.borderColor=j,fe.currentTarget.style.boxShadow="none"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",marginBottom:"12px"},children:[t.jsx("span",{style:{fontSize:"28px"},children:oe.icon}),t.jsxs("div",{style:{flex:1},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[t.jsx("h3",{style:{color:y,fontSize:"13px",fontWeight:"bold"},children:oe.name}),z(oe.status)]}),t.jsx("div",{style:{display:"inline-block",backgroundColor:`${$(oe.status)}20`,color:$(oe.status),padding:"2px 8px",fontSize:"9px",borderRadius:"3px",textTransform:"uppercase",fontWeight:"bold"},children:oe.status})]})]}),t.jsx("p",{style:{color:C,fontSize:"10px",lineHeight:"1.5",marginBottom:"12px"},children:oe.description}),t.jsxs("div",{style:{display:"flex",gap:"16px",marginBottom:"12px",fontSize:"10px",color:C},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:y,fontWeight:"bold"},children:oe.toolCount})," tools"]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:y,fontWeight:"bold"},children:oe.callsToday})," calls today"]}),oe.auto_start&&t.jsxs("div",{style:{color:k},children:[t.jsx(si,{size:10,style:{display:"inline",marginRight:"4px"}}),"Auto-start"]})]}),Z&&Z.errorCount>0&&t.jsxs("div",{style:{padding:"8px",backgroundColor:`${A}20`,border:`1px solid ${A}`,borderRadius:"4px",fontSize:"9px",color:A,marginBottom:"12px"},children:[t.jsxs("strong",{children:["Errors: ",Z.errorCount]}),Z.lastError&&t.jsx("div",{style:{marginTop:"4px"},children:Z.lastError})]}),t.jsxs("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:[oe.status==="running"?t.jsxs("button",{onClick:()=>G(oe.id),style:{backgroundColor:"transparent",color:R,border:`1px solid ${R}`,padding:"6px 10px",fontSize:"9px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px",fontWeight:"bold"},children:[t.jsx(xc,{size:10}),"STOP"]}):t.jsxs("button",{onClick:()=>O(oe.id),style:{backgroundColor:"transparent",color:k,border:`1px solid ${k}`,padding:"6px 10px",fontSize:"9px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px",fontWeight:"bold"},children:[t.jsx(Ms,{size:10}),"START"]}),t.jsxs("button",{onClick:()=>F(oe.id,!oe.auto_start),style:{backgroundColor:"transparent",color:oe.auto_start?w:C,border:`1px solid ${oe.auto_start?w:"#404040"}`,padding:"6px 10px",fontSize:"9px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px",fontWeight:"bold"},children:[t.jsx(si,{size:10}),"AUTO"]}),t.jsxs("button",{onClick:()=>B(oe.id),style:{backgroundColor:"transparent",color:A,border:`1px solid ${A}`,padding:"6px 10px",fontSize:"9px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px",fontWeight:"bold"},children:[t.jsx(On,{size:10}),"REMOVE"]})]})]},oe.id)})})})]}),t.jsxs("div",{style:{height:"120px",borderTop:`1px solid ${j}`,backgroundColor:E,overflow:"auto",padding:"12px 16px",flexShrink:0,scrollbarWidth:"none",msOverflowStyle:"none"},children:[t.jsxs("div",{style:{color:w,fontSize:"11px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"0.5px"},children:["AVAILABLE TOOLS (",o.length,")"]}),o.length===0?t.jsx("div",{style:{color:C,fontSize:"10px",textAlign:"center",padding:"20px"},children:"No tools available. Start an MCP server to see its tools."}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"8px"},children:o.map(oe=>t.jsxs("div",{style:{backgroundColor:T,border:`1px solid ${j}`,padding:"6px 8px",fontSize:"9px",borderRadius:"3px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"2px"},children:[t.jsx(Mn,{size:10,style:{color:w}}),t.jsx("span",{style:{color:y,fontWeight:"bold"},children:oe.name})]}),oe.description&&t.jsxs("div",{style:{color:C,fontSize:"8px",marginLeft:"16px"},children:[oe.description.substring(0,50),oe.description.length>50?"...":""]})]},oe.id))})]}),t.jsxs("div",{style:{backgroundColor:T,borderTop:`1px solid ${j}`,padding:"6px 16px",fontSize:"9px",color:C,flexShrink:0,display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:w},children:""}),h]}),l&&t.jsx(qK,{onClose:()=>d(!1),onAdd:oe=>{I(oe),d(!1)}})]})},Wt={API:"https://api.fyers.in/api/v2",SYNC_API:"https://api-t1.fyers.in/api/v3",data_Api:"https://api.fyers.in/data-rest/v2",data_Api1:"https://api-t1.fyers.in/data",HSM_SOCKET:"wss://socket.fyers.in/hsm/v1-5/prod",Order_SOCKET:"wss://socket.fyers.in/trade/v3",get_profile:"/profile",tradebook:"/tradebook",positions:"/positions",holdings:"/holdings",convertPosition:"/positions",funds:"/funds",gtt_orders_sync:"/gtt/orders/sync",gtt_orders:"/gtt/orders",orders:"/orders",orders_sync:"/orders/sync",orderStatus:"/order-status",marketStatus:"/marketStatus",auth:"/generate-authcode",generateAccessToken:"/validate-authcode",exitPositions:"/positions",multi_orders:"/multi-order/sync",history:"/history",quotes:"/quotes",market_depth:"/depth",optionChain:"/options-chain-v3",logout:"/logout"};var ac;class KO{constructor(e){hE(this,ac,{s:"error",code:500,message:"Genric Error"});this.errorObject=e}getError(){return this.errorObject&&this.errorObject.response&&this.errorObject.response.data?this.errorObject.response.data:this.errorObject&&this.errorObject.code==="ENOTFOUND"?this.setError(this.errorObject.errno,this.errorObject.code):this.errorObject.code?this.setError(null,this.errorObject.code):this.errorObject?this.setError(null,this.errorObject):Fu(this,ac)}setError(e,r){return e&&(Fu(this,ac).code=e),r&&(Fu(this,ac).message=r),Fu(this,ac)}}ac=new WeakMap;const mn=KO;class YK{constructor(e){Pe(this,"setAppId",function(e){this.AppID=e});Pe(this,"setRedirectUrl",function(e){this.RedirectURL=e});Pe(this,"setAccessToken",function(e){this.AppID==null?console.log("Please set APPID using setAppId function"):this.AccessToken=this.AppID+":"+e});Pe(this,"generateAuthCode",function(e){var r="generateAuthCode";const n=e&&e.client_id||this.AppID,i=e&&e.redirect_uri||this.RedirectURL,o=e&&e.state||"sample_state";return console.log("generate authcode response",`${Wt.API}generate-authcode?client_id=${n}&redirect_uri=${i}&response_type=code&state=${o}`,r),`${Wt.SYNC_API}/generate-authcode?client_id=${n}&redirect_uri=${i}&response_type=code&state=${o}`});Pe(this,"generate_access_token",async e=>{var r="generateAuthCode";const n=e.code_verifier||"",i=e.auth_code||"",o=e.client_id||this.AppID,a=e.secret_key||"",l=await KK(`${o}:${a}`);console.log("generate_access_token inputs",{code_verifier:n,auth_code:i,client_id:o,secret_key:a,sha256:l},r);try{return n===""?(await er.post(`${Wt.SYNC_API}/validate-authcode`,{grant_type:"authorization_code",code:e.auth_code,appIdHash:l})).data:(await er.post(`${Wt.API}/validate-authcode`,{grant_type:"authorization_code",code_verifier:e.code_verifier,code:e.auth_code})).data}catch(p){var d=new mn(p).getError();return console.log("error generating access token",d,r),d}});Pe(this,"get_profile",async e=>{var r="get_profile";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.get_profile;console.log(a),await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"get_funds",async e=>{var r="get_funds";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.funds;await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"get_holdings",async e=>{var r="get_holdings";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.holdings;await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"logout_user",async e=>{var r="logout_user";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.logout;await er.post(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"get_orders",async e=>{var r="get_orders";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.orders;await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"get_gtt_orders",async e=>{var r="get_gtt_orders";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.gtt_orders;await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"get_filtered_orders",async e=>{var r="get_filtered_orders";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.orders+`?id=${e.order_id}`;await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"get_positions",async e=>{var r="get_positions";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.positions;await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"get_tradebook",async e=>{var r="get_tradebook";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.tradebook;await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"place_order",async e=>{var r="place_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.orders_sync;await er.post(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"place_gtt_order",async e=>{var r="place_gtt_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.gtt_orders_sync;await er.post(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"place_multi_order",async e=>{var r="place_multi_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.multi_orders;await er.post(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"modify_order",async e=>{var r="modify_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.orders_sync;await er.patch(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"modify_gtt_order",async e=>{var r="modify_gtt_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.gtt_orders_sync;await er.patch(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"modify_multi_order",async e=>{var r="modify_multi_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.multi_orders;await er.patch(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"cancel_order",async e=>{var r="cancel_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.orders_sync;await er.delete(a,{headers:{Authorization:n},data:e}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"cancel_gtt_order",async e=>{var r="cancel_gtt_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.gtt_orders_sync;await er.delete(a,{headers:{Authorization:n},data:e}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"cancel_multi_order",async e=>{var r="cancel_multi_order";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.multi_orders;await er.delete(a,{headers:{Authorization:n},data:e}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"exit_position",async e=>{var r="exit_position";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.positions;await er.delete(a,{headers:{Authorization:n},data:e}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"convert_position",async e=>{var r="convert_position";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.SYNC_API+Wt.positions;await er.post(a,e,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"market_status",async e=>{var r="market_status";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.data_Api1+Wt.marketStatus;const d=await er.get(a,{headers:{Authorization:n}}).then(p=>{console.log(`${r} response`,p.data,r),i(p.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,l,r),o(l)}})});Pe(this,"getHistory",async e=>{var r="getHistory";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.data_Api1+Wt.history;a=jk(a,e),await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});Pe(this,"getQuotes",async e=>{var r="getQuotes";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.data_Api1+Wt.quotes,l="";e.forEach(function(h){l=l+h+","}),l=l.slice(0,-1);var d={symbols:l};const f=new URLSearchParams(d);a=a+"?"+f,await er.get(a,{headers:{Authorization:n}}).then(h=>{console.log(`${r} response`,h.data,r),i(h.data)})}catch(f){var p=new mn(f).getError();console.log(`${r} response`,{Error:p,inputs:e},r),o(p)}})});Pe(this,"getMarketDepth",async e=>{var r="getQuotes";let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.data_Api1+Wt.market_depth,l="";e.symbol.forEach(function(h){l=l+h+","}),l=l.slice(0,-1);var d={symbol:l,ohlcv_flag:e.ohlcv_flag};const f=new URLSearchParams(d);a=a+"?"+f,await er.get(a,{headers:{Authorization:n}}).then(h=>{console.log(`${r} response`,h.data,r),i(h.data)})}catch(f){var p=new mn(f).getError();console.log(`${r} response`,{Error:p,inputs:e},r),o(p)}})});Pe(this,"getOptionChain",async e=>{var r="getOptionChain";this.Logger;let n=this.AccessToken;return this.Version,new Promise(async function(i,o){try{var a=Wt.data_Api1+Wt.optionChain;a=jk(a,e),await er.get(a,{headers:{Authorization:n}}).then(d=>{console.log(`${r} response`,d.data,r),i(d.data)})}catch(d){var l=new mn(d).getError();console.log(`${r} response`,{Error:l,inputs:e},r),o(l)}})});var r=this;r.AccessToken=e?.AccessToken??null,r.RedirectURL=e?.RedirectURL??null,r.AppID=e?.AppID??null,r.Version=e?.Version??"2.0",r.LogPath=e?.path??void 0,r.LoggingFlag=e?.enableLogging??!0}}function jk(s,e){let r=new URLSearchParams;for(let n in e)r.append(n,e[n]);return`${s}?${r.toString()}`}async function KK(s){const r=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(n)).map(a=>a.toString(16).padStart(2,"0")).join("")}const VK={client_id:"clientId",id:"id",id_parent:"parentId",id_exchange:"exchOrdId",qty:"qty",qty_remaining:"remainingQuantity",qty_filled:"filledQty",price_limit:"limitPrice",price_stop:"stopPrice",price_traded:"tradedPrice",ord_type:"type",fy_token:"fyToken",exchange:"exchange",segment:"segment",symbol:"symbol",instrument:"instrument",oms_msg:"message",offline_flag:"offlineOrder",time_oms:"orderDateTime",validity:"orderValidity",product_type:"productType",tran_side:"side",ord_status:"status",ord_source:"source",symbol_exch:"ex_sym",symbol_desc:"description",ordertag:"orderTag"},XK={symbol:"symbol",id:"id",buy_avg:"buyAvg",buy_qty:"buyQty",buy_val:"buyVal",sell_avg:"sellAvg",sell_qty:"sellQty",sell_val:"sellVal",net_avg:"netAvg",net_qty:"netQty",tran_side:"side",qty:"qty",product_type:"productType",pl_realized:"realized_profit",rbirefrate:"rbiRefRate",fy_token:"fyToken",exchange:"exchange",segment:"segment",day_buy_qty:"dayBuyQty",day_sell_qty:"daySellQty",cf_buy_qty:"cfBuyQty",cf_sell_qty:"cfSellQty",qty_multiplier:"qtyMulti_com",pl_total:"pl",cross_curr_flag:"crossCurrency",pl_unrealized:"unrealized_profit"},JK={id_fill:"tradeNumber",id:"orderNumber",qty_traded:"tradedQty",price_traded:"tradePrice",traded_val:"tradeValue",product_type:"productType",client_id:"clientId",id_exchange:"exchangeOrderNo",ord_type:"orderType",tran_side:"side",symbol:"symbol",fill_time:"orderDateTime",fy_token:"fyToken",exchange:"exchange",segment:"segment",ordertag:"orderTag"},w0={orders:VK,position:XK,tradebook:JK};var ya=0;const QK={11:4,12:4,20:4,21:4,22:6,23:6,24:6,25:6,26:6,90:2,91:1,92:5,93:5,94:5,51:6,52:6,53:6,54:6,55:6,61:6,62:6,63:6,64:6,71:6,72:6,73:1};function E0(s,e){const r={};for(const n of Object.keys(e))s.hasOwnProperty(n)&&(r[e[n]]=s[n]);return r}class ZK{constructor(e,r=void 0,n=!0){this.url=Wt.Order_SOCKET,this.authorizationKey=e,this.ws=null,this.onErrorCallback=null,this.onCloseCallback=null,this.onMessageCallback=null,this.onOpenCallback=null,this.orderscallback=null,this.LogPath=r,this.positionscallback=null,this.tradescallback=null,this.isPingEnabled=!0,this.pingInterval=null,this.autoreconnectinterval=null,this.orderUpdates="orders",this.tradeUpdates="trades",this.positionUpdates="positions",this.edis="edis",this.pricealerts="pricealerts",this.isUserClosed=!1,this.autoreconnectflag=!1,this.maxreconnectiontries=0}connect(){const e="connect";try{var r=btoa(this.authorizationKey);r=encodeURIComponent(r),this.ws=new WebSocket(this.url,[r]),console.log(this.url),this.ws.binaryType="arraybuffer",this.ws.addEventListener("error",n=>{this.onErrorCallback?this.onErrorCallback(n):console.log("error occoured",n)}),this.ws.addEventListener("close",n=>{this.stopPing(),this.onCloseCallback?this.onCloseCallback(n):(console.log("ws closed",n),!this.isUserClosed&&ya<this.maxreconnectiontries&&this._autoreconnect())}),this.ws.addEventListener("message",n=>{const i=n.data;if(i!=="pong"){var o=JSON.parse(i);if(o.hasOwnProperty("orders")){var a=E0(o.orders,w0.orders);a.status=QK[a.status],a.orderNumStatus=a.id+":"+a.status,this.orderscallback?this.orderscallback({s:"ok",orders:a}):console.log("Orders_internal",{s:"ok",orders:a})}else if(o.hasOwnProperty("positions")){var l=E0(o.positions,w0.position);this.positionscallback?this.positionscallback({s:"ok",positions:l}):console.log("positions_internal",{s:"ok",positions:l})}else if(o.hasOwnProperty("trades")){var d=E0(o.trades,w0.tradebook);this.tradescallback?this.tradescallback({s:"ok",trades:d}):console.log("trades_internal",{s:"ok",trades:d})}else this.onMessageCallback?this.onMessageCallback(o):console.log("message_internal",o)}}),this.ws.addEventListener("open",()=>{ya=0,this.onOpenCallback?this.onOpenCallback():console.log("connected"),this.isPingEnabled&&this.startPing()})}catch(n){console.log(`Error occured ${e}: ${n}`),console.error("unexpected error on connect function",n,e)}}on(e,r){try{if(e==="error")this.onErrorCallback=r;else if(e==="general")this.onMessageCallback=r;else if(e==="connect")this.onOpenCallback=r;else if(e==="close"){const i=function(o){r(o),!this.isUserClosed&&ya<this.maxreconnectiontries&&this._autoreconnect()};this.onCloseCallback=i}else e==="orders"?this.orderscallback=r:e==="trades"?this.tradescallback=r:e==="positions"?this.positionscallback=r:(console.log("incorrect value passed",e),console.error("wrong onwhat passed",{onwhat:e},"on"))}catch(i){console.error("unexpected error on 'on' function",i,"on")}}isConnected(){return this.ws&&this.ws.readyState===WebSocket.OPEN}startPing(){this.pingInterval=setInterval(()=>{this.isConnected()&&this.ws.send("ping")},1e3)}stopPing(){clearInterval(this.pingInterval)}subscribe(e){const r="subscribe";try{this.isConnected()?(console.debug("trying to subscribe to",{towhat:e},r),e.constructor===Array?this.ws.send(JSON.stringify({T:"SUB_ORD",SLIST:e,SUB_T:1})):this.ws.send(JSON.stringify({T:"SUB_ORD",SLIST:[e],SUB_T:1}))):(console.error("websocket is not connected",{towhat:e},r),console.log("Cannot send message. WebSocket is not connected."))}catch(n){console.error("unexpected error on subscribe function",n,r)}}unsubscribe(e){const r="unsubscribe";try{this.isConnected()?e.constructor===Array?(console.debug("trying to unsubscribe to",{towhat:e},r),this.ws.send(JSON.stringify({T:"SUB_ORD",SLIST:e,SUB_T:-1}))):this.ws.send(JSON.stringify({T:"SUB_ORD",SLIST:[e],SUB_T:-1})):console.error("websocket is not connected",{towhat:e},r)}catch(n){console.error("unexpected error on unsubscribe function",n,r)}}close(){this.ws&&this.isConnected&&(clearInterval(this.autoreconnectinterval),this.stopPing(),this.ws.close(),this.isUserClosed=!0)}_autoreconnect(){if(this.autoreconnectflag){var e=Math.floor((ya+5)/5);e*=5,this.autoreconnectinterval=setTimeout(()=>{!this.isConnected()&&ya<this.maxreconnectiontries?(console.log("trying to reconnect ",ya+1),ya++,this.connect()):ya>=this.maxreconnectiontries&&(console.log("max autoconnect tries exceeded"),clearInterval(this.autoreconnectinterval),this.stopPing(),ya=0)},e*1e3)}}autoreconnect(e=5){this.autoreconnectflag=!0,this.maxreconnectiontries=e>50?50:e}}const Ig=window.WebSocket||window.MozWebSocket,ct=Lg;(function(s,e){const r=Lg,n=s();for(;;)try{if(-parseInt(r(431))/1+-parseInt(r(242))/2*(parseInt(r(241))/3)+-parseInt(r(479))/4+-parseInt(r(260))/5*(-parseInt(r(363))/6)+-parseInt(r(258))/7+parseInt(r(532))/8*(-parseInt(r(551))/9)+parseInt(r(417))/10===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(zg,735541);class es{constructor(){}}es[ct(494)]=ct(463),es[ct(347)]=30,es.isSingleLib=!0,es[ct(399)]=!1,es[ct(429)]=!1,es[ct(231)]=1500,es[ct(255)]=-2147483648,es[ct(423)]=!0,es[ct(451)]=1,es.INDEX_LITE_FCOUNT=1;class Ur{constructor(){}static[ct(436)](e){const r=ct;es[r(399)]&&console[r(330)](e)}static[ct(541)](e){const r=ct;es[r(429)]&&console[r(330)](e)}}var Mt;(function(s){const e=ct;s[e(434)]=e(351),s[e(307)]=e(477),s[e(251)]="msg",s[e(481)]=e(382),s[e(336)]=e(443)})(Mt||(Mt={}));var Ws;(function(s){const e=ct;s[e(470)]=e(341),s.FAILED=e(299),s[e(549)]=e(348),s[e(298)]="--"})(Ws||(Ws={}));var Pg;(function(s){const e=ct;s[s.LITE=76]=e(492),s[s[e(475)]=70]=e(475)})(Pg||(Pg={}));var yd;(function(s){const e=ct;s[s[e(250)]=83]=e(250),s[s[e(332)]=85]=e(332),s[s.LITE=76]=e(492)})(yd||(yd={}));var Ds;(function(s){s.OK="K",s.NOT_OK="N"})(Ds||(Ds={}));var Is;(function(s){const e=ct;s.OK="Ok",s[e(373)]=e(395)})(Is||(Is={}));var El;(function(s){s.SCRIP="sf",s.INDEX="if",s.DEPTH="dp"})(El||(El={}));var fn;(function(s){const e=ct;s[e(307)]="type",s.USER_ID="user",s[e(439)]=e(438),s[e(529)]=e(493),s[e(413)]=e(544),s[e(327)]=e(256),s[e(402)]=e(495),s[e(285)]="redis",s[e(396)]=e(240),s[e(342)]=e(460),s[e(388)]=e(513),s.OPC_KEY="key",s[e(456)]=e(257),s.SID="Sid",s[e(411)]="x-access-token",s[e(527)]=e(469)})(fn||(fn={}));var In;(function(s){const e=ct;s.CONNECTION="cn",s[e(244)]=e(322),s[e(412)]=e(227),s[e(487)]=e(312),s[e(524)]=e(308),s[e(516)]=e(528),s.DEPTH_UNSUBS=e(468),s.CHANNEL_RESUME="cr",s[e(364)]="cp",s.SNAP_MW=e(270),s[e(287)]=e(310),s[e(447)]=e(449),s[e(534)]=e(290),s.LITE=e(361),s[e(475)]=e(386),s[e(315)]="ti",s[e(496)]=e(253),s[e(548)]=e(505),s.LOG="log"})(In||(In={}));var Dn;(function(s){const e=ct;s[e(367)]="cn",s[e(340)]=e(318),s[e(248)]="unsub",s[e(250)]=e(515),s[e(272)]="cr",s[e(229)]="cp",s[e(488)]=e(290),s[e(492)]="lit",s[e(475)]=e(386)})(Dn||(Dn={}));var Sr;(function(s){const e=ct;s[s.CONNECTION_TYPE=1]=e(448),s[s[e(546)]=2]="THROTTLING_TYPE",s[s[e(484)]=3]="ACK_TYPE",s[s[e(252)]=4]="SUBSCRIBE_TYPE",s[s.UNSUBSCRIBE_TYPE=5]=e(309),s[s[e(236)]=6]=e(236),s[s[e(297)]=7]=e(297),s[s.CHRESUME_TYPE=8]="CHRESUME_TYPE",s[s[e(371)]=9]=e(371),s[s[e(405)]=10]=e(405),s[s[e(522)]=12]="LITE_FULL"})(Sr||(Sr={}));var Ps;(function(s){const e=ct;s[s[e(466)]=200]=e(466),s[s.CONNECTION_FAILED=11001]=e(291),s[s[e(234)]=11002]="CONNECTION_INVALID",s[s[e(418)]=11011]=e(418),s[s[e(385)]=11012]=e(385),s[s.SNAPSHOT_FAILED=11013]="SNAPSHOT_FAILED",s[s.CHANNELP_FAILED=11031]="CHANNELP_FAILED",s[s[e(278)]=11032]=e(278)})(Ps||(Ps={}));var So;(function(s){const e=ct;s[e(292)]="dp",s[e(369)]="sf",s[e(552)]="if"})(So||(So={}));function Lg(s,e){const r=zg();return Lg=function(n,i){return n=n-227,r[n]},Lg(s,e)}var ro;(function(s){const e=ct;s[e(232)]=e(362),s[e(503)]=e(269),s.TURNOVER=e(376),s[e(352)]="s104",s[e(419)]=e(422),s[e(464)]=e(343),s[e(281)]=e(432)})(ro||(ro={}));var yl;(function(s){const e=ct;s[s[e(262)]=0]=e(262),s[s[e(394)]=1]=e(394),s[s.DATE=2]=e(489),s[s[e(427)]=3]=e(427)})(yl||(yl={}));var gl;(function(s){const e=ct;s.LTP="i102",s[e(464)]=e(293),s[e(232)]=e(337),s[e(503)]=e(319)})(gl||(gl={}));var kk;(function(s){const e=ct;s[s[e(352)]=1]=e(352),s[s[e(419)]=0]=e(419),s[s[e(464)]=20]=e(464),s[s[e(281)]=11]="VWAP",s[s.CHANGE=21]=e(232),s[s.PERCHANGE=22]=e(360),s[s[e(537)]=23]=e(537)})(kk||(kk={}));var Ak;(function(s){const e=ct;s[s[e(419)]=0]="LTP",s[s[e(464)]=1]=e(464),s[s.CHANGE=6]=e(232),s[s.PERCHANGE=7]=e(360)})(Ak||(Ak={}));class Bo{constructor(e){const r=ct;this[r(440)]=new Uint8Array(e),this[r(326)]=2}[ct(377)](){const e=ct;this[e(326)]=0}[ct(471)](){return this[ct(326)]}[ct(387)](){const e=ct;let r=this[e(326)]-2;return this.data[0]=r>>8&255,this[e(440)][1]=r&255,this[e(440)]}[ct(501)](e,r){const n=ct;r==null?this[n(440)][this[n(326)]++]=e:this[n(440)][r]=e}[ct(392)](e,r){const n=ct;r==null?this.data[this.pos++]=e:this[n(440)][r]=e}appendShort(e){const r=ct;this.data[this[r(326)]++]=e>>8&255,this[r(440)][this[r(326)]++]=e&255}appendInt(e){const r=ct;this[r(440)][this[r(326)]++]=e>>24&255,this[r(440)][this.pos++]=e>>16&255,this[r(440)][this[r(326)]++]=e>>8&255,this[r(440)][this[r(326)]++]=e&255}appendLong(e){const r=ct;this.data[this[r(326)]++]=e>>56&255,this[r(440)][this[r(326)]++]=e>>48&255,this.data[this[r(326)]++]=e>>40&255,this[r(440)][this[r(326)]++]=e>>32&255,this.data[this.pos++]=e>>24&255,this.data[this[r(326)]++]=e>>16&255,this[r(440)][this[r(326)]++]=e>>8&255,this.data[this.pos++]=e&255}[ct(490)](e){const r=ct,n=BigInt(e);this[r(440)][this.pos++]=Number(n>>BigInt(56)&BigInt(255)),this[r(440)][this[r(326)]++]=Number(n>>BigInt(48)&BigInt(255)),this[r(440)][this[r(326)]++]=Number(n>>BigInt(40)&BigInt(255)),this.data[this[r(326)]++]=Number(n>>BigInt(32)&BigInt(255)),this[r(440)][this[r(326)]++]=Number(n>>BigInt(24)&BigInt(255)),this[r(440)][this.pos++]=Number(n>>BigInt(16)&BigInt(255)),this[r(440)][this[r(326)]++]=Number(n>>BigInt(8)&BigInt(255)),this[r(440)][this[r(326)]++]=Number(n&BigInt(255))}[ct(539)](e){const r=ct;for(let n=0;n<e[r(491)];n++)this.data[this[r(326)]++]=e[r(536)](n)}[ct(540)](e,r){const n=ct;let i=r??e.length;for(let o=0;o<i;o++)this[n(440)][this[n(326)]++]=e[o]}}class C0{constructor(e,r,n,i){const o=ct;this.fId=e,this[o(313)]=r,this[o(477)]=n,this.desc=i}}function zg(){const s=["CLOSE","keys","SUCCESS","pow","dpu","source","SUCCESSFUL","getPosition","hsParser","error","setMultiplierAndPrec","FULL","CHANGE_INDEX","type",`
Depth::`,"959580FzxuGw","Maximum scrips allowed per request is ","STAT_CODE","open","^(0{1}[1-9]|[12][0-9]|3[01])/(0{1}[1-9]|1[012])/20\\d{2}$","ACK_TYPE","LTP_INDEX","onclose","INDEX_SUBS","OPC","DATE","appendLongAsBigInt","length","LITE","scrips","LIB_VERSION","jwt","STR","packets.length: ","Connect...","getMinutes","index:","appendByte","index","PCHANGE","User call","fcn","intervalId","liteFCount","getOpChainSubsRequest",", val:","fcount1: ","toString","strJson","lowstk","Cleanup previous connection","snap","DEPTH_SUBS","onerror","WebSocket not initialized!","Number","pingFunction","onopen","LITE_FULL","pingRequest","INDEX_UNSUBS","isScripOK","exchange","SOURCE","dps","SCRIPS","setStringValues","reason","11202584HMSZis","USER_ID","OPC_SUBS","prec: ","charCodeAt","TURNOVER","get","appendString","appendByteArray","hsiDebug","setLongValues","appendInt","channelnum","PER_CHANGE_INDEX","THROTTLING_TYPE","_instance","FORCE_CONNECTION","INVD_FLD_COUNT","Invalid topic feed type !","9bqPKtU","INDEX","mwu","buf2Long","CHANNELP","onClose::CloseCode:","MAX_SCRIPS","CHANGE","OPEN","CONNECTION_INVALID","prepareChannelRequest","DATA_TYPE",", WasClean:","Authorization mode is enabled: Authorization or Sid not found !","Conn fCount:","stkprc","3ONZxdx","2003872xLZkzX","set","SCRIP_SUBS","createMapingsMap","prepareJson","counter","UNSUBS","prepareSubsUnSubsRequest","SNAP","MSG","SUBSCRIBE_TYPE","str","hfid","TRASH_VAL","channelnums","Authorization","9666909hTbaBb","Topic Not Available in TopicList!","24615wCosJU","JS_API","FLOAT32","scrip","interval","prepareLiteChannelRequest","prepareConnectionRequest","FAILED","Unable to send request !, Reason: Connection faulty or request not valid !","f102","mwsp","topic Id: ","CHANNELR","CLOSE_INDEX","subscription failed","TURNOVER_INDEX","Invalid conn mode !","Processing dynamic mapping....","CHANNELR_FAILED","heartBeatIntervalInMS","onOpen","VWAP","getHours","updates ......","SID","REDIS_KEY","push","SNAP_DP","prepareData","Open","opc","CONNECTION_FAILED","DEPTH","i103","onMessage","getMonth","inWS","CHPAUSE_TYPE","NOT_AVL","failed","substring","startPingInterval","Error: Channel values must be in this range  [ val > 0 && val < 65 ]","getAcknowledgementReq","sendJsonArrResp",", Reason:","parseData","TYPE","ifu","UNSUBSCRIBE_TYPE","dpsp","LOG","ifs","key","onClose","THROTTLING_INTERVAL","appendShort","readyState","sub","f105","getKey","ConvNumber","mws",`
Scrip::`,"getFormatDate2","VOLUME_INDEX","pos","CHANNEL_NUMS","DEPTH_UNSUBS","index_lite","log","INDEX_LITE_FCOUNT","UPDATE","multiplier","leadingZero","feedType","STREAM_DATA_CONFIG","f104","slice","concat","SUBS","successful","HIGH_STK","s121","onError::MSG:","forEach","isConnected","DEFAULT_HEARTBEAT_INTERVAL","invalid field count","buf2String","reqData","stat","VOLUME","getSeconds","precisionValue","fid","fld","fieldDataArray","mappingArray","CHANNELP_FAILED","PERCHANGE","lit","f101","1422IYHOsj","CHANNEL_PAUSE","tSymbol","Invalid Request !","CONN","HSI WebSocket not initialized!","SCRIP","onError","SNAPSHOT","url","NOT_OK","details","precision","f103","clear","binaryType","hsiWs","stringify","send","stCode","prepareConnectionRequestOld","VWAP_INDEX","UNSUBSCRIPTION_FAILED","ful","getBytes","LOW_STK","getInstance","getStringFieldsJson","topicList","appendChar",`
Index::`,"LONG","NotOk","STK_PRC","connect","blob","HSM_LOG_Flag","wasClean","setSeconds","JWT","ACK: ","test","OPC_SUBSCRIBE","updatedFieldsArray","getScripByteArray","topicName: ","mode","OPC_KEY","X_ACCESS_TOKEN","SCRIP_UNSUBS","CHANNEL_NUM","getTypeFromString","nameLen:","split","41870370zawcKr","SUBSCRIPTION_FAILED","LTP","stopHearBeat","prepareConnectionRequest2","s105","STREAM_DATA_ENABLED","dataType","code","Invalid ResponseType: ","STRING","heartBeatInterval","HSI_LOG_Flag","fields","595106LHGUnP","s113","onmessage","STATUS","StreamDataJson having some issue","hsmDebug","timestamp","sessionid","SESSION_ID","data","getStatus","toFixed","streamDataConfig","CONNECTION","ackNum","isCalled","SNAP_IF","CONNECTION_TYPE","ifsp","hsWS","SCRIP_LITE_FCOUNT","indexOf","getDate","getFormatDate","parse","AUTORIZATION","close","TYPE:: ","symbol","highstk","arraybuffer","prepareSnapshotRequest","v1.5-ft-5.3.0"];return zg=function(){return s},zg()}class Rv{constructor(e){const r=ct;this[r(333)]=1,this[r(375)]=2,this[r(354)]=100,this[r(357)]=new Array,this.updatedFieldsArray=new Array,this.liteFCount=-1,this[r(335)]=e}[ct(320)](){const e=ct;return this[e(526)][e(339)]("|",this[e(459)])}[ct(542)](e,r){const n=ct;this[n(357)][e]!=r&&r!=es[n(255)]&&(this[n(357)][e]=r,this[n(406)][e]=!0)}[ct(474)](e,r){const n=ct;this.precision=r,this.precisionValue=Math[n(467)](10,r),this[n(333)]=e}clearFieldDataArray(){const e=ct;this[e(357)].length=this[e(406)].length=0}[ct(530)](e,r){const n=ct;switch(e){case 0:this[n(526)]=r;break;case 1:this[n(459)]=r;break;case 2:this[n(365)]=r;break}}[ct(390)](){const e=ct;return this.strJson?this[e(512)]:(this.strJson={name:this[e(335)],tk:this.symbol,e:this.exchange},Object.assign({ts:this[e(365)]},this[e(512)]))}[ct(246)](e){const r=ct,n={};for(let i=0;i<e[r(491)];i++){let o=e[i],a=this[r(357)][i];this[r(406)][i]&&a!=null&&o&&(o[r(477)]==yl[r(262)]?a=(a/(this[r(333)]*this[r(354)])).toFixed(this[r(375)]):o[r(477)]==yl.DATE&&(a=Xt[r(454)](a)),Ur[r(436)](i+":"+o[r(313)]+":"+a[r(511)]()),n[o[r(313)]]=a[r(511)]())}return this[r(406)]=[],Object[r(465)](n)[r(491)]>0?Object.assign(n,this.getStringFieldsJson()):!1}}class vn extends Rv{constructor(){const e=ct;super(El[e(369)])}[ct(288)](){const e=ct;if(this.updatedFieldsArray[vn[e(485)]]||this[e(406)][vn[e(273)]]){let r=this[e(357)][vn.LTP_INDEX],n=this[e(357)][vn[e(273)]];if(r!=null&&n!=null){let i=r-n;this.fieldDataArray[vn.CHANGE_INDEX]=i,this[e(406)][vn[e(476)]]=!0,this[e(357)][vn[e(545)]]=+(i/n*100)[e(442)](this[e(375)]),this[e(406)][vn.PER_CHANGE_INDEX]=!0}}if(this[e(406)][vn.VOLUME_INDEX]||this.updatedFieldsArray[vn[e(384)]]){let r=this[e(357)][vn[e(325)]],n=this[e(357)][vn[e(384)]];r!=null&&n!=null&&(this.fieldDataArray[vn[e(275)]]=r*n,this.updatedFieldsArray[vn[e(275)]]=!0)}return Ur[e(436)](e(323)+this[e(335)]+"|"+this[e(526)]+"|"+this[e(459)]),super[e(246)](vn[e(358)])}}class Ls extends Rv{constructor(){super(El.INDEX)}[ct(288)](){const e=ct;if(this[e(406)][Ls[e(485)]]||this[e(406)][Ls[e(273)]]){let r=this[e(357)][Ls[e(485)]],n=this[e(357)][Ls[e(273)]];if(r!=null&&n!=null){let i=r-n;this[e(357)][Ls.CHANGE_INDEX]=i,this[e(406)][Ls.CHANGE_INDEX]=!0,this[e(357)][Ls[e(545)]]=+(i/n*100)[e(442)](this[e(375)]),this[e(406)][Ls[e(545)]]=!0}}return Ur[e(436)](e(393)+this.feedType+"|"+this[e(526)]+"|"+this[e(459)]),super[e(246)](Ls.mappingArray)}}class Ap extends Rv{constructor(){const e=ct;super(El[e(292)])}[ct(288)](){const e=ct;return Ur[e(436)](e(478)+this[e(335)]+"|"+this[e(526)]+"|"+this[e(459)]),super[e(246)](Ap[e(358)])}}class Xt{constructor(){}static[ct(228)](e){const r=ct;let n=new Uint8Array(e),i=0,o=n[r(491)];for(let a=0,l=o-1;a<o;a++,l--)i+=n[l]<<a*8;return i}static buf2Float(e,r){return new DataView(e,r,4).getFloat32(0)}static[ct(349)](e){return new TextDecoder("utf-8").decode(e)}static[ct(454)](e){const r=ct;let n=new Date(e*1e3);return Xt[r(334)](n[r(453)]())+"/"+Xt.leadingZero(n[r(295)]()+1)+"/"+n.getFullYear()+" "+Xt[r(334)](n.getHours())+":"+Xt[r(334)](n[r(499)]())+":"+Xt[r(334)](n[r(353)]())}static[ct(324)](e){const r=ct;let n=new Date(1970,0,1);return n[r(401)](e),Xt.leadingZero(n[r(453)]())+"/"+Xt[r(334)](n[r(295)]()+1)+"/"+n.getFullYear()+" "+Xt[r(334)](n[r(282)]())+":"+Xt[r(334)](n[r(499)]())+":"+Xt[r(334)](n.getSeconds())}static[ct(334)](e){const r=ct;return e<10?"0"+e.toString():e[r(511)]()}static[ct(525)](e){const r=ct;return e[r(416)]("&").length>es.MAX_SCRIPS?(console[r(473)](r(480)+es[r(231)]),!1):!0}static checkDateFormat(e){const r=ct;return new RegExp(r(483))[r(404)](e)}}class Pn{constructor(){}static getAcknowledgementReq(e){const r=ct;let n=new Bo(11);return n[r(501)](Sr[r(484)]),n[r(501)](1),n.appendByte(1),n[r(316)](4),n.appendInt(e),n.getBytes()}static[ct(383)](e){const r=ct;let n=e.length,i=r(261),o=i.length,a=new Bo(n+o+10);return a[r(501)](Sr.CONNECTION_TYPE),a.appendByte(2),a.appendByte(1),a[r(316)](n),a[r(539)](e),a[r(501)](2),a[r(316)](o),a[r(539)](i),a[r(387)]()}static prepareConnectionRequest(e,r){const n=ct;let i=e[n(491)],o=n(261),a=o[n(491)],l=new Bo(i+a+18);return l[n(501)](Sr[n(448)]),l[n(501)](4),l.appendByte(1),l.appendShort(i),l.appendString(e),l[n(501)](2),l[n(316)](1),l[n(501)](r.charCodeAt(0)),l.appendByte(3),l[n(316)](1),l[n(501)](es[n(423)]?1:0),l[n(501)](4),l[n(316)](a),l[n(539)](o),l.getBytes()}static[ct(421)](e,r){const n=ct;let i=n(261),o=i[n(491)],a=e[n(491)],l=r[n(491)],d=new Bo(o+a+l+13);return d[n(501)](Sr[n(448)]),d[n(501)](3),d.appendByte(1),d[n(316)](a),d[n(539)](e),d[n(501)](2),d.appendShort(l),d[n(539)](r),d[n(501)](3),d[n(316)](o),d[n(539)](i),d[n(387)]()}static[ct(249)](e,r,n,i){const o=ct;if(!Xt[o(525)](e))return null;let a=Pn.getScripByteArray(e,n),l=new Bo(a[o(491)]+11);return l.appendByte(r),l.appendByte(2),l[o(501)](1),l[o(316)](a[o(491)]),l.appendByteArray(a,a[o(491)]),l[o(501)](2),l[o(316)](1),l.appendByte(i),l[o(387)]()}static[ct(265)](e,r,n){const i=ct;let o=new Bo(19);o[i(501)](e),o.appendByte(2),o[i(501)](1),o[i(316)](8);let a=0,l=0;return n[i(345)](function(d){const p=i;d>0&&d<=32?a|=1<<d:d>32&&d<=64?l|=1<<d:console[p(473)]("Error: Channel values must be in this range  [ val > 0 && val < 65 ]")}),o.appendInt(l),o[i(543)](a),o[i(501)](2),o.appendShort(1),o.appendByte(r),o[i(387)]()}static[ct(235)](e,r){const n=ct;let i=new Bo(15);i[n(501)](e),i[n(501)](1),i[n(501)](1),i.appendShort(8);let o=0,a=0;return r[n(345)](function(l){const d=n;l>0&&l<=32?o|=1<<l:l>32&&l<=64?a|=1<<l:console.error(d(302))}),i.appendInt(a),i.appendInt(o),i[n(387)]()}static prepareSnapshotRequest(e,r,n){const i=ct;let o=Pn[i(407)](e,n),a=o[i(491)],l=new Bo(a+7);return l[i(501)](r),l[i(501)](1),l.appendByte(1),l[i(316)](a),l.appendByteArray(o,a),l[i(387)]()}static prepareThrottlingIntervalRequest(e){const r=ct;let n=new Bo(11);return n[r(501)](Sr[r(546)]),n[r(501)](1),n[r(501)](1),n[r(316)](4),n[r(543)](e),n[r(387)]()}static[ct(407)](e,r){const n=ct;e.charCodeAt(e[n(491)]-1)==38&&(e=e[n(300)](0,e.length-1));let i=e[n(416)]("&"),o=i[n(491)],a=0;for(let p=0;p<o;p++)i[p]=r+"|"+i[p],a+=i[p][n(491)]+1;let l=new Uint8Array(a+2),d=0;l[d++]=o>>8&255,l[d++]=o&255;for(let p=0;p<o;p++){let f=i[p],h=f[n(491)];l[d++]=h&255;for(let x=0;x<h;x++)l[d++]=f[n(536)](x)}return l}static[ct(508)](e,r,n,i,o){const a=ct;let l=e[a(491)],d=new Bo(l+30);return d[a(501)](Sr.OPC_SUBSCRIBE),d[a(501)](5),d.appendByte(1),d.appendShort(l),d[a(539)](e),d[a(501)](2),d[a(316)](8),d[a(490)](r),d.appendByte(3),d[a(316)](1),d.appendByte(n),d[a(501)](4),d.appendShort(1),d[a(501)](i),d.appendByte(5),d[a(316)](1),d[a(501)](o),d[a(387)]()}}Pn[ct(523)]=new Uint8Array([0,1,11]);class eV{constructor(){const e=ct;this[e(372)]=null,this.ws=null,this.hsParser=null,this[e(280)]=null,this.onClose=null,this[e(294)]=null,this.onError=null}[ct(457)](){const e=ct;this.ws&&(this.ws[e(457)](1e3,e(504)),this.ws=null)}[ct(346)](){const e=ct;return this.ws?this.ws[e(317)]==Ig.OPEN:!1}connect(e,r){const n=ct;Ur[n(436)](n(498)),this[n(372)]=e;let i=(r||es[n(347)])*1e3;if(this.ws&&(this.ws[n(521)]=o=>{},this.ws[n(433)]=o=>{},this.ws[n(486)]=o=>{},this.ws[n(517)]=o=>{},this.ws[n(457)](1e3,n(514))),this.ws=new Ig(e),this.ws)this.ws[n(378)]=n(461),this[n(472)]=new tV(this.ws,this,i);else{console[n(473)](n(518));return}this.ws.onopen=o=>{const a=n;Ur[a(436)](a(289)),this[a(280)]()},this.ws.onmessage=o=>{const a=n;let l=o.data;if(l instanceof ArrayBuffer){let d=this[a(472)][a(306)](l);d&&this[a(294)](JSON[a(380)](d))}else this[a(294)](l)},this.ws[n(486)]=o=>{const a=n;Ur[a(436)](a(230)+o[a(425)]+a(305)+o[a(531)]+a(237)+o[a(400)]),this[a(314)](o)},this.ws[n(517)]=o=>{const a=n;Ur[a(436)](a(344)+o),this[a(370)](o)}}[ct(381)](e){const r=ct;let n=JSON[r(455)](e);Ur[r(436)](n);let i=n[fn[r(307)]],o=null,a=n[fn[r(529)]],l=n[fn.CHANNEL_NUM],d=n[fn[r(327)]];switch(i){case In[r(444)]:let p=n[r(409)];if(n[fn[r(533)]]!==void 0&&p!==void 0){let f=n[fn.USER_ID];o=Pn[r(266)](f,p)}else if(n[fn[r(439)]]!==void 0&&p!==void 0){let f=n[fn[r(439)]];o=Pn[r(266)](f,p)}else if(n[fn[r(456)]]!==void 0){let f=n[fn[r(456)]],h=n[fn[r(284)]];f&&h?o=Pn[r(421)](f,h):console[r(473)](r(238))}else console[r(473)](r(276));break;case In.SCRIP_SUBS:o=Pn[r(249)](a,Sr[r(252)],So[r(369)],l);break;case In[r(412)]:o=Pn[r(249)](a,Sr.UNSUBSCRIBE_TYPE,So[r(369)],l);break;case In[r(487)]:o=Pn[r(249)](a,Sr[r(252)],So.INDEX,l);break;case In[r(524)]:o=Pn[r(249)](a,Sr[r(309)],So[r(552)],l);break;case In[r(516)]:o=Pn[r(249)](a,Sr[r(252)],So[r(292)],l);break;case In[r(328)]:o=Pn[r(249)](a,Sr[r(309)],So[r(292)],l);break;case In[r(364)]:o=Pn.prepareChannelRequest(Sr.CHPAUSE_TYPE,d);break;case In.CHANNEL_RESUME:o=Pn[r(235)](Sr.CHRESUME_TYPE,d);break;case In.SNAP_MW:o=Pn[r(462)](a,Sr[r(371)],So[r(369)]);break;case In[r(287)]:o=Pn[r(462)](a,Sr[r(371)],So[r(292)]);break;case In[r(447)]:o=Pn[r(462)](a,Sr[r(371)],So[r(552)]);break;case In[r(534)]:o=Pn[r(508)](n[fn[r(410)]],n[fn.STK_PRC],n[fn[r(342)]],n[fn[r(388)]],l);break;case In[r(311)]:break;case In.LITE:o=Pn[r(265)](Sr[r(522)],Pg.LITE,d);break;case In[r(475)]:o=Pn[r(265)](Sr.LITE_FULL,Pg[r(475)],d);break;case In[r(496)]:o=a;break;default:o=null;break}this.ws&&o?this.ws[r(381)](o):console[r(473)](r(268))}}class tV{constructor(e,r,n){const i=ct;this[i(450)]=null,this[i(296)]=null,this[i(391)]=new Array,this[i(247)]=0,this.ackNum=0,this[i(506)]=0,this.inWS=e,this[i(450)]=r,this[i(279)]=n}[ct(306)](e){const r=ct;let n=0,i=Xt[r(228)](e[r(338)](n,2));Ur[r(436)](r(497)+i),n+=2;let o=Xt[r(228)](e[r(338)](n,n+1));if(n+=1,Ur[r(436)](r(458)+o),o==Sr.CONNECTION_TYPE){const a={};let l=Xt[r(228)](e[r(338)](n,n+1));Ur.hsmDebug(r(239)+l),n+=1,Xt[r(228)](e[r(338)](n,n+1)),n+=1;let d=Xt.buf2Long(e[r(338)](n,n+2));n+=2;let p=Xt[r(349)](e.slice(n,n+d));n+=d;let f=0;if(l>=2){if(Xt.buf2Long(e[r(338)](n,n+1)),n+=1,d=Xt[r(228)](e.slice(n,n+2)),n+=2,f=Xt[r(228)](e[r(338)](n,n+d)),n+=d,l>=3){Xt.buf2Long(e[r(338)](n,n+1)),n+=1,d=Xt[r(228)](e.slice(n,n+2)),n+=2;let h=JSON[r(455)](Xt[r(349)](e[r(338)](n,n+d)));n+=d,this[r(245)](h)}switch(Ur.hsmDebug(r(403)+f),p){case Ds.OK:a[Mt[r(434)]]=Is.OK,a[Mt[r(307)]]=Dn[r(367)],a[Mt[r(251)]]=Ws[r(470)],a[Mt[r(481)]]=Ps.SUCCESS,this[r(301)]();break;case Ds[r(373)]:a[Mt[r(434)]]=Is.NOT_OK,a[Mt[r(307)]]=Dn[r(367)],a[Mt[r(251)]]=Ws.FAILED,a[Mt.STAT_CODE]=Ps[r(291)];break}this.ackNum=f}else if(l==1)switch(p){case Ds.OK:a[Mt.STATUS]=Is.OK,a[Mt.TYPE]=Dn[r(367)],a[Mt[r(251)]]=Ws[r(470)],a[Mt[r(481)]]=Ps[r(466)],this[r(301)]();break;case Ds[r(373)]:a[Mt[r(434)]]=Is[r(373)],a[Mt.TYPE]=Dn[r(367)],a[Mt.MSG]=Ws[r(267)],a[Mt[r(481)]]=Ps.CONNECTION_FAILED;break}else a[Mt[r(434)]]=Is[r(373)],a[Mt.TYPE]=Dn[r(367)],a[Mt[r(251)]]=Ws[r(549)],a[Mt.STAT_CODE]=Ps[r(234)];return this[r(304)](a)}else if(o==Sr.DATA_TYPE){let a=0;if(this[r(445)]>0&&(++this.counter,a=Xt.buf2Long(e.slice(n,n+4)),n+=4,this.counter==this[r(445)])){let p=Pn[r(303)](a);this[r(296)]&&this.inWS[r(381)](p),Ur[r(436)]("Acknowledgement sent for message num: "+a),this[r(247)]=0}const l=[];let d=Xt.buf2Long(e.slice(n,n+2));n+=2;for(let p=0;p<d;p++){let f=Xt[r(228)](e[r(338)](n,n+1));if(Ur.hsmDebug("ResponseType: "+f),n++,f==yd[r(250)]){let h=Xt[r(228)](e[r(338)](n,n+2));n+=2,Ur.hsmDebug(r(271)+h);let x=Xt[r(228)](e[r(338)](n,n+1));n++,Ur.hsmDebug(r(415)+x);let m=Xt[r(349)](e[r(338)](n,n+x));n+=x,Ur.hsmDebug(r(408)+m);let b=this.getNewTopicData(m);if(b){this.topicList[h]=b;let w=Xt[r(228)](e[r(338)](n,n+1));n++,Ur[r(436)](r(510)+w);for(let E=0;E<w;E++){let j=Xt.buf2Long(e[r(338)](n,n+4));b[r(542)](E,j),n+=4,Ur[r(436)](E+":"+j)}n+=2;let y=Xt[r(228)](e[r(338)](n,n+2));n+=2,Ur[r(436)]("multi: "+y);let C=Xt[r(228)](e[r(338)](n,n+1));n++,Ur[r(436)](r(535)+C),b.setMultiplierAndPrec(y,C);for(let E=0;E<3;E++){let j=Xt[r(228)](e.slice(n,n+1));n++;let k=Xt[r(349)](e[r(338)](n,n+j));n+=j,b[r(530)](E,k),Ur[r(436)]("strVal: "+k)}let T=b[r(288)]();T&&l[r(286)](T)}else Ur[r(436)](r(550))}else if(f==yd[r(332)]||f==yd[r(492)]){Ur[r(436)](r(283)+f);let h=Xt[r(228)](e[r(338)](n,n+2));Ur[r(436)](r(271)+h),n+=2;let x=this.topicList[h];if(!x)console[r(473)](r(259));else{let b;f!=yd[r(492)]?(b=Xt[r(228)](e.slice(n,n+1)),n++):b=x[r(507)],Ur.hsmDebug(r(510)+b);for(let w=0;w<b;w++){let y=Xt[r(228)](e[r(338)](n,n+4));x[r(542)](w,y),Ur[r(436)](r(500)+w+r(509)+y),n+=4}}let m=x[r(288)]();m&&l.push(m)}else console[r(473)](r(426)+f)}return l[r(491)]>0?l:null}else if(o==Sr[r(252)]||o==Sr[r(309)]){let a=this[r(441)](e,n);const l={};switch(a){case Ds.OK:l[Mt[r(434)]]=Is.OK,l[Mt[r(307)]]=o==Sr[r(252)]?Dn[r(340)]:Dn[r(248)],l[Mt[r(251)]]=Ws[r(470)],l[Mt.STAT_CODE]=Ps[r(466)];break;case Ds[r(373)]:l[Mt[r(434)]]=Is[r(373)],o==Sr[r(252)]?(l[Mt[r(307)]]=Dn[r(340)],l[Mt[r(251)]]=r(274),l[Mt[r(481)]]=Ps[r(418)]):(l[Mt[r(307)]]=Dn[r(248)],l[Mt.MSG]="unsubscription  failed",l[Mt.STAT_CODE]=Ps[r(385)]);break}return this.sendJsonArrResp(l)}else if(o==Sr[r(371)]){let a=this[r(441)](e,n);const l={};switch(a){case Ds.OK:l[Mt[r(434)]]=Is.OK,l[Mt.TYPE]=Dn[r(250)],l[Mt[r(251)]]=Ws[r(470)],l[Mt.STAT_CODE]=Ps.SUCCESS;break;case Ds[r(373)]:l[Mt[r(434)]]=Is.NOT_OK,l[Mt[r(307)]]=Dn[r(250)],l[Mt[r(251)]]=Ws[r(267)],l[Mt[r(481)]]=Ps.SNAPSHOT_FAILED;break}return this.sendJsonArrResp(l)}else if(o==Sr[r(297)]||o==Sr.CHRESUME_TYPE){let a=this[r(441)](e,n);const l={};switch(a){case Ds.OK:l[Mt[r(434)]]=Is.OK,l[Mt[r(307)]]=o==Sr[r(297)]?Dn[r(229)]:Dn[r(272)],l[Mt[r(251)]]=Ws.SUCCESSFUL,l[Mt.STAT_CODE]=Ps.SUCCESS;break;case Ds.NOT_OK:l[Mt[r(434)]]=Is[r(373)],l[Mt.TYPE]=o==Sr[r(297)]?Dn[r(229)]:Dn[r(272)],l[Mt.MSG]=Ws[r(267)],l[Mt[r(481)]]=o==Sr[r(297)]?Ps[r(359)]:Ps[r(278)];break}return this.sendJsonArrResp(l)}else if(o==Sr.OPC_SUBSCRIBE){let a=this[r(441)](e,n);n+=5;const l={};switch(a){case Ds.OK:l[Mt.STATUS]=Is.OK,l[Mt[r(307)]]=Dn.OPC,l[Mt[r(251)]]=Ws[r(470)],l[Mt[r(481)]]=Ps[r(466)],Xt[r(228)](e[r(338)](n,++n));let d=Xt[r(228)](e.slice(n,n+2));n+=2;let p=Xt[r(349)](e.slice(n,n+d));n+=d,l[r(313)]=p,Xt[r(228)](e[r(338)](n,++n)),d=Xt[r(228)](e[r(338)](n,n+2)),n+=2;let f=Xt[r(349)](e[r(338)](n,n+d));n+=d,l[r(493)]=JSON[r(455)](f)[r(440)];break;case Ds[r(373)]:l[Mt.STATUS]=Is[r(373)],l[Mt[r(307)]]=Dn.OPC,l[Mt[r(251)]]=Ws.FAILED,l[Mt[r(481)]]=11040;break}return this[r(304)](l)}else if(o==Sr[r(522)]){let a=this[r(441)](e,n);const l={};switch(a){case Ds.OK:l[Mt[r(434)]]=Is.OK,l[Mt[r(307)]]=o==Sr[r(522)]?Dn[r(492)]:Dn[r(475)],l[Mt[r(251)]]=Ws[r(470)],l[Mt.STAT_CODE]=Ps[r(466)];break;case Ds.NOT_OK:l[Mt[r(434)]]=Is[r(373)],l[Mt[r(307)]]=o==Sr.LITE_FULL?Dn.LITE:Dn.FULL,l[Mt[r(251)]]=Ws[r(267)],l[Mt[r(481)]]=12001;break}return this.sendJsonArrResp(l)}else return null}[ct(441)](e,r){const n=ct;let i=Ds.NOT_OK[n(511)]();if(Xt[n(228)](e[n(338)](r,++r))>0){Xt[n(228)](e[n(338)](r,++r));let a=Xt[n(228)](e[n(338)](r,r+2));r+=2,i=Xt[n(349)](e[n(338)](r,r+a)),r+=a}return i}getNewTopicData(e){const r=ct;let n=e.split("|")[0],i=null;switch(n){case El[r(369)]:i=new vn,i[r(507)]=es.SCRIP_LITE_FCOUNT;break;case El[r(552)]:i=new Ls,i[r(507)]=es[r(331)];break;case El[r(292)]:i=new Ap;break}return i}[ct(245)](e){const r=ct;if(e){Ur.hsmDebug(r(277)),vn[r(358)]=new Array,Ls[r(358)]=new Array,Ap[r(358)]=new Array;let n=new Map;e[r(430)][r(345)](function(l){n[r(243)](l.fid,l)}),es[r(451)]=e.scrip_lite.hfid,es[r(331)]=e[r(329)][r(254)],e[r(263)][r(286)](ro[r(232)]),e[r(263)][r(286)](ro[r(503)]),e.scrip.push(ro[r(537)]),e[r(502)][r(286)](gl[r(232)]),e[r(502)].push(gl[r(503)]),vn.LTP_INDEX=e.scrip[r(452)](ro[r(419)]),vn.VOLUME_INDEX=e.scrip[r(452)](ro[r(352)]),vn[r(384)]=e.scrip.indexOf(ro[r(281)]),vn.CHANGE_INDEX=e[r(263)].indexOf(ro[r(232)]),vn[r(545)]=e[r(263)][r(452)](ro.PCHANGE),vn.CLOSE_INDEX=e[r(263)][r(452)](ro[r(464)]),vn.TURNOVER_INDEX=e[r(263)][r(452)](ro[r(537)]),Ls[r(485)]=e[r(502)][r(452)](gl[r(419)]),Ls[r(273)]=e.index[r(452)](gl[r(464)]),Ls[r(476)]=e[r(502)].indexOf(gl[r(232)]),Ls[r(545)]=e.index[r(452)](gl[r(503)]);let i=e[r(263)];for(let l=0;l<i[r(491)];l++){let d=n[r(538)](i[l]),p=this[r(414)](d[r(424)]);vn[r(358)][l]=new C0(d[r(355)],d[r(356)],p,d[r(374)])}let o=e[r(502)];for(let l=0;l<o.length;l++){let d=n[r(538)](o[l]),p=this[r(414)](d[r(424)]);Ls[r(358)][l]=new C0(d.fid,d[r(356)],p,d[r(374)])}let a=e.depth;for(let l=0;l<a[r(491)];l++){let d=n.get(a[l]),p=this[r(414)](d[r(424)]);Ap[r(358)][l]=new C0(d.fid,d[r(356)],p,d.details)}}else console[r(473)](r(435))}[ct(414)](e){const r=ct;let n=yl[r(427)];switch(e){case r(321):n=yl[r(262)];break;case r(437):n=yl[r(489)];break;case r(519):n=yl[r(394)];break}return n}[ct(304)](e){let r=[];return r.push(e),r}startPingInterval(){const e=ct;this[e(506)]=setInterval(this[e(520)],this[e(279)],this)}pingFunction(e){const r=ct;this.inWS?.[r(317)]==Ig[r(233)]&&e.inWS?e[r(296)][r(381)](Pn.pingRequest):e.intervalId&&clearInterval(e[r(506)])}}class vo{constructor(){const e=ct;this.isCalled=!0,this[e(347)]=30}static[ct(389)](){const e=ct;return this[e(547)]||(this[e(547)]=new vo)}close(){const e=ct;this.stopHearBeat(),this[e(379)][e(457)]()}[ct(397)](e,r){const n=ct;this[n(372)]=e,this[n(428)]=(r||this[n(347)])*1e3,this[n(379)]&&(this.hsiWs[n(521)]=function(i){},this.hsiWs.onmessage=function(i){},this.hsiWs[n(486)]=function(i){},this[n(379)][n(517)]=function(i){},this[n(379)][n(457)]()),this[n(379)]=new Ig(e),this[n(379)]?this[n(379)][n(378)]=n(398):console.error(n(368)),this.hsiWs[n(521)]=function(){const i=n;Ur[i(541)](i(482)),vo[i(547)][i(280)]()},this.hsiWs[n(433)]=function(i){const o=n;Ur.hsiDebug(i);let a=i[o(440)],l=JSON[o(455)](a);if(l&&l.task=="cn"&&l.ak=="ok"){let d={type:"hb"};vo[o(547)][o(264)]=setInterval(function(){const p=o;vo[p(547)].isCalled=!0,vo._instance[p(379)][p(381)](JSON[p(380)](d))},r)}Ur[o(541)](a),a&&vo[o(547)].onMessage(a)},this.hsiWs[n(486)]=function(){const i=n;vo[i(547)][i(420)](),vo[i(547)].onClose()},this[n(379)][n(517)]=function(){const i=n;vo[i(547)][i(420)](),vo[i(547)][i(370)]()}}[ct(381)](e){const r=ct;let n=JSON[r(455)](e);Ur.hsiDebug(n);let i=n.type,o;i===In[r(444)]?n[fn[r(456)]]!==void 0&&n[fn[r(284)]]!==void 0&&n[fn[r(527)]]!==void 0?(o={type:"cn",Authorization:n[fn[r(456)]],Sid:n[fn.SID],src:n[fn[r(527)]]},this[r(350)]=o):n[fn.X_ACCESS_TOKEN]!==void 0&&n[fn[r(527)]]!==void 0?(o={type:"cn","x-access-token":n[fn.X_ACCESS_TOKEN],src:n[fn[r(527)]]},this.reqData=o):console[r(473)]("Invalid connection mode !"):i===In[r(548)]?(this[r(350)]=this[r(350)].type=r(505),o=this[r(350)]):i===In[r(311)]||(i===In.STR?o=n[r(440)]:console[r(473)](r(366))),this[r(379)]&&o?this[r(379)][r(381)](JSON[r(380)](o)):console[r(473)](r(268))}stopHearBeat(){const e=ct;this[e(446)]&&(this[e(446)]=!1,this.interval&&clearInterval(this[e(264)]))}}const rV={name:"type",ltp:"ltp",ltt:"last_traded_time",ltq:"last_traded_qty",fdtm:"exch_feed_time",op:"open_price",c:"prev_close_price",lo:"low_price",h:"high_price",cng:"ch",nc:"chp",v:"vol_traded_today",ap:"avg_trade_price",tbq:"tot_buy_qty",tsq:"tot_sell_qty",bp:"bid_price",sp:"ask_price",bq:"bid_size",bs:"ask_size",mul:"multiplier",prec:"precision"},nV={name:"type",ltp:"ltp",ltt:"last_traded_time",tvalue:"exch_feed_time",v:"vol_traded_today"},sV={iv:"ltp",tvalue:"exch_feed_time",name:"type"},iV={iv:"ltp",ic:"prev_close_price",highPrice:"high_price",lowPrice:"low_price",openingPrice:"open_price",cng:"ch",nc:"chp",name:"type",tvalue:"exch_feed_time"},Tk={bp:"bid_price1",bp1:"bid_price2",bp2:"bid_price3",bp3:"bid_price4",bp4:"bid_price5",sp:"ask_price1",sp1:"ask_price2",sp2:"ask_price3",sp3:"ask_price4",sp4:"ask_price5",bq:"bid_size1",bq1:"bid_size2",bq2:"bid_size3",bq3:"bid_size4",bq4:"bid_size5",bs:"ask_size1",bs1:"ask_size2",bs2:"ask_size3",bs3:"ask_size4",bs4:"ask_size5",bno1:"bid_order1",bno2:"bid_order2",bno3:"bid_order3",bno4:"bid_order4",bno5:"bid_order5",sno1:"ask_order1",sno2:"ask_order2",sno3:"ask_order3",sno4:"ask_order4",sno5:"ask_order5",name:"type"},oV={"NSE:NIFTYINDIAMFG-INDEX":"NIFTY INDIA MFG","NSE:NIFTY100ESG-INDEX":"NIFTY100 ESG","NSE:NIFTYINDDIGITAL-INDEX":"NIFTY IND DIGITAL","NSE:NIFTYMICROCAP250-INDEX":"NIFTY MICROCAP250","NSE:NIFTYCONSRDURBL-INDEX":"NIFTY CONSR DURBL","NSE:NIFTYHEALTHCARE-INDEX":"NIFTY HEALTHCARE","NSE:NIFTYOILANDGAS-INDEX":"NIFTY OIL AND GAS","NSE:NIFTY100ESGSECLDR-INDEX":"Nifty100ESGSecLdr","NSE:NIFTY200MOMENTM30-INDEX":"Nifty200Momentm30","NSE:NIFTYALPHALOWVOL-INDEX":"NIFTY AlphaLowVol","NSE:NIFTY200QUALTY30-INDEX":"NIFTY200 QUALTY30","NSE:NIFTYSMLCAP50-INDEX":"NIFTY SMLCAP 50","NSE:NIFTYMIDSELECT-INDEX":"NIFTY MID SELECT","NSE:MIDCPNIFTY-INDEX":"NIFTY MID SELECT","NSE:NIFTYMIDCAP150-INDEX":"NIFTY MIDCAP 150","NSE:NIFTY100 EQL WGT-INDEX":"NIFTY100 EQL Wgt","NSE:NIFTY50 EQL WGT-INDEX":"NIFTY50 EQL Wgt","NSE:NIFTYGSCOMPSITE-INDEX":"Nifty GS Compsite","NSE:NIFTYGS1115YR-INDEX":"Nifty GS 11 15Yr","NSE:NIFTYGS48YR-INDEX":"Nifty GS 4 8Yr","NSE:NIFTYGS10YRCLN-INDEX":"Nifty GS 10Yr Cln","NSE:NIFTYGS813YR-INDEX":"Nifty GS 8 13Yr","NSE:NIFTYSMLCAP100-INDEX":"NIFTY SMLCAP 100","NSE:NIFTYQUALITY30-INDEX":"NIFTY100 Qualty30","NSE:NIFTYPVTBANK-INDEX":"Nifty Pvt Bank","NSE:NIFTYPHARMA-INDEX":"Nifty Pharma","NSE:NIFTYLARGEMID250-INDEX":"NIFTY LARGEMID250","NSE:NIFTYGS15YRPLUS-INDEX":"Nifty GS 15YrPlus","NSE:NIFTYPSUBANK-INDEX":"Nifty PSU Bank","NSE:NIFTYSMLCAP250-INDEX":"NIFTY SMLCAP 250","NSE:NIFTYENERGY-INDEX":"Nifty Energy","NSE:NIFTYALPHA50-INDEX":"NIFTY Alpha 50","NSE:NIFTYPSE-INDEX":"Nifty PSE","NSE:NIFTYFINSRV2550-INDEX":"Nifty FinSrv25 50","NSE:FINNIFTY-INDEX":"Nifty Fin Service","NSE:NIFTYREALTY-INDEX":"Nifty Realty","NSE:NIFTY500-INDEX":"Nifty 500","NSE:NIFTY500MULTICAP-INDEX":"NIFTY500 MULTICAP","NSE:NIFTYMIDCAP50-INDEX":"Nifty Midcap 50","NSE:NIFTYTOTALMKT-INDEX":"NIFTY TOTAL MKT","NSE:NIFTY50PR2XLEV-INDEX":"Nifty50 PR 2x Lev","NSE:INDIAVIX-INDEX":"India VIX","NSE:NIFTYDIVOPPS50-INDEX":"Nifty Div Opps 50","NSE:NIFTYMNC-INDEX":"Nifty MNC","NSE:NIFTY50VALUE20-INDEX":"Nifty50 Value 20","NSE:NIFTY50-INDEX":"Nifty 50","NSE:HANGSENG BEES-NAV-INDEX":"HangSeng BeES-NAV","NSE:NIFTY100LIQ15-INDEX":"Nifty100 Liq 15","NSE:NIFTY50TR2XLEV-INDEX":"Nifty50 TR 2x Lev","NSE:NIFTY100-INDEX":"Nifty 100","NSE:NIFTY100 LOWVOL30-INDEX":"NIFTY100 LowVol30","NSE:NIFTYBANK-INDEX":"Nifty Bank","NSE:NIFTYFMCG-INDEX":"Nifty FMCG","NSE:NIFTYIT-INDEX":"Nifty IT","NSE:NIFTYGS10YR-INDEX":"Nifty GS 10Yr","NSE:NIFTYMIDCAP100-INDEX":"NIFTY MIDCAP 100","NSE:NIFTYNEXT50-INDEX":"Nifty Next 50","NSE:NIFTYM150QLTY50-INDEX":"NIFTY M150 QLTY50","NSE:NIFTYSERVSECTOR-INDEX":"Nifty Serv Sector","NSE:NIFTYMIDSML400-INDEX":"NIFTY MIDSML 400","NSE:NIFTYAUTO-INDEX":"Nifty Auto","NSE:NIFTYMETAL-INDEX":"Nifty Metal","NSE:NIFTYINFRA-INDEX":"Nifty Infra","NSE:NIFTYMEDIA-INDEX":"Nifty Media","NSE:NIFTY50PR1XINV-INDEX":"Nifty50 PR 1x Inv","NSE:NIFTY200-INDEX":"Nifty 200","NSE:NIFTY50TR1XINV-INDEX":"Nifty50 TR 1x Inv","NSE:NIFTYCPSE-INDEX":"Nifty CPSE","NSE:NIFTYMIDLIQ15-INDEX":"Nifty Mid Liq 15","NSE:NIFTYCOMMODITIES-INDEX":"Nifty Commodities","NSE:NIFTYCONSUMPTION-INDEX":"Nifty Consumption","NSE:NIFTY50DIVPOINT-INDEX":"Nifty50 Div Point","NSE:NIFTYGROWSECT15-INDEX":"Nifty GrowSect 15","BSE:100LARGECAPTMC-INDEX":"LCTMCI","BSE:DFRG-INDEX":"DFRGRI","BSE:QUALITY-INDEX":"BSEQUI","BSE:DIVIDENDSTABILITY-INDEX":"BSEDSI","BSE:250SMALLCAP-INDEX":"SML250","BSE:150MIDCAP-INDEX":"MID150","BSE:ESG100-INDEX":"ESG100","BSE:SNXT50-INDEX":"SNXT50","BSE:SNSX50-INDEX":"SNSX50","BSE:UTILS-INDEX":"UTILS","BSE:GREENEX-INDEX":"GREENX","BSE:SENSEX-INDEX":"SENSEX","BSE:REALTY-INDEX":"REALTY","BSE:PRIVATEBANKS-INDEX":"BSEPBI","BSE:CDGS-INDEX":"CDGS","BSE:OILGAS-INDEX":"OILGAS","BSE:ENERGY-INDEX":"ENERGY","BSE:POWER-INDEX":"POWER","BSE:500-INDEX":"BSE500","BSE:100-INDEX":"BSE100","BSE:PSU-INDEX":"BSEPSU","BSE:HC-INDEX":"BSE HC","BSE:400MIDSMALLCAP-INDEX":"MSL400","BSE:BHRT22-INDEX":"BHRT22","BSE:BANKEX-INDEX":"BANKEX","BSE:ALLCAP-INDEX":"ALLCAP","BSE:INFRA-INDEX":"INFRA","BSE:CD-INDEX":"BSE CD","BSE:MIDCAP-INDEX":"MIDCAP","BSE:AUTO-INDEX":"AUTO","BSE:BASMTR-INDEX":"BASMTR","BSE:200-INDEX":"BSE200","BSE:FIN-INDEX":"FIN","BSE:CG-INDEX":"BSE CG","BSE:ENHANCEDVALUE-INDEX":"BSEEVI","BSE:TECK-INDEX":"TECK","BSE:METAL-INDEX":"METAL","BSE:CARBONEX-INDEX":"CARBON","BSE:MIDSEL-INDEX":"MIDSEL","BSE:SME IPO-INDEX":"SMEIPO","BSE:MOMENTUM-INDEX":"BSEMOI","BSE:TELCOM-INDEX":"TELCOM","BSE:CPSE-INDEX":"CPSE","BSE:250LARGEMIDCAP-INDEX":"LMI250","BSE:SMLCAP-INDEX":"SMLCAP","BSE:IT-INDEX":"BSE IT","BSE:INDIAMANUFACTURING-INDEX":"MFG","BSE:INDSTR-INDEX":"INDSTR","BSE:LOWVOLATILITY-INDEX":"BSELVI","BSE:LRGCAP-INDEX":"LRGCAP","BSE:IPO-INDEX":"BSEIPO","BSE:FMC-INDEX":"BSEFMC","BSE:SMLSEL-INDEX":"SMLSEL"},Rk={stat:"s",type:"type",msg:"message",stCode:"code"},Tp={sf:{full:rV,lite:nV},if:{full:iV,lite:sV},index_dict:oV,confirmationmapper:{full:Rk,lite:Rk},dp:{full:Tk,lite:Tk}};var Tt=fs;(function(s,e){for(var r=fs,n=s();;)try{var i=parseInt(r(721))/1*(parseInt(r(934))/2)+parseInt(r(994))/3+-parseInt(r(932))/4*(parseInt(r(958))/5)+-parseInt(r(600))/6+parseInt(r(500))/7*(-parseInt(r(1004))/8)+parseInt(r(879))/9+-parseInt(r(830))/10*(-parseInt(r(687))/11);if(i===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(Mg,306540+-1488725*-1+58975*-15);const aV=[Tt(1013),"op","c","lo","h",Tt(584),"nc","yh","yl","ap","to",Tt(1053),Tt(965),"bp","sp",Tt(845),Tt(581),Tt(783)+"ce",Tt(750),Tt(710),"ic","iv",Tt(529),Tt(669),Tt(603),Tt(873),Tt(522),Tt(640),Tt(941),Tt(927)],lV=[Tt(1005),"v",Tt(944),Tt(699),"oi","bq","bs",Tt(813),Tt(507),Tt(583),Tt(615),Tt(769),Tt(749),Tt(711),Tt(781),Tt(792),Tt(799),Tt(472),Tt(997),Tt(491),Tt(995),Tt(743),Tt(1028),Tt(797),Tt(614)],cV=[Tt(707),Tt(957),Tt(798)];function fs(s,e){var r=Mg();return fs=function(n,i){n=n-472;var o=r[n];return o},fs(s,e)}var va={};function Mg(){var s=["HMddt","dqBiF","channel ou","RFiBU","clear","wCohg","HHyGA","prec","rbnCF","bq3","cng","channel pa","4|0|1|3|2|","dwUNp","kkrEG","socketoncl","INDEX","error in a","ion","wcbFc","VcasR","Index dont","subscripti","kInKc","upper_ckt","6|2|3","624768axPBBb","xPpOs","VtJCM","bp3","aeMFx","ECQHU","HSMToken","YzpIW","jWyHa","reconnect ","hasOwnProp","ifs","error in r","AwcNt","sno5","bq4","DBaQh","EcsGN","lose funct","mwu","1210","1|4|0|3|2","input","|4|3|6|13|","avkdR","Ifeuq","GOpdJ","tInstance(","unction","isConnecte","pcujZ","gxhWm","getFyToken","hVwBM","nekkg","name","LoggingFla","RgBgs","fTmQH","qoiwV","sp2","jwjGl",'T: "hsm_ke',"receiver","MqrSi","invalid pa","autoreconn","rVajC","forEach","NdYpT","ectflag","TjLya","slice","xqrDu","charCodeAt","EOAYd","nstance of","f numbers","ANboB","replace","mws","full","bnPdX","socket alr","LpNsO","VjAfA","SYcMg","NXqse","YzgDV","bp2","stat","Rrqtq","GgrNf","ct functio","hwROt","entries","cTmBO","ehFrU","yiWEE","red","me functio","getError","secondcoun","ssing an e","ws closed","autreconne","GRbcR","10605386sFerWG","t found fo","BpfQd","HLShM","function","toString","vOvUr","cttimer","1212","ken","XNIRj","egYht","tsq"," first","split","join","ode functi","rDSrv","t of range","BBaMk","ltt","KhuNQ","LKhiU","highPrice","bs3","or array o","Kbbhx","GEErO","wOsMk","splice","Invalid JW","max autoco","5|6|2","eeJgY","1495757eSkcja","RlmWN","log","YAckg","lUGsf","symbol lim","KSKCm","xpired tok","NCjFK","9|18|7","2|4|0|3|1","ZBMvD","close","tMFaO","recurssive","FHrLf","XvVrG","is invalid","AYmbz","match","LOCcP","MAoMl","sno2","llaNy","ume","shift","TdcYX","channelres","bs2","lowPrice","n connect ","FDWTB","code","now","JOaWn","0|3|7|4|1|","IZTkW","ZHNRb","onmapper","error conv","nction","Failed to ","reduce","confirmati","exp","error","parse","Token expi","bs1","vuVnf","hsm_key","isUserClos","hVAzF","PyoNc","RxKIy","onMessage","uVKYe","LogPath","ror","PxUWP","bs4","EtRUe","openingPri","el as a nu","iDIGw","ymbol-toke","SMKey","oMOsa","UPoKb","dpu","channel ca","bno1","svLqK","vide valid","aljoZ","fVPSo","sno4","tvalue","bno2","QgRSf","AoHsf","3|0|2|4|1","RSosa","bcs_fo","jyWcm","SyLdr","message","yIuoQ","AlnzI","unsubscrib","Authorizat","iJZRQ","bq1","lower_ckt","hJdxt","recursives","eBhVy"," ws subscr"," have mark","AcGBM","eqauX","ction","bmQVp","push","uhWpd","it passed","lit","fHdnC","decode JWT","10yTPiCq","fyToken","NWZBb","IRAfS","iwLGZ","symbols","zkIOe","fZWBi","vhrYt","HktwC","1120","kBYiI","s exceeded","exchangeto","tqYus","mul","t found in","onticks","socket is ","dps","gTNIu","sage","OvfKe","mpzQb","qGlON","ZzQiz","OcuiO","hing symbo","https://ap",") instead."," function","headers","assign","xJZPR","error fetc","bIGOw","xceeding y","SrnYq","zROzZ","rdUON","diWiR","getTime","uLCWj","bp4","data","BFJkE","2|4|1|0|3","pRqJB","qGKHg","5669469PRpqfP","xaEhn","TbQuP","l token","gocbr","constructo","onOpen","hKVlz","sub","oKJbT","length","EQHqE","channelnum","instance","SaPAF","MNDpv","rtTgL","WrgHu","SGfBO","mcx_fo","ed. Use ge","eiJOk","bse_fo"," channel s","JTlJk","LgoqE","ose","t across a","n be in ra","nse_com","PWmyx","oTHLv","sMjKe","nnect trie"," DataSocke","UismO","index_dict","sendReques"," initalize","WcEWm","initalize ","sed by fun","etween 1 a","erty","onError","bznqA","isArray","ecvRX","sp4","0|4|1|2|5|","advuU","r specific","decodeJWTA","21308gXIzDX","riqxQ","2XZrpLF","FullMode","n function","nse_fo","i-t1.fyers","0|4|1|3|2","ojCVz","sp3","_autorecon","XwELB","tbq","MEGdS","ou have ","PpTyr","socketonOp","CyuNv","tGzpB","connect","KNMNW","1010","get","the socket","mber","fdtm","455WEkFNz","f range","subscribe","as number ","error in u","ryNZD","EtRpr","ucl","symbol","nTVUe","ndExtractH","wBTFc","tertimer","s channel ","errmsg","pRnad","SocketMess","socket clo","ELHKc","cVTrg","ect","on limit e","budZX","zrMhE","NBkvg","HcSzl","zKMBb","QwQla","erting mes","rameter:","ful","Ywpgg","eady close","DGfyq","callbackfu","t is allow","263328cjInsu","sno1","values","bno4","ePGkm","jtIPB","nvYMc","ifu","onClose","AYZul","344MURbOZ","ltq","rBJdt","substring","l token fo","ecurrsivef","Zeere","TWNBt","chjBP","ltp","Socketerro","end","0|2|4|1|3","1011","6|5","pfJmd","cqevf","ssed out o","AYTlG","driuJ","LoucB","socketoner","FhkVX","ZEhyh","sno3","hannelresu","HhtDt","wjAqE","error in c","GNabh","hvcMx","WHebb","iption lef","error in m","ll channel","trying to "," token","wMGXh","You are pa","aJXkw","1012","zdmoO","4|1|3|0|2","sessionid","nqHRD","queue","age","hould be b","getInstanc","lcl","pass chann","tcPoH","LiteMode","utoreconne","MCpxJ","nse_cm","Please pro","bno3","1211","nect","nd 30","qduhR","3|2|0|1|4","contains","error occo","OSIuk","LXDmY","scrips","hECVt",'y" missing',"WxmpY","bqKSs","ubscribe f","IiFTD","SgLKD","TiakD","bno5","3|4|5|0|2|","GlSzQ","gyiqF","QwiFF","conversion","map key no","type","floor","273175XYSceQ","nsubscribe","0|5|7|1|4|","asdzK","ssfbg","socket not","HSM key no","bq2","please pas","3|4|1|0|2","kRCbI","nRUoa","validSymbo","delval","SqPKp","tSPpk","HSM_SOCKET","interval","6|3","cde_fo","stringify","JCrGO","sp1","ZKpWG","LcsnQ","receive","lite","VzKNg","rlCdI","bp1","nge 1 to 3","VSubX","send","1020","hhvnT","0|17|10|11","bse_cm","cPqVM",".in/data/s","mode","ured","disconnect","includes","sOVNG","BAIQL","prototype","post","yTNef","oDhxt","r index","Bhrbz","connected","5|1|2|5|8|","waitFor","oFKnW","debug","JpoPD","Kkjck","qDQZH","etdepth","wIzLz","Only one i","error in s","then"," or token ","BIyzo","SCJJN","map","KMLtS","SwHRj","14|12|16|1","IWpDN","error in o"," symbol"];return Mg=function(){return s},Mg()}va[Tt(953)]=Tt(1059),va[Tt(1017)]=Tt(937),va[Tt(840)]=Tt(898),va[Tt(620)]=Tt(536),va[Tt(1044)]=Tt(519),va[Tt(473)]=Tt(901),va[Tt(533)]=Tt(908),va[Tt(695)]=Tt(804);const Mf=va;var pn={};function dV(s){var e=Tt,r={};r[e(1012)]=function(i,o){return i+o},r[e(1024)]=function(i,o){return i+o};var n=r;return Object[e(996)](s)[e(763)]((i,o)=>{var a=e;return n[a(1024)](i,Object[a(996)](o)[a(763)]((l,d)=>{var p=a;return n[p(1012)](l,d[p(889)])},4071+-1983*-1+-6054))},0)}async function Nk(s,e,r,n){var i=Tt,o={kkrEG:i(632),wcbFc:i(512)+"l",IWpDN:i(509),kBYiI:function(y,C){return y(C)},HLShM:i(498),RxKIy:i(887),oTHLv:i(864)+i(857)+i(882)},a=null,l={};const d=o[i(588)];for(const y of r){var p=JSON[i(520)](y);try{var f={};f[i(811)+i(592)]=e;var h={};h[i(861)]=f,a=(await er[i(546)](s,p,h))[i(874)];for(const T in a[o[i(593)]])l[T]=a[o[i(593)]][T]}catch(C){for(var x=o[i(571)][i(701)]("|"),m=1*-6724+1*4863+1861;;){switch(x[m++]){case"0":o[i(841)](n,w);continue;case"1":w[o[i(690)]]=o[i(775)];continue;case"2":var b={};b.d=[],a=b;continue;case"3":var w=new KO(C)[i(681)]();continue;case"4":console[i(766)](o[i(910)],w,d);continue}break}}}return l}function uV(s,e){var r=Tt,n={};n[r(714)]=function(l,d){return l>d};var i=n;let o=-8501+1*-5493+13994,a=!1;for(const l in s)if(Array[r(925)](s[l])&&s[l][r(542)](e)&&(o++,i[r(714)](o,1))){a=!0;break}return!a}function Ok(s,e){var r=Tt;return!s[r(542)](e)&&s[r(824)](e),s}function Bf(s,e=[-9504+-9*-827+2062,2,-5396+-5399*-1,-5058+-1*6673+1*11735,-6839+-1711*-4,327*-11+154+3449,7483+3738*-2,8,1*7071+2537+29*-331,7436+2*-3581+-264,-12720+-1*-12731,1540+1*3282+-2*2405,-8783+1*8796,14,-1*6354+-6586+1*12955,6816+263*-7+-4959,8053+-6*775+-3386,-3417+4754*-1+-19*-431,19,-887+-1*8237+-1524*-6,662+2*-3187+5733,-9*-939+-595*-5+4*-2851,-1*2361+8188+-5804,-1*-8932+764+-9672,-9210+1*-7405+16640,511*-5+-9892+-1*-12473,-1*8655+-1046*-6+2406*1,7498+-5*1494,29,1273+5789*-1+4546]){var r=Tt,n={};n[r(817)]=function(a,l){return a<l},n[r(720)]=function(a,l){return a===l};for(var i=n,o=7372+-19*388;i[r(817)](o,e[r(889)]);o++)i[r(720)](e[o],s)&&e[r(716)](o,3882*1+8892+-12773);return e}function cd(s,e){var r=Tt,n={};n[r(708)]=function(l,d){return l===d},n[r(977)]=function(l,d){return l>d};var i=n;const o=[];let a=[];for(const l of s)a[r(824)](l),i[r(708)](a[r(889)],e)&&(o[r(824)](a),a=[]);return i[r(977)](a[r(889)],-15*-601+353*20+-16075)&&o[r(824)](a),o}function pV(s){var e=Tt,r={};r[e(844)]=function(x,m){return x-m},r[e(579)]=function(x,m){return x/m};var n=r;const[i,o,a,l,d,p]=s[e(740)](/\d+/g),f=new Date(a,n[e(844)](o,8*582+6624+1*-11279),i,l,d,p);return Math[e(499)](n[e(579)](f[e(871)](),3*1538+4366+-7980))}class hV{constructor(){var e=Tt;this[e(1049)]=[]}[Tt(532)](e){var r=Tt;this[r(1049)][r(824)](e)}async[Tt(525)](){var e=Tt,r={};r[e(481)]=function(i,o){return i>o};var n=r;return n[e(481)](this[e(1049)][e(889)],-5338+-2669*-2)?this[e(1049)][e(746)]():void 0}[Tt(578)](){var e=Tt;this[e(1049)]=[]}}function fV(s,e,r){var n=Tt,i={};i[n(758)]=function(a,l){return a!==l};var o=i;o[n(758)](e,r)&&s[n(610)+n(922)](e)&&(s[r]=s[e],delete s[e])}function Ff(s,e){var r=Tt,n={tcPoH:function(d,p){return d===p},yiWEE:r(764)+r(759),bnPdX:r(526),QgRSf:r(661),cqevf:function(d,p){return d===p},WHebb:function(d,p,f,h){return d(p,f,h)},dqBiF:function(d,p){return d==p},aljoZ:function(d,p){return d==p},QwiFF:r(814),GlSzQ:r(598),TiakD:function(d,p){return d!=p},asdzK:r(966)},i={...s},o=i,a=o[r(635)];if(n[r(1055)](a,void 0)&&(a=n[r(678)]),e)var l=n[r(662)];else var l=n[r(800)];for(const d in o)n[r(1055)](Tp[a],void 0)||(n[r(1020)](Tp[a][l][d],void 0)?n[r(490)](d,n[r(503)])&&delete o[d]:(n[r(1035)](fV,o,d,Tp[a][l][d]),n[r(575)](a,"sf")&&n[r(795)](l,n[r(800)])&&(o[n[r(495)]]=4918+1*-4918,o[n[r(493)]]=1002*-1+2*1173+-1344)));return o}Array[Tt(545)][Tt(478)]=function(s){var e=Tt,r={};r[e(825)]=function(o,a){return o===a};for(var n=r,i=this[e(889)];i--;)if(n[e(825)](this[i],s))return!0;return!1};let _k=function(s,e){var r=Tt,n={UismO:function(i,o){return i(o)}};return aV[r(478)](s)?n[r(914)](parseFloat,e):lV[r(478)](s)?n[r(914)](parseInt,e):cV[r(478)](s)?n[r(914)](pV,e):e};function gV(s){var e=Tt,r={PyoNc:e(931)+e(968)+e(787),nqHRD:function(i,o){return i-o},Kbbhx:function(i,o){return i(o)},hvcMx:e(506)+e(846)+e(1040),DGfyq:e(717)+e(642)+e(484)+e(564)+e(738)+".",Ywpgg:function(i,o){return i>=o},iDIGw:function(i,o){return i*o},NWZBb:e(768)+e(679),gocbr:e(1042)+e(683)+e(728)+"en"};const n=r[e(774)];try{const i=s[e(701)](":"),o=i[r[e(1048)](i[e(889)],-8247+-1558*5+6*2673)],a=r[e(713)](xV,o);if(console[e(723)](a),!a||!a[e(771)])throw console[e(723)](r[e(1034)],a,n),new Error(r[e(991)]);if(a[e(765)]&&r[e(989)](Date[e(754)](),r[e(785)](a[e(765)],3*-1876+-548*16+15396)))throw console[e(723)](r[e(832)],a,n),new Error(r[e(883)]);return a[e(771)]}catch(i){throw console[e(723)](r[e(1034)],i[e(807)],n),new Error(e(762)+e(829)+": "+i[e(807)])}}function xV(s){for(var e=Tt,r={zrMhE:e(621),BpfQd:function(p,f){return p+f},zROzZ:function(p,f){return p(f)}},n=r[e(981)][e(701)]("|"),i=8518+-1*1309+801*-9;;){switch(n[i++]){case"0":var o=d[e(659)](/-/g,"+")[e(659)](/_/g,"/");continue;case"1":var a={avkdR:function(p,f){var h=e;return r[h(689)](p,f)},qGlON:function(p,f){var h=e;return r[h(689)](p,f)}};continue;case"2":return JSON[e(767)](l);case"3":var l=r[e(868)](decodeURIComponent,r[e(868)](atob,o)[e(701)]("")[e(567)](function(p){var f=e;return a[f(624)]("%",a[f(854)]("00",p[f(654)](-3107*-1+9732+-12839)[f(692)](12356+2468*-5))[f(652)](-2))})[e(702)](""));continue;case"4":var d=s[e(701)](".")[-2361+1*1223+1139];continue}break}}const Dk=Symbol(Tt(643)),Ik=Symbol(Tt(816)+Tt(1015));(()=>{var E,j,k,A,R,M,P,I,O,G,B;var s=Tt,e={hhvnT:s(535)+s(623)+s(570)+s(552)+s(730),rBJdt:s(561)+s(656)+s(913)+s(993)+s(899)+s(627)+s(859),fZWBi:function(F,z,$){return F(z,$)},VSubX:s(827),nTVUe:s(988),fVPSo:function(F,z){return F(z)},HcSzl:function(F,z){return F===z},EtRpr:s(611),XNIRj:s(1001),cPqVM:s(660),gTNIu:function(F,z){return F===z},gyiqF:s(619),ZzQiz:s(849),hVwBM:s(790),XwELB:s(735)+s(532),qduhR:function(F,z){return F>z},BIyzo:s(612)+s(1009)+s(628),hKVlz:function(F,z){return F(z)},nvYMc:function(F){return F()},svLqK:function(F,z){return F(z)},xJZPR:function(F,z){return F<z},pfJmd:function(F,z){return F(z)},wMGXh:function(F,z){return F!=z},MqrSi:function(F,z,$){return F(z,$)},PWmyx:function(F,z){return F(z)},kInKc:function(F,z){return F===z},sMjKe:s(766),WrgHu:function(F,z){return F(z)},lUGsf:s(760)+s(986)+s(851),ojCVz:s(496),ryNZD:function(F,z){return F===z},vOvUr:s(951),MNDpv:s(807),SyLdr:s(733),BBaMk:s(645)+s(987),SYcMg:s(572)+s(936),tMFaO:s(551),JOaWn:function(F,z){return F(z)},oMOsa:s(684),AYTlG:function(F,z){return F<z},hECVt:s(479)+s(540),wBTFc:function(F,z,$){return F(z,$)},SqPKp:s(756)+s(719),IiFTD:function(F,z){return F===z},mpzQb:function(F,z){return F===z},Bhrbz:s(572)+s(751)+s(691),TbQuP:s(731),yTNef:function(F,z){return F+z},bmQVp:s(876),bqKSs:s(960),PxUWP:function(F,z){return F<=z},gxhWm:function(F,z){return F>z},WcEWm:s(887),ZEhyh:s(791)+s(907)+s(530)+"0",VcasR:s(585)+s(1021)+s(959),oFKnW:function(F,z){return F+z},RgBgs:s(726)+s(826),uLCWj:function(F,z){return F-z},xPpOs:function(F,z){return F(z)},RFiBU:function(F,z){return F-z},QwQla:function(F,z){return F+z},Zeere:function(F,z){return F>z},nRUoa:function(F,z){return F===z},FhkVX:function(F,z){return F(z)},qGKHg:function(F,z){return F(z)},aJXkw:function(F,z){return F===z},LKhiU:s(919)+s(955)+s(700),LOCcP:s(505)+s(917)+"d",HHyGA:s(848)+s(541)+"ed",HktwC:s(858)+s(938)+s(538)+s(786)+"n",BAIQL:function(F,z,$,W,D){return F(z,$,W,D)},EtRUe:function(F,z){return F==z},OSIuk:function(F,z){return F===z},xaEhn:s(590),vhrYt:s(1016),pcujZ:s(1060)+s(794)+s(573),LcsnQ:s(497)+s(688)+s(549),TdcYX:s(595)+s(819)+s(559),NCjFK:s(1046),GRbcR:function(F,z){return F===z},UPoKb:function(F,z,$){return F(z,$)},nekkg:function(F,z){return F===z},JpoPD:s(966),qoiwV:s(915),EcsGN:s(928)+s(518),KNMNW:function(F,z){return F===z},ehFrU:function(F,z){return F===z},ZKpWG:function(F,z){return F!=z},DBaQh:function(F,z){return F!=z},yIuoQ:s(562)+s(487)+s(628),BFJkE:s(802),sOVNG:s(492)+"1",ecvRX:function(F,z){return F===z},wjAqE:s(810)+"e",uVKYe:function(F,z){return F===z},EOAYd:function(F,z){return F(z)},hVAzF:function(F,z){return F(z)},YAckg:function(F,z,$,W){return F(z,$,W)},ECQHU:function(F,z){return F-z},NXqse:s(477),jwjGl:function(F,z){return F+z},WxmpY:function(F,z){return F(z)},GgrNf:function(F,z){return F(z)},YzpIW:s(586)+s(1018),AcGBM:function(F,z){return F+z},PpTyr:function(F,z){return F!=z},ANboB:function(F,z){return F(z)},wOsMk:function(F,z){return F!=z},KMLtS:function(F,z){return F!=z},LgoqE:s(962)+s(501)+s(860),JTlJk:function(F,z){return F===z},wIzLz:s(663)+s(990)+"d",jWyHa:s(502)+s(599),HhtDt:function(F,z){return F(z)},riqxQ:s(975)+s(920)+s(822),MAoMl:function(F,z){return F(z)},rVajC:s(1032)+s(618)+s(592),MEGdS:s(748)+s(745),Rrqtq:function(F,z){return F<z},bIGOw:s(576)+s(705)+s(902)+s(1051)+s(921)+s(475),ELHKc:s(1054)+s(784)+s(956),tSPpk:s(1032)+s(1029)+s(680)+"n",zdmoO:s(539),fHdnC:function(F,z){return F===z},zKMBb:function(F,z){return F===z},aeMFx:function(F,z){return F<z},SgLKD:s(508)+s(971)+s(961)+s(712)+s(657),rbnCF:s(1037)+s(703)+"on",hJdxt:s(1039)+s(609),rdUON:function(F,z){return F+z},TjLya:function(F,z){return F>=z},ZBMvD:s(718)+s(912)+s(842),SGfBO:s(646)+s(978),jtIPB:function(F,z){return F/z},EQHqE:function(F,z){return F+z},eiJOk:function(F,z){return F*z},OcuiO:s(591)+s(1057)+s(673)+"n",dwUNp:function(F,z){return F>z},fTmQH:s(516)};let r;var n={};n[1]=[],n[2]=[],n[3]=[],n[4]=[],n[5]=[],n[6]=[],n[7]=[],n[8]=[],n[9]=[],n[10]=[],n[11]=[],n[12]=[],n[13]=[],n[14]=[],n[15]=[],n[16]=[],n[17]=[],n[18]=[],n[19]=[],n[20]=[],n[21]=[],n[22]=[],n[23]=[],n[24]=[],n[25]=[],n[26]=[],n[27]=[],n[28]=[],n[29]=[],n[30]=[];var i={};i[1]=[],i[2]=[],i[3]=[],i[4]=[],i[5]=[],i[6]=[],i[7]=[],i[8]=[],i[9]=[],i[10]=[],i[11]=[],i[12]=[],i[13]=[],i[14]=[],i[15]=[],i[16]=[],i[17]=[],i[18]=[],i[19]=[],i[20]=[],i[21]=[],i[22]=[],i[23]=[],i[24]=[],i[25]=[],i[26]=[],i[27]=[],i[28]=[],i[29]=[],i[30]=[];var o={};o[1]=[],o[2]=[],o[3]=[],o[4]=[],o[5]=[],o[6]=[],o[7]=[],o[8]=[],o[9]=[],o[10]=[],o[11]=[],o[12]=[],o[13]=[],o[14]=[],o[15]=[],o[16]=[],o[17]=[],o[18]=[],o[19]=[],o[20]=[],o[21]=[],o[22]=[],o[23]=[],o[24]=[],o[25]=[],o[26]=[],o[27]=[],o[28]=[],o[29]=[],o[30]=[];var a={};a.if=n,a.sf=i,a.dp=o;let l=a;var d={};d[1]=!0,d[2]=!0,d[3]=!0,d[4]=!0,d[5]=!0,d[6]=!0,d[7]=!0,d[8]=!0,d[9]=!0,d[10]=!0,d[11]=!1,d[12]=!1,d[13]=!1,d[14]=!1,d[15]=!1,d[16]=!1,d[17]=!1,d[18]=!1,d[19]=!1,d[20]=!1,d[21]=!1,d[22]=!1,d[23]=!1,d[24]=!1,d[25]=!1,d[26]=!1,d[27]=!1,d[28]=!1,d[29]=!1,d[30]=!1;let p=d,f,h,x=Wt[e[s(638)]],m=-6120+-340*-18,b=320+1*-766+446,w=4*494+11*393+-6299,y=new eV,C=new hV;class T{constructor(z,$,W=!0){Pe(this,G,function($){return new Promise(W=>{var D=fs;e[D(837)](setTimeout,W,$)})});Pe(this,"on",function(z,$){var W=s,D={llaNy:function(Y){var he=fs;return e[he(1e3)](Y)},YzgDV:function(Y,he){var me=fs;return e[me(850)](Y,he)},SwHRj:function(Y,he){var me=fs;return e[me(1041)](Y,he)},XvVrG:function(Y,he,me){var ge=fs;return e[ge(644)](Y,he,me)},JCrGO:function(Y,he){var me=fs;return e[me(909)](Y,he)},iwLGZ:function(Y,he){var me=fs;return e[me(597)](Y,he)},LpNsO:e[W(911)],cTmBO:function(Y,he){var me=W;return e[me(896)](Y,he)},rlCdI:e[W(725)],tGzpB:e[W(940)]};const oe="on";try{var Z=C;if(e[W(963)](z,e[W(693)])){var fe=h;this[W(948)+"en"]=function(){var Y=W;b=-6156+-671*-14+-3238;var he={};he[Y(498)]="cn",he[Y(1047)]=fe,he[Y(539)]="P",Z[Y(532)](he),D[Y(744)]($)},y[W(885)]=this[W(948)+"en"]}else if(e[W(597)](z,e[W(894)])){this[W(992)+W(761)]=$;var Q=this[W(1025)+W(779)];this[W(847)]=function(Y){var he=W;try{var me=JSON[he(767)](Y,_k);me[he(648)](function(le){var X=he;if(D[X(668)](le[X(670)],void 0)){if(D[X(569)](le.tk,"")){delete le.ts,pn[le.tk][le[X(635)]]=Object[X(862)]({},pn[le.tk][le[X(635)]],le);var V=D[X(737)](Ff,pn[le.tk][le[X(635)]],p[r]);D[X(521)]($,V)}}else{var de=D[X(737)](Ff,JSON[X(767)](Y)[0],p[r]);if(D[X(834)](de.s,"Ok"))de.s="ok",D[X(521)]($,de);else{de.s=D[X(664)],D[X(676)](Q,de);return}}})}catch(le){var ge={};ge[he(766)]=le,console[he(723)](D[he(528)],ge,D[he(950)])}},y[W(776)]=this[W(847)]}else if(e[W(850)](z,e[W(911)]))this[W(1025)+W(779)]=function(Y){var he=W;e[he(886)]($,Y)},y[W(923)]=this[W(1025)+W(779)];else if(e[W(850)](z,e[W(806)]))this[W(589)+W(905)]=function(){var Y=W;e[Y(1e3)]($),e[Y(793)](clearInterval,T[Y(892)][Y(517)]),!T[Y(892)][Y(772)+"ed"]&&e[Y(863)](b,m)?T[Y(892)][Y(942)+Y(474)]():e[Y(1019)](clearInterval,T[Y(892)][Y(682)+Y(970)])},y[W(1002)]=this[W(589)+W(905)];else{console[W(766)](e[W(706)],z);var _={};_[W(622)]=z,console[W(723)](e[W(706)],_,oe)}}catch(Y){console[W(766)](e[W(666)],Y,oe)}});Pe(this,O,function(){var z=s,$={NdYpT:function(Q,_){var Y=fs;return e[Y(850)](Q,_)},AYZul:function(Q,_,Y){var he=fs;return e[he(644)](Q,_,Y)},jyWcm:function(Q,_,Y){var he=fs;return e[he(969)](Q,_,Y)},egYht:function(Q,_){var Y=fs;return e[Y(850)](Q,_)},iJZRQ:e[z(911)]};const W=e[z(693)];try{for(var D=e[z(514)][z(701)]("|"),oe=-21*-394+-4741*1+-3533;;){switch(D[oe++]){case"0":this[z(517)]=e[z(644)](setInterval,()=>{this[Ik]()},-2591*-2+-1824+-3357);continue;case"1":e[z(597)](this[z(847)],void 0)?y[z(776)]=function(Q){var _=z,Y=JSON[_(767)](Q,_k);Y[_(648)](function(he){var me=_;if($[me(649)](he[me(670)],void 0)){delete he.ts,pn[he.tk][he[me(635)]]=Object[me(862)]({},pn[he.tk][he[me(635)]],he);var ge=$[me(1003)](Ff,pn[he.tk][he[me(635)]],p[r]),le={};le[me(974)+me(1050)]=ge,console[me(723)](le)}else{var X=[$[me(805)](Ff,JSON[me(767)](Q)[0],p[r])];if($[me(698)](X[8649+2*3911+-1267*13].s,"Ok")){X[-3*-1457+1586*4+1*-10715].s="ok";var V={};V[me(974)+me(1050)]=X,console[me(723)](V)}else{X[4876+-4*1219].s=$[me(812)];var de={};de[me(974)+me(1050)]=X,console[me(723)](de);return}}})}:y[z(776)]=this[z(847)];continue;case"2":y[z(951)](x);continue;case"3":var Z=this[z(606)];continue;case"4":e[z(488)](this[z(948)+"en"],void 0)?(y[z(885)]=function(){var Q=z;console[Q(723)](e[Q(734)]),b=1*-9068+1899+7169;var _={};_[Q(498)]="cn",_[Q(1047)]=Z,_[Q(539)]="P",fe[Q(532)](_)},this[z(948)+"en"]=y[z(885)]):y[z(885)]=this[z(948)+"en"];continue;case"5":e[z(853)](this[z(589)+z(905)],void 0)?(y[z(1002)]=function(){var Q=z;e[Q(755)](clearInterval,T[Q(892)][Q(517)]),console[Q(723)](e[Q(788)]),!T[Q(892)][Q(772)+"ed"]&&e[Q(1022)](b,m)?T[Q(892)][Q(942)+Q(474)]():e[Q(896)](clearInterval,T[Q(892)][Q(682)+Q(970)])},this[z(589)+z(905)]=y[z(1002)]):y[z(1002)]=this[z(589)+z(905)];continue;case"6":e[z(597)](this[z(1025)+z(779)],void 0)?(y[z(923)]=function(Q){var _=z;if(console[_(723)](e[_(483)]),e[_(1041)](Q,void 0)){var Y={};Y[_(1014)+"r"]=Q,console[_(723)](Y)}},this[z(1025)+z(779)]=y[z(923)]):y[z(923)]=this[z(1025)+z(779)];continue;case"7":var fe=C;continue}break}}catch{console[z(766)]((e[z(550)],W))}});Pe(this,I,async(z,$=!1,W=7175+-3*-3302+-5690*3)=>{var D=s,oe={bznqA:e[D(881)],rDSrv:e[D(964)],IZTkW:function(be,We){var J=D;return e[J(547)](be,We)},AoHsf:function(be,We){var J=D;return e[J(547)](be,We)},SrnYq:e[D(823)],oDhxt:e[D(855)],driuJ:e[D(537)]};const Z=e[D(486)];try{var fe=this[D(1025)+D(779)];if(e[D(780)](W,-5*895+-4628+9103)||e[D(631)](W,2440+-2410*1)){e[D(909)](fe,{code:-(-1*-7048+45+13*-538),type:e[D(918)],message:e[D(1027)],s:e[D(911)]}),console[D(766)](e[D(594)],{code:-(6738*1+9171+-15810),type:e[D(918)],message:e[D(1027)],s:e[D(911)]},Z);return}var Q=e[D(886)](dV,l);if(e[D(476)](e[D(554)](z[D(889)],Q),-7645+1*-6339+18984)){console[D(766)](e[D(637)],{code:-(1098*-1+-1394+-1*-2843),type:e[D(918)],message:D(596)+D(979)+D(866)+D(946)+e[D(872)](3*-2692+219+12857,Q)+(D(818)+D(1036)+D(906)+D(1038)+"s"),s:e[D(911)]},Z),e[D(601)](fe,{code:-(1*-3294+1635*-3+8550),type:e[D(918)],message:D(596)+D(979)+D(866)+D(946)+e[D(577)](1*-6427+1346+5581,Q)+(D(818)+D(1036)+D(906)+D(1038)+"s"),s:e[D(911)],count:e[D(872)](9375+-19*361+414*6,Q)});return}var _=e[D(985)](e[D(985)](l.if[W][D(889)],l.dp[W][D(889)]),l.sf[W][D(889)]);if(e[D(1010)](e[D(554)](z[D(889)],_),9692*1+7930+6311*-2)){console[D(766)](e[D(637)],{code:-(-3187+2*1769),type:e[D(918)],message:D(596)+D(979)+D(866)+D(946)+e[D(872)](5e3,_)+(D(818)+D(1036)+"t"),s:e[D(911)]},Z),e[D(796)](fe,{code:-(493+5*1421+-7247*1),type:e[D(918)],message:D(596)+D(979)+D(866)+D(946)+e[D(577)](-8151+4181*-1+4*4333,_)+(D(818)+D(1036)+"t"),s:e[D(911)],count:e[D(872)](5e3,_)});return}var Y=[],he=[];const be=J=>new Promise(se=>setTimeout(se,J));if(e[D(511)](y,void 0)?await e[D(1026)](be,6445+-1978*1+-3467):!y[D(629)+"d"]()&&await e[D(878)](be,1e3),e[D(1043)](y,void 0)){e[D(1026)](fe,{code:-(-2792*-1+2*-348+-1997*1),type:e[D(918)],message:e[D(709)],s:e[D(911)]}),console[D(766)](e[D(741)],{code:-(-563*5+9083+-6169),type:e[D(918)],message:e[D(709)],s:e[D(911)]},Z);return}else if(!y[D(629)+"d"]()){console[D(766)](e[D(580)],{code:-(-652*-1+1988+-2541),type:e[D(918)],message:e[D(580)],s:e[D(911)]},Z),e[D(878)](fe,{code:-99,type:e[D(918)],message:e[D(580)],s:e[D(911)]});return}var me=f,ge=e[D(644)](cd,z,500),le=[];ge[D(648)](J=>{var se=D,Te={};Te[se(835)]=J;var Me=Te;le[se(824)](Me)});const We=e[D(839)];var X=await e[D(544)](Nk,We,me,le,fe);for(const[J,se]of Object[D(675)](X))if(!e[D(782)](se,void 0)){var V=J[D(701)]("-");if(e[D(480)](V[e[D(872)](V[D(889)],-305+-1364*5+7126)],e[D(880)]))for(var de=e[D(838)][D(701)]("|"),je=3342+1*-9733+11*581;;){switch(de[je++]){case"0":var _e=se[D(652)](8840+1*2417+-11257,15*-647+9582+127);continue;case"1":var Re=e[D(554)](e[D(547)](Be,"|"),$e);continue;case"2":var Be=Mf[_e];continue;case"3":if(e[D(850)]($e,void 0)){e[D(896)](fe,{code:-(10898+1*-10883),type:e[D(918)],message:e[D(630)],s:e[D(911)],symbol:J});var Se={};Se[D(966)]=J,console[D(766)](e[D(524)],Se,Z)}else if($)e[D(896)](fe,{code:-99,type:e[D(918)],message:e[D(747)],s:e[D(911)]}),console[D(766)](e[D(524)],{code:-(-3662*-1+-4122+559),type:e[D(918)],message:e[D(747)],s:e[D(911)]},Z);else for(var ie=e[D(729)][D(701)]("|"),ve=0;;){switch(ie[ve++]){case"0":Y[D(824)](Re);continue;case"1":if(e[D(686)](pn[$e].if,void 0)){var Ae={};Ae[D(966)]=J,pn[$e].if=Ae}continue;case"2":l.if[W]=e[D(789)](Ok,l.if[W],$e);continue;case"3":e[D(634)](pn[$e].if[e[D(556)]],void 0)&&(pn[$e].if[e[D(556)]]=J);continue;case"4":e[D(1043)](pn[$e],void 0)&&(pn[$e]={});continue}break}continue;case"4":var $e=Tp[e[D(639)]][J];continue}break}else for(var qe=e[D(617)][D(701)]("|"),Ie=-2402*-3+5935+-17*773;;){switch(qe[Ie++]){case"0":var $e=se[D(1007)](-4037+8*371+1079);continue;case"1":var Be=Mf[_e];continue;case"2":var Re=e[D(985)](e[D(985)](Be,"|"),$e);continue;case"3":l[K][W]=e[D(789)](Ok,l[K][W],$e);continue;case"4":var _e=se[D(652)](3*-453+8948*1+-7589*1,-12358+-6181*-2);continue;case"5":if($){var K="dp";if(e[D(597)](pn[$e],void 0)&&(pn[$e]={}),e[D(597)](pn[$e][K],void 0)){var Ee={};Ee[D(966)]=J,pn[$e][K]=Ee}e[D(634)](pn[$e][K][e[D(556)]],void 0)&&(pn[$e][K][e[D(556)]]=J)}else{var K="sf";if(e[D(952)](pn[$e],void 0)&&(pn[$e]={}),e[D(677)](pn[$e][K],void 0)){var Oe={};Oe[D(966)]=J,pn[$e][K]=Oe}e[D(952)](pn[$e][K][e[D(556)]],void 0)&&(pn[$e][K][e[D(556)]]=J)}continue;case"6":he[D(824)](Re);continue}break}}var q=[];if(e[D(1041)](Y[D(889)],3501+9111*-1+5610)&&e[D(969)](cd,Y,1500)[D(648)](se=>{for(var Te=D,Me=oe[Te(924)][Te(701)]("|"),Qe=-10716+38*282;;){switch(Me[Qe++]){case"0":se[Te(648)](ke=>{var Ne=Te;re=ue[Ne(973)](ue[Ne(574)](re,ke),"&")});continue;case"1":var ye={};ye[Te(498)]=oe[Te(704)],ye[Te(482)]=re,ye[Te(891)]=W,q[Te(824)](ye);continue;case"2":var ue={pRnad:function(ke,Ne){var U=Te;return oe[U(757)](ke,Ne)},HMddt:function(ke,Ne){var U=Te;return oe[U(757)](ke,Ne)}};continue;case"3":re=re[Te(652)](-6989+1868*-3+12593,-(-887*9+8600+-616));continue;case"4":var re="";continue}break}}),e[D(523)](he[D(889)],-8*-326+-123+-2485)&&e[D(969)](cd,he,1500)[D(648)](se=>{for(var Te=D,Me=oe[Te(867)][Te(701)]("|"),Qe=-9270+-3907*-1+5363;;){switch(Me[Qe++]){case"0":if($)var ye=oe[Te(548)];else var ye=oe[Te(1023)];continue;case"1":ue=ue[Te(652)](1095*-1+1*4069+-2974,-(8213+2053*-4));continue;case"2":var ue="";continue;case"3":var re={};re[Te(498)]=ye,re[Te(482)]=ue,re[Te(891)]=W,q[Te(824)](re);continue;case"4":se[Te(648)](ke=>{var Ne=Te;ue=oe[Ne(757)](oe[Ne(801)](ue,ke),"&")});continue}break}}),e[D(1041)](q[D(889)],-7972*-1+-2*3693+-293*2)){var ee=e[D(909)](Bf,W);if(e[D(616)](W,r)){var ce={};ce[D(498)]="cp",ce[D(891)+"s"]=ee,q[D(824)](ce);var Ce={};Ce[D(498)]="cr",Ce[D(891)+"s"]=[W],q[D(824)](Ce)}C[D(532)](q)}}catch(be){console[D(766)](e[D(808)],be,Z)}});Pe(this,P,async(z,$=!1,W=1*-1415+-2572+3998)=>{var D=s,oe={FDWTB:e[D(543)],zkIOe:e[D(633)],SaPAF:e[D(494)],diWiR:function(q,ee){var ce=D;return e[ce(985)](q,ee)},FHrLf:function(q,ee){var ce=D;return e[ce(926)](q,ee)},TWNBt:function(q,ee,ce){var Ce=D;return e[Ce(837)](q,ee,ce)},AlnzI:function(q,ee,ce){var Ce=D;return e[Ce(969)](q,ee,ce)}};const Z=e[D(1031)];try{var fe=this[D(1025)+D(779)];if(e[D(780)](W,-1*-8429+252+-8681)||e[D(476)](W,7*-1114+-1*-8807+-979*1)){e[D(601)](fe,{code:-(-488*-6+-3270+441),type:e[D(918)],message:e[D(1027)],s:e[D(911)]}),console[D(766)](e[D(594)],{code:-(8052+-7531*1+-422),type:e[D(918)],message:e[D(1027)],s:e[D(911)]},Z);return}var Q=[],_=[],Y=[];if(e[D(777)](y,void 0)){e[D(655)](fe,{code:-(956*6+-3007*2+377),type:e[D(918)],message:e[D(709)],s:e[D(911)]}),console[D(766)](e[D(741)],{code:-(3*-1455+-10*-963+369*-14),type:e[D(918)],message:e[D(709)],s:e[D(911)]},Z);return}else if(!y[D(629)+"d"]()){e[D(773)](fe,{code:-(2641*1+-3911*1+-1369*-1),type:e[D(918)],message:e[D(580)],s:e[D(911)]}),console[D(766)](e[D(580)],{code:-(3733*-1+563+-1*-3269),type:e[D(918)],message:e[D(580)],s:e[D(911)]},Z);return}var he=f,me=e[D(789)](cd,z,-564*1+-3213+4277),ge=[];me[D(648)](ee=>{var ce=D,Ce={};Ce[ce(835)]=ee;var be=Ce;ge[ce(824)](be)});const q=e[D(839)];var le=await e[D(724)](Nk,q,he,ge);for(const[ee,ce]of Object[D(675)](le))if(!e[D(782)](ce,void 0)){var X=ee[D(701)]("-");if(e[D(777)](X[e[D(605)](X[D(889)],461*21+2631+-12311)],e[D(880)]))for(var V=e[D(667)][D(701)]("|"),de=0;;){switch(V[de++]){case"0":var je=Tp[e[D(639)]][ee];continue;case"1":var _e=e[D(641)](e[D(554)](Re,"|"),je);continue;case"2":var Re=Mf[Be];continue;case"3":var Be=ce[D(652)](357*-15+-9486+14841,4);continue;case"4":if(e[D(511)](je,void 0)){e[D(485)](fe,{code:-(7169+-1543*2+-4068),type:e[D(918)],message:e[D(630)],s:e[D(911)],symbol:ee});var Se={};Se[D(966)]=ee,console[D(766)](e[D(524)],Se,Z)}else if($)e[D(672)](fe,{code:-(7*-569+-7063*1+15*743),type:e[D(918)],message:e[D(747)],s:e[D(911)]}),console[D(766)](e[D(524)],{code:-(3464+-1549*4+2831),type:e[D(918)],message:e[D(747)],s:e[D(911)]},Z);else{var ie="if";Q[D(824)](_e);var ve={};ve[D(843)+D(696)]=je,ve[D(513)]=ie,Y[D(824)](ve)}continue}break}else for(var Ae=e[D(607)][D(701)]("|"),$e=3*3281+-639+-9204;;){switch(Ae[$e++]){case"0":var je=ce[D(1007)](1*-2264+690+396*4);continue;case"1":var Be=ce[D(652)](7188+-8*-764+-266*50,1*-3794+7*-1207+-331*-37);continue;case"2":var _e=e[D(820)](e[D(985)](Re,"|"),je);continue;case"3":var Re=Mf[Be];continue;case"4":if($)var ie="dp";else var ie="sf";continue;case"5":var qe={};qe[D(843)+D(696)]=je,qe[D(513)]=ie,Y[D(824)](qe);continue;case"6":_[D(824)](_e);continue}break}}var Ie=[];if(e[D(523)](Q[D(889)],-5*-1114+114+-5684)&&e[D(644)](cd,Q,1500)[D(648)](ce=>{for(var Ce=D,be=e[Ce(875)][Ce(701)]("|"),We=0;;){switch(be[We++]){case"0":var J="";continue;case"1":var se={};se[Ce(498)]=e[Ce(697)],se[Ce(482)]=J,se[Ce(891)]=W,Ie[Ce(824)](se);continue;case"2":ce[Ce(648)](Me=>{var Qe=Ce;J=Te[Qe(626)](Te[Qe(888)](J,Me),"&")});continue;case"3":var Te={GOpdJ:function(Me,Qe){var ye=Ce;return e[ye(985)](Me,Qe)},oKJbT:function(Me,Qe){var ye=Ce;return e[ye(547)](Me,Qe)}};continue;case"4":J=J[Ce(652)](-3*-687+3403+683*-8,-1);continue}break}}),e[D(947)](_[D(889)],-3003+-2*-2811+-2619)&&e[D(837)](cd,_,1500)[D(648)](ce=>{for(var Ce=D,be=oe[Ce(752)][Ce(701)]("|"),We=-6108+-5326*-1+782;;){switch(be[We++]){case"0":Me=Me[Ce(652)](-3*1797+1*-5953+1418*8,-(-1261+2*631));continue;case"1":var J={};J[Ce(498)]=se,J[Ce(482)]=Me,J[Ce(891)]=W,Ie[Ce(824)](J);continue;case"2":if($)var se=oe[Ce(836)];else var se=oe[Ce(893)];continue;case"3":var Te={VtJCM:function(Qe,ye){var ue=Ce;return oe[ue(870)](Qe,ye)}};continue;case"4":var Me="";continue;case"5":ce[Ce(648)](Qe=>{var ye=Ce;Me=Te[ye(602)](Te[ye(602)](Me,Qe),"&")});continue}break}}),e[D(1041)](Ie[D(889)],1014*-5+9331+-4261)){var K=e[D(658)](Bf,W);if(e[D(715)](W,r)){var Ee={};Ee[D(498)]="cp",Ee[D(891)+"s"]=K,Ie[D(824)](Ee);var Oe={};Oe[D(498)]="cr",Oe[D(891)+"s"]=[W],Ie[D(824)](Oe)}C[D(532)](Ie)}e[D(568)](Y[D(889)],2498*-2+-6980+11976)&&Y[D(648)](ee=>{var ce=D;!oe[ce(736)](pn[ee[ce(843)+ce(696)]],void 0)&&oe[ce(1011)](uV,l[ie],ee[ce(843)+ce(696)])&&delete pn[ee[ce(843)+ce(696)]][ee[ce(513)]],l[ie][W]=oe[ce(809)](Bf,ee[ce(843)+ce(696)],l[ie][W])})}catch(q){console[D(766)](e[D(904)],q,Z)}});Pe(this,M,function(){var z=s;const $=e[z(806)];try{if(e[z(903)](y,void 0)){console[z(723)](e[z(560)]);return}else if(y[z(629)+"d"]())for(var W=e[z(608)][z(701)]("|"),D=-3694*-1+-1*-4694+932*-9;;){switch(W[D++]){case"0":e[z(1030)](clearInterval,this[z(685)+z(694)]);continue;case"1":this[z(772)+"ed"]=!0;continue;case"2":C[z(578)]();continue;case"3":console[z(555)](e[z(933)],{},$);continue;case"4":y[z(733)]();continue;case"5":e[z(742)](clearInterval,this[z(517)]);continue;case"6":pn={};continue;case"7":e[z(1019)](clearInterval,this[z(682)+z(970)]);continue}break}else{console[z(723)](e[z(560)]);return}}catch(oe){console[z(766)](e[z(647)],oe,$)}});Pe(this,R,function(){var z=s;return e[z(677)](y,void 0)?!1:!!y[z(629)+"d"]()});Pe(this,A,function(z){var $=s;const W=e[$(945)];try{if(e[$(983)](z[$(884)+"r"],Number)){if(e[$(631)](channel,30)||e[$(671)](channel,6569*1+469+-7037)){console[$(723)](e[$(865)]),console[$(766)](e[$(865)],null,W);return}var D=e[$(742)](Bf,z),oe={};oe[$(498)]="cp",oe[$(891)+"s"]=D;var Z={};Z[$(498)]="cr",Z[$(891)+"s"]=[z],C[$(532)]([oe,Z])}else console[$(723)](e[$(976)])}catch(fe){console[$(766)](e[$(515)],fe,W)}});Pe(this,k,function(z,$=-5919*1+2075+3855){var W=s,D={hwROt:function(Q,_){var Y=fs;return e[Y(1010)](Q,_)},RlmWN:function(Q,_){var Y=fs;return e[Y(863)](Q,_)},AYmbz:e[W(865)]};const oe=e[W(1045)];try{if(e[W(828)]($[W(884)+"r"],Array)){$[W(648)](Q=>{var _=W;if(D[_(674)](Q,-4*-2422+-7243*-1+1*-16901)||D[_(722)](Q,2711*1+-3318+-608*-1)){console[_(723)](D[_(739)]),console[_(766)](D[_(739)],null,oe);return}});var Z={};Z[W(498)]=z,Z[W(891)+"s"]=$,C[W(532)](Z),e[W(984)](z,e[W(531)])?$[W(648)](Q=>{p[Q]=!0}):$[W(648)](Q=>{p[Q]=!1})}else if(e[W(488)]($[W(884)+"r"],Number)){if(e[W(476)]($,-756+4852*2+-8918)||e[W(604)]($,1)){console[W(723)](e[W(865)]),console[W(766)](e[W(865)],null,oe);return}var fe={};fe[W(498)]=z,fe[W(891)+"s"]=[$],C[W(532)](fe),e[W(828)](z,e[W(531)])?p[$]=!0:p[$]=!1}else console[W(723)](e[W(489)]),console[W(766)](e[W(489)],null,oe)}catch(Q){console[W(766)](e[W(582)],Q,oe)}});Pe(this,j,function(){var z=s,$={rtTgL:function(oe,Z){var fe=fs;return e[fe(604)](oe,Z)},Ifeuq:e[z(815)],KSKCm:function(oe,Z){var fe=z;return e[fe(869)](oe,Z)},xqrDu:function(oe,Z){var fe=z;return e[fe(651)](oe,Z)},budZX:e[z(732)]};const W=e[z(897)];if(this[z(646)+z(650)]){var D=Math[z(499)](e[z(999)](e[z(890)](b,5),5));D*=-8286+-1*-8116+175;try{this[z(685)+z(694)]=e[z(837)](setTimeout,()=>{var oe=z;if(!y[oe(629)+"d"]()&&$[oe(895)](b,m)){console[oe(723)]($[oe(625)],$[oe(727)](b,1*-9401+-1320+10722)),b++;var Z={};Z[1]=[],Z[2]=[],Z[3]=[],Z[4]=[],Z[5]=[],Z[6]=[],Z[7]=[],Z[8]=[],Z[9]=[],Z[10]=[],Z[11]=[],Z[12]=[],Z[13]=[],Z[14]=[],Z[15]=[],Z[16]=[],Z[17]=[],Z[18]=[],Z[19]=[],Z[20]=[],Z[21]=[],Z[22]=[],Z[23]=[],Z[24]=[],Z[25]=[],Z[26]=[],Z[27]=[],Z[28]=[],Z[29]=[],Z[30]=[];var fe={};fe[1]=[],fe[2]=[],fe[3]=[],fe[4]=[],fe[5]=[],fe[6]=[],fe[7]=[],fe[8]=[],fe[9]=[],fe[10]=[],fe[11]=[],fe[12]=[],fe[13]=[],fe[14]=[],fe[15]=[],fe[16]=[],fe[17]=[],fe[18]=[],fe[19]=[],fe[20]=[],fe[21]=[],fe[22]=[],fe[23]=[],fe[24]=[],fe[25]=[],fe[26]=[],fe[27]=[],fe[28]=[],fe[29]=[],fe[30]=[];var Q={};Q[1]=[],Q[2]=[],Q[3]=[],Q[4]=[],Q[5]=[],Q[6]=[],Q[7]=[],Q[8]=[],Q[9]=[],Q[10]=[],Q[11]=[],Q[12]=[],Q[13]=[],Q[14]=[],Q[15]=[],Q[16]=[],Q[17]=[],Q[18]=[],Q[19]=[],Q[20]=[],Q[21]=[],Q[22]=[],Q[23]=[],Q[24]=[],Q[25]=[],Q[26]=[],Q[27]=[],Q[28]=[],Q[29]=[],Q[30]=[];var _={};_.if=Z,_.sf=fe,_.dp=Q,l=_,this[oe(951)]()}else $[oe(653)](b,m)&&(console[oe(723)]($[oe(980)]),b=0)},e[z(900)](D,-1893+-2893*-1))}catch(oe){console[z(766)](e[z(856)],oe,W)}}});Pe(this,E,function(z=1*-1934+-2233*1+4*1043){var $=s;this[$(646)+$(650)]=!0,m=e[$(587)](z,50)?-8441+-7*-1213:z});for(var D=s,oe=e[D(534)][D(701)]("|"),Z=-3151*1+8146+-3*1665;;){switch(oe[Z++]){case"0":if(T[D(892)])throw new Error(e[D(1006)]);continue;case"1":fe[D(992)+D(761)]=function(Q){var _=D,Y={};Y[_(974)+_(1050)]=Q,console[_(723)](Y)};continue;case"2":fe[D(682)+D(970)]=e[D(837)](setInterval,()=>{w=2449+359*-15+1*2936},1e3);continue;case"3":fe[D(1056)]=e[D(531)];continue;case"4":fe[D(636)+"g"]=W;continue;case"5":fe[D(517)]=void 0;continue;case"6":f=z;continue;case"7":T[D(892)]=this;continue;case"8":fe[D(685)+D(694)]=void 0;continue;case"9":fe[D(646)+D(650)]=!1;continue;case"10":fe[D(935)]=e[D(967)];continue;case"11":fe[D(778)]=$;continue;case"12":fe[D(847)]=void 0;continue;case"13":h=e[D(796)](gV,f);continue;case"14":fe[D(948)+"en"]=void 0;continue;case"15":fe[D(589)+D(905)]=void 0;continue;case"16":fe[D(1025)+D(779)]=void 0;continue;case"17":var fe=this;continue;case"18":fe[D(772)+"ed"]=!1;continue}break}}static[s(1052)+"e"](z,$,W=!0){var D=s;return!T[D(892)]&&(T[D(892)]=new T(z,$,W)),T[D(892)]}async[Dk](){var z=s;return await C[z(525)]()}[(B=Ik,G=s(553),O=s(951),I=s(960),P=s(810)+"e",M=s(733),R=s(629)+"d",A=s(748)+s(745),k=s(539),j=s(942)+s(474),E=s(646)+s(978),B)](){var z=s,$={SCJJN:function(D,oe){var Z=fs;return e[Z(983)](D,oe)},VzKNg:e[z(964)],ePGkm:e[z(697)],advuU:e[z(537)],eqauX:function(D,oe){var Z=z;return e[Z(850)](D,oe)},IRAfS:e[z(494)],VjAfA:function(D,oe){var Z=z;return e[Z(983)](D,oe)},ssfbg:e[z(855)],AwcNt:e[z(633)],pRqJB:function(D,oe){var Z=z;return e[Z(983)](D,oe)},RSosa:function(D,oe){var Z=z;return e[Z(983)](D,oe)}};const W=e[z(943)];try{if(e[z(476)](w,10)||!y[z(629)+"d"]())return;this[Dk]()[z(563)](async D=>{var oe=z;$[oe(665)](D,void 0)||($[oe(821)](D[oe(884)+"r"],Array)?D[oe(648)](async Z=>{var fe=oe;($[fe(566)](Z[fe(498)],$[fe(527)])||$[fe(566)](Z[fe(498)],$[fe(998)])||$[fe(566)](Z[fe(498)],$[fe(929)])||$[fe(821)](Z[fe(498)],$[fe(833)])||$[fe(665)](Z[fe(498)],$[fe(504)])||$[fe(821)](Z[fe(498)],$[fe(613)]))&&(r=Z[fe(891)]),await this[fe(553)](-876*1+4*1231+-3548),y[fe(532)](JSON[fe(520)](Z)),w++}):(($[oe(566)](D[oe(498)],$[oe(527)])||$[oe(877)](D[oe(498)],$[oe(998)])||$[oe(803)](D[oe(498)],$[oe(929)])||$[oe(821)](D[oe(498)],$[oe(833)])||$[oe(566)](D[oe(498)],$[oe(504)])||$[oe(877)](D[oe(498)],$[oe(613)]))&&(r=D[oe(891)]),await this[oe(553)](1811+2572*-3+6405),y[oe(532)](JSON[oe(520)](D)),w++))})}catch(D){console[z(723)](e[z(565)],D,W)}}}return T})();class mV{constructor(){Pe(this,"fyers",null);Pe(this,"isInitialized",!1);Pe(this,"symbolMasterCache",[])}async initialize(){try{const e=await Je.getCredentialByService("fyers");if(!e||!e.api_key||!e.api_secret||!e.password)return!1;const n=(e.additional_data?JSON.parse(e.additional_data):{}).appType||"100",i=`${e.api_key}-${n}:${e.password}`;return this.fyers=new YK({AccessToken:i,AppID:e.api_key,RedirectURL:e.api_secret,enableLogging:!1}),this.isInitialized=!0,!0}catch(e){return console.error("[Fyers]  Initialization error:",e),this.isInitialized=!1,!1}}async saveCredentials(e){await Je.saveCredential({service_name:"fyers",username:"fyers_user",api_key:e.appId,api_secret:e.redirectUrl,password:e.accessToken,additional_data:JSON.stringify({appType:e.appType||"100",connected_at:new Date().toISOString()})}),await this.initialize()}isReady(){return this.isInitialized&&this.fyers!==null}async getProfile(){if(!this.isReady())throw new Error("Fyers service not initialized");const e=await this.fyers.get_profile();if(e.s!=="ok")throw new Error(e.message||"Failed to fetch profile");return e.data}async getFunds(){if(!this.isReady())throw new Error("Fyers service not initialized");const e=await this.fyers.get_funds();if(e.s!=="ok")throw new Error(e.message||"Failed to fetch funds");return e.fund_limit}async getHoldings(){if(!this.isReady())throw new Error("Fyers service not initialized");const e=await this.fyers.get_holdings();if(e.s!=="ok")throw new Error(e.message||"Failed to fetch holdings");return{overall:e.overall,holdings:e.holdings}}async getPositions(){if(!this.isReady())throw new Error("Fyers service not initialized");const e=await this.fyers.get_positions();if(e.s!=="ok")throw new Error(e.message||"Failed to fetch positions");return e.netPositions||[]}async placeOrder(e){if(!this.isReady())throw new Error("Fyers service not initialized");const r=await this.fyers.place_order(e);if(r.s!=="ok")throw new Error(r.message||"Failed to place order");return{orderId:r.id||"",message:r.message||"Order placed successfully"}}async getOrders(){if(!this.isReady())throw new Error("Fyers service not initialized");const e=await this.fyers.get_orders();if(e.s!=="ok")throw new Error(e.message||"Failed to fetch orders");return e.orderBook||[]}async cancelOrder(e){if(!this.isReady())throw new Error("Fyers service not initialized");const r=await this.fyers.cancel_order({id:e});if(r.s!=="ok")throw new Error(r.message||"Failed to cancel order")}async getMarketStatus(){if(!this.isReady())throw new Error("Fyers service not initialized");const e=await this.fyers.market_status();if(e.s!=="ok")throw new Error(e.message||"Failed to fetch market status");return e.marketStatus}async placeGTTOrder(e){if(!this.isReady())throw new Error("Fyers service not initialized");const r=await this.fyers.place_gtt_order(e);if(r.s!=="ok")throw new Error(r.message||"GTT Order placement failed");return r}async getQuotes(e){if(!this.isReady())throw new Error("Fyers service not initialized");const r=await this.fyers.getQuotes(e);if(r.s!=="ok")throw console.error("[Fyers] Quote API error:",r),new Error(r.message||"Failed to fetch quotes");const n=r.d||r.data||[];if(!Array.isArray(n)||n.length===0)return console.error("[Fyers] Invalid or empty quote data"),{};const i={};return n.forEach(o=>{const a=o.n||o.symbol;if(!a)return;const l=o.v||o;i[a]={n:a,lp:l.lp||l.last_price||0,ltp:l.lp||l.ltp||l.last_price||0,ch:l.ch||l.change||0,chp:l.chp||l.change_percent||0,high:l.high_price||l.h||l.high||0,low:l.low_price||l.l||l.low||0,open:l.open_price||l.o||l.open||0,volume:l.volume||l.v||0,v:l.volume||l.v||0,o:l.open_price||l.o||l.open||0,h:l.high_price||l.h||l.high||0,l:l.low_price||l.l||l.low||0,...l}}),i}async getMarketDepth(e,r=!0){if(!this.isReady())throw new Error("Fyers service not initialized");const n=await this.fyers.getMarketDepth({symbol:e,ohlcv_flag:r?1:0});if(n.s!=="ok")throw new Error(n.message||"Failed to fetch market depth");return n.d}async getHistory(e){if(!this.isReady())throw new Error("Fyers service not initialized");const r=await this.fyers.getHistory(e);if(r.s!=="ok")throw new Error(r.message||"Failed to fetch history");return r}async getOptionChain(e,r=5,n=""){if(!this.isReady())throw new Error("Fyers service not initialized");const i=await this.fyers.getOptionChain({symbol:e,strikecount:r,timestamp:n});if(i.code!==200)throw new Error(i.message||"Failed to fetch option chain");return i.data}isMarketOpen(){const e=new Date,r=5.5*60*60*1e3,n=new Date(e.getTime()+r),i=n.getUTCDay(),o=n.getUTCHours(),a=n.getUTCMinutes(),l=o*60+a;return i===0||i===6?!1:l>=555&&l<=930}async loadSymbolMaster(){try{const r=await(await tn("https://public.fyers.in/sym_details/NSE_CM_sym_master.json")).json();r&&typeof r=="object"&&!Array.isArray(r)?this.symbolMasterCache=Object.entries(r).map(([n,i])=>({symbol:n,fytoken:i.fyToken||i.fytoken,fyToken:i.fyToken||i.fytoken,description:i.symbolDesc||i.symDetails||"",exchange:i.exchangeName||"NSE",segment:i.exSeries||"",lotsize:i.minLotSize||1,lotSize:i.minLotSize||1,tick_size:i.tickSize||.05,tickSize:i.tickSize||.05,shortName:i.short_name||i.exSymbol||"",displayName:i.display_format_mob||i.exSymName||""})):Array.isArray(r)?this.symbolMasterCache=r:this.symbolMasterCache=[]}catch(e){console.error("[Fyers]  Failed to load symbol master:",e),this.symbolMasterCache=[]}}searchSymbols(e,r=20){if(!Array.isArray(this.symbolMasterCache)||this.symbolMasterCache.length===0)return console.warn("[Fyers] Symbol master not loaded or invalid"),[];if(!e||e.trim().length===0)return[];const n=e.toLowerCase().trim();try{return this.symbolMasterCache.filter(i=>{if(!i)return!1;const o=i.symbol?.toLowerCase()||"",a=i.description?.toLowerCase()||"",l=i.shortName?.toLowerCase()||"",d=i.displayName?.toLowerCase()||"";return o.includes(n)||a.includes(n)||l.includes(n)||d.includes(n)}).slice(0,r)}catch(i){return console.error("[Fyers] Error searching symbols:",i),[]}}getSymbol(e){return this.symbolMasterCache.find(r=>r.symbol===e)}async calculateSpanMargin(e){if(!this.isReady())throw new Error("Fyers service not initialized");const r={symbol:e.symbol,qty:e.qty,side:e.side==="BUY"?1:-1,type:e.type==="MARKET"?2:e.type==="LIMIT"?1:3,productType:e.productType,limitPrice:e.limitPrice||0,stopLoss:e.stopLoss||0,stopPrice:e.stopPrice||0,takeProfit:e.takeProfit||0},n=await this.fyers.span_margin(r);if(n.s!=="ok")throw new Error(n.message||"Failed to calculate margin");return n}async calculateMultiOrderMargin(e){if(!this.isReady())throw new Error("Fyers service not initialized");const r=e.map(i=>({symbol:i.symbol,qty:i.qty,side:i.side==="BUY"?1:-1,type:i.type==="MARKET"?2:i.type==="LIMIT"?1:3,productType:i.productType,limitPrice:i.limitPrice||0,stopLoss:i.stopLoss||0,stopPrice:i.stopPrice||0,takeProfit:i.takeProfit||0})),n=await this.fyers.multiorder_margin(r);if(n.s!=="ok")throw new Error(n.message||"Failed to calculate multi-order margin");return n}}const zn=new mV;class yV{constructor(){Pe(this,"socket",null);Pe(this,"isConnected",!1);Pe(this,"connectionString","");Pe(this,"orderCallbacks",[]);Pe(this,"tradeCallbacks",[]);Pe(this,"positionCallbacks",[]);Pe(this,"generalCallbacks",[]);Pe(this,"errorCallbacks",[])}connect(e,r){if(this.isConnected){Mr.debug("Already connected");return}this.connectionString=`${e}:${r}`,this.socket=new ZK(this.connectionString),this.socket.on("error",n=>{Mr.error("Error:",n),this.errorCallbacks.forEach(i=>i(n))}),this.socket.on("connect",()=>{Mr.info("Connected successfully"),this.isConnected=!0,this.socket.subscribe([this.socket.orderUpdates,this.socket.tradeUpdates,this.socket.positionUpdates,this.socket.edis,this.socket.pricealerts])}),this.socket.on("close",()=>{Mr.info("Connection closed"),this.isConnected=!1}),this.socket.on("orders",n=>{Mr.debug("Order update:",n),n.orders&&this.orderCallbacks.forEach(i=>i(n.orders))}),this.socket.on("trades",n=>{Mr.debug("Trade update:",n),n.trades&&this.tradeCallbacks.forEach(i=>i(n.trades))}),this.socket.on("positions",n=>{Mr.debug("Position update:",n),n.positions&&this.positionCallbacks.forEach(i=>i(n.positions))}),this.socket.on("general",n=>{Mr.debug("General update:",n),this.generalCallbacks.forEach(i=>i(n))}),this.socket.autoreconnect(),this.socket.connect()}disconnect(){this.socket&&this.isConnected&&(this.socket.close(),this.socket=null,this.isConnected=!1,Mr.info("Disconnected"))}getConnectionStatus(){return this.isConnected}onOrderUpdate(e){this.orderCallbacks.push(e)}onTradeUpdate(e){this.tradeCallbacks.push(e)}onPositionUpdate(e){this.positionCallbacks.push(e)}onGeneralUpdate(e){this.generalCallbacks.push(e)}onError(e){this.errorCallbacks.push(e)}clearCallbacks(){this.orderCallbacks=[],this.tradeCallbacks=[],this.positionCallbacks=[],this.generalCallbacks=[],this.errorCallbacks=[]}}const uc=new yV;const bV=s=>{const e=new ArrayBuffer(8),r=new Uint8Array(e);let n=s;for(let i=7;i>=0&&n!==0;i--)r[i]=n&255,n-=r[i],n/=256;return r};function vV(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function Bg(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function zd(s,...e){if(!vV(s))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(s.length))throw new Error("Uint8Array expected of length "+e+", got length="+s.length)}function SV(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Bg(s.outputLen),Bg(s.blockLen)}function Md(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function VO(s,e){zd(s);const r=e.outputLen;if(s.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function wV(s){return new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4))}function Ko(...s){for(let e=0;e<s.length;e++)s[e].fill(0)}function j0(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function Fo(s,e){return s<<32-e|s>>>e}function k0(s,e){return s<<e|s>>>32-e>>>0}const EV=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function CV(s){return s<<24&4278190080|s<<8&16711680|s>>>8&65280|s>>>24&255}function jV(s){for(let e=0;e<s.length;e++)s[e]=CV(s[e]);return s}const Pk=EV?s=>s:jV;function kV(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}function yx(s){return typeof s=="string"&&(s=kV(s)),zd(s),s}class Nv{}function Qd(s){const e=n=>s().update(yx(n)).digest(),r=s();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>s(),e}class XO extends Nv{update(e){return Md(this),this.iHash.update(e),this}digestInto(e){Md(this),zd(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:a,outputLen:l}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=a,e.outputLen=l,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}constructor(e,r){super(),this.finished=!1,this.destroyed=!1,SV(e);const n=yx(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let a=0;a<o.length;a++)o[a]^=54;this.iHash.update(o),this.oHash=e.create();for(let a=0;a<o.length;a++)o[a]^=106;this.oHash.update(o),Ko(o)}}const Rb=(s,e,r)=>new XO(s,e).update(r).digest();Rb.create=(s,e)=>new XO(s,e);function AV(s,e,r,n){if(typeof s.setBigUint64=="function")return s.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),a=Number(r>>i&o),l=Number(r&o),d=n?4:0,p=n?0:4;s.setUint32(e+d,a,n),s.setUint32(e+p,l,n)}function JO(s,e,r){return s&e^~s&r}function QO(s,e,r){return s&e^s&r^e&r}class Ov extends Nv{update(e){Md(this),e=yx(e),zd(e);const{view:r,buffer:n,blockLen:i}=this,o=e.length;for(let a=0;a<o;){const l=Math.min(i-this.pos,o-a);if(l===i){const d=j0(e);for(;i<=o-a;a+=i)this.process(d,a);continue}n.set(e.subarray(a,a+l),this.pos),this.pos+=l,a+=l,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Md(this),VO(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:o}=this;let{pos:a}=this;r[a++]=128,Ko(this.buffer.subarray(a)),this.padOffset>i-a&&(this.process(n,0),a=0);for(let h=a;h<i;h++)r[h]=0;AV(n,i-8,BigInt(this.length*8),o),this.process(n,0);const l=j0(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const p=d/4,f=this.get();if(p>f.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<p;h++)l.setUint32(4*h,f[h],o)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:o,destroyed:a,pos:l}=this;return e.destroyed=a,e.finished=o,e.length=i,e.pos=l,i%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}constructor(e,r,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=j0(this.buffer)}}const nl=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),sl=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Gs=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Us=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),pp=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),il=new Uint32Array(80);class TV extends Ov{get(){const{A:e,B:r,C:n,D:i,E:o}=this;return[e,r,n,i,o]}set(e,r,n,i,o){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0}process(e,r){for(let d=0;d<16;d++,r+=4)il[d]=e.getUint32(r,!1);for(let d=16;d<80;d++)il[d]=k0(il[d-3]^il[d-8]^il[d-14]^il[d-16],1);let{A:n,B:i,C:o,D:a,E:l}=this;for(let d=0;d<80;d++){let p,f;d<20?(p=JO(i,o,a),f=1518500249):d<40?(p=i^o^a,f=1859775393):d<60?(p=QO(i,o,a),f=2400959708):(p=i^o^a,f=3395469782);const h=k0(n,5)+p+l+f+il[d]|0;l=a,a=o,o=k0(i,30),i=n,n=h}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,a=a+this.D|0,l=l+this.E|0,this.set(n,i,o,a,l)}roundClean(){Ko(il)}destroy(){this.set(0,0,0,0,0),Ko(this.buffer)}constructor(){super(64,20,8,!1),this.A=pp[0]|0,this.B=pp[1]|0,this.C=pp[2]|0,this.D=pp[3]|0,this.E=pp[4]|0}}const RV=Qd(()=>new TV),$f=BigInt(2**32-1),Lk=BigInt(32);function NV(s,e=!1){return e?{h:Number(s&$f),l:Number(s>>Lk&$f)}:{h:Number(s>>Lk&$f)|0,l:Number(s&$f)|0}}function ZO(s,e=!1){const r=s.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:a,l}=NV(s[o],e);[n[o],i[o]]=[a,l]}return[n,i]}const zk=(s,e,r)=>s>>>r,Mk=(s,e,r)=>s<<32-r|e>>>r,dd=(s,e,r)=>s>>>r|e<<32-r,ud=(s,e,r)=>s<<32-r|e>>>r,Gf=(s,e,r)=>s<<64-r|e>>>r-32,Uf=(s,e,r)=>s>>>r-32|e<<64-r,OV=(s,e,r)=>s<<r|e>>>32-r,_V=(s,e,r)=>e<<r|s>>>32-r,DV=(s,e,r)=>e<<r-32|s>>>64-r,IV=(s,e,r)=>s<<r-32|e>>>64-r;function ba(s,e,r,n){const i=(e>>>0)+(n>>>0);return{h:s+r+(i/2**32|0)|0,l:i|0}}const PV=(s,e,r)=>(s>>>0)+(e>>>0)+(r>>>0),LV=(s,e,r,n)=>e+r+n+(s/2**32|0)|0,zV=(s,e,r,n)=>(s>>>0)+(e>>>0)+(r>>>0)+(n>>>0),MV=(s,e,r,n,i)=>e+r+n+i+(s/2**32|0)|0,BV=(s,e,r,n,i)=>(s>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),FV=(s,e,r,n,i,o)=>e+r+n+i+o+(s/2**32|0)|0,$V=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ol=new Uint32Array(64);class e_ extends Ov{get(){const{A:e,B:r,C:n,D:i,E:o,F:a,G:l,H:d}=this;return[e,r,n,i,o,a,l,d]}set(e,r,n,i,o,a,l,d){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=a|0,this.G=l|0,this.H=d|0}process(e,r){for(let h=0;h<16;h++,r+=4)ol[h]=e.getUint32(r,!1);for(let h=16;h<64;h++){const x=ol[h-15],m=ol[h-2],b=Fo(x,7)^Fo(x,18)^x>>>3,w=Fo(m,17)^Fo(m,19)^m>>>10;ol[h]=w+ol[h-7]+b+ol[h-16]|0}let{A:n,B:i,C:o,D:a,E:l,F:d,G:p,H:f}=this;for(let h=0;h<64;h++){const x=Fo(l,6)^Fo(l,11)^Fo(l,25),m=f+x+JO(l,d,p)+$V[h]+ol[h]|0,w=(Fo(n,2)^Fo(n,13)^Fo(n,22))+QO(n,i,o)|0;f=p,p=d,d=l,l=a+m|0,a=o,o=i,i=n,n=m+w|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,a=a+this.D|0,l=l+this.E|0,d=d+this.F|0,p=p+this.G|0,f=f+this.H|0,this.set(n,i,o,a,l,d,p,f)}roundClean(){Ko(ol)}destroy(){this.set(0,0,0,0,0,0,0,0),Ko(this.buffer)}constructor(e=32){super(64,e,8,!1),this.A=nl[0]|0,this.B=nl[1]|0,this.C=nl[2]|0,this.D=nl[3]|0,this.E=nl[4]|0,this.F=nl[5]|0,this.G=nl[6]|0,this.H=nl[7]|0}}class GV extends e_{constructor(){super(28),this.A=sl[0]|0,this.B=sl[1]|0,this.C=sl[2]|0,this.D=sl[3]|0,this.E=sl[4]|0,this.F=sl[5]|0,this.G=sl[6]|0,this.H=sl[7]|0}}const t_=ZO(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),UV=t_[0],WV=t_[1],al=new Uint32Array(80),ll=new Uint32Array(80);class r_ extends Ov{get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:a,Dh:l,Dl:d,Eh:p,El:f,Fh:h,Fl:x,Gh:m,Gl:b,Hh:w,Hl:y}=this;return[e,r,n,i,o,a,l,d,p,f,h,x,m,b,w,y]}set(e,r,n,i,o,a,l,d,p,f,h,x,m,b,w,y){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=a|0,this.Dh=l|0,this.Dl=d|0,this.Eh=p|0,this.El=f|0,this.Fh=h|0,this.Fl=x|0,this.Gh=m|0,this.Gl=b|0,this.Hh=w|0,this.Hl=y|0}process(e,r){for(let E=0;E<16;E++,r+=4)al[E]=e.getUint32(r),ll[E]=e.getUint32(r+=4);for(let E=16;E<80;E++){const j=al[E-15]|0,k=ll[E-15]|0,A=dd(j,k,1)^dd(j,k,8)^zk(j,k,7),R=ud(j,k,1)^ud(j,k,8)^Mk(j,k,7),M=al[E-2]|0,P=ll[E-2]|0,I=dd(M,P,19)^Gf(M,P,61)^zk(M,P,6),O=ud(M,P,19)^Uf(M,P,61)^Mk(M,P,6),G=zV(R,O,ll[E-7],ll[E-16]),B=MV(G,A,I,al[E-7],al[E-16]);al[E]=B|0,ll[E]=G|0}let{Ah:n,Al:i,Bh:o,Bl:a,Ch:l,Cl:d,Dh:p,Dl:f,Eh:h,El:x,Fh:m,Fl:b,Gh:w,Gl:y,Hh:C,Hl:T}=this;for(let E=0;E<80;E++){const j=dd(h,x,14)^dd(h,x,18)^Gf(h,x,41),k=ud(h,x,14)^ud(h,x,18)^Uf(h,x,41),A=h&m^~h&w,R=x&b^~x&y,M=BV(T,k,R,WV[E],ll[E]),P=FV(M,C,j,A,UV[E],al[E]),I=M|0,O=dd(n,i,28)^Gf(n,i,34)^Gf(n,i,39),G=ud(n,i,28)^Uf(n,i,34)^Uf(n,i,39),B=n&o^n&l^o&l,F=i&a^i&d^a&d;C=w|0,T=y|0,w=m|0,y=b|0,m=h|0,b=x|0,{h,l:x}=ba(p|0,f|0,P|0,I|0),p=l|0,f=d|0,l=o|0,d=a|0,o=n|0,a=i|0;const z=PV(I,G,F);n=LV(z,P,O,B),i=z|0}({h:n,l:i}=ba(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:a}=ba(this.Bh|0,this.Bl|0,o|0,a|0),{h:l,l:d}=ba(this.Ch|0,this.Cl|0,l|0,d|0),{h:p,l:f}=ba(this.Dh|0,this.Dl|0,p|0,f|0),{h,l:x}=ba(this.Eh|0,this.El|0,h|0,x|0),{h:m,l:b}=ba(this.Fh|0,this.Fl|0,m|0,b|0),{h:w,l:y}=ba(this.Gh|0,this.Gl|0,w|0,y|0),{h:C,l:T}=ba(this.Hh|0,this.Hl|0,C|0,T|0),this.set(n,i,o,a,l,d,p,f,h,x,m,b,w,y,C,T)}roundClean(){Ko(al,ll)}destroy(){Ko(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}constructor(e=64){super(128,e,16,!1),this.Ah=Us[0]|0,this.Al=Us[1]|0,this.Bh=Us[2]|0,this.Bl=Us[3]|0,this.Ch=Us[4]|0,this.Cl=Us[5]|0,this.Dh=Us[6]|0,this.Dl=Us[7]|0,this.Eh=Us[8]|0,this.El=Us[9]|0,this.Fh=Us[10]|0,this.Fl=Us[11]|0,this.Gh=Us[12]|0,this.Gl=Us[13]|0,this.Hh=Us[14]|0,this.Hl=Us[15]|0}}class qV extends r_{constructor(){super(48),this.Ah=Gs[0]|0,this.Al=Gs[1]|0,this.Bh=Gs[2]|0,this.Bl=Gs[3]|0,this.Ch=Gs[4]|0,this.Cl=Gs[5]|0,this.Dh=Gs[6]|0,this.Dl=Gs[7]|0,this.Eh=Gs[8]|0,this.El=Gs[9]|0,this.Fh=Gs[10]|0,this.Fl=Gs[11]|0,this.Gh=Gs[12]|0,this.Gl=Gs[13]|0,this.Hh=Gs[14]|0,this.Hl=Gs[15]|0}}const HV=Qd(()=>new e_),YV=Qd(()=>new GV),KV=Qd(()=>new r_),VV=Qd(()=>new qV),XV=BigInt(0),hp=BigInt(1),JV=BigInt(2),QV=BigInt(7),ZV=BigInt(256),eX=BigInt(113),n_=[],s_=[],i_=[];for(let s=0,e=hp,r=1,n=0;s<24;s++){[r,n]=[n,(2*r+3*n)%5],n_.push(2*(5*n+r)),s_.push((s+1)*(s+2)/2%64);let i=XV;for(let o=0;o<7;o++)e=(e<<hp^(e>>QV)*eX)%ZV,e&JV&&(i^=hp<<(hp<<BigInt(o))-hp);i_.push(i)}const o_=ZO(i_,!0),tX=o_[0],rX=o_[1],Bk=(s,e,r)=>r>32?DV(s,e,r):OV(s,e,r),Fk=(s,e,r)=>r>32?IV(s,e,r):_V(s,e,r);function nX(s,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let a=0;a<10;a++)r[a]=s[a]^s[a+10]^s[a+20]^s[a+30]^s[a+40];for(let a=0;a<10;a+=2){const l=(a+8)%10,d=(a+2)%10,p=r[d],f=r[d+1],h=Bk(p,f,1)^r[l],x=Fk(p,f,1)^r[l+1];for(let m=0;m<50;m+=10)s[a+m]^=h,s[a+m+1]^=x}let i=s[2],o=s[3];for(let a=0;a<24;a++){const l=s_[a],d=Bk(i,o,l),p=Fk(i,o,l),f=n_[a];i=s[f],o=s[f+1],s[f]=d,s[f+1]=p}for(let a=0;a<50;a+=10){for(let l=0;l<10;l++)r[l]=s[a+l];for(let l=0;l<10;l++)s[a+l]^=~r[(l+2)%10]&r[(l+4)%10]}s[0]^=tX[n],s[1]^=rX[n]}Ko(r)}class _v extends Nv{clone(){return this._cloneInto()}keccak(){Pk(this.state32),nX(this.state32,this.rounds),Pk(this.state32),this.posOut=0,this.pos=0}update(e){Md(this),e=yx(e),zd(e);const{blockLen:r,state:n}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(r-this.pos,i-o);for(let l=0;l<a;l++)n[this.pos++]^=e[o++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:i}=this;e[n]^=r,(r&128)!==0&&n===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Md(this,!1),zd(e),this.finish();const r=this.state,{blockLen:n}=this;for(let i=0,o=e.length;i<o;){this.posOut>=n&&this.keccak();const a=Math.min(n-this.posOut,o-i);e.set(r.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Bg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(VO(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Ko(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:i,rounds:o,enableXOF:a}=this;return e||(e=new _v(r,n,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=n,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}constructor(e,r,n,i=!1,o=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=i,this.rounds=o,Bg(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=wV(this.state)}}const bx=(s,e,r)=>Qd(()=>new _v(e,s,r)),sX=bx(6,144,224/8),iX=bx(6,136,256/8),oX=bx(6,104,384/8),aX=bx(6,72,512/8),Bd=(()=>{if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"__GLOBALTHIS__",{get(){return this},configurable:!0});try{if(typeof __GLOBALTHIS__<"u")return __GLOBALTHIS__}finally{delete Object.prototype.__GLOBALTHIS__}if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis})(),$k={SHA1:RV,SHA224:YV,SHA256:HV,SHA384:VV,SHA512:KV,"SHA3-224":sX,"SHA3-256":iX,"SHA3-384":oX,"SHA3-512":aX},Dv=s=>{switch(!0){case/^(?:SHA-?1|SSL3-SHA1)$/i.test(s):return"SHA1";case/^SHA(?:2?-)?224$/i.test(s):return"SHA224";case/^SHA(?:2?-)?256$/i.test(s):return"SHA256";case/^SHA(?:2?-)?384$/i.test(s):return"SHA384";case/^SHA(?:2?-)?512$/i.test(s):return"SHA512";case/^SHA3-224$/i.test(s):return"SHA3-224";case/^SHA3-256$/i.test(s):return"SHA3-256";case/^SHA3-384$/i.test(s):return"SHA3-384";case/^SHA3-512$/i.test(s):return"SHA3-512";default:throw new TypeError(`Unknown hash algorithm: ${s}`)}},lX=(s,e,r)=>{if(Rb){const n=$k[s]??$k[Dv(s)];return Rb(n,e,r)}else throw new Error("Missing HMAC function")},Nb="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",cX=s=>{s=s.replace(/ /g,"");let e=s.length;for(;s[e-1]==="=";)--e;s=(e<s.length?s.substring(0,e):s).toUpperCase();const r=new ArrayBuffer(s.length*5/8|0),n=new Uint8Array(r);let i=0,o=0,a=0;for(let l=0;l<s.length;l++){const d=Nb.indexOf(s[l]);if(d===-1)throw new TypeError(`Invalid character found: ${s[l]}`);o=o<<5|d,i+=5,i>=8&&(i-=8,n[a++]=o>>>i)}return n},dX=s=>{let e=0,r=0,n="";for(let i=0;i<s.length;i++)for(r=r<<8|s[i],e+=8;e>=5;)n+=Nb[r>>>e-5&31],e-=5;return e>0&&(n+=Nb[r<<5-e&31]),n},uX=s=>{s=s.replace(/ /g,"");const e=new ArrayBuffer(s.length/2),r=new Uint8Array(e);for(let n=0;n<s.length;n+=2)r[n/2]=parseInt(s.substring(n,n+2),16);return r},pX=s=>{let e="";for(let r=0;r<s.length;r++){const n=s[r].toString(16);n.length===1&&(e+="0"),e+=n}return e.toUpperCase()},hX=s=>{const e=new ArrayBuffer(s.length),r=new Uint8Array(e);for(let n=0;n<s.length;n++)r[n]=s.charCodeAt(n)&255;return r},fX=s=>{let e="";for(let r=0;r<s.length;r++)e+=String.fromCharCode(s[r]);return e},Gk=Bd.TextEncoder?new Bd.TextEncoder:null,Uk=Bd.TextDecoder?new Bd.TextDecoder:null,gX=s=>{if(!Gk)throw new Error("Encoding API not available");return Gk.encode(s)},xX=s=>{if(!Uk)throw new Error("Encoding API not available");return Uk.decode(s)},mX=s=>{if(Bd.crypto?.getRandomValues)return Bd.crypto.getRandomValues(new Uint8Array(s));throw new Error("Cryptography API not available")};class Ca{static fromLatin1(e){return new Ca({buffer:hX(e).buffer})}static fromUTF8(e){return new Ca({buffer:gX(e).buffer})}static fromBase32(e){return new Ca({buffer:cX(e).buffer})}static fromHex(e){return new Ca({buffer:uX(e).buffer})}get buffer(){return this.bytes.buffer}get latin1(){return Object.defineProperty(this,"latin1",{enumerable:!0,writable:!1,configurable:!1,value:fX(this.bytes)}),this.latin1}get utf8(){return Object.defineProperty(this,"utf8",{enumerable:!0,writable:!1,configurable:!1,value:xX(this.bytes)}),this.utf8}get base32(){return Object.defineProperty(this,"base32",{enumerable:!0,writable:!1,configurable:!1,value:dX(this.bytes)}),this.base32}get hex(){return Object.defineProperty(this,"hex",{enumerable:!0,writable:!1,configurable:!1,value:pX(this.bytes)}),this.hex}constructor({buffer:e,size:r=20}={}){this.bytes=typeof e>"u"?mX(r):new Uint8Array(e),Object.defineProperty(this,"bytes",{enumerable:!0,writable:!1,configurable:!1,value:this.bytes})}}const yX=(s,e)=>{{if(s.length!==e.length)throw new TypeError("Input strings must have the same length");let r=-1,n=0;for(;++r<s.length;)n|=s.charCodeAt(r)^e.charCodeAt(r);return n===0}};class vs{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,counter:0,window:1}}static generate({secret:e,algorithm:r=vs.defaults.algorithm,digits:n=vs.defaults.digits,counter:i=vs.defaults.counter}){const o=lX(r,e.bytes,bV(i)),a=o[o.byteLength-1]&15;return(((o[a]&127)<<24|(o[a+1]&255)<<16|(o[a+2]&255)<<8|o[a+3]&255)%10**n).toString().padStart(n,"0")}generate({counter:e=this.counter++}={}){return vs.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:e})}static validate({token:e,secret:r,algorithm:n,digits:i=vs.defaults.digits,counter:o=vs.defaults.counter,window:a=vs.defaults.window}){if(e.length!==i)return null;let l=null;const d=p=>{const f=vs.generate({secret:r,algorithm:n,digits:i,counter:p});yX(e,f)&&(l=p-o)};d(o);for(let p=1;p<=a&&l===null&&(d(o-p),!(l!==null||(d(o+p),l!==null)));++p);return l}validate({token:e,counter:r=this.counter,window:n}){return vs.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,counter:r,window:n})}toString(){const e=encodeURIComponent;return`otpauth://hotp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&counter=${e(this.counter)}`}constructor({issuer:e=vs.defaults.issuer,label:r=vs.defaults.label,issuerInLabel:n=vs.defaults.issuerInLabel,secret:i=new Ca,algorithm:o=vs.defaults.algorithm,digits:a=vs.defaults.digits,counter:l=vs.defaults.counter}={}){this.issuer=e,this.label=r,this.issuerInLabel=n,this.secret=typeof i=="string"?Ca.fromBase32(i):i,this.algorithm=Dv(o),this.digits=a,this.counter=l}}class bs{static get defaults(){return{issuer:"",label:"OTPAuth",issuerInLabel:!0,algorithm:"SHA1",digits:6,period:30,window:1}}static counter({period:e=bs.defaults.period,timestamp:r=Date.now()}={}){return Math.floor(r/1e3/e)}counter({timestamp:e=Date.now()}={}){return bs.counter({period:this.period,timestamp:e})}static remaining({period:e=bs.defaults.period,timestamp:r=Date.now()}={}){return e*1e3-r%(e*1e3)}remaining({timestamp:e=Date.now()}={}){return bs.remaining({period:this.period,timestamp:e})}static generate({secret:e,algorithm:r,digits:n,period:i=bs.defaults.period,timestamp:o=Date.now()}){return vs.generate({secret:e,algorithm:r,digits:n,counter:bs.counter({period:i,timestamp:o})})}generate({timestamp:e=Date.now()}={}){return bs.generate({secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:e})}static validate({token:e,secret:r,algorithm:n,digits:i,period:o=bs.defaults.period,timestamp:a=Date.now(),window:l}){return vs.validate({token:e,secret:r,algorithm:n,digits:i,counter:bs.counter({period:o,timestamp:a}),window:l})}validate({token:e,timestamp:r,window:n}){return bs.validate({token:e,secret:this.secret,algorithm:this.algorithm,digits:this.digits,period:this.period,timestamp:r,window:n})}toString(){const e=encodeURIComponent;return`otpauth://totp/${this.issuer.length>0?this.issuerInLabel?`${e(this.issuer)}:${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?issuer=${e(this.issuer)}&`:`${e(this.label)}?`}secret=${e(this.secret.base32)}&algorithm=${e(this.algorithm)}&digits=${e(this.digits)}&period=${e(this.period)}`}constructor({issuer:e=bs.defaults.issuer,label:r=bs.defaults.label,issuerInLabel:n=bs.defaults.issuerInLabel,secret:i=new Ca,algorithm:o=bs.defaults.algorithm,digits:a=bs.defaults.digits,period:l=bs.defaults.period}={}){this.issuer=e,this.label=r,this.issuerInLabel=n,this.secret=typeof i=="string"?Ca.fromBase32(i):i,this.algorithm=Dv(o),this.digits=a,this.period=l}}async function bX(s){Mr.info("Starting authentication...");try{Mr.debug("Step 1: Sending login OTP...");let e=await tn("https://api-t2.fyers.in/vagator/v2/send_login_otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fy_id:s.clientId,app_id:"2"})}),r=await e.json();if(Mr.debug("OTP Response status:",e.status),Mr.debug("OTP Response data:",r),e.status!==200)throw new Error(`Failed to send OTP: HTTP ${e.status}`);if(!r.request_key)throw new Error(`Failed to send OTP: ${JSON.stringify(r)}`);let n=r.request_key;Mr.info("OTP sent successfully"),Mr.debug("Step 2: Generating TOTP...");const o=new bs({secret:s.totpKey}).generate();if(Mr.debug("TOTP generated:",o),e=await tn("https://api-t2.fyers.in/vagator/v2/verify_otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request_key:n,otp:o})}),r=await e.json(),Mr.debug("Verify OTP Response status:",e.status),Mr.debug("Verify OTP Response data:",r),e.status!==200)throw new Error(`Failed to verify OTP: HTTP ${e.status}`);if(!r.request_key)throw new Error(`Failed to verify OTP: ${JSON.stringify(r)}`);if(n=r.request_key,Mr.info("TOTP verified successfully"),Mr.debug("Step 3: Verifying PIN..."),e=await tn("https://api-t2.fyers.in/vagator/v2/verify_pin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request_key:n,identity_type:"pin",identifier:s.pin})}),r=await e.json(),Mr.debug("Verify PIN Response status:",e.status),Mr.debug("Verify PIN Response data:",r),e.status!==200)throw new Error(`Failed to verify PIN: HTTP ${e.status}`);if(!r.data?.access_token)throw new Error(`Failed to verify PIN: ${JSON.stringify(r)}`);const a=r.data.access_token;if(Mr.info("PIN verified successfully"),Mr.debug("Step 4: Getting authorization code..."),e=await tn("https://api-t1.fyers.in/api/v3/token",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({fyers_id:s.clientId,app_id:s.appId,redirect_uri:"https://trade.fyers.in/api-login/redirect-uri/index.html",appType:s.appType,code_challenge:"",state:"sample_state",scope:"",nonce:"",response_type:"code",create_cookie:!0})}),r=await e.json(),Mr.debug("Token API Response status:",e.status),Mr.debug("Token API Response data:",r),e.status!==308)throw new Error(`Expected HTTP 308 but got ${e.status}: ${JSON.stringify(r)}`);if(!r?.Url)throw new Error("Failed to get authorization URL");const d=new URL(r.Url).searchParams.get("auth_code");if(!d)throw new Error("No auth_code in response URL");Mr.info("Authorization code obtained"),Mr.debug("Step 5: Validating auth code...");const p=await lt("sha256_hash",{input:`${s.appId}-${s.appType}:${s.appSecret}`});if(Mr.debug("Generated appIdHash"),e=await tn("https://api-t1.fyers.in/api/v3/validate-authcode",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({grant_type:"authorization_code",appIdHash:p,code:d})}),r=await e.json(),Mr.debug("Validate Auth Code Response status:",e.status),Mr.debug("Validate Auth Code Response data:",r),e.status!==200)throw new Error(`Failed to validate auth code: HTTP ${e.status}`);if(!r.access_token)throw new Error(`Failed to validate auth code: ${JSON.stringify(r)}`);const f=r.access_token,h=`${s.appId}-${s.appType}:${f}`;return Mr.info("Authentication successful!"),Mr.info("Final access token obtained"),{accessToken:f,connectionString:h}}catch(e){throw Mr.error("Authentication failed:",e),new Error(e.message||"Authentication failed")}}const vX=({onClose:s,onSuccess:e})=>{const[r,n]=S.useState(""),[i,o]=S.useState(""),[a,l]=S.useState(""),[d,p]=S.useState("100"),[f,h]=S.useState(""),[x,m]=S.useState(""),[b,w]=S.useState(!1),[y,C]=S.useState(""),[T,E]=S.useState(""),j="#FFA500",k="#FFFFFF",A="#787878",R="#000000",M="#0a0a0a",P=async()=>{if(!r||!i||!a||!f||!x){C("Please fill all required fields");return}w(!0),C(""),E("Starting authentication...");try{const I={clientId:r,pin:i,appId:a,appType:d,appSecret:f,totpKey:x};E("Generating TOTP and authenticating...");const O=await bX(I);E("Saving credentials..."),await zn.saveCredentials({appId:a,appType:d,redirectUrl:"https://trade.fyers.in/api-login/redirect-uri/index.html",accessToken:O.accessToken});const{sqliteService:G}=await Br(async()=>{const{sqliteService:B}=await Promise.resolve().then(()=>jd);return{sqliteService:B}},void 0);await G.saveCredential({service_name:"fyers_config",username:r,password:i,api_key:a,api_secret:f,additional_data:JSON.stringify({appType:d,totpKey:x,connectionString:O.connectionString})}),E("Testing connection..."),await zn.getProfile(),E("Connected successfully!"),setTimeout(()=>{w(!1),e()},1e3)}catch(I){w(!1),E(""),C(I instanceof Error?I.message:"Authentication failed")}};return t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,fontFamily:"Consolas, monospace"},children:t.jsxs("div",{style:{backgroundColor:M,border:`2px solid ${j}`,width:"500px",maxWidth:"90%"},children:[t.jsxs("div",{style:{backgroundColor:R,borderBottom:`1px solid ${j}`,padding:"10px 12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{color:j,fontSize:"12px",fontWeight:"bold"},children:"CONNECT FYERS ACCOUNT"}),t.jsx("button",{onClick:s,style:{backgroundColor:"transparent",border:"none",color:k,cursor:"pointer",padding:"4px"},children:t.jsx(ln,{size:16})})]}),t.jsxs("div",{style:{padding:"20px"},children:[t.jsx("div",{style:{color:A,fontSize:"10px",marginBottom:"20px",lineHeight:"1.5"},children:"Enter your Fyers credentials. Authentication will be automated using TOTP."}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:k,fontSize:"10px",marginBottom:"5px",fontWeight:"bold"},children:"Client ID *"}),t.jsx("input",{type:"text",value:r,onChange:I=>n(I.target.value.toUpperCase()),placeholder:"XB02507",disabled:b,style:{width:"100%",backgroundColor:R,border:`1px solid ${A}`,color:k,padding:"8px",fontSize:"10px",fontFamily:"Consolas, monospace",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:k,fontSize:"10px",marginBottom:"5px",fontWeight:"bold"},children:"PIN *"}),t.jsx("input",{type:"password",value:i,onChange:I=>o(I.target.value),placeholder:"1590",disabled:b,style:{width:"100%",backgroundColor:R,border:`1px solid ${A}`,color:k,padding:"8px",fontSize:"10px",fontFamily:"Consolas, monospace",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:k,fontSize:"10px",marginBottom:"5px",fontWeight:"bold"},children:"App ID *"}),t.jsx("input",{type:"text",value:a,onChange:I=>l(I.target.value.toUpperCase()),placeholder:"NDM5TDN9DB",disabled:b,style:{width:"100%",backgroundColor:R,border:`1px solid ${A}`,color:k,padding:"8px",fontSize:"10px",fontFamily:"Consolas, monospace",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:k,fontSize:"10px",marginBottom:"5px",fontWeight:"bold"},children:"App Type"}),t.jsx("input",{type:"text",value:d,onChange:I=>p(I.target.value),placeholder:"100",disabled:b,style:{width:"100%",backgroundColor:R,border:`1px solid ${A}`,color:k,padding:"8px",fontSize:"10px",fontFamily:"Consolas, monospace",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",color:k,fontSize:"10px",marginBottom:"5px",fontWeight:"bold"},children:"App Secret *"}),t.jsx("input",{type:"password",value:f,onChange:I=>h(I.target.value.toUpperCase()),placeholder:"UR9IJU1U0E",disabled:b,style:{width:"100%",backgroundColor:R,border:`1px solid ${A}`,color:k,padding:"8px",fontSize:"10px",fontFamily:"Consolas, monospace",boxSizing:"border-box"}})]}),t.jsxs("div",{style:{marginBottom:"15px"},children:[t.jsx("label",{style:{display:"block",color:k,fontSize:"10px",marginBottom:"5px",fontWeight:"bold"},children:"TOTP Key *"}),t.jsx("input",{type:"password",value:x,onChange:I=>m(I.target.value.toUpperCase()),placeholder:"XOYMD3QRDV6QPNSWK3WSKMD642KGODJQ",disabled:b,style:{width:"100%",backgroundColor:R,border:`1px solid ${A}`,color:k,padding:"8px",fontSize:"9px",fontFamily:"Consolas, monospace",boxSizing:"border-box"}})]}),T&&t.jsx("div",{style:{backgroundColor:R,border:`1px solid ${j}`,color:j,padding:"8px",fontSize:"9px",marginBottom:"15px",textAlign:"center"},children:T}),y&&t.jsx("div",{style:{backgroundColor:R,border:"1px solid #FF0000",color:"#FF0000",padding:"8px",fontSize:"9px",marginBottom:"15px"},children:y}),t.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:s,disabled:b,style:{backgroundColor:R,border:`1px solid ${A}`,color:k,padding:"8px 16px",fontSize:"10px",cursor:b?"not-allowed":"pointer",fontFamily:"Consolas, monospace",opacity:b?.5:1},children:"CANCEL"}),t.jsx("button",{onClick:P,disabled:b,style:{backgroundColor:j,border:"none",color:"black",padding:"8px 16px",fontSize:"10px",fontWeight:"bold",cursor:b?"not-allowed":"pointer",fontFamily:"Consolas, monospace",opacity:b?.5:1},children:b?"CONNECTING...":"CONNECT"})]})]})]})})},SX=()=>{const[s,e]=S.useState(null),[r,n]=S.useState(!0),[i,o]=S.useState(""),a="#FFA500",l="#FFFFFF",d="#787878",p="#0a0a0a";S.useEffect(()=>{f()},[]);const f=async()=>{n(!0),o("");try{const h=await zn.getProfile();e(h)}catch(h){o(h instanceof Error?h.message:"Failed to load profile")}finally{n(!1)}};return r?t.jsx("div",{style:{backgroundColor:p,border:`1px solid ${d}`,padding:"12px",marginBottom:"12px"},children:t.jsx("div",{style:{color:d,fontSize:"10px"},children:"Loading profile..."})}):i||!s?t.jsx("div",{style:{backgroundColor:p,border:"1px solid #FF0000",padding:"12px",marginBottom:"12px"},children:t.jsx("div",{style:{color:"#FF0000",fontSize:"10px"},children:i||"Failed to load profile"})}):t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${a}`,padding:"12px",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",paddingBottom:"8px",borderBottom:`1px solid ${d}`},children:[t.jsx(Kp,{size:12,color:a}),t.jsx("span",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:"PROFILE"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px"},children:[s.image&&t.jsx("img",{src:s.image,alt:s.name,style:{width:"50px",height:"50px",borderRadius:"2px",border:`1px solid ${d}`}}),t.jsx("div",{style:{flex:1},children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",gap:"8px",fontSize:"10px"},children:[t.jsx("div",{style:{color:d},children:"Name:"}),t.jsx("div",{style:{color:l,fontWeight:"bold"},children:s.name}),t.jsx("div",{style:{color:d},children:"Display Name:"}),t.jsx("div",{style:{color:l},children:s.display_name}),t.jsx("div",{style:{color:d},children:"Email:"}),t.jsx("div",{style:{color:l},children:s.email_id}),t.jsx("div",{style:{color:d},children:"PAN:"}),t.jsx("div",{style:{color:l,fontFamily:"Consolas, monospace"},children:s.PAN})]})})]})]})},wX=()=>{const[s,e]=S.useState([]),[r,n]=S.useState(!0),[i,o]=S.useState(""),a="#FFA500",l="#FFFFFF",d="#787878",p="#000000",f="#0a0a0a",h="#00C800",x="#FF0000";S.useEffect(()=>{m()},[]);const m=async()=>{n(!0),o("");try{const T=await zn.getFunds();e(T)}catch(T){o(T instanceof Error?T.message:"Failed to load funds")}finally{n(!1)}},b=T=>`${T.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;if(r)return t.jsx("div",{style:{backgroundColor:f,border:`1px solid ${d}`,padding:"12px",marginBottom:"12px"},children:t.jsx("div",{style:{color:d,fontSize:"10px"},children:"Loading funds..."})});if(i)return t.jsx("div",{style:{backgroundColor:f,border:"1px solid #FF0000",padding:"12px",marginBottom:"12px"},children:t.jsx("div",{style:{color:"#FF0000",fontSize:"10px"},children:i})});const w=s.find(T=>T.id===10),y=s.find(T=>T.id===2),C=s.find(T=>T.id===4);return t.jsxs("div",{style:{backgroundColor:f,border:`1px solid ${a}`,padding:"12px",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",paddingBottom:"8px",borderBottom:`1px solid ${d}`},children:[t.jsx(Hb,{size:12,color:a}),t.jsx("span",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:"FUNDS & LIMITS"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginBottom:"12px"},children:[w&&t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${h}`,padding:"10px"},children:[t.jsx("div",{style:{color:d,fontSize:"8px",marginBottom:"4px"},children:"AVAILABLE BALANCE"}),t.jsx("div",{style:{color:h,fontSize:"13px",fontWeight:"bold"},children:b(w.equityAmount)}),w.commodityAmount>0&&t.jsxs("div",{style:{color:d,fontSize:"8px",marginTop:"2px"},children:["Commodity: ",b(w.commodityAmount)]})]}),y&&t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${a}`,padding:"10px"},children:[t.jsx("div",{style:{color:d,fontSize:"8px",marginBottom:"4px"},children:"UTILIZED AMOUNT"}),t.jsx("div",{style:{color:a,fontSize:"13px",fontWeight:"bold"},children:b(y.equityAmount)})]}),C&&t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${C.equityAmount>=0?h:x}`,padding:"10px"},children:[t.jsx("div",{style:{color:d,fontSize:"8px",marginBottom:"4px"},children:"REALIZED P&L"}),t.jsx("div",{style:{color:C.equityAmount>=0?h:x,fontSize:"13px",fontWeight:"bold"},children:b(C.equityAmount)})]})]}),t.jsx("div",{style:{backgroundColor:p,border:`1px solid ${d}`,maxHeight:"200px",overflow:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"9px"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{backgroundColor:f,borderBottom:`1px solid ${d}`},children:[t.jsx("th",{style:{padding:"6px",textAlign:"left",color:a,fontWeight:"bold"},children:"CATEGORY"}),t.jsx("th",{style:{padding:"6px",textAlign:"right",color:a,fontWeight:"bold"},children:"EQUITY"}),t.jsx("th",{style:{padding:"6px",textAlign:"right",color:a,fontWeight:"bold"},children:"COMMODITY"})]})}),t.jsx("tbody",{children:s.map((T,E)=>t.jsxs("tr",{style:{borderBottom:E<s.length-1?`1px solid ${d}`:"none"},children:[t.jsx("td",{style:{padding:"6px",color:l},children:T.title}),t.jsx("td",{style:{padding:"6px",textAlign:"right",color:T.equityAmount>=0?l:x,fontFamily:"Consolas, monospace"},children:b(T.equityAmount)}),t.jsx("td",{style:{padding:"6px",textAlign:"right",color:d,fontFamily:"Consolas, monospace"},children:b(T.commodityAmount)})]},T.id))})]})})]})},EX=()=>{const[s,e]=S.useState(null),[r,n]=S.useState(!0),[i,o]=S.useState(""),a="#FFA500",l="#FFFFFF",d="#787878",p="#000000",f="#0a0a0a",h="#00C800",x="#FF0000";S.useEffect(()=>{m()},[]);const m=async()=>{n(!0),o("");try{const y=await zn.getHoldings();e(y)}catch(y){o(y instanceof Error?y.message:"Failed to load holdings")}finally{n(!1)}},b=y=>`${y.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,w=y=>`${y>=0?"+":""}${y.toFixed(2)}%`;return r?t.jsx("div",{style:{height:"100%",backgroundColor:p,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx("div",{style:{color:d,fontSize:"10px"},children:"Loading holdings..."})}):i||!s?t.jsxs("div",{style:{height:"100%",backgroundColor:p,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"10px"},children:[t.jsx("div",{style:{color:x,fontSize:"10px"},children:i||"Failed to load holdings"}),t.jsx("button",{onClick:m,style:{backgroundColor:a,color:"black",border:"none",padding:"6px 12px",fontSize:"9px",fontWeight:"bold",cursor:"pointer"},children:"RETRY"})]}):t.jsxs("div",{style:{height:"100%",backgroundColor:p,display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:f,borderBottom:`1px solid ${d}`,padding:"12px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(qb,{size:12,color:a}),t.jsxs("span",{style:{color:a,fontSize:"11px",fontWeight:"bold"},children:["HOLDINGS (",s.overall.count_total,")"]})]}),t.jsxs("button",{onClick:m,style:{backgroundColor:p,border:`1px solid ${d}`,color:l,padding:"4px 8px",fontSize:"9px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(xn,{size:10}),"REFRESH"]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px"},children:[t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${d}`,padding:"8px"},children:[t.jsx("div",{style:{color:d,fontSize:"8px",marginBottom:"4px"},children:"TOTAL INVESTMENT"}),t.jsx("div",{style:{color:l,fontSize:"11px",fontWeight:"bold"},children:b(s.overall.total_investment)})]}),t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${d}`,padding:"8px"},children:[t.jsx("div",{style:{color:d,fontSize:"8px",marginBottom:"4px"},children:"CURRENT VALUE"}),t.jsx("div",{style:{color:l,fontSize:"11px",fontWeight:"bold"},children:b(s.overall.total_current_value)})]}),t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${s.overall.total_pl>=0?h:x}`,padding:"8px"},children:[t.jsx("div",{style:{color:d,fontSize:"8px",marginBottom:"4px"},children:"TOTAL P&L"}),t.jsx("div",{style:{color:s.overall.total_pl>=0?h:x,fontSize:"11px",fontWeight:"bold"},children:b(s.overall.total_pl)})]}),t.jsxs("div",{style:{backgroundColor:p,border:`1px solid ${s.overall.pnl_perc>=0?h:x}`,padding:"8px"},children:[t.jsx("div",{style:{color:d,fontSize:"8px",marginBottom:"4px"},children:"P&L %"}),t.jsx("div",{style:{color:s.overall.pnl_perc>=0?h:x,fontSize:"11px",fontWeight:"bold"},children:w(s.overall.pnl_perc)})]})]})]}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:s.holdings.length===0?t.jsx("div",{style:{textAlign:"center",color:d,padding:"40px",fontSize:"10px"},children:"No holdings found"}):t.jsx("div",{style:{backgroundColor:f,border:`1px solid ${d}`},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"9px"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{backgroundColor:p,borderBottom:`1px solid ${d}`},children:[t.jsx("th",{style:{padding:"8px",textAlign:"left",color:a,fontWeight:"bold"},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:a,fontWeight:"bold"},children:"QTY"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:a,fontWeight:"bold"},children:"AVG COST"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:a,fontWeight:"bold"},children:"LTP"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:a,fontWeight:"bold"},children:"MARKET VALUE"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:a,fontWeight:"bold"},children:"P&L"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:a,fontWeight:"bold"},children:"TYPE"})]})}),t.jsx("tbody",{children:s.holdings.map((y,C)=>t.jsxs("tr",{style:{borderBottom:C<s.holdings.length-1?`1px solid ${d}`:"none",backgroundColor:C%2===0?p:f},children:[t.jsx("td",{style:{padding:"8px",color:l,fontWeight:"bold"},children:y.symbol.replace("NSE:","").replace("-EQ","")}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:l,fontFamily:"Consolas, monospace"},children:y.quantity}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:d,fontFamily:"Consolas, monospace"},children:b(y.costPrice)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:l,fontFamily:"Consolas, monospace"},children:b(y.ltp)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:l,fontFamily:"Consolas, monospace"},children:b(y.marketVal)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:y.pl>=0?h:x,fontFamily:"Consolas, monospace",fontWeight:"bold"},children:b(y.pl)}),t.jsx("td",{style:{padding:"8px",textAlign:"center",color:d,fontSize:"8px"},children:y.holdingType})]},y.fyToken))})]})})})]})},CX=({wsConnected:s})=>{const[e,r]=S.useState([]),[n,i]=S.useState(!0),[o,a]=S.useState(""),l="#FFA500",d="#FFFFFF",p="#787878",f="#000000",h="#0a0a0a",x="#00C800",m="#FF0000";S.useEffect(()=>(b(),s&&uc.onPositionUpdate(y=>{console.log("[Positions] WebSocket update:",y),b()}),()=>{uc.clearCallbacks()}),[s]);const b=async()=>{i(!0),a("");try{const y=await zn.getPositions();r(y)}catch(y){a(y instanceof Error?y.message:"Failed to load positions")}finally{i(!1)}},w=y=>`${y.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return n&&e.length===0?t.jsx("div",{style:{height:"100%",backgroundColor:f,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx("div",{style:{color:p,fontSize:"10px"},children:"Loading positions..."})}):t.jsxs("div",{style:{height:"100%",backgroundColor:f,display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:h,borderBottom:`1px solid ${p}`,padding:"12px",flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(Cs,{size:12,color:l}),t.jsxs("span",{style:{color:l,fontSize:"11px",fontWeight:"bold"},children:["POSITIONS (",e.length,")"]}),s&&t.jsx("span",{style:{color:x,fontSize:"8px",backgroundColor:f,padding:"2px 6px",border:`1px solid ${x}`},children:"LIVE"})]}),t.jsxs("button",{onClick:b,disabled:n,style:{backgroundColor:f,border:`1px solid ${p}`,color:d,padding:"4px 8px",fontSize:"9px",cursor:n?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"4px",opacity:n?.5:1},children:[t.jsx(xn,{size:10}),"REFRESH"]})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:[o&&t.jsx("div",{style:{backgroundColor:h,border:`1px solid ${m}`,color:m,padding:"10px",fontSize:"9px",marginBottom:"12px"},children:o}),e.length===0?t.jsx("div",{style:{textAlign:"center",color:p,padding:"40px",fontSize:"10px"},children:"No open positions"}):t.jsx("div",{style:{backgroundColor:h,border:`1px solid ${p}`},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"9px"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{backgroundColor:f,borderBottom:`1px solid ${p}`},children:[t.jsx("th",{style:{padding:"8px",textAlign:"left",color:l,fontWeight:"bold"},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:l,fontWeight:"bold"},children:"PRODUCT"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:l,fontWeight:"bold"},children:"QTY"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:l,fontWeight:"bold"},children:"AVG PRICE"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:l,fontWeight:"bold"},children:"LTP"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:l,fontWeight:"bold"},children:"P&L"})]})}),t.jsx("tbody",{children:e.map((y,C)=>t.jsxs("tr",{style:{borderBottom:C<e.length-1?`1px solid ${p}`:"none",backgroundColor:C%2===0?f:h},children:[t.jsxs("td",{style:{padding:"8px",color:d,fontWeight:"bold"},children:[y.symbol,t.jsx("span",{style:{marginLeft:"6px",color:y.netQty>0?x:m,fontSize:"8px",fontWeight:"bold"},children:y.netQty>0?"LONG":"SHORT"})]}),t.jsx("td",{style:{padding:"8px",textAlign:"center",color:p,fontSize:"8px"},children:y.productType}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:d,fontFamily:"Consolas, monospace"},children:Math.abs(y.netQty)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:p,fontFamily:"Consolas, monospace"},children:w(y.netAvg)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:d,fontFamily:"Consolas, monospace"},children:w(y.ltp)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:y.pl>=0?x:m,fontFamily:"Consolas, monospace",fontWeight:"bold"},children:w(y.pl)})]},y.id||C))})]})})]})]})},jX=({wsConnected:s})=>{const[e,r]=S.useState([]),[n,i]=S.useState(!0),[o,a]=S.useState(""),l="#FFA500",d="#FFFFFF",p="#787878",f="#000000",h="#0a0a0a",x="#00C800",m="#FF0000",b="#FFFF00";S.useEffect(()=>(w(),s&&uc.onOrderUpdate(E=>{console.log("[Orders] WebSocket update:",E),w()}),()=>{uc.clearCallbacks()}),[s]);const w=async()=>{i(!0),a("");try{const E=await zn.getOrders();r(E)}catch(E){a(E instanceof Error?E.message:"Failed to load orders")}finally{i(!1)}},y=E=>E===6?x:E===7?m:E===8?p:E===5?b:l,C=E=>({1:"PENDING",2:"PLACED",5:"PARTIAL",6:"FILLED",7:"REJECTED",8:"CANCELLED",90:"COMPLETE"})[E]||`STATUS_${E}`,T=E=>`${E.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return n&&e.length===0?t.jsx("div",{style:{height:"100%",backgroundColor:f,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx("div",{style:{color:p,fontSize:"10px"},children:"Loading orders..."})}):t.jsxs("div",{style:{height:"100%",backgroundColor:f,display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:h,borderBottom:`1px solid ${p}`,padding:"12px",flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(ri,{size:12,color:l}),t.jsxs("span",{style:{color:l,fontSize:"11px",fontWeight:"bold"},children:["ORDER BOOK (",e.length,")"]}),s&&t.jsx("span",{style:{color:x,fontSize:"8px",backgroundColor:f,padding:"2px 6px",border:`1px solid ${x}`},children:"LIVE"})]}),t.jsx("div",{style:{display:"flex",gap:"6px"},children:t.jsxs("button",{onClick:w,disabled:n,style:{backgroundColor:f,border:`1px solid ${p}`,color:d,padding:"4px 8px",fontSize:"9px",cursor:n?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"4px",opacity:n?.5:1},children:[t.jsx(xn,{size:10}),"REFRESH"]})})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:[o&&t.jsx("div",{style:{backgroundColor:h,border:`1px solid ${m}`,color:m,padding:"10px",fontSize:"9px",marginBottom:"12px"},children:o}),e.length===0?t.jsx("div",{style:{textAlign:"center",color:p,padding:"40px",fontSize:"10px"},children:"No orders found"}):t.jsx("div",{style:{backgroundColor:h,border:`1px solid ${p}`},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"9px"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{backgroundColor:f,borderBottom:`1px solid ${p}`},children:[t.jsx("th",{style:{padding:"8px",textAlign:"left",color:l,fontWeight:"bold"},children:"TIME"}),t.jsx("th",{style:{padding:"8px",textAlign:"left",color:l,fontWeight:"bold"},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:l,fontWeight:"bold"},children:"TYPE"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:l,fontWeight:"bold"},children:"SIDE"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:l,fontWeight:"bold"},children:"QTY"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:l,fontWeight:"bold"},children:"PRICE"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:l,fontWeight:"bold"},children:"STATUS"}),t.jsx("th",{style:{padding:"8px",textAlign:"left",color:l,fontWeight:"bold"},children:"ORDER ID"})]})}),t.jsx("tbody",{children:e.map((E,j)=>t.jsxs("tr",{style:{borderBottom:j<e.length-1?`1px solid ${p}`:"none",backgroundColor:j%2===0?f:h},children:[t.jsx("td",{style:{padding:"8px",color:p,fontSize:"8px"},children:E.orderDateTime}),t.jsx("td",{style:{padding:"8px",color:d,fontWeight:"bold"},children:E.symbol}),t.jsx("td",{style:{padding:"8px",textAlign:"center",color:p,fontSize:"8px"},children:E.type===1?"LIMIT":E.type===2?"MARKET":`TYPE_${E.type}`}),t.jsx("td",{style:{padding:"8px",textAlign:"center",color:E.side===1?x:m,fontWeight:"bold",fontSize:"8px"},children:E.side===1?"BUY":"SELL"}),t.jsxs("td",{style:{padding:"8px",textAlign:"right",color:d,fontFamily:"Consolas, monospace"},children:[E.filledQty,"/",E.qty]}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:p,fontFamily:"Consolas, monospace"},children:T(E.limitPrice)}),t.jsx("td",{style:{padding:"8px",textAlign:"center"},children:t.jsx("span",{style:{color:y(E.status),fontSize:"8px",fontWeight:"bold",backgroundColor:f,padding:"2px 6px",border:`1px solid ${y(E.status)}`},children:C(E.status)})}),t.jsx("td",{style:{padding:"8px",color:p,fontSize:"8px",fontFamily:"Consolas, monospace"},children:E.id})]},E.id))})]})})]})]})},kX=["NSE:NIFTY50-INDEX","NSE:RELIANCE-EQ","NSE:TCS-EQ","NSE:HDFCBANK-EQ","NSE:INFY-EQ","NSE:ICICIBANK-EQ","NSE:HINDUNILVR-EQ","NSE:ITC-EQ","NSE:SBIN-EQ","NSE:BHARTIARTL-EQ","NSE:KOTAKBANK-EQ","NSE:BAJFINANCE-EQ","NSE:LT-EQ","NSE:HCLTECH-EQ","NSE:ASIANPAINT-EQ","NSE:MARUTI-EQ","NSE:AXISBANK-EQ","NSE:SUNPHARMA-EQ","NSE:TITAN-EQ","NSE:ULTRACEMCO-EQ","NSE:WIPRO-EQ","NSE:ONGC-EQ","NSE:NTPC-EQ","NSE:NESTLEIND-EQ","NSE:POWERGRID-EQ","NSE:M&M-EQ","NSE:TATAMOTORS-EQ","NSE:TATASTEEL-EQ","NSE:BAJAJFINSV-EQ","NSE:ADANIENT-EQ","NSE:TECHM-EQ","NSE:ADANIPORTS-EQ","NSE:JSWSTEEL-EQ","NSE:HINDALCO-EQ","NSE:INDUSINDBK-EQ","NSE:DIVISLAB-EQ","NSE:BRITANNIA-EQ","NSE:TATACONSUM-EQ","NSE:COALINDIA-EQ","NSE:CIPLA-EQ","NSE:EICHERMOT-EQ","NSE:DRREDDY-EQ","NSE:GRASIM-EQ","NSE:APOLLOHOSP-EQ","NSE:BPCL-EQ","NSE:UPL-EQ","NSE:LTIM-EQ","NSE:HEROMOTOCO-EQ","NSE:BAJAJ-AUTO-EQ","NSE:ADANIGREEN-EQ"],AX=()=>{const[s,e]=S.useState(""),[r,n]=S.useState(kX),[i,o]=S.useState({}),[a,l]=S.useState({}),[d,p]=S.useState({}),[f,h]=S.useState(!1),[x,m]=S.useState(!1),[b,w]=S.useState(!1),[y,C]=S.useState(!1),[T,E]=S.useState({}),[j,k]=S.useState({isOpen:!1,symbol:"",side:"BUY",ltp:0}),[A,R]=S.useState({isOpen:!1,symbol:"",ltp:0}),[M,P]=S.useState(1),[I,O]=S.useState(2),[G,B]=S.useState(0),[F,z]=S.useState(0),[$,W]=S.useState("INTRADAY"),[D,oe]=S.useState(1),[Z,fe]=S.useState(1),[Q,_]=S.useState(0),[Y,he]=S.useState(0),[me,ge]=S.useState("CNC"),le=S.useRef(null),X=S.useRef(null),V="#FFA500",de="#FFFFFF",je="#787878",_e="#000000",Re="#0a0a0a",Be="#00C800",Se="#FF0000";S.useEffect(()=>{const se=zn.isMarketOpen();w(se),zn.loadSymbolMaster().then(()=>{m(!0)}).catch(console.error),ie(),(async()=>{const ye=r.filter(ue=>!T[ue]);ye.length>0&&await ve(ye)})();const Qe=setInterval(()=>{ie(),w(zn.isMarketOpen())},se?3e3:3e4);return()=>clearInterval(Qe)},[r]);const ie=async()=>{if(r.length!==0){h(!0);try{l(i);const se=await zn.getQuotes(r);o(se);const Te={};Object.keys(se).forEach(Me=>{if(a[Me]&&se[Me]){const Qe=a[Me].ltp||a[Me].lp||0,ye=se[Me].ltp||se[Me].lp||0;Qe!==void 0&&ye!==void 0&&Qe!==ye&&(Te[Me]=ye>Qe?"up":"down")}}),p(Te),setTimeout(()=>p({}),500)}catch(se){console.error("[Market Data] Failed to load quotes:",se)}finally{h(!1)}}},ve=async se=>{try{const Te=Math.floor(Date.now()/1e3),Me=Te-720*60*60;for(let Qe=0;Qe<se.length;Qe++){const ye=se[Qe];try{const ue=X.current?.scrollTop||0,re=await zn.getHistory({symbol:ye,resolution:"D",date_format:"0",range_from:Me.toString(),range_to:Te.toString(),cont_flag:"1"});if(re.s==="ok"&&re.candles&&re.candles.length>0){const ke=re.candles.map(Ne=>Ne[4]);E(Ne=>({...Ne,[ye]:ke.slice(-15)})),requestAnimationFrame(()=>{X.current&&(X.current.scrollTop=ue)})}}catch(ue){ue?.code===429&&(console.warn(`Rate limit for ${ye}, waiting longer...`),await new Promise(re=>setTimeout(re,2e3)))}Qe<se.length-1&&await new Promise(ue=>setTimeout(ue,1e3))}}catch(Te){console.error("[Market Data] Failed to load historical data:",Te)}},Ae=async()=>{await ve(r)},$e=se=>{!se.trim()||r.includes(se)||(n([...r,se]),e(""),C(!1))},qe=se=>{n(r.filter(Te=>Te!==se))},Ie=(se,Te,Me)=>{k({isOpen:!0,symbol:se,side:Te,ltp:Me}),B(Me),P(1),O(2)},K=(se,Te)=>{R({isOpen:!0,symbol:se,ltp:Te}),_(Te),he(Te),fe(1),oe(1),ge("CNC")},Ee=async()=>{try{const se={symbol:j.symbol,qty:M,type:I,side:j.side==="BUY"?1:-1,productType:$,limitPrice:I===1?G:0,stopPrice:I===3?F:0,disclosedQty:0,validity:"DAY",offlineOrder:!1,stopLoss:0,takeProfit:0,orderTag:"fincept-terminal"},Te=await zn.placeOrder(se);Te.orderId||Te.s==="ok"?(alert(`Order placed successfully! Order ID: ${Te.orderId||Te.id||"N/A"}`),k({isOpen:!1,symbol:"",side:"BUY",ltp:0})):alert(`Order failed: ${Te.message||"Unknown error"}`)}catch(se){console.error("Order placement error:",se),alert(`Order failed: ${se.message||"Unknown error"}`)}},Oe=async()=>{try{const se={side:D,symbol:A.symbol,productType:me,orderInfo:{leg1:{price:Q,triggerPrice:Y,qty:Z}}},Te=await zn.placeGTTOrder(se);Te.s==="ok"?(alert(`GTT Order placed successfully! Order ID: ${Te.id||"N/A"}`),R({isOpen:!1,symbol:"",ltp:0})):alert(`GTT Order failed: ${Te.message||"Unknown error"}`)}catch(se){console.error("GTT Order placement error:",se),alert(`GTT Order failed: ${se.message||"Unknown error"}`)}},q=()=>{ie(),Ae()},ee=()=>!x||!s||s.length<2?[]:zn.searchSymbols(s,10),ce=se=>se==null||isNaN(se)?"...":`${se.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,Ce=se=>se==null||isNaN(se)?"...":`${se>=0?"+":""}${se.toFixed(2)}%`,be=se=>{const Te=d[se];return Te?Te==="up"?"rgba(0, 200, 0, 0.3)":"rgba(255, 0, 0, 0.3)":"transparent"},We=se=>{const Te=i[se];return!Te||!Te.ch?de:Te.ch>0?Be:Te.ch<0?Se:de},J=({data:se,width:Te,height:Me,color:Qe})=>{if(!se||se.length<2)return null;const ye=Math.min(...se),re=Math.max(...se)-ye||1,ke=[];se.forEach((U,ne)=>{const xe=ne/(se.length-1)*Te,Le=Me-(U-ye)/re*(Me-4);ke.push(`${xe},${Le}`)});const Ne=`M 0,${Me} L ${ke.join(" L ")} L ${Te},${Me} Z`;return t.jsxs("svg",{width:Te,height:Me,style:{display:"block",margin:"auto"},children:[t.jsx("path",{d:Ne,fill:Qe,fillOpacity:"0.15"}),t.jsx("polyline",{points:ke.join(" "),fill:"none",stroke:Qe,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})};return t.jsxs("div",{style:{height:"100%",backgroundColor:_e,display:"flex",flexDirection:"column",fontFamily:"Consolas, monospace"},children:[t.jsxs("div",{style:{backgroundColor:Re,borderBottom:`1px solid ${je}`,padding:"8px 12px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(Nr,{size:12,color:V}),t.jsx("span",{style:{color:V,fontSize:"11px",fontWeight:"bold"},children:"MARKET SCREENER"}),t.jsx("span",{style:{fontSize:"9px",color:b?Be:Se,fontWeight:"bold",padding:"2px 6px",border:`1px solid ${b?Be:Se}`,backgroundColor:b?"rgba(0, 200, 0, 0.1)":"rgba(255, 0, 0, 0.1)"},children:b?"LIVE":"CLOSED"})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsxs("button",{onClick:q,style:{backgroundColor:_e,border:`1px solid ${V}`,color:V,padding:"4px 10px",fontSize:"9px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px",fontFamily:"Consolas, monospace"},children:[t.jsx(xn,{size:10}),"REFRESH CHARTS"]}),t.jsxs("span",{style:{color:je,fontSize:"9px"},children:[r.length," SYMBOLS"]})]})]}),t.jsxs("div",{style:{position:"relative"},children:[t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.jsx(Ho,{size:12,color:je}),t.jsx("input",{ref:le,type:"text",value:s,onChange:se=>{e(se.target.value),C(se.target.value.length>=2)},onFocus:()=>C(s.length>=2),onBlur:()=>setTimeout(()=>C(!1),200),placeholder:"Search symbols... (e.g., RELIANCE, TCS, INFY)",style:{flex:1,backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"6px 8px",fontSize:"10px",outline:"none"}})]}),y&&ee().length>0&&t.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:Re,border:`1px solid ${V}`,maxHeight:"200px",overflowY:"auto",zIndex:1e3,marginTop:"2px"},children:ee().map((se,Te)=>t.jsxs("div",{onClick:()=>$e(se.symbol),style:{padding:"8px",borderBottom:`1px solid ${je}`,cursor:"pointer",backgroundColor:Re},onMouseEnter:Me=>Me.currentTarget.style.backgroundColor=_e,onMouseLeave:Me=>Me.currentTarget.style.backgroundColor=Re,children:[t.jsx("div",{style:{color:V,fontSize:"10px",fontWeight:"bold"},children:se.shortName||se.symbol}),t.jsx("div",{style:{color:je,fontSize:"9px"},children:se.displayName||se.description})]},Te))})]})]}),t.jsxs("div",{ref:X,style:{flex:1,overflow:"auto",backgroundColor:_e},className:"custom-scrollbar",children:[t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px"},children:[t.jsx("thead",{style:{position:"sticky",top:0,backgroundColor:Re,borderBottom:`2px solid ${V}`},children:t.jsxs("tr",{children:[t.jsx("th",{style:{padding:"8px",textAlign:"left",color:V,fontWeight:"bold",width:"14%"},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:V,fontWeight:"bold",width:"10%"},children:"LTP"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:V,fontWeight:"bold",width:"8%"},children:"CHG"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:V,fontWeight:"bold",width:"8%"},children:"CHG%"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:V,fontWeight:"bold",width:"9%"},children:"HIGH"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:V,fontWeight:"bold",width:"9%"},children:"LOW"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:V,fontWeight:"bold",width:"10%"},children:"VOL"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:V,fontWeight:"bold",width:"14%"},children:"TREND (15D)"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:V,fontWeight:"bold",width:"16%"},children:"ACTION"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:V,fontWeight:"bold",width:"2%"}})]})}),t.jsx("tbody",{children:r.map((se,Te)=>{const Me=i[se],Qe=!Me;return t.jsxs("tr",{style:{borderBottom:`1px solid ${je}`,backgroundColor:Te%2===0?_e:Re},onMouseEnter:ye=>ye.currentTarget.style.backgroundColor="#111111",onMouseLeave:ye=>ye.currentTarget.style.backgroundColor=Te%2===0?_e:Re,children:[t.jsx("td",{style:{padding:"8px",color:de,fontWeight:"bold"},children:se.split(":")[1]||se}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:Qe?je:We(se),fontWeight:"bold",backgroundColor:be(se),transition:"background-color 0.5s ease"},children:Qe?"...":ce(Me?.ltp)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:Qe?je:(Me?.ch||0)>0?Be:(Me?.ch||0)<0?Se:de},children:Qe?"...":ce(Math.abs(Me?.ch||0))}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:Qe?je:(Me?.chp||0)>0?Be:(Me?.chp||0)<0?Se:de,fontWeight:"bold"},children:Qe?"...":Ce(Me?.chp)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:de},children:Qe?"...":ce(Me?.high)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:de},children:Qe?"...":ce(Me?.low)}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:de},children:Qe?"...":(Me?.volume||0)>0?(Me?.volume||0).toLocaleString("en-IN"):"..."}),t.jsx("td",{style:{padding:"8px 12px",textAlign:"center",verticalAlign:"middle"},children:t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"24px"},children:T[se]&&T[se].length>0?t.jsx(J,{data:T[se],width:100,height:28,color:(Me?.chp||0)>0?Be:(Me?.chp||0)<0?Se:je}):t.jsx("span",{style:{color:je,fontSize:"9px"},children:"Loading..."})})}),t.jsx("td",{style:{padding:"6px",textAlign:"center"},children:t.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"center",flexWrap:"wrap"},children:[t.jsx("button",{onClick:()=>Ie(se,"BUY",Me?.ltp||0),disabled:Qe||!Me,style:{backgroundColor:Be,color:"black",border:"none",padding:"4px 10px",fontSize:"9px",fontWeight:"bold",cursor:Qe||!Me?"not-allowed":"pointer",opacity:Qe||!Me?.5:1,fontFamily:"Consolas, monospace"},children:"BUY"}),t.jsx("button",{onClick:()=>Ie(se,"SELL",Me?.ltp||0),disabled:Qe||!Me,style:{backgroundColor:Se,color:de,border:"none",padding:"4px 10px",fontSize:"9px",fontWeight:"bold",cursor:Qe||!Me?"not-allowed":"pointer",opacity:Qe||!Me?.5:1,fontFamily:"Consolas, monospace"},children:"SELL"}),t.jsx("button",{onClick:()=>K(se,Me?.ltp||0),disabled:Qe||!Me,style:{backgroundColor:V,color:"black",border:"none",padding:"4px 10px",fontSize:"9px",fontWeight:"bold",cursor:Qe||!Me?"not-allowed":"pointer",opacity:Qe||!Me?.5:1,fontFamily:"Consolas, monospace"},children:"GTT"})]})}),t.jsx("td",{style:{padding:"8px",textAlign:"center"},children:t.jsx(ln,{size:12,color:Se,style:{cursor:"pointer"},onClick:()=>qe(se)})})]},se)})})]}),r.length===0&&t.jsx("div",{style:{padding:"40px",textAlign:"center",color:je,fontSize:"11px"},children:"No symbols added. Use search above to add symbols to your screener."})]}),j.isOpen&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:t.jsxs("div",{style:{backgroundColor:Re,border:`2px solid ${V}`,padding:"24px",minWidth:"400px",maxWidth:"500px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",borderBottom:`1px solid ${je}`,paddingBottom:"12px"},children:[t.jsxs("h3",{style:{color:j.side==="BUY"?Be:Se,margin:0,fontSize:"16px",fontWeight:"bold"},children:[j.side," ",j.symbol.split(":")[1]||j.symbol]}),t.jsx(ln,{size:18,color:je,style:{cursor:"pointer"},onClick:()=>k({isOpen:!1,symbol:"",side:"BUY",ltp:0})})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Order Type"}),t.jsxs("select",{value:I,onChange:se=>O(Number(se.target.value)),style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:2,children:"MARKET"}),t.jsx("option",{value:1,children:"LIMIT"}),t.jsx("option",{value:3,children:"STOP"})]})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Product Type"}),t.jsxs("select",{value:$,onChange:se=>W(se.target.value),style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"INTRADAY",children:"INTRADAY"}),t.jsx("option",{value:"CNC",children:"CNC (DELIVERY)"}),t.jsx("option",{value:"MARGIN",children:"MARGIN"})]})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Quantity"}),t.jsx("input",{type:"number",value:M,onChange:se=>P(Math.max(1,parseInt(se.target.value)||1)),min:1,style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),I===1&&t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsxs("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:["Limit Price (Current LTP: ",j.ltp.toFixed(2),")"]}),t.jsx("input",{type:"number",value:G,onChange:se=>B(parseFloat(se.target.value)||0),step:.05,style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),I===3&&t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Stop Price"}),t.jsx("input",{type:"number",value:F,onChange:se=>z(parseFloat(se.target.value)||0),step:.05,style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px",paddingTop:"16px",borderTop:`1px solid ${je}`},children:[t.jsxs("button",{onClick:Ee,style:{flex:1,backgroundColor:j.side==="BUY"?Be:Se,color:j.side==="BUY"?"black":de,border:"none",padding:"10px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:["PLACE ",j.side," ORDER"]}),t.jsx("button",{onClick:()=>k({isOpen:!1,symbol:"",side:"BUY",ltp:0}),style:{flex:.4,backgroundColor:_e,color:de,border:`1px solid ${je}`,padding:"10px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"CANCEL"})]})]})}),A.isOpen&&t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:t.jsxs("div",{style:{backgroundColor:Re,border:`2px solid ${V}`,padding:"24px",minWidth:"400px",maxWidth:"500px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",borderBottom:`1px solid ${je}`,paddingBottom:"12px"},children:[t.jsxs("h3",{style:{color:V,margin:0,fontSize:"16px",fontWeight:"bold"},children:["GTT ORDER - ",A.symbol.split(":")[1]||A.symbol]}),t.jsx(ln,{size:18,color:je,style:{cursor:"pointer"},onClick:()=>R({isOpen:!1,symbol:"",ltp:0})})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Side"}),t.jsxs("select",{value:D,onChange:se=>oe(Number(se.target.value)),style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:1,children:"BUY"}),t.jsx("option",{value:-1,children:"SELL"})]})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Product Type"}),t.jsxs("select",{value:me,onChange:se=>ge(se.target.value),style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"CNC",children:"CNC (DELIVERY)"}),t.jsx("option",{value:"INTRADAY",children:"INTRADAY"}),t.jsx("option",{value:"MARGIN",children:"MARGIN"})]})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Quantity"}),t.jsx("input",{type:"number",value:Z,onChange:se=>fe(Math.max(1,parseInt(se.target.value)||1)),min:1,style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsxs("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:["Trigger Price (Current LTP: ",A.ltp.toFixed(2),")"]}),t.jsx("input",{type:"number",value:Y,onChange:se=>he(parseFloat(se.target.value)||0),step:.05,style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{color:de,fontSize:"11px",display:"block",marginBottom:"6px"},children:"Limit Price"}),t.jsx("input",{type:"number",value:Q,onChange:se=>_(parseFloat(se.target.value)||0),step:.05,style:{width:"100%",backgroundColor:_e,border:`1px solid ${je}`,color:de,padding:"8px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"24px",paddingTop:"16px",borderTop:`1px solid ${je}`},children:[t.jsx("button",{onClick:Oe,style:{flex:1,backgroundColor:V,color:"black",border:"none",padding:"10px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"PLACE GTT ORDER"}),t.jsx("button",{onClick:()=>R({isOpen:!1,symbol:"",ltp:0}),style:{flex:.4,backgroundColor:_e,color:de,border:`1px solid ${je}`,padding:"10px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"CANCEL"})]})]})})]})},Di="#FFA500",Wn="#FFFFFF",Jt="#787878",Tn="#000000",fp="#0a0a0a",tc="#00C800",cl="#FF0000",TX=()=>{const[s,e]=S.useState("order"),[r,n]=S.useState(""),[i,o]=S.useState(1),[a,l]=S.useState("BUY"),[d,p]=S.useState("MARKET"),[f,h]=S.useState("INTRADAY"),[x,m]=S.useState(0),[b,w]=S.useState(0),[y,C]=S.useState(""),[T,E]=S.useState(1),[j,k]=S.useState("BUY"),[A,R]=S.useState("INTRADAY"),[M,P]=S.useState(0),[I,O]=S.useState(0),[G,B]=S.useState([]),[F,z]=S.useState(null),[$,W]=S.useState(!1),[D,oe]=S.useState({symbol:"",qty:1,side:"BUY",type:"LIMIT",productType:"INTRADAY",limitPrice:0}),Z=async()=>{if(!r.trim()){alert("Please enter a symbol");return}try{const he={symbol:r.toUpperCase(),qty:i,type:d==="MARKET"?2:d==="LIMIT"?1:3,side:a==="BUY"?1:-1,productType:f,validity:"DAY",disclosedQty:0,offlineOrder:!1};d==="LIMIT"&&(he.limitPrice=x),d==="STOP"&&(he.stopPrice=b,he.limitPrice=x);const me=await zn.placeOrder(he);me.orderId||me.s==="ok"?(alert(`Order placed successfully! Order ID: ${me.orderId||me.id||"N/A"}`),n(""),o(1),m(0),w(0)):alert(`Order failed: ${me.message||"Unknown error"}`)}catch(he){console.error("Order placement error:",he),alert(`Order failed: ${he.message||"Unknown error"}`)}},fe=async()=>{if(!y.trim()){alert("Please enter a symbol");return}try{const he={side:j==="BUY"?1:-1,symbol:y.toUpperCase(),productType:A,orderInfo:{leg1:{price:I,triggerPrice:M,qty:T}}},me=await zn.placeGTTOrder(he);me.s==="ok"?(alert(`GTT Order placed successfully! Order ID: ${me.id||"N/A"}`),C(""),E(1),P(0),O(0)):alert(`GTT Order failed: ${me.message||"Unknown error"}`)}catch(he){console.error("GTT Order placement error:",he),alert(`GTT Order failed: ${he.message||"Unknown error"}`)}},Q=()=>{if(!D.symbol.trim()){alert("Please enter a symbol");return}B([...G,{...D,symbol:D.symbol.toUpperCase()}]),oe({symbol:"",qty:1,side:"BUY",type:"LIMIT",productType:"INTRADAY",limitPrice:0})},_=he=>{B(G.filter((me,ge)=>ge!==he))},Y=async()=>{if(G.length===0){alert("Please add at least one order to calculate margin");return}W(!0);try{const he=await zn.calculateMultiOrderMargin(G);z(he)}catch(he){console.error("Margin calculation error:",he),alert(`Margin calculation failed: ${he.message||"Unknown error"}`)}finally{W(!1)}};return t.jsxs("div",{style:{padding:"12px",fontFamily:"Consolas, monospace",fontSize:"11px",color:Wn},children:[t.jsx("div",{style:{display:"flex",gap:"2px",marginBottom:"16px",borderBottom:`1px solid ${Jt}`},children:[{id:"order",label:"PLACE ORDER",icon:Nr},{id:"gtt",label:"GTT ORDER",icon:Cs},{id:"margin",label:"MARGIN CALCULATOR",icon:zT}].map(({id:he,label:me,icon:ge})=>t.jsxs("button",{onClick:()=>e(he),style:{backgroundColor:s===he?Tn:"transparent",border:"none",borderBottom:s===he?`2px solid ${Di}`:"2px solid transparent",color:s===he?Di:Jt,padding:"8px 16px",fontSize:"9px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px",fontFamily:"Consolas, monospace"},children:[t.jsx(ge,{size:12}),me]},he))}),s==="order"&&t.jsxs("div",{style:{backgroundColor:fp,padding:"16px",border:`1px solid ${Jt}`},children:[t.jsx("div",{style:{color:Di,fontWeight:"bold",marginBottom:"16px",fontSize:"12px"},children:"PLACE ORDER"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"SYMBOL"}),t.jsx("input",{type:"text",value:r,onChange:he=>n(he.target.value),placeholder:"e.g., NSE:SBIN-EQ",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"QUANTITY"}),t.jsx("input",{type:"number",value:i,onChange:he=>o(Number(he.target.value)),min:"1",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"SIDE"}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{onClick:()=>l("BUY"),style:{flex:1,backgroundColor:a==="BUY"?tc:Tn,color:a==="BUY"?"black":tc,border:`1px solid ${tc}`,padding:"6px",fontSize:"9px",fontWeight:"bold",cursor:"pointer"},children:"BUY"}),t.jsx("button",{onClick:()=>l("SELL"),style:{flex:1,backgroundColor:a==="SELL"?cl:Tn,color:a==="SELL"?Wn:cl,border:`1px solid ${cl}`,padding:"6px",fontSize:"9px",fontWeight:"bold",cursor:"pointer"},children:"SELL"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"ORDER TYPE"}),t.jsxs("select",{value:d,onChange:he=>p(he.target.value),style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"MARKET",children:"MARKET"}),t.jsx("option",{value:"LIMIT",children:"LIMIT"}),t.jsx("option",{value:"STOP",children:"STOP"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"PRODUCT TYPE"}),t.jsxs("select",{value:f,onChange:he=>h(he.target.value),style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"CNC",children:"CNC"}),t.jsx("option",{value:"INTRADAY",children:"INTRADAY"}),t.jsx("option",{value:"MARGIN",children:"MARGIN"})]})]}),(d==="LIMIT"||d==="STOP")&&t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"LIMIT PRICE"}),t.jsx("input",{type:"number",value:x,onChange:he=>m(Number(he.target.value)),step:"0.05",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),d==="STOP"&&t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"STOP PRICE"}),t.jsx("input",{type:"number",value:b,onChange:he=>w(Number(he.target.value)),step:"0.05",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]})]}),t.jsx("button",{onClick:Z,style:{marginTop:"16px",backgroundColor:Di,color:"black",border:"none",padding:"10px 20px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",width:"100%",fontFamily:"Consolas, monospace"},children:"PLACE ORDER"})]}),s==="gtt"&&t.jsxs("div",{style:{backgroundColor:fp,padding:"16px",border:`1px solid ${Jt}`},children:[t.jsx("div",{style:{color:Di,fontWeight:"bold",marginBottom:"16px",fontSize:"12px"},children:"GTT ORDER (GOOD TILL TRIGGERED)"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"SYMBOL"}),t.jsx("input",{type:"text",value:y,onChange:he=>C(he.target.value),placeholder:"e.g., NSE:SBIN-EQ",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"QUANTITY"}),t.jsx("input",{type:"number",value:T,onChange:he=>E(Number(he.target.value)),min:"1",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"SIDE"}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{onClick:()=>k("BUY"),style:{flex:1,backgroundColor:j==="BUY"?tc:Tn,color:j==="BUY"?"black":tc,border:`1px solid ${tc}`,padding:"6px",fontSize:"9px",fontWeight:"bold",cursor:"pointer"},children:"BUY"}),t.jsx("button",{onClick:()=>k("SELL"),style:{flex:1,backgroundColor:j==="SELL"?cl:Tn,color:j==="SELL"?Wn:cl,border:`1px solid ${cl}`,padding:"6px",fontSize:"9px",fontWeight:"bold",cursor:"pointer"},children:"SELL"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"PRODUCT TYPE"}),t.jsxs("select",{value:A,onChange:he=>R(he.target.value),style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"CNC",children:"CNC"}),t.jsx("option",{value:"INTRADAY",children:"INTRADAY"}),t.jsx("option",{value:"MARGIN",children:"MARGIN"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"TRIGGER PRICE"}),t.jsx("input",{type:"number",value:M,onChange:he=>P(Number(he.target.value)),step:"0.05",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"LIMIT PRICE"}),t.jsx("input",{type:"number",value:I,onChange:he=>O(Number(he.target.value)),step:"0.05",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]})]}),t.jsx("button",{onClick:fe,style:{marginTop:"16px",backgroundColor:Di,color:"black",border:"none",padding:"10px 20px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",width:"100%",fontFamily:"Consolas, monospace"},children:"PLACE GTT ORDER"})]}),s==="margin"&&t.jsxs("div",{children:[t.jsxs("div",{style:{backgroundColor:fp,padding:"16px",border:`1px solid ${Jt}`,marginBottom:"12px"},children:[t.jsx("div",{style:{color:Di,fontWeight:"bold",marginBottom:"16px",fontSize:"12px"},children:"ADD ORDER TO CALCULATE MARGIN"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"SYMBOL"}),t.jsx("input",{type:"text",value:D.symbol,onChange:he=>oe({...D,symbol:he.target.value}),placeholder:"e.g., NSE:SBIN-EQ",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"QTY"}),t.jsx("input",{type:"number",value:D.qty,onChange:he=>oe({...D,qty:Number(he.target.value)}),min:"1",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"SIDE"}),t.jsxs("select",{value:D.side,onChange:he=>oe({...D,side:he.target.value}),style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"BUY",children:"BUY"}),t.jsx("option",{value:"SELL",children:"SELL"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"TYPE"}),t.jsxs("select",{value:D.type,onChange:he=>oe({...D,type:he.target.value}),style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"MARKET",children:"MARKET"}),t.jsx("option",{value:"LIMIT",children:"LIMIT"}),t.jsx("option",{value:"STOP",children:"STOP"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"PRODUCT"}),t.jsxs("select",{value:D.productType,onChange:he=>oe({...D,productType:he.target.value}),style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"},children:[t.jsx("option",{value:"CNC",children:"CNC"}),t.jsx("option",{value:"INTRADAY",children:"INTRADAY"}),t.jsx("option",{value:"MARGIN",children:"MARGIN"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",color:Jt,marginBottom:"4px",fontSize:"9px"},children:"LIMIT PRICE"}),t.jsx("input",{type:"number",value:D.limitPrice||0,onChange:he=>oe({...D,limitPrice:Number(he.target.value)}),step:"0.05",style:{width:"100%",backgroundColor:Tn,border:`1px solid ${Jt}`,color:Wn,padding:"6px",fontSize:"11px",fontFamily:"Consolas, monospace"}})]})]}),t.jsx("button",{onClick:Q,style:{marginTop:"12px",backgroundColor:Tn,border:`1px solid ${Di}`,color:Di,padding:"8px 16px",fontSize:"9px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"+ ADD ORDER"})]}),G.length>0&&t.jsxs("div",{style:{backgroundColor:fp,padding:"16px",border:`1px solid ${Jt}`,marginBottom:"12px"},children:[t.jsxs("div",{style:{color:Di,fontWeight:"bold",marginBottom:"12px",fontSize:"12px"},children:["ORDERS (",G.length,")"]}),t.jsx("div",{style:{maxHeight:"200px",overflow:"auto"},children:G.map((he,me)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px",backgroundColor:Tn,marginBottom:"4px",fontSize:"10px"},children:[t.jsxs("div",{style:{flex:1},children:[t.jsx("span",{style:{color:Wn},children:he.symbol}),t.jsxs("span",{style:{color:Jt,marginLeft:"8px"},children:[he.side," ",he.qty," @ ",he.limitPrice||"MKT"]}),t.jsx("span",{style:{color:Jt,marginLeft:"8px"},children:he.productType})]}),t.jsx("button",{onClick:()=>_(me),style:{backgroundColor:"transparent",border:`1px solid ${cl}`,color:cl,padding:"4px 8px",fontSize:"9px",cursor:"pointer"},children:"REMOVE"})]},me))}),t.jsx("button",{onClick:Y,disabled:$,style:{marginTop:"12px",backgroundColor:Di,color:"black",border:"none",padding:"10px 20px",fontSize:"11px",fontWeight:"bold",cursor:$?"not-allowed":"pointer",width:"100%",fontFamily:"Consolas, monospace",opacity:$?.5:1},children:$?"CALCULATING...":"CALCULATE MARGIN"})]}),F&&t.jsxs("div",{style:{backgroundColor:fp,padding:"16px",border:`1px solid ${Jt}`},children:[t.jsx("div",{style:{color:Di,fontWeight:"bold",marginBottom:"12px",fontSize:"12px"},children:"MARGIN CALCULATION RESULT"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:Jt,fontSize:"9px",marginBottom:"4px"},children:"AVAILABLE MARGIN"}),t.jsxs("div",{style:{color:tc,fontSize:"14px",fontWeight:"bold"},children:["",F.margin_avail?.toFixed(2)||"0.00"]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:Jt,fontSize:"9px",marginBottom:"4px"},children:"REQUIRED MARGIN"}),t.jsxs("div",{style:{color:Di,fontSize:"14px",fontWeight:"bold"},children:["",F.total?.toFixed(2)||"0.00"]})]})]}),F.data&&F.data.length>0&&t.jsxs("div",{style:{marginTop:"12px"},children:[t.jsx("div",{style:{color:Jt,fontSize:"9px",marginBottom:"8px"},children:"ORDER-WISE BREAKDOWN"}),F.data.map((he,me)=>t.jsxs("div",{style:{backgroundColor:Tn,padding:"8px",marginBottom:"4px",fontSize:"10px"},children:[t.jsx("div",{style:{color:Wn},children:he.symbol||G[me]?.symbol}),t.jsxs("div",{style:{color:Jt,marginTop:"4px"},children:["Margin: ",he.margin?.toFixed(2)||"0.00"]})]},me))]})]})]})]})},RX=()=>{const[s,e]=S.useState(!1),[r,n]=S.useState(!1),[i,o]=S.useState(!0),[a,l]=S.useState("overview"),[d,p]=S.useState(!1),f="#FFA500",h="#FFFFFF",x="#787878",m="#000000",b="#0a0a0a",w="#00C800",y="#FF0000";S.useEffect(()=>{C()},[]);const C=async()=>{o(!0);try{const{sqliteService:k}=await Br(async()=>{const{sqliteService:R}=await Promise.resolve().then(()=>jd);return{sqliteService:R}},void 0);await k.initialize(),await zn.initialize()?(await zn.getProfile(),e(!0),zn.loadSymbolMaster().catch(console.error)):e(!1)}catch(k){console.error("[Fyers] Connection check failed:",k),e(!1)}finally{o(!1)}},T=async()=>{await C(),n(!1)},E=()=>{uc.disconnect(),p(!1),e(!1)},j=async()=>{const k=zn.isMarketOpen();if(d)uc.disconnect(),p(!1);else{if(!k){console.warn("[Fyers] Cannot start WebSocket - market is closed"),alert("Market is currently closed. Live updates are not available.");return}try{if(await zn.initialize()){const{sqliteService:R}=await Br(async()=>{const{sqliteService:P}=await Promise.resolve().then(()=>jd);return{sqliteService:P}},void 0),M=await R.getCredentialByService("fyers");M&&M.api_key&&M.password&&(uc.connect(M.api_key,M.password),p(!0))}}catch(A){console.error("[Fyers] WebSocket connection failed:",A)}}};return i?t.jsx("div",{style:{height:"100%",backgroundColor:m,color:h,fontFamily:"Consolas, monospace",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px"},children:t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx("div",{style:{color:f,marginBottom:"10px"},children:"Loading Fyers..."}),t.jsx("div",{style:{color:x,fontSize:"9px"},children:"Checking connection status"})]})}):s?t.jsxs("div",{style:{height:"100%",backgroundColor:m,color:h,fontFamily:"Consolas, monospace",display:"flex",flexDirection:"column",fontSize:"11px"},children:[t.jsxs("div",{style:{backgroundColor:b,borderBottom:`1px solid ${x}`,padding:"8px 12px",display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{color:f,fontWeight:"bold",fontSize:"12px"},children:"FYERS BROKER"}),t.jsx("span",{style:{color:x},children:"|"}),t.jsxs("span",{style:{color:d?w:x,fontSize:"9px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Cs,{size:10}),d?"LIVE":"OFFLINE"]})]}),t.jsxs("div",{style:{display:"flex",gap:"6px"},children:[t.jsxs("button",{onClick:j,style:{backgroundColor:d?y:w,color:d?h:"black",border:"none",padding:"4px 8px",fontSize:"9px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Cs,{size:10}),d?"STOP LIVE":"START LIVE"]}),t.jsxs("button",{onClick:()=>window.location.reload(),style:{backgroundColor:m,border:`1px solid ${x}`,color:h,padding:"4px 8px",fontSize:"9px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(xn,{size:10}),"REFRESH"]}),t.jsxs("button",{onClick:E,style:{backgroundColor:m,border:`1px solid ${y}`,color:y,padding:"4px 8px",fontSize:"9px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx($T,{size:10}),"DISCONNECT"]})]})]}),t.jsx("div",{style:{backgroundColor:b,borderBottom:`1px solid ${x}`,padding:"0 12px",display:"flex",gap:"2px",flexShrink:0},children:[{id:"overview",label:"OVERVIEW",icon:Nr},{id:"holdings",label:"HOLDINGS",icon:qb},{id:"positions",label:"POSITIONS",icon:Cs},{id:"orders",label:"ORDERS",icon:ri},{id:"market",label:"MARKET",icon:Hb},{id:"trading",label:"TRADING",icon:Nr}].map(({id:k,label:A,icon:R})=>t.jsxs("button",{onClick:()=>l(k),style:{backgroundColor:a===k?m:"transparent",border:"none",borderBottom:a===k?`2px solid ${f}`:"2px solid transparent",color:a===k?f:x,padding:"8px 12px",fontSize:"9px",cursor:"pointer",fontWeight:"bold",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(R,{size:10}),A]},k))}),t.jsxs("div",{style:{flex:1,overflow:"auto"},children:[a==="overview"&&t.jsxs("div",{style:{padding:"12px"},children:[t.jsx(SX,{}),t.jsx(wX,{})]}),a==="holdings"&&t.jsx(EX,{}),a==="positions"&&t.jsx(CX,{wsConnected:d}),a==="orders"&&t.jsx(jX,{wsConnected:d}),a==="market"&&t.jsx(AX,{}),a==="trading"&&t.jsx(TX,{})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{height:"100%",backgroundColor:m,color:h,fontFamily:"Consolas, monospace",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",fontSize:"11px"},children:t.jsxs("div",{style:{textAlign:"center",padding:"40px",border:`2px solid ${f}`,backgroundColor:b},children:[t.jsx("div",{style:{color:f,fontSize:"14px",fontWeight:"bold",marginBottom:"10px"},children:"FYERS NOT CONNECTED"}),t.jsxs("div",{style:{color:x,fontSize:"10px",marginBottom:"20px",lineHeight:"1.5"},children:["Connect your Fyers broker account to access",t.jsx("br",{}),"trading, portfolio, and market data features."]}),t.jsx("button",{onClick:()=>n(!0),style:{backgroundColor:f,color:"black",border:"none",padding:"10px 20px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:"CONNECT FYERS"})]})}),r&&t.jsx(vX,{onClose:()=>n(!1),onSuccess:T})]})},NX={BASE_URL:"https://finceptbackend.share.zrok.io"},OX=s=>`${NX.BASE_URL}${s}`;async function Zi(s,e="GET",r,n){try{const i={method:e,headers:{"Content-Type":"application/json",...r&&{"X-API-Key":r}}};n&&(e==="POST"||e==="PUT")&&(i.body=JSON.stringify(n)),console.log(`[SupportAPI] ${e} ${s}`,n||"");const o=await tn(OX(s),i),a=await o.json();return console.log("[SupportAPI] Response:",a),{success:o.ok,data:a,error:o.ok?void 0:a.detail||a.error||"Request failed",status_code:o.status}}catch(i){return console.error(`[SupportAPI] Error in ${e} ${s}:`,i),{success:!1,error:i instanceof Error?i.message:"Network error",status_code:500}}}class pd{static async getUserTickets(e){return Zi("/support/tickets","GET",e)}static async createTicket(e,r){return Zi("/support/tickets","POST",e,r)}static async getTicketDetails(e,r){return Zi(`/support/tickets/${r}`,"GET",e)}static async updateTicket(e,r,n){return Zi(`/support/tickets/${r}`,"PUT",e,{status:n})}static async addTicketMessage(e,r,n){return Zi(`/support/tickets/${r}/messages`,"POST",e,{message:n})}static async getSupportStats(e){return Zi("/support/stats","GET",e)}static async submitContactForm(e){return Zi("/support/contact","POST",void 0,e)}static async submitFeedback(e){return Zi("/support/feedback","POST",void 0,e)}static async getSupportCategories(){return Zi("/support/categories","GET")}static async subscribeToNewsletter(e,r){return Zi("/support/newsletter/subscribe","POST",void 0,{email:e,name:r,source:"terminal"})}static async unsubscribeFromNewsletter(e,r){const n=new URLSearchParams({email:e});return r&&n.append("token",r),Zi(`/support/newsletter/unsubscribe?${n.toString()}`,"POST")}static async checkNewsletterStatus(e){return Zi(`/support/newsletter/status?email=${encodeURIComponent(e)}`,"GET")}}const _X=()=>{const{colors:s,fontSize:e,fontFamily:r,fontWeight:n,fontStyle:i}=Er(),o={ORANGE:s.primary,WHITE:s.text,RED:s.alert,GREEN:s.secondary,YELLOW:s.warning,GRAY:s.textMuted,BLUE:s.info,PURPLE:s.purple,CYAN:s.accent,DARK_BG:s.background,PANEL_BG:s.panel},{session:a}=Ao(),[l,d]=S.useState(new Date),[p,f]=S.useState("list"),[h,x]=S.useState(!1),m={id:"DEMO-001",ticket_id:"DEMO-001",subject:"Welcome to Fincept Support - Demo Ticket",description:`This is a demonstration ticket to help you understand how our support system works.

HOW TO USE SUPPORT:
1. Click "+ CREATE TICKET" to submit a new support request
2. Fill in the subject, category, priority, and detailed description
3. Our support team will respond within 24 hours
4. You can add messages to continue the conversation
5. Close the ticket when your issue is resolved

AVAILABLE CATEGORIES:
- Technical Issue: For bugs, errors, or technical problems
- Billing: Questions about payments, subscriptions, or invoices
- Feature Request: Suggest new features or improvements
- Bug Report: Report software bugs with detailed steps
- Account: Account access, settings, or profile issues
- Other: General inquiries

This demo ticket shows you exactly how your real support tickets will appear. Feel free to explore and create your own ticket when you need assistance!`,category:"technical",priority:"medium",status:"open",created_at:new Date().toISOString(),messages:[{sender_type:"support",message:"Welcome to Fincept Terminal Support! This is how our support team will respond to your tickets. We typically respond within 24 hours during business days.",created_at:new Date(Date.now()-36e5).toISOString()},{sender_type:"user",message:"Thank you! I understand how the system works now.",created_at:new Date(Date.now()-18e5).toISOString()},{sender_type:"support",message:"Great! Feel free to create a real ticket anytime you need help. Our team is here to assist you 24/7.",created_at:new Date(Date.now()-9e5).toISOString()}]},[b,w]=S.useState([m]),[y,C]=S.useState(null),[T,E]=S.useState({total_tickets:1,open_tickets:1,resolved_tickets:0}),[j,k]=S.useState({subject:"",description:"",category:"technical",priority:"medium"}),[A,R]=S.useState("");S.useEffect(()=>{const D=setInterval(()=>d(new Date),1e3);return()=>clearInterval(D)},[]),S.useEffect(()=>{a?.api_key&&(M(),P())},[a]);const M=async()=>{if(!a?.api_key)return;x(!0);const D=await pd.getUserTickets(a.api_key);if(D.success){const oe=D.data?.tickets||D.data||[];w([m,...oe])}else w([m]);x(!1)},P=async()=>{if(!a?.api_key)return;const D=await pd.getSupportStats(a.api_key);D.success&&E(D.data)},I=async()=>{if(!a?.api_key||!j.subject||!j.description){alert("Please fill in all required fields");return}x(!0);const D=await pd.createTicket(a.api_key,j);x(!1),D.success?(alert("Ticket created successfully!"),k({subject:"",description:"",category:"technical",priority:"medium"}),f("list"),M()):alert(`Failed to create ticket: ${D.error}`)},O=async D=>{if(D==="DEMO-001"){C(m),f("details");return}if(!a?.api_key)return;x(!0);const oe=await pd.getTicketDetails(a.api_key,D);x(!1),oe.success?(C(oe.data),f("details")):alert(`Failed to load ticket details: ${oe.error}`)},G=async()=>{if(!a?.api_key||!y||!A.trim())return;x(!0);const D=await pd.addTicketMessage(a.api_key,y.id||y.ticket_id,A);x(!1),D.success?(R(""),O(y.id||y.ticket_id)):alert(`Failed to add message: ${D.error}`)},B=async D=>{if(!a?.api_key||!y)return;x(!0);const oe=await pd.updateTicket(a.api_key,y.id||y.ticket_id,D);x(!1),oe.success?(O(y.id||y.ticket_id),M()):alert(`Failed to update ticket: ${oe.error}`)},F=D=>D?new Date(D).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",z=D=>{switch(D?.toLowerCase()){case"open":case"in_progress":return o.CYAN;case"resolved":case"closed":return o.GREEN;case"pending":return o.YELLOW;default:return o.GRAY}},$=D=>{switch(D?.toLowerCase()){case"high":case"urgent":return o.RED;case"medium":return o.ORANGE;case"low":return o.GREEN;default:return o.GRAY}},W=D=>{switch(D?.toLowerCase()){case"open":case"in_progress":return t.jsx(uo,{size:14});case"resolved":case"closed":return t.jsx(MT,{size:14});default:return t.jsx(Rp,{size:14})}};return a?t.jsxs("div",{style:{height:"100%",backgroundColor:o.DARK_BG,color:o.WHITE,fontFamily:"Consolas, monospace",overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        *::-webkit-scrollbar-track {
          background: #1a1a1a;
        }
        *::-webkit-scrollbar-thumb {
          background: #404040;
          border-radius: 4px;
        }
        *::-webkit-scrollbar-thumb:hover {
          background: #525252;
        }
      `}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:o.PANEL_BG,borderBottom:`1px solid ${o.GRAY}`,fontSize:"13px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:o.ORANGE,fontWeight:"bold"},children:"FINCEPT"}),t.jsx("span",{style:{color:o.WHITE},children:"SUPPORT TERMINAL"}),t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsx("span",{style:{color:o.WHITE,fontSize:"11px"},children:l.toISOString().replace("T"," ").substring(0,19)})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:o.GRAY,fontSize:"11px"},children:"TICKETS:"}),t.jsx("span",{style:{color:o.CYAN,fontSize:"11px",fontWeight:"bold"},children:T.total_tickets||0}),t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsx("span",{style:{color:o.YELLOW,fontSize:"11px"},children:"OPEN:"}),t.jsx("span",{style:{color:o.YELLOW,fontSize:"11px",fontWeight:"bold"},children:T.open_tickets||0}),t.jsx("span",{style:{color:o.GRAY},children:"|"}),t.jsx("span",{style:{color:o.GREEN,fontSize:"11px"},children:"RESOLVED:"}),t.jsx("span",{style:{color:o.GREEN,fontSize:"11px",fontWeight:"bold"},children:T.resolved_tickets||0})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:o.PANEL_BG,borderBottom:`1px solid ${o.GRAY}`,fontSize:"12px",gap:"8px",flexShrink:0},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[p==="list"&&t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:M,disabled:h,style:{backgroundColor:o.ORANGE,color:"black",border:"none",padding:"4px 12px",fontSize:"11px",fontWeight:"bold",cursor:h?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(xn,{size:12}),"REFRESH"]}),t.jsxs("button",{onClick:()=>f("create"),style:{backgroundColor:o.GREEN,color:"black",border:"none",padding:"4px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(wn,{size:12}),"CREATE TICKET"]})]}),(p==="create"||p==="details")&&t.jsxs("button",{onClick:()=>f("list"),style:{backgroundColor:o.GRAY,color:"black",border:"none",padding:"4px 12px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(ks,{size:12}),"BACK TO LIST"]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:h?o.ORANGE:o.GREEN,fontSize:"14px"},children:""}),t.jsx("span",{style:{color:h?o.ORANGE:o.GREEN,fontSize:"11px",fontWeight:"bold"},children:h?"UPDATING":"READY"})]})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:[p==="list"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{color:o.ORANGE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"0.5px"},children:"SUPPORT TICKETS"}),t.jsx("div",{style:{borderBottom:`1px solid ${o.GRAY}`,marginBottom:"16px"}}),h&&b.length===0?t.jsx("div",{style:{color:o.GRAY,fontSize:"12px",textAlign:"center",marginTop:"40px"},children:"Loading tickets..."}):b.length>0?t.jsx("div",{style:{display:"grid",gap:"8px"},children:b.map(D=>{const oe=D.id==="DEMO-001"||D.ticket_id==="DEMO-001";return t.jsxs("div",{onClick:()=>O(D.id||D.ticket_id),style:{backgroundColor:o.PANEL_BG,border:`1px solid ${oe?o.BLUE:o.GRAY}`,borderLeft:`4px solid ${z(D.status)}`,padding:"12px",cursor:"pointer",transition:"all 0.2s",position:"relative"},onMouseEnter:Z=>{Z.currentTarget.style.borderColor=o.ORANGE,Z.currentTarget.style.backgroundColor="#1a1a1a"},onMouseLeave:Z=>{Z.currentTarget.style.borderColor=oe?o.BLUE:o.GRAY,Z.currentTarget.style.backgroundColor=o.PANEL_BG},children:[oe&&t.jsx("div",{style:{position:"absolute",top:"8px",right:"8px",backgroundColor:o.BLUE,color:"black",padding:"2px 8px",fontSize:"9px",fontWeight:"bold"},children:"DEMO"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"80px 1fr 120px 120px 120px 150px",gap:"12px",alignItems:"center",fontSize:"11px"},children:[t.jsxs("div",{style:{color:o.GRAY},children:["#",D.id||D.ticket_id]}),t.jsx("div",{style:{color:o.WHITE,fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:D.subject}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[W(D.status),t.jsx("span",{style:{color:z(D.status),fontWeight:"bold"},children:D.status?.toUpperCase()})]}),t.jsx("div",{style:{backgroundColor:$(D.priority),color:"black",padding:"2px 8px",fontSize:"9px",fontWeight:"bold",textAlign:"center"},children:D.priority?.toUpperCase()}),t.jsx("div",{style:{color:o.CYAN,textAlign:"center"},children:D.category?.toUpperCase()}),t.jsx("div",{style:{color:o.GRAY,fontSize:"10px",textAlign:"right"},children:F(D.created_at)})]})]},D.id||D.ticket_id)})}):t.jsx("div",{style:{color:o.GRAY,fontSize:"12px",textAlign:"center",marginTop:"40px"},children:"No support tickets found. Create your first ticket to get started!"})]}),p==="create"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{color:o.ORANGE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"0.5px"},children:"CREATE NEW TICKET"}),t.jsx("div",{style:{borderBottom:`1px solid ${o.GRAY}`,marginBottom:"16px"}}),t.jsx("div",{style:{backgroundColor:o.PANEL_BG,border:`1px solid ${o.GRAY}`,borderLeft:`4px solid ${o.GREEN}`,padding:"20px",maxWidth:"800px"},children:t.jsxs("div",{style:{display:"grid",gap:"16px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:o.GRAY,fontSize:"11px",display:"block",marginBottom:"4px"},children:"SUBJECT *"}),t.jsx("input",{type:"text",value:j.subject,onChange:D=>k({...j,subject:D.target.value}),placeholder:"Brief description of your issue",style:{width:"100%",padding:"8px",backgroundColor:o.DARK_BG,border:`1px solid ${o.GRAY}`,color:o.WHITE,fontSize:"11px",fontFamily:"Consolas, monospace",outline:"none"}})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:o.GRAY,fontSize:"11px",display:"block",marginBottom:"4px"},children:"CATEGORY *"}),t.jsxs("select",{value:j.category,onChange:D=>k({...j,category:D.target.value}),style:{width:"100%",padding:"8px",backgroundColor:o.DARK_BG,border:`1px solid ${o.GRAY}`,color:o.WHITE,fontSize:"11px",fontFamily:"Consolas, monospace",outline:"none",cursor:"pointer"},children:[t.jsx("option",{value:"technical",children:"Technical Issue"}),t.jsx("option",{value:"billing",children:"Billing"}),t.jsx("option",{value:"feature",children:"Feature Request"}),t.jsx("option",{value:"bug",children:"Bug Report"}),t.jsx("option",{value:"account",children:"Account"}),t.jsx("option",{value:"other",children:"Other"})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:o.GRAY,fontSize:"11px",display:"block",marginBottom:"4px"},children:"PRIORITY"}),t.jsxs("select",{value:j.priority,onChange:D=>k({...j,priority:D.target.value}),style:{width:"100%",padding:"8px",backgroundColor:o.DARK_BG,border:`1px solid ${o.GRAY}`,color:o.WHITE,fontSize:"11px",fontFamily:"Consolas, monospace",outline:"none",cursor:"pointer"},children:[t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"high",children:"High"})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:o.GRAY,fontSize:"11px",display:"block",marginBottom:"4px"},children:"DESCRIPTION *"}),t.jsx("textarea",{value:j.description,onChange:D=>k({...j,description:D.target.value}),placeholder:"Provide detailed information about your issue...",rows:12,style:{width:"100%",padding:"8px",backgroundColor:o.DARK_BG,border:`1px solid ${o.GRAY}`,color:o.WHITE,fontSize:"11px",fontFamily:"Consolas, monospace",outline:"none",resize:"vertical"}})]}),t.jsx("button",{onClick:I,disabled:h,style:{padding:"10px 20px",backgroundColor:h?o.GRAY:o.GREEN,border:"none",color:"black",fontSize:"11px",fontWeight:"bold",cursor:h?"not-allowed":"pointer",width:"fit-content"},children:h?"CREATING...":"CREATE TICKET"})]})})]}),p==="details"&&y&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{color:o.ORANGE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"0.5px"},children:["TICKET DETAILS - #",y.id||y.ticket_id]}),t.jsx("div",{style:{borderBottom:`1px solid ${o.GRAY}`,marginBottom:"16px"}}),(()=>{const D=y.id==="DEMO-001"||y.ticket_id==="DEMO-001",oe=y.messages||[];return t.jsxs(t.Fragment,{children:[D&&t.jsx("div",{style:{backgroundColor:o.BLUE,color:"black",padding:"8px 12px",marginBottom:"12px",fontSize:"11px",fontWeight:"bold",textAlign:"center"},children:"DEMO TICKET - This shows you how the support system works. Create your own ticket to get real support!"}),t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`1px solid ${D?o.BLUE:o.GRAY}`,borderLeft:`4px solid ${z(y.status)}`,padding:"16px",marginBottom:"16px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:o.WHITE,fontSize:"14px",fontWeight:"bold",marginBottom:"8px"},children:y.subject}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, auto)",gap:"16px",fontSize:"11px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:o.GRAY},children:"Status: "}),t.jsx("span",{style:{color:z(y.status),fontWeight:"bold"},children:y.status?.toUpperCase()})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:o.GRAY},children:"Priority: "}),t.jsx("span",{style:{color:$(y.priority),fontWeight:"bold"},children:y.priority?.toUpperCase()})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:o.GRAY},children:"Category: "}),t.jsx("span",{style:{color:o.CYAN},children:y.category?.toUpperCase()})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:o.GRAY},children:"Created: "}),t.jsx("span",{style:{color:o.WHITE},children:F(y.created_at)})]})]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[!D&&y.status!=="closed"&&t.jsx("button",{onClick:()=>B("closed"),disabled:h,style:{padding:"6px 12px",backgroundColor:o.DARK_BG,border:`1px solid ${o.RED}`,color:o.RED,fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"CLOSE"}),!D&&y.status==="closed"&&t.jsx("button",{onClick:()=>B("open"),disabled:h,style:{padding:"6px 12px",backgroundColor:o.DARK_BG,border:`1px solid ${o.GREEN}`,color:o.GREEN,fontSize:"10px",fontWeight:"bold",cursor:"pointer"},children:"REOPEN"})]})]}),t.jsx("div",{style:{padding:"12px",backgroundColor:o.DARK_BG,borderLeft:`4px solid ${o.BLUE}`,color:o.WHITE,fontSize:"11px",lineHeight:"1.6",whiteSpace:"pre-wrap"},children:y.description})]}),t.jsxs("div",{style:{color:o.ORANGE,fontSize:"12px",fontWeight:"bold",marginBottom:"8px",letterSpacing:"0.5px"},children:["CONVERSATION (",oe.length,")"]}),t.jsx("div",{style:{borderBottom:`1px solid ${o.GRAY}`,marginBottom:"12px"}}),oe.length>0?t.jsx("div",{style:{display:"grid",gap:"8px",marginBottom:"16px"},children:oe.map((Z,fe)=>t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`1px solid ${o.GRAY}`,borderLeft:`4px solid ${Z.sender_type==="user"?o.CYAN:o.PURPLE}`,padding:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:Z.sender_type==="user"?o.CYAN:o.PURPLE,fontSize:"11px",fontWeight:"bold"},children:Z.sender_type==="user"?"YOU":"SUPPORT TEAM"}),t.jsx("span",{style:{color:o.GRAY,fontSize:"10px"},children:F(Z.created_at)})]}),t.jsx("div",{style:{color:o.WHITE,fontSize:"11px",lineHeight:"1.6"},children:Z.message})]},fe))}):t.jsx("div",{style:{color:o.GRAY,fontSize:"11px",textAlign:"center",padding:"20px"},children:"No messages yet"}),y.status!=="closed"&&!D&&t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`1px solid ${o.GRAY}`,borderLeft:`4px solid ${o.GREEN}`,padding:"16px"},children:[t.jsx("div",{style:{color:o.GREEN,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"ADD MESSAGE"}),t.jsx("textarea",{value:A,onChange:Z=>R(Z.target.value),placeholder:"Type your message here...",rows:4,style:{width:"100%",padding:"8px",backgroundColor:o.DARK_BG,border:`1px solid ${o.GRAY}`,color:o.WHITE,fontSize:"11px",fontFamily:"Consolas, monospace",outline:"none",resize:"vertical",marginBottom:"12px"}}),t.jsxs("button",{onClick:G,disabled:h||!A.trim(),style:{padding:"8px 16px",backgroundColor:h||!A.trim()?o.GRAY:o.GREEN,border:"none",color:"black",fontSize:"11px",fontWeight:"bold",cursor:h||!A.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Zg,{size:12}),h?"SENDING...":"SEND MESSAGE"]})]}),D&&t.jsxs("div",{style:{backgroundColor:o.PANEL_BG,border:`1px solid ${o.BLUE}`,borderLeft:`4px solid ${o.BLUE}`,padding:"16px"},children:[t.jsx("div",{style:{color:o.BLUE,fontSize:"11px",fontWeight:"bold",marginBottom:"8px"},children:"DEMO TICKET - READ ONLY"}),t.jsxs("div",{style:{color:o.GRAY,fontSize:"10px",lineHeight:"1.6"},children:["This is a demonstration ticket. You cannot add messages to demo tickets.",t.jsx("br",{}),t.jsx("br",{}),"To create a real support ticket and communicate with our team:",t.jsx("br",{}),'1. Click "BACK TO LIST"',t.jsx("br",{}),'2. Click "+ CREATE TICKET"',t.jsx("br",{}),"3. Fill in your issue details",t.jsx("br",{}),"4. Submit and receive support from our team"]})]})]})})()]})]}),t.jsxs("div",{style:{borderTop:`1px solid ${o.GRAY}`,backgroundColor:o.PANEL_BG,padding:"6px 12px",fontSize:"10px",color:o.GRAY,flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{children:"Fincept Terminal Support System | 24/7 Customer Service"}),t.jsxs("span",{children:["Response Time: < 24 hours | Status: ",h?"UPDATING":"READY"]})]})]}):t.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:o.DARK_BG},children:t.jsxs("div",{style:{textAlign:"center",fontFamily:"Consolas, monospace"},children:[t.jsx("div",{style:{color:o.ORANGE,fontSize:"16px",marginBottom:"8px",fontWeight:"bold"},children:"AUTHENTICATION REQUIRED"}),t.jsx("div",{style:{color:o.GRAY,fontSize:"12px"},children:"Please login to access support tickets"})]})})};class DX{constructor(){Pe(this,"apiKey","")}async loadApiKey(){try{Xi.info("Loading API key from database...");const e=await Je.getCredentials();Xi.debug("Found credentials:",e.map(n=>n.service_name));const r=e.find(n=>n.service_name.toLowerCase()==="polygon.io");if(Xi.debug("Polygon credential found:",!!r),r?.api_key)return this.apiKey=r.api_key,localStorage.setItem("POLYGON_API_KEY",r.api_key),Xi.info("API key loaded successfully, length:",r.api_key.length),r.api_key;Xi.warn("No Polygon.io API key found in credentials")}catch(e){Xi.error("Failed to load Polygon API key from database:",e)}return""}getApiKey(){return this.apiKey}async executeCommand(e,r){try{this.apiKey||(Xi.debug("API key not set, loading..."),await this.loadApiKey()),Xi.debug("Executing command: "+e,{args:r}),Xi.debug("API key present:",!!this.apiKey);const n=await lt("execute_polygon_command",{command:e,args:r,apiKey:this.apiKey||null});Xi.debug("Command result received, length:",n.length);const i=JSON.parse(n);return Xi.debug("Parsed result success:",i.success),i}catch(n){throw Xi.error("Polygon API error:",n),n}}async getAllTickers(e){const r=[];return e&&Object.entries(e).forEach(([n,i])=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();r.push(`--${o}=${i}`)}),this.executeCommand("tickers",r)}async getTickerDetails(e,r){const n=[`--ticker=${e}`];return r&&n.push(`--date=${r}`),this.executeCommand("ticker-details",n)}async getTickerTypes(e,r){const n=[];return e&&n.push(`--asset-class=${e}`),r&&n.push(`--locale=${r}`),this.executeCommand("ticker-types",n)}async getRelatedTickers(e){return this.executeCommand("related-tickers",[`--ticker=${e}`])}async getNews(e){const r=[];return e&&Object.entries(e).forEach(([n,i])=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();r.push(`--${o}=${i}`)}),this.executeCommand("news",r)}async getIPOs(e){const r=[];return e&&Object.entries(e).forEach(([n,i])=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();r.push(`--${o}=${i}`)}),this.executeCommand("ipos",r)}async getSplits(e){const r=[];return e&&Object.entries(e).forEach(([n,i])=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();r.push(`--${o}=${i}`)}),this.executeCommand("splits",r)}async getDividends(e){const r=[];return e&&Object.entries(e).forEach(([n,i])=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();r.push(`--${o}=${i}`)}),this.executeCommand("dividends",r)}async getTickerEvents(e,r){const n=[`--identifier=${e}`];return r&&n.push(`--types=${r}`),this.executeCommand("ticker-events",n)}async getExchanges(e,r){const n=[];return e&&n.push(`--asset-class=${e}`),r&&n.push(`--locale=${r}`),this.executeCommand("exchanges",n)}async getConditionCodes(e){const r=[];return e&&Object.entries(e).forEach(([n,i])=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();r.push(`--${o}=${i}`)}),this.executeCommand("condition-codes",r)}async getMarketHolidays(){return this.executeCommand("market-holidays",[])}async getMarketStatus(){return this.executeCommand("market-status",[])}async getSingleTickerSnapshot(e){return this.executeCommand("ticker-snapshot",[`--ticker=${e}`])}async getFullMarketSnapshot(e,r){const n=[`--tickers=${e.join(",")}`];return r!==void 0&&n.push(`--include-otc=${r}`),this.executeCommand("market-snapshot",n)}async getUnifiedSnapshot(e){const r=[];return e&&Object.entries(e).forEach(([n,i])=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();r.push(`--${o}=${i}`)}),this.executeCommand("unified-snapshot",r)}async getTopMarketMovers(e,r){const n=[`--direction=${e}`];return r!==void 0&&n.push(`--include-otc=${r}`),this.executeCommand("top-movers",n)}async getTrades(e,r){const n=[`--ticker=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("trades",n)}async getLastTrade(e){return this.executeCommand("last-trade",[`--ticker=${e}`])}async getQuotes(e,r){const n=[`--ticker=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("quotes",n)}async getLastQuote(e){return this.executeCommand("last-quote",[`--ticker=${e}`])}async getSMA(e,r){const n=[`--ticker=${e}`];return Object.entries(r).forEach(([i,o])=>{if(o!==void 0){const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}}),this.executeCommand("sma",n)}async getEMA(e,r){const n=[`--ticker=${e}`];return Object.entries(r).forEach(([i,o])=>{if(o!==void 0){const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}}),this.executeCommand("ema",n)}async getMACD(e,r){const n=[`--ticker=${e}`];return Object.entries(r).forEach(([i,o])=>{if(o!==void 0){const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}}),this.executeCommand("macd",n)}async getRSI(e,r){const n=[`--ticker=${e}`];return Object.entries(r).forEach(([i,o])=>{if(o!==void 0){const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}}),this.executeCommand("rsi",n)}async getBalanceSheets(e,r){const n=[`--tickers=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("balance-sheets",n)}async getCashFlowStatements(e,r){const n=[`--tickers=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("cash-flow-statements",n)}async getIncomeStatements(e,r){const n=[`--tickers=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("income-statements",n)}async getFinancialRatios(e,r){const n=[`--ticker=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("ratios",n)}async getShortInterest(e,r){const n=[`--ticker=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("short-interest",n)}async getShortVolume(e,r){const n=[`--ticker=${e}`];return r&&Object.entries(r).forEach(([i,o])=>{const a=i.replace(/([A-Z])/g,"-$1").toLowerCase();n.push(`--${a}=${o}`)}),this.executeCommand("short-volume",n)}}const Yr=new DX;class IX{async getHistoricalData(e,r,n){try{const i=await lt("get_historical_data",{symbol:e,startDate:r,endDate:n});return i.success&&i.data?i.data:(console.warn(`[YFinanceService] Failed to fetch historical data for ${e}:`,i.error),[])}catch(i){return console.error(`[YFinanceService] Error fetching historical data for ${e}:`,i),[]}}async getStockInfo(e){try{const r=await lt("get_stock_info",{symbol:e});return r.success&&r.data?r.data:(console.warn(`[YFinanceService] Failed to fetch stock info for ${e}:`,r.error),null)}catch(r){return console.error(`[YFinanceService] Error fetching stock info for ${e}:`,r),null}}async getRecentHistory(e,r=30){const n=new Date,i=new Date;i.setDate(i.getDate()-r);const o=a=>a.toISOString().split("T")[0];return this.getHistoricalData(e,o(i),o(n))}}const PX=new IX,LX=({data:s,width:e=400,height:r=250,bullishColor:n="#00ff88",bearishColor:i="#ff4444",backgroundColor:o="#0a0a0a",gridColor:a="#222222",textColor:l="#888888",showGrid:d=!0,showVolume:p=!0,showLabels:f=!0})=>{const h=S.useRef(null);return S.useEffect(()=>{if(!h.current||s.length===0)return;const x=h.current,m=x.getContext("2d");if(!m)return;x.width=e,x.height=r,m.fillStyle=o,m.fillRect(0,0,e,r);const b=s.map(I=>I.high),w=s.map(I=>I.low),y=Math.max(...b),C=Math.min(...w),T=y-C||1,E={top:20,right:50,bottom:p?70:30,left:10},j=p?r*.7:r-E.top-E.bottom,k=e-E.left-E.right,A=p?r*.2:0,R=Math.max(2,Math.floor(k/s.length)-2),M=Math.floor(k/s.length);if(d){m.strokeStyle=a,m.lineWidth=1;const I=5;for(let G=0;G<=I;G++){const B=E.top+j/I*G;m.beginPath(),m.moveTo(E.left,B),m.lineTo(e-E.right,B),m.stroke()}const O=Math.min(5,s.length);for(let G=0;G<=O;G++){const B=E.left+k/O*G;m.beginPath(),m.moveTo(B,E.top),m.lineTo(B,E.top+j),m.stroke()}}if(f){m.fillStyle=l,m.font="9px Consolas, monospace",m.textAlign="left";const I=5;for(let O=0;O<=I;O++){const G=C+T/I*(I-O),B=E.top+j/I*O;m.fillText(G.toFixed(2),e-E.right+5,B+3)}}const P=p&&s.some(I=>I.volume)?Math.max(...s.map(I=>I.volume||0)):1;if(s.forEach((I,O)=>{const G=E.left+O*M+M/2,B=I.close>=I.open,F=B?n:i,z=E.top+(y-I.high)/T*j,$=E.top+(y-I.low)/T*j,W=E.top+(y-I.open)/T*j,D=E.top+(y-I.close)/T*j;m.strokeStyle=F,m.lineWidth=1,m.beginPath(),m.moveTo(G,z),m.lineTo(G,$),m.stroke();const oe=Math.min(W,D),Z=Math.abs(D-W)||1;if(m.fillStyle=F,m.fillRect(G-R/2,oe,R,Z),p&&I.volume){const fe=E.top+j+10,Q=I.volume/P*A;m.fillStyle=B?`${n}66`:`${i}66`,m.fillRect(G-R/2,fe+A-Q,R,Q)}}),f&&(m.fillStyle=l,m.font="9px Consolas, monospace",m.textAlign="center",[0,Math.floor(s.length/2),s.length-1].forEach(O=>{if(O<s.length){const G=E.left+O*M+M/2,B=new Date(s[O].timestamp*1e3),F=`${B.getMonth()+1}/${B.getDate()}`,z=p?E.top+j+A+20:r-10;m.fillText(F,G,z)}}),p&&(m.textAlign="left",m.fillText("VOL",E.left,E.top+j+25))),s.length>0){const I=s[s.length-1],O=I.close,G=E.top+(y-O)/T*j,F=I.close>=I.open?n:i;m.strokeStyle=F,m.lineWidth=1,m.setLineDash([5,5]),m.beginPath(),m.moveTo(E.left,G),m.lineTo(e-E.right,G),m.stroke(),m.setLineDash([]),m.fillStyle=F;const z=O.toFixed(2),$=m.measureText(z).width;m.fillRect(e-E.right+2,G-8,$+6,16),m.fillStyle=o,m.font="bold 10px Consolas, monospace",m.textAlign="left",m.fillText(z,e-E.right+5,G+3);const W=s[0],oe=(O-W.open)/W.open*100,Z=`${oe>=0?"+":""}${oe.toFixed(2)}%`;m.fillStyle=F,m.font="bold 11px Consolas, monospace",m.textAlign="left",m.fillText(Z,E.left+5,E.top+15)}},[s,e,r,n,i,o,a,l,d,p,f]),s.length===0?t.jsx("div",{style:{width:`${e}px`,height:`${r}px`,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:o,color:l,fontSize:"11px",fontFamily:"Consolas, monospace"},children:"No chart data available"}):t.jsx("canvas",{ref:h,style:{display:"block"}})},zX=()=>{const{colors:s}=Er(),e={ORANGE:s.primary,WHITE:s.text,RED:s.alert,GREEN:s.secondary,YELLOW:s.warning,GRAY:s.textMuted,BLUE:s.info,CYAN:s.accent,DARK_BG:s.panel,PANEL_BG:s.background,BORDER:"#222222",PANEL_HEADER_BG:"#1a1a1a"},[r,n]=S.useState("AAPL"),[i,o]=S.useState(""),[a,l]=S.useState(!1),[d,p]=S.useState(!1),[f,h]=S.useState(null),[x,m]=S.useState("financials"),[b,w]=S.useState(null),[y,C]=S.useState(null),[T,E]=S.useState([]),[j,k]=S.useState([]),[A,R]=S.useState(null),[M,P]=S.useState([]),[I,O]=S.useState([]),[G,B]=S.useState(null),[F,z]=S.useState(null),[$,W]=S.useState(null),[D,oe]=S.useState(null),[Z,fe]=S.useState(null),[Q,_]=S.useState(null),[Y,he]=S.useState(null),[me,ge]=S.useState(null),[le,X]=S.useState([]),[V,de]=S.useState([]),[je,_e]=S.useState(null),[Re,Be]=S.useState([]),[Se,ie]=S.useState([]),[ve,Ae]=S.useState([]),[$e,qe]=S.useState(null),[Ie,K]=S.useState(null),[Ee,Oe]=S.useState(null),[q,ee]=S.useState(null),[ce,Ce]=S.useState(null),[be,We]=S.useState(null),[J,se]=S.useState(null),[Te,Me]=S.useState(null),[Qe,ye]=S.useState(null),[ue,re]=S.useState(null),[ke,Ne]=S.useState([]);S.useEffect(()=>{(async()=>{const it=await Yr.loadApiKey();p(!!it)})()},[]);const U=()=>{const tt=document.querySelector('[data-tab="settings"]');tt&&tt.click()},ne=async tt=>{try{const it=await PX.getRecentHistory(tt,30);if(it&&it.length>0){const vt=it.map(rr=>({timestamp:rr.timestamp,open:rr.open,high:rr.high,low:rr.low,close:rr.close,volume:rr.volume}));Ne(vt),console.log(`[PolygonEqTab] Loaded ${vt.length} candlesticks for ${tt}`)}else Ne([]),console.warn(`[PolygonEqTab] No chart data available for ${tt}`)}catch(it){console.error("[PolygonEqTab] Error fetching chart data:",it),Ne([])}},xe=async()=>{if(!await Yr.loadApiKey()){console.log("[PolygonEqTab] No API key found, skipping data fetch");return}console.log("=== FETCHING DATA FOR:",r,"==="),l(!0),h(null);try{ne(r);const it=jt=>new Promise(Vs=>setTimeout(Vs,jt)),vt=200;console.log("[PolygonEqTab] Fetching ticker details...");const rr=await Yr.getTickerDetails(r).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching snapshot...");const Zt=await Yr.getSingleTickerSnapshot(r).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching news...");const mr=await Yr.getNews({ticker:r,limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching related tickers...");const Cr=await Yr.getRelatedTickers(r).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching market status...");const ts=await Yr.getMarketStatus().catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching dividends...");const As=await Yr.getDividends({ticker:r,limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching splits...");const Fs=await Yr.getSplits({ticker:r,limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching last trade...");const Ve=await Yr.getLastTrade(r).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching last quote...");const Ot=await Yr.getLastQuote(r).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching SMA(20)...");const It=await Yr.getSMA(r,{window:20,timespan:"day",limit:50}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching EMA(20)...");const Dt=await Yr.getEMA(r,{window:20,timespan:"day",limit:50}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching MACD...");const Ct=await Yr.getMACD(r,{shortWindow:12,longWindow:26,signalWindow:9,timespan:"day",limit:50}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching RSI...");const or=await Yr.getRSI(r,{window:14,timespan:"day",limit:50}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching income statements...");const rn=await Yr.getIncomeStatements(r,{timeframe:"annual",limit:5}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching balance sheets...");const $r=await Yr.getBalanceSheets(r,{timeframe:"annual",limit:5}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching all tickers...");const oi=await Yr.getAllTickers({search:r,limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching ticker types...");const Ei=await Yr.getTickerTypes().catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching ticker events...");const xs=await Yr.getTickerEvents(r).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching exchanges...");const $t=await Yr.getExchanges().catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching condition codes...");const Wr=await Yr.getConditionCodes({limit:20}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching market holidays...");const En=await Yr.getMarketHolidays().catch(jt=>({success:!1,error:jt.message}));await it(vt);const Ir=ts;console.log("[PolygonEqTab] Fetching SMA(50)...");const Fn=await Yr.getSMA(r,{window:50,timespan:"day",limit:100}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching EMA(50)...");const us=await Yr.getEMA(r,{window:50,timespan:"day",limit:100}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching MACD (full)...");const Pr=await Yr.getMACD(r,{shortWindow:12,longWindow:26,signalWindow:9,timespan:"day",limit:100}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching cash flow statements...");const Cn=await Yr.getCashFlowStatements(r,{timeframe:"annual",limit:5}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching financial ratios...");const Gr=await Yr.getFinancialRatios(r,{limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching short interest...");const Yn=await Yr.getShortInterest(r,{limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching short volume...");const cn=await Yr.getShortVolume(r,{limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching trades...");const dn=await Yr.getTrades(r,{limit:10}).catch(jt=>({success:!1,error:jt.message}));await it(vt),console.log("[PolygonEqTab] Fetching quotes...");const ho=await Yr.getQuotes(r,{limit:10}).catch(jt=>({success:!1,error:jt.message}));if(console.log("[PolygonEqTab] detailsResp:",rr),console.log("[PolygonEqTab] snapResp:",Zt),console.log("[PolygonEqTab] newsResp:",mr),console.log("[PolygonEqTab] lastTradeResp:",Ve),console.log("[PolygonEqTab] lastQuoteResp:",Ot),rr?.success!==!1&&rr?.ticker_details&&w(rr.ticker_details),Zt?.success!==!1&&Zt?.snapshot&&C(Zt.snapshot),mr?.success!==!1&&mr?.news_articles?E(mr.news_articles):E([]),Cr?.success!==!1&&Cr?.related_tickers){const jt=Cr.related_tickers.map(Vs=>typeof Vs=="string"?{ticker:Vs,name:null}:Vs);k(jt)}else k([]);ts?.success!==!1&&ts?.market_status&&R(ts.market_status),As?.success!==!1&&As?.dividends?P(As.dividends):P([]),Fs?.success!==!1&&Fs?.splits?O(Fs.splits):O([]),Ve?.success!==!1&&Ve?.last_trade&&B(Ve.last_trade),Ot?.success!==!1&&Ot?.last_quote&&z(Ot.last_quote),It?.success!==!1&&It?.sma_data&&W(It.sma_data),Dt?.success!==!1&&Dt?.ema_data&&oe(Dt.ema_data),Ct?.success!==!1&&Ct?.macd_data&&fe(Ct.macd_data),or?.success!==!1&&or?.rsi_data&&_(or.rsi_data),rn?.success!==!1&&rn?.income_statement_data&&he(rn.income_statement_data),$r?.success!==!1&&$r?.balance_sheet_data&&ge($r.balance_sheet_data),oi?.success!==!1&&oi?.tickers?X(oi.tickers):X([]),Ei?.success!==!1&&Ei?.ticker_types?de(Ei.ticker_types):de([]),xs?.success!==!1&&xs?.ticker_events?_e(xs.ticker_events):_e(null),$t?.success!==!1&&$t?.exchanges?Be($t.exchanges):Be([]),Wr?.success!==!1&&Wr?.condition_codes?ie(Wr.condition_codes):ie([]),En?.success!==!1&&En?.market_holidays?Ae(En.market_holidays):Ae([]),Ir?.success!==!1&&Ir?.market_status?qe(Ir.market_status):qe(null),Fn?.success!==!1&&Fn?.sma_data?K(Fn.sma_data):K(null),us?.success!==!1&&us?.ema_data?Oe(us.ema_data):Oe(null),Pr?.success!==!1&&Pr?.macd_data?ee(Pr.macd_data):ee(null),Cn?.success!==!1&&Cn?.cash_flow_data?Ce(Cn):Ce(null),Gr?.success!==!1&&Gr?.ratios_data?We(Gr):We(null),Yn?.success!==!1&&Yn?.short_interest_data?se(Yn):se(null),cn?.success!==!1&&cn?.short_volume_data?Me(cn):Me(null),dn?.success!==!1&&dn?.trades?ye(dn):ye(null),ho?.success!==!1&&ho?.quotes?re(ho):re(null),console.log("=== DATA FETCH COMPLETE (31/31 ENDPOINTS) ===")}catch(it){console.error("Critical error:",it),h(it.message||"Failed to fetch data")}finally{l(!1)}};S.useEffect(()=>{d&&xe()},[r,d]);const Le=()=>{i.trim()&&(n(i.trim().toUpperCase()),o(""))},ze=tt=>{n(tt)},Ge=(tt,it=2)=>!tt&&tt!==0?"N/A":tt.toLocaleString(void 0,{minimumFractionDigits:it,maximumFractionDigits:it}),Ze=tt=>!tt&&tt!==0?"N/A":tt>=1e12?`$${(tt/1e12).toFixed(2)}T`:tt>=1e9?`$${(tt/1e9).toFixed(2)}B`:tt>=1e6?`$${(tt/1e6).toFixed(2)}M`:tt>=1e3?`$${(tt/1e3).toFixed(2)}K`:`$${tt.toFixed(2)}`;if(!d)return t.jsx("div",{style:{height:"100%",backgroundColor:e.DARK_BG,color:e.WHITE,fontFamily:"Consolas, monospace",display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`2px solid ${e.ORANGE}`,padding:"40px",maxWidth:"600px",textAlign:"center"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"24px",fontWeight:"bold",marginBottom:"20px"},children:"POLYGON.IO API KEY REQUIRED"}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"14px",marginBottom:"20px",lineHeight:"1.6"},children:["Configure your Polygon.io API key to access institutional-grade financial data.",t.jsx("br",{}),t.jsx("br",{}),t.jsx("strong",{style:{color:e.CYAN},children:"Steps to configure:"}),t.jsxs("ol",{style:{textAlign:"left",marginTop:"10px",paddingLeft:"40px"},children:[t.jsxs("li",{children:["Get your free API key at: ",t.jsx("span",{style:{color:e.CYAN},children:"polygon.io"})]}),t.jsx("li",{children:"Go to Settings  Credentials section"}),t.jsxs("li",{children:["Add new API key with service name: ",t.jsx("span",{style:{color:e.CYAN},children:"Polygon.io"})]}),t.jsx("li",{children:"Paste your API key and save"}),t.jsx("li",{children:"Return to this tab and refresh"})]})]}),t.jsx("button",{onClick:U,style:{backgroundColor:e.ORANGE,border:"none",color:e.DARK_BG,padding:"12px 30px",fontSize:"14px",cursor:"pointer",fontWeight:"bold"},children:"GO TO SETTINGS"})]})});const xt=y?.day?.close||y?.prev_day?.close||0,bt=y?.prev_day?.close||0;let Lt=y?.todays_change||0,yt=y?.todays_change_perc||0;Lt===0&&xt>0&&bt>0&&(Lt=xt-bt,yt=Lt/bt*100);const Pt=({title:tt,color:it=e.ORANGE})=>t.jsx("div",{style:{backgroundColor:e.PANEL_HEADER_BG,borderBottom:`1px solid ${it}`,padding:"6px 10px",color:it,fontSize:"12px",fontWeight:"bold",letterSpacing:"0.5px"},children:tt}),Et=({label:tt,value:it,valueColor:vt=e.WHITE,small:rr=!1})=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:rr?"3px":"6px",fontSize:rr?"11px":"12px"},children:[t.jsxs("span",{style:{color:e.GRAY},children:[tt,":"]}),t.jsx("span",{style:{color:vt,fontWeight:"bold"},children:it})]});return t.jsxs("div",{style:{height:"100%",backgroundColor:e.DARK_BG,color:e.WHITE,fontFamily:"Consolas, monospace",display:"flex",flexDirection:"column",fontSize:"12px",overflow:"auto",overflowX:"hidden"},className:"custom-scrollbar",children:[t.jsx("div",{style:{backgroundColor:e.PANEL_BG,borderBottom:`1px solid ${e.BORDER}`,padding:"8px 12px",display:"flex",flexDirection:"column",gap:"8px",flexShrink:0},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap"},children:[t.jsx("span",{style:{color:e.ORANGE,fontWeight:"bold",fontSize:"13px"},children:"POLYGON.IO"}),t.jsx("input",{type:"text",value:i,onChange:tt=>o(tt.target.value),onKeyPress:tt=>tt.key==="Enter"&&Le(),placeholder:"Symbol...",style:{backgroundColor:e.DARK_BG,border:`1px solid ${e.BORDER}`,color:e.WHITE,padding:"4px 10px",fontSize:"12px",width:"120px",fontFamily:"Consolas, monospace"}}),t.jsx("button",{onClick:Le,style:{backgroundColor:e.ORANGE,border:"none",color:e.DARK_BG,padding:"4px 14px",fontSize:"11px",cursor:"pointer",fontWeight:"bold"},children:"GO"}),j.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("span",{style:{color:e.GRAY,fontSize:"10px",fontWeight:"bold",marginLeft:"8px"},children:"RELATED:"}),j.slice(0,8).map((tt,it)=>t.jsx("div",{onClick:()=>ze(tt.ticker),style:{backgroundColor:e.PANEL_HEADER_BG,border:`1px solid ${e.BORDER}`,padding:"3px 8px",cursor:"pointer",fontSize:"10px",color:e.CYAN,fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:vt=>{vt.currentTarget.style.backgroundColor=e.CYAN,vt.currentTarget.style.color=e.DARK_BG},onMouseLeave:vt=>{vt.currentTarget.style.backgroundColor=e.PANEL_HEADER_BG,vt.currentTarget.style.color=e.CYAN},children:tt.ticker},it))]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[t.jsx("span",{style:{color:e.CYAN,fontSize:"18px",fontWeight:"bold"},children:r}),t.jsx("span",{style:{color:e.GRAY,fontSize:"12px",maxWidth:"250px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:b?.name||""}),t.jsxs("span",{style:{color:e.WHITE,fontSize:"16px",fontWeight:"bold"},children:["$",Ge(xt)]}),t.jsxs("span",{style:{color:Lt>=0?e.GREEN:e.RED,fontSize:"13px",fontWeight:"bold"},children:[Lt>=0?"":""," ",Math.abs(Lt).toFixed(2)," (",yt.toFixed(2),"%)"]}),a&&t.jsx("span",{style:{color:e.YELLOW,fontSize:"10px"},children:" LOAD"}),!a&&!f&&t.jsx("span",{style:{color:e.GREEN,fontSize:"10px"},children:" LIVE"}),t.jsx("button",{onClick:()=>xe(),style:{backgroundColor:e.BLUE,border:"none",color:e.WHITE,padding:"4px 12px",fontSize:"10px",cursor:"pointer",fontWeight:"bold"},children:"REFRESH"})]})]})}),f&&t.jsxs("div",{style:{backgroundColor:"#1a0000",borderBottom:`1px solid ${e.RED}`,padding:"6px 12px",color:e.RED,fontSize:"11px",flexShrink:0},children:[t.jsx("strong",{children:"ERROR:"})," ",f]}),t.jsxs("div",{style:{padding:"6px",flexShrink:0,maxWidth:"100%",boxSizing:"border-box"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0, 1fr))",gap:"8px",marginBottom:"8px"},children:[t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`},children:[t.jsx(Pt,{title:"QUOTE",color:e.CYAN}),t.jsxs("div",{style:{padding:"10px",fontSize:"11px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"6px",marginBottom:"6px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:e.GRAY,fontSize:"10px"},children:"OPEN:"})," ",t.jsxs("span",{style:{color:e.CYAN},children:["$",Ge(y?.day?.open)]})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:e.GRAY,fontSize:"10px"},children:"HIGH:"})," ",t.jsxs("span",{style:{color:e.GREEN},children:["$",Ge(y?.day?.high)]})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:e.GRAY,fontSize:"10px"},children:"LOW:"})," ",t.jsxs("span",{style:{color:e.RED},children:["$",Ge(y?.day?.low)]})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:e.GRAY,fontSize:"10px"},children:"VOL:"})," ",t.jsx("span",{style:{color:e.YELLOW},children:Ge(y?.day?.volume,0)})]})]}),t.jsx(Et,{label:"VWAP",value:`$${Ge(y?.day?.vwap)}`,valueColor:e.CYAN,small:!0}),t.jsxs("div",{style:{borderTop:`1px solid ${e.BORDER}`,marginTop:"6px",paddingTop:"6px"},children:[t.jsx("div",{style:{color:e.GRAY,fontSize:"10px",marginBottom:"3px"},children:"LAST TRADE"}),t.jsx(Et,{label:"Price",value:`$${Ge(G?.price)}`,valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Size",value:Ge(G?.size,0),valueColor:e.WHITE,small:!0})]})]})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`},children:[t.jsx(Pt,{title:"BID/ASK",color:e.GREEN}),t.jsxs("div",{style:{padding:"10px",fontSize:"11px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:e.GRAY,fontSize:"10px"},children:"BID"}),t.jsxs("div",{style:{color:e.GREEN,fontSize:"14px",fontWeight:"bold"},children:["$",Ge(F?.bid_price)]}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"10px"},children:["x",Ge(F?.bid_size,0)]})]}),t.jsxs("div",{style:{textAlign:"right"},children:[t.jsx("div",{style:{color:e.GRAY,fontSize:"10px"},children:"ASK"}),t.jsxs("div",{style:{color:e.RED,fontSize:"14px",fontWeight:"bold"},children:["$",Ge(F?.ask_price)]}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"10px"},children:["x",Ge(F?.ask_size,0)]})]})]}),t.jsx(Et,{label:"Spread",value:`$${Ge((F?.ask_price||0)-(F?.bid_price||0),3)}`,valueColor:e.YELLOW,small:!0}),t.jsxs("div",{style:{borderTop:`1px solid ${e.BORDER}`,marginTop:"6px",paddingTop:"6px"},children:[t.jsx(Et,{label:"Mkt Cap",value:Ze(b?.market_cap),valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Exchange",value:b?.primary_exchange||"N/A",valueColor:e.WHITE,small:!0})]})]})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`},children:[t.jsx(Pt,{title:"MARKET STATUS",color:e.GREEN}),t.jsxs("div",{style:{padding:"10px",fontSize:"11px",textAlign:"center"},children:[t.jsx("div",{style:{color:A?.market==="open"?e.GREEN:e.RED,fontSize:"16px",fontWeight:"bold",marginBottom:"6px"},children:A?.market?.toUpperCase()||"N/A"}),t.jsx("div",{style:{color:e.CYAN,fontSize:"10px",marginBottom:"8px"},children:A?.serverTime||"N/A"}),t.jsx(Et,{label:"Exchanges",value:A?.exchanges?Object.keys(A.exchanges).length:"N/A",valueColor:e.BLUE,small:!0}),t.jsx(Et,{label:"Currencies",value:A?.currencies?Object.keys(A.currencies).length:"N/A",valueColor:e.YELLOW,small:!0})]})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`},children:[t.jsx(Pt,{title:"TECHNICALS",color:e.YELLOW}),t.jsxs("div",{style:{padding:"10px",fontSize:"11px"},children:[t.jsx(Et,{label:"SMA(20)",value:`$${Ge($?.statistics?.latest_value)}`,valueColor:e.CYAN,small:!0}),t.jsx(Et,{label:"EMA(20)",value:`$${Ge(D?.statistics?.latest_value)}`,valueColor:e.BLUE,small:!0}),t.jsx(Et,{label:"RSI(14)",value:Ge(Q?.statistics?.rsi_stats?.latest_value,1),valueColor:(Q?.statistics?.rsi_stats?.latest_value||0)>70?e.RED:(Q?.statistics?.rsi_stats?.latest_value||0)<30?e.GREEN:e.YELLOW,small:!0}),t.jsxs("div",{style:{borderTop:`1px solid ${e.BORDER}`,marginTop:"6px",paddingTop:"6px"},children:[t.jsx("div",{style:{color:e.GRAY,fontSize:"10px",marginBottom:"3px"},children:"MACD Signal"}),t.jsx("div",{style:{color:Z?.macd_values?.[0]?.crossover_analysis?.macd_above_signal?e.GREEN:e.RED,fontSize:"12px",fontWeight:"bold",textAlign:"center"},children:Z?.macd_values?.[0]?.crossover_analysis?.macd_above_signal?" BULLISH":" BEARISH"})]})]})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"8px",marginBottom:"8px"},children:[t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`},children:[t.jsx(Pt,{title:`LATEST NEWS (${T.length})`,color:e.ORANGE}),t.jsx("div",{style:{padding:"10px",maxHeight:"240px",overflowY:"auto"},children:T.length>0?T.slice(0,4).map(tt=>t.jsxs("div",{style:{marginBottom:"10px",paddingBottom:"10px",borderBottom:`1px solid ${e.BORDER}`,fontSize:"11px",display:"flex",gap:"10px"},children:[tt.image_url&&t.jsx("div",{style:{flexShrink:0,width:"80px",height:"60px",overflow:"hidden",borderRadius:"4px",border:`1px solid ${e.BORDER}`,backgroundColor:e.DARK_BG},children:t.jsx("img",{src:tt.image_url,alt:tt.title,style:{width:"100%",height:"100%",objectFit:"cover"},onError:it=>{it.target.style.display="none"}})}),t.jsxs("div",{style:{flex:1,minWidth:0},children:[t.jsx("div",{style:{color:e.ORANGE,fontWeight:"bold",marginBottom:"3px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:tt.title}),t.jsxs("div",{style:{color:e.GRAY,fontSize:"10px",marginBottom:"4px"},children:[tt.publisher?.name," | ",new Date(tt.published_utc).toLocaleDateString()]}),tt.description&&t.jsx("div",{style:{color:e.WHITE,fontSize:"9px",marginBottom:"4px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.3"},children:tt.description}),t.jsx("a",{href:tt.article_url,target:"_blank",rel:"noopener noreferrer",style:{color:e.CYAN,fontSize:"10px",textDecoration:"underline"},children:"READ MORE "})]})]},tt.id)):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"15px",fontSize:"11px"},children:"No news available"})})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`},children:[t.jsx(Pt,{title:"TRADES & QUOTES",color:e.CYAN}),t.jsxs("div",{style:{padding:"10px",fontSize:"11px"},children:[t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:"LAST TRADE"}),t.jsx(Et,{label:"Price",value:`$${Ge(G?.price)}`,valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Size",value:Ge(G?.size,0),small:!0}),t.jsx(Et,{label:"Time",value:G?.participant_timestamp?new Date(G.participant_timestamp/1e6).toLocaleTimeString():"N/A",valueColor:e.GRAY,small:!0})]}),t.jsxs("div",{style:{borderTop:`1px solid ${e.BORDER}`,paddingTop:"8px"},children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"11px",fontWeight:"bold",marginBottom:"4px"},children:"LAST QUOTE"}),t.jsx(Et,{label:"Bid",value:`$${Ge(F?.bid_price)}`,valueColor:e.RED,small:!0}),t.jsx(Et,{label:"Ask",value:`$${Ge(F?.ask_price)}`,valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Spread",value:`$${Ge((F?.ask_price||0)-(F?.bid_price||0))}`,valueColor:e.YELLOW,small:!0})]})]})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`,display:"flex",flexDirection:"column",height:"100%"},children:[t.jsx(Pt,{title:"30-DAY CHART",color:e.BLUE}),t.jsx("div",{style:{flex:1,display:"flex",alignItems:"stretch",justifyContent:"stretch",padding:"4px"},children:t.jsx(LX,{data:ke,width:300,height:230,bullishColor:e.GREEN,bearishColor:e.RED,backgroundColor:e.DARK_BG,gridColor:e.BORDER,textColor:e.GRAY,showGrid:!0,showVolume:!0,showLabels:!0})})]})]}),t.jsxs("div",{style:{backgroundColor:e.PANEL_BG,border:`1px solid ${e.BORDER}`},children:[t.jsx("div",{style:{display:"flex",borderBottom:`1px solid ${e.BORDER}`,backgroundColor:e.PANEL_HEADER_BG},children:[{id:"financials",label:"FINANCIALS"},{id:"actions",label:"ACTIONS"},{id:"short",label:"SHORT"},{id:"market",label:"MARKET"},{id:"reference",label:"REFERENCE"}].map(tt=>t.jsx("button",{onClick:()=>m(tt.id),style:{padding:"6px 15px",backgroundColor:x===tt.id?e.PANEL_BG:"transparent",border:"none",borderBottom:x===tt.id?`2px solid ${e.ORANGE}`:"none",color:x===tt.id?e.ORANGE:e.GRAY,fontSize:"9px",fontWeight:"bold",cursor:"pointer",fontFamily:"Consolas, monospace"},children:tt.label},tt.id))}),t.jsxs("div",{style:{padding:"8px"},children:[x==="financials"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:e.GREEN,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:"INCOME STATEMENT"}),Y?.results&&Y.results.length>0?t.jsx("div",{style:{fontSize:"8px"},children:Y.results.slice(0,1).map((tt,it)=>t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.ORANGE,fontWeight:"bold",marginBottom:"4px"},children:["FY ",tt.fiscal_year]}),t.jsx(Et,{label:"Revenue",value:Ze(tt.revenue),valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Gross Profit",value:Ze(tt.gross_profit),valueColor:e.CYAN,small:!0}),t.jsx(Et,{label:"Operating Inc",value:Ze(tt.operating_income),valueColor:e.BLUE,small:!0}),t.jsx(Et,{label:"Net Income",value:Ze(tt.consolidated_net_income_loss),valueColor:tt.consolidated_net_income_loss>=0?e.GREEN:e.RED,small:!0}),t.jsx(Et,{label:"EBITDA",value:Ze(tt.ebitda),valueColor:e.YELLOW,small:!0}),t.jsx(Et,{label:"EPS",value:`$${Ge(tt.diluted_earnings_per_share)}`,valueColor:e.WHITE,small:!0})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No data"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:e.BLUE,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:"BALANCE SHEET"}),me?.results&&me.results.length>0?t.jsx("div",{style:{fontSize:"8px"},children:me.results.slice(0,1).map((tt,it)=>t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.ORANGE,fontWeight:"bold",marginBottom:"4px"},children:["FY ",tt.fiscal_year]}),t.jsx(Et,{label:"Total Assets",value:Ze(tt.total_assets),valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Current Assets",value:Ze(tt.total_current_assets),valueColor:e.CYAN,small:!0}),t.jsx(Et,{label:"Total Liab",value:Ze(tt.total_liabilities),valueColor:e.RED,small:!0}),t.jsx(Et,{label:"Total Equity",value:Ze(tt.total_equity),valueColor:e.YELLOW,small:!0}),t.jsx(Et,{label:"Cash",value:Ze(tt.cash_and_equivalents),valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Current Ratio",value:Ge(tt.financial_ratios?.liquidity_ratios?.current_ratio,2),valueColor:tt.financial_ratios?.liquidity_ratios?.current_ratio>=1?e.GREEN:e.RED,small:!0})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No data"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:e.YELLOW,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:"CASH FLOW & RATIOS"}),t.jsxs("div",{style:{fontSize:"8px"},children:[ce?.cash_flow_data?.results&&ce.cash_flow_data.results.length>0&&t.jsx("div",{style:{marginBottom:"6px"},children:ce.cash_flow_data.results.slice(0,1).map((tt,it)=>t.jsxs("div",{children:[t.jsx(Et,{label:"Operating CF",value:Ze(tt.net_cash_from_operating_activities),valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"Investing CF",value:Ze(tt.net_cash_from_investing_activities),valueColor:e.BLUE,small:!0}),t.jsx(Et,{label:"Financing CF",value:Ze(tt.net_cash_from_financing_activities),valueColor:e.ORANGE,small:!0}),t.jsx(Et,{label:"Free CF",value:Ze(tt.cash_flow_ratios?.profitability_metrics?.free_cash_flow),valueColor:e.GREEN,small:!0})]},it))}),be?.ratios_data?.results&&be.ratios_data.results.length>0&&t.jsx("div",{children:be.ratios_data.results.slice(0,1).map((tt,it)=>t.jsxs("div",{children:[t.jsx(Et,{label:"P/E Ratio",value:Ge(tt.price_to_earnings_ratio,2),valueColor:e.WHITE,small:!0}),t.jsx(Et,{label:"ROE",value:`${Ge(tt.return_on_equity*100,2)}%`,valueColor:e.GREEN,small:!0}),t.jsx(Et,{label:"ROA",value:`${Ge(tt.return_on_assets*100,2)}%`,valueColor:e.GREEN,small:!0})]},it))})]})]})]}),x==="actions"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.GREEN,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:["DIVIDENDS (",M.length,")"]}),M.length>0?t.jsx("div",{style:{fontSize:"8px"},children:M.slice(0,8).map((tt,it)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"3px",paddingBottom:"3px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsx("span",{style:{color:e.CYAN},children:tt.ex_dividend_date}),t.jsxs("span",{style:{color:e.GREEN,fontWeight:"bold"},children:["$",Ge(tt.cash_amount,3)]})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No dividends"})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.YELLOW,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:["SPLITS (",I.length,")"]}),I.length>0?t.jsx("div",{style:{fontSize:"8px"},children:I.slice(0,8).map((tt,it)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"3px",paddingBottom:"3px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsx("span",{style:{color:e.CYAN},children:tt.execution_date}),t.jsxs("span",{style:{color:e.YELLOW,fontWeight:"bold"},children:[tt.split_from,":",tt.split_to]})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No splits"})]})]}),x==="short"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:e.RED,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:"SHORT INTEREST"}),J?.short_interest_data&&J.short_interest_data.length>0?t.jsx("div",{style:{fontSize:"8px"},children:J.short_interest_data.slice(0,5).map((tt,it)=>t.jsxs("div",{style:{marginBottom:"4px",paddingBottom:"4px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsx("div",{style:{color:e.CYAN,fontWeight:"bold",marginBottom:"2px"},children:tt.settlement_date}),t.jsx(Et,{label:"Interest",value:Ge(tt.short_interest),valueColor:e.WHITE,small:!0}),t.jsx(Et,{label:"% Float",value:`${Ge(tt.percent_of_float,2)}%`,valueColor:e.RED,small:!0})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No data"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:e.ORANGE,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:"SHORT VOLUME"}),Te?.short_volume_data&&Te.short_volume_data.length>0?t.jsx("div",{style:{fontSize:"8px"},children:Te.short_volume_data.slice(0,5).map((tt,it)=>t.jsxs("div",{style:{marginBottom:"4px",paddingBottom:"4px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsx("div",{style:{color:e.CYAN,fontWeight:"bold",marginBottom:"2px"},children:tt.date}),t.jsx(Et,{label:"Volume",value:Ge(tt.volume),valueColor:e.WHITE,small:!0}),t.jsx(Et,{label:"Short Vol",value:Ge(tt.short_volume),valueColor:e.ORANGE,small:!0})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No data"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:e.GREEN,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:"TRADES & QUOTES"}),t.jsxs("div",{style:{fontSize:"8px"},children:[Qe?.trades&&Qe.trades.length>0?t.jsx("div",{style:{marginBottom:"6px"},children:Qe.trades.slice(0,3).map((tt,it)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px",fontSize:"7px"},children:[t.jsx("span",{style:{color:e.GRAY},children:tt.time}),t.jsxs("span",{style:{color:e.GREEN},children:["$",Ge(tt.price,2)]}),t.jsx("span",{style:{color:e.WHITE},children:Ge(tt.size)})]},it))}):null,ue?.quotes&&ue.quotes.length>0?t.jsx("div",{children:ue.quotes.slice(0,3).map((tt,it)=>t.jsx("div",{style:{marginBottom:"2px",fontSize:"7px"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:e.GRAY},children:tt.time}),t.jsxs("span",{style:{color:e.GREEN},children:["B: $",Ge(tt.bid_price,2)]}),t.jsxs("span",{style:{color:e.RED},children:["A: $",Ge(tt.ask_price,2)]})]})},it))}):null]})]})]}),x==="market"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.ORANGE,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:["TICKER SEARCH (",le.length,")"]}),le.length>0?t.jsx("div",{style:{fontSize:"8px"},children:le.slice(0,8).map((tt,it)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px",paddingBottom:"2px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsx("span",{style:{color:e.CYAN,fontWeight:"bold"},children:tt.ticker}),t.jsx("span",{style:{color:e.WHITE,fontSize:"7px"},children:tt.name?.substring(0,20)||"N/A"}),t.jsx("span",{style:{color:e.YELLOW},children:tt.type})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No results"})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.BLUE,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:["MARKET HOLIDAYS (",ve.length,")"]}),ve.length>0?t.jsx("div",{style:{fontSize:"8px"},children:ve.slice(0,8).map((tt,it)=>t.jsxs("div",{style:{marginBottom:"3px",paddingBottom:"3px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:e.CYAN,fontWeight:"bold"},children:tt.date}),t.jsx("span",{style:{color:tt.status==="closed"?e.RED:e.YELLOW,fontSize:"7px"},children:tt.status?.toUpperCase()})]}),t.jsx("div",{style:{color:e.WHITE,fontSize:"7px"},children:tt.name})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No holidays"})]})]}),x==="reference"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.BLUE,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:["TICKER TYPES (",V.length,")"]}),V.length>0?t.jsx("div",{style:{fontSize:"8px"},children:V.slice(0,8).map((tt,it)=>t.jsxs("div",{style:{marginBottom:"3px",paddingBottom:"3px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsx("div",{style:{color:e.CYAN,fontWeight:"bold"},children:tt.code}),t.jsx("div",{style:{color:e.WHITE,fontSize:"7px"},children:tt.description?.substring(0,30)})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No types"})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.GREEN,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:["EXCHANGES (",Re.length,")"]}),Re.length>0?t.jsx("div",{style:{fontSize:"8px"},children:Re.slice(0,8).map((tt,it)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"2px",paddingBottom:"2px",borderBottom:`1px solid ${e.BORDER}`},children:[t.jsx("span",{style:{color:e.CYAN,fontWeight:"bold"},children:tt.mic}),t.jsx("span",{style:{color:e.WHITE,fontSize:"7px"},children:tt.name?.substring(0,20)})]},it))}):t.jsx("div",{style:{color:e.GRAY,textAlign:"center",padding:"10px",fontSize:"8px"},children:"No exchanges"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:e.YELLOW,fontSize:"9px",fontWeight:"bold",marginBottom:"6px",borderBottom:`1px solid ${e.BORDER}`,paddingBottom:"4px"},children:"EVENTS & CODES"}),t.jsxs("div",{style:{fontSize:"8px"},children:[je&&je.events&&je.events.length>0?t.jsxs("div",{style:{marginBottom:"6px"},children:[t.jsxs("div",{style:{color:e.CYAN,marginBottom:"3px",fontSize:"8px"},children:["Events: ",je.events.length]}),je.events.slice(0,3).map((tt,it)=>t.jsxs("div",{style:{color:e.WHITE,fontSize:"7px",marginBottom:"2px"},children:[tt.date," - ",tt.type]},it))]}):null,Se.length>0?t.jsxs("div",{children:[t.jsxs("div",{style:{color:e.CYAN,marginBottom:"3px",fontSize:"8px"},children:["Codes: ",Se.length]}),Se.slice(0,4).map((tt,it)=>t.jsxs("div",{style:{color:e.WHITE,fontSize:"7px",marginBottom:"2px"},children:[tt.id," - ",tt.type]},it))]}):null]})]})]})]})]})]}),t.jsxs("div",{style:{borderTop:`1px solid ${e.BORDER}`,backgroundColor:e.PANEL_BG,padding:"4px 10px",fontSize:"8px",color:e.GRAY,display:"flex",justifyContent:"space-between",flexShrink:0},children:[t.jsx("span",{children:"Polygon.io API | 31/31 Endpoints | Institutional Data"}),t.jsxs("span",{children:[r," | ",new Date().toLocaleString()]})]}),t.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: #0a0a0a;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: rgba(255, 165, 0, 0.3);
          border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 165, 0, 0.5);
        }
      `})]})};function a_(s,e=2){return s===0?"0.00":!s||isNaN(s)?"--":s<.01?s.toFixed(8):s<1?s.toFixed(6):s<100?s.toFixed(4):s.toFixed(e)}function Eo(s,e="USD",r=2){if(!s||isNaN(s))return"--";const n=a_(Math.abs(s),r);return e==="USD"?`$${n}`:`${n} ${e}`}function MX(s,e=2){if(!s||isNaN(s))return{text:"$0.00",color:"gray",sign:""};const r=s>=0?"+":"",n=s>=0?"green":"red";return{text:`${r}$${a_(Math.abs(s),e)}`,color:n,sign:r}}function BX(s){return s?new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}):"--"}function FX(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"--"}function l_(s){return s?`${FX(s)} ${BX(s)}`:"--"}function c_(s){return{open:{text:"OPEN",color:"blue"},closed:{text:"FILLED",color:"green"},canceled:{text:"CANCELED",color:"gray"},expired:{text:"EXPIRED",color:"orange"},rejected:{text:"REJECTED",color:"red"},pending:{text:"PENDING",color:"yellow"}}[s?.toLowerCase()]||{text:s?.toUpperCase()||"UNKNOWN",color:"gray"}}function $X(s){return s===1?"1x":`${s}x`}const zr={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GRAY:"#787878",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",BORDER:"#2A2A2A",HOVER:"#1F1F1F",YELLOW:"#FFD700"};function GX({symbol:s,currentPrice:e,orderType:r,side:n,onOrderChange:i,balance:o=0}){const[a,l]=S.useState(""),[d,p]=S.useState(""),[f,h]=S.useState(0);S.useEffect(()=>{(r==="market"||!d)&&p(e.toString())},[e,r]),S.useEffect(()=>{const y=parseFloat(a)||0,C=parseFloat(d)||e;h(y*C),i({symbol:s,type:r,side:n,quantity:y,price:r==="limit"?C:void 0})},[a,d,s,r,n,e,i]);const x=y=>{(/^\d*\.?\d*$/.test(y)||y==="")&&l(y)},m=y=>{(/^\d*\.?\d*$/.test(y)||y==="")&&p(y)},b=y=>{if(o===0||e===0)return;const C=parseFloat(d)||e,T=o*y/C;l(T.toFixed(4))},w=o>0&&e>0?o/e:0;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[r==="limit"&&t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:zr.GRAY,marginBottom:"4px",letterSpacing:"0.5px"},children:"PRICE"}),t.jsx("input",{type:"text",value:d,onChange:y=>m(y.target.value),placeholder:"0.00",style:{width:"100%",padding:"8px 10px",backgroundColor:zr.HEADER_BG,border:`1px solid ${zr.BORDER}`,color:zr.WHITE,fontSize:"12px",fontFamily:"inherit",outline:"none"},onFocus:y=>y.target.style.borderColor=zr.ORANGE,onBlur:y=>y.target.style.borderColor=zr.BORDER}),t.jsxs("div",{style:{fontSize:"8px",color:zr.GRAY,marginTop:"4px"},children:["Market: ",Eo(e)]})]}),r==="market"&&t.jsxs("div",{style:{padding:"8px",backgroundColor:`${zr.ORANGE}10`,border:`1px solid ${zr.ORANGE}40`,fontSize:"10px",color:zr.GRAY},children:["Market Price: ",t.jsx("span",{style:{color:zr.ORANGE,fontWeight:700},children:Eo(e)})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:zr.GRAY,marginBottom:"4px",letterSpacing:"0.5px"},children:"QUANTITY"}),t.jsx("input",{type:"text",value:a,onChange:y=>x(y.target.value),placeholder:"0.0000",style:{width:"100%",padding:"8px 10px",backgroundColor:zr.HEADER_BG,border:`1px solid ${zr.BORDER}`,color:zr.WHITE,fontSize:"12px",fontFamily:"inherit",outline:"none"},onFocus:y=>y.target.style.borderColor=zr.ORANGE,onBlur:y=>y.target.style.borderColor=zr.BORDER}),t.jsxs("div",{style:{fontSize:"8px",color:zr.GRAY,marginTop:"4px"},children:["Max: ",w.toFixed(4)," ",s.split("/")[0]]})]}),t.jsx("div",{style:{display:"flex",gap:"4px"},children:[.25,.5,.75,1].map(y=>t.jsxs("button",{onClick:()=>b(y),style:{flex:1,padding:"6px",backgroundColor:zr.PANEL_BG,border:`1px solid ${zr.BORDER}`,color:zr.GRAY,fontSize:"9px",fontWeight:700,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:C=>{C.currentTarget.style.backgroundColor=zr.HOVER,C.currentTarget.style.borderColor=zr.ORANGE,C.currentTarget.style.color=zr.ORANGE},onMouseLeave:C=>{C.currentTarget.style.backgroundColor=zr.PANEL_BG,C.currentTarget.style.borderColor=zr.BORDER,C.currentTarget.style.color=zr.GRAY},children:[y*100,"%"]},y))}),t.jsxs("div",{style:{padding:"10px",backgroundColor:zr.HEADER_BG,border:`1px solid ${zr.BORDER}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"9px",color:zr.GRAY,fontWeight:700},children:"TOTAL"}),t.jsx("span",{style:{fontSize:"13px",color:zr.YELLOW,fontWeight:700},children:Eo(f)})]}),n==="buy"&&f>o&&t.jsxs("div",{style:{padding:"8px",backgroundColor:`${zr.RED}10`,border:`1px solid ${zr.RED}40`,fontSize:"10px",color:zr.RED},children:[" Insufficient balance (Available: ",Eo(o),")"]})]})}const Ar={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",BORDER:"#2A2A2A",CYAN:"#00E5FF"};function UX({currentPrice:s,supportsStopLoss:e,supportsTakeProfit:r,supportsTrailing:n,onOrderChange:i}){const[o,a]=S.useState(!1),[l,d]=S.useState(""),[p,f]=S.useState(""),[h,x]=S.useState("");if(!(e||r||n))return null;const b=C=>{(/^\d*\.?\d*$/.test(C)||C==="")&&(d(C),i({stopLossPrice:C?parseFloat(C):void 0}))},w=C=>{(/^\d*\.?\d*$/.test(C)||C==="")&&(f(C),i({takeProfitPrice:C?parseFloat(C):void 0}))},y=C=>{(/^\d*\.?\d*$/.test(C)||C==="")&&(x(C),i({trailingPercent:C?parseFloat(C):void 0}))};return t.jsxs("div",{style:{marginTop:"8px"},children:[t.jsxs("button",{onClick:()=>a(!o),style:{width:"100%",padding:"8px",backgroundColor:o?`${Ar.CYAN}15`:Ar.PANEL_BG,border:`1px solid ${o?Ar.CYAN:Ar.BORDER}`,color:o?Ar.CYAN:Ar.GRAY,fontSize:"10px",fontWeight:700,cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.2s"},onMouseEnter:C=>{o||(C.currentTarget.style.borderColor=Ar.CYAN,C.currentTarget.style.color=Ar.CYAN)},onMouseLeave:C=>{o||(C.currentTarget.style.borderColor=Ar.BORDER,C.currentTarget.style.color=Ar.GRAY)},children:[t.jsx("span",{children:" ADVANCED OPTIONS"}),t.jsx("span",{children:o?"":""})]}),o&&t.jsxs("div",{style:{marginTop:"8px",padding:"12px",backgroundColor:Ar.HEADER_BG,border:`1px solid ${Ar.BORDER}`,display:"flex",flexDirection:"column",gap:"12px"},children:[e&&t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:Ar.GRAY,marginBottom:"4px",letterSpacing:"0.5px"},children:"STOP LOSS"}),t.jsx("input",{type:"text",value:l,onChange:C=>b(C.target.value),placeholder:"Optional",style:{width:"100%",padding:"8px 10px",backgroundColor:Ar.PANEL_BG,border:`1px solid ${Ar.BORDER}`,color:Ar.WHITE,fontSize:"11px",fontFamily:"inherit",outline:"none"},onFocus:C=>C.target.style.borderColor=Ar.RED,onBlur:C=>C.target.style.borderColor=Ar.BORDER}),l&&t.jsxs("div",{style:{fontSize:"8px",color:Ar.RED,marginTop:"4px"},children:[parseFloat(l)<s?"":""," ",Math.abs((parseFloat(l)-s)/s*100).toFixed(2),"% from current"]})]}),r&&t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:Ar.GRAY,marginBottom:"4px",letterSpacing:"0.5px"},children:"TAKE PROFIT"}),t.jsx("input",{type:"text",value:p,onChange:C=>w(C.target.value),placeholder:"Optional",style:{width:"100%",padding:"8px 10px",backgroundColor:Ar.PANEL_BG,border:`1px solid ${Ar.BORDER}`,color:Ar.WHITE,fontSize:"11px",fontFamily:"inherit",outline:"none"},onFocus:C=>C.target.style.borderColor=Ar.GREEN,onBlur:C=>C.target.style.borderColor=Ar.BORDER}),p&&t.jsxs("div",{style:{fontSize:"8px",color:Ar.GREEN,marginTop:"4px"},children:[parseFloat(p)>s?"":""," ",Math.abs((parseFloat(p)-s)/s*100).toFixed(2),"% from current"]})]}),n&&t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:Ar.GRAY,marginBottom:"4px",letterSpacing:"0.5px"},children:"TRAILING STOP (%)"}),t.jsx("input",{type:"text",value:h,onChange:C=>y(C.target.value),placeholder:"e.g. 2.5",style:{width:"100%",padding:"8px 10px",backgroundColor:Ar.PANEL_BG,border:`1px solid ${Ar.BORDER}`,color:Ar.WHITE,fontSize:"11px",fontFamily:"inherit",outline:"none"},onFocus:C=>C.target.style.borderColor=Ar.ORANGE,onBlur:C=>C.target.style.borderColor=Ar.BORDER}),h&&t.jsxs("div",{style:{fontSize:"8px",color:Ar.ORANGE,marginTop:"4px"},children:["Trailing ",h,"% (",Eo(s*parseFloat(h)/100),")"]})]}),t.jsx("div",{style:{padding:"8px",backgroundColor:`${Ar.CYAN}10`,border:`1px solid ${Ar.CYAN}40`,fontSize:"9px",color:Ar.GRAY,lineHeight:"1.4"},children:" Advanced orders help manage risk automatically. Stop-loss limits losses, take-profit locks in gains, and trailing stop follows price movements."})]})]})}function d_(){const{features:s,supports:e,activeBrokerMetadata:r}=Hn();return S.useMemo(()=>{if(!s||!e)return{supportsMarket:!0,supportsLimit:!0,supportsStop:!1,supportsStopLimit:!1,supportsTrailingStop:!1,supportsIceberg:!1,supportsStopLoss:!1,supportsTakeProfit:!1,supportsPostOnly:!1,supportsReduceOnly:!1,supportsTimeInForce:!1,supportsMargin:!1,supportsLeverage:!1,maxLeverage:void 0,supportsOrderEdit:!1,supportsBatchOrders:!1,supportsCancelAll:!1,supportsDeadManSwitch:!1,supportedOrderTypes:["market","limit"],supportedTimeInForce:["GTC"]};const n=["market","limit"],i=r?.tradingFeatures?.stopOrders??!1,o=r?.tradingFeatures?.stopLimitOrders??!1,a=r?.tradingFeatures?.trailingStopOrders??!1;i&&n.push("stop"),o&&n.push("stop_limit"),a&&n.push("trailing_stop");const l=r?.advancedFeatures?.leverage??!1,d=r?.advancedFeatures?.maxLeverage,p=r?.features?.margin??!1;return{supportsMarket:!0,supportsLimit:!0,supportsStop:i,supportsStopLimit:o,supportsTrailingStop:a,supportsIceberg:r?.tradingFeatures?.icebergOrders??!1,supportsStopLoss:i||o,supportsTakeProfit:i||o,supportsPostOnly:!0,supportsReduceOnly:p,supportsTimeInForce:!0,supportsMargin:p,supportsLeverage:l,maxLeverage:d,supportsOrderEdit:e?.canEditOrder?.()??!1,supportsBatchOrders:e?.canBatchOrder?.()??!1,supportsCancelAll:e?.canCancelAll?.()??!1,supportsDeadManSwitch:r?.tradingFeatures?.editOrders??!1,supportedOrderTypes:n,supportedTimeInForce:["GTC","IOC","FOK"]}},[s,e,r])}function WX(){const{activeAdapter:s,tradingMode:e,paperAdapter:r}=Hn(),[n,i]=S.useState(!1),[o,a]=S.useState(!1),[l,d]=S.useState(!1),[p,f]=S.useState(null),h=S.useCallback(async b=>{if(!s||!s.isConnected())throw new Error("Exchange not connected");i(!0),f(null);try{const w={};b.stopPrice&&(w.stopPrice=b.stopPrice),b.takeProfitPrice&&(w.takeProfitPrice=b.takeProfitPrice),b.stopLossPrice&&(w.stopLossPrice=b.stopLossPrice),b.trailingPercent&&(w.trailingPercent=b.trailingPercent),b.trailingAmount&&(w.trailingAmount=b.trailingAmount),b.leverage&&(w.leverage=b.leverage),b.marginMode&&(w.marginMode=b.marginMode),b.reduceOnly&&(w.reduceOnly=b.reduceOnly),b.postOnly&&(w.postOnly=b.postOnly),b.timeInForce&&(w.timeInForce=b.timeInForce),b.icebergQty&&(w.icebergQty=b.icebergQty),b.clientOrderId&&(w.clientOrderId=b.clientOrderId);const y=await s.createOrder(b.symbol,b.type,b.side,b.quantity,b.price,w);return console.log("[useOrderExecution] Order placed:",y),y}catch(w){const y=w;throw console.error("[useOrderExecution] Order failed:",y),f(y),y}finally{i(!1)}},[s]),x=S.useCallback(async(b,w)=>{if(!s||!s.isConnected())throw new Error("Exchange not connected");a(!0),f(null);try{await s.cancelOrder(b,w),console.log("[useOrderExecution] Order canceled:",b)}catch(y){const C=y;throw console.error("[useOrderExecution] Cancel failed:",C),f(C),C}finally{a(!1)}},[s]),m=S.useCallback(async(b,w,y)=>{if(!s||!s.isConnected())throw new Error("Exchange not connected");if(typeof s.editOrder!="function")throw new Error("This exchange does not support order editing");d(!0),f(null);try{const C=await s.editOrder(b,w,y.type,y.side,y.quantity,y.price,{stopPrice:y.stopPrice,takeProfitPrice:y.takeProfitPrice,stopLossPrice:y.stopLossPrice});return console.log("[useOrderExecution] Order edited:",C),C}catch(C){const T=C;throw console.error("[useOrderExecution] Edit failed:",T),f(T),T}finally{d(!1)}},[s]);return{placeOrder:h,cancelOrder:x,editOrder:m,isPlacing:n,isCanceling:o,isEditing:l,error:p}}const Zn={ORANGE:"#FF8800",WHITE:"#FFFFFF",GREEN:"#00D66F",GRAY:"#787878",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",BORDER:"#2A2A2A",CYAN:"#00E5FF"};function qX(){const{activeBroker:s,activeAdapter:e}=Hn(),[r,n]=S.useState(""),[i,o]=S.useState(""),[a,l]=S.useState(null),[d,p]=S.useState(!1);if(s!=="hyperliquid")return null;const f=async()=>{if(!(!r||!e)){p(!0);try{e.setVaultAddress(r);const x=await e.fetchVaultBalance(r);l(x),alert(` Vault connected: ${r.slice(0,8)}...`)}catch(x){alert(` Vault connection failed: ${x.message}`)}finally{p(!1)}}},h=()=>{!i||!e||(e.setSubAccountAddress(i),alert(` Subaccount set: ${i.slice(0,8)}...`))};return t.jsxs("div",{style:{padding:"12px",backgroundColor:Zn.PANEL_BG,border:`1px solid ${Zn.BORDER}`,marginTop:"12px"},children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:700,color:Zn.ORANGE,marginBottom:"12px",letterSpacing:"0.5px"},children:" HYPERLIQUID VAULT & SUBACCOUNTS"}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:Zn.GRAY,marginBottom:"4px"},children:"VAULT ADDRESS"}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("input",{type:"text",value:r,onChange:x=>n(x.target.value),placeholder:"0x...",style:{flex:1,padding:"6px 8px",backgroundColor:Zn.HEADER_BG,border:`1px solid ${Zn.BORDER}`,color:Zn.WHITE,fontSize:"10px",fontFamily:"inherit"}}),t.jsx("button",{onClick:f,disabled:d||!r,style:{padding:"6px 12px",backgroundColor:Zn.CYAN,border:"none",color:Zn.PANEL_BG,fontSize:"9px",fontWeight:700,cursor:!r||d?"not-allowed":"pointer",opacity:!r||d?.5:1},children:d?"...":"CONNECT"})]})]}),t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:Zn.GRAY,marginBottom:"4px"},children:"SUBACCOUNT ADDRESS"}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("input",{type:"text",value:i,onChange:x=>o(x.target.value),placeholder:"0x...",style:{flex:1,padding:"6px 8px",backgroundColor:Zn.HEADER_BG,border:`1px solid ${Zn.BORDER}`,color:Zn.WHITE,fontSize:"10px",fontFamily:"inherit"}}),t.jsx("button",{onClick:h,disabled:!i,style:{padding:"6px 12px",backgroundColor:Zn.GREEN,border:"none",color:Zn.PANEL_BG,fontSize:"9px",fontWeight:700,cursor:i?"pointer":"not-allowed",opacity:i?1:.5},children:"SET"})]})]}),a&&t.jsxs("div",{style:{padding:"8px",backgroundColor:`${Zn.CYAN}15`,border:`1px solid ${Zn.CYAN}40`,fontSize:"9px",color:Zn.CYAN},children:[" Vault Balance: $",a.total?.USD?.toFixed(2)||"0.00"]}),t.jsx("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:`${Zn.ORANGE}10`,border:`1px solid ${Zn.ORANGE}40`,fontSize:"8px",color:Zn.GRAY,lineHeight:"1.4"},children:" HyperLiquid vaults allow you to trade from a vault address. Subaccounts enable multi-strategy trading."})]})}const yn={ORANGE:"#FF8800",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",PANEL_BG:"#0F0F0F",BORDER:"#2A2A2A"};function HX({symbol:s,currentLeverage:e=1,onLeverageChange:r}){const{activeBroker:n,activeAdapter:i}=Hn(),[o,a]=S.useState(e),[l,d]=S.useState("cross"),[p,f]=S.useState(!1);if(n!=="hyperliquid")return null;const h=async b=>{if(i){a(b),f(!0);try{await i.setLeverage(s,b),r&&r(b)}catch(w){console.error("Failed to set leverage:",w)}finally{f(!1)}}},x=async b=>{if(i){d(b),f(!0);try{await i.setMarginMode(s,b)}catch(w){console.error("Failed to set margin mode:",w)}finally{f(!1)}}},m=[1,2,5,10,20,50];return t.jsxs("div",{style:{marginTop:"12px"},children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"6px"},children:[t.jsx("label",{style:{fontSize:"9px",fontWeight:700,color:yn.GRAY,letterSpacing:"0.5px"},children:"LEVERAGE"}),t.jsxs("span",{style:{fontSize:"12px",fontWeight:700,color:o>10?yn.RED:yn.ORANGE},children:[o,"x"]})]}),t.jsx("input",{type:"range",min:"1",max:"50",value:o,onChange:b=>h(parseInt(b.target.value)),disabled:p,style:{width:"100%",height:"4px",backgroundColor:yn.BORDER,outline:"none",opacity:p?.5:1}}),t.jsx("div",{style:{display:"flex",gap:"4px",marginTop:"6px"},children:m.map(b=>t.jsxs("button",{onClick:()=>h(b),disabled:p,style:{flex:1,padding:"4px",backgroundColor:o===b?yn.ORANGE:yn.PANEL_BG,border:`1px solid ${o===b?yn.ORANGE:yn.BORDER}`,color:o===b?yn.PANEL_BG:yn.GRAY,fontSize:"8px",fontWeight:700,cursor:p?"not-allowed":"pointer",opacity:p?.5:1},children:[b,"x"]},b))})]}),t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:yn.GRAY,marginBottom:"6px",letterSpacing:"0.5px"},children:"MARGIN MODE"}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{onClick:()=>x("cross"),disabled:p,style:{flex:1,padding:"6px",backgroundColor:l==="cross"?yn.GREEN:yn.PANEL_BG,border:`1px solid ${l==="cross"?yn.GREEN:yn.BORDER}`,color:l==="cross"?yn.PANEL_BG:yn.GRAY,fontSize:"9px",fontWeight:700,cursor:p?"not-allowed":"pointer",opacity:p?.5:1},children:"CROSS"}),t.jsx("button",{onClick:()=>x("isolated"),disabled:p,style:{flex:1,padding:"6px",backgroundColor:l==="isolated"?yn.ORANGE:yn.PANEL_BG,border:`1px solid ${l==="isolated"?yn.ORANGE:yn.BORDER}`,color:l==="isolated"?yn.PANEL_BG:yn.GRAY,fontSize:"9px",fontWeight:700,cursor:p?"not-allowed":"pointer",opacity:p?.5:1},children:"ISOLATED"})]})]}),o>20&&t.jsxs("div",{style:{marginTop:"8px",padding:"6px 8px",backgroundColor:`${yn.RED}15`,border:`1px solid ${yn.RED}40`,fontSize:"8px",color:yn.RED},children:[" High leverage (",o,"x) increases liquidation risk"]})]})}function YX(s,e,r,n){const i=[];if(s.symbol||i.push("Symbol is required"),(!s.quantity||s.quantity<=0)&&i.push("Quantity must be greater than 0"),e.supportedOrderTypes.includes(s.type)||i.push(`Order type "${s.type}" is not supported by this exchange`),s.type==="limit"&&(!s.price||s.price<=0)&&i.push("Limit orders require a valid price"),(s.type==="stop"||s.type==="stop_limit")&&!s.stopPrice&&i.push("Stop orders require a stop price"),s.type==="stop_limit"&&!s.price&&i.push("Stop-limit orders require both stop price and limit price"),s.type==="trailing_stop"&&(e.supportsTrailingStop||i.push("This exchange does not support trailing stop orders"),!s.trailingPercent&&!s.trailingAmount&&i.push("Trailing stop orders require trailing percent or trailing amount")),s.stopLossPrice&&!e.supportsStopLoss&&i.push("This exchange does not support stop loss orders"),s.takeProfitPrice&&!e.supportsTakeProfit&&i.push("This exchange does not support take profit orders"),s.leverage&&(e.supportsLeverage?e.maxLeverage&&s.leverage>e.maxLeverage&&i.push(`Maximum leverage for this exchange is ${e.maxLeverage}x`):i.push("This exchange does not support leverage")),s.icebergQty&&!e.supportsIceberg&&i.push("This exchange does not support iceberg orders"),s.icebergQty&&s.icebergQty>=s.quantity&&i.push("Iceberg visible quantity must be less than total quantity"),s.postOnly&&s.type==="market"&&i.push("Market orders cannot be post-only"),s.reduceOnly&&!e.supportsReduceOnly&&i.push("This exchange does not support reduce-only orders"),r!==void 0&&n){const o=KX(s,n);s.side==="buy"&&o>r&&i.push(`Insufficient balance. Required: $${o.toFixed(2)}, Available: $${r.toFixed(2)}`)}return{valid:i.length===0,errors:i}}function KX(s,e){const r=s.price||e,n=s.quantity;return s.leverage&&s.leverage>1?r*n/s.leverage:r*n}function VX(s){return s.length===0?"":s.length===1?s[0]:s.map((e,r)=>`${r+1}. ${e}`).join(`
`)}const hr={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",BORDER:"#2A2A2A",HOVER:"#1F1F1F"};function XX({symbol:s,currentPrice:e,balance:r,onOrderPlaced:n}){const i=d_(),{placeOrder:o,isPlacing:a,error:l}=WX(),{activeBroker:d}=Hn(),[p,f]=S.useState("limit"),[h,x]=S.useState("buy"),[m,b]=S.useState({}),[w,y]=S.useState(""),C=S.useCallback(k=>{b(A=>({...A,...k})),y("")},[]),T=S.useMemo(()=>({symbol:s,type:p,side:h,quantity:m.quantity||0,price:m.price,stopLossPrice:m.stopLossPrice,takeProfitPrice:m.takeProfitPrice,trailingPercent:m.trailingPercent}),[s,p,h,m]),E=async()=>{const k=YX(T,i,r,e);if(!k.valid){y(VX(k.errors));return}try{await o(T),b({}),y(""),n&&n(),alert(` Order placed: ${h.toUpperCase()} ${m.quantity} ${s.split("/")[0]}`)}catch(A){y(A.message)}},j=m.quantity&&m.quantity>0&&(p!=="limit"||m.price&&m.price>0)&&!a;return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:700,color:hr.GRAY,marginBottom:"6px",letterSpacing:"0.5px"},children:"ORDER TYPE"}),t.jsx("div",{style:{display:"flex",gap:"4px"},children:i.supportedOrderTypes.map(k=>t.jsx("button",{onClick:()=>f(k),style:{flex:1,padding:"8px 6px",backgroundColor:p===k?hr.ORANGE:hr.PANEL_BG,border:`1px solid ${p===k?hr.ORANGE:hr.BORDER}`,color:p===k?hr.DARK_BG:hr.GRAY,fontSize:"9px",fontWeight:700,cursor:"pointer",textTransform:"uppercase",transition:"all 0.2s"},onMouseEnter:A=>{p!==k&&(A.currentTarget.style.backgroundColor=hr.HOVER,A.currentTarget.style.borderColor=hr.ORANGE,A.currentTarget.style.color=hr.ORANGE)},onMouseLeave:A=>{p!==k&&(A.currentTarget.style.backgroundColor=hr.PANEL_BG,A.currentTarget.style.borderColor=hr.BORDER,A.currentTarget.style.color=hr.GRAY)},children:k},k))})]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[t.jsx("button",{onClick:()=>x("buy"),style:{flex:1,padding:"10px",backgroundColor:h==="buy"?hr.GREEN:hr.PANEL_BG,border:`2px solid ${h==="buy"?hr.GREEN:hr.BORDER}`,color:h==="buy"?hr.DARK_BG:hr.GREEN,fontSize:"11px",fontWeight:700,cursor:"pointer",transition:"all 0.2s"},children:"BUY"}),t.jsx("button",{onClick:()=>x("sell"),style:{flex:1,padding:"10px",backgroundColor:h==="sell"?hr.RED:hr.PANEL_BG,border:`2px solid ${h==="sell"?hr.RED:hr.BORDER}`,color:h==="sell"?hr.WHITE:hr.RED,fontSize:"11px",fontWeight:700,cursor:"pointer",transition:"all 0.2s"},children:"SELL"})]}),t.jsx(GX,{symbol:s,currentPrice:e,orderType:p,side:h,onOrderChange:C,balance:r}),t.jsx(UX,{currentPrice:e,supportsStopLoss:i.supportsStopLoss,supportsTakeProfit:i.supportsTakeProfit,supportsTrailing:i.supportsTrailingStop,onOrderChange:C}),d==="hyperliquid"&&i.supportsLeverage&&t.jsx(HX,{symbol:s,onLeverageChange:k=>C({leverage:k})}),w&&t.jsxs("div",{style:{padding:"10px",backgroundColor:`${hr.RED}15`,border:`1px solid ${hr.RED}`,color:hr.RED,fontSize:"10px",whiteSpace:"pre-line"},children:[" ",w]}),l&&t.jsxs("div",{style:{padding:"10px",backgroundColor:`${hr.RED}15`,border:`1px solid ${hr.RED}`,color:hr.RED,fontSize:"10px"},children:[" ",l.message]}),t.jsx("button",{onClick:E,disabled:!j,style:{width:"100%",padding:"12px",backgroundColor:j?h==="buy"?hr.GREEN:hr.RED:hr.PANEL_BG,border:`2px solid ${j?h==="buy"?hr.GREEN:hr.RED:hr.BORDER}`,color:j?hr.WHITE:hr.GRAY,fontSize:"12px",fontWeight:700,cursor:j?"pointer":"not-allowed",textTransform:"uppercase",letterSpacing:"1px",opacity:a?.6:1,transition:"all 0.2s"},children:a?" PLACING ORDER...":`${h.toUpperCase()} ${s.split("/")[0]}`})]})}function JX(){const{activeBroker:s,activeAdapter:e}=Hn(),[r,n]=S.useState([]),[i,o]=S.useState(""),[a,l]=S.useState([]),[d,p]=S.useState(""),[f,h]=S.useState(""),[x,m]=S.useState(!0),[b,w]=S.useState(!1),[y,C]=S.useState(!1),[T,E]=S.useState(null),[j,k]=S.useState(null);S.useEffect(()=>{s==="kraken"&&A()},[s]);const A=S.useCallback(async()=>{if(!e){m(!1);return}m(!0),E(null);try{const G=await e.fetchBalance(),B=[{asset:"ETH",balance:G.ETH?.total||0,stakedBalance:0,availableBalance:G.ETH?.free||0,apy:4.5,lockPeriod:"Flexible",method:"ETH2.S"},{asset:"DOT",balance:G.DOT?.total||0,stakedBalance:0,availableBalance:G.DOT?.free||0,apy:12,lockPeriod:"28 days",method:"DOT.S"},{asset:"SOL",balance:G.SOL?.total||0,stakedBalance:0,availableBalance:G.SOL?.free||0,apy:6.5,lockPeriod:"2 days",method:"SOL.S"},{asset:"ADA",balance:G.ADA?.total||0,stakedBalance:0,availableBalance:G.ADA?.free||0,apy:5,lockPeriod:"Flexible",method:"ADA.S"},{asset:"MATIC",balance:G.MATIC?.total||0,stakedBalance:0,availableBalance:G.MATIC?.free||0,apy:8,lockPeriod:"3 days",method:"MATIC.S"}];n(B.filter(F=>F.balance>0||F.stakedBalance>0))}catch(O){E("Failed to fetch staking assets"),console.error("Staking fetch error:",O)}finally{m(!1)}},[e]),R=O=>{o(O),h(""),E(null),k(null);const G=r.find(B=>B.asset===O);G&&(l([{method:G.method,apy:G.apy,lockPeriod:G.lockPeriod,minAmount:.01}]),p(G.method))},M=async()=>{if(!i||!d||!f||parseFloat(f)<=0){E("Please fill all fields");return}const O=r.find(G=>G.asset===i);if(!O||parseFloat(f)>O.availableBalance){E("Insufficient balance");return}w(!0),E(null),k(null);try{typeof e.stakeAsset=="function"?(await e.stakeAsset(i,parseFloat(f),d),k(`Successfully staked ${f} ${i}`),h(""),setTimeout(()=>{A()},2e3)):E("Staking not supported by current adapter")}catch(G){E(G?.message||"Failed to stake asset"),console.error("Staking error:",G)}finally{w(!1)}},P=async()=>{if(!i||!f||parseFloat(f)<=0){E("Please enter valid amount");return}const O=r.find(G=>G.asset===i);if(!O||parseFloat(f)>O.stakedBalance){E("Insufficient staked balance");return}C(!0),E(null),k(null);try{typeof e.unstakeAsset=="function"?(await e.unstakeAsset(i,parseFloat(f)),k(`Successfully unstaked ${f} ${i}`),h(""),setTimeout(()=>{A()},2e3)):E("Unstaking not supported by current adapter")}catch(G){E(G?.message||"Failed to unstake asset"),console.error("Unstaking error:",G)}finally{C(!1)}},I=O=>{if(!i)return;const G=r.find(B=>B.asset===i);if(G){const B=G.availableBalance*O/100;h(B.toFixed(8))}};return s!=="kraken"?null:x?t.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(ni,{className:"w-6 h-6 text-blue-500 animate-spin"})})}):t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(wl,{className:"w-5 h-5 text-green-500"}),t.jsx("span",{className:"text-lg font-semibold text-white",children:"Kraken Staking"})]}),t.jsx("button",{onClick:A,className:"px-3 py-1 text-xs text-blue-400 hover:text-blue-300 border border-blue-500/30 hover:border-blue-400/50 rounded transition",children:"Refresh"})]}),r.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(Rr,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("div",{className:"text-sm",children:"No stakable assets found"}),t.jsx("div",{className:"text-xs mt-1",children:"Add funds to your Kraken account to start staking"})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-2 gap-3 mb-6",children:r.map(O=>t.jsxs("button",{onClick:()=>R(O.asset),className:`p-4 rounded border-2 transition ${i===O.asset?"border-blue-500 bg-blue-500/10":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-white font-semibold",children:O.asset}),t.jsxs("div",{className:"flex items-center gap-1 text-green-500 text-xs",children:[t.jsx(Nr,{className:"w-3 h-3"}),O.apy.toFixed(2),"% APY"]})]}),t.jsxs("div",{className:"text-xs text-gray-400",children:[t.jsxs("div",{children:["Balance: ",O.balance.toFixed(8)]}),O.stakedBalance>0&&t.jsxs("div",{className:"text-green-500",children:["Staked: ",O.stakedBalance.toFixed(8)]})]}),t.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-2",children:[t.jsx(uo,{className:"w-3 h-3"}),O.lockPeriod]})]},O.asset))}),i&&t.jsxs("div",{className:"border-t border-gray-800 pt-6 space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs text-gray-400 mb-2",children:"Amount to Stake"}),t.jsx("input",{type:"number",value:f,onChange:O=>h(O.target.value),placeholder:"0.00",className:"w-full px-4 py-3 bg-gray-800 border border-gray-700 rounded text-white focus:outline-none focus:border-blue-500",step:"0.00000001",min:"0"}),t.jsx("div",{className:"flex gap-2 mt-2",children:[25,50,75,100].map(O=>t.jsxs("button",{onClick:()=>I(O),className:"flex-1 px-2 py-1 text-xs bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded transition",children:[O,"%"]},O))})]}),i&&f&&parseFloat(f)>0&&t.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded",children:t.jsxs("div",{className:"text-xs space-y-1",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:"Estimated yearly earnings:"}),t.jsxs("span",{className:"text-green-500 font-semibold",children:[(parseFloat(f)*(r.find(O=>O.asset===i)?.apy||0)/100).toFixed(8)," ",i]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-400",children:"Lock period:"}),t.jsx("span",{className:"text-white",children:r.find(O=>O.asset===i)?.lockPeriod})]})]})}),T&&t.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded flex items-start gap-2",children:[t.jsx(Rr,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-xs text-red-400",children:T})]}),j&&t.jsxs("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded flex items-start gap-2",children:[t.jsx(Bn,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-xs text-green-400",children:j})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:M,disabled:b||!f||parseFloat(f)<=0,className:"flex-1 px-4 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white font-semibold rounded transition flex items-center justify-center gap-2",children:b?t.jsxs(t.Fragment,{children:[t.jsx(ni,{className:"w-4 h-4 animate-spin"}),"Staking..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Nr,{className:"w-4 h-4"}),"Stake"]})}),t.jsx("button",{onClick:P,disabled:y||!f||parseFloat(f)<=0||(r.find(O=>O.asset===i)?.stakedBalance||0)===0,className:"flex-1 px-4 py-3 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-700 disabled:cursor-not-allowed text-white font-semibold rounded transition flex items-center justify-center gap-2",children:y?t.jsxs(t.Fragment,{children:[t.jsx(ni,{className:"w-4 h-4 animate-spin"}),"Unstaking..."]}):"Unstake"})]}),t.jsx("div",{className:"p-3 bg-gray-800/50 border border-gray-700 rounded",children:t.jsxs("div",{className:"text-xs text-gray-400",children:[t.jsx("strong",{className:"text-gray-300",children:"Note:"})," Staking rewards are automatically paid out. Unstaking may take up to the lock period to complete. Check Kraken's terms for each asset's specific staking conditions."]})})]})]})]})}function QX(){const{activeBroker:s,activeAdapter:e}=Hn(),[r,n]=S.useState([]),[i,o]=S.useState(null),[a,l]=S.useState(!0),[d,p]=S.useState(null);S.useEffect(()=>{s==="kraken"&&f()},[s]);const f=S.useCallback(async()=>{l(!0),p(null);try{const m=[{symbol:"PF_BTCUSD",baseAsset:"BTC",quoteAsset:"USD",price:43250.5,change24h:2.35,volume24h:1234567890,openInterest:56789e4,fundingRate:1e-4,nextFunding:"4h 23m",maxLeverage:50},{symbol:"PF_ETHUSD",baseAsset:"ETH",quoteAsset:"USD",price:2345.67,change24h:-1.23,volume24h:456789012,openInterest:234567e3,fundingRate:5e-5,nextFunding:"4h 23m",maxLeverage:50},{symbol:"PF_SOLUSD",baseAsset:"SOL",quoteAsset:"USD",price:98.45,change24h:5.67,volume24h:123456789,openInterest:45678900,fundingRate:15e-5,nextFunding:"4h 23m",maxLeverage:25},{symbol:"PF_XRPUSD",baseAsset:"XRP",quoteAsset:"USD",price:.5234,change24h:3.45,volume24h:89012345,openInterest:23456789,fundingRate:-2e-5,nextFunding:"4h 23m",maxLeverage:20}];n(m),m.length>0&&!i&&o(m[0])}catch(m){p("Failed to fetch futures markets"),console.error("Futures fetch error:",m)}finally{l(!1)}},[e,i]),h=(m,b=2)=>m.toLocaleString("en-US",{minimumFractionDigits:b,maximumFractionDigits:b}),x=m=>m>=1e9?`$${(m/1e9).toFixed(2)}B`:m>=1e6?`$${(m/1e6).toFixed(2)}M`:m>=1e3?`$${(m/1e3).toFixed(2)}K`:`$${m.toFixed(2)}`;return s!=="kraken"?null:a?t.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(ni,{className:"w-6 h-6 text-blue-500 animate-spin"})})}):t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Cs,{className:"w-5 h-5 text-purple-500"}),t.jsx("span",{className:"text-lg font-semibold text-white",children:"Kraken Futures"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:f,className:"px-3 py-1 text-xs text-blue-400 hover:text-blue-300 border border-blue-500/30 hover:border-blue-400/50 rounded transition",children:"Refresh"}),t.jsxs("a",{href:"https://futures.kraken.com",target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1 text-xs text-gray-400 hover:text-gray-300 border border-gray-700 hover:border-gray-600 rounded transition flex items-center gap-1",children:[t.jsx(Nd,{className:"w-3 h-3"}),"Kraken Futures"]})]})]}),t.jsxs("div",{className:"mb-6 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded flex items-start gap-2",children:[t.jsx(Cl,{className:"w-4 h-4 text-yellow-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-xs text-yellow-400",children:[t.jsx("strong",{children:"Futures Trading Risk Warning:"})," Futures trading involves high risk and leverage. Only trade with funds you can afford to lose. Requires separate Kraken Futures account."]})]}),r.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(Cs,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("div",{className:"text-sm",children:"No futures markets available"})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:r.map(m=>t.jsx("button",{onClick:()=>o(m),className:`p-3 rounded border-2 transition ${i?.symbol===m.symbol?"border-purple-500 bg-purple-500/10":"border-gray-700 bg-gray-800/50 hover:border-gray-600"}`,children:t.jsxs("div",{className:"text-left",children:[t.jsxs("div",{className:"text-white font-semibold mb-1",children:[m.baseAsset,"/USD"]}),t.jsxs("div",{className:"text-sm text-gray-400",children:["$",h(m.price)]}),t.jsxs("div",{className:`text-xs font-semibold ${m.change24h>=0?"text-green-500":"text-red-500"}`,children:[m.change24h>=0?"+":"",m.change24h.toFixed(2),"%"]})]})},m.symbol))}),i&&t.jsxs("div",{className:"border-t border-gray-800 pt-6 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-4 bg-gray-800/50 border border-gray-700 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Mark Price"}),t.jsxs("div",{className:"text-2xl font-bold text-white",children:["$",h(i.price)]}),t.jsxs("div",{className:`text-sm font-semibold ${i.change24h>=0?"text-green-500":"text-red-500"}`,children:[i.change24h>=0?"+":"",i.change24h.toFixed(2),"% 24h"]})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 border border-gray-700 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"24h Volume"}),t.jsx("div",{className:"text-lg font-bold text-white",children:x(i.volume24h)}),t.jsx("div",{className:"text-xs text-gray-500",children:"Trading Volume"})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 border border-gray-700 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Open Interest"}),t.jsx("div",{className:"text-lg font-bold text-white",children:x(i.openInterest)}),t.jsx("div",{className:"text-xs text-gray-500",children:"Total Positions"})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 border border-gray-700 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Funding Rate"}),t.jsxs("div",{className:`text-lg font-bold ${i.fundingRate>=0?"text-green-500":"text-red-500"}`,children:[(i.fundingRate*100).toFixed(4),"%"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"Every 8 hours"})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 border border-gray-700 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Next Funding"}),t.jsx("div",{className:"text-lg font-bold text-white",children:i.nextFunding}),t.jsx("div",{className:"text-xs text-gray-500",children:"Countdown"})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 border border-gray-700 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Max Leverage"}),t.jsxs("div",{className:"text-lg font-bold text-orange-500",children:[i.maxLeverage,"x"]}),t.jsx("div",{className:"text-xs text-gray-500",children:"Available"})]})]}),t.jsxs("div",{className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded",children:[t.jsx("div",{className:"text-sm font-semibold text-blue-400 mb-2",children:"Contract Details"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Contract Type:"}),t.jsx("span",{className:"text-white ml-2",children:"Perpetual"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Settlement:"}),t.jsx("span",{className:"text-white ml-2",children:"USD"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Contract Size:"}),t.jsxs("span",{className:"text-white ml-2",children:["1 ",i.baseAsset]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Min Order:"}),t.jsxs("span",{className:"text-white ml-2",children:["0.0001 ",i.baseAsset]})]})]})]}),t.jsx("div",{className:"p-4 bg-gray-800/30 border border-gray-700 rounded",children:t.jsxs("div",{className:"text-xs text-gray-400 space-y-2",children:[t.jsxs("div",{children:[t.jsx("strong",{className:"text-gray-300",children:"How to trade:"})," Futures trading on Kraken requires a separate Kraken Futures account. Visit"," ",t.jsx("a",{href:"https://futures.kraken.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"futures.kraken.com"})," ","to create an account and start trading."]}),t.jsxs("div",{children:[t.jsx("strong",{className:"text-gray-300",children:"API Integration:"})," To trade futures directly from this terminal, configure Kraken Futures API credentials in Settings."]})]})}),t.jsx("div",{className:"flex gap-3",children:t.jsxs("a",{href:`https://futures.kraken.com/trade/${i.symbol}`,target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded transition flex items-center justify-center gap-2",children:[t.jsx(Nd,{className:"w-4 h-4"}),"Trade on Kraken Futures"]})})]})]})]})}function ZX(s,e=!0,r=2e3){const{activeAdapter:n,tradingMode:i}=Hn(),[o,a]=S.useState([]),[l,d]=S.useState(!1),[p,f]=S.useState(null),h=S.useCallback(async()=>{if(!n){a([]),d(!1);return}o.length===0&&d(!0),f(null);try{const x=new Promise((y,C)=>setTimeout(()=>C(new Error("Position fetch timeout after 15s")),15e3)),m=n.fetchPositions(s?[s]:void 0),w=(await Promise.race([m,x])||[]).map(y=>({symbol:y.symbol,side:y.side==="long"||y.contracts>0?"long":"short",quantity:Math.abs(y.contracts||y.amount||0),entryPrice:y.entryPrice||y.averagePrice||0,currentPrice:y.markPrice||y.currentPrice||0,unrealizedPnl:y.unrealizedPnl||0,realizedPnl:y.realizedPnl,pnlPercent:y.percentage||0,leverage:y.leverage,marginMode:y.marginMode,liquidationPrice:y.liquidationPrice,notionalValue:y.notional||y.notionalValue||0,marginUsed:y.collateral||y.initialMargin,openTime:y.timestamp,positionId:y.id||y.symbol}));a(w),f(null)}catch(x){const m=x;console.error("[usePositions] Failed to fetch positions:",m),f(m),console.warn("[usePositions] Keeping existing positions due to fetch error")}finally{d(!1)}},[n,s]);return S.useEffect(()=>{if(h(),!e)return;const x=setInterval(h,r);return()=>clearInterval(x)},[h,e,r]),{positions:o,isLoading:l,error:p,refresh:h}}function eJ(){const{activeAdapter:s}=Hn(),[e,r]=S.useState(!1),[n,i]=S.useState(null);return{closePosition:S.useCallback(async a=>{if(!s||!s.isConnected())throw new Error("Exchange not connected");r(!0),i(null);try{const l=a.side==="long"?"sell":"buy";return await s.createOrder(a.symbol,"market",l,a.quantity,void 0,{reduceOnly:!0}),!0}catch(l){const d=l;throw i(d),d}finally{r(!1)}},[s]),isClosing:e,error:n}}const hn={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",BORDER:"#2A2A2A"};function tJ(){const{positions:s,isLoading:e,refresh:r}=ZX(void 0,!0,2e3),{closePosition:n,isClosing:i}=eJ(),o=d_(),{activeBroker:a}=Hn(),l=async d=>{if(confirm(`Close ${d.side.toUpperCase()} position for ${d.symbol}?`))try{console.log("[PositionsTable] Closing position:",d),await n(d),console.log("[PositionsTable] Position closed, refreshing..."),await r(),setTimeout(()=>r(),500),alert(` Position closed: ${d.symbol}`)}catch(p){console.error("[PositionsTable] Close error:",p),alert(` Failed to close position: ${p.message}`)}};return e&&s.length===0?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:hn.GRAY,fontSize:"11px"},children:"Loading positions..."}):s.length===0?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:hn.GRAY,fontSize:"11px"},children:"No open positions"}):t.jsx("div",{style:{width:"100%",overflowX:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{backgroundColor:hn.HEADER_BG,borderBottom:`1px solid ${hn.BORDER}`},children:[t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:hn.GRAY,fontWeight:700},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:hn.GRAY,fontWeight:700},children:"SIDE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:hn.GRAY,fontWeight:700},children:"SIZE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:hn.GRAY,fontWeight:700},children:"ENTRY"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:hn.GRAY,fontWeight:700},children:"CURRENT"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:hn.GRAY,fontWeight:700},children:"PNL"}),o.supportsLeverage&&t.jsx("th",{style:{padding:"8px 10px",textAlign:"center",color:hn.GRAY,fontWeight:700},children:"LEV"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"center",color:hn.GRAY,fontWeight:700},children:"ACTIONS"})]})}),t.jsx("tbody",{children:s.map((d,p)=>{const f=MX(d.unrealizedPnl);return t.jsxs("tr",{style:{borderBottom:`1px solid ${hn.BORDER}`,backgroundColor:p%2===0?hn.DARK_BG:hn.PANEL_BG},children:[t.jsx("td",{style:{padding:"10px",color:hn.WHITE,fontWeight:600},children:d.symbol}),t.jsx("td",{style:{padding:"10px"},children:t.jsx("span",{style:{padding:"2px 6px",backgroundColor:d.side==="long"?`${hn.GREEN}20`:`${hn.RED}20`,color:d.side==="long"?hn.GREEN:hn.RED,fontSize:"9px",fontWeight:700,borderRadius:"2px"},children:d.side.toUpperCase()})}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:hn.WHITE},children:d.quantity.toFixed(4)}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:hn.GRAY},children:Eo(d.entryPrice)}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:hn.WHITE},children:Eo(d.currentPrice)}),t.jsxs("td",{style:{padding:"10px",textAlign:"right",color:f.color,fontWeight:700},children:[f.text,t.jsxs("div",{style:{fontSize:"8px",color:hn.GRAY},children:["(",f.sign,d.pnlPercent.toFixed(2),"%)"]})]}),o.supportsLeverage&&t.jsx("td",{style:{padding:"10px",textAlign:"center",color:hn.ORANGE,fontWeight:700},children:$X(d.leverage||1)}),t.jsx("td",{style:{padding:"10px",textAlign:"center"},children:t.jsx("button",{onClick:()=>l(d),disabled:i,style:{padding:"4px 10px",backgroundColor:hn.RED,border:"none",color:hn.WHITE,fontSize:"9px",fontWeight:700,cursor:i?"not-allowed":"pointer",opacity:i?.5:1},onMouseEnter:h=>{i||(h.currentTarget.style.opacity="0.8")},onMouseLeave:h=>{i||(h.currentTarget.style.opacity="1")},children:"CLOSE"})})]},d.positionId||p)})})]})})}function rJ(s,e=!0,r=2e3){const{activeAdapter:n}=Hn(),[i,o]=S.useState([]),[a,l]=S.useState(!1),[d,p]=S.useState(null),f=S.useCallback(async()=>{if(!n||!n.isConnected()){o([]);return}l(!0),p(null);try{const x=(await n.fetchOpenOrders(s)||[]).map(m=>({id:m.id,symbol:m.symbol,type:m.type,side:m.side,quantity:m.amount||0,price:m.price,stopPrice:m.stopPrice,status:m.status,filled:m.filled||0,remaining:m.remaining||m.amount||0,timestamp:m.timestamp||Date.now(),createdAt:m.datetime||new Date().toISOString(),updatedAt:m.lastUpdateTimestamp?new Date(m.lastUpdateTimestamp).toISOString():void 0,average:m.average,cost:m.cost,fee:m.fee?{cost:m.fee.cost||0,currency:m.fee.currency||"USD"}:void 0,clientOrderId:m.clientOrderId,timeInForce:m.timeInForce,reduceOnly:m.reduceOnly,postOnly:m.postOnly}));o(x)}catch(h){const x=h;console.error("[useOrders] Failed to fetch orders:",x),p(x)}finally{l(!1)}},[n,s]);return S.useEffect(()=>{if(f(),!e)return;const h=setInterval(f,r);return()=>clearInterval(h)},[f,e,r]),{openOrders:i,isLoading:a,error:d,refresh:f}}function nJ(){const{activeAdapter:s}=Hn(),[e,r]=S.useState(!1),[n,i]=S.useState(null),o=S.useCallback(async(l,d)=>{if(!s||!s.isConnected())throw new Error("Exchange not connected");r(!0),i(null);try{return await s.cancelOrder(l,d),!0}catch(p){const f=p;throw i(f),f}finally{r(!1)}},[s]),a=S.useCallback(async l=>{if(!s||!s.isConnected())throw new Error("Exchange not connected");if(typeof s.cancelAllOrders!="function")throw new Error("This exchange does not support cancel all orders");r(!0),i(null);try{return await s.cancelAllOrders(l),!0}catch(d){const p=d;throw i(p),p}finally{r(!1)}},[s]);return{cancelOrder:o,cancelAllOrders:a,isCanceling:e,error:n}}function sJ(s,e=50){const{activeAdapter:r}=Hn(),[n,i]=S.useState([]),[o,a]=S.useState(!1),[l,d]=S.useState(null),p=S.useCallback(async()=>{if(!r||!r.isConnected()){i([]);return}if(typeof r.fetchClosedOrders!="function"){i([]);return}a(!0),d(null);try{const h=(await r.fetchClosedOrders(s,void 0,e)||[]).map(x=>({id:x.id,symbol:x.symbol,type:x.type,side:x.side,quantity:x.amount||0,price:x.price,stopPrice:x.stopPrice,status:x.status,filled:x.filled||0,remaining:0,timestamp:x.timestamp||Date.now(),createdAt:x.datetime||new Date().toISOString(),average:x.average,cost:x.cost,fee:x.fee?{cost:x.fee.cost||0,currency:x.fee.currency||"USD"}:void 0}));i(h)}catch(f){const h=f;console.error("[useClosedOrders] Failed to fetch closed orders:",h),d(h)}finally{a(!1)}},[r,s,e]);return S.useEffect(()=>{p()},[p]),{closedOrders:n,isLoading:o,error:l,refresh:p}}const gr={WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",BORDER:"#2A2A2A"};function iJ(){const{openOrders:s,isLoading:e,refresh:r}=rJ(void 0,!0,2e3),{cancelOrder:n,cancelAllOrders:i,isCanceling:o}=nJ(),a=async d=>{if(confirm(`Cancel ${d.type} ${d.side} order for ${d.symbol}?`))try{await n(d.id,d.symbol),await r(),alert(` Order canceled: ${d.id}`)}catch(p){alert(` Failed to cancel order: ${p.message}`)}},l=async()=>{if(confirm("Cancel ALL open orders?"))try{await i(),await r(),alert(" All orders canceled")}catch(d){alert(` Failed to cancel all orders: ${d.message}`)}};return e&&s.length===0?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:gr.GRAY,fontSize:"11px"},children:"Loading orders..."}):t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[s.length>0&&t.jsxs("div",{style:{padding:"8px 12px",backgroundColor:gr.HEADER_BG,borderBottom:`1px solid ${gr.BORDER}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("span",{style:{fontSize:"10px",color:gr.GRAY,fontWeight:700},children:["OPEN ORDERS (",s.length,")"]}),t.jsx("button",{onClick:l,disabled:o,style:{padding:"4px 10px",backgroundColor:`${gr.RED}20`,border:`1px solid ${gr.RED}`,color:gr.RED,fontSize:"9px",fontWeight:700,cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"CANCEL ALL"})]}),t.jsx("div",{style:{flex:1,overflowX:"auto",overflowY:"auto"},children:s.length===0?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:gr.GRAY,fontSize:"11px"},children:"No open orders"}):t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[t.jsx("thead",{style:{position:"sticky",top:0,zIndex:1},children:t.jsxs("tr",{style:{backgroundColor:gr.HEADER_BG,borderBottom:`1px solid ${gr.BORDER}`},children:[t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:gr.GRAY,fontWeight:700},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:gr.GRAY,fontWeight:700},children:"TYPE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:gr.GRAY,fontWeight:700},children:"SIDE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:gr.GRAY,fontWeight:700},children:"SIZE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:gr.GRAY,fontWeight:700},children:"PRICE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:gr.GRAY,fontWeight:700},children:"FILLED"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:gr.GRAY,fontWeight:700},children:"STATUS"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:gr.GRAY,fontWeight:700},children:"TIME"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"center",color:gr.GRAY,fontWeight:700},children:"ACTION"})]})}),t.jsx("tbody",{children:s.map((d,p)=>{const f=c_(d.status),h=d.filled/d.quantity*100;return t.jsxs("tr",{style:{borderBottom:`1px solid ${gr.BORDER}`,backgroundColor:p%2===0?gr.DARK_BG:gr.PANEL_BG},children:[t.jsx("td",{style:{padding:"10px",color:gr.WHITE,fontWeight:600},children:d.symbol}),t.jsx("td",{style:{padding:"10px",color:gr.GRAY,textTransform:"uppercase"},children:d.type}),t.jsx("td",{style:{padding:"10px"},children:t.jsx("span",{style:{padding:"2px 6px",backgroundColor:d.side==="buy"?`${gr.GREEN}20`:`${gr.RED}20`,color:d.side==="buy"?gr.GREEN:gr.RED,fontSize:"9px",fontWeight:700,borderRadius:"2px"},children:d.side.toUpperCase()})}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:gr.WHITE},children:d.quantity.toFixed(4)}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:gr.GRAY},children:d.price?Eo(d.price):"MARKET"}),t.jsxs("td",{style:{padding:"10px",textAlign:"right"},children:[t.jsx("div",{style:{color:gr.WHITE},children:d.filled.toFixed(4)}),t.jsxs("div",{style:{fontSize:"8px",color:gr.GRAY},children:["(",h.toFixed(0),"%)"]})]}),t.jsx("td",{style:{padding:"10px"},children:t.jsx("span",{style:{padding:"2px 6px",backgroundColor:`${f.color}20`,color:f.color,fontSize:"8px",fontWeight:700,borderRadius:"2px"},children:f.text})}),t.jsx("td",{style:{padding:"10px",color:gr.GRAY,fontSize:"9px"},children:l_(d.timestamp)}),t.jsx("td",{style:{padding:"10px",textAlign:"center"},children:t.jsx("button",{onClick:()=>a(d),disabled:o,style:{padding:"4px 10px",backgroundColor:"transparent",border:`1px solid ${gr.RED}`,color:gr.RED,fontSize:"9px",fontWeight:700,cursor:o?"not-allowed":"pointer",opacity:o?.5:1},onMouseEnter:x=>{o||(x.currentTarget.style.backgroundColor=gr.RED,x.currentTarget.style.color=gr.WHITE)},onMouseLeave:x=>{o||(x.currentTarget.style.backgroundColor="transparent",x.currentTarget.style.color=gr.RED)},children:"CANCEL"})})]},d.id)})})]})})]})}const an={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",BORDER:"#2A2A2A"};function oJ(){const{closedOrders:s,isLoading:e,error:r}=sJ(void 0,100);return r?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:an.GRAY,fontSize:"11px"},children:"This exchange does not support closed orders history"}):e?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:an.GRAY,fontSize:"11px"},children:"Loading order history..."}):s.length===0?t.jsx("div",{style:{padding:"20px",textAlign:"center",color:an.GRAY,fontSize:"11px"},children:"No closed orders"}):t.jsx("div",{style:{width:"100%",height:"100%",overflowX:"auto",overflowY:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[t.jsx("thead",{style:{position:"sticky",top:0,zIndex:1},children:t.jsxs("tr",{style:{backgroundColor:an.HEADER_BG,borderBottom:`1px solid ${an.BORDER}`},children:[t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:an.GRAY,fontWeight:700},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:an.GRAY,fontWeight:700},children:"TYPE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:an.GRAY,fontWeight:700},children:"SIDE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:an.GRAY,fontWeight:700},children:"SIZE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:an.GRAY,fontWeight:700},children:"PRICE"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:an.GRAY,fontWeight:700},children:"AVG FILL"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"right",color:an.GRAY,fontWeight:700},children:"COST"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:an.GRAY,fontWeight:700},children:"STATUS"}),t.jsx("th",{style:{padding:"8px 10px",textAlign:"left",color:an.GRAY,fontWeight:700},children:"TIME"})]})}),t.jsx("tbody",{children:s.map((n,i)=>{const o=c_(n.status);return t.jsxs("tr",{style:{borderBottom:`1px solid ${an.BORDER}`,backgroundColor:i%2===0?an.DARK_BG:an.PANEL_BG},children:[t.jsx("td",{style:{padding:"10px",color:an.WHITE,fontWeight:600},children:n.symbol}),t.jsx("td",{style:{padding:"10px",color:an.GRAY,textTransform:"uppercase",fontSize:"9px"},children:n.type}),t.jsx("td",{style:{padding:"10px"},children:t.jsx("span",{style:{padding:"2px 6px",backgroundColor:n.side==="buy"?`${an.GREEN}20`:`${an.RED}20`,color:n.side==="buy"?an.GREEN:an.RED,fontSize:"9px",fontWeight:700,borderRadius:"2px"},children:n.side.toUpperCase()})}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:an.WHITE},children:n.quantity.toFixed(4)}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:an.GRAY},children:n.price?Eo(n.price):"MARKET"}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:an.WHITE},children:n.average?Eo(n.average):"--"}),t.jsx("td",{style:{padding:"10px",textAlign:"right",color:an.ORANGE},children:n.cost?Eo(n.cost):"--"}),t.jsx("td",{style:{padding:"10px"},children:t.jsx("span",{style:{padding:"2px 6px",backgroundColor:`${o.color}20`,color:o.color,fontSize:"8px",fontWeight:700,borderRadius:"2px"},children:o.text})}),t.jsx("td",{style:{padding:"10px",color:an.GRAY,fontSize:"9px"},children:l_(n.timestamp)})]},n.id)})})]})})}function u_(s,e="1h",r=100){const{activeAdapter:n}=Hn(),[i,o]=S.useState([]),[a,l]=S.useState(!1),[d,p]=S.useState(null),f=S.useCallback(async()=>{if(!n||!s){o([]);return}l(!0),p(null);try{const x=(await n.fetchOHLCV(s,e,r)||[]).map(m=>({timestamp:m[0],open:m[1],high:m[2],low:m[3],close:m[4],volume:m[5]}));o(x)}catch(h){const x=h;console.error("[useOHLCV] Failed to fetch OHLCV:",x),p(x),o([])}finally{l(!1)}},[n,s,e,r]);return S.useEffect(()=>{f()},[f]),{ohlcv:i,isLoading:a,error:d,refresh:f}}function aJ(s,e=20,r=!0){const{activeAdapter:n}=Hn(),[i,o]=S.useState(null),[a,l]=S.useState(!1),[d,p]=S.useState(null),f=S.useCallback(async()=>{if(!n||!s){o(null);return}l(!0),p(null);try{const h=await n.fetchOrderBook(s,e),x={symbol:s,bids:(h.bids||[]).map(m=>({price:m[0],size:m[1]})),asks:(h.asks||[]).map(m=>({price:m[0],size:m[1]})),timestamp:h.timestamp||Date.now()};o(x)}catch(h){const x=h;console.error("[useOrderBook] Failed to fetch orderbook:",x),p(x),o(null)}finally{l(!1)}},[n,s,e]);return S.useEffect(()=>{if(f(),!r)return;const h=setInterval(f,1e3);return()=>clearInterval(h)},[f,r]),{orderBook:i,isLoading:a,error:d,refresh:f}}function lJ(s,e="1h",r=100){const{ohlcv:n}=u_(s,e,r),[i,o]=S.useState([]);return S.useEffect(()=>{if(!n.length){o([]);return}const a=new Map;n.forEach(d=>{const p=Math.round(d.close/10)*10,f=a.get(p)||{volume:0,buyVol:0,sellVol:0},h=d.close>=d.open,x=h?d.volume:d.volume*.3,m=h?d.volume*.3:d.volume;a.set(p,{volume:f.volume+d.volume,buyVol:f.buyVol+x,sellVol:f.sellVol+m})});const l=Array.from(a.entries()).map(([d,p])=>({price:d,volume:p.volume,buyVolume:p.buyVol,sellVolume:p.sellVol})).sort((d,p)=>d.price-p.price);o(l)},[n]),{volumeProfile:i,isLoading:!1,error:null}}function cJ({symbol:s,timeframe:e="1h",height:r=500,showVolume:n=!0}){const[i,o]=S.useState(e),{ohlcv:a,isLoading:l,error:d}=u_(s,i,200),p=["1m","5m","15m","1h","4h","1d"],f=a.map(h=>({time:h.timestamp>1e10?Math.floor(h.timestamp/1e3):h.timestamp,open:h.open,high:h.high,low:h.low,close:h.close,volume:h.volume}));return t.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",position:"relative"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 12px",flexShrink:0,backgroundColor:"#000000",borderBottom:"1px solid #2A2A2A",height:"28px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("span",{style:{fontSize:"10px",color:"#787878",fontWeight:600,fontFamily:"monospace"},children:"TIMEFRAME:"}),t.jsx("div",{style:{display:"flex",gap:"3px"},children:p.map(h=>t.jsx("button",{onClick:()=>o(h),style:{padding:"3px 8px",fontSize:"10px",fontFamily:"monospace",borderRadius:"2px",border:"none",cursor:"pointer",backgroundColor:i===h?"#FF8800":"#1A1A1A",color:i===h?"#000000":"#787878",fontWeight:i===h?600:400,transition:"all 0.2s"},onMouseEnter:x=>{i!==h&&(x.currentTarget.style.backgroundColor="#2A2A2A",x.currentTarget.style.color="#FFFFFF")},onMouseLeave:x=>{i!==h&&(x.currentTarget.style.backgroundColor="#1A1A1A",x.currentTarget.style.color="#787878")},children:h},h))})]}),!l&&!d&&f.length>0&&t.jsx("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"2px",fontSize:"10px",fontFamily:"monospace"},children:[t.jsxs("span",{style:{color:"#FF8800",fontWeight:600,marginRight:"8px"},children:[s," - ",i]}),t.jsx("span",{style:{color:"#787878"},children:"O"}),t.jsx("span",{style:{color:"#FFFFFF",marginRight:"6px"},children:f[f.length-1].open.toFixed(2)}),t.jsx("span",{style:{color:"#787878"},children:"H"}),t.jsx("span",{style:{color:"#FFFFFF",marginRight:"6px"},children:f[f.length-1].high.toFixed(2)}),t.jsx("span",{style:{color:"#787878"},children:"L"}),t.jsx("span",{style:{color:"#FFFFFF",marginRight:"6px"},children:f[f.length-1].low.toFixed(2)}),t.jsx("span",{style:{color:"#787878"},children:"C"}),t.jsx("span",{style:{color:f[f.length-1].close>=f[f.length-1].open?"#00D66F":"#FF3B3B",fontWeight:600,marginRight:"12px"},children:f[f.length-1].close.toFixed(2)}),t.jsxs("span",{style:{color:"#787878",fontSize:"9px"},children:[f.length," BARS"]})]})})]}),t.jsxs("div",{style:{flex:1,position:"relative",minHeight:0,overflow:"hidden"},children:[l&&t.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:10},children:t.jsx("div",{style:{width:"32px",height:"32px",border:"2px solid transparent",borderTopColor:"#3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}})}),d&&t.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:10},children:t.jsxs("div",{style:{color:"#ef4444",fontSize:"14px"},children:["Failed to load chart data: ",d.message]})}),!l&&!d&&f.length>0&&t.jsx(D2,{data:f,symbol:`${s} - ${i}`,height:r,showVolume:n,showToolbar:!0,showHeader:!1}),!l&&!d&&f.length===0&&t.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:"#6b7280",fontSize:"12px"},children:"No data available"})]})]})}function dJ({symbol:s,height:e=300,limit:r=50}){const{orderBook:n,isLoading:i,error:o}=aJ(s,r,!0),a=S.useMemo(()=>{if(!n)return[];const d=[];let p=0;[...n.bids].sort((m,b)=>b.price-m.price).slice(0,r).forEach(m=>{p+=m.size,d.push({price:m.price,bidTotal:p,askTotal:0})});let h=0;return[...n.asks].sort((m,b)=>m.price-b.price).slice(0,r).forEach(m=>{h+=m.size,d.push({price:m.price,bidTotal:0,askTotal:h})}),d.sort((m,b)=>m.price-b.price)},[n,r]),l=S.useMemo(()=>!n||!n.bids.length||!n.asks.length?null:(n.bids[0].price+n.asks[0].price)/2,[n]);return i?t.jsx("div",{className:"flex items-center justify-center bg-black border border-gray-800 rounded",style:{height:e},children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):o?t.jsxs("div",{className:"flex items-center justify-center bg-black border border-gray-800 rounded text-red-500 text-sm",style:{height:e},children:["Failed to load depth chart: ",o.message]}):a.length?t.jsxs("div",{className:"bg-black border border-gray-800 rounded p-2",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"MARKET DEPTH"}),l&&t.jsxs("span",{className:"text-xs font-mono text-gray-300",children:["MID: $",l.toFixed(2)]})]}),t.jsx(ml,{width:"100%",height:e,children:t.jsxs(dA,{data:a,margin:{top:5,right:5,left:5,bottom:5},children:[t.jsxs("defs",{children:[t.jsxs("linearGradient",{id:"bidGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.4}),t.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]}),t.jsxs("linearGradient",{id:"askGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.4}),t.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]})]}),t.jsx(bl,{dataKey:"price",stroke:"#4b5563",tick:{fill:"#9ca3af",fontSize:11},tickFormatter:d=>`$${d.toFixed(0)}`}),t.jsx(vl,{stroke:"#4b5563",tick:{fill:"#9ca3af",fontSize:11},tickFormatter:d=>d.toFixed(2)}),t.jsx(Sl,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"4px",fontSize:"12px"},labelStyle:{color:"#d1d5db"},itemStyle:{color:"#d1d5db"},formatter:d=>d.toFixed(4),labelFormatter:d=>`Price: $${d}`}),t.jsx(L0,{type:"stepAfter",dataKey:"bidTotal",stroke:"#10b981",fill:"url(#bidGradient)",strokeWidth:2,name:"Bid Depth"}),t.jsx(L0,{type:"stepBefore",dataKey:"askTotal",stroke:"#ef4444",fill:"url(#askGradient)",strokeWidth:2,name:"Ask Depth"})]})})]}):t.jsx("div",{className:"flex items-center justify-center bg-black border border-gray-800 rounded text-gray-500 text-sm",style:{height:e},children:"No orderbook data available"})}function uJ({symbol:s,timeframe:e="1h",height:r=400,limit:n=100}){const{volumeProfile:i}=lJ(s,e,n);if(!i.length)return t.jsx("div",{className:"flex items-center justify-center bg-black border border-gray-800 rounded",style:{height:r},children:t.jsx("div",{className:"text-gray-500 text-sm",children:"No volume data available"})});Math.max(...i.map(a=>a.volume));const o=i.reduce((a,l)=>l.volume>a.volume?l:a);return t.jsxs("div",{className:"bg-black border border-gray-800 rounded p-2",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"VOLUME PROFILE"}),t.jsxs("span",{className:"text-xs font-mono text-blue-400",children:["POC: $",o.price.toFixed(2)]})]}),t.jsx(ml,{width:"100%",height:r,children:t.jsxs(aA,{data:i,layout:"horizontal",margin:{top:5,right:5,left:50,bottom:20},children:[t.jsx(bl,{type:"number",stroke:"#4b5563",tick:{fill:"#9ca3af",fontSize:11},tickFormatter:a=>`${(a/1e3).toFixed(0)}K`}),t.jsx(vl,{type:"number",dataKey:"price",stroke:"#4b5563",tick:{fill:"#9ca3af",fontSize:11},tickFormatter:a=>`$${a.toFixed(0)}`,domain:["auto","auto"]}),t.jsx(Sl,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"4px",fontSize:"12px"},labelStyle:{color:"#d1d5db"},itemStyle:{color:"#d1d5db"},formatter:(a,l)=>a.toFixed(2),labelFormatter:a=>`Price: $${a}`}),t.jsx(lA,{dataKey:"volume",radius:[0,2,2,0],children:i.map((a,l)=>{const d=a.buyVolume/a.volume,p=a.price===o.price;let f="#6b7280";return p?f="#3b82f6":d>.6?f="#10b981":d<.4&&(f="#ef4444"),t.jsx(JI,{fill:f},`cell-${l}`)})})]})}),t.jsxs("div",{className:"flex items-center justify-center gap-4 mt-2 text-xs",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),t.jsx("span",{className:"text-gray-400",children:"POC"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),t.jsx("span",{className:"text-gray-400",children:"Buy Heavy"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),t.jsx("span",{className:"text-gray-400",children:"Sell Heavy"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded"}),t.jsx("span",{className:"text-gray-400",children:"Neutral"})]})]})]})}function pJ(){const{activeAdapter:s,activeBroker:e}=Hn(),[r,n]=S.useState(null),[i,o]=S.useState(!1),[a,l]=S.useState(null),d=S.useCallback(async()=>{if(!s){n(null);return}o(!0),l(null);try{const p=s.getTradingFees?.()||null;if(p)n({maker:p.maker||0,taker:p.taker||0,makerPercent:`${((p.maker||0)*100).toFixed(3)}%`,takerPercent:`${((p.taker||0)*100).toFixed(3)}%`});else{const f={kraken:{maker:.0016,taker:.0026,makerPercent:"0.160%",takerPercent:"0.260%"},hyperliquid:{maker:2e-4,taker:5e-4,makerPercent:"0.020%",takerPercent:"0.050%"},paper:{maker:2e-4,taker:5e-4,makerPercent:"0.020%",takerPercent:"0.050%"}};n(f[e||"paper"]||f.paper)}}catch(p){const f=p;console.error("[useFees] Failed to fetch fees:",f),l(f),n(null)}finally{o(!1)}},[s,e]);return S.useEffect(()=>{d()},[d]),{fees:r,isLoading:i,error:a,refresh:d}}function hJ(s=!0){const{activeAdapter:e}=Hn(),[r,n]=S.useState(null),[i,o]=S.useState(!1),[a,l]=S.useState(null),d=S.useCallback(async()=>{if(!e||!e.isConnected()){n(null);return}o(!0),l(null);try{const f=(await e.fetchBalance()).info;if(f&&f.totalMargin!==void 0){const h=parseFloat(f.totalMargin||"0"),x=parseFloat(f.usedMargin||"0"),m=h-x,b=h>0?m/h*100:100,w=parseFloat(f.maintenanceMargin||"0");n({totalMargin:h,usedMargin:x,availableMargin:m,marginLevel:b,maintenanceMargin:w,isMarginCall:b<20})}else n(null)}catch(p){const f=p;console.error("[useMarginInfo] Failed to fetch margin info:",f),l(f),n(null)}finally{o(!1)}},[e]);return S.useEffect(()=>{if(d(),!s)return;const p=setInterval(d,1e4);return()=>clearInterval(p)},[d,s]),{marginInfo:r,isLoading:i,error:a,refresh:d}}function fJ(){const{activeAdapter:s,tradingMode:e,paperAdapter:r}=Hn(),[n,i]=S.useState(null),[o,a]=S.useState(!1),[l,d]=S.useState(null),p=S.useCallback(async()=>{const f=e==="paper"?r:s;if(!f){i(null);return}a(!0),d(null);try{if(e==="paper"&&f.getStatistics){const h=await f.getStatistics();i(h)}else i(null)}catch(h){const x=h;console.error("[useTradingStats] Failed to fetch stats:",x),d(x),i(null)}finally{a(!1)}},[s,r,e]);return S.useEffect(()=>{p();const f=setInterval(p,1e4);return()=>clearInterval(f)},[p]),{stats:n,isLoading:o,error:l,refresh:p}}const Ht={ORANGE:"#FF8800",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",YELLOW:"#FFD700",BLUE:"#0088FF",PURPLE:"#9D4EDD",BORDER:"#2A2A2A",MUTED:"#4A4A4A"};function gJ(){const{stats:s,isLoading:e}=fJ();if(e||!s)return t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px",background:Ht.PANEL_BG,border:`1px solid ${Ht.BORDER}`,color:Ht.GRAY,fontSize:"12px"},children:e?t.jsx("div",{style:{width:"24px",height:"24px",border:`2px solid ${Ht.BORDER}`,borderTopColor:Ht.ORANGE,borderRadius:"50%",animation:"spin 1s linear infinite"}}):"No statistics available"});const r=[{label:"Total P&L",value:`${s.totalPnL>=0?"+":""}$${(typeof s.totalPnL=="number"?s.totalPnL:0).toFixed(2)}`,color:s.totalPnL>=0?Ht.GREEN:Ht.RED,icon:s.totalPnL>=0?Nr:Dd},{label:"Return",value:`${s.returnPercent>=0?"+":""}${(typeof s.returnPercent=="number"?s.returnPercent:0).toFixed(2)}%`,color:s.returnPercent>=0?Ht.GREEN:Ht.RED,icon:ka},{label:"Win Rate",value:`${(typeof s.winRate=="number"?s.winRate:0).toFixed(1)}%`,color:s.winRate>=50?Ht.GREEN:Ht.YELLOW,icon:ka},{label:"Total Trades",value:(s.totalTrades||0).toString(),color:Ht.BLUE,icon:wl},{label:"Winning Trades",value:(s.winningTrades||0).toString(),color:Ht.GREEN,icon:Nr},{label:"Losing Trades",value:(s.losingTrades||0).toString(),color:Ht.RED,icon:Dd},{label:"Realized P&L",value:`${s.realizedPnL>=0?"+":""}$${(typeof s.realizedPnL=="number"?s.realizedPnL:0).toFixed(2)}`,color:s.realizedPnL>=0?Ht.GREEN:Ht.RED,icon:wl},{label:"Unrealized P&L",value:`${s.unrealizedPnL>=0?"+":""}$${(typeof s.unrealizedPnL=="number"?s.unrealizedPnL:0).toFixed(2)}`,color:s.unrealizedPnL>=0?Ht.GREEN:Ht.RED,icon:wl}];return t.jsxs("div",{style:{height:"100%",overflow:"auto",padding:"12px",background:Ht.PANEL_BG},children:[t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"12px",marginBottom:"16px"},children:r.map((n,i)=>{const o=n.icon;return t.jsxs("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px",transition:"all 0.2s"},onMouseEnter:a=>a.currentTarget.style.borderColor=Ht.MUTED,onMouseLeave:a=>a.currentTarget.style.borderColor=Ht.BORDER,children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{fontSize:"9px",color:Ht.GRAY,fontWeight:600,letterSpacing:"0.5px"},children:n.label.toUpperCase()}),t.jsx(o,{size:14,color:n.color})]}),t.jsx("div",{style:{fontSize:"18px",fontWeight:700,fontFamily:'"IBM Plex Mono", monospace',color:n.color},children:n.value})]},i)})}),s.averageWin!==void 0&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"12px",marginBottom:"16px"},children:[s.averageWin!==void 0&&typeof s.averageWin=="number"&&t.jsxs("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",color:Ht.GRAY,marginBottom:"4px"},children:"AVG WIN"}),t.jsxs("div",{style:{fontSize:"14px",fontFamily:'"IBM Plex Mono", monospace',color:Ht.GREEN,fontWeight:600},children:["$",s.averageWin.toFixed(2)]})]}),s.averageLoss!==void 0&&typeof s.averageLoss=="number"&&t.jsxs("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",color:Ht.GRAY,marginBottom:"4px"},children:"AVG LOSS"}),t.jsxs("div",{style:{fontSize:"14px",fontFamily:'"IBM Plex Mono", monospace',color:Ht.RED,fontWeight:600},children:["$",s.averageLoss.toFixed(2)]})]}),s.profitFactor!==void 0&&typeof s.profitFactor=="number"&&t.jsxs("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",color:Ht.GRAY,marginBottom:"4px"},children:"PROFIT FACTOR"}),t.jsx("div",{style:{fontSize:"14px",fontFamily:'"IBM Plex Mono", monospace',color:Ht.BLUE,fontWeight:600},children:s.profitFactor.toFixed(2)})]}),s.largestWin!==void 0&&typeof s.largestWin=="number"&&t.jsxs("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",color:Ht.GRAY,marginBottom:"4px"},children:"LARGEST WIN"}),t.jsxs("div",{style:{fontSize:"14px",fontFamily:'"IBM Plex Mono", monospace',color:Ht.GREEN,fontWeight:600},children:["$",s.largestWin.toFixed(2)]})]}),s.largestLoss!==void 0&&typeof s.largestLoss=="number"&&t.jsxs("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",color:Ht.GRAY,marginBottom:"4px"},children:"LARGEST LOSS"}),t.jsxs("div",{style:{fontSize:"14px",fontFamily:'"IBM Plex Mono", monospace',color:Ht.RED,fontWeight:600},children:["$",s.largestLoss.toFixed(2)]})]}),s.sharpeRatio!==void 0&&typeof s.sharpeRatio=="number"&&t.jsxs("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",color:Ht.GRAY,marginBottom:"4px"},children:"SHARPE RATIO"}),t.jsx("div",{style:{fontSize:"14px",fontFamily:'"IBM Plex Mono", monospace',color:Ht.PURPLE,fontWeight:600},children:s.sharpeRatio.toFixed(2)})]})]}),t.jsx("div",{style:{background:Ht.DARK_BG,border:`1px solid ${Ht.BORDER}`,borderRadius:"4px",padding:"12px"},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsx("span",{style:{fontSize:"9px",color:Ht.GRAY,fontWeight:600},children:"TOTAL FEES PAID"}),t.jsxs("span",{style:{fontSize:"14px",fontFamily:'"IBM Plex Mono", monospace',color:Ht.ORANGE,fontWeight:600},children:["$",(typeof s.totalFees=="number"?s.totalFees:0).toFixed(2)]})]})})]})}const Jr={ORANGE:"#FF8800",WHITE:"#FFFFFF",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",CYAN:"#00E5FF",BLUE:"#0088FF",BORDER:"#2A2A2A",MUTED:"#4A4A4A"};function xJ(){const{fees:s,isLoading:e}=pJ(),{activeBroker:r}=Hn();return e||!s?t.jsxs("div",{style:{background:Jr.PANEL_BG,border:`1px solid ${Jr.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[t.jsx(wl,{size:14,color:Jr.ORANGE}),t.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:Jr.WHITE},children:"TRADING FEES"})]}),e?t.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:t.jsx("div",{style:{width:"20px",height:"20px",border:`2px solid ${Jr.BORDER}`,borderTopColor:Jr.ORANGE,borderRadius:"50%",animation:"spin 1s linear infinite"}})}):t.jsx("div",{style:{fontSize:"10px",color:Jr.GRAY},children:"No fee information available"})]}):t.jsxs("div",{style:{background:Jr.PANEL_BG,border:`1px solid ${Jr.BORDER}`,borderRadius:"4px",padding:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(wl,{size:14,color:Jr.ORANGE}),t.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:Jr.WHITE},children:"TRADING FEES"})]}),t.jsx("span",{style:{fontSize:"9px",color:Jr.GRAY,fontWeight:600},children:r?.toUpperCase()})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",background:Jr.DARK_BG,border:`1px solid ${Jr.BORDER}`,borderRadius:"3px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("div",{style:{fontSize:"10px",color:Jr.GRAY},children:"MAKER FEE"}),t.jsx("div",{style:{position:"relative",display:"inline-block"},title:"Fee for adding liquidity to the order book",children:t.jsx(dg,{size:10,color:Jr.MUTED,style:{cursor:"help"}})})]}),t.jsx("div",{style:{fontSize:"11px",fontFamily:'"IBM Plex Mono", monospace',color:Jr.GREEN,fontWeight:600},children:s.makerPercent})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",background:Jr.DARK_BG,border:`1px solid ${Jr.BORDER}`,borderRadius:"3px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("div",{style:{fontSize:"10px",color:Jr.GRAY},children:"TAKER FEE"}),t.jsx("div",{style:{position:"relative",display:"inline-block"},title:"Fee for taking liquidity from the order book",children:t.jsx(dg,{size:10,color:Jr.MUTED,style:{cursor:"help"}})})]}),t.jsx("div",{style:{fontSize:"11px",fontFamily:'"IBM Plex Mono", monospace',color:Jr.ORANGE,fontWeight:600},children:s.takerPercent})]})]}),t.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:`1px solid ${Jr.BORDER}`},children:[t.jsx("div",{style:{fontSize:"9px",color:Jr.GRAY,marginBottom:"8px"},children:"EXAMPLE: $10,000 TRADE"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"10px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:Jr.GRAY},children:"Maker:"}),t.jsxs("span",{style:{color:Jr.GREEN,fontFamily:'"IBM Plex Mono", monospace',fontWeight:600},children:["$",(1e4*s.maker).toFixed(2)]})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[t.jsx("span",{style:{color:Jr.GRAY},children:"Taker:"}),t.jsxs("span",{style:{color:Jr.ORANGE,fontFamily:'"IBM Plex Mono", monospace',fontWeight:600},children:["$",(1e4*s.taker).toFixed(2)]})]})]})]}),t.jsx("div",{style:{marginTop:"12px",padding:"8px",background:`${Jr.BLUE}15`,border:`1px solid ${Jr.BLUE}40`,borderRadius:"3px"},children:t.jsx("div",{style:{fontSize:"9px",color:Jr.CYAN},children:" TIP: Use limit orders to pay lower maker fees"})})]})}function mJ(){const{marginInfo:s,isLoading:e}=hJ();if(e)return t.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded p-4",children:t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"})})});if(!s)return t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(jo,{className:"w-4 h-4 text-gray-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-400",children:"Margin Trading"})]}),t.jsx("div",{className:"text-xs text-gray-500",children:"Not available or not enabled on this account"})]});const n=s.marginLevel>=50?{color:"text-green-500",bgColor:"bg-green-500/10",borderColor:"border-green-500/20",label:"Healthy"}:s.marginLevel>=20?{color:"text-yellow-500",bgColor:"bg-yellow-500/10",borderColor:"border-yellow-500/20",label:"Warning"}:{color:"text-red-500",bgColor:"bg-red-500/10",borderColor:"border-red-500/20",label:"Critical"};return t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(jo,{className:"w-4 h-4 text-blue-500"}),t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Margin Status"})]}),t.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 ${n.bgColor} ${n.borderColor} border rounded text-xs ${n.color}`,children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-current"}),n.label]})]}),s.isMarginCall&&t.jsxs("div",{className:"mb-3 p-2 bg-red-500/10 border border-red-500/20 rounded flex items-start gap-2",children:[t.jsx(Cl,{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-xs text-red-400",children:[t.jsx("div",{className:"font-medium mb-1",children:"Margin Call Warning!"}),t.jsx("div",{children:"Your margin level is critically low. Add funds or close positions to avoid liquidation."})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"Margin Level"}),t.jsxs("span",{className:`text-sm font-mono font-bold ${n.color}`,children:[s.marginLevel.toFixed(2),"%"]})]}),t.jsx("div",{className:"w-full h-2 bg-gray-800 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full ${n.bgColor.replace("/10","")} transition-all`,style:{width:`${Math.min(s.marginLevel,100)}%`}})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/30 rounded",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"Total Margin"}),t.jsxs("span",{className:"text-sm font-mono text-white",children:["$",s.totalMargin.toFixed(2)]})]}),t.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/30 rounded",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"Used Margin"}),t.jsxs("span",{className:"text-sm font-mono text-orange-500",children:["$",s.usedMargin.toFixed(2)]})]}),t.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/30 rounded",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"Available Margin"}),t.jsxs("span",{className:"text-sm font-mono text-green-500",children:["$",s.availableMargin.toFixed(2)]})]}),s.maintenanceMargin>0&&t.jsxs("div",{className:"flex items-center justify-between p-2 bg-black/30 rounded",children:[t.jsx("span",{className:"text-xs text-gray-400",children:"Maintenance Margin"}),t.jsxs("span",{className:"text-sm font-mono text-blue-500",children:["$",s.maintenanceMargin.toFixed(2)]})]})]}),t.jsx("div",{className:"mt-3 p-2 bg-blue-500/10 border border-blue-500/20 rounded",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(Nr,{className:"w-3 h-3 text-blue-400 flex-shrink-0 mt-0.5"}),t.jsx("div",{className:"text-xs text-blue-400",children:"Maintain margin level above 50% for safe trading"})]})})]})}function yJ(){const{availableBrokers:s}=Hn(),[e,r]=S.useState([]),[n,i]=S.useState([]),[o,a]=S.useState(0),[l,d]=S.useState(!0),[p,f]=S.useState(null),h=S.useCallback(async()=>{d(!0),f(null);try{const x=[],m=[{exchange:"kraken",currency:"BTC",total:.5,free:.3,used:.2,usdValue:21625},{exchange:"kraken",currency:"ETH",total:10,free:8,used:2,usdValue:23456},{exchange:"kraken",currency:"USDC",total:5e3,free:4500,used:500,usdValue:5e3},{exchange:"hyperliquid",currency:"BTC",total:.3,free:.3,used:0,usdValue:12975},{exchange:"hyperliquid",currency:"ETH",total:5,free:3,used:2,usdValue:11728},{exchange:"hyperliquid",currency:"USDC",total:1e4,free:8e3,used:2e3,usdValue:1e4}];x.push(...m),r(x);const b=new Map;for(const C of x){b.has(C.currency)||b.set(C.currency,{currency:C.currency,totalAmount:0,totalUsdValue:0,exchanges:[]});const T=b.get(C.currency);T.totalAmount+=C.total,T.totalUsdValue+=C.usdValue,T.exchanges.push({exchange:C.exchange,amount:C.total,usdValue:C.usdValue})}const w=Array.from(b.values());i(w);const y=w.reduce((C,T)=>C+T.totalUsdValue,0);a(y)}catch(x){f(x?.message||"Failed to fetch cross-exchange balances"),console.error("Cross-exchange balance error:",x)}finally{d(!1)}},[s]);return S.useEffect(()=>{h();const x=setInterval(h,3e4);return()=>clearInterval(x)},[h]),{balances:e,aggregatedBalances:n,totalPortfolioValue:o,isLoading:l,error:p,refresh:h}}function bJ(s=["BTC/USDC","ETH/USDC"]){const{availableBrokers:e}=Hn(),[r,n]=S.useState([]),[i,o]=S.useState(!1),[a,l]=S.useState(null),d=S.useCallback(async()=>{o(!0);try{const p=[],h=[{symbol:"BTC/USDC",buyExchange:"hyperliquid",sellExchange:"kraken",buyPrice:43150.5,sellPrice:43285.75,spread:135.25,spreadPercent:.31,potentialProfit:135.25,timestamp:Date.now()},{symbol:"ETH/USDC",buyExchange:"kraken",sellExchange:"hyperliquid",buyPrice:2340.25,sellPrice:2358.5,spread:18.25,spreadPercent:.78,potentialProfit:18.25,timestamp:Date.now()}].filter(x=>x.spreadPercent>.2);p.push(...h),n(p),l(Date.now())}catch(p){console.error("Arbitrage scan error:",p)}finally{o(!1)}},[s,e]);return S.useEffect(()=>{d();const p=setInterval(d,1e4);return()=>clearInterval(p)},[d]),{opportunities:r,isScanning:i,lastScanTime:a,scan:d}}function vJ(){const{aggregatedBalances:s,totalPortfolioValue:e,isLoading:r,error:n,refresh:i}=yJ(),o=l=>l.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),a=(l,d=4)=>l.toLocaleString("en-US",{minimumFractionDigits:d,maximumFractionDigits:d});return r?t.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(ni,{className:"w-6 h-6 text-blue-500 animate-spin"})})}):n?t.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:t.jsx("div",{className:"text-center py-8 text-red-500",children:n})}):t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Jg,{className:"w-5 h-5 text-blue-500"}),t.jsx("span",{className:"text-lg font-semibold text-white",children:"Cross-Exchange Portfolio"})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("button",{onClick:i,className:"px-3 py-1 text-xs text-blue-400 hover:text-blue-300 border border-blue-500/30 hover:border-blue-400/50 rounded transition flex items-center gap-1",children:[t.jsx(xn,{className:"w-3 h-3"}),"Refresh"]})})]}),t.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"Total Portfolio Value"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"text-3xl font-bold text-white",children:["$",o(e)]}),t.jsxs("div",{className:"flex items-center gap-1 text-green-500 text-sm",children:[t.jsx(Nr,{className:"w-4 h-4"}),t.jsx("span",{children:"+2.45%"})]})]}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Across ",s.length," assets"]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"text-sm font-semibold text-gray-400 mb-3",children:"Asset Breakdown"}),s.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(Hb,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("div",{className:"text-sm",children:"No balances found"})]}):s.sort((l,d)=>d.totalUsdValue-l.totalUsdValue).map(l=>t.jsxs("div",{className:"p-4 bg-gray-800/50 border border-gray-700 rounded hover:border-gray-600 transition",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-sm",children:l.currency.substring(0,2)}),t.jsxs("div",{children:[t.jsx("div",{className:"text-white font-semibold",children:l.currency}),t.jsxs("div",{className:"text-xs text-gray-500",children:[a(l.totalAmount)," ",l.currency]})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-white font-semibold",children:["$",o(l.totalUsdValue)]}),t.jsxs("div",{className:"text-xs text-gray-500",children:[(l.totalUsdValue/e*100).toFixed(2),"%"]})]})]}),t.jsx("div",{className:"space-y-2 pl-13",children:l.exchanges.map((d,p)=>t.jsxs("div",{className:"flex items-center justify-between text-xs p-2 bg-black/20 rounded",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"px-2 py-0.5 bg-gray-700 rounded text-gray-300 capitalize",children:d.exchange}),t.jsxs("span",{className:"text-gray-400",children:[a(d.amount)," ",l.currency]})]}),t.jsxs("span",{className:"text-gray-300",children:["$",o(d.usdValue)]})]},p))}),t.jsx("div",{className:"mt-3 h-2 bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all",style:{width:`${l.totalUsdValue/e*100}%`}})})]},l.currency))]}),t.jsx("div",{className:"mt-6 p-3 bg-blue-500/10 border border-blue-500/20 rounded",children:t.jsxs("div",{className:"text-xs text-blue-400",children:[t.jsx("strong",{children:"Note:"})," This view aggregates balances from all connected exchanges. Values are updated every 30 seconds. Exchange-specific details are shown for each asset."]})})]})}function SJ(){const{opportunities:s,isScanning:e,lastScanTime:r,scan:n}=bJ(),i=a=>a.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),o=a=>{const l=Math.floor((Date.now()-a)/1e3);if(l<60)return`${l}s ago`;const d=Math.floor(l/60);return d<60?`${d}m ago`:`${Math.floor(d/60)}h ago`};return t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(si,{className:"w-5 h-5 text-yellow-500"}),t.jsx("span",{className:"text-lg font-semibold text-white",children:"Arbitrage Opportunities"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[r&&t.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[t.jsx(uo,{className:"w-3 h-3"}),o(r)]}),t.jsxs("button",{onClick:n,disabled:e,className:"px-3 py-1 text-xs text-yellow-400 hover:text-yellow-300 border border-yellow-500/30 hover:border-yellow-400/50 rounded transition flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(xn,{className:`w-3 h-3 ${e?"animate-spin":""}`}),e?"Scanning...":"Scan"]})]})]}),t.jsxs("div",{className:"mb-6 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded flex items-start gap-2",children:[t.jsx(Cl,{className:"w-4 h-4 text-yellow-500 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-xs text-yellow-400",children:[t.jsx("strong",{children:"Risk Warning:"})," Arbitrage opportunities include trading fees, withdrawal fees, and execution risk. Always calculate net profit after all costs. Prices can change rapidly."]})]}),e&&t.jsxs("div",{className:"mb-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded flex items-center gap-2",children:[t.jsx(ni,{className:"w-4 h-4 text-blue-500 animate-spin"}),t.jsx("span",{className:"text-sm text-blue-400",children:"Scanning for arbitrage opportunities..."})]}),t.jsx("div",{className:"space-y-3",children:s.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(si,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("div",{className:"text-sm",children:"No arbitrage opportunities found"}),t.jsx("div",{className:"text-xs mt-1",children:"Spread must be > 0.2% to be considered viable"})]}):s.map((a,l)=>t.jsxs("div",{className:"p-4 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 border-2 border-yellow-500/30 rounded hover:border-yellow-400/50 transition",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[t.jsx(si,{className:"w-5 h-5 fill-current"}),t.jsx("span",{className:"text-lg font-bold text-white",children:a.symbol})]}),t.jsxs("div",{className:"px-2 py-0.5 bg-yellow-500/20 border border-yellow-500/30 rounded text-xs text-yellow-400 font-semibold",children:[a.spreadPercent.toFixed(2),"% Spread"]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm text-gray-400",children:"Potential Profit"}),t.jsxs("div",{className:"text-xl font-bold text-green-500",children:["$",a.potentialProfit.toFixed(2)]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[t.jsxs("div",{className:"p-3 bg-green-500/10 border border-green-500/20 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"BUY ON"}),t.jsx("div",{className:"text-sm font-semibold text-white capitalize mb-2",children:a.buyExchange}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Nr,{className:"w-4 h-4 text-green-500"}),t.jsxs("span",{className:"text-lg font-bold text-green-500",children:["$",i(a.buyPrice)]})]})]}),t.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded",children:[t.jsx("div",{className:"text-xs text-gray-400 mb-1",children:"SELL ON"}),t.jsx("div",{className:"text-sm font-semibold text-white capitalize mb-2",children:a.sellExchange}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Nr,{className:"w-4 h-4 text-red-500 rotate-180"}),t.jsxs("span",{className:"text-lg font-bold text-red-500",children:["$",i(a.sellPrice)]})]})]})]}),t.jsx("div",{className:"p-2 bg-black/30 rounded mb-3",children:t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-gray-400",children:"Price Difference:"}),t.jsxs("span",{className:"text-white font-semibold",children:["$",a.spread.toFixed(2)]})]})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-semibold rounded transition flex items-center justify-center gap-1",children:[t.jsx(Nr,{className:"w-4 h-4"}),"Execute Arbitrage"]}),t.jsx("button",{className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded transition",children:t.jsx(Nd,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"mt-2 text-xs text-gray-500 text-center",children:["Detected ",o(a.timestamp)]})]},l))}),t.jsxs("div",{className:"mt-6 space-y-2",children:[t.jsxs("div",{className:"p-3 bg-gray-800/50 border border-gray-700 rounded",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-300 mb-2",children:"How It Works"}),t.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[t.jsxs("div",{children:["1. ",t.jsx("strong",{children:"Buy"})," the asset on the exchange with the lower price"]}),t.jsxs("div",{children:["2. ",t.jsx("strong",{children:"Transfer"})," the asset to the exchange with the higher price"]}),t.jsxs("div",{children:["3. ",t.jsx("strong",{children:"Sell"})," the asset for profit"]})]})]}),t.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded",children:t.jsxs("div",{className:"text-xs text-blue-400",children:[t.jsx("strong",{children:"Cost Considerations:"})," Factor in trading fees (maker/taker), withdrawal fees, network fees, and execution time. The spread must exceed total costs for profitable arbitrage."]})}),t.jsx("div",{className:"p-3 bg-purple-500/10 border border-purple-500/20 rounded",children:t.jsxs("div",{className:"text-xs text-purple-400",children:[t.jsx("strong",{children:"Auto-Scan:"}),' Opportunities are automatically scanned every 10 seconds. Click "Scan" to manually refresh.']})})]})]})}class wJ{async getApiKeysMap(){try{const e=await Je.getLLMConfigs(),r={};return e.forEach(n=>{if(n.api_key){const i=n.provider.toLowerCase();let o=i;i==="gemini"&&(o="google",r.GEMINI_API_KEY=n.api_key);const a=`${o.toUpperCase()}_API_KEY`;r[a]=n.api_key}}),r}catch(e){return console.warn("Failed to load API keys:",e),{}}}async listModels(e){await this.syncApiKeys();try{const r=await lt("agno_list_models",{provider:e});return JSON.parse(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:String(r)}}}async recommendModel(e,r="medium",n=!1){try{const i=await lt("agno_recommend_model",{task:e,budget:r,reasoning:n});return JSON.parse(i)}catch(i){return{success:!1,error:i instanceof Error?i.message:String(i)}}}async validateConfig(e){try{const r=await lt("agno_validate_config",{configJson:JSON.stringify(e)});return JSON.parse(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:String(r)}}}async createAgent(e){try{const r=await lt("agno_create_agent",{agentConfigJson:JSON.stringify(e)});return JSON.parse(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:String(r)}}}async runAgent(e,r,n){try{const i=await lt("agno_run_agent",{agentId:e,prompt:r,sessionId:n});return JSON.parse(i)}catch(i){return{success:!1,error:i instanceof Error?i.message:String(i)}}}async analyzeMarket(e,r="openai:gpt-4o-mini",n="comprehensive"){try{const i=await this.getApiKeysMap(),o=await lt("agno_analyze_market",{symbol:e,agentModel:r,analysisType:n,apiKeysJson:JSON.stringify(i)});return JSON.parse(o)}catch(i){return{success:!1,error:i instanceof Error?i.message:String(i)}}}async generateTradeSignal(e,r="momentum",n="anthropic:claude-sonnet-4",i){try{const o=await this.getApiKeysMap(),a=await lt("agno_generate_trade_signal",{symbol:e,strategy:r,agentModel:n,marketData:i?JSON.stringify(i):void 0,apiKeysJson:JSON.stringify(o)});return JSON.parse(a)}catch(o){return{success:!1,error:o instanceof Error?o.message:String(o)}}}async manageRisk(e,r="openai:gpt-4",n="moderate"){try{const i=await this.getApiKeysMap(),o=await lt("agno_manage_risk",{portfolioData:JSON.stringify(e),agentModel:r,riskTolerance:n,apiKeysJson:JSON.stringify(i)});return JSON.parse(o)}catch(i){return{success:!1,error:i instanceof Error?i.message:String(i)}}}async getConfigTemplate(e="default"){try{const r=await lt("agno_get_config_template",{configType:e});return JSON.parse(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:String(r)}}}async createCompetition(e,r,n="trading"){try{const i=await this.getApiKeysMap(),o=await lt("agno_create_competition",{name:e,modelsJson:JSON.stringify(r),taskType:n,apiKeysJson:JSON.stringify(i)});return JSON.parse(o)}catch(i){return{success:!1,error:i instanceof Error?i.message:String(i)}}}async runCompetition(e,r,n="analyze"){try{const i=await this.getApiKeysMap(),o=await lt("agno_run_competition",{teamId:e,symbol:r,task:n,apiKeysJson:JSON.stringify(i)});return JSON.parse(o)}catch(i){return{success:!1,error:i instanceof Error?i.message:String(i)}}}async getLeaderboard(){try{const e=await lt("agno_get_leaderboard");return JSON.parse(e)}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}async getRecentDecisions(e=50){try{const r=await lt("agno_get_recent_decisions",{limit:e});return JSON.parse(r)}catch(r){return{success:!1,error:r instanceof Error?r.message:String(r)}}}async syncApiKeys(){try{const e=await this.getApiKeysMap();Object.keys(e).length>0&&await lt("agno_set_api_keys",{apiKeysJson:JSON.stringify(e)})}catch(e){console.warn("[AgnoService] Failed to sync API keys:",e)}}parseResponse(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return{success:!0,data:e}}return e}getAvailableProviders(){return["openai","anthropic","google","groq","deepseek","xai","ollama","cohere","mistral","together","fireworks"]}getAgentTypes(){return[{value:"market_analyst",label:"Market Analyst",description:"Technical analysis and market insights"},{value:"trading_strategy",label:"Trading Strategy",description:"Signal generation and trade recommendations"},{value:"risk_manager",label:"Risk Manager",description:"Portfolio risk assessment and position sizing"},{value:"portfolio_manager",label:"Portfolio Manager",description:"Asset allocation and portfolio optimization"},{value:"sentiment_analyst",label:"Sentiment Analyst",description:"Market sentiment and news analysis"},{value:"custom",label:"Custom Agent",description:"Create your own custom agent"}]}getTradingStrategies(){return[{value:"momentum",label:"Momentum",description:"Follow strong price trends with momentum indicators"},{value:"breakout",label:"Breakout",description:"Trade breakouts from consolidation zones"},{value:"reversal",label:"Reversal",description:"Identify trend reversals at key levels"},{value:"trend_following",label:"Trend Following",description:"Enter on pullbacks in established trends"}]}formatModelString(e,r){return`${e}:${r}`}parseModelString(e){const[r,n]=e.split(":");return{provider:r,model:n}}async executeTrade(e,r,n,i){try{const o=await this.getApiKeysMap(),a=await lt("agno_execute_trade",{signalJson:JSON.stringify(e),portfolioJson:JSON.stringify(r),agentId:n,model:i,apiKeysJson:JSON.stringify(o)});return this.parseResponse(a)}catch(o){return console.error("[AgnoService] Execute trade error:",o),{success:!1,error:o instanceof Error?o.message:String(o)}}}async closePosition(e,r,n="manual"){try{const i=await lt("agno_close_position",{tradeId:e,exitPrice:r,reason:n});return this.parseResponse(i)}catch(i){return console.error("[AgnoService] Close position error:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async getAgentTrades(e,r=100,n){try{const i=await lt("agno_get_agent_trades",{agentId:e,limit:r,status:n});return this.parseResponse(i)}catch(i){return console.error("[AgnoService] Get agent trades error:",i),{success:!1,error:i instanceof Error?i.message:String(i)}}}async getAgentPerformance(e){try{const r=await lt("agno_get_agent_performance",{agentId:e});return this.parseResponse(r)}catch(r){return console.error("[AgnoService] Get agent performance error:",r),{success:!1,error:r instanceof Error?r.message:String(r)}}}async getDbLeaderboard(e=20){try{const r=await lt("agno_get_db_leaderboard",{limit:e});return this.parseResponse(r)}catch(r){return console.error("[AgnoService] Get leaderboard error:",r),{success:!1,error:r instanceof Error?r.message:String(r)}}}async getDbDecisions(e=50,r){try{const n=await lt("agno_get_db_decisions",{limit:e,agentId:r});return this.parseResponse(n)}catch(n){return console.error("[AgnoService] Get decisions error:",n),{success:!1,error:n instanceof Error?n.message:String(n)}}}async runDebate(e,r,n,i,o){try{const a=await this.getApiKeysMap(),l=await lt("agno_run_debate",{symbol:e,marketDataJson:JSON.stringify(r),bullModel:n,bearModel:i,analystModel:o,apiKeysJson:JSON.stringify(a)});return this.parseResponse(l)}catch(a){return console.error("[AgnoService] Run debate error:",a),{success:!1,error:a instanceof Error?a.message:String(a)}}}async getRecentDebates(e=10){try{const r=await lt("agno_get_recent_debates",{limit:e});return this.parseResponse(r)}catch(r){return console.error("[AgnoService] Get debates error:",r),{success:!1,error:r instanceof Error?r.message:String(r)}}}async checkEvolution(e){try{const r=await lt("agno_check_evolution",{agentId:e});return this.parseResponse(r)}catch(r){return console.error("[AgnoService] Check evolution error:",r),{success:!1,error:r instanceof Error?r.message:String(r)}}}async evolveAgent(e,r,n,i,o){try{const a=await lt("agno_evolve_agent",{agentId:e,model:r,currentInstructionsJson:JSON.stringify(n),trigger:i,notes:o});return this.parseResponse(a)}catch(a){return console.error("[AgnoService] Evolve agent error:",a),{success:!1,error:a instanceof Error?a.message:String(a)}}}async getEvolutionSummary(e){try{const r=await lt("agno_get_evolution_summary",{agentId:e});return this.parseResponse(r)}catch(r){return console.error("[AgnoService] Get evolution summary error:",r),{success:!1,error:r instanceof Error?r.message:String(r)}}}}const Uo=new wJ,Kr={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",BORDER:"#2A2A2A"};function EJ({onAgentCreated:s}){const[e,r]=S.useState(""),[n,i]=S.useState("trading_strategy"),[o,a]=S.useState(""),[l,d]=S.useState("openai"),[p,f]=S.useState("gpt-4o-mini"),[h,x]=S.useState(.7),[m,b]=S.useState(["BTC/USD"]),[w,y]=S.useState(!1),[C,T]=S.useState(180),[E,j]=S.useState(.1),[k,A]=S.useState(1),[R,M]=S.useState(.15),[P,I]=S.useState(.05),[O,G]=S.useState(.6),[B,F]=S.useState(5),[z,$]=S.useState(!0),[W,D]=S.useState(2),[oe,Z]=S.useState(2),[fe,Q]=S.useState(5),[_,Y]=S.useState(!1),[he,me]=S.useState(1),[ge,le]=S.useState(!0),[X,V]=S.useState(!1),[de,je]=S.useState(""),[_e,Re]=S.useState(new Set(["basic","llm","trading"])),[Be,Se]=S.useState(!1),[ie,ve]=S.useState(null),Ae=Oe=>{const q=new Set(_e);q.has(Oe)?q.delete(Oe):q.add(Oe),Re(q)},$e=async()=>{Se(!0),ve(null);try{const Oe={name:e||"Trading Agent",role:qe(n),description:o||Ie(n),agent_model:`${l}:${p}`,temperature:h,tools:K(n),symbols:m,enable_memory:ge,risk_tolerance:Ee(),instructions:de.split(`
`).filter(ee=>ee.trim())},q=await Uo.createAgent(Oe);q.success&&q.data?s({...q.data,autoTrading:{enabled:w,interval:C,safety:{maxPositionSize:E,maxLeverage:k,maxDrawdown:R,maxDailyLoss:P,minConfidence:O,maxOpenPositions:B},tpsl:{dynamic:z,riskReward:W,slPercent:oe,tpPercent:fe,trailing:_,trailingPercent:he}}}):ve(q.error||"Failed to create agent")}catch(Oe){ve(Oe instanceof Error?Oe.message:"Unknown error")}finally{Se(!1)}},qe=Oe=>({market_analyst:"Market Analysis Specialist",trading_strategy:"Trading Strategy Expert",risk_manager:"Risk Management Specialist",portfolio_manager:"Portfolio Manager",sentiment_analyst:"Sentiment Analysis Expert"})[Oe]||"Trading Agent",Ie=Oe=>({market_analyst:"Analyzes market data, technical indicators, and trends to provide insights",trading_strategy:"Generates trade signals with entry/exit points and risk management",risk_manager:"Monitors portfolio risk and ensures compliance with safety limits",portfolio_manager:"Manages asset allocation and portfolio optimization",sentiment_analyst:"Analyzes market sentiment from news and social media"})[Oe]||"AI-powered trading agent",K=Oe=>({market_analyst:["market_data","technical_analysis"],trading_strategy:["market_data","technical_analysis","order_execution"],risk_manager:["portfolio","market_data"],portfolio_manager:["portfolio","market_data"],sentiment_analyst:["news_sentiment","market_data"]})[Oe]||["market_data"],Ee=()=>R<=.1?"conservative":R>=.2?"aggressive":"moderate";return t.jsx("div",{style:{padding:"8px",height:"100%",overflow:"auto"},children:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsx(hd,{title:"BASIC CONFIGURATION",icon:t.jsx(xi,{size:14}),expanded:_e.has("basic"),onToggle:()=>Ae("basic"),children:t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsx(A0,{label:"Agent Name",value:e,onChange:r,placeholder:"My Trading Agent"}),t.jsx(Wk,{label:"Agent Type",value:n,onChange:i,options:[{value:"market_analyst",label:"Market Analyst"},{value:"trading_strategy",label:"Trading Strategy"},{value:"risk_manager",label:"Risk Manager"},{value:"portfolio_manager",label:"Portfolio Manager"},{value:"sentiment_analyst",label:"Sentiment Analyst"}]}),t.jsx(qk,{label:"Description (Optional)",value:o,onChange:a,rows:2})]})}),t.jsx(hd,{title:"LLM CONFIGURATION",icon:t.jsx(qo,{size:14}),expanded:_e.has("llm"),onToggle:()=>Ae("llm"),children:t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsx(Wk,{label:"Provider",value:l,onChange:d,options:[{value:"openai",label:"OpenAI"},{value:"anthropic",label:"Anthropic"},{value:"google",label:"Google"},{value:"groq",label:"Groq (Fast & Free)"},{value:"deepseek",label:"DeepSeek"},{value:"xai",label:"xAI (Grok)"},{value:"ollama",label:"Ollama (Local)"}]}),t.jsx(A0,{label:"Model",value:p,onChange:f,placeholder:"gpt-4o-mini"})]}),t.jsx(eo,{label:"Temperature",value:h,onChange:x,min:0,max:1,step:.1,showValue:!0})]})}),t.jsx(hd,{title:"TRADING CONFIGURATION",icon:t.jsx(Nr,{size:14}),expanded:_e.has("trading"),onToggle:()=>Ae("trading"),children:t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsx(A0,{label:"Trading Symbols (comma-separated)",value:m.join(", "),onChange:Oe=>b(Oe.split(",").map(q=>q.trim())),placeholder:"BTC/USD, ETH/USD"}),t.jsx(gp,{label:"Enable Auto-Trading (Alpha Arena Mode)",checked:w,onChange:y,description:"Agent will execute trades automatically every few minutes"}),w&&t.jsx(eo,{label:"Execution Interval (seconds)",value:C,onChange:T,min:60,max:600,step:30,showValue:!0,description:"How often the agent makes trading decisions (Alpha Arena uses 180s)"})]})}),t.jsx(hd,{title:"SAFETY LIMITS",icon:t.jsx(jo,{size:14}),expanded:_e.has("safety"),onToggle:()=>Ae("safety"),children:t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsx(eo,{label:"Max Position Size (% of portfolio)",value:E*100,onChange:Oe=>j(Oe/100),min:1,max:50,step:1,showValue:!0,suffix:"%"}),t.jsx(eo,{label:"Max Leverage",value:k,onChange:A,min:1,max:10,step:.5,showValue:!0,suffix:"x"}),t.jsx(eo,{label:"Max Drawdown (circuit breaker)",value:R*100,onChange:Oe=>M(Oe/100),min:5,max:50,step:5,showValue:!0,suffix:"%",description:"Auto-trading stops if drawdown exceeds this"}),t.jsx(eo,{label:"Max Daily Loss",value:P*100,onChange:Oe=>I(Oe/100),min:1,max:20,step:1,showValue:!0,suffix:"%"}),t.jsx(eo,{label:"Min Confidence to Execute",value:O*100,onChange:Oe=>G(Oe/100),min:30,max:90,step:5,showValue:!0,suffix:"%",description:"Only execute trades above this confidence"}),t.jsx(eo,{label:"Max Open Positions",value:B,onChange:F,min:1,max:20,step:1,showValue:!0})]})}),t.jsx(hd,{title:"TAKE PROFIT / STOP LOSS",icon:t.jsx(ka,{size:14}),expanded:_e.has("tpsl"),onToggle:()=>Ae("tpsl"),children:t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsx(gp,{label:"Dynamic TP/SL (based on volatility)",checked:z,onChange:$,description:"Alpha Arena style - adjusts TP/SL based on current market volatility"}),z?t.jsx(eo,{label:"Risk/Reward Ratio",value:W,onChange:D,min:1,max:5,step:.5,showValue:!0,suffix:":1"}):t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsx(eo,{label:"Stop Loss %",value:oe,onChange:Z,min:.5,max:10,step:.5,showValue:!0,suffix:"%"}),t.jsx(eo,{label:"Take Profit %",value:fe,onChange:Q,min:1,max:20,step:.5,showValue:!0,suffix:"%"})]}),t.jsx(gp,{label:"Trailing Stop Loss",checked:_,onChange:Y,description:"Lock in profits as price moves favorably"}),_&&t.jsx(eo,{label:"Trailing Distance %",value:he,onChange:me,min:.5,max:5,step:.5,showValue:!0,suffix:"%"})]})}),t.jsx(hd,{title:"ADVANCED OPTIONS",icon:t.jsx(Mn,{size:14}),expanded:_e.has("advanced"),onToggle:()=>Ae("advanced"),children:t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsx(gp,{label:"Enable Memory",checked:ge,onChange:le,description:"Agent remembers past decisions and learns from them"}),t.jsx(gp,{label:"Enable Knowledge Base",checked:X,onChange:V,description:"Access to historical market data and patterns"}),t.jsx(qk,{label:"Custom Instructions (one per line)",value:de,onChange:je,rows:4,placeholder:`Always use risk management
Never trade during low volume
Focus on high confidence setups`})]})}),ie&&t.jsxs("div",{style:{background:`${Kr.RED}15`,border:`1px solid ${Kr.RED}`,borderRadius:"4px",padding:"12px",display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(Cl,{size:16,color:Kr.RED}),t.jsx("span",{style:{color:Kr.RED,fontSize:"11px"},children:ie})]}),t.jsxs("button",{onClick:$e,disabled:Be||!e,style:{background:`linear-gradient(135deg, ${Kr.GREEN} 0%, #00B359 100%)`,border:"none",color:Kr.DARK_BG,padding:"14px",borderRadius:"4px",fontSize:"12px",fontWeight:"700",cursor:Be||!e?"not-allowed":"pointer",opacity:Be||!e?.5:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"8px"},children:[t.jsx(ao,{size:16}),Be?"CREATING AGENT...":"CREATE AGENT"]})]})})}function hd({title:s,icon:e,expanded:r,onToggle:n,children:i}){return t.jsxs("div",{style:{background:Kr.PANEL_BG,border:`1px solid ${Kr.BORDER}`,borderRadius:"4px",overflow:"hidden"},children:[t.jsxs("div",{onClick:n,style:{background:Kr.HEADER_BG,padding:"10px 12px",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",borderBottom:r?`1px solid ${Kr.BORDER}`:"none"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:Kr.ORANGE},children:e}),t.jsx("span",{style:{color:Kr.WHITE,fontSize:"11px",fontWeight:"700"},children:s})]}),r?t.jsx(Hp,{size:14,color:Kr.GRAY}):t.jsx(bi,{size:14,color:Kr.GRAY})]}),r&&t.jsx("div",{style:{padding:"12px"},children:i})]})}function A0({label:s,value:e,onChange:r,placeholder:n="",type:i="text"}){return t.jsxs("div",{children:[t.jsx("label",{style:{color:Kr.GRAY,fontSize:"10px",fontWeight:"600",display:"block",marginBottom:"4px"},children:s}),t.jsx("input",{type:i,value:e,onChange:o=>r(o.target.value),placeholder:n,style:{width:"100%",background:Kr.DARK_BG,border:`1px solid ${Kr.BORDER}`,color:Kr.WHITE,padding:"8px",borderRadius:"3px",fontSize:"11px"}})]})}function Wk({label:s,value:e,onChange:r,options:n}){return t.jsxs("div",{children:[t.jsx("label",{style:{color:Kr.GRAY,fontSize:"10px",fontWeight:"600",display:"block",marginBottom:"4px"},children:s}),t.jsx("select",{value:e,onChange:i=>r(i.target.value),style:{width:"100%",background:Kr.DARK_BG,border:`1px solid ${Kr.BORDER}`,color:Kr.WHITE,padding:"8px",borderRadius:"3px",fontSize:"11px",cursor:"pointer"},children:n.map(i=>t.jsx("option",{value:i.value,children:i.label},i.value))})]})}function qk({label:s,value:e,onChange:r,rows:n=3,placeholder:i=""}){return t.jsxs("div",{children:[t.jsx("label",{style:{color:Kr.GRAY,fontSize:"10px",fontWeight:"600",display:"block",marginBottom:"4px"},children:s}),t.jsx("textarea",{value:e,onChange:o=>r(o.target.value),rows:n,placeholder:i,style:{width:"100%",background:Kr.DARK_BG,border:`1px solid ${Kr.BORDER}`,color:Kr.WHITE,padding:"8px",borderRadius:"3px",fontSize:"11px",resize:"vertical",fontFamily:"inherit"}})]})}function gp({label:s,checked:e,onChange:r,description:n=""}){return t.jsxs("div",{children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:e,onChange:i=>r(i.target.checked),style:{cursor:"pointer"}}),t.jsx("span",{style:{color:Kr.WHITE,fontSize:"11px",fontWeight:"600"},children:s})]}),n&&t.jsx("p",{style:{color:Kr.GRAY,fontSize:"9px",marginTop:"4px",marginLeft:"24px"},children:n})]})}function eo({label:s,value:e,onChange:r,min:n,max:i,step:o,showValue:a,suffix:l="",description:d=""}){return t.jsxs("div",{children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[t.jsx("label",{style:{color:Kr.GRAY,fontSize:"10px",fontWeight:"600"},children:s}),a&&t.jsxs("span",{style:{color:Kr.CYAN,fontSize:"10px",fontWeight:"700"},children:[e,l]})]}),t.jsx("input",{type:"range",min:n,max:i,step:o,value:e,onChange:p=>r(parseFloat(p.target.value)),style:{width:"100%",cursor:"pointer",accentColor:Kr.ORANGE}}),d&&t.jsx("p",{style:{color:Kr.GRAY,fontSize:"9px",marginTop:"4px"},children:d})]})}const Rt={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",BLUE:"#0088FF",PURPLE:"#9D4EDD",BORDER:"#2A2A2A",HOVER:"#1F1F1F"};function CJ({selectedSymbol:s}){const[e,r]=S.useState(null),[n,i]=S.useState(!1),[o,a]=S.useState(!1),[l,d]=S.useState(null),[p,f]=S.useState(null),[h,x]=S.useState(!1),[m,b]=S.useState("AI Trading Competition"),[w,y]=S.useState([]),[C,T]=S.useState("analyze"),[E,j]=S.useState(!0),[k,A]=S.useState([]),R=B=>({openai:Rt.GREEN,anthropic:Rt.ORANGE,google:Rt.BLUE,groq:Rt.PURPLE,deepseek:Rt.CYAN,xai:Rt.YELLOW,together:Rt.PURPLE,mistral:Rt.BLUE,cohere:Rt.CYAN})[B.toLowerCase()]||Rt.GRAY;S.useEffect(()=>{(async()=>{try{console.log("[CompetitionPanel] Loading configured models...");const{sqliteService:F}=await Br(async()=>{const{sqliteService:W}=await Promise.resolve().then(()=>jd);return{sqliteService:W}},void 0),z=await F.getLLMConfigs();console.log("[CompetitionPanel] Raw configs:",z);const $=z.filter(W=>W.api_key&&W.api_key.trim().length>0).map(W=>({value:`${W.provider}:${W.model}`,label:`${W.provider.charAt(0).toUpperCase()+W.provider.slice(1)} - ${W.model}`,color:R(W.provider)}));if(console.log("[CompetitionPanel] Configured models:",$),A($),$.length>=3){const W=$.slice(0,3).map(D=>D.value);console.log("[CompetitionPanel] Auto-selecting first 3 models:",W),y(W)}else if($.length>=2){const W=$.slice(0,2).map(D=>D.value);console.log("[CompetitionPanel] Auto-selecting first 2 models:",W),y(W)}else console.warn("[CompetitionPanel] Not enough models configured for competition (need at least 2)")}catch(F){console.error("[CompetitionPanel] Failed to load configured models:",F),d("Failed to load configured models. Please configure API keys in Settings  LLM Config")}})()},[]);const M=async()=>{if(w.length<2){const B="Select at least 2 models to compete";console.error("[CompetitionPanel]",B),d(B);return}try{a(!0),d(null),console.log("[CompetitionPanel] Creating competition:",{name:m,models:w,type:"trading"});const B=await Uo.createCompetition(m,w,"trading");if(console.log("[CompetitionPanel] Create competition response:",B),B.success&&B.data)console.log("[CompetitionPanel] Competition created successfully. Team ID:",B.data.team_id),r(B.data.team_id),x(!1);else{const F=B.error||"Failed to create competition";console.error("[CompetitionPanel] Competition creation failed:",F),d(F)}}catch(B){console.error("[CompetitionPanel] Exception during competition creation:",B);const F=B instanceof Error?B.message:String(B);d(F)}finally{a(!1)}},P=async()=>{if(!e){console.error("[CompetitionPanel] No team ID available");return}try{a(!0),i(!0),d(null),console.log("[CompetitionPanel] Running competition:",{teamId:e,symbol:s,taskType:C});const B=await Uo.runCompetition(e,s,C);if(console.log("[CompetitionPanel] Run competition response:",B),B.success&&B.data)console.log("[CompetitionPanel] Competition completed successfully"),f(B.data);else{const F=B.error||"Competition failed";console.error("[CompetitionPanel] Competition run failed:",F),console.error("[CompetitionPanel] Full response:",JSON.stringify(B,null,2)),d(F)}}catch(B){console.error("[CompetitionPanel] Exception during competition run:",B),console.error("[CompetitionPanel] Error details:",{message:B instanceof Error?B.message:String(B),stack:B instanceof Error?B.stack:void 0,raw:B});const F=B instanceof Error?B.message:String(B);d(F)}finally{a(!1),i(!1)}},I=()=>{i(!1)},O=()=>{r(null),f(null),d(null),x(!0)};S.useEffect(()=>{if(!E||!e)return;const B=setInterval(async()=>{try{const F=await Uo.getLeaderboard();F.success&&F.data&&p&&f({...p,leaderboard:F.data.leaderboard})}catch(F){console.error("Failed to refresh leaderboard:",F)}},5e3);return()=>clearInterval(B)},[E,e,p]);const G=B=>{y(F=>{const z=F.includes(B)?F.filter($=>$!==B):[...F,B];return console.log("[CompetitionPanel] Model selection updated:",{toggled:B,wasPreviouslySelected:F.includes(B),previousSelection:F,newSelection:z}),z})};return t.jsxs("div",{style:{height:"100%",background:Rt.PANEL_BG,border:`1px solid ${Rt.BORDER}`,borderRadius:"2px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{background:Rt.HEADER_BG,borderBottom:`1px solid ${Rt.BORDER}`,padding:"8px 10px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(K0,{size:14,color:Rt.YELLOW}),t.jsx("span",{style:{color:Rt.WHITE,fontSize:"11px",fontWeight:"600",letterSpacing:"0.5px"},children:"COMPETITION"}),n&&t.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:Rt.GREEN,animation:"pulse 2s infinite"}})]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[!e&&t.jsxs("button",{onClick:()=>x(!h),style:{background:Rt.ORANGE,border:"none",color:Rt.DARK_BG,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"700",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(wn,{size:10}),"SETUP"]}),e&&!n&&t.jsxs("button",{onClick:P,disabled:o,style:{background:Rt.GREEN,border:"none",color:Rt.DARK_BG,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"700",cursor:o?"not-allowed":"pointer",opacity:o?.5:1,display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Ms,{size:10}),"RUN"]}),n&&t.jsxs("button",{onClick:I,style:{background:Rt.RED,border:"none",color:Rt.WHITE,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"700",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(xc,{size:10}),"STOP"]}),e&&t.jsx("button",{onClick:O,style:{background:"transparent",border:`1px solid ${Rt.BORDER}`,color:Rt.GRAY,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"700",cursor:"pointer"},children:"RESET"})]})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"10px"},children:[h&&!e&&t.jsx(jJ,{competitionName:m,setCompetitionName:b,selectedModels:w,toggleModel:G,availableModels:k,taskType:C,setTaskType:T,onCreateCompetition:M,isLoading:o}),e&&!h&&p&&t.jsx(kJ,{result:p,selectedSymbol:s}),!h&&!e&&!p&&t.jsxs("div",{style:{textAlign:"center",color:Rt.GRAY,fontSize:"10px",marginTop:"40px"},children:[t.jsx(K0,{size:40,color:Rt.GRAY,style:{marginBottom:"10px"}}),t.jsx("div",{children:"No active competition"}),t.jsx("div",{style:{marginTop:"4px",fontSize:"9px"},children:"Click SETUP to create one"})]}),l&&t.jsxs("div",{style:{background:`${Rt.RED}15`,border:`1px solid ${Rt.RED}`,borderRadius:"2px",padding:"8px",marginTop:"10px",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(Rr,{size:14,color:Rt.RED}),t.jsx("span",{style:{color:Rt.RED,fontSize:"10px"},children:l})]})]})]})}function jJ({competitionName:s,setCompetitionName:e,selectedModels:r,toggleModel:n,availableModels:i,taskType:o,setTaskType:a,onCreateCompetition:l,isLoading:d}){return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:Rt.GRAY,fontSize:"9px",display:"block",marginBottom:"4px"},children:"COMPETITION NAME"}),t.jsx("input",{type:"text",value:s,onChange:p=>e(p.target.value),style:{width:"100%",background:Rt.DARK_BG,border:`1px solid ${Rt.BORDER}`,color:Rt.WHITE,padding:"6px 8px",borderRadius:"2px",fontSize:"10px",fontFamily:'"IBM Plex Mono", monospace'}})]}),t.jsxs("div",{children:[t.jsxs("label",{style:{color:Rt.GRAY,fontSize:"9px",display:"block",marginBottom:"6px"},children:["SELECT MODELS (min 2) - ",i.length," Available"]}),i.length===0?t.jsx("div",{style:{background:`${Rt.YELLOW}15`,border:`1px solid ${Rt.YELLOW}`,borderRadius:"2px",padding:"8px",fontSize:"9px",color:Rt.YELLOW,textAlign:"center"},children:"No models configured. Go to Settings  LLM Config to add API keys."}):i.length<2?t.jsx("div",{style:{background:`${Rt.ORANGE}15`,border:`1px solid ${Rt.ORANGE}`,borderRadius:"2px",padding:"8px",fontSize:"9px",color:Rt.ORANGE,textAlign:"center"},children:"Need at least 2 models for competition. Configure more in Settings  LLM Config."}):t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:i.map(p=>{const f=r.includes(p.value);return t.jsxs("button",{onClick:()=>{console.log("[CompetitionPanel] Toggle model:",p.value,"Currently selected:",f),n(p.value)},style:{background:f?`${p.color}30`:Rt.DARK_BG,border:`2px solid ${f?p.color:Rt.BORDER}`,color:f?p.color:Rt.GRAY,padding:"8px 10px",borderRadius:"3px",fontSize:"9px",fontWeight:f?"700":"500",cursor:"pointer",transition:"all 0.2s",textAlign:"left",position:"relative",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:h=>{f||(h.currentTarget.style.background=Rt.HOVER,h.currentTarget.style.borderColor=p.color+"50")},onMouseLeave:h=>{f||(h.currentTarget.style.background=Rt.DARK_BG,h.currentTarget.style.borderColor=Rt.BORDER)},children:[t.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",border:`2px solid ${f?p.color:Rt.BORDER}`,background:f?p.color:"transparent",flexShrink:0,transition:"all 0.2s"}}),t.jsx("span",{children:p.label})]},p.value)})})]}),t.jsxs("div",{children:[t.jsx("label",{style:{color:Rt.GRAY,fontSize:"9px",display:"block",marginBottom:"4px"},children:"TASK TYPE"}),t.jsx("div",{style:{display:"flex",gap:"4px"},children:["analyze","signal","evaluate"].map(p=>t.jsx("button",{onClick:()=>a(p),style:{flex:1,background:o===p?Rt.ORANGE:"transparent",border:`1px solid ${o===p?Rt.ORANGE:Rt.BORDER}`,color:o===p?Rt.DARK_BG:Rt.GRAY,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"700",cursor:"pointer",transition:"all 0.2s",textTransform:"uppercase"},children:p},p))})]}),t.jsx("button",{onClick:l,disabled:d||r.length<2,style:{background:Rt.ORANGE,border:"none",color:Rt.DARK_BG,padding:"10px",borderRadius:"2px",fontSize:"10px",fontWeight:"700",cursor:d||r.length<2?"not-allowed":"pointer",opacity:d||r.length<2?.5:1,marginTop:"8px"},children:d?"CREATING...":"CREATE COMPETITION"})]})}function kJ({result:s,selectedSymbol:e}){return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[s.consensus&&t.jsxs("div",{style:{background:Rt.DARK_BG,border:`1px solid ${Rt.BORDER}`,borderRadius:"2px",padding:"10px"},children:[t.jsx("div",{style:{color:Rt.GRAY,fontSize:"9px",marginBottom:"6px"},children:"CONSENSUS"}),t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsx("span",{style:{color:Rt.WHITE,fontSize:"14px",fontWeight:"700",textTransform:"uppercase"},children:s.consensus.action}),t.jsxs("span",{style:{color:Rt.ORANGE,fontSize:"12px",fontWeight:"700"},children:[(s.consensus.confidence*100).toFixed(0),"% CONFIDENCE"]})]}),t.jsx("div",{style:{display:"flex",gap:"12px",fontSize:"9px",color:Rt.GRAY},children:t.jsxs("div",{children:["AGREEMENT: ",t.jsxs("span",{style:{color:Rt.WHITE,fontWeight:"600"},children:[s.consensus.agreement,"/",s.consensus.total_models]})]})})]}),t.jsxs("div",{style:{background:Rt.DARK_BG,border:`1px solid ${Rt.BORDER}`,borderRadius:"2px",padding:"10px"},children:[t.jsx("div",{style:{color:Rt.GRAY,fontSize:"9px",marginBottom:"8px"},children:"MODEL RESULTS"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:s.results.map((r,n)=>t.jsxs("div",{style:{background:Rt.PANEL_BG,border:`1px solid ${Rt.BORDER}`,borderRadius:"2px",padding:"8px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[t.jsx("span",{style:{color:Rt.ORANGE,fontSize:"10px",fontWeight:"700"},children:r.model.split(":")[1]||r.model}),t.jsx("span",{style:{color:Rt.GRAY,fontSize:"8px"},children:new Date(r.timestamp).toLocaleTimeString()})]}),t.jsxs("div",{style:{color:Rt.WHITE,fontSize:"9px",lineHeight:"1.4"},children:[r.response.substring(0,150),"..."]})]},n))})]}),s.leaderboard&&s.leaderboard.length>0&&t.jsxs("div",{style:{background:Rt.DARK_BG,border:`1px solid ${Rt.BORDER}`,borderRadius:"2px",padding:"10px"},children:[t.jsx("div",{style:{color:Rt.GRAY,fontSize:"9px",marginBottom:"8px"},children:"LEADERBOARD"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:s.leaderboard.slice(0,5).map((r,n)=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px",background:Rt.PANEL_BG,border:`1px solid ${Rt.BORDER}`,borderRadius:"2px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsxs("span",{style:{color:n===0?Rt.YELLOW:Rt.GRAY,fontSize:"10px",fontWeight:"700"},children:["#",n+1]}),t.jsx("span",{style:{color:Rt.WHITE,fontSize:"10px"},children:r.model.split(":")[1]})]}),t.jsxs("span",{style:{color:r.total_pnl>=0?Rt.GREEN:Rt.RED,fontSize:"10px",fontWeight:"700"},children:[r.total_pnl>=0?"+":"",r.total_pnl.toFixed(2)]})]},r.model))})]})]})}const et={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",BLUE:"#0088FF",PURPLE:"#9D4EDD",BORDER:"#2A2A2A"};function AJ({selectedSymbol:s,portfolioData:e}){const[r,n]=S.useState("quick-actions"),[i,o]=S.useState(!1),[a,l]=S.useState(null),[d,p]=S.useState(null),[f,h]=S.useState("openai:gpt-4o-mini"),[x,m]=S.useState("comprehensive"),[b,w]=S.useState("momentum"),[y,C]=S.useState(!1),[T,E]=S.useState([]),[j,k]=S.useState([]),[A,R]=S.useState(null);S.useEffect(()=>{(async()=>{try{const{sqliteService:F}=await Br(async()=>{const{sqliteService:W}=await Promise.resolve().then(()=>jd);return{sqliteService:W}},void 0),$=(await F.getLLMConfigs()).filter(W=>W.api_key&&W.api_key.trim().length>0);if(C($.length>0),$.length>0){const W=$.map(D=>({value:`${D.provider}:${D.model}`,label:`${D.provider.charAt(0).toUpperCase()+D.provider.slice(1)} - ${D.model}`}));E(W),h(W[0].value)}}catch(F){console.error("Failed to check API keys:",F)}})()},[]);const M=async()=>{o(!0),p(null),l(null);try{const B=await Uo.analyzeMarket(s,f,x);B.success&&B.data?l({type:"market_analysis",data:B.data}):p(B.error||"Analysis failed")}catch(B){p(B instanceof Error?B.message:"Unknown error")}finally{o(!1)}},P=async()=>{o(!0),p(null),l(null);try{const B=await Uo.generateTradeSignal(s,b,f);B.success&&B.data?l({type:"trade_signal",data:B.data}):p(B.error||"Signal generation failed")}catch(B){p(B instanceof Error?B.message:"Unknown error")}finally{o(!1)}},I=async()=>{if(!e){p("Portfolio data not available");return}o(!0),p(null),l(null);try{const B=await Uo.manageRisk(e,f,"moderate");B.success&&B.data?l({type:"risk_analysis",data:B.data}):p(B.error||"Risk analysis failed")}catch(B){p(B instanceof Error?B.message:"Unknown error")}finally{o(!1)}},O=async()=>{if(T.length<2){p("Need at least 2 configured models to start a competition");return}o(!0),p(null),l(null);try{const B=T.map(W=>W.value),F=await Uo.createCompetition(`${s}_${Date.now()}`,B,"trading");if(!F.success||!F.data)throw new Error(F.error||"Failed to create competition");const z=F.data.team_id,$=await Uo.runCompetition(z,s,"analyze");$.success&&$.data?l({type:"competition",data:$.data}):p($.error||"Competition failed")}catch(B){p(B instanceof Error?B.message:"Unknown error")}finally{o(!1)}},G=async()=>{if(!a||a.type!=="trade_signal"){p("Generate a trade signal first");return}if(!e){p("Portfolio data not available");return}o(!0),p(null);try{const B=a.data,F={total_value:e.total_value,positions:e.positions||[],daily_pnl:0},z=await Uo.executeTrade(B,F,"quick_action_agent",f);z.success&&z.data?l({type:"trade_execution",data:z.data}):p(z.error||"Trade execution failed")}catch(B){p(B instanceof Error?B.message:"Unknown error")}finally{o(!1)}};return t.jsxs("div",{style:{background:et.PANEL_BG,border:`1px solid ${et.BORDER}`,borderRadius:"4px",height:"100%",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{background:et.HEADER_BG,borderBottom:`1px solid ${et.BORDER}`,padding:"6px 8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(_d,{size:14,color:et.ORANGE}),t.jsx("h3",{style:{color:et.WHITE,fontSize:"11px",fontWeight:"600",margin:0,letterSpacing:"0.5px"},children:"AI AGENTS"})]}),t.jsxs("div",{style:{display:"flex",gap:"3px"},children:[t.jsx("button",{onClick:()=>n("quick-actions"),style:{background:r==="quick-actions"?et.ORANGE:"transparent",color:r==="quick-actions"?et.DARK_BG:et.GRAY,border:`1px solid ${r==="quick-actions"?et.ORANGE:et.BORDER}`,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",letterSpacing:"0.3px"},children:"QUICK"}),t.jsx("button",{onClick:()=>n("create-agent"),style:{background:r==="create-agent"?et.ORANGE:"transparent",color:r==="create-agent"?et.DARK_BG:et.GRAY,border:`1px solid ${r==="create-agent"?et.ORANGE:et.BORDER}`,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",letterSpacing:"0.3px"},children:"CREATE"}),t.jsx("button",{onClick:()=>n("manage-agents"),style:{background:r==="manage-agents"?et.ORANGE:"transparent",color:r==="manage-agents"?et.DARK_BG:et.GRAY,border:`1px solid ${r==="manage-agents"?et.ORANGE:et.BORDER}`,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",letterSpacing:"0.3px"},children:"MANAGE"}),t.jsx("button",{onClick:()=>n("competition"),style:{background:r==="competition"?et.ORANGE:"transparent",color:r==="competition"?et.DARK_BG:et.GRAY,border:`1px solid ${r==="competition"?et.ORANGE:et.BORDER}`,padding:"4px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:"pointer",transition:"all 0.15s",letterSpacing:"0.3px"},children:"COMPETE"})]})]}),t.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:[r==="quick-actions"&&t.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:t.jsx(TJ,{selectedSymbol:s,selectedModel:f,setSelectedModel:h,analysisType:x,setAnalysisType:m,strategy:b,setStrategy:w,isLoading:i,result:a,error:d,hasConfiguredKeys:y,availableModels:T,onAnalyzeMarket:M,onGenerateSignal:P,onAssessRisk:I,onStartCompetition:O,onExecuteTrade:G})}),r==="create-agent"&&t.jsx("div",{style:{flex:1,overflow:"auto"},children:t.jsx(RJ,{selectedSymbol:s,onAgentCreated:B=>{k([...j,B]),n("manage-agents")}})}),r==="manage-agents"&&t.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:t.jsx(NJ,{agents:j})}),r==="competition"&&t.jsx("div",{style:{flex:1,overflow:"hidden"},children:t.jsx(CJ,{selectedSymbol:s})})]})]})}function TJ({selectedSymbol:s,selectedModel:e,setSelectedModel:r,analysisType:n,setAnalysisType:i,strategy:o,setStrategy:a,isLoading:l,result:d,error:p,hasConfiguredKeys:f,availableModels:h,onAnalyzeMarket:x,onGenerateSignal:m,onAssessRisk:b,onStartCompetition:w,onExecuteTrade:y}){const C=h.length>0?h:[{value:"openai:gpt-4o-mini",label:"GPT-4o Mini (Configure in Settings)"},{value:"anthropic:claude-sonnet-4",label:"Claude Sonnet 4 (Configure in Settings)"},{value:"google:gemini-2.0-flash-exp",label:"Gemini 2.0 Flash (Configure in Settings)"}];return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t.jsxs("div",{children:[t.jsx("label",{style:{color:et.GRAY,fontSize:"9px",fontWeight:"600",display:"block",marginBottom:"4px",letterSpacing:"0.5px"},children:"MODEL"}),t.jsx("select",{value:e,onChange:T=>r(T.target.value),disabled:!f,style:{width:"100%",background:et.DARK_BG,border:`1px solid ${f?et.BORDER:et.RED}`,color:f?et.WHITE:et.GRAY,padding:"5px 8px",borderRadius:"2px",fontSize:"10px",cursor:f?"pointer":"not-allowed",fontFamily:'"IBM Plex Mono", monospace',opacity:f?1:.6},children:C.map(T=>t.jsx("option",{value:T.value,children:T.label},T.value))}),!f&&t.jsx("div",{style:{fontSize:"8px",color:et.RED,marginTop:"3px"},children:"Configure API keys in Settings  LLM Config"})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"6px"},children:[t.jsxs("div",{children:[t.jsxs("button",{onClick:x,disabled:l||!f,style:{width:"100%",background:f?et.BLUE:et.GRAY,border:`1px solid ${f?et.BLUE:et.GRAY}`,color:et.WHITE,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:l||!f?"not-allowed":"pointer",opacity:l||!f?.5:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",letterSpacing:"0.3px"},children:[l?t.jsx(Hs,{size:12,className:"animate-spin"}):t.jsx(qo,{size:12}),"ANALYZE"]}),t.jsxs("select",{value:n,onChange:T=>i(T.target.value),style:{width:"100%",background:et.DARK_BG,border:`1px solid ${et.BORDER}`,color:et.GRAY,padding:"4px 6px",borderRadius:"2px",fontSize:"9px",marginTop:"3px",cursor:"pointer"},children:[t.jsx("option",{value:"quick",children:"Quick"}),t.jsx("option",{value:"comprehensive",children:"Comprehensive"}),t.jsx("option",{value:"deep",children:"Deep"})]})]}),t.jsxs("div",{children:[t.jsxs("button",{onClick:m,disabled:l||!f,style:{width:"100%",background:f?et.GREEN:et.GRAY,border:`1px solid ${f?et.GREEN:et.GRAY}`,color:et.DARK_BG,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:l||!f?"not-allowed":"pointer",opacity:l||!f?.5:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",letterSpacing:"0.3px"},children:[l?t.jsx(Hs,{size:12,className:"animate-spin"}):t.jsx(ka,{size:12}),"SIGNAL"]}),t.jsxs("select",{value:o,onChange:T=>a(T.target.value),style:{width:"100%",background:et.DARK_BG,border:`1px solid ${et.BORDER}`,color:et.GRAY,padding:"4px 6px",borderRadius:"2px",fontSize:"9px",marginTop:"3px",cursor:"pointer"},children:[t.jsx("option",{value:"momentum",children:"Momentum"}),t.jsx("option",{value:"breakout",children:"Breakout"}),t.jsx("option",{value:"reversal",children:"Reversal"}),t.jsx("option",{value:"trend_following",children:"Trend"})]})]}),t.jsxs("button",{onClick:b,disabled:l||!f,style:{width:"100%",background:f?et.ORANGE:et.GRAY,border:`1px solid ${f?et.ORANGE:et.GRAY}`,color:et.DARK_BG,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:l||!f?"not-allowed":"pointer",opacity:l||!f?.5:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",letterSpacing:"0.3px"},children:[l?t.jsx(Hs,{size:12,className:"animate-spin"}):t.jsx(jo,{size:12}),"RISK"]}),t.jsxs("button",{onClick:w,disabled:l||h.length<2,style:{width:"100%",background:h.length>=2?et.PURPLE:et.GRAY,border:`1px solid ${h.length>=2?et.PURPLE:et.GRAY}`,color:et.WHITE,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:l||h.length<2?"not-allowed":"pointer",opacity:l||h.length<2?.5:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",letterSpacing:"0.3px"},children:[l?t.jsx(Hs,{size:12,className:"animate-spin"}):t.jsx(_d,{size:12}),"COMPETE"]})]}),!f&&t.jsx("div",{style:{fontSize:"8px",color:et.RED,marginTop:"4px",textAlign:"center"},children:"Configure API keys in Settings  LLM Config"}),f&&h.length<2&&t.jsx("div",{style:{fontSize:"8px",color:et.YELLOW,marginTop:"4px",textAlign:"center"},children:"Add 2+ models for multi-model competition"}),p&&t.jsxs("div",{style:{background:`${et.RED}10`,border:`1px solid ${et.RED}`,borderRadius:"2px",padding:"6px 8px",display:"flex",alignItems:"flex-start",gap:"6px"},children:[t.jsx(Rr,{size:12,color:et.RED,style:{flexShrink:0,marginTop:"1px"}}),t.jsxs("div",{children:[t.jsx("div",{style:{color:et.RED,fontSize:"9px",fontWeight:"600",letterSpacing:"0.3px"},children:"ERROR"}),t.jsx("div",{style:{color:et.GRAY,fontSize:"9px",marginTop:"2px",lineHeight:"1.4"},children:p})]})]}),d&&t.jsxs("div",{style:{background:et.DARK_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"8px",maxHeight:"300px",overflow:"auto"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px",paddingBottom:"6px",borderBottom:`1px solid ${et.BORDER}`},children:[t.jsx(Bn,{size:12,color:et.GREEN}),t.jsxs("span",{style:{color:et.GREEN,fontSize:"9px",fontWeight:"600",letterSpacing:"0.5px"},children:[d.type==="market_analysis"&&"MARKET ANALYSIS",d.type==="trade_signal"&&"TRADE SIGNAL",d.type==="risk_analysis"&&"RISK ASSESSMENT",d.type==="competition"&&"MULTI-MODEL COMPETITION",d.type==="trade_execution"&&"TRADE EXECUTED"]}),d.type==="trade_signal"&&t.jsxs("button",{onClick:y,disabled:l,style:{marginLeft:"auto",background:et.ORANGE,border:`1px solid ${et.ORANGE}`,color:et.DARK_BG,padding:"3px 8px",borderRadius:"2px",fontSize:"9px",fontWeight:"700",cursor:l?"not-allowed":"pointer",opacity:l?.5:1,display:"flex",alignItems:"center",gap:"3px",letterSpacing:"0.3px",transition:"all 0.2s"},children:[l?t.jsx(Hs,{size:10,className:"animate-spin"}):t.jsx(si,{size:10}),"EXECUTE"]})]}),d.type==="competition"?t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{color:et.ORANGE,fontSize:"8px",fontWeight:"700",marginBottom:"4px"},children:["CONSENSUS (",d.data.consensus.total_models," MODELS)"]}),t.jsxs("div",{style:{background:et.PANEL_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"6px",fontSize:"9px",color:et.WHITE},children:["Action: ",t.jsx("span",{style:{color:et.CYAN,fontWeight:"700"},children:d.data.consensus.action.toUpperCase()}),"  ","Confidence: ",t.jsxs("span",{style:{color:et.YELLOW,fontWeight:"700"},children:[(d.data.consensus.confidence*100).toFixed(0),"%"]}),"  ","Agreement: ",t.jsxs("span",{style:{color:et.GREEN,fontWeight:"700"},children:[d.data.consensus.agreement,"/",d.data.consensus.total_models]})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:et.ORANGE,fontSize:"8px",fontWeight:"700",marginBottom:"4px"},children:"MODEL DECISIONS"}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:d.data.results.map((T,E)=>t.jsxs("div",{style:{background:et.PANEL_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"4px 6px",fontSize:"9px"},children:[t.jsxs("span",{style:{color:et.CYAN,fontWeight:"700"},children:[T.model.split(":")[1]||T.model,":"]})," ",t.jsx("span",{style:{color:et.WHITE},children:T.decision?.action?.toUpperCase()||"ANALYZING..."})]},E))})]})]}):d.type==="trade_execution"?t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[d.data.success&&t.jsxs("div",{style:{background:`${et.GREEN}15`,border:`1px solid ${et.GREEN}`,borderRadius:"2px",padding:"6px",fontSize:"9px",color:et.GREEN},children:[" Trade executed successfully (Paper Trading)",d.data.trade_id&&t.jsxs("span",{style:{marginLeft:"6px"},children:["ID: ",d.data.trade_id]})]}),d.data.warnings&&d.data.warnings.length>0&&t.jsx("div",{style:{background:`${et.YELLOW}15`,border:`1px solid ${et.YELLOW}`,borderRadius:"2px",padding:"6px"},children:d.data.warnings.map((T,E)=>t.jsxs("div",{style:{fontSize:"8px",color:et.YELLOW,marginBottom:"2px"},children:[" ",T]},E))}),d.data.trade_data&&t.jsxs("div",{style:{background:et.PANEL_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"6px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px",fontSize:"9px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:et.GRAY},children:"Symbol:"}),t.jsx("span",{style:{color:et.WHITE,fontWeight:"700",marginLeft:"4px"},children:d.data.trade_data.symbol})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:et.GRAY},children:"Side:"}),t.jsx("span",{style:{color:d.data.trade_data.side==="buy"?et.GREEN:et.RED,fontWeight:"700",marginLeft:"4px",textTransform:"uppercase"},children:d.data.trade_data.side})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:et.GRAY},children:"Entry:"}),t.jsxs("span",{style:{color:et.CYAN,fontWeight:"700",marginLeft:"4px"},children:["$",d.data.trade_data.entry_price?.toFixed(2)]})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:et.GRAY},children:"Quantity:"}),t.jsx("span",{style:{color:et.WHITE,fontWeight:"700",marginLeft:"4px"},children:d.data.trade_data.quantity})]}),d.data.trade_data.stop_loss&&t.jsxs("div",{children:[t.jsx("span",{style:{color:et.GRAY},children:"Stop Loss:"}),t.jsxs("span",{style:{color:et.RED,fontWeight:"700",marginLeft:"4px"},children:["$",d.data.trade_data.stop_loss.toFixed(2)]})]}),d.data.trade_data.take_profit&&t.jsxs("div",{children:[t.jsx("span",{style:{color:et.GRAY},children:"Take Profit:"}),t.jsxs("span",{style:{color:et.GREEN,fontWeight:"700",marginLeft:"4px"},children:["$",d.data.trade_data.take_profit.toFixed(2)]})]})]}),d.data.execution_time_ms&&t.jsxs("div",{style:{fontSize:"8px",color:et.GRAY,textAlign:"right"},children:["Executed in ",d.data.execution_time_ms,"ms"]})]}):t.jsx("div",{style:{color:et.WHITE,fontSize:"10px",lineHeight:"1.5",whiteSpace:"pre-wrap",fontFamily:'"IBM Plex Mono", monospace'},children:d.data.analysis||d.data.signal||d.data.risk_analysis})]})]})}function RJ({selectedSymbol:s,onAgentCreated:e}){return t.jsx(EJ,{onAgentCreated:e})}function NJ({agents:s}){const[e,r]=S.useState([]),[n,i]=S.useState(null);S.useEffect(()=>{if(s.length>0){const x=s.map((m,b)=>({id:m.agent_id,name:m.config.name,type:m.config.role,status:b===0?"running":"stopped",autoTrading:b===0,metrics:{totalTrades:Math.floor(Math.random()*50),winningTrades:Math.floor(Math.random()*30),losingTrades:Math.floor(Math.random()*20),totalPnL:(Math.random()-.5)*5e3,dailyPnL:(Math.random()-.5)*500,currentDrawdown:Math.random()*.15,confidence:.6+Math.random()*.3},lastActivity:new Date().toISOString()}));r(x)}},[s]);const o=x=>{r(m=>m.map(b=>b.id===x?{...b,status:"running"}:b))},a=x=>{r(m=>m.map(b=>b.id===x?{...b,status:"paused"}:b))},l=x=>{r(m=>m.map(b=>b.id===x?{...b,status:"stopped",autoTrading:!1}:b))},d=()=>{r(x=>x.map(m=>({...m,status:"stopped",autoTrading:!1})))};if(s.length===0)return t.jsxs("div",{style:{color:et.GRAY,textAlign:"center",padding:"30px 12px"},children:[t.jsx(xi,{size:32,color:et.GRAY,style:{margin:"0 auto 10px"}}),t.jsx("div",{style:{fontSize:"11px",fontWeight:"600",marginBottom:"4px",letterSpacing:"0.5px"},children:"NO AGENTS"}),t.jsx("div",{style:{fontSize:"9px",lineHeight:"1.4"},children:"Create your first AI agent"})]});const p=e.filter(x=>x.status==="running").length,f=e.reduce((x,m)=>x+m.metrics.totalPnL,0),h=e.reduce((x,m)=>x+m.metrics.totalTrades,0);return t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"6px"},children:[t.jsxs("div",{style:{background:et.DARK_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"6px 8px"},children:[t.jsx("div",{style:{color:et.GRAY,fontSize:"8px",marginBottom:"3px",letterSpacing:"0.5px"},children:"ACTIVE"}),t.jsxs("div",{style:{color:et.WHITE,fontSize:"14px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace'},children:[p,"/",s.length]})]}),t.jsxs("div",{style:{background:et.DARK_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"6px 8px"},children:[t.jsx("div",{style:{color:et.GRAY,fontSize:"8px",marginBottom:"3px",letterSpacing:"0.5px"},children:"P&L"}),t.jsxs("div",{style:{color:f>=0?et.GREEN:et.RED,fontSize:"14px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace'},children:["$",f.toFixed(0)]})]}),t.jsxs("div",{style:{background:et.DARK_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"6px 8px"},children:[t.jsx("div",{style:{color:et.GRAY,fontSize:"8px",marginBottom:"3px",letterSpacing:"0.5px"},children:"TRADES"}),t.jsx("div",{style:{color:et.WHITE,fontSize:"14px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace'},children:h})]}),t.jsx("div",{style:{background:et.DARK_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"6px 8px"},children:t.jsxs("button",{onClick:d,disabled:p===0,style:{width:"100%",height:"100%",background:p>0?et.RED:"transparent",border:`1px solid ${p>0?et.RED:et.BORDER}`,color:p>0?et.WHITE:et.GRAY,borderRadius:"2px",fontSize:"8px",fontWeight:"600",cursor:p>0?"pointer":"not-allowed",display:"flex",alignItems:"center",justifyContent:"center",gap:"3px",letterSpacing:"0.3px"},children:[t.jsx(xc,{size:10}),"STOP"]})})]}),t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:e.map(x=>t.jsx(OJ,{agent:x,isExpanded:n===x.id,onToggleExpand:()=>i(n===x.id?null:x.id),onStart:()=>o(x.id),onPause:()=>a(x.id),onStop:()=>l(x.id)},x.id))})]})}function OJ({agent:s,isExpanded:e,onToggleExpand:r,onStart:n,onPause:i,onStop:o}){const a=s.metrics.totalTrades>0?s.metrics.winningTrades/s.metrics.totalTrades*100:0,l={running:et.GREEN,paused:et.YELLOW,stopped:et.GRAY}[s.status];return t.jsxs("div",{style:{background:et.DARK_BG,border:`1px solid ${s.status==="running"?et.GREEN:et.BORDER}`,borderRadius:"2px",overflow:"hidden"},children:[t.jsxs("div",{onClick:r,style:{padding:"6px 8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",background:s.status==="running"?`${et.GREEN}08`:"transparent"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flex:1},children:[t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:l,boxShadow:s.status==="running"?`0 0 6px ${l}`:"none"}}),t.jsxs("div",{style:{flex:1},children:[t.jsx("div",{style:{color:et.WHITE,fontSize:"10px",fontWeight:"600",marginBottom:"1px"},children:s.name}),t.jsxs("div",{style:{color:et.GRAY,fontSize:"8px"},children:[s.type.replace(/_/g," ").toUpperCase(),s.autoTrading&&t.jsx("span",{style:{color:et.ORANGE,marginLeft:"6px"},children:" AUTO"})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:et.GRAY,fontSize:"7px",letterSpacing:"0.5px"},children:"P&L"}),t.jsxs("div",{style:{color:s.metrics.totalPnL>=0?et.GREEN:et.RED,fontSize:"10px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace'},children:["$",s.metrics.totalPnL.toFixed(0)]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:et.GRAY,fontSize:"7px",letterSpacing:"0.5px"},children:"WIN"}),t.jsxs("div",{style:{color:et.WHITE,fontSize:"10px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace'},children:[a.toFixed(0),"%"]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:et.GRAY,fontSize:"7px",letterSpacing:"0.5px"},children:"TRD"}),t.jsx("div",{style:{color:et.WHITE,fontSize:"10px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace'},children:s.metrics.totalTrades})]})]})]}),e?t.jsx(Hp,{size:12,color:et.GRAY}):t.jsx(bi,{size:12,color:et.GRAY})]}),e&&t.jsxs("div",{style:{borderTop:`1px solid ${et.BORDER}`,padding:"8px",background:et.PANEL_BG},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"6px",marginBottom:"8px"},children:[t.jsx(fd,{label:"DAILY",value:`$${s.metrics.dailyPnL.toFixed(0)}`,color:s.metrics.dailyPnL>=0?et.GREEN:et.RED}),t.jsx(fd,{label:"DD",value:`${(s.metrics.currentDrawdown*100).toFixed(1)}%`,color:et.ORANGE}),t.jsx(fd,{label:"CONF",value:`${(s.metrics.confidence*100).toFixed(0)}%`,color:et.CYAN}),t.jsx(fd,{label:"WIN",value:s.metrics.winningTrades.toString(),color:et.GREEN}),t.jsx(fd,{label:"LOSS",value:s.metrics.losingTrades.toString(),color:et.RED}),t.jsx(fd,{label:"STATE",value:s.status.toUpperCase(),color:l})]}),t.jsxs("div",{style:{display:"flex",gap:"4px"},children:[s.status!=="running"&&t.jsxs("button",{onClick:n,style:{flex:1,background:et.GREEN,border:"none",color:et.DARK_BG,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",letterSpacing:"0.3px"},children:[t.jsx(Ms,{size:10}),"START"]}),s.status==="running"&&t.jsxs("button",{onClick:i,style:{flex:1,background:et.YELLOW,border:"none",color:et.DARK_BG,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",letterSpacing:"0.3px"},children:[t.jsx(TB,{size:10}),"PAUSE"]}),s.status!=="stopped"&&t.jsxs("button",{onClick:o,style:{flex:1,background:et.RED,border:"none",color:et.WHITE,padding:"6px",borderRadius:"2px",fontSize:"9px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",letterSpacing:"0.3px"},children:[t.jsx(xc,{size:10}),"STOP"]})]})]})]})}function fd({label:s,value:e,color:r}){return t.jsxs("div",{style:{background:et.DARK_BG,border:`1px solid ${et.BORDER}`,borderRadius:"2px",padding:"5px 6px"},children:[t.jsx("div",{style:{color:et.GRAY,fontSize:"7px",marginBottom:"2px",letterSpacing:"0.5px"},children:s}),t.jsx("div",{style:{color:r,fontSize:"11px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace'},children:e})]})}const _r={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",PURPLE:"#9D4EDD",BORDER:"#2A2A2A",MUTED:"#4A4A4A"};function _J({teamId:s,refreshInterval:e=5e3}){const[r,n]=S.useState([]),[i,o]=S.useState("all"),[a,l]=S.useState(!1),[d,p]=S.useState([]),f=S.useRef(null),h=()=>{f.current?.scrollIntoView({behavior:"smooth"})};S.useEffect(()=>{h()},[r]);const x=async()=>{try{l(!0);const{invoke:C}=await Br(async()=>{const{invoke:j}=await import("./tauri-vendor-CMSE6dGk.js").then(k=>k.c);return{invoke:j}},[]),T=await C("agno_get_recent_decisions",{limit:100}),E=JSON.parse(T);if(E.success&&E.data?.decisions){n(E.data.decisions);const j=[...new Set(E.data.decisions.map(k=>k.model))];p(j)}}catch(C){console.error("Failed to fetch decisions:",C)}finally{l(!1)}};S.useEffect(()=>{x();const C=setInterval(x,e);return()=>clearInterval(C)},[s,e]);const m=i==="all"?r:r.filter(C=>C.model===i),b=C=>{const T=[_r.ORANGE,_r.CYAN,_r.GREEN,_r.PURPLE,_r.YELLOW],E=C.split("").reduce((j,k)=>j+k.charCodeAt(0),0);return T[E%T.length]},w=C=>{switch(C){case"long":return _r.GREEN;case"short":return _r.RED;case"close":return _r.ORANGE;default:return _r.GRAY}},y=C=>{const T=new Date(C),j=Math.floor((new Date().getTime()-T.getTime())/1e3);return j<60?`${j}s ago`:j<3600?`${Math.floor(j/60)}m ago`:T.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return t.jsxs("div",{style:{height:"100%",background:_r.PANEL_BG,border:`1px solid ${_r.BORDER}`,borderRadius:"2px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{background:_r.HEADER_BG,borderBottom:`1px solid ${_r.BORDER}`,padding:"8px 10px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(qo,{size:14,color:_r.ORANGE}),t.jsx("span",{style:{color:_r.WHITE,fontSize:"11px",fontWeight:"600",letterSpacing:"0.5px"},children:"MODELCHAT"}),a&&t.jsx(cg,{size:8,color:_r.ORANGE,style:{animation:"pulse 2s infinite"}})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(F4,{size:12,color:_r.GRAY}),t.jsxs("select",{value:i,onChange:C=>o(C.target.value),style:{background:_r.DARK_BG,border:`1px solid ${_r.BORDER}`,color:_r.WHITE,padding:"3px 6px",borderRadius:"2px",fontSize:"9px",cursor:"pointer",fontFamily:'"IBM Plex Mono", monospace'},children:[t.jsx("option",{value:"all",children:"ALL MODELS"}),d.map(C=>t.jsx("option",{value:C,children:C},C))]})]})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"10px",display:"flex",flexDirection:"column",gap:"8px"},children:[m.length===0?t.jsx("div",{style:{textAlign:"center",color:_r.GRAY,fontSize:"10px",marginTop:"40px"},children:a?"Loading decisions...":"No decisions yet. Start a competition to see model reasoning."}):m.map((C,T)=>t.jsx(DJ,{decision:C,modelColor:b(C.model),actionColor:w(C.action),formatTimestamp:y},`${C.model}-${C.timestamp}-${T}`)),t.jsx("div",{ref:f})]})]})}function DJ({decision:s,modelColor:e,actionColor:r,formatTimestamp:n}){return t.jsxs("div",{style:{background:_r.DARK_BG,border:`1px solid ${_r.BORDER}`,borderLeft:`3px solid ${e}`,borderRadius:"2px",padding:"8px 10px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:e}}),t.jsx("span",{style:{color:e,fontSize:"10px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace',textTransform:"uppercase"},children:s.model.split(":")[1]||s.model}),s.action&&t.jsxs("div",{style:{background:`${r}20`,border:`1px solid ${r}`,borderRadius:"2px",padding:"2px 6px",display:"flex",alignItems:"center",gap:"3px"},children:[s.action==="long"?t.jsx(Nr,{size:10,color:r}):s.action==="short"?t.jsx(Dd,{size:10,color:r}):null,t.jsx("span",{style:{color:r,fontSize:"8px",fontWeight:"700",letterSpacing:"0.5px"},children:s.action.toUpperCase()})]}),s.symbol&&t.jsx("span",{style:{color:_r.GRAY,fontSize:"8px",fontFamily:'"IBM Plex Mono", monospace'},children:s.symbol})]}),t.jsx("span",{style:{color:_r.MUTED,fontSize:"8px",fontFamily:'"IBM Plex Mono", monospace'},children:n(s.timestamp)})]}),t.jsx("div",{style:{color:_r.WHITE,fontSize:"10px",lineHeight:"1.5",fontFamily:'"IBM Plex Mono", monospace',whiteSpace:"pre-wrap"},children:s.content}),(s.entry||s.target||s.stopLoss)&&t.jsxs("div",{style:{marginTop:"6px",paddingTop:"6px",borderTop:`1px solid ${_r.BORDER}`,display:"flex",gap:"12px",fontSize:"9px",fontFamily:'"IBM Plex Mono", monospace'},children:[s.entry&&t.jsxs("div",{children:[t.jsx("span",{style:{color:_r.GRAY},children:"ENTRY: "}),t.jsxs("span",{style:{color:_r.CYAN,fontWeight:"600"},children:["$",s.entry]})]}),s.target&&t.jsxs("div",{children:[t.jsx("span",{style:{color:_r.GRAY},children:"TARGET: "}),t.jsxs("span",{style:{color:_r.GREEN,fontWeight:"600"},children:["$",s.target]})]}),s.stopLoss&&t.jsxs("div",{children:[t.jsx("span",{style:{color:_r.GRAY},children:"STOP: "}),t.jsxs("span",{style:{color:_r.RED,fontWeight:"600"},children:["$",s.stopLoss]})]}),s.confidence&&t.jsxs("div",{children:[t.jsx("span",{style:{color:_r.GRAY},children:"CONF: "}),t.jsxs("span",{style:{color:_r.YELLOW,fontWeight:"600"},children:[(s.confidence*100).toFixed(0),"%"]})]})]})]})}const tr={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",PURPLE:"#9D4EDD",BORDER:"#2A2A2A"};function IJ({refreshInterval:s=1e4}){const[e,r]=S.useState([]),[n,i]=S.useState(!1),[o,a]=S.useState("pnl"),l=async()=>{try{i(!0);const{invoke:h}=await Br(async()=>{const{invoke:b}=await import("./tauri-vendor-CMSE6dGk.js").then(w=>w.c);return{invoke:b}},[]),x=await h("agno_get_leaderboard"),m=JSON.parse(x);m.success&&m.data?.leaderboard&&r(m.data.leaderboard)}catch(h){console.error("Failed to fetch leaderboard:",h)}finally{i(!1)}};S.useEffect(()=>{l();const h=setInterval(l,s);return()=>clearInterval(h)},[s]);const d=[...e].sort((h,x)=>{switch(o){case"pnl":return x.total_pnl-h.total_pnl;case"winrate":return x.win_rate-h.win_rate;case"trades":return x.total_trades-h.total_trades;default:return 0}}),p=h=>{switch(h){case 1:return tr.YELLOW;case 2:return tr.CYAN;case 3:return tr.ORANGE;default:return tr.GRAY}},f=h=>{const x=[tr.ORANGE,tr.CYAN,tr.GREEN,tr.PURPLE,tr.YELLOW],m=h.split("").reduce((b,w)=>b+w.charCodeAt(0),0);return x[m%x.length]};return t.jsxs("div",{style:{height:"100%",background:tr.PANEL_BG,border:`1px solid ${tr.BORDER}`,borderRadius:"2px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{background:tr.HEADER_BG,borderBottom:`1px solid ${tr.BORDER}`,padding:"8px 10px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(K0,{size:14,color:tr.YELLOW}),t.jsx("span",{style:{color:tr.WHITE,fontSize:"11px",fontWeight:"600",letterSpacing:"0.5px"},children:"LEADERBOARD"}),n&&t.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:tr.ORANGE,animation:"pulse 2s infinite"}})]}),t.jsx("div",{style:{display:"flex",gap:"4px"},children:[{value:"pnl",label:"P&L"},{value:"winrate",label:"WIN%"},{value:"trades",label:"TRADES"}].map(h=>t.jsx("button",{onClick:()=>a(h.value),style:{background:o===h.value?tr.ORANGE:"transparent",border:`1px solid ${o===h.value?tr.ORANGE:tr.BORDER}`,color:o===h.value?tr.DARK_BG:tr.GRAY,padding:"2px 6px",borderRadius:"2px",fontSize:"8px",fontWeight:"700",cursor:"pointer",transition:"all 0.2s"},children:h.label},h.value))})]}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"10px"},children:d.length===0?t.jsx("div",{style:{textAlign:"center",color:tr.GRAY,fontSize:"10px",marginTop:"40px"},children:n?"Loading leaderboard...":"No models yet. Create a competition to start tracking."}):t.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:d.map((h,x)=>t.jsx(PJ,{model:h,rank:x+1,rankColor:p(x+1),modelColor:f(h.model)},h.model))})})]})}function PJ({model:s,rank:e,rankColor:r,modelColor:n}){const i=s.total_pnl>=0;return t.jsxs("div",{style:{background:tr.DARK_BG,border:`1px solid ${tr.BORDER}`,borderLeft:`3px solid ${n}`,borderRadius:"2px",padding:"8px 10px",transition:"all 0.2s"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:e<=3?`${r}20`:"transparent",border:`2px solid ${r}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:"700",color:r},children:e}),t.jsx("span",{style:{color:n,fontSize:"10px",fontWeight:"700",fontFamily:'"IBM Plex Mono", monospace',textTransform:"uppercase"},children:s.model.split(":")[1]||s.model})]}),t.jsxs("div",{style:{background:i?`${tr.GREEN}20`:`${tr.RED}20`,border:`1px solid ${i?tr.GREEN:tr.RED}`,borderRadius:"2px",padding:"2px 6px",display:"flex",alignItems:"center",gap:"3px"},children:[i?t.jsx(Nr,{size:10,color:tr.GREEN}):t.jsx(Dd,{size:10,color:tr.RED}),t.jsxs("span",{style:{color:i?tr.GREEN:tr.RED,fontSize:"9px",fontWeight:"700"},children:[i?"+":"",s.total_pnl.toFixed(2)]})]})]}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",fontSize:"9px",fontFamily:'"IBM Plex Mono", monospace'},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:tr.GRAY,fontSize:"7px",marginBottom:"2px"},children:"WIN RATE"}),t.jsxs("div",{style:{color:s.win_rate>=50?tr.GREEN:tr.RED,fontWeight:"700",fontSize:"10px"},children:[s.win_rate.toFixed(1),"%"]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:tr.GRAY,fontSize:"7px",marginBottom:"2px"},children:"TRADES"}),t.jsx("div",{style:{color:tr.CYAN,fontWeight:"700",fontSize:"10px"},children:s.total_trades})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:tr.GRAY,fontSize:"7px",marginBottom:"2px"},children:"TODAY"}),t.jsxs("div",{style:{color:s.daily_pnl>=0?tr.GREEN:tr.RED,fontWeight:"700",fontSize:"10px"},children:[s.daily_pnl>=0?"+":"",s.daily_pnl.toFixed(2)]})]})]}),t.jsxs("div",{style:{marginTop:"8px",paddingTop:"6px",borderTop:`1px solid ${tr.BORDER}`,display:"flex",justifyContent:"space-between",fontSize:"8px",fontFamily:'"IBM Plex Mono", monospace'},children:[t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("span",{style:{color:tr.GRAY},children:"W: "}),t.jsx("span",{style:{color:tr.GREEN,fontWeight:"600"},children:s.winning_trades})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("span",{style:{color:tr.GRAY},children:"L: "}),t.jsx("span",{style:{color:tr.RED,fontWeight:"600"},children:s.losing_trades})]}),t.jsxs("div",{style:{display:"flex",gap:"8px"},children:[t.jsx("span",{style:{color:tr.GRAY},children:"POS: "}),t.jsx("span",{style:{color:tr.YELLOW,fontWeight:"600"},children:s.positions})]})]})]})}const Ue={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",PURPLE:"#9D4EDD",BORDER:"#2A2A2A",HOVER:"#1F1F1F",MUTED:"#4A4A4A"};function LJ(){const{activeBroker:s,availableBrokers:e,setActiveBroker:r,tradingMode:n,setTradingMode:i,paperPortfolioMode:o,setPaperPortfolioMode:a,activeAdapter:l,paperAdapter:d,defaultSymbols:p,isConnecting:f}=Hn(),[h,x]=S.useState(new Date),[m,b]=S.useState(p[0]||"BTC/USD"),[w,y]=S.useState(null),[C,T]=S.useState({bids:[],asks:[],symbol:""}),[E,j]=S.useState([]),[k,A]=S.useState(!1),[R,M]=S.useState(0),[P,I]=S.useState(""),[O,G]=S.useState([]),[B,F]=S.useState(!1),[z,$]=S.useState(!1),[W,D]=S.useState(!1),[oe,Z]=S.useState("chart"),[fe,Q]=S.useState("orderbook"),[_,Y]=S.useState("watchlist"),[he,me]=S.useState([]),[ge,le]=S.useState([]),[X,V]=S.useState([]),[de,je]=S.useState(0),[_e,Re]=S.useState(0),[Be,Se]=S.useState(null),[ie,ve]=S.useState("positions"),[Ae,$e]=S.useState(!1),[qe,Ie]=S.useState(0),[K,Ee]=S.useState(2e-4),[Oe,q]=S.useState(5e-4),[ee,ce]=S.useState(!1),[Ce,be]=S.useState(["BTC/USD","ETH/USD","BNB/USD","SOL/USD","XRP/USD","ADA/USD","DOGE/USD","AVAX/USD","DOT/USD","MATIC/USD","LTC/USD","SHIB/USD","TRX/USD","LINK/USD","UNI/USD","ATOM/USD","XLM/USD","ETC/USD","BCH/USD","NEAR/USD","APT/USD","ARB/USD","OP/USD","LDO/USD","FIL/USD","ICP/USD","INJ/USD","STX/USD","MKR/USD","AAVE/USD"]),[We,J]=S.useState({});S.useEffect(()=>{const U=setInterval(()=>{x(new Date)},1e3);return()=>clearInterval(U)},[]),S.useEffect(()=>{const U=async()=>{try{if(l&&typeof l.fetchTickers=="function")try{const xt=await l.fetchTickers(Ce),bt={};let Lt=!1;if(Ce.forEach(yt=>{const Pt=xt[yt];Pt&&Pt.last&&Pt.last>0&&(bt[yt]={price:Pt.last,change:Pt.percentage||0},Lt=!0)}),Lt){J(bt),console.log("[Watchlist] Successfully fetched prices from adapter");return}}catch(xt){console.warn("[Watchlist] fetchTickers failed, trying fallback API:",xt)}const xe=Ce.map(xt=>xt.replace("/USD","USDT").replace("/","")),Le=await fetch("https://api.binance.com/api/v3/ticker/24hr");if(!Le.ok)throw new Error(`Binance API returned ${Le.status}`);const ze=await Le.json();if(!Array.isArray(ze))throw new Error("Invalid response from Binance API");const Ge={};let Ze=!1;Ce.forEach((xt,bt)=>{const Lt=xe[bt],yt=ze.find(Pt=>Pt.symbol===Lt);if(yt&&yt.lastPrice){const Pt=parseFloat(yt.lastPrice),Et=parseFloat(yt.priceChangePercent);Pt>0&&(Ge[xt]={price:Pt,change:Et},Ze=!0)}}),Ze?(J(Ge),console.log("[Watchlist] Successfully fetched prices from Binance")):console.warn("[Watchlist] No valid data received, keeping existing prices")}catch(xe){console.error("[Watchlist] Failed to fetch prices:",xe),console.warn("[Watchlist] Keeping existing prices due to fetch error")}};U();const ne=setInterval(U,9e5);return()=>clearInterval(ne)},[l,Ce]),S.useEffect(()=>{y(null),T({bids:[],asks:[],symbol:m}),j([]),M(0)},[m]);const{message:se}=Jf(s?`${s}.ticker.${m}`:null),{message:Te}=Jf(s?`${s}.book.${m}`:null),{message:Me}=Jf(s?`${s}.trade.${m}`:null);S.useEffect(()=>{if(se&&se.data){const U=se.data;if(U.symbol===m&&(y(U),n==="paper"&&d)){const ne=d.matchingEngine;ne&&typeof ne.updatePriceFromWebSocket=="function"&&ne.updatePriceFromWebSocket(m,{bid:U.bid,ask:U.ask,last:U.last})}}},[se,n,d,m]),S.useEffect(()=>{if(!Te||!Te.data)return;const U=Te.data,ne=U.messageType,xe=U.symbol||m;xe===m&&(ne==="snapshot"?(T({bids:U.bids||[],asks:U.asks||[],symbol:xe,checksum:U.checksum}),M(Date.now())):ne==="update"&&T(Le=>{const ze={...Le};if(U.bids&&U.bids.length>0){const Ge=new Map(Le.bids.map(Ze=>[Ze.price,Ze.size]));U.bids.forEach(Ze=>{Ze.size===0?Ge.delete(Ze.price):Ge.set(Ze.price,Ze.size)}),ze.bids=Array.from(Ge.entries()).map(([Ze,xt])=>({price:Ze,size:xt})).sort((Ze,xt)=>xt.price-Ze.price).slice(0,25)}if(U.asks&&U.asks.length>0){const Ge=new Map(Le.asks.map(Ze=>[Ze.price,Ze.size]));U.asks.forEach(Ze=>{Ze.size===0?Ge.delete(Ze.price):Ge.set(Ze.price,Ze.size)}),ze.asks=Array.from(Ge.entries()).map(([Ze,xt])=>({price:Ze,size:xt})).sort((Ze,xt)=>Ze.price-xt.price).slice(0,25)}return ze.checksum=U.checksum,M(Date.now()),ze}))},[Te,m]),S.useEffect(()=>{if(Me&&Me.data){const U=Me.data;(U.symbol||m)===m&&j(xe=>[U,...xe].slice(0,50))}},[Me,m]),S.useEffect(()=>{const U=async()=>{if(!(n!=="paper"||!d))try{const xe=await d.fetchBalance(),Le=xe.free?.USD||0,ze=xe.total?.USD||0;je(Le),Re(ze);const Ze=(await d.fetchPositions()).map(yt=>({symbol:yt.symbol,side:yt.side,quantity:yt.contracts,entryPrice:yt.entryPrice,positionValue:yt.info?.positionValue||yt.entryPrice*yt.contracts,currentPrice:yt.markPrice,unrealizedPnl:yt.unrealizedPnl,pnlPercent:yt.percentage||0}));me(Ze);const bt=(await d.fetchOpenOrders()).map(yt=>({id:yt.id,symbol:yt.symbol,side:yt.side,type:yt.type,quantity:yt.amount,price:yt.price,status:yt.status,createdAt:yt.datetime}));le(bt);const Lt=await d.fetchMyTrades(void 0,void 0,50);if(V(Lt),typeof d.getStatistics=="function"){const yt=await d.getStatistics();Se(yt)}}catch(xe){console.error("[TradingTab] Failed to load paper trading data:",xe)}};U();const ne=setInterval(U,2e3);return()=>clearInterval(ne)},[n,d]),S.useEffect(()=>{d&&(d.paperConfig.slippage.market=qe,d.paperConfig.fees.maker=K,d.paperConfig.fees.taker=Oe)},[qe,K,Oe,d]),S.useEffect(()=>{(async()=>{if(l){F(!0);try{const xe=(await l.fetchMarkets()).filter(Le=>Le.active&&Le.spot&&(Le.quote==="USD"||Le.quote==="USDT"||Le.quote==="USDC")).map(Le=>Le.symbol).sort();G(xe)}catch{G(p)}finally{F(!1)}}})()},[l,p]),S.useCallback(async U=>{if(!d||!d.isConnected())throw alert("Paper trading adapter not available"),new Error("Adapter not available");A(!0);try{const ne=await d.createOrder(U.symbol,U.type,U.side,U.quantity,U.price,{stopPrice:U.stopPrice}),Le=(await d.fetchOpenOrders()).map(Ze=>({id:Ze.id,symbol:Ze.symbol,side:Ze.side,type:Ze.type,quantity:Ze.amount,price:Ze.price,status:Ze.status,createdAt:Ze.datetime}));le(Le);const Ge=(await d.fetchBalance()).free?.USD||0;je(Ge),alert(` Order placed: ${ne.id}`)}catch(ne){throw alert(` Order failed: ${ne.message}`),ne}finally{A(!1)}},[d]),S.useCallback(async(U,ne)=>{if(d)try{await d.cancelOrder(U,ne);const Le=(await d.fetchOpenOrders()).map(ze=>({id:ze.id,symbol:ze.symbol,side:ze.side,type:ze.type,quantity:ze.amount,price:ze.price,status:ze.status,createdAt:ze.datetime}));le(Le)}catch(xe){console.error("Cancel failed:",xe)}},[d]);const Qe=async U=>{D(!1),await r(U)},ye=w?.last||C.asks[0]?.price||0,ue=w?.change||w?.price_change||0;let re=w?.change_percent||w?.percentage||w?.percent_change||0;if(re===0&&w?.last&&w?.open&&w.open>0)re=(w.last-w.open)/w.open*100;else if(re===0&&ue!==0&&ye>0){const U=ye-ue;U>0&&(re=ue/U*100)}const ke=w?.high&&w?.low?w.high-w.low:0,Ne=ke>0&&w?.low&&w.low>0?ke/w.low*100:0;return t.jsxs("div",{style:{height:"100%",backgroundColor:Ue.DARK_BG,color:Ue.WHITE,fontFamily:'"IBM Plex Mono", "Consolas", monospace',overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap');

        *::-webkit-scrollbar { width: 6px; height: 6px; }
        *::-webkit-scrollbar-track { background: ${Ue.DARK_BG}; }
        *::-webkit-scrollbar-thumb { background: ${Ue.BORDER}; border-radius: 3px; }
        *::-webkit-scrollbar-thumb:hover { background: ${Ue.MUTED}; }

        .terminal-glow {
          text-shadow: 0 0 10px ${Ue.ORANGE}40;
        }

        .price-flash {
          animation: flash 0.3s ease-out;
        }

        @keyframes flash {
          0% { background-color: ${Ue.YELLOW}40; }
          100% { background-color: transparent; }
        }
      `}),t.jsxs("div",{style:{backgroundColor:Ue.HEADER_BG,borderBottom:`2px solid ${Ue.ORANGE}`,padding:"6px 12px",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,boxShadow:`0 2px 8px ${Ue.ORANGE}20`},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(Cs,{size:18,color:Ue.ORANGE,style:{filter:"drop-shadow(0 0 4px "+Ue.ORANGE+")"}}),t.jsx("span",{style:{color:Ue.ORANGE,fontWeight:700,fontSize:"14px",letterSpacing:"0.5px",textShadow:`0 0 10px ${Ue.ORANGE}40`},children:"FINCEPT TERMINAL"})]}),t.jsx("div",{style:{height:"16px",width:"1px",backgroundColor:Ue.BORDER}}),t.jsxs("div",{style:{position:"relative"},children:[t.jsxs("button",{onClick:()=>D(!W),style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px 10px",backgroundColor:Ue.PANEL_BG,border:`1px solid ${Ue.BORDER}`,color:Ue.CYAN,cursor:"pointer",fontSize:"11px",fontWeight:600,transition:"all 0.2s"},onMouseEnter:U=>U.currentTarget.style.borderColor=Ue.CYAN,onMouseLeave:U=>U.currentTarget.style.borderColor=Ue.BORDER,children:[t.jsx(fc,{size:12}),s?.toUpperCase()||"SELECT BROKER",t.jsx(bi,{size:10})]}),W&&t.jsx("div",{style:{position:"absolute",top:"100%",left:0,marginTop:"4px",backgroundColor:Ue.PANEL_BG,border:`1px solid ${Ue.BORDER}`,minWidth:"200px",zIndex:1e3,boxShadow:`0 4px 16px ${Ue.DARK_BG}80`},children:e.map(U=>t.jsxs("div",{onClick:()=>Qe(U.id),style:{padding:"10px 12px",cursor:"pointer",fontSize:"11px",backgroundColor:s===U.id?`${Ue.ORANGE}20`:"transparent",borderLeft:s===U.id?`3px solid ${Ue.ORANGE}`:"3px solid transparent",display:"flex",alignItems:"center",justifyContent:"space-between",transition:"all 0.2s"},onMouseEnter:ne=>{s!==U.id&&(ne.currentTarget.style.backgroundColor=Ue.HOVER)},onMouseLeave:ne=>{s!==U.id&&(ne.currentTarget.style.backgroundColor="transparent")},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.WHITE,fontWeight:600},children:U.name}),t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px"},children:U.type.toUpperCase()})]}),s===U.id&&t.jsx("div",{style:{width:"6px",height:"6px",borderRadius:"50%",backgroundColor:Ue.GREEN,boxShadow:`0 0 6px ${Ue.GREEN}`}})]},U.id))})]}),t.jsx("div",{style:{height:"16px",width:"1px",backgroundColor:Ue.BORDER}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("button",{onClick:()=>i("paper"),style:{padding:"4px 10px",backgroundColor:n==="paper"?Ue.GREEN:Ue.PANEL_BG,border:`1px solid ${n==="paper"?Ue.GREEN:Ue.BORDER}`,color:n==="paper"?Ue.DARK_BG:Ue.GRAY,cursor:"pointer",fontSize:"10px",fontWeight:700,transition:"all 0.2s"},children:"PAPER"}),t.jsx("button",{onClick:()=>i("live"),style:{padding:"4px 10px",backgroundColor:n==="live"?Ue.RED:Ue.PANEL_BG,border:`1px solid ${n==="live"?Ue.RED:Ue.BORDER}`,color:n==="live"?Ue.WHITE:Ue.GRAY,cursor:"pointer",fontSize:"10px",fontWeight:700,transition:"all 0.2s"},children:"LIVE"})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx("div",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"10px"},children:l?.isConnected()?t.jsxs(t.Fragment,{children:[t.jsx(Yb,{size:12,color:Ue.GREEN}),t.jsx("span",{style:{color:Ue.GREEN},children:"CONNECTED"})]}):t.jsxs(t.Fragment,{children:[t.jsx(v3,{size:12,color:Ue.RED}),t.jsx("span",{style:{color:Ue.RED},children:"DISCONNECTED"})]})}),t.jsx("div",{style:{height:"16px",width:"1px",backgroundColor:Ue.BORDER}}),t.jsx(Tl,{compact:!0}),t.jsx("button",{onClick:()=>ce(!ee),style:{padding:"4px 8px",backgroundColor:"transparent",border:`1px solid ${Ue.BORDER}`,color:Ue.GRAY,cursor:"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"10px",transition:"all 0.2s"},onMouseEnter:U=>{U.currentTarget.style.borderColor=Ue.ORANGE,U.currentTarget.style.color=Ue.ORANGE},onMouseLeave:U=>{U.currentTarget.style.borderColor=Ue.BORDER,U.currentTarget.style.color=Ue.GRAY},children:t.jsx(Mn,{size:12})})]})]}),t.jsxs("div",{style:{backgroundColor:Ue.PANEL_BG,borderBottom:`1px solid ${Ue.BORDER}`,padding:"10px 12px",display:"flex",alignItems:"center",gap:"20px",flexShrink:0},children:[t.jsxs("div",{style:{position:"relative",minWidth:"180px"},"data-symbol-selector":!0,children:[t.jsxs("div",{onClick:()=>$(!z),style:{padding:"6px 12px",backgroundColor:Ue.HEADER_BG,border:`1px solid ${Ue.BORDER}`,cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("span",{style:{fontSize:"13px",fontWeight:700,color:Ue.ORANGE},children:m}),t.jsx(bi,{size:12,color:Ue.GRAY})]}),z&&t.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",backgroundColor:Ue.PANEL_BG,border:`1px solid ${Ue.BORDER}`,maxHeight:"400px",overflow:"hidden",zIndex:1e3,boxShadow:`0 4px 16px ${Ue.DARK_BG}80`},children:[t.jsx("div",{style:{padding:"8px",borderBottom:`1px solid ${Ue.BORDER}`},children:t.jsx("input",{type:"text",placeholder:"Search symbols...",value:P,onChange:U=>I(U.target.value),autoFocus:!0,style:{width:"100%",padding:"6px 8px",backgroundColor:Ue.HEADER_BG,color:Ue.WHITE,border:`1px solid ${Ue.BORDER}`,fontSize:"11px",outline:"none"}})}),t.jsx("div",{style:{maxHeight:"340px",overflowY:"auto"},children:O.filter(U=>U.toLowerCase().includes(P.toLowerCase())).map(U=>t.jsx("div",{onClick:()=>{b(U),$(!1),I("")},style:{padding:"8px 12px",cursor:"pointer",fontSize:"11px",backgroundColor:U===m?`${Ue.ORANGE}20`:"transparent",color:U===m?Ue.ORANGE:Ue.WHITE,borderLeft:U===m?`3px solid ${Ue.ORANGE}`:"none"},onMouseEnter:ne=>{U!==m&&(ne.currentTarget.style.backgroundColor=Ue.HOVER)},onMouseLeave:ne=>{U!==m&&(ne.currentTarget.style.backgroundColor="transparent")},children:U},U))})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"8px"},children:[t.jsx("span",{style:{fontSize:"24px",fontWeight:700,color:Ue.YELLOW},children:w?`$${w.last?.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})||"0.00"}`:"--"}),w&&t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[ue>=0?t.jsx(Nr,{size:16,color:Ue.GREEN}):t.jsx(Dd,{size:16,color:Ue.RED}),t.jsxs("span",{style:{fontSize:"13px",fontWeight:600,color:ue>=0?Ue.GREEN:Ue.RED},children:[ue>=0?"+":"",ue.toFixed(2)," (",re>=0?"+":"",re.toFixed(2),"%)"]})]})]}),t.jsx("div",{style:{height:"24px",width:"1px",backgroundColor:Ue.BORDER}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px",fontSize:"11px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"BID"}),t.jsx("div",{style:{color:Ue.GREEN,fontWeight:600},children:w?`$${w.bid?.toFixed(2)||"0.00"}`:"--"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"ASK"}),t.jsx("div",{style:{color:Ue.RED,fontWeight:600},children:w?`$${w.ask?.toFixed(2)||"0.00"}`:"--"})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"24H RANGE"}),t.jsx("div",{style:{color:Ue.CYAN,fontWeight:600},children:ke>0?t.jsxs(t.Fragment,{children:["$",ke.toFixed(2)," (",Ne.toFixed(2),"%)"]}):"--"})]}),w&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"24H HIGH"}),t.jsxs("div",{style:{color:Ue.WHITE,fontWeight:600},children:["$",w.high?.toFixed(2)||"--"]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"24H LOW"}),t.jsxs("div",{style:{color:Ue.WHITE,fontWeight:600},children:["$",w.low?.toFixed(2)||"--"]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"24H VOLUME"}),t.jsx("div",{style:{color:Ue.PURPLE,fontWeight:600},children:w.volume?t.jsx(t.Fragment,{children:w.quoteVolume?`$${w.quoteVolume.toLocaleString(void 0,{maximumFractionDigits:0})}`:w.volumeUsd?`$${w.volumeUsd.toLocaleString(void 0,{maximumFractionDigits:0})}`:ye>0?t.jsxs(t.Fragment,{children:["$",(w.volume*ye).toLocaleString(void 0,{maximumFractionDigits:0}),t.jsxs("span",{style:{fontSize:"8px",color:Ue.GRAY,marginLeft:"4px"},children:["(",w.volume.toLocaleString(void 0,{maximumFractionDigits:2})," ",m.split("/")[0],")"]})]}):t.jsxs(t.Fragment,{children:[w.volume.toLocaleString(void 0,{maximumFractionDigits:2}),t.jsx("span",{style:{fontSize:"8px",color:Ue.GRAY,marginLeft:"2px"},children:m.split("/")[0]})]})}):"--"})]})]})]}),n==="paper"&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{height:"24px",width:"1px",backgroundColor:Ue.BORDER}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"11px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"BALANCE"}),t.jsxs("div",{style:{color:Ue.CYAN,fontWeight:600},children:["$",de.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:Ue.GRAY,fontSize:"9px",marginBottom:"2px"},children:"EQUITY"}),t.jsxs("div",{style:{color:Ue.YELLOW,fontWeight:600},children:["$",_e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsxs("div",{style:{width:"320px",backgroundColor:Ue.PANEL_BG,borderRight:`1px solid ${Ue.BORDER}`,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"6px",backgroundColor:Ue.HEADER_BG,borderBottom:`1px solid ${Ue.BORDER}`,display:"flex",gap:"4px"},children:[t.jsx("button",{onClick:()=>Y("watchlist"),style:{flex:1,padding:"6px 8px",backgroundColor:_==="watchlist"?Ue.ORANGE:"transparent",border:"none",color:_==="watchlist"?Ue.DARK_BG:Ue.GRAY,cursor:"pointer",fontSize:"9px",fontWeight:700,letterSpacing:"0.5px",transition:"all 0.2s",borderRadius:"2px"},children:"WATCH"}),t.jsx("button",{onClick:()=>Y("ai-agents"),style:{flex:1,padding:"6px 8px",backgroundColor:_==="ai-agents"?Ue.ORANGE:"transparent",border:"none",color:_==="ai-agents"?Ue.DARK_BG:Ue.GRAY,cursor:"pointer",fontSize:"9px",fontWeight:700,letterSpacing:"0.5px",transition:"all 0.2s",borderRadius:"2px"},children:"AGENTS"}),t.jsx("button",{onClick:()=>Y("leaderboard"),style:{flex:1,padding:"6px 8px",backgroundColor:_==="leaderboard"?Ue.ORANGE:"transparent",border:"none",color:_==="leaderboard"?Ue.DARK_BG:Ue.GRAY,cursor:"pointer",fontSize:"9px",fontWeight:700,letterSpacing:"0.5px",transition:"all 0.2s",borderRadius:"2px"},children:"LEADER"})]}),t.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:[_==="watchlist"&&t.jsx("div",{style:{flex:1,overflow:"auto",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0",alignContent:"start"},children:Ce.map((U,ne)=>t.jsx("div",{onClick:()=>b(U),style:{padding:"8px 10px",cursor:"pointer",backgroundColor:m===U?`${Ue.ORANGE}15`:"transparent",borderLeft:m===U?`2px solid ${Ue.ORANGE}`:"2px solid transparent",borderBottom:`1px solid ${Ue.BORDER}`,borderRight:ne%2===0?`1px solid ${Ue.BORDER}`:"none",transition:"all 0.2s"},onMouseEnter:xe=>{m!==U&&(xe.currentTarget.style.backgroundColor=Ue.HOVER)},onMouseLeave:xe=>{m!==U&&(xe.currentTarget.style.backgroundColor="transparent")},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[t.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:m===U?Ue.ORANGE:Ue.WHITE,whiteSpace:"nowrap"},children:U.replace("/USD","")}),We[U]?t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"2px"},children:[t.jsxs("div",{style:{fontSize:"10px",color:Ue.WHITE,fontFamily:"monospace",fontWeight:600},children:["$",We[U].price>=1e3?We[U].price.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):We[U].price>=1?We[U].price.toFixed(2):We[U].price.toFixed(4)]}),t.jsxs("div",{style:{fontSize:"9px",color:We[U].change>=0?Ue.GREEN:Ue.RED,fontFamily:"monospace",fontWeight:700},children:[We[U].change>=0?"":""," ",Math.abs(We[U].change).toFixed(2),"%"]})]}):t.jsx("div",{style:{fontSize:"9px",color:Ue.GRAY,fontFamily:"monospace"},children:"..."})]})},U))}),_==="ai-agents"&&t.jsx("div",{style:{flex:1,overflow:"auto"},children:t.jsx(AJ,{selectedSymbol:m,portfolioData:{positions:he.map(U=>({symbol:U.symbol,quantity:U.quantity,entry_price:U.entryPrice,current_price:U.currentPrice,value:U.positionValue})),total_value:_e}})}),_==="leaderboard"&&t.jsx("div",{style:{flex:1,overflow:"hidden"},children:t.jsx(IJ,{refreshInterval:1e4})})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{flex:Ae?1:"0 0 55%",backgroundColor:Ue.PANEL_BG,borderBottom:`1px solid ${Ue.BORDER}`,display:"flex",flexDirection:"column",overflow:"hidden",transition:"flex 0.3s ease"},children:[t.jsx("div",{style:{padding:"8px 12px",backgroundColor:Ue.HEADER_BG,borderBottom:`1px solid ${Ue.BORDER}`,display:"flex",alignItems:"center",gap:"8px"},children:["CHART","DEPTH","TRADES"].map(U=>t.jsx("button",{onClick:()=>Z(U.toLowerCase()),style:{padding:"4px 12px",backgroundColor:oe===U.toLowerCase()?Ue.ORANGE:"transparent",border:"none",color:oe===U.toLowerCase()?Ue.DARK_BG:Ue.GRAY,cursor:"pointer",fontSize:"10px",fontWeight:700,transition:"all 0.2s"},children:U},U))}),t.jsxs("div",{style:{flex:1,display:"flex",alignItems:"stretch",justifyContent:"center",color:Ue.GRAY,fontSize:"12px",overflow:"visible",minHeight:0},children:[oe==="chart"&&t.jsx("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:t.jsx(cJ,{symbol:m,showVolume:!0})}),oe==="depth"&&t.jsx("div",{style:{width:"100%",height:"100%",padding:"8px"},children:t.jsx(dJ,{symbol:m})}),oe==="trades"&&t.jsx("div",{style:{width:"100%",height:"100%",overflow:"auto",padding:"8px"},children:t.jsxs("table",{style:{width:"100%",fontSize:"10px",borderCollapse:"collapse"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{borderBottom:`1px solid ${Ue.BORDER}`},children:[t.jsx("th",{style:{padding:"6px",textAlign:"left",color:Ue.GRAY},children:"TIME"}),t.jsx("th",{style:{padding:"6px",textAlign:"right",color:Ue.GRAY},children:"PRICE"}),t.jsx("th",{style:{padding:"6px",textAlign:"right",color:Ue.GRAY},children:"SIZE"})]})}),t.jsx("tbody",{children:E.slice(0,20).map((U,ne)=>t.jsxs("tr",{style:{borderBottom:`1px solid ${Ue.BORDER}40`},children:[t.jsx("td",{style:{padding:"4px 6px",color:Ue.GRAY,fontSize:"9px"},children:new Date(U.timestamp).toLocaleTimeString()}),t.jsxs("td",{style:{padding:"4px 6px",textAlign:"right",color:U.side==="buy"?Ue.GREEN:Ue.RED},children:["$",U.price?.toFixed(2)]}),t.jsx("td",{style:{padding:"4px 6px",textAlign:"right",color:Ue.WHITE},children:U.amount?.toFixed(4)})]},ne))})]})})]})]}),t.jsxs("div",{style:{flex:Ae?"0 0 40px":1,display:"flex",flexDirection:"column",overflow:"hidden",transition:"flex 0.3s ease"},children:[t.jsxs("div",{style:{padding:"6px 12px",backgroundColor:Ue.HEADER_BG,borderBottom:`1px solid ${Ue.BORDER}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("div",{style:{display:"flex",gap:"4px"},children:["positions","orders","history","trades","stats","features","cross-exchange"].map(U=>t.jsxs("button",{onClick:()=>ve(U),style:{padding:"6px 16px",backgroundColor:ie===U?Ue.ORANGE:"transparent",border:"none",color:ie===U?Ue.DARK_BG:Ue.GRAY,cursor:"pointer",fontSize:"10px",fontWeight:700,textTransform:"uppercase",transition:"all 0.2s"},children:[U," ",U==="positions"&&`(${he.length})`," ",U==="orders"&&`(${ge.length})`]},U))}),t.jsx("button",{onClick:()=>$e(!Ae),style:{padding:"4px 8px",backgroundColor:"transparent",border:`1px solid ${Ue.BORDER}`,color:Ue.GRAY,cursor:"pointer",fontSize:"10px",fontWeight:600,display:"flex",alignItems:"center",gap:"4px",borderRadius:"2px",transition:"all 0.2s"},onMouseEnter:U=>{U.currentTarget.style.backgroundColor=Ue.HOVER,U.currentTarget.style.borderColor=Ue.GRAY},onMouseLeave:U=>{U.currentTarget.style.backgroundColor="transparent",U.currentTarget.style.borderColor=Ue.BORDER},title:Ae?"Maximize Panel":"Minimize Panel",children:Ae?t.jsxs(t.Fragment,{children:[t.jsx(Hp,{size:14}),t.jsx("span",{children:"MAXIMIZE"})]}):t.jsxs(t.Fragment,{children:[t.jsx(bi,{size:14}),t.jsx("span",{children:"MINIMIZE"})]})})]}),!Ae&&t.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:[ie==="positions"&&t.jsx(tJ,{}),ie==="orders"&&t.jsx(iJ,{}),ie==="history"&&t.jsx(oJ,{}),ie==="trades"&&(X.length===0?t.jsx("div",{style:{padding:"40px",textAlign:"center",color:Ue.GRAY,fontSize:"11px"},children:"No trade history"}):t.jsxs("table",{style:{width:"100%",fontSize:"10px",borderCollapse:"collapse"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{borderBottom:`1px solid ${Ue.BORDER}`},children:[t.jsx("th",{style:{padding:"8px",textAlign:"left",color:Ue.GRAY,fontWeight:600},children:"TIME"}),t.jsx("th",{style:{padding:"8px",textAlign:"left",color:Ue.GRAY,fontWeight:600},children:"SYMBOL"}),t.jsx("th",{style:{padding:"8px",textAlign:"center",color:Ue.GRAY,fontWeight:600},children:"SIDE"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:Ue.GRAY,fontWeight:600},children:"QTY"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:Ue.GRAY,fontWeight:600},children:"PRICE"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:Ue.GRAY,fontWeight:600},children:"VALUE"}),t.jsx("th",{style:{padding:"8px",textAlign:"right",color:Ue.GRAY,fontWeight:600},children:"FEE"})]})}),t.jsx("tbody",{children:X.map((U,ne)=>t.jsxs("tr",{style:{borderBottom:`1px solid ${Ue.BORDER}40`},children:[t.jsx("td",{style:{padding:"8px",color:Ue.GRAY,fontSize:"9px"},children:new Date(U.timestamp).toLocaleTimeString()}),t.jsx("td",{style:{padding:"8px",color:Ue.WHITE},children:U.symbol}),t.jsx("td",{style:{padding:"8px",textAlign:"center"},children:t.jsx("span",{style:{padding:"2px 8px",backgroundColor:U.side==="buy"?`${Ue.GREEN}20`:`${Ue.RED}20`,color:U.side==="buy"?Ue.GREEN:Ue.RED,fontSize:"9px",fontWeight:700},children:U.side.toUpperCase()})}),t.jsx("td",{style:{padding:"8px",textAlign:"right",color:Ue.WHITE},children:U.amount?.toFixed(4)||"0.0000"}),t.jsxs("td",{style:{padding:"8px",textAlign:"right",color:Ue.YELLOW},children:["$",U.price?.toFixed(2)||"0.00"]}),t.jsxs("td",{style:{padding:"8px",textAlign:"right",color:Ue.CYAN},children:["$",U.cost?.toFixed(2)||"0.00"]}),t.jsxs("td",{style:{padding:"8px",textAlign:"right",color:Ue.RED},children:["$",U.fee?.cost?.toFixed(2)||"0.00"]})]},ne))})]})),ie==="stats"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 300px",gap:"12px",padding:"12px",height:"100%",overflow:"hidden"},children:[t.jsx("div",{style:{height:"100%",overflow:"auto"},children:t.jsx(gJ,{})}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",height:"100%",overflow:"auto"},children:[t.jsx(xJ,{}),t.jsx(mJ,{})]})]}),ie==="features"&&t.jsxs("div",{style:{padding:"16px",overflow:"auto"},children:[s==="kraken"&&t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsx(JX,{}),t.jsx(QX,{})]}),s==="hyperliquid"&&t.jsxs("div",{style:{padding:"40px",textAlign:"center",color:Ue.GRAY,backgroundColor:Ue.PANEL_BG,border:`1px solid ${Ue.BORDER}`,borderRadius:"4px"},children:[t.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px"},children:"HyperLiquid Features"}),t.jsx("div",{style:{fontSize:"11px"},children:"HyperLiquid-specific features (Vault Manager, Leverage Control) are available in the order form panel on the right."})]}),s!=="kraken"&&s!=="hyperliquid"&&t.jsxs("div",{style:{padding:"40px",textAlign:"center",color:Ue.GRAY,backgroundColor:Ue.PANEL_BG,border:`1px solid ${Ue.BORDER}`,borderRadius:"4px"},children:[t.jsx("div",{style:{fontSize:"14px",fontWeight:600,marginBottom:"8px"},children:"No Exchange-Specific Features"}),t.jsx("div",{style:{fontSize:"11px"},children:"The selected exchange does not have additional features available in this panel."})]})]}),ie==="cross-exchange"&&t.jsx("div",{style:{padding:"16px",overflow:"auto"},children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsx(vJ,{}),t.jsx(SJ,{})]})})]})]})]}),t.jsxs("div",{style:{width:"300px",backgroundColor:Ue.PANEL_BG,borderLeft:`1px solid ${Ue.BORDER}`,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{height:"45%",borderBottom:`1px solid ${Ue.BORDER}`,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsx("div",{style:{padding:"8px 12px",backgroundColor:Ue.HEADER_BG,borderBottom:`1px solid ${Ue.BORDER}`,fontSize:"10px",fontWeight:700,color:Ue.ORANGE,letterSpacing:"0.5px"},children:"ORDER ENTRY"}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:n==="paper"?!d||!d.isConnected()?t.jsxs("div",{style:{padding:"20px",textAlign:"center",border:`1px solid ${Ue.ORANGE}`,backgroundColor:`${Ue.ORANGE}10`},children:[t.jsx("div",{style:{color:Ue.ORANGE,fontSize:"11px",fontWeight:700,marginBottom:"8px"},children:" INITIALIZING..."}),t.jsx("div",{style:{color:Ue.GRAY,fontSize:"10px"},children:f?"Connecting to broker...":"Waiting for adapter..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(XX,{symbol:m,currentPrice:ye,balance:de,onOrderPlaced:()=>{console.log("Order placed successfully")}}),t.jsx(qX,{})]}):t.jsx("div",{style:{padding:"20px",textAlign:"center",border:`1px solid ${Ue.RED}`,backgroundColor:`${Ue.RED}10`,color:Ue.RED,fontSize:"11px"},children:"Live trading not yet enabled"})})]}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"8px 12px",backgroundColor:Ue.HEADER_BG,borderBottom:`1px solid ${Ue.BORDER}`,fontSize:"10px",fontWeight:700,color:Ue.ORANGE,letterSpacing:"0.5px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx("div",{style:{display:"flex",gap:"8px"},children:["orderbook","volume","modelchat"].map(U=>t.jsx("button",{onClick:()=>Q(U),style:{padding:"4px 8px",backgroundColor:fe===U?Ue.ORANGE:"transparent",border:"none",color:fe===U?Ue.DARK_BG:Ue.GRAY,cursor:"pointer",fontSize:"9px",fontWeight:700,transition:"all 0.2s"},children:U.toUpperCase()},U))}),fe==="orderbook"&&t.jsxs("span",{style:{fontSize:"8px",color:Ue.GRAY},children:[C.asks.length+C.bids.length," LEVELS"]})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:[fe==="orderbook"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{color:Ue.RED,fontSize:"9px",fontWeight:700,marginBottom:"4px"},children:["ASKS (",C.asks.length,")"]}),t.jsx("table",{style:{width:"100%",fontSize:"10px"},children:t.jsx("tbody",{children:C.asks.slice(0,12).reverse().map((U,ne)=>{const xe=U.size/Math.max(...C.asks.map(Le=>Le.size))*100;return t.jsxs("tr",{style:{position:"relative"},children:[t.jsxs("td",{style:{padding:"2px 4px",color:Ue.RED,position:"relative",zIndex:1},children:[t.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:`${xe}%`,backgroundColor:`${Ue.RED}15`,zIndex:-1}}),"$",U.price.toFixed(2)]}),t.jsx("td",{style:{padding:"2px 4px",textAlign:"right",color:Ue.GRAY},children:U.size.toFixed(4)})]},ne)})})})]}),t.jsx("div",{style:{height:"1px",backgroundColor:Ue.BORDER,margin:"8px 0",position:"relative"},children:t.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",backgroundColor:Ue.PANEL_BG,padding:"0 8px",fontSize:"11px",fontWeight:700,color:Ue.YELLOW},children:["$",ye.toFixed(2)]})}),t.jsxs("div",{children:[t.jsxs("div",{style:{color:Ue.GREEN,fontSize:"9px",fontWeight:700,marginBottom:"4px"},children:["BIDS (",C.bids.length,")"]}),t.jsx("table",{style:{width:"100%",fontSize:"10px"},children:t.jsx("tbody",{children:C.bids.slice(0,12).map((U,ne)=>{const xe=U.size/Math.max(...C.bids.map(Le=>Le.size))*100;return t.jsxs("tr",{style:{position:"relative"},children:[t.jsxs("td",{style:{padding:"2px 4px",color:Ue.GREEN,position:"relative",zIndex:1},children:[t.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:`${xe}%`,backgroundColor:`${Ue.GREEN}15`,zIndex:-1}}),"$",U.price.toFixed(2)]}),t.jsx("td",{style:{padding:"2px 4px",textAlign:"right",color:Ue.GRAY},children:U.size.toFixed(4)})]},ne)})})})]})]}),fe==="volume"&&t.jsx(uJ,{symbol:m,height:550}),fe==="modelchat"&&t.jsx(_J,{refreshInterval:5e3})]}),t.jsxs("div",{style:{padding:"4px 8px",backgroundColor:Ue.HEADER_BG,borderTop:`1px solid ${Ue.BORDER}`,fontSize:"8px",color:Ue.GRAY},children:["Updated: ",R>0?new Date(R).toLocaleTimeString():"Never"]})]})]})]}),t.jsxs("div",{style:{borderTop:`1px solid ${Ue.BORDER}`,backgroundColor:Ue.HEADER_BG,padding:"4px 12px",fontSize:"9px",color:Ue.GRAY,display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[t.jsx("span",{children:"Fincept Terminal v3.0.12 | Professional Trading Platform"}),t.jsxs("span",{children:["Broker: ",t.jsx("span",{style:{color:Ue.ORANGE},children:s?.toUpperCase()||"NONE"})," | Mode: ",t.jsx("span",{style:{color:n==="paper"?Ue.GREEN:Ue.RED},children:n.toUpperCase()})," | Status: ",t.jsx("span",{style:{color:l?.isConnected()?Ue.GREEN:Ue.RED},children:l?.isConnected()?"CONNECTED":"DISCONNECTED"})]})]})]})}async function T0(s,e){await lt("plugin:shell|open",{path:s,with:e})}class zJ{async generateHTML(e){try{const r=JSON.stringify(e),n=await lt("generate_report_html",{templateJson:r});return JSON.parse(n)}catch(r){return Hl.error("Failed to generate HTML:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async generatePDF(e,r){try{const n=JSON.stringify(e),i=await lt("generate_report_pdf",{templateJson:n,outputPath:r});return JSON.parse(i)}catch(n){return Hl.error("Failed to generate PDF:",n),{success:!1,error:n instanceof Error?n.message:"Unknown error"}}}async createDefaultTemplate(){try{const e=await lt("create_default_report_template");return JSON.parse(e)}catch(e){return Hl.error("Failed to create default template:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async openInFolder(e){try{Hl.debug("Opening folder for:",e);const r=e.replace(/\\/g,"/").split("/");r.pop();const n=r.join("/"),i=await this.getPlatform();if(Hl.debug("Platform:",i),i==="windows"){const o=e.replace(/\//g,"\\");await T0(`explorer /select,"${o}"`)}else i==="darwin"?await T0(`open -R "${e}"`):await T0(`xdg-open "${n}"`);return!0}catch(r){return Hl.error("Failed to open folder:",r),!1}}async getPlatform(){try{return await lt("plugin:os|platform")}catch{const e=navigator.userAgent.toLowerCase();return e.includes("win")?"windows":e.includes("mac")?"darwin":"linux"}}async saveTemplate(e){await Je.initialize();const r=new Date().toISOString(),n={...e,updated_at:r,created_at:e.created_at||r};JSON.stringify({components:n.components,metadata:n.metadata,styles:n.styles});try{const i=this.getTemplatesFromLocalStorage(),o=i.findIndex(a=>a.id===e.id);o>=0?i[o]=n:i.push(n),localStorage.setItem("financial_report_templates",JSON.stringify(i))}catch(i){throw Hl.error("Failed to save template:",i),i}}getTemplatesFromLocalStorage(){const e=localStorage.getItem("financial_report_templates");return e?JSON.parse(e):[]}async getTemplates(){return this.getTemplatesFromLocalStorage()}async getTemplate(e){return this.getTemplatesFromLocalStorage().find(n=>n.id===e)||null}async deleteTemplate(e){const n=this.getTemplatesFromLocalStorage().filter(i=>i.id!==e);localStorage.setItem("financial_report_templates",JSON.stringify(n))}getDefaultTemplate(){return{id:`report-${Date.now()}`,name:"New Financial Report",description:"Professional financial research report",components:[],metadata:{author:"",company:"",date:new Date().toISOString().split("T")[0],title:"Financial Research Report"},styles:{pageSize:"A4",orientation:"portrait",margins:"20mm",headerFooter:!0}}}getEquityResearchTemplate(){return{id:"equity-research-template",name:"Equity Research Report",description:"Professional equity research report with multi-column layout",components:[{id:"cover-page",type:"coverpage",content:null,config:{subtitle:"Equity Research | Technology Sector",backgroundColor:"#0a0a0a",color:"#FFA500"}},{id:"page-break-1",type:"pagebreak",content:null,config:{}},{id:"exec-summary-section",type:"section",content:null,config:{sectionTitle:"EXECUTIVE SUMMARY",sectionStyle:"highlight",backgroundColor:"#f8f9fa",borderColor:"#FFA500",padding:"20px"},children:[{id:"exec-summary-content",type:"text",content:"We initiate coverage on XYZ Corporation with a BUY rating and 12-month price target of $185. The company demonstrates strong fundamentals with market-leading positions in cloud infrastructure and AI services. Key investment highlights include accelerating revenue growth, margin expansion, and strategic acquisitions.",config:{fontSize:"medium",alignment:"left"}}]},{id:"investment-highlights",type:"columns",content:null,config:{columnCount:2,padding:"15px"},children:[{id:"col1-heading",type:"subheading",content:"Bull Case",config:{fontSize:"medium",color:"#10b981",fontWeight:"bold"}},{id:"col1-text",type:"text",content:` Market share gains in cloud computing
 Strong pricing power and gross margin expansion
 Robust free cash flow generation
 Strategic AI partnerships`,config:{fontSize:"small"}},{id:"col2-heading",type:"subheading",content:"Bear Case",config:{fontSize:"medium",color:"#ef4444",fontWeight:"bold"}},{id:"col2-text",type:"text",content:` Regulatory scrutiny in key markets
 Intensifying competition
 Currency headwinds
 Execution risks on large projects`,config:{fontSize:"small"}}]},{id:"financial-metrics",type:"heading",content:"Key Financial Metrics",config:{fontSize:"xl",alignment:"left"}},{id:"metrics-3col",type:"columns",content:null,config:{columnCount:3},children:[{id:"metric1",type:"text",content:`Revenue Growth
+23.5% YoY`,config:{alignment:"center",fontWeight:"bold",fontSize:"medium"}},{id:"metric2",type:"text",content:`Operating Margin
32.1%`,config:{alignment:"center",fontWeight:"bold",fontSize:"medium"}},{id:"metric3",type:"text",content:`FCF Yield
4.8%`,config:{alignment:"center",fontWeight:"bold",fontSize:"medium"}}]}],metadata:{author:"Fincept Research",company:"Fincept Corporation",date:new Date().toISOString().split("T")[0],title:"XYZ Corp - Initiate with BUY"},styles:{pageSize:"A4",orientation:"portrait",margins:"15mm",headerFooter:!0}}}getSampleFinancialReport(){return{id:"sample-financial-report",name:"Sample Financial Analysis Report",description:"Complete financial analysis with charts and tables",components:[{id:"exec-summary-heading",type:"heading",content:"Executive Summary",config:{fontSize:"xl",alignment:"left"}},{id:"exec-summary-text",type:"text",content:"This report provides a comprehensive analysis of the financial performance and market position of XYZ Corporation for the fiscal year 2024. Key findings include strong revenue growth, improved profitability margins, and strategic market expansion.",config:{alignment:"left"}},{id:"divider-1",type:"divider",content:null,config:{}},{id:"financial-highlights",type:"heading",content:"Financial Highlights",config:{fontSize:"xl",alignment:"left"}},{id:"financial-table",type:"table",content:{rows:[["Revenue","$1,250M","+15.3%"],["Net Income","$187M","+22.1%"],["EBITDA","$325M","+18.7%"],["EPS","$4.23","+19.5%"]]},config:{columns:["Metric","Value","YoY Change"]}},{id:"market-analysis",type:"heading",content:"Market Analysis",config:{fontSize:"xl",alignment:"left"}},{id:"market-text",type:"text",content:"The company has demonstrated strong market performance across all key segments, with particular strength in the technology sector. Market share has increased from 23% to 27% over the past year.",config:{alignment:"left"}}],metadata:{author:"Financial Analysis Team",company:"Fincept Corporation",date:new Date().toISOString().split("T")[0],title:"Financial Analysis Report - XYZ Corporation"},styles:{pageSize:"A4",orientation:"portrait",margins:"20mm",headerFooter:!0}}}}const Hk=new zJ;function MJ(s){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=s:r.appendChild(document.createTextNode(s))}Array(12).fill(0);let Ob=1;class BJ{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;const{message:n,...i}=e,o=typeof e?.id=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:Ob++,a=this.toasts.find(d=>d.id===o),l=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),a?this.toasts=this.toasts.map(d=>d.id===o?(this.publish({...d,...e,id:o,title:n}),{...d,...e,id:o,dismissible:l,title:n}):d):this.addToast({title:n,...i,dismissible:l,id:o}),o},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:e,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let o=n!==void 0,a;const l=i.then(async p=>{if(a=["resolve",p],S.isValidElement(p))o=!1,this.create({id:n,type:"default",message:p});else if($J(p)&&!p.ok){o=!1;const h=typeof r.error=="function"?await r.error(`HTTP error! status: ${p.status}`):r.error,x=typeof r.description=="function"?await r.description(`HTTP error! status: ${p.status}`):r.description,b=typeof h=="object"&&!S.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:x,...b})}else if(p instanceof Error){o=!1;const h=typeof r.error=="function"?await r.error(p):r.error,x=typeof r.description=="function"?await r.description(p):r.description,b=typeof h=="object"&&!S.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:x,...b})}else if(r.success!==void 0){o=!1;const h=typeof r.success=="function"?await r.success(p):r.success,x=typeof r.description=="function"?await r.description(p):r.description,b=typeof h=="object"&&!S.isValidElement(h)?h:{message:h};this.create({id:n,type:"success",description:x,...b})}}).catch(async p=>{if(a=["reject",p],r.error!==void 0){o=!1;const f=typeof r.error=="function"?await r.error(p):r.error,h=typeof r.description=="function"?await r.description(p):r.description,m=typeof f=="object"&&!S.isValidElement(f)?f:{message:f};this.create({id:n,type:"error",description:h,...m})}}).finally(()=>{o&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),d=()=>new Promise((p,f)=>l.then(()=>a[0]==="reject"?f(a[1]):p(a[1])).catch(f));return typeof n!="string"&&typeof n!="number"?{unwrap:d}:Object.assign(n,{unwrap:d})},this.custom=(e,r)=>{const n=r?.id||Ob++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const so=new BJ,FJ=(s,e)=>{const r=e?.id||Ob++;return so.addToast({title:s,...e,id:r}),r},$J=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",GJ=FJ,UJ=()=>so.toasts,WJ=()=>so.getActiveToasts(),to=Object.assign(GJ,{success:so.success,info:so.info,warning:so.warning,error:so.error,custom:so.custom,message:so.message,promise:so.promise,dismiss:so.dismiss,loading:so.loading},{getHistory:UJ,getToasts:WJ});MJ("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");const mt={ORANGE:"#FFA500",BLACK:"#000000",DARK_BG:"#0a0a0a",PANEL_BG:"#1a1a1a",BORDER:"#333333",TEXT_PRIMARY:"#FFFFFF",TEXT_SECONDARY:"#999999"};function qJ({component:s,isSelected:e,onClick:r,onDelete:n,onDuplicate:i}){const{attributes:o,listeners:a,setNodeRef:l,transform:d,transition:p}=oN({id:s.id}),f={transform:Ld.Transform.toString(d),transition:p},h=()=>{switch(s.type){case"heading":return t.jsx(Sd,{size:14});case"text":return t.jsx(WT,{size:14});case"chart":return t.jsx(ja,{size:14});case"table":return t.jsx(UT,{size:14});case"image":return t.jsx(q0,{size:14});case"code":return t.jsx(Yp,{size:14});case"divider":return t.jsx(Op,{size:14});default:return t.jsx(ri,{size:14})}},x=()=>s.content?String(s.content).substring(0,40):`${s.type.charAt(0).toUpperCase()+s.type.slice(1)} component`;return t.jsxs("div",{ref:l,style:f,className:`flex items-center justify-between p-2 mb-1 cursor-pointer transition-colors border-l-2 ${e?"bg-[#2a2a2a] border-l-[#FFA500]":"bg-transparent border-l-transparent hover:bg-[#1a1a1a]"}`,onClick:r,children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[t.jsx("div",{...o,...a,className:"cursor-move text-gray-500 hover:text-[#FFA500]",children:t.jsx(bB,{size:14})}),t.jsx("div",{className:"text-[#FFA500]",children:h()}),t.jsx("span",{className:"text-xs text-gray-400 truncate",children:x()})]}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{onClick:m=>{m.stopPropagation(),i()},className:"p-1 hover:bg-[#333333] rounded text-gray-400 hover:text-[#FFA500]",title:"Duplicate",children:t.jsx(hc,{size:12})}),t.jsx("button",{onClick:m=>{m.stopPropagation(),n()},className:"p-1 hover:bg-[#333333] rounded text-gray-400 hover:text-red-500",title:"Delete",children:t.jsx(On,{size:12})})]})]})}const HJ=()=>{const{colors:s}=Er(),[e,r]=S.useState(new Date),[n,i]=S.useState({id:`report-${Date.now()}`,name:"New Financial Report",description:"Professional financial research report",components:[],metadata:{author:"",company:"",date:new Date().toISOString().split("T")[0],title:"Financial Research Report"},styles:{pageSize:"A4",orientation:"portrait",margins:"20mm",headerFooter:!0}}),[o,a]=S.useState(null),[l,d]=S.useState(!1),[p,f]=S.useState(!1),[h,x]=S.useState(!1),[m,b]=S.useState(""),[w,y]=S.useState("classic"),[C,T]=S.useState("Arial, sans-serif"),[E,j]=S.useState(11),[k,A]=S.useState(!1),[R,M]=S.useState(!1),[P,I]=S.useState("#ffffff"),[O,G]=S.useState(!1),[B,F]=S.useState([]),[z,$]=S.useState(""),[W,D]=S.useState(!1),[oe,Z]=S.useState("ollama"),[fe,Q]=S.useState([]),[_,Y]=S.useState(""),he=S.useRef(null),[me,ge]=S.useState("split"),le=F2(Ng(gx),Ng(fx,{coordinateGetter:aN}));S.useEffect(()=>{const K=setInterval(()=>r(new Date),1e3);return()=>clearInterval(K)},[]),S.useEffect(()=>{(async()=>{try{const Oe=(await Je.getLLMConfigs()).map(ee=>({id:ee.config_name,name:ee.model_name||ee.config_name,provider:ee.provider}));Q(Oe);const q=await Je.getActiveLLMConfig();q&&Z(q.provider)}catch(Ee){console.error("Failed to load models:",Ee)}})()},[]),S.useEffect(()=>{he.current?.scrollIntoView({behavior:"smooth"})},[B,_]);const X=n.components.find(K=>K.id===o),V=S.useCallback(K=>{const Ee={id:`component-${Date.now()}`,type:K,content:K==="divider"||K==="pagebreak"||K==="coverpage"||K==="section"||K==="columns"?"":K==="heading"?"New Heading":K==="subheading"?"New Subheading":K==="text"?"Enter text here...":"",config:{fontSize:K==="heading"?"2xl":K==="subheading"?"xl":"base",fontWeight:K==="heading"||K==="subheading"?"bold":"normal",alignment:"left",...K==="columns"&&{columnCount:2},...K==="section"&&{sectionTitle:"New Section",sectionStyle:"default",backgroundColor:"#f8f9fa",borderColor:"#FFA500",padding:"15px"},...K==="coverpage"&&{subtitle:"",backgroundColor:"#0a0a0a"}},...K==="columns"||K==="section"?{children:[]}:{}};i(Oe=>({...Oe,components:[...Oe.components,Ee]})),a(Ee.id),to.success(`${K.charAt(0).toUpperCase()+K.slice(1)} added`)},[]),de=S.useCallback((K,Ee)=>{i(Oe=>({...Oe,components:Oe.components.map(q=>q.id===K?{...q,...Ee}:q)}))},[]),je=S.useCallback(K=>{i(Ee=>({...Ee,components:Ee.components.filter(Oe=>Oe.id!==K)})),o===K&&a(null),to.success("Component deleted")},[o]),_e=S.useCallback(K=>{const Ee=n.components.find(Oe=>Oe.id===K);if(Ee){const Oe={...Ee,id:`component-${Date.now()}`};i(q=>({...q,components:[...q.components,Oe]})),to.success("Component duplicated")}},[n.components]),Re=K=>{const{active:Ee,over:Oe}=K;Oe&&Ee.id!==Oe.id&&i(q=>{const ee=q.components.findIndex(Ce=>Ce.id===Ee.id),ce=q.components.findIndex(Ce=>Ce.id===Oe.id);return{...q,components:Fp(q.components,ee,ce)}})},Be=async()=>{try{f(!0),await P0({filters:[{name:"JSON",extensions:["json"]}],defaultPath:`${n.name}.json`})&&(await Hk.saveTemplate(n),to.success("Template saved successfully"))}catch(K){console.error("Error saving template:",K),to.error("Failed to save template")}finally{f(!1)}},Se=async()=>{try{const K=await I0({filters:[{name:"JSON",extensions:["json"]}],multiple:!1}),Ee=await Hk.getTemplates();Ee.length>0?(i(Ee[0]),to.success("Template loaded successfully")):to.info("No saved templates found. Use a sample template instead.")}catch(K){console.error("Error loading template:",K),to.error("Failed to load template")}},ie=async()=>{try{d(!0);const K=await P0({filters:[{name:"PDF",extensions:["pdf"]}],defaultPath:`${n.metadata.title||"report"}.pdf`});K&&(await lt("generate_report_pdf",{templateJson:JSON.stringify(n),outputPath:K}),b(K),x(!0))}catch(K){console.error("Error generating PDF:",K),to.error("Failed to generate PDF")}finally{d(!1)}},ve=async()=>{try{const K=m.substring(0,m.lastIndexOf("\\"));await lt("open_folder",{path:K}),x(!1)}catch(K){console.error("Error opening folder:",K),to.error("Failed to open folder")}},Ae=async()=>{if(!z.trim())return;const K={role:"user",content:z.trim()};F(Ee=>[...Ee,K]),$(""),D(!0),Y("");try{if(!await Je.getActiveLLMConfig()){F(Ce=>[...Ce,{role:"assistant",content:"Please configure your LLM settings first in the Chat tab or Settings."}]),D(!1);return}const q=[{role:"system",content:`You are a professional writing assistant helping to create financial reports. ${`I'm working on a report titled "${n.metadata.title}". ${n.components.length>0?`It has ${n.components.length} components including ${n.components.map(Ce=>Ce.type).join(", ")}.`:"It's empty so far."} The report uses ${C} font at ${E}pt with ${w} theme.`}`},...B.map(Ce=>({role:Ce.role,content:Ce.content})),{role:"user",content:K.content}];let ee="";const ce=await Pp.chat(K.content,q,(Ce,be)=>{be||(ee+=Ce,Y(ee))});if(ce.error)throw new Error(ce.error);ee=ce.content,F(Ce=>[...Ce,{role:"assistant",content:ee}]),Y("")}catch(Ee){console.error("AI Error:",Ee),F(Oe=>[...Oe,{role:"assistant",content:"Sorry, I encountered an error. Please try again."}])}finally{D(!1)}},$e=K=>{$({improve:"Can you help me improve the content of this report? Suggest better wording and structure.",expand:"Can you help me expand on the current content with more details and insights?",summarize:"Can you help me create a concise executive summary for this report?",grammar:"Can you check the grammar and suggest improvements for professional writing?"}[K]||"")},qe=()=>{switch(w){case"modern":return{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",color:"#ffffff"};case"geometric":return{backgroundColor:"#ffffff",backgroundImage:`
            linear-gradient(30deg, rgba(255,165,0,0.08) 12%, transparent 12.5%, transparent 87%, rgba(255,165,0,0.08) 87.5%, rgba(255,165,0,0.08)),
            linear-gradient(150deg, rgba(255,165,0,0.08) 12%, transparent 12.5%, transparent 87%, rgba(255,165,0,0.08) 87.5%, rgba(255,165,0,0.08)),
            linear-gradient(30deg, rgba(255,165,0,0.05) 12%, transparent 12.5%, transparent 87%, rgba(255,165,0,0.05) 87.5%, rgba(255,165,0,0.05)),
            linear-gradient(150deg, rgba(255,165,0,0.05) 12%, transparent 12.5%, transparent 87%, rgba(255,165,0,0.05) 87.5%, rgba(255,165,0,0.05))
          `,backgroundSize:"80px 140px",backgroundPosition:"0 0, 0 0, 40px 70px, 40px 70px",color:"#000000"};case"gradient":return{background:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",color:"#ffffff"};case"minimal":return{backgroundColor:"#ffffff",backgroundImage:`
            linear-gradient(rgba(200,200,200,0.3) 1px, transparent 1px),
            linear-gradient(90deg, rgba(200,200,200,0.3) 1px, transparent 1px)
          `,backgroundSize:"20px 20px",color:"#000000"};case"pattern":return{backgroundColor:"#ffffff",backgroundImage:`
            repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,165,0,0.02) 10px, rgba(255,165,0,0.02) 20px),
            repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(255,165,0,0.02) 10px, rgba(255,165,0,0.02) 20px),
            radial-gradient(circle at 10% 10%, rgba(255,165,0,0.03) 0%, transparent 50%),
            radial-gradient(circle at 90% 90%, rgba(255,165,0,0.03) 0%, transparent 50%)
          `,backgroundSize:"cover",color:"#000000"};default:return{backgroundColor:P,color:"#000000"}}},Ie=async()=>{try{const K=await I0({multiple:!1,filters:[{name:"Images",extensions:["png","jpg","jpeg","gif","bmp","webp"]}]});K&&typeof K=="string"&&X&&(de(X.id,{config:{...X.config,imageUrl:K}}),to.success("Image uploaded"))}catch{to.error("Failed to upload image")}};return t.jsxs("div",{className:"h-full flex flex-col",style:{backgroundColor:mt.DARK_BG,color:mt.TEXT_PRIMARY},children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b",style:{borderColor:mt.BORDER,backgroundColor:mt.PANEL_BG},children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ri,{className:"w-5 h-5",style:{color:mt.ORANGE}}),t.jsx("span",{className:"font-bold text-sm",style:{color:mt.ORANGE},children:"REPORT BUILDER"})]}),t.jsx(Tl,{compact:!0})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:Se,className:"px-3 py-1 text-xs rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-1",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(VE,{size:14}),"Load"]}),t.jsxs("button",{onClick:Be,disabled:p,className:"px-3 py-1 text-xs rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-1 disabled:opacity-50",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(ao,{size:14}),p?"Saving...":"Save"]}),t.jsxs("button",{onClick:ie,disabled:l||n.components.length===0,className:"px-3 py-1 text-xs rounded transition-colors flex items-center gap-1 disabled:opacity-50",style:{backgroundColor:mt.ORANGE,color:mt.BLACK,fontWeight:"bold"},children:[t.jsx(Mi,{size:14}),l?"Generating...":"Export PDF"]})]})]}),t.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[t.jsx("div",{className:"w-1/5 border-r overflow-y-auto",style:{borderColor:mt.BORDER,backgroundColor:mt.PANEL_BG},children:t.jsxs("div",{className:"p-3",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-xs font-bold mb-2",style:{color:mt.ORANGE},children:"ADD COMPONENTS"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("button",{onClick:()=>V("heading"),className:"w-full px-3 py-2 text-xs text-left rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-2",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(Sd,{size:14}),"Heading"]}),t.jsxs("button",{onClick:()=>V("text"),className:"w-full px-3 py-2 text-xs text-left rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-2",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(WT,{size:14}),"Text"]}),t.jsxs("button",{onClick:()=>V("chart"),className:"w-full px-3 py-2 text-xs text-left rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-2",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(ja,{size:14}),"Chart"]}),t.jsxs("button",{onClick:()=>V("table"),className:"w-full px-3 py-2 text-xs text-left rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-2",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(UT,{size:14}),"Table"]}),t.jsxs("button",{onClick:()=>V("image"),className:"w-full px-3 py-2 text-xs text-left rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-2",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(q0,{size:14}),"Image"]}),t.jsxs("button",{onClick:()=>V("code"),className:"w-full px-3 py-2 text-xs text-left rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-2",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(Yp,{size:14}),"Code Block"]}),t.jsxs("button",{onClick:()=>V("divider"),className:"w-full px-3 py-2 text-xs text-left rounded hover:bg-[#2a2a2a] transition-colors flex items-center gap-2",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(Op,{size:14}),"Divider"]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-xs font-bold mb-2",style:{color:mt.ORANGE},children:"LAYOUT"}),t.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[t.jsxs("button",{onClick:()=>V("section"),className:"px-2 py-2 text-xs rounded hover:bg-[#2a2a2a] transition-colors flex flex-col items-center gap-1",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(kB,{size:14}),t.jsx("span",{className:"text-[9px]",children:"Section"})]}),t.jsxs("button",{onClick:()=>V("columns"),className:"px-2 py-2 text-xs rounded hover:bg-[#2a2a2a] transition-colors flex flex-col items-center gap-1",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(b4,{size:14}),t.jsx("span",{className:"text-[9px]",children:"Columns"})]}),t.jsxs("button",{onClick:()=>V("coverpage"),className:"px-2 py-2 text-xs rounded hover:bg-[#2a2a2a] transition-colors flex flex-col items-center gap-1",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(LT,{size:14}),t.jsx("span",{className:"text-[9px]",children:"Cover"})]}),t.jsxs("button",{onClick:()=>V("pagebreak"),className:"px-2 py-2 text-xs rounded hover:bg-[#2a2a2a] transition-colors flex flex-col items-center gap-1",style:{color:mt.TEXT_PRIMARY},children:[t.jsx(I4,{size:14}),t.jsx("span",{className:"text-[9px]",children:"Break"})]})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-xs font-bold mb-2",style:{color:mt.ORANGE},children:"SETTINGS"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"Page Theme"}),t.jsxs("select",{value:w,onChange:K=>y(K.target.value),className:"w-full px-2 py-1 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},children:[t.jsx("option",{value:"classic",children:"Classic White"}),t.jsx("option",{value:"minimal",children:"Minimal Grid"}),t.jsx("option",{value:"geometric",children:"Geometric Triangles"}),t.jsx("option",{value:"pattern",children:"Diagonal Pattern"}),t.jsx("option",{value:"modern",children:"Modern Gradient (Dark)"}),t.jsx("option",{value:"gradient",children:"Professional Gradient (Dark)"})]})]}),w==="classic"&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("label",{className:"text-[9px]",style:{color:mt.TEXT_SECONDARY},children:"Background Color"}),t.jsx("button",{onClick:()=>G(!O),className:"text-[9px] px-2 py-1 rounded hover:bg-[#2a2a2a]",style:{color:mt.ORANGE},children:O?"Hide Picker":"Show Picker"})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("div",{className:"w-8 h-8 rounded border-2 border-[#333333]",style:{backgroundColor:P}}),t.jsx("input",{type:"text",value:P,onChange:K=>I(K.target.value),className:"flex-1 px-2 py-1 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},placeholder:"#ffffff"})]}),O&&t.jsxs("div",{className:"p-3 rounded bg-[#0a0a0a] border border-[#333333] space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Color Palette"}),t.jsx("div",{className:"w-full h-32 rounded cursor-crosshair border border-[#333333] relative",style:{background:`
                                linear-gradient(to bottom, transparent, black),
                                linear-gradient(to right, white, hsl(${P.startsWith("#")?0:120}, 100%, 50%))
                              `},onClick:K=>{const Ee=K.currentTarget.getBoundingClientRect(),Oe=K.clientX-Ee.left,q=K.clientY-Ee.top,ee=Oe/Ee.width,ce=q/Ee.height,Ce=ee*360,be=100,We=100-ce*50;I(((se,Te,Me)=>{Me/=100;const Qe=Te*Math.min(Me,1-Me)/100,ye=ue=>{const re=(ue+se/30)%12,ke=Me-Qe*Math.max(Math.min(re-3,9-re,1),-1);return Math.round(255*ke).toString(16).padStart(2,"0")};return`#${ye(0)}${ye(8)}${ye(4)}`})(Ce,be,We))},children:t.jsx("div",{className:"absolute w-3 h-3 border-2 border-white rounded-full shadow-lg pointer-events-none",style:{left:"50%",top:"10%",transform:"translate(-50%, -50%)"}})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Hue"}),t.jsx("div",{className:"w-full h-6 rounded cursor-pointer border border-[#333333]",style:{background:"linear-gradient(to right, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000)"},onClick:K=>{const Ee=K.currentTarget.getBoundingClientRect(),q=(K.clientX-Ee.left)/Ee.width,ee=Math.round(q*360);I(((Ce,be,We)=>{We/=100;const J=be*Math.min(We,1-We)/100,se=Te=>{const Me=(Te+Ce/30)%12,Qe=We-J*Math.max(Math.min(Me-3,9-Me,1),-1);return Math.round(255*Qe).toString(16).padStart(2,"0")};return`#${se(0)}${se(8)}${se(4)}`})(ee,100,50))}})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Lightness"}),t.jsx("div",{className:"w-full h-6 rounded cursor-pointer border border-[#333333]",style:{background:"linear-gradient(to right, #000000, #808080, #ffffff)"},onClick:K=>{const Ee=K.currentTarget.getBoundingClientRect(),q=(K.clientX-Ee.left)/Ee.width,ee=Math.round(q*100);I(((Ce,be,We)=>{We/=100;const J=be*Math.min(We,1-We)/100,se=Te=>{const Me=(Te+Ce/30)%12,Qe=We-J*Math.max(Math.min(Me-3,9-Me,1),-1);return Math.round(255*Qe).toString(16).padStart(2,"0")};return`#${se(0)}${se(8)}${se(4)}`})(120,0,ee))}})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Preset Colors"}),t.jsx("div",{className:"grid grid-cols-8 gap-1",children:["#ffffff","#f8f9fa","#e9ecef","#dee2e6","#ced4da","#adb5bd","#6c757d","#495057","#fff3cd","#d1ecf1","#d4edda","#f8d7da","#e2e3e5","#d6d8db","#fef5e7","#ebf5fb","#ff0000","#ff7f00","#ffff00","#00ff00","#00ffff","#0000ff","#8b00ff","#ff00ff","#fff5f5","#ffe6e6","#ffd6cc","#ffe5cc","#fff4cc","#ffffcc","#f0fff4","#f0f9ff"].map(K=>t.jsx("button",{onClick:()=>I(K),className:`w-full aspect-square rounded border-2 transition-all hover:scale-110 ${P.toLowerCase()===K.toLowerCase()?"border-[#FFA500] ring-2 ring-[#FFA500]":"border-[#333333] hover:border-[#666]"}`,style:{backgroundColor:K},title:K},K))})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"Report Title"}),t.jsx("input",{type:"text",value:n.metadata.title,onChange:K=>i(Ee=>({...Ee,metadata:{...Ee.metadata,title:K.target.value}})),className:"w-full px-2 py-1 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},placeholder:"Enter report title..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"Author"}),t.jsx("input",{type:"text",value:n.metadata.author,onChange:K=>i(Ee=>({...Ee,metadata:{...Ee.metadata,author:K.target.value}})),className:"w-full px-2 py-1 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},placeholder:"Enter author name..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"Company"}),t.jsx("input",{type:"text",value:n.metadata.company,onChange:K=>i(Ee=>({...Ee,metadata:{...Ee.metadata,company:K.target.value}})),className:"w-full px-2 py-1 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},placeholder:"Enter company name..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"Font Family"}),t.jsxs("select",{value:C,onChange:K=>T(K.target.value),className:"w-full px-2 py-1 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},children:[t.jsx("option",{value:"Arial, sans-serif",children:"Arial"}),t.jsx("option",{value:"'Times New Roman', serif",children:"Times New Roman"}),t.jsx("option",{value:"Georgia, serif",children:"Georgia"}),t.jsx("option",{value:"'Courier New', monospace",children:"Courier New"}),t.jsx("option",{value:"Verdana, sans-serif",children:"Verdana"}),t.jsx("option",{value:"'Trebuchet MS', sans-serif",children:"Trebuchet MS"}),t.jsx("option",{value:"'Palatino Linotype', serif",children:"Palatino"}),t.jsx("option",{value:"Garamond, serif",children:"Garamond"}),t.jsx("option",{value:"'Comic Sans MS', cursive",children:"Comic Sans MS"}),t.jsx("option",{value:"'Lucida Console', monospace",children:"Lucida Console"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"Base Font Size"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"range",min:"8",max:"16",value:E,onChange:K=>j(Number(K.target.value)),className:"flex-1",style:{accentColor:mt.ORANGE}}),t.jsxs("span",{className:"text-xs",style:{color:mt.TEXT_PRIMARY,minWidth:"30px"},children:[E,"pt"]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"Text Style"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>A(!k),className:`flex-1 px-3 py-2 rounded border transition-all ${k?"bg-[#FFA500] border-[#FFA500] text-black":"bg-[#0a0a0a] border-[#333333] text-gray-400 hover:border-[#FFA500]"}`,title:"Toggle Bold",children:t.jsx($M,{size:16,className:"mx-auto"})}),t.jsx("button",{onClick:()=>M(!R),className:`flex-1 px-3 py-2 rounded border transition-all ${R?"bg-[#FFA500] border-[#FFA500] text-black":"bg-[#0a0a0a] border-[#333333] text-gray-400 hover:border-[#FFA500]"}`,title:"Toggle Italic",children:t.jsx(V4,{size:16,className:"mx-auto"})})]})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xs font-bold mb-2",style:{color:mt.ORANGE},children:"DOCUMENT STRUCTURE"}),t.jsx("div",{className:"space-y-0",children:n.components.length===0?t.jsx("p",{className:"text-xs text-center py-4",style:{color:mt.TEXT_SECONDARY},children:"No components yet"}):t.jsx(Eb,{sensors:le,collisionDetection:bb,onDragEnd:Re,children:t.jsx(jb,{items:n.components.map(K=>K.id),strategy:Cb,children:n.components.map(K=>t.jsx(qJ,{component:K,isSelected:o===K.id,onClick:()=>a(K.id),onDelete:()=>je(K.id),onDuplicate:()=>_e(K.id)},K.id))})})})]})]})}),t.jsx("div",{className:"w-3/5 overflow-y-auto p-6",style:{backgroundColor:"#0f0f0f"},children:t.jsxs("div",{className:"mx-auto shadow-lg",style:{width:"210mm",minHeight:"297mm",padding:"20mm",fontFamily:C,fontSize:`${E}pt`,fontWeight:k?"bold":"normal",fontStyle:R?"italic":"normal",...qe()},children:[t.jsxs("div",{className:"mb-8 border-b border-gray-300 pb-4",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:n.metadata.title}),n.metadata.company&&t.jsx("p",{className:"text-lg text-gray-600",children:n.metadata.company}),n.metadata.author&&t.jsxs("p",{className:"text-sm text-gray-500",children:["By ",n.metadata.author]}),t.jsx("p",{className:"text-sm text-gray-500",children:n.metadata.date})]}),n.components.length===0?t.jsxs("div",{className:"text-center py-16 text-gray-400",children:[t.jsx(ri,{className:"w-16 h-16 mx-auto mb-4 opacity-30"}),t.jsx("p",{className:"text-lg",children:"Your report is empty"}),t.jsx("p",{className:"text-sm mt-2",children:"Add components from the left panel to start building your report"})]}):t.jsx("div",{className:"space-y-4",children:n.components.map(K=>{const Ee=o===K.id;return t.jsxs("div",{onClick:()=>a(K.id),className:`cursor-pointer transition-all ${Ee?"ring-2 ring-orange-500 ring-offset-2":"hover:ring-1 hover:ring-gray-300"}`,children:[K.type==="heading"&&t.jsx("h2",{className:`font-bold text-2xl text-${K.config.alignment||"left"}`,children:K.content||"Heading"}),K.type==="text"&&t.jsx("p",{className:`text-${K.config.alignment||"left"}`,children:K.content||"Text content"}),K.type==="chart"&&t.jsxs("div",{className:"border border-gray-300 rounded p-8 bg-gray-50 text-center",children:[t.jsx(ja,{className:"w-16 h-16 mx-auto text-gray-400"}),t.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Chart Placeholder"})]}),K.type==="table"&&t.jsx("div",{className:"border border-gray-300 rounded overflow-hidden",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsx("tr",{children:(K.config.columns||["Column 1","Column 2","Column 3"]).map((Oe,q)=>t.jsx("th",{className:"px-4 py-2 text-left text-sm font-semibold",children:Oe},q))})}),t.jsx("tbody",{children:t.jsx("tr",{className:"border-t border-gray-200",children:(K.config.columns||["Column 1","Column 2","Column 3"]).map((Oe,q)=>t.jsx("td",{className:"px-4 py-2 text-sm",children:"Sample data"},q))})})]})}),K.type==="image"&&t.jsx("div",{className:"border border-gray-300 rounded p-4 bg-gray-50",children:K.config.imageUrl?t.jsx("img",{src:`file://${K.config.imageUrl}`,alt:"Report Image",className:"max-w-full h-auto"}):t.jsxs("div",{className:"text-center py-8 text-gray-400",children:[t.jsx(q0,{className:"w-12 h-12 mx-auto mb-2"}),t.jsx("p",{className:"text-sm",children:"No image selected"})]})}),K.type==="code"&&t.jsx("pre",{className:"bg-gray-900 text-green-400 p-4 rounded overflow-x-auto text-sm font-mono",children:t.jsx("code",{children:K.content||"// Code block"})}),K.type==="divider"&&t.jsx("hr",{className:"border-t-2 border-gray-300 my-4"}),K.type==="section"&&t.jsxs("div",{className:"border-l-4 p-4 my-4",style:{borderColor:K.config.borderColor||"#FFA500",backgroundColor:K.config.backgroundColor||"#f8f9fa"},children:[t.jsx("h3",{className:"font-bold text-lg mb-2",style:{color:K.config.borderColor||"#FFA500"},children:K.config.sectionTitle||"SECTION"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Section content area - add child components here"})]}),K.type==="columns"&&t.jsx("div",{className:`grid gap-4 my-4 ${K.config.columnCount===3?"grid-cols-3":"grid-cols-2"}`,children:Array.from({length:K.config.columnCount||2}).map((Oe,q)=>t.jsx("div",{className:"border border-gray-300 rounded p-4 bg-gray-50",children:t.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["Column ",q+1]})},q))}),K.type==="coverpage"&&t.jsxs("div",{className:"min-h-[400px] flex flex-col items-center justify-center text-center p-12",style:{backgroundColor:K.config.backgroundColor||"#0a0a0a",color:"#FFA500"},children:[t.jsx("h1",{className:"text-4xl font-bold mb-4",children:n.metadata.title}),K.config.subtitle&&t.jsx("p",{className:"text-xl mb-8",children:K.config.subtitle}),t.jsxs("div",{className:"text-sm text-gray-400 mt-auto",children:[n.metadata.company,t.jsx("br",{}),n.metadata.author,t.jsx("br",{}),n.metadata.date]})]}),K.type==="pagebreak"&&t.jsx("div",{className:"my-8 py-4 border-t-2 border-dashed border-gray-400 text-center",children:t.jsx("span",{className:"text-xs text-gray-400 bg-white px-3 py-1 rounded-full",children:"Page Break"})})]},K.id)})})]})}),t.jsxs("div",{className:"w-1/5 border-l flex flex-col min-h-0",style:{borderColor:mt.BORDER,backgroundColor:mt.PANEL_BG},children:[t.jsxs("div",{className:"flex border-b",style:{borderColor:mt.BORDER},children:[t.jsxs("button",{onClick:()=>ge("properties"),className:`flex-1 px-3 py-2 text-xs font-semibold transition-colors flex items-center justify-center gap-1 ${me==="properties"?"bg-[#FFA500] text-black":"bg-transparent hover:bg-[#2a2a2a]"}`,style:{color:me==="properties"?"#000":mt.TEXT_PRIMARY},children:[t.jsx(Mn,{size:14}),"Properties"]}),t.jsxs("button",{onClick:()=>ge("chat"),className:`flex-1 px-3 py-2 text-xs font-semibold transition-colors flex items-center justify-center gap-1 ${me==="chat"?"bg-[#FFA500] text-black":"bg-transparent hover:bg-[#2a2a2a]"}`,style:{color:me==="chat"?"#000":mt.TEXT_PRIMARY},children:[t.jsx(Qg,{size:14}),"AI Chat"]}),t.jsx("button",{onClick:()=>ge("split"),className:`px-3 py-2 text-xs font-semibold transition-colors flex items-center justify-center ${me==="split"?"bg-[#FFA500] text-black":"bg-transparent hover:bg-[#2a2a2a]"}`,style:{color:me==="split"?"#000":mt.TEXT_PRIMARY},title:"Split View",children:t.jsx(uB,{size:14})})]}),(me==="properties"||me==="split")&&t.jsx("div",{className:`${me==="split"?"flex-1 border-b":"flex-1"} overflow-y-auto min-h-0`,style:{borderColor:mt.BORDER},children:X?t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-sm font-bold",style:{color:mt.ORANGE},children:"PROPERTIES"}),t.jsx("button",{onClick:()=>a(null),className:"p-1 hover:bg-[#2a2a2a] rounded",style:{color:mt.TEXT_SECONDARY},children:t.jsx(ln,{size:16})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Type"}),t.jsx("div",{className:"px-3 py-2 text-xs rounded bg-[#0a0a0a] capitalize",children:X.type})]}),(X.type==="heading"||X.type==="text"||X.type==="code")&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Content"}),t.jsx("textarea",{value:X.content||"",onChange:K=>de(X.id,{content:K.target.value}),className:"w-full px-3 py-2 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},rows:X.type==="code"?10:4,placeholder:"Enter content..."})]}),(X.type==="heading"||X.type==="text")&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Alignment"}),t.jsx("div",{className:"flex gap-2",children:["left","center","right"].map(K=>t.jsx("button",{onClick:()=>de(X.id,{config:{...X.config,alignment:K}}),className:`flex-1 px-3 py-2 text-xs rounded transition-colors capitalize ${X.config.alignment===K?"bg-[#FFA500] text-black":"bg-[#0a0a0a] hover:bg-[#2a2a2a]"}`,children:K},K))})]}),(X.type==="heading"||X.type==="text")&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Font Size"}),t.jsxs("select",{value:X.config.fontSize||"base",onChange:K=>de(X.id,{config:{...X.config,fontSize:K.target.value}}),className:"w-full px-3 py-2 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},children:[t.jsx("option",{value:"xs",children:"Extra Small"}),t.jsx("option",{value:"sm",children:"Small"}),t.jsx("option",{value:"base",children:"Base"}),t.jsx("option",{value:"lg",children:"Large"}),t.jsx("option",{value:"xl",children:"Extra Large"}),t.jsx("option",{value:"2xl",children:"2X Large"}),t.jsx("option",{value:"3xl",children:"3X Large"})]})]}),X.type==="image"&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold mb-2 block",style:{color:mt.TEXT_SECONDARY},children:"Image"}),X.config.imageUrl?t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-xs text-gray-400 break-all bg-[#0a0a0a] p-2 rounded",children:X.config.imageUrl.split("\\").pop()}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:Ie,className:"flex-1 px-3 py-2 text-xs rounded bg-blue-600 hover:bg-blue-700 transition-colors",children:"Change Image"}),t.jsx("button",{onClick:()=>de(X.id,{config:{...X.config,imageUrl:void 0}}),className:"flex-1 px-3 py-2 text-xs rounded bg-red-600 hover:bg-red-700 transition-colors",children:"Remove"})]})]}):t.jsxs("button",{onClick:Ie,className:"w-full px-3 py-2 text-xs rounded transition-colors flex items-center justify-center gap-2",style:{backgroundColor:mt.ORANGE,color:mt.BLACK},children:[t.jsx(wn,{size:14}),"Upload Image"]})]}),X.type==="table"&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Columns (comma-separated)"}),t.jsx("input",{type:"text",value:(X.config.columns||[]).join(", "),onChange:K=>de(X.id,{config:{...X.config,columns:K.target.value.split(",").map(Ee=>Ee.trim())}}),className:"w-full px-3 py-2 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},placeholder:"Column 1, Column 2, Column 3"})]}),X.type==="chart"&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-semibold mb-1 block",style:{color:mt.TEXT_SECONDARY},children:"Chart Type"}),t.jsxs("select",{value:X.config.chartType||"bar",onChange:K=>de(X.id,{config:{...X.config,chartType:K.target.value}}),className:"w-full px-3 py-2 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},children:[t.jsx("option",{value:"bar",children:"Bar Chart"}),t.jsx("option",{value:"line",children:"Line Chart"}),t.jsx("option",{value:"pie",children:"Pie Chart"}),t.jsx("option",{value:"area",children:"Area Chart"})]})]}),t.jsx("div",{className:"pt-4 border-t",style:{borderColor:mt.BORDER},children:t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>_e(X.id),className:"flex-1 px-3 py-2 text-xs rounded bg-[#0a0a0a] hover:bg-[#2a2a2a] transition-colors flex items-center justify-center gap-2",children:[t.jsx(hc,{size:14}),"Duplicate"]}),t.jsxs("button",{onClick:()=>je(X.id),className:"flex-1 px-3 py-2 text-xs rounded bg-red-600 hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[t.jsx(On,{size:14}),"Delete"]})]})})]})]}):t.jsxs("div",{className:"p-4 text-center",style:{color:mt.TEXT_SECONDARY},children:[t.jsx(Mn,{size:32,className:"mx-auto mb-2 opacity-30"}),t.jsx("p",{className:"text-xs",children:"Select a component to edit properties"})]})}),(me==="chat"||me==="split")&&t.jsxs("div",{className:"flex-1 flex flex-col min-h-0",style:{backgroundColor:mt.PANEL_BG},children:[t.jsxs("div",{className:"p-4 border-b border-[#333333] flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(xi,{size:18,style:{color:mt.ORANGE}}),t.jsx("h3",{className:"text-sm font-bold",style:{color:mt.ORANGE},children:"AI WRITING ASSISTANT"})]}),t.jsx(_d,{size:16,style:{color:mt.ORANGE}})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"text-[9px] block mb-1",style:{color:mt.TEXT_SECONDARY},children:"AI Model"}),t.jsxs("select",{value:oe,onChange:K=>Z(K.target.value),className:"w-full px-2 py-1 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},children:[fe.map(K=>t.jsxs("option",{value:K.provider,children:[K.name," (",K.provider,")"]},K.id)),fe.length===0&&t.jsx("option",{value:"ollama",children:"Configure in Settings"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[t.jsx("button",{onClick:()=>$e("improve"),className:"px-2 py-1 text-[9px] rounded bg-[#0a0a0a] border border-[#333333] hover:border-[#FFA500] transition-colors",style:{color:mt.TEXT_PRIMARY},children:" Improve"}),t.jsx("button",{onClick:()=>$e("expand"),className:"px-2 py-1 text-[9px] rounded bg-[#0a0a0a] border border-[#333333] hover:border-[#FFA500] transition-colors",style:{color:mt.TEXT_PRIMARY},children:" Expand"}),t.jsx("button",{onClick:()=>$e("summarize"),className:"px-2 py-1 text-[9px] rounded bg-[#0a0a0a] border border-[#333333] hover:border-[#FFA500] transition-colors",style:{color:mt.TEXT_PRIMARY},children:" Summary"}),t.jsx("button",{onClick:()=>$e("grammar"),className:"px-2 py-1 text-[9px] rounded bg-[#0a0a0a] border border-[#333333] hover:border-[#FFA500] transition-colors",style:{color:mt.TEXT_PRIMARY},children:" Grammar"})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 min-h-0",children:[B.length===0&&t.jsxs("div",{className:"text-center py-8",children:[t.jsx(xi,{size:32,className:"mx-auto mb-3",style:{color:mt.TEXT_SECONDARY}}),t.jsx("p",{className:"text-xs",style:{color:mt.TEXT_SECONDARY},children:"Ask me to help you write better reports!"}),t.jsx("p",{className:"text-[9px] mt-2",style:{color:mt.TEXT_SECONDARY},children:'Try: "Help me write an introduction"'})]}),B.map((K,Ee)=>t.jsxs("div",{className:`flex gap-2 ${K.role==="user"?"justify-end":"justify-start"}`,children:[K.role==="assistant"&&t.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:mt.ORANGE},children:t.jsx(xi,{size:14,style:{color:"#000"}})}),t.jsx("div",{className:`max-w-[85%] rounded-lg p-3 ${K.role==="user"?"bg-[#FFA500] text-black":"bg-[#1a1a1a] border border-[#333333]"}`,children:t.jsx("div",{className:"text-xs break-words",style:{color:K.role==="user"?"#000":mt.TEXT_PRIMARY},children:K.role==="assistant"?t.jsx(vg,{content:K.content}):K.content})}),K.role==="user"&&t.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center bg-[#333333]",children:t.jsx(Kp,{size:14,style:{color:mt.TEXT_PRIMARY}})})]},Ee)),W&&_&&t.jsxs("div",{className:"flex gap-2 justify-start",children:[t.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:mt.ORANGE},children:t.jsx(xi,{size:14,style:{color:"#000"}})}),t.jsx("div",{className:"max-w-[85%] rounded-lg p-3 bg-[#1a1a1a] border border-[#333333]",children:t.jsx("div",{className:"text-xs break-words",style:{color:mt.TEXT_PRIMARY},children:t.jsx(vg,{content:_})})})]}),W&&!_&&t.jsxs("div",{className:"flex gap-2 justify-start",children:[t.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:mt.ORANGE},children:t.jsx(xi,{size:14,style:{color:"#000"}})}),t.jsx("div",{className:"max-w-[85%] rounded-lg p-3 bg-[#1a1a1a] border border-[#333333]",children:t.jsxs("div",{className:"text-xs flex gap-1",style:{color:mt.TEXT_SECONDARY},children:[t.jsx("span",{className:"animate-bounce",children:""}),t.jsx("span",{className:"animate-bounce delay-100",children:""}),t.jsx("span",{className:"animate-bounce delay-200",children:""})]})})]}),t.jsx("div",{ref:he})]}),t.jsx("div",{className:"p-4 border-t border-[#333333] flex-shrink-0",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:z,onChange:K=>$(K.target.value),onKeyPress:K=>K.key==="Enter"&&Ae(),placeholder:"Ask AI to help with your report...",className:"flex-1 px-3 py-2 text-xs rounded bg-[#0a0a0a] border border-[#333333] focus:border-[#FFA500] outline-none",style:{color:mt.TEXT_PRIMARY},disabled:W}),t.jsx("button",{onClick:Ae,disabled:W||!z.trim(),className:"px-3 py-2 rounded transition-all disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:mt.ORANGE,color:"#000"},children:t.jsx(Zg,{size:16})})]})})]})]})]}),t.jsx(n2,{open:h,onOpenChange:x,children:t.jsxs(s2,{className:"bg-[#1a1a1a] border-[#333333]",children:[t.jsxs(i2,{children:[t.jsx(a2,{className:"text-[#FFA500]",children:"PDF Generated Successfully!"}),t.jsx(l2,{className:"text-gray-400",children:"Your report has been generated and saved."})]}),t.jsxs("div",{className:"py-4",children:[t.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"File saved to:"}),t.jsx("p",{className:"text-xs text-gray-500 break-all bg-[#0a0a0a] p-2 rounded border border-[#333333]",children:m})]}),t.jsxs(o2,{children:[t.jsx(Tr,{variant:"outline",onClick:()=>x(!1),className:"bg-transparent border-[#333333] text-white hover:bg-[#2a2a2a]",children:"Close"}),t.jsxs(Tr,{onClick:ve,className:"bg-[#FFA500] text-black hover:bg-[#ff8c00]",children:[t.jsx(VE,{className:"w-4 h-4 mr-2"}),"Show in Folder"]})]})]})}),t.jsxs("div",{style:{borderTop:`2px solid ${mt.ORANGE}`,padding:"8px 16px",background:`linear-gradient(180deg, ${mt.PANEL_BG} 0%, #0a0a0a 100%)`,display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0,flexWrap:"wrap",gap:"12px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",fontSize:"9px"},children:[t.jsx("span",{style:{color:mt.ORANGE,fontWeight:"bold"},children:"REPORT BUILDER v1.0.0"}),t.jsx("span",{style:{color:mt.TEXT_SECONDARY},children:"|"}),t.jsxs("span",{style:{color:mt.TEXT_PRIMARY},children:["Components: ",n.components.length]}),t.jsx("span",{style:{color:mt.TEXT_SECONDARY},children:"|"}),t.jsxs("span",{style:{color:mt.TEXT_PRIMARY},children:["Theme: ",w.charAt(0).toUpperCase()+w.slice(1)]})]}),t.jsxs("div",{style:{fontSize:"9px",color:mt.TEXT_SECONDARY},children:[e.toLocaleTimeString()," | PDF Generator: Rust printpdf"]})]})]})},YJ=()=>{const s={bg:"#0A0A0A",panel:"#1A1A1A",border:"#2A2A2A",accent:"#FF8800",text:"#FFFFFF",textMuted:"#888888",success:"#00FF88",alert:"#FF4444"},[e,r]=S.useState(null),[n,i]=S.useState([]),[o,a]=S.useState(!1),[l,d]=S.useState({symbol:"SPY",startDate:new Date(Date.now()-365*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],initialCapital:1e5,strategyType:"sma_crossover",parameters:{fastPeriod:10,slowPeriod:20},commission:.001,slippage:5e-4,leverage:1}),[p,f]=S.useState(!1),[h,x]=S.useState(null),[m,b]=S.useState(null),[w,y]=S.useState({provider:!0,symbol:!0,strategy:!0,parameters:!0,advanced:!1,results:!0});S.useEffect(()=>{C()},[]);const C=async()=>{try{const I=Ss.listProviders().map(B=>typeof B=="string"?B:B.name);i(I);const G=(await Je.getBacktestingProviders()).find(B=>B.is_active===!0||B.is_active===1);G?r(G.name):I.length>0&&r(I[0])}catch(P){console.error("[Backtesting] Failed to initialize providers:",P),b("Failed to load backtesting providers")}},T=async P=>{try{if(a(!1),!Ss.getProvider(P))throw new Error(`Provider ${P} not found`);await Ss.setActiveProvider(P),await Je.setActiveBacktestingProvider(P),r(P),b(null),E(P)}catch(I){b(`Failed to switch provider: ${I}`)}},E=P=>{P==="Backtesting.py"?d(I=>({...I,strategyType:"sma_crossover",parameters:{fastPeriod:10,slowPeriod:20},commission:.001})):P==="QuantConnect Lean"?d(I=>({...I,strategyType:"custom",commission:0})):P==="VectorBT"&&d(I=>({...I,strategyType:"sma_crossover",parameters:{fastWindow:10,slowWindow:20}}))},j=async()=>{if(!e){b("No active provider selected");return}f(!0),b(null),x(null);try{const P=Ss.getProvider(e);if(!P)throw new Error("Provider not found");const I={strategy:{name:`${l.strategyType} - ${l.symbol}`,type:l.strategyType,code:l.strategyCode,parameters:l.parameters},startDate:l.startDate,endDate:l.endDate,initialCapital:l.initialCapital,assets:[{symbol:l.symbol,assetClass:"stocks",weight:1}],commission:l.commission,tradeOnClose:!1,hedging:!1,exclusiveOrders:!0,margin:l.leverage};console.log("[Backtesting] Running backtest:",I);const O=await P.runBacktest(I);x(O),y(G=>({...G,results:!0}))}catch(P){console.error("[Backtesting] Error:",P),b(String(P))}finally{f(!1)}},k=P=>{y(I=>({...I,[P]:!I[P]}))},A=({title:P,section:I,icon:O})=>t.jsxs("div",{onClick:()=>k(I),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",background:s.panel,borderBottom:`1px solid ${s.border}`,cursor:"pointer",userSelect:"none"},children:[w[I]?t.jsx(bi,{size:16}):t.jsx(Rd,{size:16}),O,t.jsx("span",{style:{fontWeight:600,fontSize:"0.9rem"},children:P})]}),R=({label:P,children:I,description:O})=>t.jsxs("div",{style:{marginBottom:"16px"},children:[t.jsx("label",{style:{display:"block",fontSize:"0.85rem",color:s.textMuted,marginBottom:"6px",fontWeight:500},children:P}),I,O&&t.jsx("div",{style:{fontSize:"0.75rem",color:s.textMuted,marginTop:"4px"},children:O})]}),M=()=>l.strategyType==="sma_crossover"?t.jsxs(t.Fragment,{children:[t.jsx(R,{label:"Fast Period",description:"Short-term moving average",children:t.jsx("input",{type:"number",value:l.parameters.fastPeriod||10,onChange:P=>d(I=>({...I,parameters:{...I.parameters,fastPeriod:parseInt(P.target.value)}})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})}),t.jsx(R,{label:"Slow Period",description:"Long-term moving average",children:t.jsx("input",{type:"number",value:l.parameters.slowPeriod||20,onChange:P=>d(I=>({...I,parameters:{...I.parameters,slowPeriod:parseInt(P.target.value)}})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})})]}):l.strategyType==="rsi"?t.jsxs(t.Fragment,{children:[t.jsx(R,{label:"RSI Period",description:"Lookback period for RSI",children:t.jsx("input",{type:"number",value:l.parameters.period||14,onChange:P=>d(I=>({...I,parameters:{...I.parameters,period:parseInt(P.target.value)}})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})}),t.jsx(R,{label:"Oversold Threshold",children:t.jsx("input",{type:"number",value:l.parameters.oversold||30,onChange:P=>d(I=>({...I,parameters:{...I.parameters,oversold:parseInt(P.target.value)}})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})}),t.jsx(R,{label:"Overbought Threshold",children:t.jsx("input",{type:"number",value:l.parameters.overbought||70,onChange:P=>d(I=>({...I,parameters:{...I.parameters,overbought:parseInt(P.target.value)}})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})})]}):l.strategyType==="custom"&&e==="Backtesting.py"?t.jsx(R,{label:"Python Strategy Code",description:"Custom strategy using Backtesting.py API",children:t.jsx("textarea",{value:l.strategyCode||"",onChange:P=>d(I=>({...I,strategyCode:P.target.value})),placeholder:`class MyStrategy(Strategy):
    def init(self):
        self.sma = self.I(SMA, self.data.Close, 20)

    def next(self):
        if self.data.Close[-1] > self.sma[-1]:
            self.buy()
        elif self.data.Close[-1] < self.sma[-1]:
            self.sell()`,style:{width:"100%",minHeight:"200px",padding:"12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.85rem",fontFamily:"monospace",resize:"vertical"}})}):null;return t.jsxs("div",{style:{width:"100%",height:"100%",background:s.bg,color:s.text,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{backgroundColor:"#1A1A1A",borderBottom:`2px solid ${s.accent}`,padding:"12px 20px",boxShadow:"0 2px 8px rgba(255, 136, 0, 0.2)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[t.jsx(Cs,{size:20,color:s.accent,style:{filter:`drop-shadow(0 0 4px ${s.accent})`}}),t.jsx("span",{style:{color:s.accent,fontWeight:700,fontSize:"15px",letterSpacing:"0.5px",textShadow:"0 0 10px rgba(255, 136, 0, 0.4)"},children:"BACKTESTING ENGINE"})]}),t.jsxs("div",{style:{position:"relative"},children:[t.jsxs("button",{onClick:()=>a(!o),style:{padding:"6px 14px",background:s.panel,border:`1px solid ${s.accent}`,borderRadius:"4px",color:s.text,cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",fontSize:"0.85rem",fontWeight:600},children:[t.jsx(Mn,{size:14}),e||"Select Provider",t.jsx(bi,{size:14})]}),o&&t.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"4px",background:s.panel,border:`1px solid ${s.accent}`,borderRadius:"4px",minWidth:"200px",zIndex:1e3,boxShadow:"0 4px 12px rgba(0,0,0,0.5)"},children:n.map(P=>t.jsx("div",{onClick:()=>T(P),style:{padding:"10px 14px",cursor:"pointer",borderBottom:`1px solid ${s.border}`,background:P===e?`${s.accent}22`:"transparent",color:P===e?s.accent:s.text,fontWeight:P===e?600:400},children:P},P))})]})]}),t.jsxs("div",{style:{flex:1,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",padding:"16px",overflow:"auto"},children:[t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[t.jsxs("div",{style:{background:s.panel,border:`1px solid ${s.border}`,borderRadius:"6px",overflow:"hidden"},children:[t.jsx(A,{title:"Symbol & Timeframe",section:"symbol",icon:t.jsx(Nr,{size:16})}),w.symbol&&t.jsxs("div",{style:{padding:"16px"},children:[t.jsx(R,{label:"Symbol",description:"Stock ticker to backtest",children:t.jsx("input",{type:"text",value:l.symbol,onChange:P=>d(I=>({...I,symbol:P.target.value.toUpperCase()})),placeholder:"SPY",style:{width:"100%",padding:"10px 14px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"1rem",fontWeight:600,textTransform:"uppercase"}})}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[t.jsx(R,{label:"Start Date",children:t.jsx("input",{type:"date",value:l.startDate,onChange:P=>d(I=>({...I,startDate:P.target.value})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})}),t.jsx(R,{label:"End Date",children:t.jsx("input",{type:"date",value:l.endDate,onChange:P=>d(I=>({...I,endDate:P.target.value})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})})]}),t.jsx(R,{label:"Initial Capital",children:t.jsx("input",{type:"number",value:l.initialCapital,onChange:P=>d(I=>({...I,initialCapital:parseFloat(P.target.value)})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})})]})]}),t.jsxs("div",{style:{background:s.panel,border:`1px solid ${s.border}`,borderRadius:"6px",overflow:"hidden"},children:[t.jsx(A,{title:"Strategy Configuration",section:"strategy",icon:t.jsx(Mn,{size:16})}),w.strategy&&t.jsx("div",{style:{padding:"16px"},children:t.jsx(R,{label:"Strategy Type",children:t.jsxs("select",{value:l.strategyType,onChange:P=>d(I=>({...I,strategyType:P.target.value,parameters:{}})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"},children:[t.jsx("option",{value:"sma_crossover",children:"SMA Crossover"}),t.jsx("option",{value:"rsi",children:"RSI Strategy"}),t.jsx("option",{value:"macd",children:"MACD Strategy"}),e==="Backtesting.py"&&t.jsx("option",{value:"custom",children:"Custom Python Code"})]})})})]}),t.jsxs("div",{style:{background:s.panel,border:`1px solid ${s.border}`,borderRadius:"6px",overflow:"hidden"},children:[t.jsx(A,{title:"Strategy Parameters",section:"parameters",icon:t.jsx(Mn,{size:16})}),w.parameters&&t.jsx("div",{style:{padding:"16px"},children:M()})]}),t.jsxs("div",{style:{background:s.panel,border:`1px solid ${s.border}`,borderRadius:"6px",overflow:"hidden"},children:[t.jsx(A,{title:"Advanced Settings",section:"advanced",icon:t.jsx(Mn,{size:16})}),w.advanced&&t.jsxs("div",{style:{padding:"16px"},children:[t.jsx(R,{label:"Commission (%)",description:"Trading commission percentage",children:t.jsx("input",{type:"number",step:"0.0001",value:l.commission,onChange:P=>d(I=>({...I,commission:parseFloat(P.target.value)})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})}),t.jsx(R,{label:"Slippage (%)",description:"Expected slippage per trade",children:t.jsx("input",{type:"number",step:"0.0001",value:l.slippage,onChange:P=>d(I=>({...I,slippage:parseFloat(P.target.value)})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})}),t.jsx(R,{label:"Leverage",description:"Margin/leverage multiplier",children:t.jsx("input",{type:"number",step:"0.1",value:l.leverage,onChange:P=>d(I=>({...I,leverage:parseFloat(P.target.value)})),style:{width:"100%",padding:"8px 12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"4px",color:s.text,fontSize:"0.9rem"}})})]})]}),t.jsx("button",{onClick:j,disabled:p||!e,style:{padding:"14px",background:p?s.border:`linear-gradient(135deg, ${s.accent}, #FF6600)`,border:"none",borderRadius:"6px",color:s.text,fontSize:"1rem",fontWeight:700,cursor:p?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",boxShadow:p?"none":"0 4px 12px rgba(255, 136, 0, 0.3)",transition:"all 0.2s"},children:p?t.jsxs(t.Fragment,{children:[t.jsx(BT,{size:18}),"Running Backtest..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Ms,{size:18}),"Run Backtest"]})}),m&&t.jsx("div",{style:{padding:"12px",background:`${s.alert}22`,border:`1px solid ${s.alert}`,borderRadius:"6px",color:s.alert,fontSize:"0.85rem"},children:m})]}),t.jsxs("div",{style:{background:s.panel,border:`1px solid ${s.border}`,borderRadius:"6px",overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx(A,{title:"Backtest Results",section:"results",icon:t.jsx(Nr,{size:16})}),w.results&&t.jsxs("div",{style:{flex:1,padding:"16px",overflow:"auto"},children:[!h&&!p&&t.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:s.textMuted,fontSize:"0.9rem"},children:'Configure your backtest and click "Run Backtest" to see results'}),p&&t.jsxs("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"16px"},children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#FF8800]"}),t.jsxs("div",{style:{color:s.textMuted},children:["Running backtest on ",e,"..."]})]}),h&&t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[t.jsxs("div",{style:{padding:"16px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"6px"},children:[t.jsx("h4",{style:{marginBottom:"12px",fontSize:"0.9rem",color:s.textMuted},children:"Backtest Summary"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"0.85rem"},children:[t.jsxs("div",{children:["Symbol: ",t.jsx("span",{style:{color:s.accent,fontWeight:600},children:l.symbol})]}),t.jsxs("div",{children:["Strategy: ",t.jsx("span",{style:{color:s.text,fontWeight:600},children:l.strategyType})]}),t.jsxs("div",{children:["Period: ",l.startDate," to ",l.endDate]}),t.jsxs("div",{children:["Provider: ",e]})]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[{label:"Total Return",value:((h.performance?.totalReturn??0)*100).toFixed(2)+"%",positive:(h.performance?.totalReturn??0)>0},{label:"Sharpe Ratio",value:(h.performance?.sharpeRatio??0).toFixed(2),positive:(h.performance?.sharpeRatio??0)>0},{label:"Max Drawdown",value:((h.performance?.maxDrawdown??0)*100).toFixed(2)+"%",positive:!1},{label:"Win Rate",value:((h.performance?.winRate??0)*100).toFixed(1)+"%",positive:!0},{label:"Total Trades",value:(h.performance?.totalTrades??0).toString(),positive:!0},{label:"Profit Factor",value:(h.performance?.profitFactor??0).toFixed(2),positive:(h.performance?.profitFactor??0)>1}].map(P=>t.jsxs("div",{style:{padding:"12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"6px"},children:[t.jsx("div",{style:{fontSize:"0.75rem",color:s.textMuted,marginBottom:"4px"},children:P.label}),t.jsx("div",{style:{fontSize:"1.3rem",fontWeight:"bold",color:P.positive?s.success:s.alert},children:P.value})]},P.label))}),t.jsxs("div",{style:{padding:"12px",background:s.bg,border:`1px solid ${s.border}`,borderRadius:"6px"},children:[t.jsx("h4",{style:{marginBottom:"8px",fontSize:"0.85rem"},children:"Recent Trades"}),t.jsxs("div",{style:{fontSize:"0.75rem",color:s.textMuted},children:[h.trades?.length??0," total trades executed"]})]})]})]})]})]})]})},KJ=()=>{const{colors:s}=Er(),[e,r]=S.useState([]),[n,i]=S.useState([]),[o,a]=S.useState(""),[l,d]=S.useState("all"),[p,f]=S.useState("all"),[h,x]=S.useState(null),[m,b]=S.useState("json"),[w,y]=S.useState(""),[C,T]=S.useState(!1),[E,j]=S.useState({count:0,totalSize:0,formattedSize:"0 Bytes"});S.useEffect(()=>{k(),A()},[]),S.useEffect(()=>{R()},[e,o,l,p]);const k=async()=>{T(!0);try{const $=await qn.getRecordedContexts({limit:1e3});r($)}catch($){console.error("[ContextsManager] Failed to load contexts:",$)}finally{T(!1)}},A=async()=>{try{const $=await qn.getStorageStats();j($)}catch($){console.error("[ContextsManager] Failed to load stats:",$)}},R=()=>{let $=[...e];if(l!=="all"&&($=$.filter(W=>W.tab_name===l)),p!=="all"&&($=$.filter(W=>W.data_type===p)),o){const W=o.toLowerCase();$=$.filter(D=>D.label?.toLowerCase().includes(W)||D.tab_name.toLowerCase().includes(W)||D.data_type.toLowerCase().includes(W)||D.tags?.toLowerCase().includes(W))}i($)},M=async $=>{if(confirm("Are you sure you want to delete this recorded context?"))try{await qn.deleteContext($),await k(),await A(),h?.id===$&&x(null)}catch(W){console.error("[ContextsManager] Failed to delete context:",W)}},P=async $=>{try{const W=await qn.exportContext($),D=new Blob([W],{type:"application/json"}),oe=URL.createObjectURL(D),Z=document.createElement("a");Z.href=oe,Z.download=`context_${$}.json`,Z.click(),URL.revokeObjectURL(oe)}catch(W){console.error("[ContextsManager] Failed to export context:",W)}},I=async $=>{x($),await O($.id,m)},O=async($,W)=>{try{const D=await qn.formatContextForLLM($,W);y(D)}catch(D){console.error("[ContextsManager] Failed to load preview:",D),y("Error loading preview")}},G=async $=>{b($),h&&await O(h.id,$)},B=()=>Array.from(new Set(e.map($=>$.tab_name))).sort(),F=()=>Array.from(new Set(e.map($=>$.data_type))).sort(),z=$=>{if($===0)return"0 B";const W=1024,D=["B","KB","MB","GB"],oe=Math.floor(Math.log($)/Math.log(W));return Math.round($/Math.pow(W,oe)*100)/100+" "+D[oe]};return t.jsxs("div",{style:{padding:"16px",height:"100%",overflow:"auto"},children:[t.jsxs("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,marginBottom:"16px",padding:"16px"},children:[t.jsxs("div",{style:{borderBottom:`1px solid ${s.textMuted}`,paddingBottom:"12px",marginBottom:"16px"},children:[t.jsx("div",{style:{color:s.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"4px"},children:"RECORDED CONTEXTS"}),t.jsx("div",{style:{color:s.textMuted,fontSize:"11px"},children:"Manage all recorded data contexts from tabs"})]}),t.jsxs("div",{style:{display:"flex",gap:"24px",fontSize:"11px"},children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"TOTAL CONTEXTS:"})," ",t.jsx("span",{style:{color:s.text,fontWeight:"bold"},children:E.count})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:s.textMuted},children:"STORAGE USED:"})," ",t.jsx("span",{style:{color:s.text,fontWeight:"bold"},children:E.formattedSize})]})]})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px",alignItems:"center"},children:[t.jsxs("div",{style:{position:"relative",flex:1},children:[t.jsx(Ho,{size:14,style:{position:"absolute",left:"8px",top:"50%",transform:"translateY(-50%)",color:s.textMuted}}),t.jsx("input",{type:"text",placeholder:"Search contexts...",value:o,onChange:$=>a($.target.value),style:{width:"100%",backgroundColor:s.background,border:`1px solid ${s.textMuted}`,color:s.text,padding:"6px 8px 6px 32px",fontSize:"11px",outline:"none"}})]}),t.jsxs("select",{value:l,onChange:$=>d($.target.value),style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,color:s.text,padding:"6px 8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",outline:"none",minWidth:"150px"},children:[t.jsx("option",{value:"all",children:"ALL TABS"}),B().map($=>t.jsx("option",{value:$,children:$.toUpperCase()},$))]}),t.jsxs("select",{value:p,onChange:$=>f($.target.value),style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,color:s.text,padding:"6px 8px",fontSize:"11px",fontWeight:"bold",cursor:"pointer",outline:"none",minWidth:"150px"},children:[t.jsx("option",{value:"all",children:"ALL TYPES"}),F().map($=>t.jsx("option",{value:$,children:$.toUpperCase()},$))]})]}),t.jsx("div",{style:{backgroundColor:s.panel,border:`1px solid ${s.textMuted}`,overflow:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{backgroundColor:s.background,borderBottom:`1px solid ${s.textMuted}`},children:[t.jsx("th",{style:rc(s),children:"LABEL"}),t.jsx("th",{style:rc(s),children:"TAB"}),t.jsx("th",{style:rc(s),children:"TYPE"}),t.jsx("th",{style:rc(s),children:"SIZE"}),t.jsx("th",{style:rc(s),children:"CREATED"}),t.jsx("th",{style:rc(s),children:"TAGS"}),t.jsx("th",{style:{...rc(s),textAlign:"right"},children:"ACTIONS"})]})}),t.jsx("tbody",{children:C?t.jsx("tr",{children:t.jsx("td",{colSpan:7,style:{padding:"32px",textAlign:"center",color:s.textMuted,fontSize:"11px"},children:"Loading contexts..."})}):n.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:7,style:{padding:"32px",textAlign:"center",color:s.textMuted,fontSize:"11px"},children:"No recorded contexts found"})}):n.map(($,W)=>t.jsxs("tr",{style:{borderBottom:`1px solid ${s.textMuted}`,backgroundColor:W%2===0?s.background:"transparent"},children:[t.jsx("td",{style:nc(s),children:t.jsx("span",{style:{fontWeight:"bold"},children:$.label||"Unnamed"})}),t.jsx("td",{style:nc(s),children:t.jsx("span",{style:Yk(s.primary),children:$.tab_name})}),t.jsx("td",{style:nc(s),children:t.jsx("span",{style:Yk(s.textMuted),children:$.data_type})}),t.jsx("td",{style:{...nc(s),color:s.textMuted},children:z($.data_size)}),t.jsx("td",{style:{...nc(s),color:s.textMuted},children:new Date($.created_at).toLocaleString()}),t.jsx("td",{style:nc(s),children:$.tags&&t.jsx("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:$.tags.split(",").map((D,oe)=>t.jsx("span",{style:VJ(s),children:D},oe))})}),t.jsx("td",{style:{...nc(s),textAlign:"right"},children:t.jsxs("div",{style:{display:"flex",gap:"4px",justifyContent:"flex-end"},children:[t.jsx("button",{onClick:()=>I($),style:R0(s),onMouseEnter:D=>D.currentTarget.style.opacity="0.8",onMouseLeave:D=>D.currentTarget.style.opacity="1",title:"Preview",children:t.jsx(vi,{size:12})}),t.jsx("button",{onClick:()=>P($.id),style:R0(s),onMouseEnter:D=>D.currentTarget.style.opacity="0.8",onMouseLeave:D=>D.currentTarget.style.opacity="1",title:"Export",children:t.jsx(Mi,{size:12})}),t.jsx("button",{onClick:()=>M($.id),style:{...R0(s),backgroundColor:s.alert},onMouseEnter:D=>D.currentTarget.style.opacity="0.8",onMouseLeave:D=>D.currentTarget.style.opacity="1",title:"Delete",children:t.jsx(On,{size:12})})]})})]},$.id))})]})}),h&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:999},onClick:()=>x(null)}),t.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:s.panel,border:`2px solid ${s.primary}`,width:"90%",maxWidth:"1200px",maxHeight:"80vh",zIndex:1e3,display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0,0,0,0.8)"},children:[t.jsxs("div",{style:{borderBottom:`1px solid ${s.textMuted}`,padding:"16px",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:s.primary,fontSize:"14px",fontWeight:"bold",marginBottom:"4px"},children:h.label||"CONTEXT PREVIEW"}),t.jsxs("div",{style:{color:s.textMuted,fontSize:"10px"},children:[h.tab_name,"  ",h.data_type]})]}),t.jsx("button",{onClick:()=>x(null),style:{backgroundColor:"transparent",border:"none",color:s.textMuted,cursor:"pointer",padding:"4px"},onMouseEnter:$=>$.currentTarget.style.color=s.primary,onMouseLeave:$=>$.currentTarget.style.color=s.textMuted,children:t.jsx(ln,{size:16})})]}),t.jsxs("div",{style:{borderBottom:`1px solid ${s.textMuted}`,padding:"12px 16px",display:"flex",gap:"8px"},children:[t.jsxs("button",{onClick:()=>G("json"),style:{...N0(s,m==="json"),display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:$=>{m!=="json"&&($.currentTarget.style.opacity="0.8")},onMouseLeave:$=>{m!=="json"&&($.currentTarget.style.opacity="1")},children:[t.jsx(O4,{size:12}),"JSON"]}),t.jsxs("button",{onClick:()=>G("markdown"),style:{...N0(s,m==="markdown"),display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:$=>{m!=="markdown"&&($.currentTarget.style.opacity="0.8")},onMouseLeave:$=>{m!=="markdown"&&($.currentTarget.style.opacity="1")},children:[t.jsx(ri,{size:12}),"MARKDOWN"]}),t.jsxs("button",{onClick:()=>G("summary"),style:{...N0(s,m==="summary"),display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:$=>{m!=="summary"&&($.currentTarget.style.opacity="0.8")},onMouseLeave:$=>{m!=="summary"&&($.currentTarget.style.opacity="1")},children:[t.jsx(eB,{size:12}),"SUMMARY"]})]}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"16px",backgroundColor:s.background},children:t.jsx("pre",{style:{fontSize:"10px",whiteSpace:"pre-wrap",fontFamily:"monospace",color:s.text,margin:0},children:w})})]})]})]})},rc=s=>({padding:"12px",fontSize:"10px",fontWeight:"bold",color:s.primary,textAlign:"left"}),nc=s=>({padding:"12px",fontSize:"11px",color:s.text}),Yk=s=>({backgroundColor:s,color:"black",padding:"2px 6px",fontSize:"9px",fontWeight:"bold",display:"inline-block"}),VJ=s=>({backgroundColor:"transparent",border:`1px solid ${s.textMuted}`,color:s.textMuted,padding:"1px 4px",fontSize:"9px",fontWeight:"bold"}),R0=s=>({backgroundColor:s.primary,color:"black",border:"none",padding:"4px 8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"}),N0=(s,e)=>({backgroundColor:e?s.primary:s.background,color:e?"black":s.text,border:`1px solid ${e?s.primary:s.textMuted}`,padding:"4px 12px",fontSize:"10px",fontWeight:"bold",cursor:"pointer"}),Ye={ORANGE:"#FF8800",WHITE:"#FFFFFF",RED:"#FF3B3B",GREEN:"#00D66F",GRAY:"#787878",DARK_BG:"#000000",PANEL_BG:"#0F0F0F",HEADER_BG:"#1A1A1A",CYAN:"#00E5FF",YELLOW:"#FFD700",BLUE:"#0088FF",PURPLE:"#9D4EDD",BORDER:"#2A2A2A",HOVER:"#1F1F1F",MUTED:"#4A4A4A"},XJ=()=>{const[s,e]=S.useState("TraderInvestorsAgent"),[r,n]=S.useState([]),[i,o]=S.useState(null),[a,l]=S.useState(""),[d,p]=S.useState({}),[f,h]=S.useState(!1),[x,m]=S.useState(null),[b,w]=S.useState(!1),[y,C]=S.useState(null),[T,E]=S.useState(null),[j,k]=S.useState([]),[A,R]=S.useState({}),[M,P]=S.useState("Analyze China-Russia alliance dynamics"),[I,O]=S.useState(new Set),[G,B]=S.useState(null),[F,z]=S.useState(null),$=[{id:"TraderInvestorsAgent",name:"Trader/Investor Agents",icon:""},{id:"GeopoliticsAgents",name:"Geopolitics Agents",icon:""},{id:"EconomicAgents",name:"Economic Agents",icon:""},{id:"hedgeFundAgents",name:"Hedge Fund Team",icon:""}];S.useEffect(()=>{D(),oe(),W()},[s]);const W=async()=>{try{const _=await Je.getLLMConfigs();k(_);const Y={};_.forEach(he=>{he.api_key&&(Y[`${he.provider.toUpperCase()}_API_KEY`]=he.api_key)}),R(Y)}catch(_){console.error("Failed to load LLM configs:",_)}};S.useEffect(()=>{i&&l(JSON.stringify(i,null,2))},[i]);const D=async()=>{h(!0),C(null);try{const Y=await lt("execute_python_agent_command",{action:"list_agents",parameters:{category:s},inputs:null});Y.success?(n(Y.agents||[]),B(Y.team_name||null),Y.agents&&Y.agents.length>0&&o(Y.agents[0])):C(Y.error||"Failed to load agents")}catch(_){console.error("Failed to load agents:",_),C(_.toString())}finally{h(!1)}},oe=async()=>{try{const Y=await lt("execute_python_agent_command",{action:"get_providers",parameters:{},inputs:null});Y.success&&Y.providers&&p(Y.providers)}catch(_){console.error("Failed to load providers:",_)}},Z=async()=>{if(i){h(!0),C(null),E(null);try{const _=JSON.parse(a),he=await lt("execute_python_agent_command",{action:"update_config",parameters:{agent_id:i.id,category:s,updates:_},inputs:null});he.success?(E("Configuration saved successfully!"),o(_),setTimeout(()=>E(null),3e3)):C(he.error||"Failed to save configuration")}catch(_){console.error("Failed to save config:",_),C(_.toString())}finally{h(!1)}}},fe=async()=>{if(!i)return;if(!M.trim()){C("Please enter a test query");return}const _=j.find(Y=>Y.is_active);if(!_){C("No active LLM provider configured in Settings. Please configure and activate an LLM provider.");return}h(!0),C(null),m(null);try{const he=await lt("execute_python_agent_command",{action:"execute_agent",parameters:{agent_id:i.id,category:s,query:M},inputs:{api_keys:A,llm_override:{provider:_.provider,model:_.model}}});m(he)}catch(Y){console.error("Failed to test agent:",Y),C(Y.toString())}finally{h(!1)}},Q=async()=>{if(!M.trim()){C("Please enter a test query");return}const _=j.find(me=>me.is_active);if(!_){C("No active LLM provider configured in Settings.");return}const Y=F?r.filter(me=>me.book_source===F):r,he=Y.map(me=>me.id);h(!0),C(null),m({success:!0,discussion:[],total_agents:Y.length,rounds:2,query:M});try{const ge=await lt("execute_python_agent_command",{action:"execute_team_collaboration",parameters:{category:s,query:M,agent_ids:he},inputs:{api_keys:A,llm_override:{provider:_.provider,model:_.model}}});m(ge),ge.success||C(ge.error||"Team collaboration failed")}catch(me){console.error("Team collaboration failed:",me),C(me.toString())}finally{h(!1)}};return t.jsxs("div",{style:{height:"100%",backgroundColor:Ye.DARK_BG,color:Ye.WHITE,fontFamily:'"IBM Plex Mono", "Consolas", monospace',overflow:"hidden",display:"flex",flexDirection:"column"},children:[t.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap');

        *::-webkit-scrollbar { width: 6px; height: 6px; }
        *::-webkit-scrollbar-track { background: ${Ye.DARK_BG}; }
        *::-webkit-scrollbar-thumb { background: ${Ye.BORDER}; border-radius: 3px; }
        *::-webkit-scrollbar-thumb:hover { background: ${Ye.MUTED}; }

        .terminal-glow {
          text-shadow: 0 0 10px ${Ye.ORANGE}40;
        }
      `}),t.jsxs("div",{style:{backgroundColor:Ye.HEADER_BG,borderBottom:`2px solid ${Ye.ORANGE}`,padding:"6px 12px",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,boxShadow:`0 2px 8px ${Ye.ORANGE}20`},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx(xi,{size:18,color:Ye.ORANGE,style:{filter:"drop-shadow(0 0 4px "+Ye.ORANGE+")"}}),t.jsx("span",{style:{color:Ye.ORANGE,fontWeight:700,fontSize:"14px",letterSpacing:"0.5px",textShadow:`0 0 10px ${Ye.ORANGE}40`},children:"AGENT CONFIGURATION"})]}),t.jsx("div",{style:{height:"16px",width:"1px",backgroundColor:Ye.BORDER}}),t.jsx("div",{style:{display:"flex",gap:"8px"},children:$.map(_=>t.jsxs("button",{onClick:()=>e(_.id),style:{padding:"4px 12px",backgroundColor:s===_.id?Ye.ORANGE:Ye.PANEL_BG,border:`1px solid ${s===_.id?Ye.ORANGE:Ye.BORDER}`,color:s===_.id?Ye.DARK_BG:Ye.CYAN,cursor:"pointer",fontSize:"10px",fontWeight:600,transition:"all 0.2s",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("span",{children:_.icon}),t.jsx("span",{children:_.name})]},_.id))})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[t.jsxs("div",{style:{padding:"4px 10px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Object.keys(A).length>0?Ye.GREEN:Ye.RED}`,fontSize:"9px",display:"flex",alignItems:"center",gap:"4px",color:Object.keys(A).length>0?Ye.GREEN:Ye.RED},children:[t.jsx(Wb,{size:10}),Object.keys(A).length," API Keys"]}),t.jsxs("button",{onClick:()=>w(!b),style:{padding:"4px 10px",backgroundColor:b?Ye.ORANGE:Ye.PANEL_BG,border:`1px solid ${Ye.BORDER}`,color:b?Ye.DARK_BG:Ye.CYAN,cursor:"pointer",fontSize:"10px",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[b?t.jsx(cc,{size:12}):t.jsx(vi,{size:12}),b?"Hide JSON":"Show JSON"]}),t.jsxs("button",{onClick:D,disabled:f,style:{padding:"4px 10px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.BORDER}`,color:Ye.CYAN,cursor:f?"not-allowed":"pointer",fontSize:"10px",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(xn,{size:12,className:f?"animate-spin":""}),"Refresh"]})]})]}),t.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[t.jsxs("div",{style:{width:"260px",borderRight:`1px solid ${Ye.BORDER}`,display:"flex",flexDirection:"column",backgroundColor:Ye.PANEL_BG},children:[t.jsx("div",{style:{padding:"8px 12px",borderBottom:`1px solid ${Ye.BORDER}`,backgroundColor:Ye.HEADER_BG,fontSize:"11px",fontWeight:600,color:Ye.GRAY},children:G?`TEAM: ${G.toUpperCase()} (${r.length})`:`AVAILABLE AGENTS (${r.length})`}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px"},children:f&&r.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"20px",color:Ye.GRAY},children:[t.jsx(xn,{size:20,className:"animate-spin",style:{margin:"0 auto"}}),t.jsx("div",{style:{marginTop:"8px",fontSize:"10px"},children:"Loading agents..."})]}):r.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"20px",color:Ye.GRAY},children:[t.jsx(Rr,{size:20,style:{margin:"0 auto"}}),t.jsx("div",{style:{marginTop:"8px",fontSize:"10px"},children:"No agents found"})]}):t.jsx(t.Fragment,{children:(()=>{const _=r.reduce((he,me)=>{const ge=me.book_source||"Other";return he[ge]||(he[ge]=[]),he[ge].push(me),he},{}),Y=Object.keys(_);return Y.length<=1&&!G?r.map(he=>t.jsxs("button",{onClick:()=>o(he),style:{width:"100%",padding:"10px",marginBottom:"6px",backgroundColor:i?.id===he.id?Ye.HOVER:"transparent",border:`1px solid ${i?.id===he.id?Ye.ORANGE:Ye.BORDER}`,color:Ye.WHITE,cursor:"pointer",textAlign:"left",fontSize:"10px",transition:"all 0.2s"},onMouseEnter:me=>{i?.id!==he.id&&(me.currentTarget.style.backgroundColor=Ye.HOVER,me.currentTarget.style.borderColor=Ye.MUTED)},onMouseLeave:me=>{i?.id!==he.id&&(me.currentTarget.style.backgroundColor="transparent",me.currentTarget.style.borderColor=Ye.BORDER)},children:[t.jsx("div",{style:{fontWeight:600,color:Ye.CYAN,marginBottom:"4px"},children:he.name}),t.jsx("div",{style:{color:Ye.GRAY,fontSize:"9px",marginBottom:"4px"},children:he.role}),t.jsxs("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:[t.jsx("span",{style:{padding:"2px 6px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,borderRadius:"2px",fontSize:"8px",color:Ye.YELLOW},children:he.llm_config.provider}),t.jsx("span",{style:{padding:"2px 6px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,borderRadius:"2px",fontSize:"8px",color:Ye.PURPLE},children:he.llm_config.model_id})]})]},he.id)):Y.map(he=>{const me=_[he],ge=I.has(he);return t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("button",{onClick:()=>{const le=new Set(I);ge?le.delete(he):le.add(he),O(le),z(ge?null:he)},style:{width:"100%",padding:"10px",backgroundColor:ge?Ye.ORANGE+"20":Ye.HEADER_BG,border:`1px solid ${ge?Ye.ORANGE:Ye.BORDER}`,color:Ye.WHITE,cursor:"pointer",textAlign:"left",fontSize:"10px",fontWeight:600,marginBottom:ge?"6px":"0"},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx("span",{style:{fontSize:"14px"},children:""}),t.jsx("span",{style:{color:Ye.ORANGE},children:he})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsxs("span",{style:{color:Ye.GRAY,fontSize:"9px"},children:[me.length," agents"]}),t.jsx(bi,{size:14,style:{transform:ge?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"}})]})]})}),ge&&me.map(le=>t.jsxs("button",{onClick:()=>o(le),style:{width:"calc(100% - 12px)",padding:"10px",marginBottom:"6px",marginLeft:"12px",backgroundColor:i?.id===le.id?Ye.HOVER:"transparent",border:`1px solid ${i?.id===le.id?Ye.CYAN:Ye.BORDER}`,color:Ye.WHITE,cursor:"pointer",textAlign:"left",fontSize:"10px",transition:"all 0.2s"},onMouseEnter:X=>{i?.id!==le.id&&(X.currentTarget.style.backgroundColor=Ye.HOVER,X.currentTarget.style.borderColor=Ye.MUTED)},onMouseLeave:X=>{i?.id!==le.id&&(X.currentTarget.style.backgroundColor="transparent",X.currentTarget.style.borderColor=Ye.BORDER)},children:[t.jsx("div",{style:{fontWeight:600,color:Ye.CYAN,marginBottom:"4px"},children:le.name}),t.jsx("div",{style:{color:Ye.GRAY,fontSize:"9px"},children:le.role})]},le.id))]},he)})})()})})]}),t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",borderRight:x?`1px solid ${Ye.BORDER}`:"none"},children:[(y||T)&&t.jsxs("div",{style:{padding:"8px 12px",backgroundColor:y?Ye.RED+"20":Ye.GREEN+"20",borderBottom:`1px solid ${y?Ye.RED:Ye.GREEN}`,display:"flex",alignItems:"center",gap:"8px",fontSize:"10px"},children:[y?t.jsx(Rr,{size:14,color:Ye.RED}):t.jsx(Bn,{size:14,color:Ye.GREEN}),t.jsx("span",{style:{color:y?Ye.RED:Ye.GREEN},children:y||T})]}),i?t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{padding:"12px",borderBottom:`1px solid ${Ye.BORDER}`,backgroundColor:Ye.HEADER_BG},children:[t.jsx("div",{style:{fontSize:"16px",fontWeight:700,color:Ye.CYAN,marginBottom:"6px"},children:i.name}),t.jsx("div",{style:{fontSize:"10px",color:Ye.GRAY,marginBottom:"8px"},children:i.description}),t.jsxs("div",{style:{marginBottom:"8px"},children:[t.jsx("div",{style:{fontSize:"9px",fontWeight:600,color:Ye.GRAY,marginBottom:"4px"},children:"TEST QUERY"}),t.jsx("textarea",{value:M,onChange:_=>P(_.target.value),placeholder:"Enter your test query here...",style:{width:"100%",minHeight:"60px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,color:Ye.WHITE,padding:"6px 8px",fontSize:"10px",fontFamily:"inherit",resize:"vertical",outline:"none"}})]}),t.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[t.jsxs("button",{onClick:Z,disabled:f,style:{padding:"6px 12px",backgroundColor:Ye.GREEN,border:"none",color:Ye.DARK_BG,cursor:f?"not-allowed":"pointer",fontSize:"10px",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(ao,{size:12}),"Save Configuration"]}),t.jsxs("button",{onClick:fe,disabled:f,style:{padding:"6px 12px",backgroundColor:Ye.BLUE,border:"none",color:Ye.WHITE,cursor:f?"not-allowed":"pointer",fontSize:"10px",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(Ms,{size:12}),f?"Testing...":"Test Agent"]}),(G||F&&r.filter(_=>_.book_source===F).length>1)&&t.jsxs("button",{onClick:Q,disabled:f,style:{padding:"6px 12px",backgroundColor:Ye.PURPLE,border:"none",color:Ye.WHITE,cursor:f?"not-allowed":"pointer",fontSize:"10px",fontWeight:600,display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx(qo,{size:12}),f?"Collaborating...":" Team Discussion"]})]})]}),t.jsx("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:b?t.jsxs("div",{style:{height:"100%"},children:[t.jsxs("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"8px",display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(Yp,{size:12}),"JSON CONFIGURATION"]}),t.jsx("textarea",{value:a,onChange:_=>l(_.target.value),style:{width:"100%",height:"calc(100% - 30px)",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,color:Ye.CYAN,padding:"12px",fontSize:"11px",fontFamily:'"IBM Plex Mono", monospace',resize:"none",outline:"none"},spellCheck:!1})]}):t.jsxs("div",{style:{display:"grid",gap:"12px"},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:"ROLE"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"11px",color:Ye.YELLOW},children:i.role})]}),t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:"GOAL"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"11px"},children:i.goal})]}),t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:"LLM CONFIGURATION (ACTIVE FROM SETTINGS)"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.BORDER}`,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"10px"},children:(()=>{const _=j.find(Y=>Y.is_active);return _?t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("span",{style:{color:Ye.GRAY},children:"Provider:"})," ",t.jsx("span",{style:{color:Ye.CYAN},children:_.provider})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:Ye.GRAY},children:"Model:"})," ",t.jsx("span",{style:{color:Ye.PURPLE},children:_.model})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:Ye.GRAY},children:"API Key:"})," ",t.jsx("span",{style:{color:_.api_key?Ye.GREEN:Ye.RED},children:_.api_key?" Configured":" Missing"})]}),t.jsxs("div",{children:[t.jsx("span",{style:{color:Ye.GRAY},children:"Status:"})," ",t.jsx("span",{style:{color:Ye.GREEN},children:" ACTIVE"})]})]}):t.jsx("div",{style:{gridColumn:"1 / -1",color:Ye.RED,textAlign:"center"},children:" No active LLM configured in Settings"})})()})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:["TOOLS (",i.tools.length,")"]}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.BORDER}`,display:"flex",gap:"6px",flexWrap:"wrap"},children:i.tools.map((_,Y)=>t.jsx("span",{style:{padding:"4px 8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,color:Ye.GREEN,fontSize:"9px"},children:_},Y))})]}),i.scoring_weights&&Object.keys(i.scoring_weights).length>0&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:"SCORING WEIGHTS (User Configurable)"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.ORANGE}`,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"10px"},children:Object.entries(i.scoring_weights||{}).map(([_,Y])=>t.jsxs("div",{children:[t.jsxs("span",{style:{color:Ye.GRAY},children:[_,":"]})," ",t.jsxs("span",{style:{color:Ye.ORANGE,fontWeight:600},children:[(Y*100).toFixed(0),"%"]})]},_))})]}),i.thresholds&&Object.keys(i.thresholds).length>0&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:"ANALYSIS THRESHOLDS (User Configurable)"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.CYAN}`,display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"6px",fontSize:"9px",maxHeight:"150px",overflow:"auto"},children:Object.entries(i.thresholds||{}).map(([_,Y])=>t.jsxs("div",{children:[t.jsxs("span",{style:{color:Ye.GRAY},children:[_,":"]})," ",t.jsx("span",{style:{color:Ye.CYAN},children:String(Y)})]},_))})]}),i.data_sources&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:"DATA SOURCES (User Configurable)"}),t.jsxs("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.PURPLE}`,fontSize:"10px"},children:[i.data_sources?.line_items&&Array.isArray(i.data_sources.line_items)&&t.jsxs("div",{style:{marginBottom:"6px"},children:[t.jsx("span",{style:{color:Ye.GRAY},children:"Line Items:"})," ",t.jsx("span",{style:{color:Ye.PURPLE},children:i.data_sources.line_items.join(", ")})]}),i.data_sources?.years_of_data!=null&&t.jsxs("div",{children:[t.jsx("span",{style:{color:Ye.GRAY},children:"Years of Data:"})," ",t.jsx("span",{style:{color:Ye.YELLOW},children:i.data_sources.years_of_data})]})]})]}),t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:"10px",fontWeight:600,color:Ye.GRAY,marginBottom:"6px"},children:"INSTRUCTIONS"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.PANEL_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"10px",maxHeight:"200px",overflow:"auto",lineHeight:"1.5"},children:i.instructions})]})]})})]}):t.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:Ye.GRAY,fontSize:"11px"},children:t.jsxs("div",{style:{textAlign:"center"},children:[t.jsx(xi,{size:48,style:{margin:"0 auto 12px",opacity:.3}}),t.jsx("div",{children:"Select an agent to view configuration"})]})})]}),x&&t.jsxs("div",{style:{width:"400px",display:"flex",flexDirection:"column",backgroundColor:Ye.PANEL_BG,overflow:"hidden"},children:[t.jsxs("div",{style:{padding:"8px 12px",borderBottom:`1px solid ${Ye.BORDER}`,backgroundColor:Ye.HEADER_BG,fontSize:"11px",fontWeight:600,color:Ye.GRAY,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[t.jsx(si,{size:12,color:x.success?Ye.GREEN:Ye.RED}),t.jsx("span",{children:"TEST RESULT"})]}),t.jsx("button",{onClick:()=>m(null),style:{padding:"2px 6px",backgroundColor:"transparent",border:`1px solid ${Ye.BORDER}`,color:Ye.GRAY,cursor:"pointer",fontSize:"9px"},children:"Close"})]}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:"12px"},children:[t.jsxs("div",{style:{padding:"8px",backgroundColor:x.success?Ye.GREEN+"20":Ye.RED+"20",border:`1px solid ${x.success?Ye.GREEN:Ye.RED}`,marginBottom:"12px",display:"flex",alignItems:"center",gap:"6px",fontSize:"10px",color:x.success?Ye.GREEN:Ye.RED},children:[x.success?t.jsx(Bn,{size:14}):t.jsx(Rr,{size:14}),t.jsx("span",{style:{fontWeight:600},children:x.success?"SUCCESS":"FAILED"})]}),x.agent_name&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",fontWeight:600,color:Ye.GRAY,marginBottom:"4px"},children:"AGENT"}),t.jsx("div",{style:{padding:"6px 8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"10px",color:Ye.CYAN},children:x.agent_name})]}),x.provider&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",fontWeight:600,color:Ye.GRAY,marginBottom:"4px"},children:"PROVIDER & MODEL"}),t.jsxs("div",{style:{padding:"6px 8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"10px",display:"flex",gap:"8px"},children:[t.jsx("span",{style:{color:Ye.YELLOW},children:x.provider}),t.jsx("span",{style:{color:Ye.GRAY},children:""}),t.jsx("span",{style:{color:Ye.PURPLE},children:x.model})]})]}),x.discussion&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsxs("div",{style:{fontSize:"9px",fontWeight:600,color:Ye.GRAY,marginBottom:"4px"},children:["TEAM DISCUSSION (",x.total_agents," AGENTS, ",x.rounds," ROUNDS)"]}),t.jsx("div",{style:{maxHeight:"500px",overflow:"auto"},children:x.discussion.map((_,Y)=>t.jsxs("div",{style:{padding:"8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,marginBottom:"8px",fontSize:"10px"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[t.jsx("span",{style:{color:Ye.CYAN,fontWeight:600},children:_.agent}),t.jsxs("span",{style:{color:Ye.GRAY,fontSize:"9px"},children:["Round ",_.round]})]}),t.jsx("div",{style:{color:Ye.GRAY,fontSize:"9px",marginBottom:"4px"},children:_.role}),t.jsx("div",{style:{color:Ye.WHITE,lineHeight:"1.6"},children:t.jsx(cb,{components:{p:({node:he,...me})=>t.jsx("p",{style:{margin:"0.5em 0"},...me}),strong:({node:he,...me})=>t.jsx("strong",{style:{color:Ye.CYAN,fontWeight:600},...me}),em:({node:he,...me})=>t.jsx("em",{style:{color:Ye.YELLOW},...me}),ul:({node:he,...me})=>t.jsx("ul",{style:{margin:"0.5em 0",paddingLeft:"1.5em"},...me}),ol:({node:he,...me})=>t.jsx("ol",{style:{margin:"0.5em 0",paddingLeft:"1.5em"},...me}),li:({node:he,...me})=>t.jsx("li",{style:{margin:"0.25em 0"},...me})},children:_.response})})]},Y))})]}),x.response&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",fontWeight:600,color:Ye.GRAY,marginBottom:"4px"},children:"RESPONSE"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"10px",maxHeight:"300px",overflow:"auto",lineHeight:"1.6",color:Ye.WHITE},children:t.jsx(cb,{components:{p:({node:_,...Y})=>t.jsx("p",{style:{margin:"0.5em 0"},...Y}),strong:({node:_,...Y})=>t.jsx("strong",{style:{color:Ye.CYAN,fontWeight:600},...Y}),em:({node:_,...Y})=>t.jsx("em",{style:{color:Ye.YELLOW},...Y}),ul:({node:_,...Y})=>t.jsx("ul",{style:{margin:"0.5em 0",paddingLeft:"1.5em"},...Y}),ol:({node:_,...Y})=>t.jsx("ol",{style:{margin:"0.5em 0",paddingLeft:"1.5em"},...Y}),li:({node:_,...Y})=>t.jsx("li",{style:{margin:"0.25em 0"},...Y})},children:x.response})})]}),x.tokens_used&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",fontWeight:600,color:Ye.GRAY,marginBottom:"4px"},children:"TOKENS USED"}),t.jsx("div",{style:{padding:"6px 8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"10px",color:Ye.CYAN},children:x.tokens_used.toLocaleString()})]}),x.error&&t.jsxs("div",{style:{marginBottom:"12px"},children:[t.jsx("div",{style:{fontSize:"9px",fontWeight:600,color:Ye.RED,marginBottom:"4px"},children:"ERROR"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.RED}`,fontSize:"10px",color:Ye.RED,lineHeight:"1.6",whiteSpace:"pre-wrap"},children:x.error})]}),t.jsxs("details",{style:{marginTop:"12px"},children:[t.jsx("summary",{style:{fontSize:"9px",fontWeight:600,color:Ye.GRAY,cursor:"pointer",marginBottom:"4px",padding:"4px",backgroundColor:Ye.HEADER_BG,border:`1px solid ${Ye.BORDER}`},children:"RAW JSON"}),t.jsx("div",{style:{padding:"8px",backgroundColor:Ye.DARK_BG,border:`1px solid ${Ye.BORDER}`,fontSize:"9px",fontFamily:'"IBM Plex Mono", monospace',maxHeight:"200px",overflow:"auto",marginTop:"4px"},children:t.jsx("pre",{style:{margin:0,color:Ye.CYAN},children:JSON.stringify(x,null,2)})})]})]})]})]})]})},dl=({label:s,items:e,onItemClick:r})=>{const[n,i]=S.useState(!1),o=S.useRef(null);return S.useEffect(()=>{const a=l=>{o.current&&!o.current.contains(l.target)&&i(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),t.jsxs("div",{ref:o,style:{position:"relative",display:"inline-block"},children:[t.jsx("span",{style:{cursor:"pointer",padding:"2px 4px",borderRadius:"2px",backgroundColor:n?"#404040":"transparent"},onClick:()=>i(!n),children:s}),n&&t.jsx("div",{style:{position:"absolute",top:"100%",left:0,backgroundColor:"#2d2d2d",border:"1px solid #404040",borderRadius:"2px",minWidth:"150px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.5)"},children:e.map((a,l)=>t.jsx("div",{style:{padding:"6px 12px",cursor:a.disabled?"not-allowed":"pointer",color:a.disabled?"#666":"#a3a3a3",fontSize:"11px",borderBottom:a.separator?"1px solid #404040":"none"},onMouseEnter:d=>{a.disabled||(d.target.style.backgroundColor="#404040",d.target.style.color="#fff")},onMouseLeave:d=>{d.target.style.backgroundColor="transparent",d.target.style.color=a.disabled?"#666":"#a3a3a3"},onClick:()=>{!a.disabled&&r&&(r(a),i(!1))},children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[a.icon,t.jsx("span",{children:a.label}),a.shortcut&&t.jsx("span",{style:{marginLeft:"auto",fontSize:"10px",color:"#666"},children:a.shortcut})]})},l))})]})},JJ=()=>{const{formattedTime:s}=Sz(),[e,r]=S.useState(()=>new Date().toISOString().split("T")[0]);return S.useEffect(()=>{const i=setInterval(()=>{r(new Date().toISOString().split("T")[0])},6e4);return()=>clearInterval(i)},[]),t.jsxs("span",{style:{color:"#a3a3a3",fontSize:"9px"},children:[e," ",s]})};function QJ(){const{session:s,logout:e}=Ao(),r=gA(),{mode:n,toggleMode:i}=TF(),[o,a]=S.useState("dashboard"),[l,d]=S.useState(!1),[p,f]=S.useState(""),{updateAvailable:h,updateInfo:x,isInstalling:m,installProgress:b,error:w,installUpdate:y,dismissUpdate:C}=aW();S.useEffect(()=>(document.body.style.margin="0",document.body.style.padding="0",document.body.style.backgroundColor="#000000",document.body.style.overflow="hidden",document.body.style.overscrollBehavior="none",document.documentElement.style.backgroundColor="#000000",document.documentElement.style.overflow="hidden",document.documentElement.style.overscrollBehavior="none",(async()=>{try{const{sqliteService:F}=await Br(async()=>{const{sqliteService:z}=await Promise.resolve().then(()=>jd);return{sqliteService:z}},void 0);F.isReady()||(console.log("[App] Initializing database on app start..."),await F.initialize(),console.log("[App] Database initialized successfully"));try{const{mcpManager:z}=await Br(async()=>{const{mcpManager:$}=await Promise.resolve().then(()=>eg);return{mcpManager:$}},void 0);console.log("[App] Starting MCP auto-start servers..."),await z.startAutoStartServers(),console.log("[App] MCP servers auto-started successfully")}catch(z){console.warn("[App] MCP auto-start failed (this is OK if no servers are configured):",z)}}catch(F){console.error("[App] Failed to initialize on app start:",F)}})(),()=>{document.body.style.overflow="auto",document.body.style.overscrollBehavior="auto",document.documentElement.style.overflow="auto",document.documentElement.style.overscrollBehavior="auto"}),[]);const T=()=>{if(!s)return t.jsx("span",{style:{color:"#fbbf24",fontSize:"10px"},children:"Loading..."});if(s.user_type==="guest"){let F="";if(s.expires_at){const z=new Date(s.expires_at).getTime(),$=new Date().getTime(),W=Math.floor((z-$)/(1e3*60*60)),D=Math.floor((z-$)%(1e3*60*60)/(1e3*60));W>0?F=` (${W}h ${D}m remaining)`:D>0?F=` (${D}m remaining)`:F=" (Expired)"}return t.jsxs("span",{style:{color:"#fbbf24",fontSize:"10px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("span",{onClick:()=>a("profile"),style:{cursor:"pointer",textDecoration:"underline"},title:"Go to Profile",children:" Guest"}),t.jsx("span",{children:F}),t.jsx("span",{style:{color:"#787878"},children:"|"}),t.jsx("span",{onClick:()=>r.navigateToPricing(),style:{cursor:"pointer",textDecoration:"underline"},title:"View Plans",children:" View Plans"})]})}else if(s.user_type==="registered"){const F=s.user_info?.username||s.user_info?.email||"User",z=s.user_info?.account_type||"free",$=s.user_info?.credit_balance??0,W=s.subscription?.data?.has_subscription||s.subscription?.has_subscription,D=W?s.subscription?.data?.subscription?.plan?.name||s.subscription?.subscription?.plan?.name||z:z==="free"?"Free Plan":z.charAt(0).toUpperCase()+z.slice(1);return t.jsxs("span",{style:{color:"#fbbf24",fontSize:"10px",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsxs("span",{onClick:()=>a("profile"),style:{cursor:"pointer",textDecoration:"underline"},title:"Go to Profile",children:[" ",F]}),t.jsx("span",{style:{color:"#787878"},children:"|"}),t.jsxs("span",{onClick:()=>a("profile"),style:{cursor:"pointer",textDecoration:"underline",color:$>0?"#10b981":"#ef4444"},title:"View Credits",children:[" ",$.toFixed(2)," Credits"]}),t.jsx("span",{style:{color:"#787878"},children:"|"}),t.jsxs("span",{onClick:()=>r.navigateToPricing(),style:{cursor:"pointer",textDecoration:"underline"},title:W?"Change Plan":"View Plans",children:[" ",D]}),W&&t.jsxs(t.Fragment,{children:[t.jsx("span",{style:{color:"#787878"},children:"|"}),t.jsx("span",{children:" Active"})]})]})}return t.jsx("span",{style:{color:"#fbbf24",fontSize:"10px"},children:"Unknown Session"})},E=()=>{document.fullscreenElement?document.exitFullscreen().then(()=>{d(!1),f("Exited fullscreen mode")}):document.documentElement.requestFullscreen().then(()=>{d(!0),f("Entered fullscreen mode")}).catch(()=>{f("Failed to enter fullscreen mode")}),setTimeout(()=>f(""),3e3)},j=async F=>{if(typeof F.action=="function"){F.action(),f(`Navigated to ${F.label}`),setTimeout(()=>f(""),2e3);return}switch(f(`${F.label} clicked`),F.action){case"fullscreen":E();break;case"refresh":case"refresh_all":f("Refreshing all data..."),window.location.reload();break;case"export":case"export_portfolio":f("Export Portfolio - Feature coming soon"),setTimeout(()=>f(""),3e3);break;case"import_data":f("Import Data - Feature coming soon"),setTimeout(()=>f(""),3e3);break;case"new_workspace":f("New Workspace - Feature coming soon"),setTimeout(()=>f(""),3e3);break;case"open_workspace":f("Open Workspace - Feature coming soon"),setTimeout(()=>f(""),3e3);break;case"save_workspace":f("Save Workspace - Feature coming soon"),setTimeout(()=>f(""),3e3);break;case"zoom_in":f("Zoom In - Use Ctrl++ in browser"),setTimeout(()=>f(""),3e3);break;case"zoom_out":f("Zoom Out - Use Ctrl+- in browser"),setTimeout(()=>f(""),3e3);break;case"zoom_reset":f("Reset Zoom - Use Ctrl+0 in browser"),setTimeout(()=>f(""),3e3);break;case"toggle_theme":f("Toggle Theme - Feature coming soon"),setTimeout(()=>f(""),3e3);break;case"show_shortcuts":f("Keyboard Shortcuts - Press F1-F12 to navigate tabs"),setTimeout(()=>f(""),5e3);break;case"show_about":f(`Fincept Terminal v${dj} - Professional Financial Platform`),setTimeout(()=>f(""),3e3);break;case"check_updates":f("Checking for updates..."),setTimeout(()=>f("You are running the latest version"),3e3);break;case"logout":f("Logging out..."),await e(),window.location.href="/";break;case"exit":f("Use Alt+F4 to close the application"),setTimeout(()=>f(""),3e3);break;default:setTimeout(()=>f(""),3e3)}};S.useEffect(()=>{const F=z=>{const $=z.target;if(!($.tagName==="INPUT"||$.tagName==="TEXTAREA"||$.isContentEditable)&&!(z.ctrlKey||z.altKey||z.shiftKey||z.metaKey))switch(z.key){case"F1":z.preventDefault(),a("dashboard"),f("Navigated to Dashboard (F1)"),setTimeout(()=>f(""),2e3);break;case"F2":z.preventDefault(),a("markets"),f("Navigated to Markets (F2)"),setTimeout(()=>f(""),2e3);break;case"F3":z.preventDefault(),a("news"),f("Navigated to News (F3)"),setTimeout(()=>f(""),2e3);break;case"F4":z.preventDefault(),a("portfolio"),f("Navigated to Portfolio (F4)"),setTimeout(()=>f(""),2e3);break;case"F5":z.preventDefault(),a("backtesting"),f("Navigated to Backtesting (F5)"),setTimeout(()=>f(""),2e3);break;case"F6":z.preventDefault(),a("watchlist"),f("Navigated to Watchlist (F6)"),setTimeout(()=>f(""),2e3);break;case"F7":z.preventDefault(),a("research"),f("Navigated to Equity Research (F7)"),setTimeout(()=>f(""),2e3);break;case"F8":z.preventDefault(),a("screener"),f("Navigated to Screener (F8)"),setTimeout(()=>f(""),2e3);break;case"F9":z.preventDefault(),a("trading"),f("Navigated to Trading (F9)"),setTimeout(()=>f(""),2e3);break;case"F10":z.preventDefault(),a("chat"),f("Navigated to AI Chat (F10)"),setTimeout(()=>f(""),2e3);break;case"F11":break;case"F12":z.preventDefault(),a("profile"),f("Navigated to Profile (F12)"),setTimeout(()=>f(""),2e3);break}};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[]);const k=[{label:"New Workspace",shortcut:"Ctrl+N",icon:null,action:"new_workspace"},{label:"Open Workspace",shortcut:"Ctrl+O",icon:null,action:"open_workspace"},{label:"Save Workspace",shortcut:"Ctrl+S",icon:null,action:"save_workspace"},{label:"Export Portfolio",shortcut:"Ctrl+E",icon:t.jsx(Mi,{size:12}),action:"export",separator:!0},{label:"Import Data",icon:null,action:"import_data"},{label:"Exit",shortcut:"Alt+F4",icon:null,action:"exit",separator:!0}],A=[{label:"Live Markets",shortcut:"F2",action:()=>a("markets")},{label:"Stock Screener",shortcut:"F8",action:()=>a("screener")},{label:"Polygon Data",action:()=>a("polygon"),separator:!0},{label:"Economics",action:()=>a("economics")},{label:"DBnomics",action:()=>a("dbnomics")}],R=[{label:"Equity Research",shortcut:"F7",action:()=>a("research")},{label:"Geopolitics",action:()=>a("geopolitics")},{label:"Maritime Intelligence",action:()=>a("maritime")},{label:"News Feed",shortcut:"F3",action:()=>a("news")}],M=[{label:"Trading Desk",shortcut:"F9",action:()=>a("trading")},{label:"Fyers Broker",action:()=>a("fyers")},{label:"Portfolio",shortcut:"F4",action:()=>a("portfolio")},{label:"Backtesting",shortcut:"F5",action:()=>a("backtesting")},{label:"Watchlist",shortcut:"F6",action:()=>a("watchlist")}],P=[{label:"AI Assistant",shortcut:"F10",action:()=>a("chat")},{label:"Agent Config",action:()=>a("agents")},{label:"MCP Servers",action:()=>a("mcp"),separator:!0},{label:"Node Editor",action:()=>a("nodes")},{label:"Code Editor",action:()=>a("code")},{label:"Data Sources",action:()=>a("datasources"),separator:!0},{label:"Data Mapping",action:()=>a("datamapping")},{label:"Report Builder",action:()=>a("reportbuilder")},{label:"Recorded Contexts",action:()=>a("contexts")},{label:"Settings",action:()=>a("settings"),separator:!0}],I=[{label:"Forum",action:()=>a("forum")},{label:"Marketplace",action:()=>a("marketplace")},{label:"Documentation",action:()=>a("docs")}],O=[{label:"Fullscreen",shortcut:"F11",icon:l?t.jsx(eC,{size:12}):t.jsx(ZE,{size:12}),action:"fullscreen"},{label:"Zoom In",shortcut:"Ctrl++",icon:null,action:"zoom_in"},{label:"Zoom Out",shortcut:"Ctrl+-",icon:null,action:"zoom_out"},{label:"Reset Zoom",shortcut:"Ctrl+0",icon:null,action:"zoom_reset",separator:!0},{label:"Toggle Theme",icon:t.jsx(vi,{size:12}),action:"toggle_theme"}],G=[{label:"Documentation",action:()=>a("docs")},{label:"Support Tickets",action:()=>a("support")},{label:"Keyboard Shortcuts",shortcut:"Ctrl+/",action:"show_shortcuts",separator:!0},{label:"About Fincept",action:"show_about"},{label:"Check for Updates",action:"check_updates"},{label:"Logout",icon:t.jsx(QE,{size:12}),action:"logout",separator:!0}],B={default:{backgroundColor:"transparent",color:"#d4d4d4",border:"none",padding:"3px 8px",fontSize:"10px",cursor:"pointer",borderRadius:"0",whiteSpace:"nowrap",flexShrink:0},active:{backgroundColor:"#ea580c",color:"white",border:"none",padding:"3px 8px",fontSize:"10px",cursor:"pointer",borderRadius:"0",whiteSpace:"nowrap",flexShrink:0}};return t.jsxs("div",{style:{width:"100vw",height:"100vh",margin:0,padding:0,backgroundColor:"#000000",fontFamily:'Consolas, "Courier New", monospace',overflow:"hidden",fontSize:"11px",position:"fixed",top:0,left:0,overscrollBehavior:"none",display:"flex",flexDirection:"column"},children:[t.jsxs("div",{style:{backgroundColor:"#2d2d2d",color:"#a3a3a3",fontSize:"11px",borderBottom:"1px solid #404040",padding:"2px 8px",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"space-between",height:"20px"},children:[t.jsxs("div",{style:{display:"flex",gap:"16px"},children:[t.jsx(dl,{label:"File",items:k,onItemClick:j}),t.jsx(dl,{label:"Markets",items:A,onItemClick:j}),t.jsx(dl,{label:"Research",items:R,onItemClick:j}),t.jsx(dl,{label:"Trading",items:M,onItemClick:j}),t.jsx(dl,{label:"Tools",items:P,onItemClick:j}),t.jsx(dl,{label:"Community",items:I,onItemClick:j}),t.jsx(dl,{label:"View",items:O,onItemClick:j}),t.jsx(dl,{label:"Help",items:G,onItemClick:j})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[t.jsx("span",{style:{color:"#ea580c",fontSize:"11px",fontWeight:"bold",letterSpacing:"0.5px"},children:"FINCEPT PROFESSIONAL"}),t.jsx("div",{style:{width:"1px",height:"14px",backgroundColor:"#525252"}}),t.jsx("button",{onClick:E,style:{background:"none",border:"none",color:"#a3a3a3",cursor:"pointer",padding:"2px",borderRadius:"2px"},onMouseEnter:F=>{F.target.style.backgroundColor="#404040",F.target.style.color="#fff"},onMouseLeave:F=>{F.target.style.backgroundColor="transparent",F.target.style.color="#a3a3a3"},title:l?"Exit Fullscreen (F11)":"Enter Fullscreen (F11)",children:l?t.jsx(eC,{size:14}):t.jsx(ZE,{size:14})}),t.jsx("div",{style:{width:"1px",height:"14px",backgroundColor:"#525252"}}),t.jsx("button",{onClick:i,style:{background:n==="chat"?"#ea580c":"none",border:n==="chat"?"1px solid #ea580c":"none",color:n==="chat"?"#fff":"#a3a3a3",cursor:"pointer",padding:"3px 8px",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px",fontSize:"10px",fontWeight:"bold",transition:"all 0.2s"},onMouseEnter:F=>{n==="terminal"&&(F.target.style.backgroundColor="#404040",F.target.style.color="#fff")},onMouseLeave:F=>{n==="terminal"&&(F.target.style.backgroundColor="transparent",F.target.style.color="#a3a3a3")},title:n==="terminal"?"Switch to Chat Mode":"Switch to Terminal Mode",children:n==="chat"?t.jsxs(t.Fragment,{children:[t.jsx(dc,{size:14}),t.jsx("span",{children:"TERMINAL"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Qg,{size:14}),t.jsx("span",{children:"CHAT MODE"})]})}),T(),t.jsxs("button",{onClick:async()=>{f("Logging out..."),await e(),window.location.href="/"},style:{backgroundColor:"transparent",color:"#ff6b6b",border:"1px solid #ff6b6b",padding:"3px 8px",fontSize:"10px",cursor:"pointer",borderRadius:"3px",display:"flex",alignItems:"center",gap:"4px",fontWeight:"bold"},onMouseEnter:F=>{F.currentTarget.style.backgroundColor="#ff6b6b",F.currentTarget.style.color="#fff"},onMouseLeave:F=>{F.currentTarget.style.backgroundColor="transparent",F.currentTarget.style.color="#ff6b6b"},title:"Logout",children:[t.jsx(QE,{size:12}),"LOGOUT"]}),t.jsx("span",{style:{color:"#737373",cursor:"pointer"},title:"Help",children:"?"})]})]}),p&&t.jsx("div",{style:{backgroundColor:"#ea580c",color:"white",fontSize:"10px",padding:"2px 8px",borderBottom:"1px solid #404040",height:"16px",display:"flex",alignItems:"center",flexShrink:0},children:p}),n!=="chat"&&t.jsx("div",{style:{backgroundColor:"#3f3f3f",borderBottom:"1px solid #404040",height:"26px",position:"relative",flexShrink:0},children:t.jsxs("div",{style:{overflowX:"auto",overflowY:"hidden",height:"100%",scrollbarWidth:"none",msOverflowStyle:"none"},className:"hide-scrollbar",onWheel:F=>{F.preventDefault();const z=F.currentTarget;z.scrollLeft+=F.deltaY},children:[t.jsx("style",{children:`
            .hide-scrollbar::-webkit-scrollbar {
              display: none;
            }
          `}),t.jsx(vC,{value:o,onValueChange:a,className:"h-full",children:t.jsxs(AF,{style:{backgroundColor:"transparent",border:"none",padding:"2px 4px",height:"100%",justifyContent:"flex-start",borderRadius:"0",flexWrap:"nowrap",width:"max-content",minWidth:"100%"},children:[t.jsx(_i,{value:"dashboard",style:o==="dashboard"?B.active:B.default,title:"Dashboard (F1)",children:"Dashboard"}),t.jsx(_i,{value:"markets",style:o==="markets"?B.active:B.default,title:"Markets (F2)",children:"Markets"}),t.jsx(_i,{value:"news",style:o==="news"?B.active:B.default,title:"News (F3)",children:"News"}),t.jsx(_i,{value:"portfolio",style:o==="portfolio"?B.active:B.default,title:"Portfolio (F4)",children:"Portfolio"}),t.jsx(_i,{value:"backtesting",style:o==="backtesting"?B.active:B.default,title:"Backtesting (F5)",children:"Backtesting"}),t.jsx(_i,{value:"watchlist",style:o==="watchlist"?B.active:B.default,title:"Watchlist (F6)",children:"Watchlist"}),t.jsx(_i,{value:"research",style:o==="research"?B.active:B.default,title:"Equity Research (F7)",children:"Research"}),t.jsx(_i,{value:"screener",style:o==="screener"?B.active:B.default,title:"Screener (F8)",children:"Screener"}),t.jsx(_i,{value:"trading",style:o==="trading"?B.active:B.default,title:"Trading (F9)",children:"Trading"}),t.jsx(_i,{value:"chat",style:o==="chat"?B.active:B.default,title:"AI Chat (F10)",children:"AI Chat"}),t.jsx(_i,{value:"agents",style:o==="agents"?B.active:B.default,title:"Agent Config",children:"Agents"}),t.jsx(_i,{value:"settings",style:o==="settings"?B.active:B.default,title:"Settings",children:"Settings"}),t.jsx(_i,{value:"profile",style:o==="profile"?B.active:B.default,title:"Profile (F12)",children:"Profile"})]})})]})}),n!=="chat"&&t.jsxs("div",{style:{backgroundColor:"#1a1a1a",borderBottom:"1px solid #404040",padding:"3px 8px",height:"22px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px",flexShrink:0,fontSize:"9px"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t.jsx("span",{style:{backgroundColor:"#ea580c",color:"white",padding:"2px 5px",fontSize:"8px",fontWeight:"bold"},children:"FINXEPT PROFESSIONAL"}),t.jsx("span",{style:{color:"#a3a3a3",fontSize:"9px"},children:"Enter Command"}),t.jsx("div",{style:{width:"1px",height:"14px",backgroundColor:"#525252"}}),t.jsx("span",{style:{color:"#a3a3a3",fontSize:"9px"},children:"Search"}),t.jsx("div",{style:{width:"1px",height:"14px",backgroundColor:"#525252"}}),t.jsx(JJ,{}),t.jsx("div",{style:{width:"1px",height:"14px",backgroundColor:"#525252"}}),t.jsxs("span",{style:{color:"#10b981",fontSize:"9px",fontWeight:"bold"},children:["v",dj]}),l&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{width:"1px",height:"14px",backgroundColor:"#525252"}}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"FULLSCREEN"})]})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F1:DASH"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F2:MKTS"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F3:NEWS"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F4:PORT"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F5:BKTEST"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F6:WATCH"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F7:RSRCH"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F8:SCRN"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F9:TRADE"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F10:AI"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F11:FULL"}),t.jsx("span",{style:{color:"#fbbf24",fontSize:"9px"},children:"F12:PROF"}),t.jsx("span",{style:{color:"#666",marginLeft:"4px"},children:"|"}),t.jsx("span",{style:{color:"#10b981",fontSize:"9px"},children:"More tabs in toolbar menus"})]})]}),t.jsx("div",{style:{flex:1,backgroundColor:"#000000",minHeight:0,overflow:"hidden"},children:n==="chat"?t.jsx(tW,{}):t.jsxs(vC,{value:o,className:"h-full",children:[t.jsx(Qr,{value:"dashboard",className:"h-full m-0 p-0",children:t.jsx(A9,{onNavigateToTab:a})}),t.jsx(Qr,{value:"markets",className:"h-full m-0 p-0",children:t.jsx(O9,{})}),t.jsx(Qr,{value:"news",className:"h-full m-0 p-0",children:t.jsx(_9,{})}),t.jsx(Qr,{value:"forum",className:"h-full m-0 p-0",children:t.jsx(jW,{})}),t.jsx(Qr,{value:"watchlist",className:"h-full m-0 p-0",children:t.jsx(F9,{})}),t.jsx(Qr,{value:"geopolitics",className:"h-full m-0 p-0",children:t.jsx(U9,{})}),t.jsx(Qr,{value:"chat",className:"h-full m-0 p-0",children:t.jsx(V9,{onNavigateToSettings:()=>a("settings"),onNavigateToTab:F=>a(F)})}),t.jsx(Qr,{value:"fyers",className:"h-full m-0 p-0",children:t.jsx(RX,{})}),t.jsx(Qr,{value:"mcp",className:"h-full m-0 p-0",children:t.jsx(HK,{onNavigateToTab:F=>a(F)})}),t.jsx(Qr,{value:"profile",className:"h-full m-0 p-0",children:t.jsx(J9,{})}),t.jsx(Qr,{value:"marketplace",className:"h-full m-0 p-0",children:t.jsx(eH,{})}),t.jsx(Qr,{value:"portfolio",className:"h-full m-0 p-0",children:t.jsx(DH,{})}),t.jsx(Qr,{value:"backtesting",className:"h-full m-0 p-0",children:t.jsx(YJ,{})}),t.jsx(Qr,{value:"research",className:"h-full m-0 p-0",children:t.jsx(GH,{})}),t.jsx(Qr,{value:"polygon",className:"h-full m-0 p-0",children:t.jsx(zX,{})}),t.jsx(Qr,{value:"screener",className:"h-full m-0 p-0",children:t.jsx(qH,{})}),t.jsx(Qr,{value:"dbnomics",className:"h-full m-0 p-0",children:t.jsx(HH,{})}),t.jsx(Qr,{value:"economics",className:"h-full m-0 p-0",children:t.jsx(KH,{})}),t.jsx(Qr,{value:"code",className:"h-full m-0 p-0",children:t.jsx(XH,{})}),t.jsx(Qr,{value:"docs",className:"h-full m-0 p-0",children:t.jsx(r7,{})}),t.jsx(Qr,{value:"maritime",className:"h-full m-0 p-0",children:t.jsx(n7,{})}),t.jsx(Qr,{value:"trading",className:"h-full m-0 p-0",children:t.jsx(LJ,{})}),t.jsx(Qr,{value:"settings",className:"h-full m-0 p-0",children:t.jsx(eK,{})}),t.jsx(Qr,{value:"nodes",className:"h-full m-0 p-0",children:t.jsx(wK,{})}),t.jsx(Qr,{value:"datasources",className:"h-full m-0 p-0",children:t.jsx(CK,{})}),t.jsx(Qr,{value:"support",className:"h-full m-0 p-0",children:t.jsx(_X,{})}),t.jsx(Qr,{value:"datamapping",className:"h-full m-0 p-0",children:t.jsx(MK,{})}),t.jsx(Qr,{value:"contexts",className:"h-full m-0 p-0",children:t.jsx(KJ,{})}),t.jsx(Qr,{value:"reportbuilder",className:"h-full m-0 p-0",children:t.jsx(HJ,{})}),t.jsx(Qr,{value:"agents",className:"h-full m-0 p-0",children:t.jsx(XJ,{})})]})}),t.jsx(n2,{open:h,onOpenChange:F=>!F&&C(),children:t.jsxs(s2,{className:"sm:max-w-[500px]",children:[t.jsxs(i2,{children:[t.jsxs(a2,{className:"flex items-center gap-2",children:[t.jsx(Mi,{className:"h-5 w-5"}),"Update Available"]}),t.jsx(l2,{children:"A new version of FinceptTerminal is available."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[x&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Current Version:"}),t.jsx("span",{className:"font-mono",children:x.currentVersion})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"New Version:"}),t.jsx("span",{className:"font-mono font-bold text-green-600",children:x.version})]}),x.date&&t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Release Date:"}),t.jsx("span",{children:new Date(x.date).toLocaleDateString()})]})]}),x?.body&&t.jsxs("div",{className:"rounded-md bg-muted p-3 text-sm",children:[t.jsx("p",{className:"font-semibold mb-2",children:"Release Notes:"}),t.jsx("div",{className:"max-h-48 overflow-y-auto",children:t.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap text-xs",children:x.body})})]}),m&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{children:b===100?"Installing...":"Downloading..."}),t.jsxs("span",{children:[b.toFixed(0),"%"]})]}),t.jsx(SW,{value:b})]}),b===100&&m&&t.jsxs(fj,{className:"border-green-500 bg-green-50 dark:bg-green-950",children:[t.jsx(MT,{className:"h-4 w-4 text-green-600"}),t.jsx(gj,{children:"Update Ready!"}),t.jsx(xj,{children:"The application will restart in a moment..."})]}),w&&t.jsxs(fj,{variant:"destructive",children:[t.jsx(Rp,{className:"h-4 w-4"}),t.jsx(gj,{children:"Error"}),t.jsx(xj,{children:w})]}),!m&&t.jsx("p",{className:"text-xs text-muted-foreground",children:"The update will download and install automatically. Your app will restart after installation."})]}),t.jsxs(o2,{children:[!m&&!w&&t.jsxs(t.Fragment,{children:[t.jsx(Tr,{variant:"outline",onClick:C,children:"Later"}),t.jsxs(Tr,{onClick:y,children:[t.jsx(Mi,{className:"mr-2 h-4 w-4"}),"Update Now"]})]}),m&&t.jsxs(Tr,{disabled:!0,children:[t.jsx(xn,{className:"mr-2 h-4 w-4 animate-spin"}),b===100?"Installing...":"Downloading..."]})]})]})})]})}function ZJ(){return t.jsx(RF,{children:t.jsx(QJ,{})})}const Wf=()=>t.jsx("div",{className:"fixed inset-0 w-full h-full",style:{top:"-10vh",left:"-10vw",right:"-10vw",bottom:"-10vh",width:"120vw",height:"120vh"},children:t.jsx("div",{className:"w-full h-full bg-black",children:t.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 1600 1200",preserveAspectRatio:"none",children:[t.jsx("defs",{children:t.jsxs("pattern",{id:"geometric-grid",x:"0",y:"0",width:"60",height:"60",patternUnits:"userSpaceOnUse",children:[t.jsx("line",{x1:"0",y1:"0",x2:"60",y2:"60",stroke:"#333333",strokeWidth:"0.8",opacity:"0.8"}),t.jsx("line",{x1:"60",y1:"0",x2:"0",y2:"60",stroke:"#333333",strokeWidth:"0.8",opacity:"0.8"})]})}),t.jsx("rect",{width:"100%",height:"100%",fill:"url(#geometric-grid)",opacity:"0.6"})]})})}),eQ=({onNavigate:s})=>t.jsxs("div",{className:"relative z-10 p-8 flex justify-between items-center",children:[t.jsx("button",{onClick:()=>s("login"),className:"text-white text-2xl font-bold hover:text-zinc-300 transition-colors",children:"Fincept"}),t.jsxs("button",{onClick:()=>s("help"),className:"text-zinc-400 hover:text-white transition-colors text-sm flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Help"]})]}),tQ=({onNavigate:s})=>t.jsxs("div",{className:"relative z-10 p-4 text-xs text-zinc-500 flex justify-between items-center mt-auto border-t border-zinc-800",children:[t.jsx("div",{children:" 2025 Fincept LP All rights reserved."}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx("button",{onClick:()=>s("contactUs"),className:"hover:text-zinc-400 transition-colors",children:"Contact Us"}),t.jsx("button",{onClick:()=>s("termsOfService"),className:"hover:text-zinc-400 transition-colors",children:"Terms of Service"}),t.jsx("button",{onClick:()=>s("trademarks"),className:"hover:text-zinc-400 transition-colors",children:"Trademarks"}),t.jsx("button",{onClick:()=>s("privacyPolicy"),className:"hover:text-zinc-400 transition-colors",children:"Privacy Policy"}),t.jsx("button",{onClick:()=>s("help"),className:"hover:text-zinc-400 transition-colors",children:"Help Center"})]})]}),rQ=({checkoutUrl:s,onSuccess:e,onCancel:r,onError:n,planName:i,planPrice:o})=>{const[a,l]=S.useState(!0),[d,p]=S.useState(!1),[f,h]=S.useState(""),x=S.useRef(null);S.useEffect(()=>{const T=k=>{const A=["dodopayments.com","stripe.com","paypal.com"],R=new URL(k.origin);A.some(M=>R.hostname.includes(M))&&(console.log("Payment message received:",k.data),k.data.type==="payment_success"?(console.log("Payment completed successfully"),e()):k.data.type==="payment_error"?(console.log("Payment failed:",k.data.error),n(k.data.error||"Payment failed")):k.data.type==="payment_cancelled"&&(console.log("Payment cancelled by user"),r()))};window.addEventListener("message",T);const j=setInterval(()=>{try{if(x.current?.contentWindow){const k=x.current.contentWindow.location.href;k.includes("payment-success")||k.includes("success")?(console.log("Payment success detected via URL"),e()):(k.includes("payment-error")||k.includes("cancelled"))&&(console.log("Payment cancelled/failed detected via URL"),r())}}catch{console.log("URL monitoring blocked by CORS (expected)")}},2e3);return()=>{window.removeEventListener("message",T),clearInterval(j)}},[e,n,r]);const m=()=>{l(!1),p(!1)},b=()=>{l(!1),p(!0),h("Failed to load payment page. Please check your internet connection.")},w=()=>{l(!0),p(!1),h(""),x.current&&(x.current.src=s)},y=()=>{window.open(s,"_blank")},C=T=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(T);return t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-zinc-900 border border-zinc-700 rounded-xl w-full max-w-4xl h-full max-h-[90vh] flex flex-col shadow-2xl",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-zinc-700",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"p-2 bg-blue-600/20 rounded-lg",children:t.jsx(FT,{className:"w-5 h-5 text-blue-400"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-white font-semibold",children:"Complete Your Payment"}),t.jsxs("p",{className:"text-zinc-400 text-sm",children:[i," - ",C(o)]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("div",{className:"flex items-center space-x-1 text-xs text-zinc-500",children:[t.jsx(jo,{className:"w-3 h-3"}),t.jsx("span",{children:"Secure Payment"})]}),t.jsx(Tr,{onClick:w,variant:"outline",size:"sm",className:"border-zinc-600 text-zinc-300 hover:bg-zinc-800",disabled:a,children:t.jsx(xn,{className:`w-4 h-4 ${a?"animate-spin":""}`})}),t.jsx(Tr,{onClick:y,variant:"outline",size:"sm",className:"border-zinc-600 text-zinc-300 hover:bg-zinc-800",title:"Open in browser",children:t.jsx(Nd,{className:"w-4 h-4"})}),t.jsx(Tr,{onClick:r,variant:"outline",size:"sm",className:"border-zinc-600 text-zinc-300 hover:bg-zinc-800",children:t.jsx(ln,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"flex-1 relative",children:[a&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-zinc-900",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"w-8 h-8 border border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),t.jsx("h3",{className:"text-white font-medium mb-2",children:"Loading Payment Page"}),t.jsx("p",{className:"text-zinc-400 text-sm",children:"Please wait while we prepare your checkout..."})]})}),d&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-zinc-900",children:t.jsxs("div",{className:"text-center max-w-md",children:[t.jsx(Rr,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),t.jsx("h3",{className:"text-white font-medium mb-2",children:"Payment Page Failed to Load"}),t.jsx("p",{className:"text-zinc-400 text-sm mb-6",children:f||"There was an issue loading the payment page. Please try again or open in your browser."}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs(Tr,{onClick:w,className:"w-full bg-blue-600 hover:bg-blue-500 text-white",children:[t.jsx(xn,{className:"w-4 h-4 mr-2"}),"Try Again"]}),t.jsxs(Tr,{onClick:y,variant:"outline",className:"w-full border-zinc-600 text-zinc-300 hover:bg-zinc-800",children:[t.jsx(Nd,{className:"w-4 h-4 mr-2"}),"Open in Browser"]})]})]})}),t.jsx("iframe",{ref:x,src:s,className:"w-full h-full border-0",onLoad:m,onError:b,title:"Payment Checkout",sandbox:"allow-same-origin allow-scripts allow-forms allow-top-navigation allow-popups",allow:"payment; encrypted-media"})]}),t.jsx("div",{className:"p-4 border-t border-zinc-700 bg-zinc-900/50",children:t.jsxs("div",{className:"flex items-center justify-between text-xs text-zinc-500",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx(jo,{className:"w-3 h-3"}),t.jsx("span",{children:"SSL Encrypted"})]}),t.jsx("span",{children:""}),t.jsx("span",{children:"PCI Compliant"}),t.jsx("span",{children:""}),t.jsx("span",{children:"Secure Payment Processing"})]}),t.jsx("div",{className:"text-right",children:t.jsx("div",{children:"Need help? Contact support"})})]})})]})})},O0=({paymentWindow:s})=>s.isOpen?t.jsx(rQ,{checkoutUrl:s.checkoutUrl,planName:s.planName,planPrice:s.planPrice,onSuccess:s.onSuccess||(()=>{}),onCancel:s.onCancel||(()=>{}),onError:s.onError||(()=>{})}):null,nQ=({onSetupComplete:s})=>{const[e,r]=S.useState(!0),[n,i]=S.useState(!1),[o,a]=S.useState(null),[l,d]=S.useState(0),[p,f]=S.useState(0),[h,x]=S.useState(0),[m,b]=S.useState(""),[w,y]=S.useState(""),[C,T]=S.useState(null),[E,j]=S.useState([]),[k,A]=S.useState(!1);S.useEffect(()=>{R(),M()},[]);const R=async()=>{try{r(!0);const O=await lt("check_setup_status");a(O),O.needs_setup?(r(!1),P()):setTimeout(()=>s(),1e3)}catch(O){console.error("Failed to check setup status:",O),T(String(O)),r(!1)}},M=async()=>{const O=await $I("setup-progress",G=>{const B=G.payload;if(b(B.step),y(B.message),B.message&&j(F=>[...F,`[${B.step}] ${B.message}`]),B.is_error){T(B.message);return}switch(B.step){case"python":d(B.progress);break;case"bun":f(B.progress);break;case"packages":x(B.progress);break;case"complete":setTimeout(()=>s(),2e3);break}});return()=>{O()}},P=async()=>{try{i(!0),T(null),await lt("run_setup")}catch(O){console.error("Setup failed:",O),T(String(O)),i(!1)}},I=()=>{console.log("[SetupScreen] Retry button clicked"),T(null),d(0),f(0),x(0),b(""),y(""),j([]),A(!1),i(!0),P()};return e?t.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:t.jsxs("div",{className:"text-center space-y-6",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-20 h-20 border-4 border-zinc-800 rounded-full mx-auto"}),t.jsx("div",{className:"w-20 h-20 border-4 border-t-emerald-500 rounded-full animate-spin absolute top-0 left-1/2 transform -translate-x-1/2"})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Fincept Terminal"}),t.jsx("p",{className:"text-zinc-400",children:"Checking system requirements..."})]})]})}):t.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center p-8",children:t.jsxs("div",{className:"max-w-2xl w-full space-y-8",children:[t.jsxs("div",{className:"text-center space-y-4",children:[t.jsx("h1",{className:"text-4xl font-bold text-white",children:"Welcome to Fincept Terminal"}),t.jsx("p",{className:"text-zinc-400 text-lg",children:"Setting up your environment for the first time..."}),o&&!o.needs_setup&&t.jsx("p",{className:"text-emerald-500 text-sm",children:" System is ready!"})]}),(n||o?.needs_setup)&&t.jsxs("div",{className:"bg-zinc-900 rounded-lg border border-zinc-800 p-8 space-y-6",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 ${l===100?"bg-emerald-500 scale-110":l>0?"bg-blue-500 animate-pulse":"bg-zinc-800"}`,children:l===100?"":"1"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-white font-semibold",children:"Python 3.12.7"}),t.jsx("p",{className:"text-zinc-500 text-sm",children:o?.python_installed?`Installed: ${o.python_version}`:"Required for analytics and data processing"})]})]}),t.jsxs("span",{className:"text-zinc-400 text-sm font-mono",children:[l,"%"]})]}),t.jsx("div",{className:"w-full bg-zinc-800 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-full transition-all duration-500 ease-out",style:{width:`${l}%`}})}),m==="python"&&w&&t.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[t.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"}),t.jsx("p",{className:"text-blue-300 font-medium animate-fade-in",children:w})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 ${p===100?"bg-emerald-500 scale-110":p>0?"bg-blue-500 animate-pulse":"bg-zinc-800"}`,children:p===100?"":"2"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-white font-semibold",children:"Bun v1.1.0"}),t.jsx("p",{className:"text-zinc-500 text-sm",children:o?.bun_installed?`Installed: ${o.bun_version}`:"Required for MCP servers (bunx)"})]})]}),t.jsxs("span",{className:"text-zinc-400 text-sm font-mono",children:[p,"%"]})]}),t.jsx("div",{className:"w-full bg-zinc-800 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-full transition-all duration-500 ease-out",style:{width:`${p}%`}})}),m==="bun"&&w&&t.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[t.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"}),t.jsx("p",{className:"text-blue-300 font-medium animate-fade-in",children:w})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 ${h===100?"bg-emerald-500 scale-110":h>0?"bg-blue-500 animate-pulse":"bg-zinc-800"}`,children:h===100?"":"3"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-white font-semibold",children:"Python Libraries"}),t.jsx("p",{className:"text-zinc-500 text-sm",children:"Installing pandas, numpy, yfinance, and more..."})]})]}),t.jsxs("span",{className:"text-zinc-400 text-sm font-mono",children:[h,"%"]})]}),t.jsx("div",{className:"w-full bg-zinc-800 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 h-full transition-all duration-500 ease-out",style:{width:`${h}%`}})}),m==="packages"&&w&&t.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[t.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"}),t.jsx("p",{className:"text-blue-300 font-medium animate-fade-in",children:w})]})]})]}),C&&t.jsxs("div",{className:"bg-red-900/20 border border-red-500/50 rounded-lg p-4 space-y-3",children:[t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("span",{className:"text-red-500 text-xl",children:""}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"text-red-500 font-semibold",children:"Setup Error"}),t.jsx("p",{className:"text-red-300 text-sm mt-1",children:C})]})]}),t.jsx("button",{onClick:I,className:"w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg transition-colors",children:"Retry Setup"})]}),!C&&t.jsx("div",{className:"bg-blue-900/20 border border-blue-500/50 rounded-lg p-4 space-y-3",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsxs("div",{className:"flex-1 space-y-2",children:[t.jsxs("p",{className:"text-blue-300 text-sm",children:[t.jsx("strong",{children:"Note:"})," This is a one-time setup process. The application will download and install the necessary runtimes for optimal performance."]}),t.jsx("p",{className:"text-blue-200 text-sm font-medium",children:" This process may take a few minutes to complete. On older CPUs, it might take longer."}),t.jsx("p",{className:"text-yellow-300 text-sm font-semibold",children:" Please do not close the application during installation. Wait for the process to complete."})]})]})}),n&&E.length>0&&t.jsxs("div",{className:"bg-zinc-900 border border-zinc-800 rounded-lg overflow-hidden",children:[t.jsxs("button",{onClick:()=>A(!k),className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-zinc-800 transition-colors",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("svg",{className:`w-4 h-4 text-zinc-400 transition-transform ${k?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),t.jsx("span",{className:"text-white font-medium",children:"Installation Logs"}),t.jsxs("span",{className:"text-zinc-500 text-sm",children:["(",E.length," entries)"]})]}),t.jsxs("span",{className:"text-zinc-500 text-xs",children:["Click to ",k?"hide":"show"]})]}),k&&t.jsx("div",{className:"border-t border-zinc-800 bg-black/40 p-4 max-h-64 overflow-y-auto font-mono text-xs",children:E.map((O,G)=>t.jsxs("div",{className:"text-zinc-400 py-0.5 hover:bg-zinc-800/50 px-2 rounded animate-fade-in",children:[t.jsxs("span",{className:"text-zinc-600 mr-2",children:[G+1,"."]}),O]},G))})]})]})})},sQ=()=>{const{session:s,isLoading:e}=Ao(),[r,n]=S.useState("login"),[i,o]=S.useState(!1),[a,l]=S.useState(!1),[d,p]=S.useState("dashboard"),[f,h]=S.useState(!1),[x,m]=S.useState(!0),[b,w]=S.useState({isOpen:!1,checkoutUrl:"",planName:"",planPrice:0});if(S.useEffect(()=>{(async()=>{try{const{invoke:E}=await Br(async()=>{const{invoke:k}=await import("./tauri-vendor-CMSE6dGk.js").then(A=>A.c);return{invoke:k}},[]),j=await E("check_setup_status");h(!j.needs_setup)}catch(E){console.error("Failed to check setup status:",E),h(!1)}finally{m(!1)}})()},[]),S.useEffect(()=>{yP({openPaymentWindow:(E,j,k)=>new Promise(A=>{console.log("PaymentManager: Opening payment window for:",j),w({isOpen:!0,checkoutUrl:E,planName:j,planPrice:k,onSuccess:()=>{console.log("PaymentManager: Payment completed successfully"),w(R=>({...R,isOpen:!1})),n("paymentProcessing"),A(!0)},onCancel:()=>{console.log("PaymentManager: Payment cancelled by user"),w(R=>({...R,isOpen:!1})),n("pricing"),A(!1)},onError:R=>{console.error("PaymentManager: Payment error:",R),w(M=>({...M,isOpen:!1})),n("pricing"),A(!1)}})})}),console.log("PaymentManager: Initialized in-app payment window manager")},[]),S.useEffect(()=>()=>{console.log("[App] App unmounting, cleaning up running workflows..."),Td.cleanupRunningWorkflows().catch(T=>{console.error("[App] Failed to cleanup running workflows:",T)})},[]),S.useEffect(()=>{const T=new URLSearchParams(window.location.search),E=T.get("session_id"),j=T.get("payment_id");if(E||j){console.log("Payment success URL detected, redirecting to payment success screen"),n("paymentSuccess"),window.history.replaceState({},document.title,window.location.pathname);return}},[]),S.useEffect(()=>{if(console.log("App.tsx useEffect triggered:",{session:s?.authenticated,isLoading:e,currentScreen:r,userType:s?.user_type,accountType:s?.user_info?.account_type,hasSubscription:s?.subscription?.has_subscription,cameFromLogin:a,hasChosenFreePlan:i}),!e)if(s?.authenticated){console.log("Session is authenticated");const T=s.user_info?.account_type==="free",E=s.subscription?.data?.has_subscription||s.subscription?.has_subscription;s.user_type==="registered"&&T&&!E&&r!=="pricing"&&r!=="paymentProcessing"&&r!=="paymentSuccess"&&(a||!i)?(console.log("Free user without subscription detected, showing pricing screen"),n("pricing")):(E||s.user_type==="guest"||i&&!a||T&&i)&&(console.log("User has subscription, is guest, or chose free plan - redirecting to dashboard"),r!=="paymentProcessing"&&r!=="paymentSuccess"&&r!=="pricing"&&n("dashboard"))}else console.log("Session not authenticated, staying on auth screens"),(r==="dashboard"||r==="pricing"||r==="paymentProcessing")&&n("login"),r!=="paymentSuccess"&&(o(!1),l(!1))},[s,e,r,a,i]),x)return t.jsxs("div",{className:"min-h-screen bg-black relative overflow-hidden flex items-center justify-center",style:{minHeight:"100vh",height:"100%"},children:[t.jsx(Wf,{}),t.jsxs("div",{className:"relative z-10 text-center",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),t.jsx("p",{className:"text-zinc-400 text-sm",children:"Initializing Fincept Terminal..."})]})]});if(!f)return t.jsx(nQ,{onSetupComplete:()=>h(!0)});if(e)return t.jsxs("div",{className:"min-h-screen bg-black relative overflow-hidden flex items-center justify-center",style:{minHeight:"100vh",height:"100%"},children:[t.jsx(Wf,{}),t.jsxs("div",{className:"relative z-10 text-center",children:[t.jsx("div",{className:"w-8 h-8 border-2 border-white/30 border-t-white rounded-full animate-spin mx-auto mb-4"}),t.jsx("p",{className:"text-zinc-400 text-sm",children:"Initializing Fincept Terminal..."})]})]});if(s?.authenticated&&r==="dashboard")return t.jsxs(t.Fragment,{children:[t.jsx(yz,{children:t.jsx(AP,{children:t.jsx(CP,{children:t.jsx(bz,{children:t.jsx(SP,{onNavigate:n,onSetActiveTab:p,children:t.jsx(ZJ,{})})})})})}),t.jsx(O0,{paymentWindow:b})]});if(r==="paymentProcessing"||r==="paymentSuccess")return t.jsxs("div",{className:"min-h-screen bg-black relative overflow-hidden flex items-center justify-center",style:{minHeight:"100vh",height:"100%"},children:[t.jsx(Wf,{}),t.jsx("div",{className:"relative z-10 flex items-center justify-center",children:y()}),t.jsx(O0,{paymentWindow:b})]});function y(){switch(r){case"paymentProcessing":return t.jsx(uF,{onNavigate:n,onPaymentComplete:()=>{o(!1),l(!1),n("dashboard")}});case"paymentSuccess":return t.jsx(wF,{onNavigate:n,onComplete:()=>{o(!1),l(!1),n("dashboard")}});default:return null}}const C=()=>{switch(r){case"login":return t.jsx(yC,{onNavigate:T=>{T==="dashboard"&&l(!0),n(T)}});case"register":return t.jsx(aF,{onNavigate:n});case"forgotPassword":return t.jsx(lF,{onNavigate:n});case"help":return t.jsx(cF,{onNavigate:n});case"pricing":return t.jsx(dF,{onNavigate:T=>{n(T==="paymentProcessing"?"paymentProcessing":T)},onProceedToDashboard:()=>{o(!0),l(!1),n("dashboard")},userType:"existing"});case"contactUs":return t.jsx(EF,{onNavigate:n});case"termsOfService":return t.jsx(CF,{onNavigate:n});case"trademarks":return t.jsx(jF,{onNavigate:n});case"privacyPolicy":return t.jsx(kF,{onNavigate:n});default:return t.jsx(yC,{onNavigate:n})}};return t.jsxs("div",{className:"min-h-screen bg-black relative overflow-hidden flex flex-col",style:{minHeight:"100vh",height:"100%"},children:[t.jsx(Wf,{}),t.jsx(eQ,{onNavigate:n}),t.jsx("div",{className:"relative z-10 flex items-center justify-center flex-1",children:C()}),t.jsx(tQ,{onNavigate:n}),t.jsx(O0,{paymentWindow:b})]})},{slice:iQ,forEach:oQ}=[];function aQ(s){return oQ.call(iQ.call(arguments,1),e=>{if(e)for(const r in e)s[r]===void 0&&(s[r]=e[r])}),s}function lQ(s){return typeof s!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(s))}const Kk=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,cQ=function(s,e){const n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},i=encodeURIComponent(e);let o=`${s}=${i}`;if(n.maxAge>0){const a=n.maxAge-0;if(Number.isNaN(a))throw new Error("maxAge should be a Number");o+=`; Max-Age=${Math.floor(a)}`}if(n.domain){if(!Kk.test(n.domain))throw new TypeError("option domain is invalid");o+=`; Domain=${n.domain}`}if(n.path){if(!Kk.test(n.path))throw new TypeError("option path is invalid");o+=`; Path=${n.path}`}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+=`; Expires=${n.expires.toUTCString()}`}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n.partitioned&&(o+="; Partitioned"),o},Vk={create(s,e,r,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+r*60*1e3)),n&&(i.domain=n),document.cookie=cQ(s,e,i)},read(s){const e=`${s}=`,r=document.cookie.split(";");for(let n=0;n<r.length;n++){let i=r[n];for(;i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return i.substring(e.length,i.length)}return null},remove(s,e){this.create(s,"",-1,e)}};var dQ={name:"cookie",lookup(s){let{lookupCookie:e}=s;if(e&&typeof document<"u")return Vk.read(e)||void 0},cacheUserLanguage(s,e){let{lookupCookie:r,cookieMinutes:n,cookieDomain:i,cookieOptions:o}=e;r&&typeof document<"u"&&Vk.create(r,s,n,i,o)}},uQ={name:"querystring",lookup(s){let{lookupQuerystring:e}=s,r;if(typeof window<"u"){let{search:n}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(n=window.location.hash.substring(window.location.hash.indexOf("?")));const o=n.substring(1).split("&");for(let a=0;a<o.length;a++){const l=o[a].indexOf("=");l>0&&o[a].substring(0,l)===e&&(r=o[a].substring(l+1))}}return r}},pQ={name:"hash",lookup(s){let{lookupHash:e,lookupFromHashIndex:r}=s,n;if(typeof window<"u"){const{hash:i}=window.location;if(i&&i.length>2){const o=i.substring(1);if(e){const a=o.split("&");for(let l=0;l<a.length;l++){const d=a[l].indexOf("=");d>0&&a[l].substring(0,d)===e&&(n=a[l].substring(d+1))}}if(n)return n;if(!n&&r>-1){const a=i.match(/\/([a-zA-Z-]*)/g);return Array.isArray(a)?a[typeof r=="number"?r:0]?.replace("/",""):void 0}}}return n}};let gd=null;const Xk=()=>{if(gd!==null)return gd;try{if(gd=typeof window<"u"&&window.localStorage!==null,!gd)return!1;const s="i18next.translate.boo";window.localStorage.setItem(s,"foo"),window.localStorage.removeItem(s)}catch{gd=!1}return gd};var hQ={name:"localStorage",lookup(s){let{lookupLocalStorage:e}=s;if(e&&Xk())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(s,e){let{lookupLocalStorage:r}=e;r&&Xk()&&window.localStorage.setItem(r,s)}};let xd=null;const Jk=()=>{if(xd!==null)return xd;try{if(xd=typeof window<"u"&&window.sessionStorage!==null,!xd)return!1;const s="i18next.translate.boo";window.sessionStorage.setItem(s,"foo"),window.sessionStorage.removeItem(s)}catch{xd=!1}return xd};var fQ={name:"sessionStorage",lookup(s){let{lookupSessionStorage:e}=s;if(e&&Jk())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(s,e){let{lookupSessionStorage:r}=e;r&&Jk()&&window.sessionStorage.setItem(r,s)}},gQ={name:"navigator",lookup(s){const e=[];if(typeof navigator<"u"){const{languages:r,userLanguage:n,language:i}=navigator;if(r)for(let o=0;o<r.length;o++)e.push(r[o]);n&&e.push(n),i&&e.push(i)}return e.length>0?e:void 0}},xQ={name:"htmlTag",lookup(s){let{htmlTag:e}=s,r;const n=e||(typeof document<"u"?document.documentElement:null);return n&&typeof n.getAttribute=="function"&&(r=n.getAttribute("lang")),r}},mQ={name:"path",lookup(s){let{lookupFromPathIndex:e}=s;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?r[typeof e=="number"?e:0]?.replace("/",""):void 0}},yQ={name:"subdomain",lookup(s){let{lookupFromSubdomainIndex:e}=s;const r=typeof e=="number"?e+1:1,n=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n[r]}};let p_=!1;try{document.cookie,p_=!0}catch{}const h_=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];p_||h_.splice(1,1);const bQ=()=>({order:h_,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:s=>s});class f_{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,r)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=aQ(r,this.options||{},bQ()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=i=>i.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(dQ),this.addDetector(uQ),this.addDetector(hQ),this.addDetector(fQ),this.addDetector(gQ),this.addDetector(xQ),this.addDetector(mQ),this.addDetector(yQ),this.addDetector(pQ)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return e.forEach(n=>{if(this.detectors[n]){let i=this.detectors[n].lookup(this.options);i&&typeof i=="string"&&(i=[i]),i&&(r=r.concat(i))}}),r=r.filter(n=>n!=null&&!lQ(n)).map(n=>this.options.convertDetectedLanguage(n)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||r.forEach(n=>{this.detectors[n]&&this.detectors[n].cacheUserLanguage(e,this.options)}))}}f_.type="languageDetector";function _b(s){"@babel/helpers - typeof";return _b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_b(s)}function g_(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":_b(XMLHttpRequest))==="object"}function vQ(s){return!!s&&typeof s.then=="function"}function SQ(s){return vQ(s)?s:Promise.resolve(s)}function Qk(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,n)}return r}function Zk(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qk(Object(r),!0).forEach(function(n){wQ(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Qk(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function wQ(s,e,r){return(e=EQ(e))in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function EQ(s){var e=CQ(s,"string");return bc(e)=="symbol"?e:e+""}function CQ(s,e){if(bc(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,e);if(bc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function bc(s){"@babel/helpers - typeof";return bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bc(s)}var jl=typeof fetch=="function"?fetch:void 0;typeof globalThis<"u"&&globalThis.fetch?jl=globalThis.fetch:typeof window<"u"&&window.fetch&&(jl=window.fetch);var $p;g_()&&(typeof globalThis<"u"&&globalThis.XMLHttpRequest?$p=globalThis.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&($p=window.XMLHttpRequest));var Fg;typeof ActiveXObject=="function"&&(typeof globalThis<"u"&&globalThis.ActiveXObject?Fg=globalThis.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(Fg=window.ActiveXObject));typeof jl!="function"&&(jl=void 0);if(!jl&&!$p&&!Fg)try{Br(()=>import("./browser-ponyfill-BQXJ8VOh.js").then(s=>s.b),[]).then(function(s){jl=s.default}).catch(function(){})}catch{}var Db=function(e,r){if(r&&bc(r)==="object"){var n="";for(var i in r)n+="&"+encodeURIComponent(i)+"="+encodeURIComponent(r[i]);if(!n)return e;e=e+(e.indexOf("?")!==-1?"&":"?")+n.slice(1)}return e},eA=function(e,r,n,i){var o=function(d){if(!d.ok)return n(d.statusText||"Error",{status:d.status});d.text().then(function(p){n(null,{status:d.status,data:p})}).catch(n)};if(i){var a=i(e,r);if(a instanceof Promise){a.then(o).catch(n);return}}typeof fetch=="function"?fetch(e,r).then(o).catch(n):jl(e,r).then(o).catch(n)},tA=!1,jQ=function(e,r,n,i){e.queryStringParams&&(r=Db(r,e.queryStringParams));var o=Zk({},typeof e.customHeaders=="function"?e.customHeaders():e.customHeaders);typeof window>"u"&&typeof globalThis<"u"&&typeof globalThis.process<"u"&&globalThis.process.versions&&globalThis.process.versions.node&&(o["User-Agent"]="i18next-http-backend (node/".concat(globalThis.process.version,"; ").concat(globalThis.process.platform," ").concat(globalThis.process.arch,")")),n&&(o["Content-Type"]="application/json");var a=typeof e.requestOptions=="function"?e.requestOptions(n):e.requestOptions,l=Zk({method:n?"POST":"GET",body:n?e.stringify(n):void 0,headers:o},tA?{}:a),d=typeof e.alternateFetch=="function"&&e.alternateFetch.length>=1?e.alternateFetch:void 0;try{eA(r,l,i,d)}catch(p){if(!a||Object.keys(a).length===0||!p.message||p.message.indexOf("not implemented")<0)return i(p);try{Object.keys(a).forEach(function(f){delete l[f]}),eA(r,l,i,d),tA=!0}catch(f){i(f)}}},kQ=function(e,r,n,i){n&&bc(n)==="object"&&(n=Db("",n).slice(1)),e.queryStringParams&&(r=Db(r,e.queryStringParams));try{var o=$p?new $p:new Fg("MSXML2.XMLHTTP.3.0");o.open(n?"POST":"GET",r,1),e.crossDomain||o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.withCredentials=!!e.withCredentials,n&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.overrideMimeType&&o.overrideMimeType("application/json");var a=e.customHeaders;if(a=typeof a=="function"?a():a,a)for(var l in a)o.setRequestHeader(l,a[l]);o.onreadystatechange=function(){o.readyState>3&&i(o.status>=400?o.statusText:null,{status:o.status,data:o.responseText})},o.send(n)}catch(d){console&&console.log(d)}},AQ=function(e,r,n,i){if(typeof n=="function"&&(i=n,n=void 0),i=i||function(){},jl&&r.indexOf("file:")!==0)return jQ(e,r,n,i);if(g_()||typeof ActiveXObject=="function")return kQ(e,r,n,i);i(new Error("No fetch and no xhr implementation found!"))};function Fd(s){"@babel/helpers - typeof";return Fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fd(s)}function rA(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),r.push.apply(r,n)}return r}function _0(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rA(Object(r),!0).forEach(function(n){x_(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):rA(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function TQ(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function RQ(s,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,m_(n.key),n)}}function NQ(s,e,r){return e&&RQ(s.prototype,e),Object.defineProperty(s,"prototype",{writable:!1}),s}function x_(s,e,r){return(e=m_(e))in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function m_(s){var e=OQ(s,"string");return Fd(e)=="symbol"?e:e+""}function OQ(s,e){if(Fd(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,e);if(Fd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var _Q=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(r){return JSON.parse(r)},stringify:JSON.stringify,parsePayload:function(r,n,i){return x_({},n,i||"")},parseLoadPayload:function(r,n){},request:AQ,reloadInterval:typeof window<"u"?!1:3600*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},y_=(function(){function s(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};TQ(this,s),this.services=e,this.options=r,this.allOptions=n,this.type="backend",this.init(e,r,n)}return NQ(s,[{key:"init",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=r,this.options=_0(_0(_0({},_Q()),this.options||{}),i),this.allOptions=o,this.services&&this.options.reloadInterval){var a=setInterval(function(){return n.reload()},this.options.reloadInterval);Fd(a)==="object"&&typeof a.unref=="function"&&a.unref()}}},{key:"readMulti",value:function(r,n,i){this._readAny(r,r,n,n,i)}},{key:"read",value:function(r,n,i){this._readAny([r],r,[n],n,i)}},{key:"_readAny",value:function(r,n,i,o,a){var l=this,d=this.options.loadPath;typeof this.options.loadPath=="function"&&(d=this.options.loadPath(r,i)),d=SQ(d),d.then(function(p){if(!p)return a(null,{});var f=l.services.interpolator.interpolate(p,{lng:r.join("+"),ns:i.join("+")});l.loadUrl(f,a,n,o)})}},{key:"loadUrl",value:function(r,n,i,o){var a=this,l=typeof i=="string"?[i]:i,d=typeof o=="string"?[o]:o,p=this.options.parseLoadPayload(l,d);this.options.request(this.options,r,p,function(f,h){if(h&&(h.status>=500&&h.status<600||!h.status))return n("failed loading "+r+"; status code: "+h.status,!0);if(h&&h.status>=400&&h.status<500)return n("failed loading "+r+"; status code: "+h.status,!1);if(!h&&f&&f.message){var x=f.message.toLowerCase(),m=["failed","fetch","network","load"].find(function(y){return x.indexOf(y)>-1});if(m)return n("failed loading "+r+": "+f.message,!0)}if(f)return n(f,!1);var b,w;try{typeof h.data=="string"?b=a.options.parse(h.data,i,o):b=h.data}catch{w="failed parsing "+r+" to json"}if(w)return n(w,!1);n(null,b)})}},{key:"create",value:function(r,n,i,o,a){var l=this;if(this.options.addPath){typeof r=="string"&&(r=[r]);var d=this.options.parsePayload(n,i,o),p=0,f=[],h=[];r.forEach(function(x){var m=l.options.addPath;typeof l.options.addPath=="function"&&(m=l.options.addPath(x,n));var b=l.services.interpolator.interpolate(m,{lng:x,ns:n});l.options.request(l.options,b,d,function(w,y){p+=1,f.push(w),h.push(y),p===r.length&&typeof a=="function"&&a(f,h)})})}}},{key:"reload",value:function(){var r=this,n=this.services,i=n.backendConnector,o=n.languageUtils,a=n.logger,l=i.language;if(!(l&&l.toLowerCase()==="cimode")){var d=[],p=function(h){var x=o.toResolveHierarchy(h);x.forEach(function(m){d.indexOf(m)<0&&d.push(m)})};p(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(f){return p(f)}),d.forEach(function(f){r.allOptions.ns.forEach(function(h){i.read(f,h,"read",null,null,function(x,m){x&&a.warn("loading namespace ".concat(h," for language ").concat(f," failed"),x),!x&&m&&a.log("loaded namespace ".concat(h," for language ").concat(f),m),i.loaded("".concat(f,"|").concat(h),x,m)})})})}}}])})();y_.type="backend";ii.use(y_).use(f_).use(eF).init({fallbackLng:"en",supportedLngs:["en","es","fr","de","zh","ja","hi","ar","pt","ru","bn","ko","tr","it","id","vi","th","pl","uk","ro"],backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"},detection:{order:["localStorage","navigator"],caches:["localStorage"],lookupLocalStorage:"i18nextLng"},interpolation:{escapeValue:!1},defaultNS:"common",ns:["common","auth","dashboard","settings","tabs"],react:{useSuspense:!1}});function nA(){window.CORSFetch?(console.log(" Configuring Tauri CORS plugin..."),window.CORSFetch.config({include:[/^https?:\/\//i],exclude:[],request:{maxRedirections:5,connectTimeout:30*1e3}}),console.log(" Tauri CORS plugin configured successfully")):console.log("  CORSFetch not available (running in dev mode with Vite proxy)")}typeof window<"u"&&(window.CORSFetch?nA():setTimeout(()=>{window.CORSFetch&&nA()},100));const DQ={backtesting:!0,optimization:!0,liveTrading:!1,research:!0,multiAsset:["stocks","crypto","forex"],indicators:!0,customStrategies:!0,maxConcurrentBacktests:10,supportedTimeframes:["tick","second","minute","hour","daily"],supportedMarkets:["us-equity","crypto","forex"]};class IQ extends ux{constructor(){super(...arguments);Pe(this,"name","VectorBT");Pe(this,"version","0.25.0");Pe(this,"capabilities",DQ);Pe(this,"description","Ultra-fast vectorized backtesting with NumPy/Pandas");Pe(this,"activeBacktests",new Map)}async initialize(r){try{return this.ensureInitialized(),(await lt("execute_python_backtest",{provider:"vectorbt",command:"test_import",args:JSON.stringify({})})).success?(this.config=r,this.initialized=!0,this.createSuccessResult("VectorBT initialized successfully")):this.createErrorResult("VectorBT not installed. Run: pip install vectorbt")}catch(n){return this.createErrorResult(n instanceof Error?n:String(n))}}async testConnection(){this.ensureInitialized();try{const r=await lt("execute_python_backtest",{provider:"vectorbt",command:"test_connection",args:JSON.stringify({})});return r.success?(this.connected=!0,{success:!0,message:`VectorBT ${JSON.parse(r.stdout).version} is available`,latency:0}):{success:!1,message:"VectorBT connection test failed",error:"Failed to import vectorbt module"}}catch(r){return{success:!1,message:"Connection test failed",error:String(r)}}}async disconnect(){this.activeBacktests.clear(),this.connected=!1,this.initialized=!1}async runBacktest(r){this.ensureConnected();const n=this.generateId();try{this.activeBacktests.set(n,{id:n,status:"running",progress:0,message:"Running VectorBT backtest..."});const i=await lt("execute_python_backtest",{provider:"vectorbt",command:"run_backtest",args:JSON.stringify({id:n,strategy:r.strategy,startDate:r.startDate,endDate:r.endDate,initialCapital:r.initialCapital,assets:r.assets,parameters:r.parameters})});if(this.activeBacktests.delete(n),!i.success)throw new Error("VectorBT backtest failed");return JSON.parse(i.stdout)}catch(i){throw this.activeBacktests.delete(n),new Error(`VectorBT backtest failed: ${i}`)}}async getBacktestStatus(r){const n=this.activeBacktests.get(r);return n||{id:r,status:"completed",progress:100,message:"Backtest not found or already completed"}}async cancelBacktest(r){this.activeBacktests.delete(r)}async getHistoricalData(r){return[]}async getAvailableData(){return{markets:[{id:"us-equity",name:"US Equities",assetClasses:["equity"]},{id:"crypto",name:"Cryptocurrency",assetClasses:["crypto"]},{id:"forex",name:"Forex",assetClasses:["forex"]}],timeframes:["tick","second","minute","hour","daily"],dateRange:{start:"2000-01-01",end:new Date().toISOString().split("T")[0]},dataSize:"Flexible (uses yfinance, ccxt, etc.)",description:"VectorBT supports multiple data sources"}}async calculateIndicator(r,n){throw new Error("Use VectorBT indicators within backtests")}async getAvailableIndicators(){return{categories:[{name:"Trend",indicators:[{id:"sma",name:"Simple Moving Average",params:["window"]},{id:"ema",name:"Exponential Moving Average",params:["span"]},{id:"bb",name:"Bollinger Bands",params:["window","alpha"]}]},{name:"Momentum",indicators:[{id:"rsi",name:"RSI",params:["window"]},{id:"macd",name:"MACD",params:["fast","slow","signal"]}]},{name:"Volatility",indicators:[{id:"atr",name:"ATR",params:["window"]},{id:"stdev",name:"Standard Deviation",params:["window"]}]}],total:50,description:"VectorBT has 50+ vectorized indicators"}}async validateStrategy(r){const n=[],i=[];return(!r.code||r.code.language!=="python")&&n.push("VectorBT requires Python strategy code"),{valid:n.length===0,errors:n,warnings:i}}async getHealth(){return this.initialized?this.connected?{status:"healthy",message:"VectorBT operational"}:{status:"degraded",message:"Not connected"}:{status:"unhealthy",message:"Not initialized"}}}const PQ={backtesting:!0,optimization:!0,liveTrading:!1,research:!0,multiAsset:["stocks","crypto","forex","futures"],indicators:!0,customStrategies:!0,maxConcurrentBacktests:20,supportedTimeframes:["tick","second","minute","hour","daily"],supportedMarkets:["us-equity","crypto","forex","futures"]};class LQ extends ux{constructor(){super(...arguments);Pe(this,"name","Backtesting.py");Pe(this,"version","0.3.3");Pe(this,"capabilities",PQ);Pe(this,"description","Lightweight, fast event-driven backtesting with interactive charts");Pe(this,"activeBacktests",new Map)}extractJSON(r){const n=r.split(`
`);let i="",o=!1,a=0,l=null;for(const d of n)if(d.trim().startsWith("{")&&(o=!0,a=0,i=""),o){i+=d+`
`;for(const f of d)f==="{"&&a++,f==="}"&&a--;if(a===0&&i.trim().length>0)try{l=JSON.parse(i),i="",o=!1}catch{i="",o=!1}}if(l)return l;throw new Error("No valid JSON response found in output: "+r.substring(0,200))}async initialize(r){try{const n=await lt("execute_python_backtest",{provider:"backtestingpy",command:"initialize",args:JSON.stringify(r||{})}),i=this.extractJSON(n);return i.success?(this.config=r,this.initialized=!0,this.createSuccessResult(i.message||"Backtesting.py initialized successfully")):this.createErrorResult(i.error||"Backtesting.py not installed. Run: pip install backtesting")}catch(n){return ir.error("Initialize error:",n),this.createErrorResult(n instanceof Error?n.message:String(n))}}async testConnection(){this.ensureInitialized();try{const r=await lt("execute_python_backtest",{provider:"backtestingpy",command:"test_connection",args:JSON.stringify({})}),n=this.extractJSON(r);return n.success?(this.connected=!0,{success:!0,message:n.message||"Backtesting.py is available",latency:0}):{success:!1,message:"Backtesting.py connection test failed",error:n.error||"Failed to import backtesting module"}}catch(r){return{success:!1,message:"Connection test failed",error:String(r)}}}async disconnect(){try{await lt("execute_python_backtest",{provider:"backtestingpy",command:"disconnect",args:JSON.stringify({})}),this.activeBacktests.clear(),this.connected=!1,this.initialized=!1}catch(r){ir.error("Disconnect error:",r)}}async runBacktest(r){this.ensureConnected();const n=this.generateBacktestId();try{this.activeBacktests.set(n,{id:n,status:"running",progress:0,message:"Running Backtesting.py backtest..."}),ir.debug("Running backtest:",{id:n,strategy:r.strategy?.name,assets:r.assets?.map(l=>l.symbol)});const i=await lt("execute_python_backtest",{provider:"backtestingpy",command:"run_backtest",args:JSON.stringify({id:n,strategy:r.strategy,startDate:r.startDate,endDate:r.endDate,initialCapital:r.initialCapital,assets:r.assets,commission:r.commission,tradeOnClose:r.tradeOnClose,hedging:r.hedging,exclusiveOrders:r.exclusiveOrders,margin:r.margin})});ir.debug("Raw Python output length:",i.length),ir.debug("Raw Python output (first 500):",i.substring(0,500)),ir.debug("Raw Python output (last 500):",i.substring(Math.max(0,i.length-500)));const o=this.extractJSON(i);if(ir.debug("Python response:",o),ir.debug("Has data field?","data"in o),this.activeBacktests.delete(n),!o.success)throw new Error(o.error||"Backtest execution failed");if(!o.data)throw ir.error("No data in result:",o),new Error("Backtest completed but no data returned");const a=o.data;return ir.debug("Full result.data:",JSON.stringify(o.data,null,2)),ir.info("Backtest completed:",{id:n,totalReturn:a.performance?.totalReturn,sharpeRatio:a.performance?.sharpeRatio,trades:a.trades?.length,performanceKeys:Object.keys(a.performance||{})}),a}catch(i){throw this.activeBacktests.delete(n),ir.error("Backtest error:",i),i}}async optimize(r){this.ensureConnected();try{ir.debug("Running optimization:",{strategy:r.strategy?.name,parameters:Object.keys(r.parameters||{})});const n=await lt("execute_python_backtest",{provider:"backtestingpy",command:"optimize",args:JSON.stringify({strategy:r.strategy,parameters:r.parameters,objective:r.objective,startDate:r.startDate,endDate:r.endDate,initialCapital:r.initialCapital,assets:r.assets,constraints:r.constraints})}),i=this.extractJSON(n);if(!i.success)throw new Error(i.error||"Optimization failed");const o=i.data;return ir.info("Optimization completed:",{bestParams:o.bestParameters,iterations:o.iterations}),o}catch(n){throw ir.error("Optimization error:",n),n}}async getHistoricalData(r){this.ensureConnected();try{return ir.warn("Data fetching not implemented"),[]}catch(n){throw ir.error("Data fetch error:",n),n}}async getAvailableData(){return{providers:[],timeframes:["daily","minute","second"]}}async calculateIndicator(r,n){this.ensureConnected();try{return ir.warn("Indicator calculation not directly supported"),{indicator:r,symbol:"",values:[]}}catch(i){throw ir.error("Indicator calculation error:",i),i}}async getAvailableIndicators(){return{categories:[{name:"trend",indicators:[{id:"sma",name:"SMA",params:["period"],description:"Simple Moving Average"},{id:"ema",name:"EMA",params:["period"],description:"Exponential Moving Average"}]},{name:"momentum",indicators:[{id:"rsi",name:"RSI",params:["period"],description:"Relative Strength Index"}]}]}}async validateStrategy(r){try{const n=[],i=[];return(!r.name||r.name.trim()==="")&&n.push("Strategy name is required"),!r.code&&r.type!=="visual"&&i.push("No strategy code provided, using default SMA crossover"),{valid:n.length===0,errors:n,warnings:i}}catch(n){return{valid:!1,errors:[String(n)],warnings:[]}}}generateBacktestId(){return`bt-py-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}const zQ={backtesting:!0,optimization:!1,liveTrading:!1,research:!0,multiAsset:["stocks","crypto","forex","futures"],indicators:!0,customStrategies:!0,maxConcurrentBacktests:50,supportedTimeframes:["minute","hour","daily"],supportedMarkets:["us-equity","crypto","forex","futures"]};class MQ extends ux{constructor(){super(...arguments);Pe(this,"name","Fast-Trade");Pe(this,"version","0.4.0");Pe(this,"capabilities",zQ);Pe(this,"description","Fast, low-code backtesting with JSON-based strategies and 80+ FINTA indicators");Pe(this,"activeBacktests",new Map)}extractJSON(r){const n=r.split(`
`);let i="",o=!1,a=0,l=null;for(const d of n)if(d.trim().startsWith("{")&&(o=!0,a=0,i=""),o){i+=d+`
`;for(const f of d)f==="{"&&a++,f==="}"&&a--;if(a===0&&i.trim().length>0)try{l=JSON.parse(i),i="",o=!1}catch{i="",o=!1}}if(l)return l;throw new Error("No valid JSON found in output: "+r.substring(0,200))}async initialize(r){try{const n=await lt("execute_python_backtest",{provider:"fasttrade",command:"initialize",args:JSON.stringify(r||{})}),i=this.extractJSON(n);return i.success?(this.config=r,this.initialized=!0,this.createSuccessResult(i.message||"Fast-Trade initialized successfully")):this.createErrorResult(i.error||"Fast-Trade not installed. Run: pip install fast-trade")}catch(n){return console.error("[FastTradeAdapter] Initialize error:",n),this.createErrorResult(n instanceof Error?n.message:String(n))}}async testConnection(){this.ensureInitialized();try{const r=await lt("execute_python_backtest",{provider:"fasttrade",command:"test_connection",args:JSON.stringify({})}),n=this.extractJSON(r);return n.success?(this.connected=!0,{success:!0,message:n.message||"Fast-Trade is available",latency:0}):{success:!1,message:"Fast-Trade connection test failed",error:n.error}}catch(r){return{success:!1,message:"Connection test failed",error:String(r)}}}async disconnect(){try{await lt("execute_python_backtest",{provider:"fasttrade",command:"disconnect",args:JSON.stringify({})}),this.activeBacktests.clear(),this.connected=!1,this.initialized=!1}catch(r){console.error("[FastTradeAdapter] Disconnect error:",r)}}async runBacktest(r){this.ensureConnected();const n=this.generateBacktestId();try{this.activeBacktests.set(n,{id:n,status:"running",progress:0,message:"Running Fast-Trade backtest..."});const i=await lt("execute_python_backtest",{provider:"fasttrade",command:"run_backtest",args:JSON.stringify({id:n,strategy:r.strategy,startDate:r.startDate,endDate:r.endDate,initialCapital:r.initialCapital,assets:r.assets})}),o=this.extractJSON(i);if(this.activeBacktests.delete(n),!o.success)throw new Error(o.error||"Backtest failed");if(!o.data)throw new Error("No backtest data returned");return o.data}catch(i){throw this.activeBacktests.delete(n),console.error("[FastTradeAdapter] Backtest error:",i),i}}async getHistoricalData(r){throw new Error("Historical data fetching not supported by Fast-Trade adapter")}async getAvailableData(){return{timeframes:["minute","hour","daily"],markets:[{id:"us-equity",name:"US Equity",assetClasses:["stocks"]},{id:"crypto",name:"Cryptocurrency",assetClasses:["crypto"]},{id:"forex",name:"Foreign Exchange",assetClasses:["forex"]},{id:"futures",name:"Futures",assetClasses:["futures"]}]}}async calculateIndicator(r,n){throw new Error("Standalone indicator calculation not supported by Fast-Trade adapter")}async getAvailableIndicators(){return{categories:[{name:"Moving Averages",indicators:[{id:"sma",name:"SMA",params:["period"],description:"Simple Moving Average"},{id:"ema",name:"EMA",params:["period"],description:"Exponential Moving Average"}]},{name:"Oscillators",indicators:[{id:"rsi",name:"RSI",params:["period"],description:"Relative Strength Index"},{id:"macd",name:"MACD",params:["fast","slow","signal"],description:"Moving Average Convergence Divergence"}]},{name:"Volatility",indicators:[{id:"bbands",name:"BBANDS",params:["period","std"],description:"Bollinger Bands"},{id:"atr",name:"ATR",params:["period"],description:"Average True Range"}]},{name:"Volume",indicators:[{id:"obv",name:"OBV",params:[],description:"On Balance Volume"},{id:"mfi",name:"MFI",params:["period"],description:"Money Flow Index"}]}]}}async getBacktestStatus(r){const n=this.activeBacktests.get(r);return n||{id:r,status:"completed",progress:100,message:"Backtest not found or already completed"}}async cancelBacktest(r){this.activeBacktests.delete(r)}generateBacktestId(){return`bt-fasttrade-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}}try{const s=new P2;Ss.registerProvider(s);const e=new IQ;Ss.registerProvider(e);const r=new LQ;Ss.registerProvider(r);const n=new MQ;Ss.registerProvider(n),console.log("[App] Registered backtesting providers:",Ss.listProviders())}catch(s){console.error("[App] Failed to register backtesting providers:",s)}class BQ extends S.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("Error caught by boundary:",e,r)}render(){return this.state.hasError?t.jsxs("div",{style:{padding:"20px",color:"white",backgroundColor:"#1a1a1a"},children:[t.jsx("h1",{children:"Something went wrong"}),t.jsx("pre",{style:{color:"#ff6b6b"},children:this.state.error?.toString()}),t.jsx("pre",{style:{fontSize:"12px",marginTop:"10px"},children:this.state.error?.stack})]}):this.props.children}}hP.createRoot(document.getElementById("root")).render(t.jsx(S.StrictMode,{children:t.jsx(BQ,{children:t.jsx(vP,{children:t.jsx(f7,{children:t.jsx(yT,{children:t.jsx(sQ,{})})})})})}));
